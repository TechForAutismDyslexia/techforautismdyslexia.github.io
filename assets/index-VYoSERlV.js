import{r as N6,a as S6,c as i4,g as C6,b as k6}from"./react-DoC2WAmd.js";import{r as F,a as wk,u as jh,b as Ml,d as j6,P as T6}from"./redux-DhCfbEIO.js";import{H as Ey}from"./helmet-g7oBtJdQ.js";import{L as nt,u as xs,a as Bo,N as Eo,b as Vo,c as I6,R as og,d as tt,B as $6}from"./router-BTCeqOFl.js";import{G as Un,U as Nk,C as Hr,a as Sk,b as A6,c as Ck,M as kk,H as E6,d as D6,e as R6}from"./ui-D2osSqbx.js";import{a as Le,j as Nr,E as Dy,b as D1,_ as ha,f as jk,p as l4}from"./utils-B5cH8NR2.js";import{L as ao,y as Be}from"./toast-CnDYsJwX.js";import"./modal-Chjiymov.js";function Zpe(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function _6(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(s,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var Jb={exports:{}},Qd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c4;function O6(){if(c4)return Qd;c4=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,o){var i=null;if(o!==void 0&&(i=""+o),a.key!==void 0&&(i=""+a.key),"key"in a){o={};for(var c in a)c!=="key"&&(o[c]=a[c])}else o=a;return a=o.ref,{$$typeof:s,type:n,key:i,ref:a!==void 0?a:null,props:o}}return Qd.Fragment=e,Qd.jsx=t,Qd.jsxs=t,Qd}var u4;function F6(){return u4||(u4=1,Jb.exports=O6()),Jb.exports}var r=F6(),e1={exports:{}},Jd={},t1={exports:{}},s1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d4;function L6(){return d4||(d4=1,function(s){function e(B,K){var J=B.length;B.push(K);e:for(;0<J;){var Q=J-1>>>1,ae=B[Q];if(0<a(ae,K))B[Q]=K,B[J]=ae,J=Q;else break e}}function t(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var K=B[0],J=B.pop();if(J!==K){B[0]=J;e:for(var Q=0,ae=B.length,we=ae>>>1;Q<we;){var Ce=2*(Q+1)-1,ve=B[Ce],pe=Ce+1,xe=B[pe];if(0>a(ve,J))pe<ae&&0>a(xe,ve)?(B[Q]=xe,B[pe]=J,Q=pe):(B[Q]=ve,B[Ce]=J,Q=Ce);else if(pe<ae&&0>a(xe,J))B[Q]=xe,B[pe]=J,Q=pe;else break e}}return K}function a(B,K){var J=B.sortIndex-K.sortIndex;return J!==0?J:B.id-K.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var i=Date,c=i.now();s.unstable_now=function(){return i.now()-c}}var u=[],h=[],p=1,f=null,g=3,b=!1,y=!1,v=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function T(B){for(var K=t(h);K!==null;){if(K.callback===null)n(h);else if(K.startTime<=B)n(h),K.sortIndex=K.expirationTime,e(u,K);else break;K=t(h)}}function $(B){if(v=!1,T(B),!y)if(t(u)!==null)y=!0,E||(E=!0,U());else{var K=t(h);K!==null&&q($,K.startTime-B)}}var E=!1,_=-1,L=5,O=-1;function z(){return w?!0:!(s.unstable_now()-O<L)}function A(){if(w=!1,E){var B=s.unstable_now();O=B;var K=!0;try{e:{y=!1,v&&(v=!1,C(_),_=-1),b=!0;var J=g;try{t:{for(T(B),f=t(u);f!==null&&!(f.expirationTime>B&&z());){var Q=f.callback;if(typeof Q=="function"){f.callback=null,g=f.priorityLevel;var ae=Q(f.expirationTime<=B);if(B=s.unstable_now(),typeof ae=="function"){f.callback=ae,T(B),K=!0;break t}f===t(u)&&n(u),T(B)}else n(u);f=t(u)}if(f!==null)K=!0;else{var we=t(h);we!==null&&q($,we.startTime-B),K=!1}}break e}finally{f=null,g=J,b=!1}K=void 0}}finally{K?U():E=!1}}}var U;if(typeof I=="function")U=function(){I(A)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,Z=X.port2;X.port1.onmessage=A,U=function(){Z.postMessage(null)}}else U=function(){N(A,0)};function q(B,K){_=N(function(){B(s.unstable_now())},K)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(B){B.callback=null},s.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<B?Math.floor(1e3/B):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_next=function(B){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var J=g;g=K;try{return B()}finally{g=J}},s.unstable_requestPaint=function(){w=!0},s.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var J=g;g=B;try{return K()}finally{g=J}},s.unstable_scheduleCallback=function(B,K,J){var Q=s.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?Q+J:Q):J=Q,B){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=J+ae,B={id:p++,callback:K,priorityLevel:B,startTime:J,expirationTime:ae,sortIndex:-1},J>Q?(B.sortIndex=J,e(h,B),t(u)===null&&B===t(h)&&(v?(C(_),_=-1):v=!0,q($,J-Q))):(B.sortIndex=ae,e(u,B),y||b||(y=!0,E||(E=!0,U()))),B},s.unstable_shouldYield=z,s.unstable_wrapCallback=function(B){var K=g;return function(){var J=g;g=K;try{return B.apply(this,arguments)}finally{g=J}}}}(s1)),s1}var h4;function M6(){return h4||(h4=1,t1.exports=L6()),t1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p4;function z6(){if(p4)return Jd;p4=1;var s=M6(),e=N6(),t=S6();function n(l){var d="https://react.dev/errors/"+l;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function o(l){var d=l,m=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(m=d.return),l=d.return;while(l)}return d.tag===3?m:null}function i(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function c(l){if(o(l)!==l)throw Error(n(188))}function u(l){var d=l.alternate;if(!d){if(d=o(l),d===null)throw Error(n(188));return d!==l?null:l}for(var m=l,x=d;;){var S=m.return;if(S===null)break;var j=S.alternate;if(j===null){if(x=S.return,x!==null){m=x;continue}break}if(S.child===j.child){for(j=S.child;j;){if(j===m)return c(S),l;if(j===x)return c(S),d;j=j.sibling}throw Error(n(188))}if(m.return!==x.return)m=S,x=j;else{for(var M=!1,G=S.child;G;){if(G===m){M=!0,m=S,x=j;break}if(G===x){M=!0,x=S,m=j;break}G=G.sibling}if(!M){for(G=j.child;G;){if(G===m){M=!0,m=j,x=S;break}if(G===x){M=!0,x=j,m=S;break}G=G.sibling}if(!M)throw Error(n(189))}}if(m.alternate!==x)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:d}function h(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l;for(l=l.child;l!==null;){if(d=h(l),d!==null)return d;l=l.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),I=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function U(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}var X=Symbol.for("react.client.reference");function Z(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===X?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case w:return"Profiler";case v:return"StrictMode";case $:return"Suspense";case E:return"SuspenseList";case O:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case b:return"Portal";case I:return(l.displayName||"Context")+".Provider";case C:return(l._context.displayName||"Context")+".Consumer";case T:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case _:return d=l.displayName||null,d!==null?d:Z(l.type)||"Memo";case L:d=l._payload,l=l._init;try{return Z(l(d))}catch(m){}}return null}var q=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},Q=[],ae=-1;function we(l){return{current:l}}function Ce(l){0>ae||(l.current=Q[ae],Q[ae]=null,ae--)}function ve(l,d){ae++,Q[ae]=l.current,l.current=d}var pe=we(null),xe=we(null),ue=we(null),ye=we(null);function Y(l,d){switch(ve(ue,d),ve(xe,l),ve(pe,null),d.nodeType){case 9:case 11:l=(l=d.documentElement)&&(l=l.namespaceURI)?O3(l):0;break;default:if(l=d.tagName,d=d.namespaceURI)d=O3(d),l=F3(d,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}Ce(pe),ve(pe,l)}function ce(){Ce(pe),Ce(xe),Ce(ue)}function re(l){l.memoizedState!==null&&ve(ye,l);var d=pe.current,m=F3(d,l.type);d!==m&&(ve(xe,l),ve(pe,m))}function ke(l){xe.current===l&&(Ce(pe),Ce(xe)),ye.current===l&&(Ce(ye),qd._currentValue=J)}var Me=Object.prototype.hasOwnProperty,Ue=s.unstable_scheduleCallback,He=s.unstable_cancelCallback,We=s.unstable_shouldYield,je=s.unstable_requestPaint,Xe=s.unstable_now,st=s.unstable_getCurrentPriorityLevel,St=s.unstable_ImmediatePriority,pt=s.unstable_UserBlockingPriority,Ve=s.unstable_NormalPriority,Je=s.unstable_LowPriority,mt=s.unstable_IdlePriority,yt=s.log,Vt=s.unstable_setDisableYieldValue,Dt=null,zt=null;function Kt(l){if(typeof yt=="function"&&Vt(l),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Dt,l)}catch(d){}}var jt=Math.clz32?Math.clz32:Dr,Ls=Math.log,Hn=Math.LN2;function Dr(l){return l>>>=0,l===0?32:31-(Ls(l)/Hn|0)|0}var aa=256,ra=4194304;function sn(l){var d=l&42;if(d!==0)return d;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Rr(l,d,m){var x=l.pendingLanes;if(x===0)return 0;var S=0,j=l.suspendedLanes,M=l.pingedLanes;l=l.warmLanes;var G=x&134217727;return G!==0?(x=G&~j,x!==0?S=sn(x):(M&=G,M!==0?S=sn(M):m||(m=G&~l,m!==0&&(S=sn(m))))):(G=x&~j,G!==0?S=sn(G):M!==0?S=sn(M):m||(m=x&~l,m!==0&&(S=sn(m)))),S===0?0:d!==0&&d!==S&&(d&j)===0&&(j=S&-S,m=d&-d,j>=m||j===32&&(m&4194048)!==0)?d:S}function _r(l,d){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&d)===0}function oa(l,d){switch(l){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sl(){var l=aa;return aa<<=1,(aa&4194048)===0&&(aa=256),l}function nl(){var l=ra;return ra<<=1,(ra&62914560)===0&&(ra=4194304),l}function Ko(l){for(var d=[],m=0;31>m;m++)d.push(l);return d}function nn(l,d){l.pendingLanes|=d,d!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Ns(l,d,m,x,S,j){var M=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var G=l.entanglements,ee=l.expirationTimes,Ne=l.hiddenUpdates;for(m=M&~m;0<m;){var _e=31-jt(m),ze=1<<_e;G[_e]=0,ee[_e]=-1;var Te=Ne[_e];if(Te!==null)for(Ne[_e]=null,_e=0;_e<Te.length;_e++){var $e=Te[_e];$e!==null&&($e.lane&=-536870913)}m&=~ze}x!==0&&al(l,x,0),j!==0&&S===0&&l.tag!==0&&(l.suspendedLanes|=j&~(M&~d))}function al(l,d,m){l.pendingLanes|=d,l.suspendedLanes&=~d;var x=31-jt(d);l.entangledLanes|=d,l.entanglements[x]=l.entanglements[x]|1073741824|m&4194090}function qn(l,d){var m=l.entangledLanes|=d;for(l=l.entanglements;m;){var x=31-jt(m),S=1<<x;S&d|l[x]&d&&(l[x]|=d),m&=~S}}function Or(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Re(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function Qe(){var l=K.p;return l!==0?l:(l=window.event,l===void 0?32:t4(l.type))}function Rn(l,d){var m=K.p;try{return K.p=l,d()}finally{K.p=m}}var an=Math.random().toString(36).slice(2),Ss="__reactFiber$"+an,Cs="__reactProps$"+an,za="__reactContainer$"+an,io="__reactEvents$"+an,Ku="__reactListeners$"+an,uc="__reactHandles$"+an,Xu="__reactResources$"+an,Fr="__reactMarker$"+an;function dc(l){delete l[Ss],delete l[Cs],delete l[io],delete l[Ku],delete l[uc]}function lo(l){var d=l[Ss];if(d)return d;for(var m=l.parentNode;m;){if(d=m[za]||m[Ss]){if(m=d.alternate,d.child!==null||m!==null&&m.child!==null)for(l=P3(l);l!==null;){if(m=l[Ss])return m;l=P3(l)}return d}l=m,m=l.parentNode}return null}function fr(l){if(l=l[Ss]||l[za]){var d=l.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return l}return null}function Xo(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l.stateNode;throw Error(n(33))}function co(l){var d=l[Xu];return d||(d=l[Xu]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function Us(l){l[Fr]=!0}var Kp=new Set,Yu={};function Pa(l,d){uo(l,d),uo(l+"Capture",d)}function uo(l,d){for(Yu[l]=d,l=0;l<d.length;l++)Kp.add(d[l])}var Xp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zu={},Yp={};function s0(l){return Me.call(Yp,l)?!0:Me.call(Zu,l)?!1:Xp.test(l)?Yp[l]=!0:(Zu[l]=!0,!1)}function hc(l,d,m){if(s0(d))if(m===null)l.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(d);return;case"boolean":var x=d.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(d);return}}l.setAttribute(d,""+m)}}function pc(l,d,m){if(m===null)l.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttribute(d,""+m)}}function Ba(l,d,m,x){if(x===null)l.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(d,m,""+x)}}var fc,Zp;function Yo(l){if(fc===void 0)try{throw Error()}catch(m){var d=m.stack.trim().match(/\n( *(at )?)/);fc=d&&d[1]||"",Zp=-1<m.stack.indexOf("\n    at")?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+fc+l+Zp}var Qu=!1;function Ju(l,d){if(!l||Qu)return"";Qu=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(d){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch($e){var Te=$e}Reflect.construct(l,[],ze)}else{try{ze.call()}catch($e){Te=$e}l.call(ze.prototype)}}else{try{throw Error()}catch($e){Te=$e}(ze=l())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch($e){if($e&&Te&&typeof $e.stack=="string")return[$e.stack,Te.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=x.DetermineComponentFrameRoot(),M=j[0],G=j[1];if(M&&G){var ee=M.split("\n"),Ne=G.split("\n");for(S=x=0;x<ee.length&&!ee[x].includes("DetermineComponentFrameRoot");)x++;for(;S<Ne.length&&!Ne[S].includes("DetermineComponentFrameRoot");)S++;if(x===ee.length||S===Ne.length)for(x=ee.length-1,S=Ne.length-1;1<=x&&0<=S&&ee[x]!==Ne[S];)S--;for(;1<=x&&0<=S;x--,S--)if(ee[x]!==Ne[S]){if(x!==1||S!==1)do if(x--,S--,0>S||ee[x]!==Ne[S]){var _e="\n"+ee[x].replace(" at new "," at ");return l.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",l.displayName)),_e}while(1<=x&&0<=S);break}}}finally{Qu=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?Yo(m):""}function Qp(l){switch(l.tag){case 26:case 27:case 5:return Yo(l.type);case 16:return Yo("Lazy");case 13:return Yo("Suspense");case 19:return Yo("SuspenseList");case 0:case 15:return Ju(l.type,!1);case 11:return Ju(l.type.render,!1);case 1:return Ju(l.type,!0);case 31:return Yo("Activity");default:return""}}function ed(l){try{var d="";do d+=Qp(l),l=l.return;while(l);return d}catch(m){return"\nError generating stack: "+m.message+"\n"+m.stack}}function _n(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function td(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function sd(l){var d=td(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),x=""+l[d];if(!l.hasOwnProperty(d)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,j=m.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return S.call(this)},set:function(M){x=""+M,j.call(this,M)}}),Object.defineProperty(l,d,{enumerable:m.enumerable}),{getValue:function(){return x},setValue:function(M){x=""+M},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Lr(l){l._valueTracker||(l._valueTracker=sd(l))}function ia(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var m=d.getValue(),x="";return l&&(x=td(l)?l.checked?"true":"false":l.value),l=x,l!==m?(d.setValue(l),!0):!1}function mc(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch(d){return l.body}}var n0=/[\n"\\]/g;function Kn(l){return l.replace(n0,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function gc(l,d,m,x,S,j,M,G){l.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?l.type=M:l.removeAttribute("type"),d!=null?M==="number"?(d===0&&l.value===""||l.value!=d)&&(l.value=""+_n(d)):l.value!==""+_n(d)&&(l.value=""+_n(d)):M!=="submit"&&M!=="reset"||l.removeAttribute("value"),d!=null?xc(l,M,_n(d)):m!=null?xc(l,M,_n(m)):x!=null&&l.removeAttribute("value"),S==null&&j!=null&&(l.defaultChecked=!!j),S!=null&&(l.checked=S&&typeof S!="function"&&typeof S!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?l.name=""+_n(G):l.removeAttribute("name")}function Xn(l,d,m,x,S,j,M,G){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(l.type=j),d!=null||m!=null){if(!(j!=="submit"&&j!=="reset"||d!=null))return;m=m!=null?""+_n(m):"",d=d!=null?""+_n(d):m,G||d===l.value||(l.value=d),l.defaultValue=d}x=x!=null?x:S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=G?l.checked:!!x,l.defaultChecked=!!x,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(l.name=M)}function xc(l,d,m){d==="number"&&mc(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function Va(l,d,m,x){if(l=l.options,d){d={};for(var S=0;S<m.length;S++)d["$"+m[S]]=!0;for(m=0;m<l.length;m++)S=d.hasOwnProperty("$"+l[m].value),l[m].selected!==S&&(l[m].selected=S),S&&x&&(l[m].defaultSelected=!0)}else{for(m=""+_n(m),d=null,S=0;S<l.length;S++){if(l[S].value===m){l[S].selected=!0,x&&(l[S].defaultSelected=!0);return}d!==null||l[S].disabled||(d=l[S])}d!==null&&(d.selected=!0)}}function nd(l,d,m){if(d!=null&&(d=""+_n(d),d!==l.value&&(l.value=d),m==null)){l.defaultValue!==d&&(l.defaultValue=d);return}l.defaultValue=m!=null?""+_n(m):""}function bc(l,d,m,x){if(d==null){if(x!=null){if(m!=null)throw Error(n(92));if(q(x)){if(1<x.length)throw Error(n(93));x=x[0]}m=x}m==null&&(m=""),d=m}m=_n(d),l.defaultValue=m,x=l.textContent,x===m&&x!==""&&x!==null&&(l.value=x)}function Zo(l,d){if(d){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=d;return}}l.textContent=d}var a0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rl(l,d,m){var x=d.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?l.setProperty(d,""):d==="float"?l.cssFloat="":l[d]="":x?l.setProperty(d,m):typeof m!="number"||m===0||a0.has(d)?d==="float"?l.cssFloat=m:l[d]=(""+m).trim():l[d]=m+"px"}function ad(l,d,m){if(d!=null&&typeof d!="object")throw Error(n(62));if(l=l.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||d!=null&&d.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var S in d)x=d[S],d.hasOwnProperty(S)&&m[S]!==x&&rl(l,S,x)}else for(var j in d)d.hasOwnProperty(j)&&rl(l,j,d[j])}function yc(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var r0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),o0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qo(l){return o0.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var vc=null;function wc(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ho=null,po=null;function rd(l){var d=fr(l);if(d&&(l=d.stateNode)){var m=l[Cs]||null;e:switch(l=d.stateNode,d.type){case"input":if(gc(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),d=m.name,m.type==="radio"&&d!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Kn(""+d)+'"][type="radio"]'),d=0;d<m.length;d++){var x=m[d];if(x!==l&&x.form===l.form){var S=x[Cs]||null;if(!S)throw Error(n(90));gc(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(d=0;d<m.length;d++)x=m[d],x.form===l.form&&ia(x)}break e;case"textarea":nd(l,m.value,m.defaultValue);break e;case"select":d=m.value,d!=null&&Va(l,!!m.multiple,d,!1)}}}var Nc=!1;function od(l,d,m){if(Nc)return l(d,m);Nc=!0;try{var x=l(d);return x}finally{if(Nc=!1,(ho!==null||po!==null)&&(Ff(),ho&&(d=ho,l=po,po=ho=null,rd(d),l)))for(d=0;d<l.length;d++)rd(l[d])}}function ol(l,d){var m=l.stateNode;if(m===null)return null;var x=m[Cs]||null;if(x===null)return null;m=x[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,d,typeof m));return m}var Ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),id=!1;if(Ua)try{var il={};Object.defineProperty(il,"passive",{get:function(){id=!0}}),window.addEventListener("test",il,il),window.removeEventListener("test",il,il)}catch(l){id=!1}var Ga=null,Sc=null,Cc=null;function Jp(){if(Cc)return Cc;var l,d=Sc,m=d.length,x,S="value"in Ga?Ga.value:Ga.textContent,j=S.length;for(l=0;l<m&&d[l]===S[l];l++);var M=m-l;for(x=1;x<=M&&d[m-x]===S[j-x];x++);return Cc=S.slice(l,1<x?1-x:void 0)}function kc(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function jc(){return!0}function ld(){return!1}function On(l){function d(m,x,S,j,M){this._reactName=m,this._targetInst=S,this.type=x,this.nativeEvent=j,this.target=M,this.currentTarget=null;for(var G in l)l.hasOwnProperty(G)&&(m=l[G],this[G]=m?m(j):j[G]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?jc:ld,this.isPropagationStopped=ld,this}return p(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=jc)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=jc)},persist:function(){},isPersistent:jc}),d}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jo=On(fo),ll=p({},fo,{view:0,detail:0}),i0=On(ll),cd,ei,cl,Tc=p({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ct,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==cl&&(cl&&l.type==="mousemove"?(cd=l.screenX-cl.screenX,ei=l.screenY-cl.screenY):ei=cd=0,cl=l),cd)},movementY:function(l){return"movementY"in l?l.movementY:ei}}),ef=On(Tc),tf=p({},Tc,{dataTransfer:0}),k=On(tf),R=p({},ll,{relatedTarget:0}),P=On(R),H=p({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),se=On(H),fe=p({},fo,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),ie=On(fe),Ie=p({},fo,{data:0}),De=On(Ie),Ge={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ot={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wt(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=vt[l])?!!d[l]:!1}function ct(){return wt}var Tt=p({},ll,{key:function(l){if(l.key){var d=Ge[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=kc(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?ot[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ct,charCode:function(l){return l.type==="keypress"?kc(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?kc(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Ut=On(Tt),cs=p({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jt=On(cs),rn=p({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ct}),la=On(rn),Fn=p({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wt=On(Fn),Ms=p({},Tc,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=On(Ms),GD=p({},fo,{newState:0,oldState:0}),WD=On(GD),HD=[9,13,27,32],l0=Ua&&"CompositionEvent"in window,ud=null;Ua&&"documentMode"in document&&(ud=document.documentMode);var qD=Ua&&"TextEvent"in window&&!ud,Gw=Ua&&(!l0||ud&&8<ud&&11>=ud),Ww=" ",Hw=!1;function qw(l,d){switch(l){case"keyup":return HD.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kw(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Ic=!1;function KD(l,d){switch(l){case"compositionend":return Kw(d);case"keypress":return d.which!==32?null:(Hw=!0,Ww);case"textInput":return l=d.data,l===Ww&&Hw?null:l;default:return null}}function XD(l,d){if(Ic)return l==="compositionend"||!l0&&qw(l,d)?(l=Jp(),Cc=Sc=Ga=null,Ic=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Gw&&d.locale!=="ko"?null:d.data;default:return null}}var YD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xw(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!YD[l.type]:d==="textarea"}function Yw(l,d,m,x){ho?po?po.push(x):po=[x]:ho=x,d=Vf(d,"onChange"),0<d.length&&(m=new Jo("onChange","change",null,m,x),l.push({event:m,listeners:d}))}var dd=null,hd=null;function ZD(l){A3(l,0)}function sf(l){var d=Xo(l);if(ia(d))return l}function Zw(l,d){if(l==="change")return d}var Qw=!1;if(Ua){var c0;if(Ua){var u0="oninput"in document;if(!u0){var Jw=document.createElement("div");Jw.setAttribute("oninput","return;"),u0=typeof Jw.oninput=="function"}c0=u0}else c0=!1;Qw=c0&&(!document.documentMode||9<document.documentMode)}function eN(){dd&&(dd.detachEvent("onpropertychange",tN),hd=dd=null)}function tN(l){if(l.propertyName==="value"&&sf(hd)){var d=[];Yw(d,hd,l,wc(l)),od(ZD,d)}}function QD(l,d,m){l==="focusin"?(eN(),dd=d,hd=m,dd.attachEvent("onpropertychange",tN)):l==="focusout"&&eN()}function JD(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return sf(hd)}function eR(l,d){if(l==="click")return sf(d)}function tR(l,d){if(l==="input"||l==="change")return sf(d)}function sR(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var ka=typeof Object.is=="function"?Object.is:sR;function pd(l,d){if(ka(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var m=Object.keys(l),x=Object.keys(d);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var S=m[x];if(!Me.call(d,S)||!ka(l[S],d[S]))return!1}return!0}function sN(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function nN(l,d){var m=sN(l);l=0;for(var x;m;){if(m.nodeType===3){if(x=l+m.textContent.length,l<=d&&x>=d)return{node:m,offset:d-l};l=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=sN(m)}}function aN(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?aN(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function rN(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var d=mc(l.document);d instanceof l.HTMLIFrameElement;){try{var m=typeof d.contentWindow.location.href=="string"}catch(x){m=!1}if(m)l=d.contentWindow;else break;d=mc(l.document)}return d}function d0(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}var nR=Ua&&"documentMode"in document&&11>=document.documentMode,$c=null,h0=null,fd=null,p0=!1;function oN(l,d,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;p0||$c==null||$c!==mc(x)||(x=$c,"selectionStart"in x&&d0(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),fd&&pd(fd,x)||(fd=x,x=Vf(h0,"onSelect"),0<x.length&&(d=new Jo("onSelect","select",null,d,m),l.push({event:d,listeners:x}),d.target=$c)))}function ul(l,d){var m={};return m[l.toLowerCase()]=d.toLowerCase(),m["Webkit"+l]="webkit"+d,m["Moz"+l]="moz"+d,m}var Ac={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionrun:ul("Transition","TransitionRun"),transitionstart:ul("Transition","TransitionStart"),transitioncancel:ul("Transition","TransitionCancel"),transitionend:ul("Transition","TransitionEnd")},f0={},iN={};Ua&&(iN=document.createElement("div").style,"AnimationEvent"in window||(delete Ac.animationend.animation,delete Ac.animationiteration.animation,delete Ac.animationstart.animation),"TransitionEvent"in window||delete Ac.transitionend.transition);function dl(l){if(f0[l])return f0[l];if(!Ac[l])return l;var d=Ac[l],m;for(m in d)if(d.hasOwnProperty(m)&&m in iN)return f0[l]=d[m];return l}var lN=dl("animationend"),cN=dl("animationiteration"),uN=dl("animationstart"),aR=dl("transitionrun"),rR=dl("transitionstart"),oR=dl("transitioncancel"),dN=dl("transitionend"),hN=new Map,m0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");m0.push("scrollEnd");function mr(l,d){hN.set(l,d),Pa(d,[l])}var pN=new WeakMap;function Wa(l,d){if(typeof l=="object"&&l!==null){var m=pN.get(l);return m!==void 0?m:(d={value:l,source:d,stack:ed(d)},pN.set(l,d),d)}return{value:l,source:d,stack:ed(d)}}var Ha=[],Ec=0,g0=0;function nf(){for(var l=Ec,d=g0=Ec=0;d<l;){var m=Ha[d];Ha[d++]=null;var x=Ha[d];Ha[d++]=null;var S=Ha[d];Ha[d++]=null;var j=Ha[d];if(Ha[d++]=null,x!==null&&S!==null){var M=x.pending;M===null?S.next=S:(S.next=M.next,M.next=S),x.pending=S}j!==0&&fN(m,S,j)}}function af(l,d,m,x){Ha[Ec++]=l,Ha[Ec++]=d,Ha[Ec++]=m,Ha[Ec++]=x,g0|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function x0(l,d,m,x){return af(l,d,m,x),rf(l)}function Dc(l,d){return af(l,null,null,d),rf(l)}function fN(l,d,m){l.lanes|=m;var x=l.alternate;x!==null&&(x.lanes|=m);for(var S=!1,j=l.return;j!==null;)j.childLanes|=m,x=j.alternate,x!==null&&(x.childLanes|=m),j.tag===22&&(l=j.stateNode,l===null||l._visibility&1||(S=!0)),l=j,j=j.return;return l.tag===3?(j=l.stateNode,S&&d!==null&&(S=31-jt(m),l=j.hiddenUpdates,x=l[S],x===null?l[S]=[d]:x.push(d),d.lane=m|536870912),j):null}function rf(l){if(50<zd)throw zd=0,Sb=null,Error(n(185));for(var d=l.return;d!==null;)l=d,d=l.return;return l.tag===3?l.stateNode:null}var Rc={};function iR(l,d,m,x){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(l,d,m,x){return new iR(l,d,m,x)}function b0(l){return l=l.prototype,!(!l||!l.isReactComponent)}function mo(l,d){var m=l.alternate;return m===null?(m=ja(l.tag,d,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=d,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,d=l.dependencies,m.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function mN(l,d){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=d,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,d=m.dependencies,l.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),l}function of(l,d,m,x,S,j){var M=0;if(x=l,typeof l=="function")b0(l)&&(M=1);else if(typeof l=="string")M=c6(l,m,pe.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case O:return l=ja(31,m,d,S),l.elementType=O,l.lanes=j,l;case y:return hl(m.children,S,j,d);case v:M=8,S|=24;break;case w:return l=ja(12,m,d,S|2),l.elementType=w,l.lanes=j,l;case $:return l=ja(13,m,d,S),l.elementType=$,l.lanes=j,l;case E:return l=ja(19,m,d,S),l.elementType=E,l.lanes=j,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case N:case I:M=10;break e;case C:M=9;break e;case T:M=11;break e;case _:M=14;break e;case L:M=16,x=null;break e}M=29,m=Error(n(130,l===null?"null":typeof l,"")),x=null}return d=ja(M,m,d,S),d.elementType=l,d.type=x,d.lanes=j,d}function hl(l,d,m,x){return l=ja(7,l,x,d),l.lanes=m,l}function y0(l,d,m){return l=ja(6,l,null,d),l.lanes=m,l}function v0(l,d,m){return d=ja(4,l.children!==null?l.children:[],l.key,d),d.lanes=m,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}var _c=[],Oc=0,lf=null,cf=0,qa=[],Ka=0,pl=null,go=1,xo="";function fl(l,d){_c[Oc++]=cf,_c[Oc++]=lf,lf=l,cf=d}function gN(l,d,m){qa[Ka++]=go,qa[Ka++]=xo,qa[Ka++]=pl,pl=l;var x=go;l=xo;var S=32-jt(x)-1;x&=~(1<<S),m+=1;var j=32-jt(d)+S;if(30<j){var M=S-S%5;j=(x&(1<<M)-1).toString(32),x>>=M,S-=M,go=1<<32-jt(d)+S|m<<S|x,xo=j+l}else go=1<<j|m<<S|x,xo=l}function w0(l){l.return!==null&&(fl(l,1),gN(l,1,0))}function N0(l){for(;l===lf;)lf=_c[--Oc],_c[Oc]=null,cf=_c[--Oc],_c[Oc]=null;for(;l===pl;)pl=qa[--Ka],qa[Ka]=null,xo=qa[--Ka],qa[Ka]=null,go=qa[--Ka],qa[Ka]=null}var Yn=null,$s=null,Yt=!1,ml=null,zr=!1,S0=Error(n(519));function gl(l){var d=Error(n(418,""));throw xd(Wa(d,l)),S0}function xN(l){var d=l.stateNode,m=l.type,x=l.memoizedProps;switch(d[Ss]=l,d[Cs]=x,m){case"dialog":Lt("cancel",d),Lt("close",d);break;case"iframe":case"object":case"embed":Lt("load",d);break;case"video":case"audio":for(m=0;m<Bd.length;m++)Lt(Bd[m],d);break;case"source":Lt("error",d);break;case"img":case"image":case"link":Lt("error",d),Lt("load",d);break;case"details":Lt("toggle",d);break;case"input":Lt("invalid",d),Xn(d,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Lr(d);break;case"select":Lt("invalid",d);break;case"textarea":Lt("invalid",d),bc(d,x.value,x.defaultValue,x.children),Lr(d)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||d.textContent===""+m||x.suppressHydrationWarning===!0||_3(d.textContent,m)?(x.popover!=null&&(Lt("beforetoggle",d),Lt("toggle",d)),x.onScroll!=null&&Lt("scroll",d),x.onScrollEnd!=null&&Lt("scrollend",d),x.onClick!=null&&(d.onclick=Uf),d=!0):d=!1,d||gl(l)}function bN(l){for(Yn=l.return;Yn;)switch(Yn.tag){case 5:case 13:zr=!1;return;case 27:case 3:zr=!0;return;default:Yn=Yn.return}}function md(l){if(l!==Yn)return!1;if(!Yt)return bN(l),Yt=!0,!1;var d=l.tag,m;if((m=d!==3&&d!==27)&&((m=d===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||zb(l.type,l.memoizedProps)),m=!m),m&&$s&&gl(l),bN(l),d===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8)if(m=l.data,m==="/$"){if(d===0){$s=xr(l.nextSibling);break e}d--}else m!=="$"&&m!=="$!"&&m!=="$?"||d++;l=l.nextSibling}$s=null}}else d===27?(d=$s,gi(l.type)?(l=Ub,Ub=null,$s=l):$s=d):$s=Yn?xr(l.stateNode.nextSibling):null;return!0}function gd(){$s=Yn=null,Yt=!1}function yN(){var l=ml;return l!==null&&(da===null?da=l:da.push.apply(da,l),ml=null),l}function xd(l){ml===null?ml=[l]:ml.push(l)}var C0=we(null),xl=null,bo=null;function ti(l,d,m){ve(C0,d._currentValue),d._currentValue=m}function yo(l){l._currentValue=C0.current,Ce(C0)}function k0(l,d,m){for(;l!==null;){var x=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,x!==null&&(x.childLanes|=d)):x!==null&&(x.childLanes&d)!==d&&(x.childLanes|=d),l===m)break;l=l.return}}function j0(l,d,m,x){var S=l.child;for(S!==null&&(S.return=l);S!==null;){var j=S.dependencies;if(j!==null){var M=S.child;j=j.firstContext;e:for(;j!==null;){var G=j;j=S;for(var ee=0;ee<d.length;ee++)if(G.context===d[ee]){j.lanes|=m,G=j.alternate,G!==null&&(G.lanes|=m),k0(j.return,m,l),x||(M=null);break e}j=G.next}}else if(S.tag===18){if(M=S.return,M===null)throw Error(n(341));M.lanes|=m,j=M.alternate,j!==null&&(j.lanes|=m),k0(M,m,l),M=null}else M=S.child;if(M!==null)M.return=S;else for(M=S;M!==null;){if(M===l){M=null;break}if(S=M.sibling,S!==null){S.return=M.return,M=S;break}M=M.return}S=M}}function bd(l,d,m,x){l=null;for(var S=d,j=!1;S!==null;){if(!j){if((S.flags&524288)!==0)j=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var M=S.alternate;if(M===null)throw Error(n(387));if(M=M.memoizedProps,M!==null){var G=S.type;ka(S.pendingProps.value,M.value)||(l!==null?l.push(G):l=[G])}}else if(S===ye.current){if(M=S.alternate,M===null)throw Error(n(387));M.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(l!==null?l.push(qd):l=[qd])}S=S.return}l!==null&&j0(d,l,m,x),d.flags|=262144}function uf(l){for(l=l.firstContext;l!==null;){if(!ka(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function bl(l){xl=l,bo=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Ln(l){return vN(xl,l)}function df(l,d){return xl===null&&bl(l),vN(l,d)}function vN(l,d){var m=d._currentValue;if(d={context:d,memoizedValue:m,next:null},bo===null){if(l===null)throw Error(n(308));bo=d,l.dependencies={lanes:0,firstContext:d},l.flags|=524288}else bo=bo.next=d;return m}var lR=typeof AbortController<"u"?AbortController:function(){var l=[],d=this.signal={aborted:!1,addEventListener:function(m,x){l.push(x)}};this.abort=function(){d.aborted=!0,l.forEach(function(m){return m()})}},cR=s.unstable_scheduleCallback,uR=s.unstable_NormalPriority,on={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function T0(){return{controller:new lR,data:new Map,refCount:0}}function yd(l){l.refCount--,l.refCount===0&&cR(uR,function(){l.controller.abort()})}var vd=null,I0=0,Fc=0,Lc=null;function dR(l,d){if(vd===null){var m=vd=[];I0=0,Fc=Ab(),Lc={status:"pending",value:void 0,then:function(x){m.push(x)}}}return I0++,d.then(wN,wN),d}function wN(){if(--I0===0&&vd!==null){Lc!==null&&(Lc.status="fulfilled");var l=vd;vd=null,Fc=0,Lc=null;for(var d=0;d<l.length;d++)(0,l[d])()}}function hR(l,d){var m=[],x={status:"pending",value:null,reason:null,then:function(S){m.push(S)}};return l.then(function(){x.status="fulfilled",x.value=d;for(var S=0;S<m.length;S++)(0,m[S])(d)},function(S){for(x.status="rejected",x.reason=S,S=0;S<m.length;S++)(0,m[S])(void 0)}),x}var NN=B.S;B.S=function(l,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&dR(l,d),NN!==null&&NN(l,d)};var yl=we(null);function $0(){var l=yl.current;return l!==null?l:ps.pooledCache}function hf(l,d){d===null?ve(yl,yl.current):ve(yl,d.pool)}function SN(){var l=$0();return l===null?null:{parent:on._currentValue,pool:l}}var wd=Error(n(460)),CN=Error(n(474)),pf=Error(n(542)),A0={then:function(){}};function kN(l){return l=l.status,l==="fulfilled"||l==="rejected"}function ff(){}function jN(l,d,m){switch(m=l[m],m===void 0?l.push(d):m!==d&&(d.then(ff,ff),d=m),d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,IN(l),l;default:if(typeof d.status=="string")d.then(ff,ff);else{if(l=ps,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=d,l.status="pending",l.then(function(x){if(d.status==="pending"){var S=d;S.status="fulfilled",S.value=x}},function(x){if(d.status==="pending"){var S=d;S.status="rejected",S.reason=x}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,IN(l),l}throw Nd=d,wd}}var Nd=null;function TN(){if(Nd===null)throw Error(n(459));var l=Nd;return Nd=null,l}function IN(l){if(l===wd||l===pf)throw Error(n(483))}var si=!1;function E0(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function D0(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function ni(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function ai(l,d,m){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(es&2)!==0){var S=x.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),x.pending=d,d=rf(l),fN(l,null,m),d}return af(l,x,d,m),rf(l)}function Sd(l,d,m){if(d=d.updateQueue,d!==null&&(d=d.shared,(m&4194048)!==0)){var x=d.lanes;x&=l.pendingLanes,m|=x,d.lanes=m,qn(l,m)}}function R0(l,d){var m=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var S=null,j=null;if(m=m.firstBaseUpdate,m!==null){do{var M={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};j===null?S=j=M:j=j.next=M,m=m.next}while(m!==null);j===null?S=j=d:j=j.next=d}else S=j=d;m={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:j,shared:x.shared,callbacks:x.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=d:l.next=d,m.lastBaseUpdate=d}var _0=!1;function Cd(){if(_0){var l=Lc;if(l!==null)throw l}}function kd(l,d,m,x){_0=!1;var S=l.updateQueue;si=!1;var j=S.firstBaseUpdate,M=S.lastBaseUpdate,G=S.shared.pending;if(G!==null){S.shared.pending=null;var ee=G,Ne=ee.next;ee.next=null,M===null?j=Ne:M.next=Ne,M=ee;var _e=l.alternate;_e!==null&&(_e=_e.updateQueue,G=_e.lastBaseUpdate,G!==M&&(G===null?_e.firstBaseUpdate=Ne:G.next=Ne,_e.lastBaseUpdate=ee))}if(j!==null){var ze=S.baseState;M=0,_e=Ne=ee=null,G=j;do{var Te=G.lane&-536870913,$e=Te!==G.lane;if($e?(Ht&Te)===Te:(x&Te)===Te){Te!==0&&Te===Fc&&(_0=!0),_e!==null&&(_e=_e.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var Nt=l,ft=G;Te=d;var rs=m;switch(ft.tag){case 1:if(Nt=ft.payload,typeof Nt=="function"){ze=Nt.call(rs,ze,Te);break e}ze=Nt;break e;case 3:Nt.flags=Nt.flags&-65537|128;case 0:if(Nt=ft.payload,Te=typeof Nt=="function"?Nt.call(rs,ze,Te):Nt,Te==null)break e;ze=p({},ze,Te);break e;case 2:si=!0}}Te=G.callback,Te!==null&&(l.flags|=64,$e&&(l.flags|=8192),$e=S.callbacks,$e===null?S.callbacks=[Te]:$e.push(Te))}else $e={lane:Te,tag:G.tag,payload:G.payload,callback:G.callback,next:null},_e===null?(Ne=_e=$e,ee=ze):_e=_e.next=$e,M|=Te;if(G=G.next,G===null){if(G=S.shared.pending,G===null)break;$e=G,G=$e.next,$e.next=null,S.lastBaseUpdate=$e,S.shared.pending=null}}while(!0);_e===null&&(ee=ze),S.baseState=ee,S.firstBaseUpdate=Ne,S.lastBaseUpdate=_e,j===null&&(S.shared.lanes=0),hi|=M,l.lanes=M,l.memoizedState=ze}}function $N(l,d){if(typeof l!="function")throw Error(n(191,l));l.call(d)}function AN(l,d){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)$N(m[l],d)}var Mc=we(null),mf=we(0);function EN(l,d){l=jo,ve(mf,l),ve(Mc,d),jo=l|d.baseLanes}function O0(){ve(mf,jo),ve(Mc,Mc.current)}function F0(){jo=mf.current,Ce(Mc),Ce(mf)}var ri=0,Rt=null,ns=null,Gs=null,gf=!1,zc=!1,vl=!1,xf=0,jd=0,Pc=null,pR=0;function zs(){throw Error(n(321))}function L0(l,d){if(d===null)return!1;for(var m=0;m<d.length&&m<l.length;m++)if(!ka(l[m],d[m]))return!1;return!0}function M0(l,d,m,x,S,j){return ri=j,Rt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,B.H=l===null||l.memoizedState===null?fS:mS,vl=!1,j=m(x,S),vl=!1,zc&&(j=RN(d,m,x,S)),DN(l),j}function DN(l){B.H=Sf;var d=ns!==null&&ns.next!==null;if(ri=0,Gs=ns=Rt=null,gf=!1,jd=0,Pc=null,d)throw Error(n(300));l===null||fn||(l=l.dependencies,l!==null&&uf(l)&&(fn=!0))}function RN(l,d,m,x){Rt=l;var S=0;do{if(zc&&(Pc=null),jd=0,zc=!1,25<=S)throw Error(n(301));if(S+=1,Gs=ns=null,l.updateQueue!=null){var j=l.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}B.H=vR,j=d(m,x)}while(zc);return j}function fR(){var l=B.H,d=l.useState()[0];return d=typeof d.then=="function"?Td(d):d,l=l.useState()[0],(ns!==null?ns.memoizedState:null)!==l&&(Rt.flags|=1024),d}function z0(){var l=xf!==0;return xf=0,l}function P0(l,d,m){d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~m}function B0(l){if(gf){for(l=l.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}gf=!1}ri=0,Gs=ns=Rt=null,zc=!1,jd=xf=0,Pc=null}function ca(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gs===null?Rt.memoizedState=Gs=l:Gs=Gs.next=l,Gs}function Ws(){if(ns===null){var l=Rt.alternate;l=l!==null?l.memoizedState:null}else l=ns.next;var d=Gs===null?Rt.memoizedState:Gs.next;if(d!==null)Gs=d,ns=l;else{if(l===null)throw Rt.alternate===null?Error(n(467)):Error(n(310));ns=l,l={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},Gs===null?Rt.memoizedState=Gs=l:Gs=Gs.next=l}return Gs}function V0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Td(l){var d=jd;return jd+=1,Pc===null&&(Pc=[]),l=jN(Pc,l,d),d=Rt,(Gs===null?d.memoizedState:Gs.next)===null&&(d=d.alternate,B.H=d===null||d.memoizedState===null?fS:mS),l}function bf(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Td(l);if(l.$$typeof===I)return Ln(l)}throw Error(n(438,String(l)))}function U0(l){var d=null,m=Rt.updateQueue;if(m!==null&&(d=m.memoCache),d==null){var x=Rt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(d={data:x.data.map(function(S){return S.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),m===null&&(m=V0(),Rt.updateQueue=m),m.memoCache=d,m=d.data[d.index],m===void 0)for(m=d.data[d.index]=Array(l),x=0;x<l;x++)m[x]=z;return d.index++,m}function vo(l,d){return typeof d=="function"?d(l):d}function yf(l){var d=Ws();return G0(d,ns,l)}function G0(l,d,m){var x=l.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=m;var S=l.baseQueue,j=x.pending;if(j!==null){if(S!==null){var M=S.next;S.next=j.next,j.next=M}d.baseQueue=S=j,x.pending=null}if(j=l.baseState,S===null)l.memoizedState=j;else{d=S.next;var G=M=null,ee=null,Ne=d,_e=!1;do{var ze=Ne.lane&-536870913;if(ze!==Ne.lane?(Ht&ze)===ze:(ri&ze)===ze){var Te=Ne.revertLane;if(Te===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),ze===Fc&&(_e=!0);else if((ri&Te)===Te){Ne=Ne.next,Te===Fc&&(_e=!0);continue}else ze={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},ee===null?(G=ee=ze,M=j):ee=ee.next=ze,Rt.lanes|=Te,hi|=Te;ze=Ne.action,vl&&m(j,ze),j=Ne.hasEagerState?Ne.eagerState:m(j,ze)}else Te={lane:ze,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},ee===null?(G=ee=Te,M=j):ee=ee.next=Te,Rt.lanes|=ze,hi|=ze;Ne=Ne.next}while(Ne!==null&&Ne!==d);if(ee===null?M=j:ee.next=G,!ka(j,l.memoizedState)&&(fn=!0,_e&&(m=Lc,m!==null)))throw m;l.memoizedState=j,l.baseState=M,l.baseQueue=ee,x.lastRenderedState=j}return S===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function W0(l){var d=Ws(),m=d.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var x=m.dispatch,S=m.pending,j=d.memoizedState;if(S!==null){m.pending=null;var M=S=S.next;do j=l(j,M.action),M=M.next;while(M!==S);ka(j,d.memoizedState)||(fn=!0),d.memoizedState=j,d.baseQueue===null&&(d.baseState=j),m.lastRenderedState=j}return[j,x]}function _N(l,d,m){var x=Rt,S=Ws(),j=Yt;if(j){if(m===void 0)throw Error(n(407));m=m()}else m=d();var M=!ka((ns||S).memoizedState,m);M&&(S.memoizedState=m,fn=!0),S=S.queue;var G=LN.bind(null,x,S,l);if(Id(2048,8,G,[l]),S.getSnapshot!==d||M||Gs!==null&&Gs.memoizedState.tag&1){if(x.flags|=2048,Bc(9,vf(),FN.bind(null,x,S,m,d),null),ps===null)throw Error(n(349));j||(ri&124)!==0||ON(x,d,m)}return m}function ON(l,d,m){l.flags|=16384,l={getSnapshot:d,value:m},d=Rt.updateQueue,d===null?(d=V0(),Rt.updateQueue=d,d.stores=[l]):(m=d.stores,m===null?d.stores=[l]:m.push(l))}function FN(l,d,m,x){d.value=m,d.getSnapshot=x,MN(d)&&zN(l)}function LN(l,d,m){return m(function(){MN(d)&&zN(l)})}function MN(l){var d=l.getSnapshot;l=l.value;try{var m=d();return!ka(l,m)}catch(x){return!0}}function zN(l){var d=Dc(l,2);d!==null&&Ea(d,l,2)}function H0(l){var d=ca();if(typeof l=="function"){var m=l;if(l=m(),vl){Kt(!0);try{m()}finally{Kt(!1)}}}return d.memoizedState=d.baseState=l,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:l},d}function PN(l,d,m,x){return l.baseState=m,G0(l,ns,typeof x=="function"?x:vo)}function mR(l,d,m,x,S){if(Nf(l))throw Error(n(485));if(l=d.action,l!==null){var j={payload:S,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){j.listeners.push(M)}};B.T!==null?m(!0):j.isTransition=!1,x(j),m=d.pending,m===null?(j.next=d.pending=j,BN(d,j)):(j.next=m.next,d.pending=m.next=j)}}function BN(l,d){var m=d.action,x=d.payload,S=l.state;if(d.isTransition){var j=B.T,M={};B.T=M;try{var G=m(S,x),ee=B.S;ee!==null&&ee(M,G),VN(l,d,G)}catch(Ne){q0(l,d,Ne)}finally{B.T=j}}else try{j=m(S,x),VN(l,d,j)}catch(Ne){q0(l,d,Ne)}}function VN(l,d,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){UN(l,d,x)},function(x){return q0(l,d,x)}):UN(l,d,m)}function UN(l,d,m){d.status="fulfilled",d.value=m,GN(d),l.state=m,d=l.pending,d!==null&&(m=d.next,m===d?l.pending=null:(m=m.next,d.next=m,BN(l,m)))}function q0(l,d,m){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do d.status="rejected",d.reason=m,GN(d),d=d.next;while(d!==x)}l.action=null}function GN(l){l=l.listeners;for(var d=0;d<l.length;d++)(0,l[d])()}function WN(l,d){return d}function HN(l,d){if(Yt){var m=ps.formState;if(m!==null){e:{var x=Rt;if(Yt){if($s){t:{for(var S=$s,j=zr;S.nodeType!==8;){if(!j){S=null;break t}if(S=xr(S.nextSibling),S===null){S=null;break t}}j=S.data,S=j==="F!"||j==="F"?S:null}if(S){$s=xr(S.nextSibling),x=S.data==="F!";break e}}gl(x)}x=!1}x&&(d=m[0])}}return m=ca(),m.memoizedState=m.baseState=d,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:WN,lastRenderedState:d},m.queue=x,m=dS.bind(null,Rt,x),x.dispatch=m,x=H0(!1),j=Q0.bind(null,Rt,!1,x.queue),x=ca(),S={state:d,dispatch:null,action:l,pending:null},x.queue=S,m=mR.bind(null,Rt,S,j,m),S.dispatch=m,x.memoizedState=l,[d,m,!1]}function qN(l){var d=Ws();return KN(d,ns,l)}function KN(l,d,m){if(d=G0(l,d,WN)[0],l=yf(vo)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var x=Td(d)}catch(M){throw M===wd?pf:M}else x=d;d=Ws();var S=d.queue,j=S.dispatch;return m!==d.memoizedState&&(Rt.flags|=2048,Bc(9,vf(),gR.bind(null,S,m),null)),[x,j,l]}function gR(l,d){l.action=d}function XN(l){var d=Ws(),m=ns;if(m!==null)return KN(d,m,l);Ws(),d=d.memoizedState,m=Ws();var x=m.queue.dispatch;return m.memoizedState=l,[d,x,!1]}function Bc(l,d,m,x){return l={tag:l,create:m,deps:x,inst:d,next:null},d=Rt.updateQueue,d===null&&(d=V0(),Rt.updateQueue=d),m=d.lastEffect,m===null?d.lastEffect=l.next=l:(x=m.next,m.next=l,l.next=x,d.lastEffect=l),l}function vf(){return{destroy:void 0,resource:void 0}}function YN(){return Ws().memoizedState}function wf(l,d,m,x){var S=ca();x=x===void 0?null:x,Rt.flags|=l,S.memoizedState=Bc(1|d,vf(),m,x)}function Id(l,d,m,x){var S=Ws();x=x===void 0?null:x;var j=S.memoizedState.inst;ns!==null&&x!==null&&L0(x,ns.memoizedState.deps)?S.memoizedState=Bc(d,j,m,x):(Rt.flags|=l,S.memoizedState=Bc(1|d,j,m,x))}function ZN(l,d){wf(8390656,8,l,d)}function QN(l,d){Id(2048,8,l,d)}function JN(l,d){return Id(4,2,l,d)}function eS(l,d){return Id(4,4,l,d)}function tS(l,d){if(typeof d=="function"){l=l();var m=d(l);return function(){typeof m=="function"?m():d(null)}}if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function sS(l,d,m){m=m!=null?m.concat([l]):null,Id(4,4,tS.bind(null,d,l),m)}function K0(){}function nS(l,d){var m=Ws();d=d===void 0?null:d;var x=m.memoizedState;return d!==null&&L0(d,x[1])?x[0]:(m.memoizedState=[l,d],l)}function aS(l,d){var m=Ws();d=d===void 0?null:d;var x=m.memoizedState;if(d!==null&&L0(d,x[1]))return x[0];if(x=l(),vl){Kt(!0);try{l()}finally{Kt(!1)}}return m.memoizedState=[x,d],x}function X0(l,d,m){return m===void 0||(ri&1073741824)!==0?l.memoizedState=d:(l.memoizedState=m,l=i3(),Rt.lanes|=l,hi|=l,m)}function rS(l,d,m,x){return ka(m,d)?m:Mc.current!==null?(l=X0(l,m,x),ka(l,d)||(fn=!0),l):(ri&42)===0?(fn=!0,l.memoizedState=m):(l=i3(),Rt.lanes|=l,hi|=l,d)}function oS(l,d,m,x,S){var j=K.p;K.p=j!==0&&8>j?j:8;var M=B.T,G={};B.T=G,Q0(l,!1,d,m);try{var ee=S(),Ne=B.S;if(Ne!==null&&Ne(G,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var _e=hR(ee,x);$d(l,d,_e,Aa(l))}else $d(l,d,x,Aa(l))}catch(ze){$d(l,d,{then:function(){},status:"rejected",reason:ze},Aa())}finally{K.p=j,B.T=M}}function xR(){}function Y0(l,d,m,x){if(l.tag!==5)throw Error(n(476));var S=iS(l).queue;oS(l,S,d,J,m===null?xR:function(){return lS(l),m(x)})}function iS(l){var d=l.memoizedState;if(d!==null)return d;d={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:J},next:null};var m={};return d.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:m},next:null},l.memoizedState=d,l=l.alternate,l!==null&&(l.memoizedState=d),d}function lS(l){var d=iS(l).next.queue;$d(l,d,{},Aa())}function Z0(){return Ln(qd)}function cS(){return Ws().memoizedState}function uS(){return Ws().memoizedState}function bR(l){for(var d=l.return;d!==null;){switch(d.tag){case 24:case 3:var m=Aa();l=ni(m);var x=ai(d,l,m);x!==null&&(Ea(x,d,m),Sd(x,d,m)),d={cache:T0()},l.payload=d;return}d=d.return}}function yR(l,d,m){var x=Aa();m={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},Nf(l)?hS(d,m):(m=x0(l,d,m,x),m!==null&&(Ea(m,l,x),pS(m,d,x)))}function dS(l,d,m){var x=Aa();$d(l,d,m,x)}function $d(l,d,m,x){var S={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(Nf(l))hS(d,S);else{var j=l.alternate;if(l.lanes===0&&(j===null||j.lanes===0)&&(j=d.lastRenderedReducer,j!==null))try{var M=d.lastRenderedState,G=j(M,m);if(S.hasEagerState=!0,S.eagerState=G,ka(G,M))return af(l,d,S,0),ps===null&&nf(),!1}catch(ee){}finally{}if(m=x0(l,d,S,x),m!==null)return Ea(m,l,x),pS(m,d,x),!0}return!1}function Q0(l,d,m,x){if(x={lane:2,revertLane:Ab(),action:x,hasEagerState:!1,eagerState:null,next:null},Nf(l)){if(d)throw Error(n(479))}else d=x0(l,m,x,2),d!==null&&Ea(d,l,2)}function Nf(l){var d=l.alternate;return l===Rt||d!==null&&d===Rt}function hS(l,d){zc=gf=!0;var m=l.pending;m===null?d.next=d:(d.next=m.next,m.next=d),l.pending=d}function pS(l,d,m){if((m&4194048)!==0){var x=d.lanes;x&=l.pendingLanes,m|=x,d.lanes=m,qn(l,m)}}var Sf={readContext:Ln,use:bf,useCallback:zs,useContext:zs,useEffect:zs,useImperativeHandle:zs,useLayoutEffect:zs,useInsertionEffect:zs,useMemo:zs,useReducer:zs,useRef:zs,useState:zs,useDebugValue:zs,useDeferredValue:zs,useTransition:zs,useSyncExternalStore:zs,useId:zs,useHostTransitionStatus:zs,useFormState:zs,useActionState:zs,useOptimistic:zs,useMemoCache:zs,useCacheRefresh:zs},fS={readContext:Ln,use:bf,useCallback:function(l,d){return ca().memoizedState=[l,d===void 0?null:d],l},useContext:Ln,useEffect:ZN,useImperativeHandle:function(l,d,m){m=m!=null?m.concat([l]):null,wf(4194308,4,tS.bind(null,d,l),m)},useLayoutEffect:function(l,d){return wf(4194308,4,l,d)},useInsertionEffect:function(l,d){wf(4,2,l,d)},useMemo:function(l,d){var m=ca();d=d===void 0?null:d;var x=l();if(vl){Kt(!0);try{l()}finally{Kt(!1)}}return m.memoizedState=[x,d],x},useReducer:function(l,d,m){var x=ca();if(m!==void 0){var S=m(d);if(vl){Kt(!0);try{m(d)}finally{Kt(!1)}}}else S=d;return x.memoizedState=x.baseState=S,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:S},x.queue=l,l=l.dispatch=yR.bind(null,Rt,l),[x.memoizedState,l]},useRef:function(l){var d=ca();return l={current:l},d.memoizedState=l},useState:function(l){l=H0(l);var d=l.queue,m=dS.bind(null,Rt,d);return d.dispatch=m,[l.memoizedState,m]},useDebugValue:K0,useDeferredValue:function(l,d){var m=ca();return X0(m,l,d)},useTransition:function(){var l=H0(!1);return l=oS.bind(null,Rt,l.queue,!0,!1),ca().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,d,m){var x=Rt,S=ca();if(Yt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=d(),ps===null)throw Error(n(349));(Ht&124)!==0||ON(x,d,m)}S.memoizedState=m;var j={value:m,getSnapshot:d};return S.queue=j,ZN(LN.bind(null,x,j,l),[l]),x.flags|=2048,Bc(9,vf(),FN.bind(null,x,j,m,d),null),m},useId:function(){var l=ca(),d=ps.identifierPrefix;if(Yt){var m=xo,x=go;m=(x&~(1<<32-jt(x)-1)).toString(32)+m,d=""+d+"R"+m,m=xf++,0<m&&(d+="H"+m.toString(32)),d+=""}else m=pR++,d=""+d+"r"+m.toString(32)+"";return l.memoizedState=d},useHostTransitionStatus:Z0,useFormState:HN,useActionState:HN,useOptimistic:function(l){var d=ca();d.memoizedState=d.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=m,d=Q0.bind(null,Rt,!0,m),m.dispatch=d,[l,d]},useMemoCache:U0,useCacheRefresh:function(){return ca().memoizedState=bR.bind(null,Rt)}},mS={readContext:Ln,use:bf,useCallback:nS,useContext:Ln,useEffect:QN,useImperativeHandle:sS,useInsertionEffect:JN,useLayoutEffect:eS,useMemo:aS,useReducer:yf,useRef:YN,useState:function(){return yf(vo)},useDebugValue:K0,useDeferredValue:function(l,d){var m=Ws();return rS(m,ns.memoizedState,l,d)},useTransition:function(){var l=yf(vo)[0],d=Ws().memoizedState;return[typeof l=="boolean"?l:Td(l),d]},useSyncExternalStore:_N,useId:cS,useHostTransitionStatus:Z0,useFormState:qN,useActionState:qN,useOptimistic:function(l,d){var m=Ws();return PN(m,ns,l,d)},useMemoCache:U0,useCacheRefresh:uS},vR={readContext:Ln,use:bf,useCallback:nS,useContext:Ln,useEffect:QN,useImperativeHandle:sS,useInsertionEffect:JN,useLayoutEffect:eS,useMemo:aS,useReducer:W0,useRef:YN,useState:function(){return W0(vo)},useDebugValue:K0,useDeferredValue:function(l,d){var m=Ws();return ns===null?X0(m,l,d):rS(m,ns.memoizedState,l,d)},useTransition:function(){var l=W0(vo)[0],d=Ws().memoizedState;return[typeof l=="boolean"?l:Td(l),d]},useSyncExternalStore:_N,useId:cS,useHostTransitionStatus:Z0,useFormState:XN,useActionState:XN,useOptimistic:function(l,d){var m=Ws();return ns!==null?PN(m,ns,l,d):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:U0,useCacheRefresh:uS},Vc=null,Ad=0;function Cf(l){var d=Ad;return Ad+=1,Vc===null&&(Vc=[]),jN(Vc,l,d)}function Ed(l,d){d=d.props.ref,l.ref=d!==void 0?d:null}function kf(l,d){throw d.$$typeof===f?Error(n(525)):(l=Object.prototype.toString.call(d),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l)))}function gS(l){var d=l._init;return d(l._payload)}function xS(l){function d(ge,he){if(l){var be=ge.deletions;be===null?(ge.deletions=[he],ge.flags|=16):be.push(he)}}function m(ge,he){if(!l)return null;for(;he!==null;)d(ge,he),he=he.sibling;return null}function x(ge){for(var he=new Map;ge!==null;)ge.key!==null?he.set(ge.key,ge):he.set(ge.index,ge),ge=ge.sibling;return he}function S(ge,he){return ge=mo(ge,he),ge.index=0,ge.sibling=null,ge}function j(ge,he,be){return ge.index=be,l?(be=ge.alternate,be!==null?(be=be.index,be<he?(ge.flags|=67108866,he):be):(ge.flags|=67108866,he)):(ge.flags|=1048576,he)}function M(ge){return l&&ge.alternate===null&&(ge.flags|=67108866),ge}function G(ge,he,be,Oe){return he===null||he.tag!==6?(he=y0(be,ge.mode,Oe),he.return=ge,he):(he=S(he,be),he.return=ge,he)}function ee(ge,he,be,Oe){var it=be.type;return it===y?_e(ge,he,be.props.children,Oe,be.key):he!==null&&(he.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===L&&gS(it)===he.type)?(he=S(he,be.props),Ed(he,be),he.return=ge,he):(he=of(be.type,be.key,be.props,null,ge.mode,Oe),Ed(he,be),he.return=ge,he)}function Ne(ge,he,be,Oe){return he===null||he.tag!==4||he.stateNode.containerInfo!==be.containerInfo||he.stateNode.implementation!==be.implementation?(he=v0(be,ge.mode,Oe),he.return=ge,he):(he=S(he,be.children||[]),he.return=ge,he)}function _e(ge,he,be,Oe,it){return he===null||he.tag!==7?(he=hl(be,ge.mode,Oe,it),he.return=ge,he):(he=S(he,be),he.return=ge,he)}function ze(ge,he,be){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return he=y0(""+he,ge.mode,be),he.return=ge,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case g:return be=of(he.type,he.key,he.props,null,ge.mode,be),Ed(be,he),be.return=ge,be;case b:return he=v0(he,ge.mode,be),he.return=ge,he;case L:var Oe=he._init;return he=Oe(he._payload),ze(ge,he,be)}if(q(he)||U(he))return he=hl(he,ge.mode,be,null),he.return=ge,he;if(typeof he.then=="function")return ze(ge,Cf(he),be);if(he.$$typeof===I)return ze(ge,df(ge,he),be);kf(ge,he)}return null}function Te(ge,he,be,Oe){var it=he!==null?he.key:null;if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return it!==null?null:G(ge,he,""+be,Oe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case g:return be.key===it?ee(ge,he,be,Oe):null;case b:return be.key===it?Ne(ge,he,be,Oe):null;case L:return it=be._init,be=it(be._payload),Te(ge,he,be,Oe)}if(q(be)||U(be))return it!==null?null:_e(ge,he,be,Oe,null);if(typeof be.then=="function")return Te(ge,he,Cf(be),Oe);if(be.$$typeof===I)return Te(ge,he,df(ge,be),Oe);kf(ge,be)}return null}function $e(ge,he,be,Oe,it){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return ge=ge.get(be)||null,G(he,ge,""+Oe,it);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case g:return ge=ge.get(Oe.key===null?be:Oe.key)||null,ee(he,ge,Oe,it);case b:return ge=ge.get(Oe.key===null?be:Oe.key)||null,Ne(he,ge,Oe,it);case L:var Ot=Oe._init;return Oe=Ot(Oe._payload),$e(ge,he,be,Oe,it)}if(q(Oe)||U(Oe))return ge=ge.get(be)||null,_e(he,ge,Oe,it,null);if(typeof Oe.then=="function")return $e(ge,he,be,Cf(Oe),it);if(Oe.$$typeof===I)return $e(ge,he,be,df(he,Oe),it);kf(he,Oe)}return null}function Nt(ge,he,be,Oe){for(var it=null,Ot=null,dt=he,gt=he=0,gn=null;dt!==null&&gt<be.length;gt++){dt.index>gt?(gn=dt,dt=null):gn=dt.sibling;var Xt=Te(ge,dt,be[gt],Oe);if(Xt===null){dt===null&&(dt=gn);break}l&&dt&&Xt.alternate===null&&d(ge,dt),he=j(Xt,he,gt),Ot===null?it=Xt:Ot.sibling=Xt,Ot=Xt,dt=gn}if(gt===be.length)return m(ge,dt),Yt&&fl(ge,gt),it;if(dt===null){for(;gt<be.length;gt++)dt=ze(ge,be[gt],Oe),dt!==null&&(he=j(dt,he,gt),Ot===null?it=dt:Ot.sibling=dt,Ot=dt);return Yt&&fl(ge,gt),it}for(dt=x(dt);gt<be.length;gt++)gn=$e(dt,ge,gt,be[gt],Oe),gn!==null&&(l&&gn.alternate!==null&&dt.delete(gn.key===null?gt:gn.key),he=j(gn,he,gt),Ot===null?it=gn:Ot.sibling=gn,Ot=gn);return l&&dt.forEach(function(wi){return d(ge,wi)}),Yt&&fl(ge,gt),it}function ft(ge,he,be,Oe){if(be==null)throw Error(n(151));for(var it=null,Ot=null,dt=he,gt=he=0,gn=null,Xt=be.next();dt!==null&&!Xt.done;gt++,Xt=be.next()){dt.index>gt?(gn=dt,dt=null):gn=dt.sibling;var wi=Te(ge,dt,Xt.value,Oe);if(wi===null){dt===null&&(dt=gn);break}l&&dt&&wi.alternate===null&&d(ge,dt),he=j(wi,he,gt),Ot===null?it=wi:Ot.sibling=wi,Ot=wi,dt=gn}if(Xt.done)return m(ge,dt),Yt&&fl(ge,gt),it;if(dt===null){for(;!Xt.done;gt++,Xt=be.next())Xt=ze(ge,Xt.value,Oe),Xt!==null&&(he=j(Xt,he,gt),Ot===null?it=Xt:Ot.sibling=Xt,Ot=Xt);return Yt&&fl(ge,gt),it}for(dt=x(dt);!Xt.done;gt++,Xt=be.next())Xt=$e(dt,ge,gt,Xt.value,Oe),Xt!==null&&(l&&Xt.alternate!==null&&dt.delete(Xt.key===null?gt:Xt.key),he=j(Xt,he,gt),Ot===null?it=Xt:Ot.sibling=Xt,Ot=Xt);return l&&dt.forEach(function(w6){return d(ge,w6)}),Yt&&fl(ge,gt),it}function rs(ge,he,be,Oe){if(typeof be=="object"&&be!==null&&be.type===y&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case g:e:{for(var it=be.key;he!==null;){if(he.key===it){if(it=be.type,it===y){if(he.tag===7){m(ge,he.sibling),Oe=S(he,be.props.children),Oe.return=ge,ge=Oe;break e}}else if(he.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===L&&gS(it)===he.type){m(ge,he.sibling),Oe=S(he,be.props),Ed(Oe,be),Oe.return=ge,ge=Oe;break e}m(ge,he);break}else d(ge,he);he=he.sibling}be.type===y?(Oe=hl(be.props.children,ge.mode,Oe,be.key),Oe.return=ge,ge=Oe):(Oe=of(be.type,be.key,be.props,null,ge.mode,Oe),Ed(Oe,be),Oe.return=ge,ge=Oe)}return M(ge);case b:e:{for(it=be.key;he!==null;){if(he.key===it)if(he.tag===4&&he.stateNode.containerInfo===be.containerInfo&&he.stateNode.implementation===be.implementation){m(ge,he.sibling),Oe=S(he,be.children||[]),Oe.return=ge,ge=Oe;break e}else{m(ge,he);break}else d(ge,he);he=he.sibling}Oe=v0(be,ge.mode,Oe),Oe.return=ge,ge=Oe}return M(ge);case L:return it=be._init,be=it(be._payload),rs(ge,he,be,Oe)}if(q(be))return Nt(ge,he,be,Oe);if(U(be)){if(it=U(be),typeof it!="function")throw Error(n(150));return be=it.call(be),ft(ge,he,be,Oe)}if(typeof be.then=="function")return rs(ge,he,Cf(be),Oe);if(be.$$typeof===I)return rs(ge,he,df(ge,be),Oe);kf(ge,be)}return typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint"?(be=""+be,he!==null&&he.tag===6?(m(ge,he.sibling),Oe=S(he,be),Oe.return=ge,ge=Oe):(m(ge,he),Oe=y0(be,ge.mode,Oe),Oe.return=ge,ge=Oe),M(ge)):m(ge,he)}return function(ge,he,be,Oe){try{Ad=0;var it=rs(ge,he,be,Oe);return Vc=null,it}catch(dt){if(dt===wd||dt===pf)throw dt;var Ot=ja(29,dt,null,ge.mode);return Ot.lanes=Oe,Ot.return=ge,Ot}finally{}}}var Uc=xS(!0),bS=xS(!1),Xa=we(null),Pr=null;function oi(l){var d=l.alternate;ve(ln,ln.current&1),ve(Xa,l),Pr===null&&(d===null||Mc.current!==null||d.memoizedState!==null)&&(Pr=l)}function yS(l){if(l.tag===22){if(ve(ln,ln.current),ve(Xa,l),Pr===null){var d=l.alternate;d!==null&&d.memoizedState!==null&&(Pr=l)}}else ii()}function ii(){ve(ln,ln.current),ve(Xa,Xa.current)}function wo(l){Ce(Xa),Pr===l&&(Pr=null),Ce(ln)}var ln=we(0);function jf(l){for(var d=l;d!==null;){if(d.tag===13){var m=d.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||Vb(m)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function J0(l,d,m,x){d=l.memoizedState,m=m(x,d),m=m==null?d:p({},d,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var eb={enqueueSetState:function(l,d,m){l=l._reactInternals;var x=Aa(),S=ni(x);S.payload=d,m!=null&&(S.callback=m),d=ai(l,S,x),d!==null&&(Ea(d,l,x),Sd(d,l,x))},enqueueReplaceState:function(l,d,m){l=l._reactInternals;var x=Aa(),S=ni(x);S.tag=1,S.payload=d,m!=null&&(S.callback=m),d=ai(l,S,x),d!==null&&(Ea(d,l,x),Sd(d,l,x))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var m=Aa(),x=ni(m);x.tag=2,d!=null&&(x.callback=d),d=ai(l,x,m),d!==null&&(Ea(d,l,m),Sd(d,l,m))}};function vS(l,d,m,x,S,j,M){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,j,M):d.prototype&&d.prototype.isPureReactComponent?!pd(m,x)||!pd(S,j):!0}function wS(l,d,m,x){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(m,x),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(m,x),d.state!==l&&eb.enqueueReplaceState(d,d.state,null)}function wl(l,d){var m=d;if("ref"in d){m={};for(var x in d)x!=="ref"&&(m[x]=d[x])}if(l=l.defaultProps){m===d&&(m=p({},m));for(var S in l)m[S]===void 0&&(m[S]=l[S])}return m}var Tf=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function NS(l){Tf(l)}function SS(l){console.error(l)}function CS(l){Tf(l)}function If(l,d){try{var m=l.onUncaughtError;m(d.value,{componentStack:d.stack})}catch(x){setTimeout(function(){throw x})}}function kS(l,d,m){try{var x=l.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function tb(l,d,m){return m=ni(m),m.tag=3,m.payload={element:null},m.callback=function(){If(l,d)},m}function jS(l){return l=ni(l),l.tag=3,l}function TS(l,d,m,x){var S=m.type.getDerivedStateFromError;if(typeof S=="function"){var j=x.value;l.payload=function(){return S(j)},l.callback=function(){kS(d,m,x)}}var M=m.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(l.callback=function(){kS(d,m,x),typeof S!="function"&&(pi===null?pi=new Set([this]):pi.add(this));var G=x.stack;this.componentDidCatch(x.value,{componentStack:G!==null?G:""})})}function wR(l,d,m,x,S){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(d=m.alternate,d!==null&&bd(d,m,S,!0),m=Xa.current,m!==null){switch(m.tag){case 13:return Pr===null?kb():m.alternate===null&&As===0&&(As=3),m.flags&=-257,m.flags|=65536,m.lanes=S,x===A0?m.flags|=16384:(d=m.updateQueue,d===null?m.updateQueue=new Set([x]):d.add(x),Tb(l,x,S)),!1;case 22:return m.flags|=65536,x===A0?m.flags|=16384:(d=m.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=d):(m=d.retryQueue,m===null?d.retryQueue=new Set([x]):m.add(x)),Tb(l,x,S)),!1}throw Error(n(435,m.tag))}return Tb(l,x,S),kb(),!1}if(Yt)return d=Xa.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=S,x!==S0&&(l=Error(n(422),{cause:x}),xd(Wa(l,m)))):(x!==S0&&(d=Error(n(423),{cause:x}),xd(Wa(d,m))),l=l.current.alternate,l.flags|=65536,S&=-S,l.lanes|=S,x=Wa(x,m),S=tb(l.stateNode,x,S),R0(l,S),As!==4&&(As=2)),!1;var j=Error(n(520),{cause:x});if(j=Wa(j,m),Md===null?Md=[j]:Md.push(j),As!==4&&(As=2),d===null)return!0;x=Wa(x,m),m=d;do{switch(m.tag){case 3:return m.flags|=65536,l=S&-S,m.lanes|=l,l=tb(m.stateNode,x,l),R0(m,l),!1;case 1:if(d=m.type,j=m.stateNode,(m.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(pi===null||!pi.has(j))))return m.flags|=65536,S&=-S,m.lanes|=S,S=jS(S),TS(S,l,m,x),R0(m,S),!1}m=m.return}while(m!==null);return!1}var IS=Error(n(461)),fn=!1;function jn(l,d,m,x){d.child=l===null?bS(d,null,m,x):Uc(d,l.child,m,x)}function $S(l,d,m,x,S){m=m.render;var j=d.ref;if("ref"in x){var M={};for(var G in x)G!=="ref"&&(M[G]=x[G])}else M=x;return bl(d),x=M0(l,d,m,M,j,S),G=z0(),l!==null&&!fn?(P0(l,d,S),No(l,d,S)):(Yt&&G&&w0(d),d.flags|=1,jn(l,d,x,S),d.child)}function AS(l,d,m,x,S){if(l===null){var j=m.type;return typeof j=="function"&&!b0(j)&&j.defaultProps===void 0&&m.compare===null?(d.tag=15,d.type=j,ES(l,d,j,x,S)):(l=of(m.type,null,x,d,d.mode,S),l.ref=d.ref,l.return=d,d.child=l)}if(j=l.child,!cb(l,S)){var M=j.memoizedProps;if(m=m.compare,m=m!==null?m:pd,m(M,x)&&l.ref===d.ref)return No(l,d,S)}return d.flags|=1,l=mo(j,x),l.ref=d.ref,l.return=d,d.child=l}function ES(l,d,m,x,S){if(l!==null){var j=l.memoizedProps;if(pd(j,x)&&l.ref===d.ref)if(fn=!1,d.pendingProps=x=j,cb(l,S))(l.flags&131072)!==0&&(fn=!0);else return d.lanes=l.lanes,No(l,d,S)}return sb(l,d,m,x,S)}function DS(l,d,m){var x=d.pendingProps,S=x.children,j=l!==null?l.memoizedState:null;if(x.mode==="hidden"){if((d.flags&128)!==0){if(x=j!==null?j.baseLanes|m:m,l!==null){for(S=d.child=l.child,j=0;S!==null;)j=j|S.lanes|S.childLanes,S=S.sibling;d.childLanes=j&~x}else d.childLanes=0,d.child=null;return RS(l,d,x,m)}if((m&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},l!==null&&hf(d,j!==null?j.cachePool:null),j!==null?EN(d,j):O0(),yS(d);else return d.lanes=d.childLanes=536870912,RS(l,d,j!==null?j.baseLanes|m:m,m)}else j!==null?(hf(d,j.cachePool),EN(d,j),ii(),d.memoizedState=null):(l!==null&&hf(d,null),O0(),ii());return jn(l,d,S,m),d.child}function RS(l,d,m,x){var S=$0();return S=S===null?null:{parent:on._currentValue,pool:S},d.memoizedState={baseLanes:m,cachePool:S},l!==null&&hf(d,null),O0(),yS(d),l!==null&&bd(l,d,x,!0),null}function $f(l,d){var m=d.ref;if(m===null)l!==null&&l.ref!==null&&(d.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(l===null||l.ref!==m)&&(d.flags|=4194816)}}function sb(l,d,m,x,S){return bl(d),m=M0(l,d,m,x,void 0,S),x=z0(),l!==null&&!fn?(P0(l,d,S),No(l,d,S)):(Yt&&x&&w0(d),d.flags|=1,jn(l,d,m,S),d.child)}function _S(l,d,m,x,S,j){return bl(d),d.updateQueue=null,m=RN(d,x,m,S),DN(l),x=z0(),l!==null&&!fn?(P0(l,d,j),No(l,d,j)):(Yt&&x&&w0(d),d.flags|=1,jn(l,d,m,j),d.child)}function OS(l,d,m,x,S){if(bl(d),d.stateNode===null){var j=Rc,M=m.contextType;typeof M=="object"&&M!==null&&(j=Ln(M)),j=new m(x,j),d.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=eb,d.stateNode=j,j._reactInternals=d,j=d.stateNode,j.props=x,j.state=d.memoizedState,j.refs={},E0(d),M=m.contextType,j.context=typeof M=="object"&&M!==null?Ln(M):Rc,j.state=d.memoizedState,M=m.getDerivedStateFromProps,typeof M=="function"&&(J0(d,m,M,x),j.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(M=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),M!==j.state&&eb.enqueueReplaceState(j,j.state,null),kd(d,x,j,S),Cd(),j.state=d.memoizedState),typeof j.componentDidMount=="function"&&(d.flags|=4194308),x=!0}else if(l===null){j=d.stateNode;var G=d.memoizedProps,ee=wl(m,G);j.props=ee;var Ne=j.context,_e=m.contextType;M=Rc,typeof _e=="object"&&_e!==null&&(M=Ln(_e));var ze=m.getDerivedStateFromProps;_e=typeof ze=="function"||typeof j.getSnapshotBeforeUpdate=="function",G=d.pendingProps!==G,_e||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(G||Ne!==M)&&wS(d,j,x,M),si=!1;var Te=d.memoizedState;j.state=Te,kd(d,x,j,S),Cd(),Ne=d.memoizedState,G||Te!==Ne||si?(typeof ze=="function"&&(J0(d,m,ze,x),Ne=d.memoizedState),(ee=si||vS(d,m,ee,x,Te,Ne,M))?(_e||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(d.flags|=4194308)):(typeof j.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=x,d.memoizedState=Ne),j.props=x,j.state=Ne,j.context=M,x=ee):(typeof j.componentDidMount=="function"&&(d.flags|=4194308),x=!1)}else{j=d.stateNode,D0(l,d),M=d.memoizedProps,_e=wl(m,M),j.props=_e,ze=d.pendingProps,Te=j.context,Ne=m.contextType,ee=Rc,typeof Ne=="object"&&Ne!==null&&(ee=Ln(Ne)),G=m.getDerivedStateFromProps,(Ne=typeof G=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(M!==ze||Te!==ee)&&wS(d,j,x,ee),si=!1,Te=d.memoizedState,j.state=Te,kd(d,x,j,S),Cd();var $e=d.memoizedState;M!==ze||Te!==$e||si||l!==null&&l.dependencies!==null&&uf(l.dependencies)?(typeof G=="function"&&(J0(d,m,G,x),$e=d.memoizedState),(_e=si||vS(d,m,_e,x,Te,$e,ee)||l!==null&&l.dependencies!==null&&uf(l.dependencies))?(Ne||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(x,$e,ee),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(x,$e,ee)),typeof j.componentDidUpdate=="function"&&(d.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof j.componentDidUpdate!="function"||M===l.memoizedProps&&Te===l.memoizedState||(d.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&Te===l.memoizedState||(d.flags|=1024),d.memoizedProps=x,d.memoizedState=$e),j.props=x,j.state=$e,j.context=ee,x=_e):(typeof j.componentDidUpdate!="function"||M===l.memoizedProps&&Te===l.memoizedState||(d.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&Te===l.memoizedState||(d.flags|=1024),x=!1)}return j=x,$f(l,d),x=(d.flags&128)!==0,j||x?(j=d.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:j.render(),d.flags|=1,l!==null&&x?(d.child=Uc(d,l.child,null,S),d.child=Uc(d,null,m,S)):jn(l,d,m,S),d.memoizedState=j.state,l=d.child):l=No(l,d,S),l}function FS(l,d,m,x){return gd(),d.flags|=256,jn(l,d,m,x),d.child}var nb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ab(l){return{baseLanes:l,cachePool:SN()}}function rb(l,d,m){return l=l!==null?l.childLanes&~m:0,d&&(l|=Ya),l}function LS(l,d,m){var x=d.pendingProps,S=!1,j=(d.flags&128)!==0,M;if((M=j)||(M=l!==null&&l.memoizedState===null?!1:(ln.current&2)!==0),M&&(S=!0,d.flags&=-129),M=(d.flags&32)!==0,d.flags&=-33,l===null){if(Yt){if(S?oi(d):ii(),Yt){var G=$s,ee;if(ee=G){e:{for(ee=G,G=zr;ee.nodeType!==8;){if(!G){G=null;break e}if(ee=xr(ee.nextSibling),ee===null){G=null;break e}}G=ee}G!==null?(d.memoizedState={dehydrated:G,treeContext:pl!==null?{id:go,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},ee=ja(18,null,null,0),ee.stateNode=G,ee.return=d,d.child=ee,Yn=d,$s=null,ee=!0):ee=!1}ee||gl(d)}if(G=d.memoizedState,G!==null&&(G=G.dehydrated,G!==null))return Vb(G)?d.lanes=32:d.lanes=536870912,null;wo(d)}return G=x.children,x=x.fallback,S?(ii(),S=d.mode,G=Af({mode:"hidden",children:G},S),x=hl(x,S,m,null),G.return=d,x.return=d,G.sibling=x,d.child=G,S=d.child,S.memoizedState=ab(m),S.childLanes=rb(l,M,m),d.memoizedState=nb,x):(oi(d),ob(d,G))}if(ee=l.memoizedState,ee!==null&&(G=ee.dehydrated,G!==null)){if(j)d.flags&256?(oi(d),d.flags&=-257,d=ib(l,d,m)):d.memoizedState!==null?(ii(),d.child=l.child,d.flags|=128,d=null):(ii(),S=x.fallback,G=d.mode,x=Af({mode:"visible",children:x.children},G),S=hl(S,G,m,null),S.flags|=2,x.return=d,S.return=d,x.sibling=S,d.child=x,Uc(d,l.child,null,m),x=d.child,x.memoizedState=ab(m),x.childLanes=rb(l,M,m),d.memoizedState=nb,d=S);else if(oi(d),Vb(G)){if(M=G.nextSibling&&G.nextSibling.dataset,M)var Ne=M.dgst;M=Ne,x=Error(n(419)),x.stack="",x.digest=M,xd({value:x,source:null,stack:null}),d=ib(l,d,m)}else if(fn||bd(l,d,m,!1),M=(m&l.childLanes)!==0,fn||M){if(M=ps,M!==null&&(x=m&-m,x=(x&42)!==0?1:Or(x),x=(x&(M.suspendedLanes|m))!==0?0:x,x!==0&&x!==ee.retryLane))throw ee.retryLane=x,Dc(l,x),Ea(M,l,x),IS;G.data==="$?"||kb(),d=ib(l,d,m)}else G.data==="$?"?(d.flags|=192,d.child=l.child,d=null):(l=ee.treeContext,$s=xr(G.nextSibling),Yn=d,Yt=!0,ml=null,zr=!1,l!==null&&(qa[Ka++]=go,qa[Ka++]=xo,qa[Ka++]=pl,go=l.id,xo=l.overflow,pl=d),d=ob(d,x.children),d.flags|=4096);return d}return S?(ii(),S=x.fallback,G=d.mode,ee=l.child,Ne=ee.sibling,x=mo(ee,{mode:"hidden",children:x.children}),x.subtreeFlags=ee.subtreeFlags&65011712,Ne!==null?S=mo(Ne,S):(S=hl(S,G,m,null),S.flags|=2),S.return=d,x.return=d,x.sibling=S,d.child=x,x=S,S=d.child,G=l.child.memoizedState,G===null?G=ab(m):(ee=G.cachePool,ee!==null?(Ne=on._currentValue,ee=ee.parent!==Ne?{parent:Ne,pool:Ne}:ee):ee=SN(),G={baseLanes:G.baseLanes|m,cachePool:ee}),S.memoizedState=G,S.childLanes=rb(l,M,m),d.memoizedState=nb,x):(oi(d),m=l.child,l=m.sibling,m=mo(m,{mode:"visible",children:x.children}),m.return=d,m.sibling=null,l!==null&&(M=d.deletions,M===null?(d.deletions=[l],d.flags|=16):M.push(l)),d.child=m,d.memoizedState=null,m)}function ob(l,d){return d=Af({mode:"visible",children:d},l.mode),d.return=l,l.child=d}function Af(l,d){return l=ja(22,l,null,d),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function ib(l,d,m){return Uc(d,l.child,null,m),l=ob(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function MS(l,d,m){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d),k0(l.return,d,m)}function lb(l,d,m,x,S){var j=l.memoizedState;j===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:S}:(j.isBackwards=d,j.rendering=null,j.renderingStartTime=0,j.last=x,j.tail=m,j.tailMode=S)}function zS(l,d,m){var x=d.pendingProps,S=x.revealOrder,j=x.tail;if(jn(l,d,x.children,m),x=ln.current,(x&2)!==0)x=x&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&MS(l,m,d);else if(l.tag===19)MS(l,m,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}switch(ve(ln,x),S){case"forwards":for(m=d.child,S=null;m!==null;)l=m.alternate,l!==null&&jf(l)===null&&(S=m),m=m.sibling;m=S,m===null?(S=d.child,d.child=null):(S=m.sibling,m.sibling=null),lb(d,!1,S,m,j);break;case"backwards":for(m=null,S=d.child,d.child=null;S!==null;){if(l=S.alternate,l!==null&&jf(l)===null){d.child=S;break}l=S.sibling,S.sibling=m,m=S,S=l}lb(d,!0,m,null,j);break;case"together":lb(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function No(l,d,m){if(l!==null&&(d.dependencies=l.dependencies),hi|=d.lanes,(m&d.childLanes)===0)if(l!==null){if(bd(l,d,m,!1),(m&d.childLanes)===0)return null}else return null;if(l!==null&&d.child!==l.child)throw Error(n(153));if(d.child!==null){for(l=d.child,m=mo(l,l.pendingProps),d.child=m,m.return=d;l.sibling!==null;)l=l.sibling,m=m.sibling=mo(l,l.pendingProps),m.return=d;m.sibling=null}return d.child}function cb(l,d){return(l.lanes&d)!==0?!0:(l=l.dependencies,!!(l!==null&&uf(l)))}function NR(l,d,m){switch(d.tag){case 3:Y(d,d.stateNode.containerInfo),ti(d,on,l.memoizedState.cache),gd();break;case 27:case 5:re(d);break;case 4:Y(d,d.stateNode.containerInfo);break;case 10:ti(d,d.type,d.memoizedProps.value);break;case 13:var x=d.memoizedState;if(x!==null)return x.dehydrated!==null?(oi(d),d.flags|=128,null):(m&d.child.childLanes)!==0?LS(l,d,m):(oi(d),l=No(l,d,m),l!==null?l.sibling:null);oi(d);break;case 19:var S=(l.flags&128)!==0;if(x=(m&d.childLanes)!==0,x||(bd(l,d,m,!1),x=(m&d.childLanes)!==0),S){if(x)return zS(l,d,m);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),ve(ln,ln.current),x)break;return null;case 22:case 23:return d.lanes=0,DS(l,d,m);case 24:ti(d,on,l.memoizedState.cache)}return No(l,d,m)}function PS(l,d,m){if(l!==null)if(l.memoizedProps!==d.pendingProps)fn=!0;else{if(!cb(l,m)&&(d.flags&128)===0)return fn=!1,NR(l,d,m);fn=(l.flags&131072)!==0}else fn=!1,Yt&&(d.flags&1048576)!==0&&gN(d,cf,d.index);switch(d.lanes=0,d.tag){case 16:e:{l=d.pendingProps;var x=d.elementType,S=x._init;if(x=S(x._payload),d.type=x,typeof x=="function")b0(x)?(l=wl(x,l),d.tag=1,d=OS(null,d,x,l,m)):(d.tag=0,d=sb(null,d,x,l,m));else{if(x!=null){if(S=x.$$typeof,S===T){d.tag=11,d=$S(null,d,x,l,m);break e}else if(S===_){d.tag=14,d=AS(null,d,x,l,m);break e}}throw d=Z(x)||x,Error(n(306,d,""))}}return d;case 0:return sb(l,d,d.type,d.pendingProps,m);case 1:return x=d.type,S=wl(x,d.pendingProps),OS(l,d,x,S,m);case 3:e:{if(Y(d,d.stateNode.containerInfo),l===null)throw Error(n(387));x=d.pendingProps;var j=d.memoizedState;S=j.element,D0(l,d),kd(d,x,null,m);var M=d.memoizedState;if(x=M.cache,ti(d,on,x),x!==j.cache&&j0(d,[on],m,!0),Cd(),x=M.element,j.isDehydrated)if(j={element:x,isDehydrated:!1,cache:M.cache},d.updateQueue.baseState=j,d.memoizedState=j,d.flags&256){d=FS(l,d,x,m);break e}else if(x!==S){S=Wa(Error(n(424)),d),xd(S),d=FS(l,d,x,m);break e}else{switch(l=d.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for($s=xr(l.firstChild),Yn=d,Yt=!0,ml=null,zr=!0,m=bS(d,null,x,m),d.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(gd(),x===S){d=No(l,d,m);break e}jn(l,d,x,m)}d=d.child}return d;case 26:return $f(l,d),l===null?(m=G3(d.type,null,d.pendingProps,null))?d.memoizedState=m:Yt||(m=d.type,l=d.pendingProps,x=Gf(ue.current).createElement(m),x[Ss]=d,x[Cs]=l,In(x,m,l),Us(x),d.stateNode=x):d.memoizedState=G3(d.type,l.memoizedProps,d.pendingProps,l.memoizedState),null;case 27:return re(d),l===null&&Yt&&(x=d.stateNode=B3(d.type,d.pendingProps,ue.current),Yn=d,zr=!0,S=$s,gi(d.type)?(Ub=S,$s=xr(x.firstChild)):$s=S),jn(l,d,d.pendingProps.children,m),$f(l,d),l===null&&(d.flags|=4194304),d.child;case 5:return l===null&&Yt&&((S=x=$s)&&(x=YR(x,d.type,d.pendingProps,zr),x!==null?(d.stateNode=x,Yn=d,$s=xr(x.firstChild),zr=!1,S=!0):S=!1),S||gl(d)),re(d),S=d.type,j=d.pendingProps,M=l!==null?l.memoizedProps:null,x=j.children,zb(S,j)?x=null:M!==null&&zb(S,M)&&(d.flags|=32),d.memoizedState!==null&&(S=M0(l,d,fR,null,null,m),qd._currentValue=S),$f(l,d),jn(l,d,x,m),d.child;case 6:return l===null&&Yt&&((l=m=$s)&&(m=ZR(m,d.pendingProps,zr),m!==null?(d.stateNode=m,Yn=d,$s=null,l=!0):l=!1),l||gl(d)),null;case 13:return LS(l,d,m);case 4:return Y(d,d.stateNode.containerInfo),x=d.pendingProps,l===null?d.child=Uc(d,null,x,m):jn(l,d,x,m),d.child;case 11:return $S(l,d,d.type,d.pendingProps,m);case 7:return jn(l,d,d.pendingProps,m),d.child;case 8:return jn(l,d,d.pendingProps.children,m),d.child;case 12:return jn(l,d,d.pendingProps.children,m),d.child;case 10:return x=d.pendingProps,ti(d,d.type,x.value),jn(l,d,x.children,m),d.child;case 9:return S=d.type._context,x=d.pendingProps.children,bl(d),S=Ln(S),x=x(S),d.flags|=1,jn(l,d,x,m),d.child;case 14:return AS(l,d,d.type,d.pendingProps,m);case 15:return ES(l,d,d.type,d.pendingProps,m);case 19:return zS(l,d,m);case 31:return x=d.pendingProps,m=d.mode,x={mode:x.mode,children:x.children},l===null?(m=Af(x,m),m.ref=d.ref,d.child=m,m.return=d,d=m):(m=mo(l.child,x),m.ref=d.ref,d.child=m,m.return=d,d=m),d;case 22:return DS(l,d,m);case 24:return bl(d),x=Ln(on),l===null?(S=$0(),S===null&&(S=ps,j=T0(),S.pooledCache=j,j.refCount++,j!==null&&(S.pooledCacheLanes|=m),S=j),d.memoizedState={parent:x,cache:S},E0(d),ti(d,on,S)):((l.lanes&m)!==0&&(D0(l,d),kd(d,null,null,m),Cd()),S=l.memoizedState,j=d.memoizedState,S.parent!==x?(S={parent:x,cache:x},d.memoizedState=S,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=S),ti(d,on,x)):(x=j.cache,ti(d,on,x),x!==S.cache&&j0(d,[on],m,!0))),jn(l,d,d.pendingProps.children,m),d.child;case 29:throw d.pendingProps}throw Error(n(156,d.tag))}function So(l){l.flags|=4}function BS(l,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!X3(d)){if(d=Xa.current,d!==null&&((Ht&4194048)===Ht?Pr!==null:(Ht&62914560)!==Ht&&(Ht&536870912)===0||d!==Pr))throw Nd=A0,CN;l.flags|=8192}}function Ef(l,d){d!==null&&(l.flags|=4),l.flags&16384&&(d=l.tag!==22?nl():536870912,l.lanes|=d,qc|=d)}function Dd(l,d){if(!Yt)switch(l.tailMode){case"hidden":d=l.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function ks(l){var d=l.alternate!==null&&l.alternate.child===l.child,m=0,x=0;if(d)for(var S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=x,l.childLanes=m,d}function SR(l,d,m){var x=d.pendingProps;switch(N0(d),d.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ks(d),null;case 1:return ks(d),null;case 3:return m=d.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),d.memoizedState.cache!==x&&(d.flags|=2048),yo(on),ce(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(md(d)?So(d):l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,yN())),ks(d),null;case 26:return m=d.memoizedState,l===null?(So(d),m!==null?(ks(d),BS(d,m)):(ks(d),d.flags&=-16777217)):m?m!==l.memoizedState?(So(d),ks(d),BS(d,m)):(ks(d),d.flags&=-16777217):(l.memoizedProps!==x&&So(d),ks(d),d.flags&=-16777217),null;case 27:ke(d),m=ue.current;var S=d.type;if(l!==null&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(!x){if(d.stateNode===null)throw Error(n(166));return ks(d),null}l=pe.current,md(d)?xN(d):(l=B3(S,x,m),d.stateNode=l,So(d))}return ks(d),null;case 5:if(ke(d),m=d.type,l!==null&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(!x){if(d.stateNode===null)throw Error(n(166));return ks(d),null}if(l=pe.current,md(d))xN(d);else{switch(S=Gf(ue.current),l){case 1:l=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:l=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":l=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":l=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":l=S.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof x.is=="string"?S.createElement("select",{is:x.is}):S.createElement("select"),x.multiple?l.multiple=!0:x.size&&(l.size=x.size);break;default:l=typeof x.is=="string"?S.createElement(m,{is:x.is}):S.createElement(m)}}l[Ss]=d,l[Cs]=x;e:for(S=d.child;S!==null;){if(S.tag===5||S.tag===6)l.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===d)break e;for(;S.sibling===null;){if(S.return===null||S.return===d)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}d.stateNode=l;e:switch(In(l,m,x),m){case"button":case"input":case"select":case"textarea":l=!!x.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&So(d)}}return ks(d),d.flags&=-16777217,null;case 6:if(l&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(typeof x!="string"&&d.stateNode===null)throw Error(n(166));if(l=ue.current,md(d)){if(l=d.stateNode,m=d.memoizedProps,x=null,S=Yn,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}l[Ss]=d,l=!!(l.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||_3(l.nodeValue,m)),l||gl(d)}else l=Gf(l).createTextNode(x),l[Ss]=d,d.stateNode=l}return ks(d),null;case 13:if(x=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(S=md(d),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=d.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Ss]=d}else gd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ks(d),S=!1}else S=yN(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=S),S=!0;if(!S)return d.flags&256?(wo(d),d):(wo(d),null)}if(wo(d),(d.flags&128)!==0)return d.lanes=m,d;if(m=x!==null,l=l!==null&&l.memoizedState!==null,m){x=d.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool);var j=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(j=x.memoizedState.cachePool.pool),j!==S&&(x.flags|=2048)}return m!==l&&m&&(d.child.flags|=8192),Ef(d,d.updateQueue),ks(d),null;case 4:return ce(),l===null&&_b(d.stateNode.containerInfo),ks(d),null;case 10:return yo(d.type),ks(d),null;case 19:if(Ce(ln),S=d.memoizedState,S===null)return ks(d),null;if(x=(d.flags&128)!==0,j=S.rendering,j===null)if(x)Dd(S,!1);else{if(As!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(j=jf(l),j!==null){for(d.flags|=128,Dd(S,!1),l=j.updateQueue,d.updateQueue=l,Ef(d,l),d.subtreeFlags=0,l=m,m=d.child;m!==null;)mN(m,l),m=m.sibling;return ve(ln,ln.current&1|2),d.child}l=l.sibling}S.tail!==null&&Xe()>_f&&(d.flags|=128,x=!0,Dd(S,!1),d.lanes=4194304)}else{if(!x)if(l=jf(j),l!==null){if(d.flags|=128,x=!0,l=l.updateQueue,d.updateQueue=l,Ef(d,l),Dd(S,!0),S.tail===null&&S.tailMode==="hidden"&&!j.alternate&&!Yt)return ks(d),null}else 2*Xe()-S.renderingStartTime>_f&&m!==536870912&&(d.flags|=128,x=!0,Dd(S,!1),d.lanes=4194304);S.isBackwards?(j.sibling=d.child,d.child=j):(l=S.last,l!==null?l.sibling=j:d.child=j,S.last=j)}return S.tail!==null?(d=S.tail,S.rendering=d,S.tail=d.sibling,S.renderingStartTime=Xe(),d.sibling=null,l=ln.current,ve(ln,x?l&1|2:l&1),d):(ks(d),null);case 22:case 23:return wo(d),F0(),x=d.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(d.flags|=8192):x&&(d.flags|=8192),x?(m&536870912)!==0&&(d.flags&128)===0&&(ks(d),d.subtreeFlags&6&&(d.flags|=8192)):ks(d),m=d.updateQueue,m!==null&&Ef(d,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==m&&(d.flags|=2048),l!==null&&Ce(yl),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),d.memoizedState.cache!==m&&(d.flags|=2048),yo(on),ks(d),null;case 25:return null;case 30:return null}throw Error(n(156,d.tag))}function CR(l,d){switch(N0(d),d.tag){case 1:return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return yo(on),ce(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 26:case 27:case 5:return ke(d),null;case 13:if(wo(d),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(n(340));gd()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return Ce(ln),null;case 4:return ce(),null;case 10:return yo(d.type),null;case 22:case 23:return wo(d),F0(),l!==null&&Ce(yl),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 24:return yo(on),null;case 25:return null;default:return null}}function VS(l,d){switch(N0(d),d.tag){case 3:yo(on),ce();break;case 26:case 27:case 5:ke(d);break;case 4:ce();break;case 13:wo(d);break;case 19:Ce(ln);break;case 10:yo(d.type);break;case 22:case 23:wo(d),F0(),l!==null&&Ce(yl);break;case 24:yo(on)}}function Rd(l,d){try{var m=d.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var S=x.next;m=S;do{if((m.tag&l)===l){x=void 0;var j=m.create,M=m.inst;x=j(),M.destroy=x}m=m.next}while(m!==S)}}catch(G){us(d,d.return,G)}}function li(l,d,m){try{var x=d.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var j=S.next;x=j;do{if((x.tag&l)===l){var M=x.inst,G=M.destroy;if(G!==void 0){M.destroy=void 0,S=d;var ee=m,Ne=G;try{Ne()}catch(_e){us(S,ee,_e)}}}x=x.next}while(x!==j)}}catch(_e){us(d,d.return,_e)}}function US(l){var d=l.updateQueue;if(d!==null){var m=l.stateNode;try{AN(d,m)}catch(x){us(l,l.return,x)}}}function GS(l,d,m){m.props=wl(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(x){us(l,d,x)}}function _d(l,d){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof m=="function"?l.refCleanup=m(x):m.current=x}}catch(S){us(l,d,S)}}function Br(l,d){var m=l.ref,x=l.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(S){us(l,d,S)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(S){us(l,d,S)}else m.current=null}function WS(l){var d=l.type,m=l.memoizedProps,x=l.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break e;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(S){us(l,l.return,S)}}function ub(l,d,m){try{var x=l.stateNode;WR(x,l.type,m,d),x[Cs]=d}catch(S){us(l,l.return,S)}}function HS(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&gi(l.type)||l.tag===4}function db(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||HS(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&gi(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function hb(l,d,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,d):(d=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,d.appendChild(l),m=m._reactRootContainer,m!=null||d.onclick!==null||(d.onclick=Uf));else if(x!==4&&(x===27&&gi(l.type)&&(m=l.stateNode,d=null),l=l.child,l!==null))for(hb(l,d,m),l=l.sibling;l!==null;)hb(l,d,m),l=l.sibling}function Df(l,d,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?m.insertBefore(l,d):m.appendChild(l);else if(x!==4&&(x===27&&gi(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(Df(l,d,m),l=l.sibling;l!==null;)Df(l,d,m),l=l.sibling}function qS(l){var d=l.stateNode,m=l.memoizedProps;try{for(var x=l.type,S=d.attributes;S.length;)d.removeAttributeNode(S[0]);In(d,x,m),d[Ss]=l,d[Cs]=m}catch(j){us(l,l.return,j)}}var Co=!1,Ps=!1,pb=!1,KS=typeof WeakSet=="function"?WeakSet:Set,mn=null;function kR(l,d){if(l=l.containerInfo,Lb=Yf,l=rN(l),d0(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var S=x.anchorOffset,j=x.focusNode;x=x.focusOffset;try{m.nodeType,j.nodeType}catch(ft){m=null;break e}var M=0,G=-1,ee=-1,Ne=0,_e=0,ze=l,Te=null;t:for(;;){for(var $e;ze!==m||S!==0&&ze.nodeType!==3||(G=M+S),ze!==j||x!==0&&ze.nodeType!==3||(ee=M+x),ze.nodeType===3&&(M+=ze.nodeValue.length),($e=ze.firstChild)!==null;)Te=ze,ze=$e;for(;;){if(ze===l)break t;if(Te===m&&++Ne===S&&(G=M),Te===j&&++_e===x&&(ee=M),($e=ze.nextSibling)!==null)break;ze=Te,Te=ze.parentNode}ze=$e}m=G===-1||ee===-1?null:{start:G,end:ee}}else m=null}m=m||{start:0,end:0}}else m=null;for(Mb={focusedElem:l,selectionRange:m},Yf=!1,mn=d;mn!==null;)if(d=mn,l=d.child,(d.subtreeFlags&1024)!==0&&l!==null)l.return=d,mn=l;else for(;mn!==null;){switch(d=mn,j=d.alternate,l=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&j!==null){l=void 0,m=d,S=j.memoizedProps,j=j.memoizedState,x=m.stateNode;try{var Nt=wl(m.type,S,m.elementType===m.type);l=x.getSnapshotBeforeUpdate(Nt,j),x.__reactInternalSnapshotBeforeUpdate=l}catch(ft){us(m,m.return,ft)}}break;case 3:if((l&1024)!==0){if(l=d.stateNode.containerInfo,m=l.nodeType,m===9)Bb(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Bb(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=d.sibling,l!==null){l.return=d.return,mn=l;break}mn=d.return}}function XS(l,d,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:ci(l,m),x&4&&Rd(5,m);break;case 1:if(ci(l,m),x&4)if(l=m.stateNode,d===null)try{l.componentDidMount()}catch(M){us(m,m.return,M)}else{var S=wl(m.type,d.memoizedProps);d=d.memoizedState;try{l.componentDidUpdate(S,d,l.__reactInternalSnapshotBeforeUpdate)}catch(M){us(m,m.return,M)}}x&64&&US(m),x&512&&_d(m,m.return);break;case 3:if(ci(l,m),x&64&&(l=m.updateQueue,l!==null)){if(d=null,m.child!==null)switch(m.child.tag){case 27:case 5:d=m.child.stateNode;break;case 1:d=m.child.stateNode}try{AN(l,d)}catch(M){us(m,m.return,M)}}break;case 27:d===null&&x&4&&qS(m);case 26:case 5:ci(l,m),d===null&&x&4&&WS(m),x&512&&_d(m,m.return);break;case 12:ci(l,m);break;case 13:ci(l,m),x&4&&QS(l,m),x&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=_R.bind(null,m),QR(l,m))));break;case 22:if(x=m.memoizedState!==null||Co,!x){d=d!==null&&d.memoizedState!==null||Ps,S=Co;var j=Ps;Co=x,(Ps=d)&&!j?ui(l,m,(m.subtreeFlags&8772)!==0):ci(l,m),Co=S,Ps=j}break;case 30:break;default:ci(l,m)}}function YS(l){var d=l.alternate;d!==null&&(l.alternate=null,YS(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&dc(d)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var bs=null,ua=!1;function ko(l,d,m){for(m=m.child;m!==null;)ZS(l,d,m),m=m.sibling}function ZS(l,d,m){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Dt,m)}catch(j){}switch(m.tag){case 26:Ps||Br(m,d),ko(l,d,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Ps||Br(m,d);var x=bs,S=ua;gi(m.type)&&(bs=m.stateNode,ua=!1),ko(l,d,m),Ud(m.stateNode),bs=x,ua=S;break;case 5:Ps||Br(m,d);case 6:if(x=bs,S=ua,bs=null,ko(l,d,m),bs=x,ua=S,bs!==null)if(ua)try{(bs.nodeType===9?bs.body:bs.nodeName==="HTML"?bs.ownerDocument.body:bs).removeChild(m.stateNode)}catch(j){us(m,d,j)}else try{bs.removeChild(m.stateNode)}catch(j){us(m,d,j)}break;case 18:bs!==null&&(ua?(l=bs,z3(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),Zd(l)):z3(bs,m.stateNode));break;case 4:x=bs,S=ua,bs=m.stateNode.containerInfo,ua=!0,ko(l,d,m),bs=x,ua=S;break;case 0:case 11:case 14:case 15:Ps||li(2,m,d),Ps||li(4,m,d),ko(l,d,m);break;case 1:Ps||(Br(m,d),x=m.stateNode,typeof x.componentWillUnmount=="function"&&GS(m,d,x)),ko(l,d,m);break;case 21:ko(l,d,m);break;case 22:Ps=(x=Ps)||m.memoizedState!==null,ko(l,d,m),Ps=x;break;default:ko(l,d,m)}}function QS(l,d){if(d.memoizedState===null&&(l=d.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Zd(l)}catch(m){us(d,d.return,m)}}function jR(l){switch(l.tag){case 13:case 19:var d=l.stateNode;return d===null&&(d=l.stateNode=new KS),d;case 22:return l=l.stateNode,d=l._retryCache,d===null&&(d=l._retryCache=new KS),d;default:throw Error(n(435,l.tag))}}function fb(l,d){var m=jR(l);d.forEach(function(x){var S=OR.bind(null,l,x);m.has(x)||(m.add(x),x.then(S,S))})}function Ta(l,d){var m=d.deletions;if(m!==null)for(var x=0;x<m.length;x++){var S=m[x],j=l,M=d,G=M;e:for(;G!==null;){switch(G.tag){case 27:if(gi(G.type)){bs=G.stateNode,ua=!1;break e}break;case 5:bs=G.stateNode,ua=!1;break e;case 3:case 4:bs=G.stateNode.containerInfo,ua=!0;break e}G=G.return}if(bs===null)throw Error(n(160));ZS(j,M,S),bs=null,ua=!1,j=S.alternate,j!==null&&(j.return=null),S.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)JS(d,l),d=d.sibling}var gr=null;function JS(l,d){var m=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Ta(d,l),Ia(l),x&4&&(li(3,l,l.return),Rd(3,l),li(5,l,l.return));break;case 1:Ta(d,l),Ia(l),x&512&&(Ps||m===null||Br(m,m.return)),x&64&&Co&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var S=gr;if(Ta(d,l),Ia(l),x&512&&(Ps||m===null||Br(m,m.return)),x&4){var j=m!==null?m.memoizedState:null;if(x=l.memoizedState,m===null)if(x===null)if(l.stateNode===null){e:{x=l.type,m=l.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":j=S.getElementsByTagName("title")[0],(!j||j[Fr]||j[Ss]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=S.createElement(x),S.head.insertBefore(j,S.querySelector("head > title"))),In(j,x,m),j[Ss]=l,Us(j),x=j;break e;case"link":var M=q3("link","href",S).get(x+(m.href||""));if(M){for(var G=0;G<M.length;G++)if(j=M[G],j.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&j.getAttribute("rel")===(m.rel==null?null:m.rel)&&j.getAttribute("title")===(m.title==null?null:m.title)&&j.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){M.splice(G,1);break t}}j=S.createElement(x),In(j,x,m),S.head.appendChild(j);break;case"meta":if(M=q3("meta","content",S).get(x+(m.content||""))){for(G=0;G<M.length;G++)if(j=M[G],j.getAttribute("content")===(m.content==null?null:""+m.content)&&j.getAttribute("name")===(m.name==null?null:m.name)&&j.getAttribute("property")===(m.property==null?null:m.property)&&j.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&j.getAttribute("charset")===(m.charSet==null?null:m.charSet)){M.splice(G,1);break t}}j=S.createElement(x),In(j,x,m),S.head.appendChild(j);break;default:throw Error(n(468,x))}j[Ss]=l,Us(j),x=j}l.stateNode=x}else K3(S,l.type,l.stateNode);else l.stateNode=H3(S,x,l.memoizedProps);else j!==x?(j===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):j.count--,x===null?K3(S,l.type,l.stateNode):H3(S,x,l.memoizedProps)):x===null&&l.stateNode!==null&&ub(l,l.memoizedProps,m.memoizedProps)}break;case 27:Ta(d,l),Ia(l),x&512&&(Ps||m===null||Br(m,m.return)),m!==null&&x&4&&ub(l,l.memoizedProps,m.memoizedProps);break;case 5:if(Ta(d,l),Ia(l),x&512&&(Ps||m===null||Br(m,m.return)),l.flags&32){S=l.stateNode;try{Zo(S,"")}catch($e){us(l,l.return,$e)}}x&4&&l.stateNode!=null&&(S=l.memoizedProps,ub(l,S,m!==null?m.memoizedProps:S)),x&1024&&(pb=!0);break;case 6:if(Ta(d,l),Ia(l),x&4){if(l.stateNode===null)throw Error(n(162));x=l.memoizedProps,m=l.stateNode;try{m.nodeValue=x}catch($e){us(l,l.return,$e)}}break;case 3:if(qf=null,S=gr,gr=Wf(d.containerInfo),Ta(d,l),gr=S,Ia(l),x&4&&m!==null&&m.memoizedState.isDehydrated)try{Zd(d.containerInfo)}catch($e){us(l,l.return,$e)}pb&&(pb=!1,e3(l));break;case 4:x=gr,gr=Wf(l.stateNode.containerInfo),Ta(d,l),Ia(l),gr=x;break;case 12:Ta(d,l),Ia(l);break;case 13:Ta(d,l),Ia(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(vb=Xe()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,fb(l,x)));break;case 22:S=l.memoizedState!==null;var ee=m!==null&&m.memoizedState!==null,Ne=Co,_e=Ps;if(Co=Ne||S,Ps=_e||ee,Ta(d,l),Ps=_e,Co=Ne,Ia(l),x&8192)e:for(d=l.stateNode,d._visibility=S?d._visibility&-2:d._visibility|1,S&&(m===null||ee||Co||Ps||Nl(l)),m=null,d=l;;){if(d.tag===5||d.tag===26){if(m===null){ee=m=d;try{if(j=ee.stateNode,S)M=j.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{G=ee.stateNode;var ze=ee.memoizedProps.style,Te=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;G.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch($e){us(ee,ee.return,$e)}}}else if(d.tag===6){if(m===null){ee=d;try{ee.stateNode.nodeValue=S?"":ee.memoizedProps}catch($e){us(ee,ee.return,$e)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===l)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break e;for(;d.sibling===null;){if(d.return===null||d.return===l)break e;m===d&&(m=null),d=d.return}m===d&&(m=null),d.sibling.return=d.return,d=d.sibling}x&4&&(x=l.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,fb(l,m))));break;case 19:Ta(d,l),Ia(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,fb(l,x)));break;case 30:break;case 21:break;default:Ta(d,l),Ia(l)}}function Ia(l){var d=l.flags;if(d&2){try{for(var m,x=l.return;x!==null;){if(HS(x)){m=x;break}x=x.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var S=m.stateNode,j=db(l);Df(l,j,S);break;case 5:var M=m.stateNode;m.flags&32&&(Zo(M,""),m.flags&=-33);var G=db(l);Df(l,G,M);break;case 3:case 4:var ee=m.stateNode.containerInfo,Ne=db(l);hb(l,Ne,ee);break;default:throw Error(n(161))}}catch(_e){us(l,l.return,_e)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function e3(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var d=l;e3(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),l=l.sibling}}function ci(l,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)XS(l,d.alternate,d),d=d.sibling}function Nl(l){for(l=l.child;l!==null;){var d=l;switch(d.tag){case 0:case 11:case 14:case 15:li(4,d,d.return),Nl(d);break;case 1:Br(d,d.return);var m=d.stateNode;typeof m.componentWillUnmount=="function"&&GS(d,d.return,m),Nl(d);break;case 27:Ud(d.stateNode);case 26:case 5:Br(d,d.return),Nl(d);break;case 22:d.memoizedState===null&&Nl(d);break;case 30:Nl(d);break;default:Nl(d)}l=l.sibling}}function ui(l,d,m){for(m=m&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var x=d.alternate,S=l,j=d,M=j.flags;switch(j.tag){case 0:case 11:case 15:ui(S,j,m),Rd(4,j);break;case 1:if(ui(S,j,m),x=j,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ne){us(x,x.return,Ne)}if(x=j,S=x.updateQueue,S!==null){var G=x.stateNode;try{var ee=S.shared.hiddenCallbacks;if(ee!==null)for(S.shared.hiddenCallbacks=null,S=0;S<ee.length;S++)$N(ee[S],G)}catch(Ne){us(x,x.return,Ne)}}m&&M&64&&US(j),_d(j,j.return);break;case 27:qS(j);case 26:case 5:ui(S,j,m),m&&x===null&&M&4&&WS(j),_d(j,j.return);break;case 12:ui(S,j,m);break;case 13:ui(S,j,m),m&&M&4&&QS(S,j);break;case 22:j.memoizedState===null&&ui(S,j,m),_d(j,j.return);break;case 30:break;default:ui(S,j,m)}d=d.sibling}}function mb(l,d){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(l=d.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&yd(m))}function gb(l,d){l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&yd(l))}function Vr(l,d,m,x){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)t3(l,d,m,x),d=d.sibling}function t3(l,d,m,x){var S=d.flags;switch(d.tag){case 0:case 11:case 15:Vr(l,d,m,x),S&2048&&Rd(9,d);break;case 1:Vr(l,d,m,x);break;case 3:Vr(l,d,m,x),S&2048&&(l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&yd(l)));break;case 12:if(S&2048){Vr(l,d,m,x),l=d.stateNode;try{var j=d.memoizedProps,M=j.id,G=j.onPostCommit;typeof G=="function"&&G(M,d.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(ee){us(d,d.return,ee)}}else Vr(l,d,m,x);break;case 13:Vr(l,d,m,x);break;case 23:break;case 22:j=d.stateNode,M=d.alternate,d.memoizedState!==null?j._visibility&2?Vr(l,d,m,x):Od(l,d):j._visibility&2?Vr(l,d,m,x):(j._visibility|=2,Gc(l,d,m,x,(d.subtreeFlags&10256)!==0)),S&2048&&mb(M,d);break;case 24:Vr(l,d,m,x),S&2048&&gb(d.alternate,d);break;default:Vr(l,d,m,x)}}function Gc(l,d,m,x,S){for(S=S&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var j=l,M=d,G=m,ee=x,Ne=M.flags;switch(M.tag){case 0:case 11:case 15:Gc(j,M,G,ee,S),Rd(8,M);break;case 23:break;case 22:var _e=M.stateNode;M.memoizedState!==null?_e._visibility&2?Gc(j,M,G,ee,S):Od(j,M):(_e._visibility|=2,Gc(j,M,G,ee,S)),S&&Ne&2048&&mb(M.alternate,M);break;case 24:Gc(j,M,G,ee,S),S&&Ne&2048&&gb(M.alternate,M);break;default:Gc(j,M,G,ee,S)}d=d.sibling}}function Od(l,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var m=l,x=d,S=x.flags;switch(x.tag){case 22:Od(m,x),S&2048&&mb(x.alternate,x);break;case 24:Od(m,x),S&2048&&gb(x.alternate,x);break;default:Od(m,x)}d=d.sibling}}var Fd=8192;function Wc(l){if(l.subtreeFlags&Fd)for(l=l.child;l!==null;)s3(l),l=l.sibling}function s3(l){switch(l.tag){case 26:Wc(l),l.flags&Fd&&l.memoizedState!==null&&d6(gr,l.memoizedState,l.memoizedProps);break;case 5:Wc(l);break;case 3:case 4:var d=gr;gr=Wf(l.stateNode.containerInfo),Wc(l),gr=d;break;case 22:l.memoizedState===null&&(d=l.alternate,d!==null&&d.memoizedState!==null?(d=Fd,Fd=16777216,Wc(l),Fd=d):Wc(l));break;default:Wc(l)}}function n3(l){var d=l.alternate;if(d!==null&&(l=d.child,l!==null)){d.child=null;do d=l.sibling,l.sibling=null,l=d;while(l!==null)}}function Ld(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var m=0;m<d.length;m++){var x=d[m];mn=x,r3(x,l)}n3(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)a3(l),l=l.sibling}function a3(l){switch(l.tag){case 0:case 11:case 15:Ld(l),l.flags&2048&&li(9,l,l.return);break;case 3:Ld(l);break;case 12:Ld(l);break;case 22:var d=l.stateNode;l.memoizedState!==null&&d._visibility&2&&(l.return===null||l.return.tag!==13)?(d._visibility&=-3,Rf(l)):Ld(l);break;default:Ld(l)}}function Rf(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var m=0;m<d.length;m++){var x=d[m];mn=x,r3(x,l)}n3(l)}for(l=l.child;l!==null;){switch(d=l,d.tag){case 0:case 11:case 15:li(8,d,d.return),Rf(d);break;case 22:m=d.stateNode,m._visibility&2&&(m._visibility&=-3,Rf(d));break;default:Rf(d)}l=l.sibling}}function r3(l,d){for(;mn!==null;){var m=mn;switch(m.tag){case 0:case 11:case 15:li(8,m,d);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:yd(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,mn=x;else e:for(m=l;mn!==null;){x=mn;var S=x.sibling,j=x.return;if(YS(x),x===m){mn=null;break e}if(S!==null){S.return=j,mn=S;break e}mn=j}}}var TR={getCacheForType:function(l){var d=Ln(on),m=d.data.get(l);return m===void 0&&(m=l(),d.data.set(l,m)),m}},IR=typeof WeakMap=="function"?WeakMap:Map,es=0,ps=null,Ft=null,Ht=0,ts=0,$a=null,di=!1,Hc=!1,xb=!1,jo=0,As=0,hi=0,Sl=0,bb=0,Ya=0,qc=0,Md=null,da=null,yb=!1,vb=0,_f=1/0,Of=null,pi=null,Tn=0,fi=null,Kc=null,Xc=0,wb=0,Nb=null,o3=null,zd=0,Sb=null;function Aa(){if((es&2)!==0&&Ht!==0)return Ht&-Ht;if(B.T!==null){var l=Fc;return l!==0?l:Ab()}return Qe()}function i3(){Ya===0&&(Ya=(Ht&536870912)===0||Yt?sl():536870912);var l=Xa.current;return l!==null&&(l.flags|=32),Ya}function Ea(l,d,m){(l===ps&&(ts===2||ts===9)||l.cancelPendingCommit!==null)&&(Yc(l,0),mi(l,Ht,Ya,!1)),nn(l,m),((es&2)===0||l!==ps)&&(l===ps&&((es&2)===0&&(Sl|=m),As===4&&mi(l,Ht,Ya,!1)),Ur(l))}function l3(l,d,m){if((es&6)!==0)throw Error(n(327));var x=!m&&(d&124)===0&&(d&l.expiredLanes)===0||_r(l,d),S=x?ER(l,d):jb(l,d,!0),j=x;do{if(S===0){Hc&&!x&&mi(l,d,0,!1);break}else{if(m=l.current.alternate,j&&!$R(m)){S=jb(l,d,!1),j=!1;continue}if(S===2){if(j=d,l.errorRecoveryDisabledLanes&j)var M=0;else M=l.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){d=M;e:{var G=l;S=Md;var ee=G.current.memoizedState.isDehydrated;if(ee&&(Yc(G,M).flags|=256),M=jb(G,M,!1),M!==2){if(xb&&!ee){G.errorRecoveryDisabledLanes|=j,Sl|=j,S=4;break e}j=da,da=S,j!==null&&(da===null?da=j:da.push.apply(da,j))}S=M}if(j=!1,S!==2)continue}}if(S===1){Yc(l,0),mi(l,d,0,!0);break}e:{switch(x=l,j=S,j){case 0:case 1:throw Error(n(345));case 4:if((d&4194048)!==d)break;case 6:mi(x,d,Ya,!di);break e;case 2:da=null;break;case 3:case 5:break;default:throw Error(n(329))}if((d&62914560)===d&&(S=vb+300-Xe(),10<S)){if(mi(x,d,Ya,!di),Rr(x,0,!0)!==0)break e;x.timeoutHandle=L3(c3.bind(null,x,m,da,Of,yb,d,Ya,Sl,qc,di,j,2,-0,0),S);break e}c3(x,m,da,Of,yb,d,Ya,Sl,qc,di,j,0,-0,0)}}break}while(!0);Ur(l)}function c3(l,d,m,x,S,j,M,G,ee,Ne,_e,ze,Te,$e){if(l.timeoutHandle=-1,ze=d.subtreeFlags,(ze&8192||(ze&16785408)===16785408)&&(Hd={stylesheets:null,count:0,unsuspend:u6},s3(d),ze=h6(),ze!==null)){l.cancelPendingCommit=ze(g3.bind(null,l,d,j,m,x,S,M,G,ee,_e,1,Te,$e)),mi(l,j,M,!Ne);return}g3(l,d,j,m,x,S,M,G,ee)}function $R(l){for(var d=l;;){var m=d.tag;if((m===0||m===11||m===15)&&d.flags&16384&&(m=d.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var S=m[x],j=S.getSnapshot;S=S.value;try{if(!ka(j(),S))return!1}catch(M){return!1}}if(m=d.child,d.subtreeFlags&16384&&m!==null)m.return=d,d=m;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function mi(l,d,m,x){d&=~bb,d&=~Sl,l.suspendedLanes|=d,l.pingedLanes&=~d,x&&(l.warmLanes|=d),x=l.expirationTimes;for(var S=d;0<S;){var j=31-jt(S),M=1<<j;x[j]=-1,S&=~M}m!==0&&al(l,m,d)}function Ff(){return(es&6)===0?(Pd(0),!1):!0}function Cb(){if(Ft!==null){if(ts===0)var l=Ft.return;else l=Ft,bo=xl=null,B0(l),Vc=null,Ad=0,l=Ft;for(;l!==null;)VS(l.alternate,l),l=l.return;Ft=null}}function Yc(l,d){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,qR(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),Cb(),ps=l,Ft=m=mo(l.current,null),Ht=d,ts=0,$a=null,di=!1,Hc=_r(l,d),xb=!1,qc=Ya=bb=Sl=hi=As=0,da=Md=null,yb=!1,(d&8)!==0&&(d|=d&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=d;0<x;){var S=31-jt(x),j=1<<S;d|=l[S],x&=~j}return jo=d,nf(),m}function u3(l,d){Rt=null,B.H=Sf,d===wd||d===pf?(d=TN(),ts=3):d===CN?(d=TN(),ts=4):ts=d===IS?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,$a=d,Ft===null&&(As=1,If(l,Wa(d,l.current)))}function d3(){var l=B.H;return B.H=Sf,l===null?Sf:l}function h3(){var l=B.A;return B.A=TR,l}function kb(){As=4,di||(Ht&4194048)!==Ht&&Xa.current!==null||(Hc=!0),(hi&134217727)===0&&(Sl&134217727)===0||ps===null||mi(ps,Ht,Ya,!1)}function jb(l,d,m){var x=es;es|=2;var S=d3(),j=h3();(ps!==l||Ht!==d)&&(Of=null,Yc(l,d)),d=!1;var M=As;e:do try{if(ts!==0&&Ft!==null){var G=Ft,ee=$a;switch(ts){case 8:Cb(),M=6;break e;case 3:case 2:case 9:case 6:Xa.current===null&&(d=!0);var Ne=ts;if(ts=0,$a=null,Zc(l,G,ee,Ne),m&&Hc){M=0;break e}break;default:Ne=ts,ts=0,$a=null,Zc(l,G,ee,Ne)}}AR(),M=As;break}catch(_e){u3(l,_e)}while(!0);return d&&l.shellSuspendCounter++,bo=xl=null,es=x,B.H=S,B.A=j,Ft===null&&(ps=null,Ht=0,nf()),M}function AR(){for(;Ft!==null;)p3(Ft)}function ER(l,d){var m=es;es|=2;var x=d3(),S=h3();ps!==l||Ht!==d?(Of=null,_f=Xe()+500,Yc(l,d)):Hc=_r(l,d);e:do try{if(ts!==0&&Ft!==null){d=Ft;var j=$a;t:switch(ts){case 1:ts=0,$a=null,Zc(l,d,j,1);break;case 2:case 9:if(kN(j)){ts=0,$a=null,f3(d);break}d=function(){ts!==2&&ts!==9||ps!==l||(ts=7),Ur(l)},j.then(d,d);break e;case 3:ts=7;break e;case 4:ts=5;break e;case 7:kN(j)?(ts=0,$a=null,f3(d)):(ts=0,$a=null,Zc(l,d,j,7));break;case 5:var M=null;switch(Ft.tag){case 26:M=Ft.memoizedState;case 5:case 27:var G=Ft;if(!M||X3(M)){ts=0,$a=null;var ee=G.sibling;if(ee!==null)Ft=ee;else{var Ne=G.return;Ne!==null?(Ft=Ne,Lf(Ne)):Ft=null}break t}}ts=0,$a=null,Zc(l,d,j,5);break;case 6:ts=0,$a=null,Zc(l,d,j,6);break;case 8:Cb(),As=6;break e;default:throw Error(n(462))}}DR();break}catch(_e){u3(l,_e)}while(!0);return bo=xl=null,B.H=x,B.A=S,es=m,Ft!==null?0:(ps=null,Ht=0,nf(),As)}function DR(){for(;Ft!==null&&!We();)p3(Ft)}function p3(l){var d=PS(l.alternate,l,jo);l.memoizedProps=l.pendingProps,d===null?Lf(l):Ft=d}function f3(l){var d=l,m=d.alternate;switch(d.tag){case 15:case 0:d=_S(m,d,d.pendingProps,d.type,void 0,Ht);break;case 11:d=_S(m,d,d.pendingProps,d.type.render,d.ref,Ht);break;case 5:B0(d);default:VS(m,d),d=Ft=mN(d,jo),d=PS(m,d,jo)}l.memoizedProps=l.pendingProps,d===null?Lf(l):Ft=d}function Zc(l,d,m,x){bo=xl=null,B0(d),Vc=null,Ad=0;var S=d.return;try{if(wR(l,S,d,m,Ht)){As=1,If(l,Wa(m,l.current)),Ft=null;return}}catch(j){if(S!==null)throw Ft=S,j;As=1,If(l,Wa(m,l.current)),Ft=null;return}d.flags&32768?(Yt||x===1?l=!0:Hc||(Ht&536870912)!==0?l=!1:(di=l=!0,(x===2||x===9||x===3||x===6)&&(x=Xa.current,x!==null&&x.tag===13&&(x.flags|=16384))),m3(d,l)):Lf(d)}function Lf(l){var d=l;do{if((d.flags&32768)!==0){m3(d,di);return}l=d.return;var m=SR(d.alternate,d,jo);if(m!==null){Ft=m;return}if(d=d.sibling,d!==null){Ft=d;return}Ft=d=l}while(d!==null);As===0&&(As=5)}function m3(l,d){do{var m=CR(l.alternate,l);if(m!==null){m.flags&=32767,Ft=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!d&&(l=l.sibling,l!==null)){Ft=l;return}Ft=l=m}while(l!==null);As=6,Ft=null}function g3(l,d,m,x,S,j,M,G,ee){l.cancelPendingCommit=null;do Mf();while(Tn!==0);if((es&6)!==0)throw Error(n(327));if(d!==null){if(d===l.current)throw Error(n(177));if(j=d.lanes|d.childLanes,j|=g0,Ns(l,m,j,M,G,ee),l===ps&&(Ft=ps=null,Ht=0),Kc=d,fi=l,Xc=m,wb=j,Nb=S,o3=x,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,FR(Ve,function(){return w3(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||x){x=B.T,B.T=null,S=K.p,K.p=2,M=es,es|=4;try{kR(l,d,m)}finally{es=M,K.p=S,B.T=x}}Tn=1,x3(),b3(),y3()}}function x3(){if(Tn===1){Tn=0;var l=fi,d=Kc,m=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||m){m=B.T,B.T=null;var x=K.p;K.p=2;var S=es;es|=4;try{JS(d,l);var j=Mb,M=rN(l.containerInfo),G=j.focusedElem,ee=j.selectionRange;if(M!==G&&G&&G.ownerDocument&&aN(G.ownerDocument.documentElement,G)){if(ee!==null&&d0(G)){var Ne=ee.start,_e=ee.end;if(_e===void 0&&(_e=Ne),"selectionStart"in G)G.selectionStart=Ne,G.selectionEnd=Math.min(_e,G.value.length);else{var ze=G.ownerDocument||document,Te=ze&&ze.defaultView||window;if(Te.getSelection){var $e=Te.getSelection(),Nt=G.textContent.length,ft=Math.min(ee.start,Nt),rs=ee.end===void 0?ft:Math.min(ee.end,Nt);!$e.extend&&ft>rs&&(M=rs,rs=ft,ft=M);var ge=nN(G,ft),he=nN(G,rs);if(ge&&he&&($e.rangeCount!==1||$e.anchorNode!==ge.node||$e.anchorOffset!==ge.offset||$e.focusNode!==he.node||$e.focusOffset!==he.offset)){var be=ze.createRange();be.setStart(ge.node,ge.offset),$e.removeAllRanges(),ft>rs?($e.addRange(be),$e.extend(he.node,he.offset)):(be.setEnd(he.node,he.offset),$e.addRange(be))}}}}for(ze=[],$e=G;$e=$e.parentNode;)$e.nodeType===1&&ze.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<ze.length;G++){var Oe=ze[G];Oe.element.scrollLeft=Oe.left,Oe.element.scrollTop=Oe.top}}Yf=!!Lb,Mb=Lb=null}finally{es=S,K.p=x,B.T=m}}l.current=d,Tn=2}}function b3(){if(Tn===2){Tn=0;var l=fi,d=Kc,m=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||m){m=B.T,B.T=null;var x=K.p;K.p=2;var S=es;es|=4;try{XS(l,d.alternate,d)}finally{es=S,K.p=x,B.T=m}}Tn=3}}function y3(){if(Tn===4||Tn===3){Tn=0,je();var l=fi,d=Kc,m=Xc,x=o3;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Tn=5:(Tn=0,Kc=fi=null,v3(l,l.pendingLanes));var S=l.pendingLanes;if(S===0&&(pi=null),Re(m),d=d.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Dt,d,void 0,(d.current.flags&128)===128)}catch(ee){}if(x!==null){d=B.T,S=K.p,K.p=2,B.T=null;try{for(var j=l.onRecoverableError,M=0;M<x.length;M++){var G=x[M];j(G.value,{componentStack:G.stack})}}finally{B.T=d,K.p=S}}(Xc&3)!==0&&Mf(),Ur(l),S=l.pendingLanes,(m&4194090)!==0&&(S&42)!==0?l===Sb?zd++:(zd=0,Sb=l):zd=0,Pd(0)}}function v3(l,d){(l.pooledCacheLanes&=d)===0&&(d=l.pooledCache,d!=null&&(l.pooledCache=null,yd(d)))}function Mf(l){return x3(),b3(),y3(),w3()}function w3(){if(Tn!==5)return!1;var l=fi,d=wb;wb=0;var m=Re(Xc),x=B.T,S=K.p;try{K.p=32>m?32:m,B.T=null,m=Nb,Nb=null;var j=fi,M=Xc;if(Tn=0,Kc=fi=null,Xc=0,(es&6)!==0)throw Error(n(331));var G=es;if(es|=4,a3(j.current),t3(j,j.current,M,m),es=G,Pd(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Dt,j)}catch(ee){}return!0}finally{K.p=S,B.T=x,v3(l,d)}}function N3(l,d,m){d=Wa(m,d),d=tb(l.stateNode,d,2),l=ai(l,d,2),l!==null&&(nn(l,2),Ur(l))}function us(l,d,m){if(l.tag===3)N3(l,l,m);else for(;d!==null;){if(d.tag===3){N3(d,l,m);break}else if(d.tag===1){var x=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(pi===null||!pi.has(x))){l=Wa(m,l),m=jS(2),x=ai(d,m,2),x!==null&&(TS(m,x,d,l),nn(x,2),Ur(x));break}}d=d.return}}function Tb(l,d,m){var x=l.pingCache;if(x===null){x=l.pingCache=new IR;var S=new Set;x.set(d,S)}else S=x.get(d),S===void 0&&(S=new Set,x.set(d,S));S.has(m)||(xb=!0,S.add(m),l=RR.bind(null,l,d,m),d.then(l,l))}function RR(l,d,m){var x=l.pingCache;x!==null&&x.delete(d),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,ps===l&&(Ht&m)===m&&(As===4||As===3&&(Ht&62914560)===Ht&&300>Xe()-vb?(es&2)===0&&Yc(l,0):bb|=m,qc===Ht&&(qc=0)),Ur(l)}function S3(l,d){d===0&&(d=nl()),l=Dc(l,d),l!==null&&(nn(l,d),Ur(l))}function _R(l){var d=l.memoizedState,m=0;d!==null&&(m=d.retryLane),S3(l,m)}function OR(l,d){var m=0;switch(l.tag){case 13:var x=l.stateNode,S=l.memoizedState;S!==null&&(m=S.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(d),S3(l,m)}function FR(l,d){return Ue(l,d)}var zf=null,Qc=null,Ib=!1,Pf=!1,$b=!1,Cl=0;function Ur(l){l!==Qc&&l.next===null&&(Qc===null?zf=Qc=l:Qc=Qc.next=l),Pf=!0,Ib||(Ib=!0,MR())}function Pd(l,d){if(!$b&&Pf){$b=!0;do for(var m=!1,x=zf;x!==null;){if(l!==0){var S=x.pendingLanes;if(S===0)var j=0;else{var M=x.suspendedLanes,G=x.pingedLanes;j=(1<<31-jt(42|l)+1)-1,j&=S&~(M&~G),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(m=!0,T3(x,j))}else j=Ht,j=Rr(x,x===ps?j:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(j&3)===0||_r(x,j)||(m=!0,T3(x,j));x=x.next}while(m);$b=!1}}function LR(){C3()}function C3(){Pf=Ib=!1;var l=0;Cl!==0&&(HR()&&(l=Cl),Cl=0);for(var d=Xe(),m=null,x=zf;x!==null;){var S=x.next,j=k3(x,d);j===0?(x.next=null,m===null?zf=S:m.next=S,S===null&&(Qc=m)):(m=x,(l!==0||(j&3)!==0)&&(Pf=!0)),x=S}Pd(l)}function k3(l,d){for(var m=l.suspendedLanes,x=l.pingedLanes,S=l.expirationTimes,j=l.pendingLanes&-62914561;0<j;){var M=31-jt(j),G=1<<M,ee=S[M];ee===-1?((G&m)===0||(G&x)!==0)&&(S[M]=oa(G,d)):ee<=d&&(l.expiredLanes|=G),j&=~G}if(d=ps,m=Ht,m=Rr(l,l===d?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,m===0||l===d&&(ts===2||ts===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&He(x),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||_r(l,m)){if(d=m&-m,d===l.callbackPriority)return d;switch(x!==null&&He(x),Re(m)){case 2:case 8:m=pt;break;case 32:m=Ve;break;case 268435456:m=mt;break;default:m=Ve}return x=j3.bind(null,l),m=Ue(m,x),l.callbackPriority=d,l.callbackNode=m,d}return x!==null&&x!==null&&He(x),l.callbackPriority=2,l.callbackNode=null,2}function j3(l,d){if(Tn!==0&&Tn!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(Mf()&&l.callbackNode!==m)return null;var x=Ht;return x=Rr(l,l===ps?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(l3(l,x,d),k3(l,Xe()),l.callbackNode!=null&&l.callbackNode===m?j3.bind(null,l):null)}function T3(l,d){if(Mf())return null;l3(l,d,!0)}function MR(){KR(function(){(es&6)!==0?Ue(St,LR):C3()})}function Ab(){return Cl===0&&(Cl=sl()),Cl}function I3(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Qo(""+l)}function $3(l,d){var m=d.ownerDocument.createElement("input");return m.name=d.name,m.value=d.value,l.id&&m.setAttribute("form",l.id),d.parentNode.insertBefore(m,d),l=new FormData(l),m.parentNode.removeChild(m),l}function zR(l,d,m,x,S){if(d==="submit"&&m&&m.stateNode===S){var j=I3((S[Cs]||null).action),M=x.submitter;M&&(d=(d=M[Cs]||null)?I3(d.formAction):M.getAttribute("formAction"),d!==null&&(j=d,M=null));var G=new Jo("action","action",null,x,S);l.push({event:G,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Cl!==0){var ee=M?$3(S,M):new FormData(S);Y0(m,{pending:!0,data:ee,method:S.method,action:j},null,ee)}}else typeof j=="function"&&(G.preventDefault(),ee=M?$3(S,M):new FormData(S),Y0(m,{pending:!0,data:ee,method:S.method,action:j},j,ee))},currentTarget:S}]})}}for(var Eb=0;Eb<m0.length;Eb++){var Db=m0[Eb],PR=Db.toLowerCase(),BR=Db[0].toUpperCase()+Db.slice(1);mr(PR,"on"+BR)}mr(lN,"onAnimationEnd"),mr(cN,"onAnimationIteration"),mr(uN,"onAnimationStart"),mr("dblclick","onDoubleClick"),mr("focusin","onFocus"),mr("focusout","onBlur"),mr(aR,"onTransitionRun"),mr(rR,"onTransitionStart"),mr(oR,"onTransitionCancel"),mr(dN,"onTransitionEnd"),uo("onMouseEnter",["mouseout","mouseover"]),uo("onMouseLeave",["mouseout","mouseover"]),uo("onPointerEnter",["pointerout","pointerover"]),uo("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bd));function A3(l,d){d=(d&4)!==0;for(var m=0;m<l.length;m++){var x=l[m],S=x.event;x=x.listeners;e:{var j=void 0;if(d)for(var M=x.length-1;0<=M;M--){var G=x[M],ee=G.instance,Ne=G.currentTarget;if(G=G.listener,ee!==j&&S.isPropagationStopped())break e;j=G,S.currentTarget=Ne;try{j(S)}catch(_e){Tf(_e)}S.currentTarget=null,j=ee}else for(M=0;M<x.length;M++){if(G=x[M],ee=G.instance,Ne=G.currentTarget,G=G.listener,ee!==j&&S.isPropagationStopped())break e;j=G,S.currentTarget=Ne;try{j(S)}catch(_e){Tf(_e)}S.currentTarget=null,j=ee}}}}function Lt(l,d){var m=d[io];m===void 0&&(m=d[io]=new Set);var x=l+"__bubble";m.has(x)||(E3(d,l,2,!1),m.add(x))}function Rb(l,d,m){var x=0;d&&(x|=4),E3(m,l,x,d)}var Bf="_reactListening"+Math.random().toString(36).slice(2);function _b(l){if(!l[Bf]){l[Bf]=!0,Kp.forEach(function(m){m!=="selectionchange"&&(VR.has(m)||Rb(m,!1,l),Rb(m,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[Bf]||(d[Bf]=!0,Rb("selectionchange",!1,d))}}function E3(l,d,m,x){switch(t4(d)){case 2:var S=m6;break;case 8:S=g6;break;default:S=Kb}m=S.bind(null,d,m,l),S=void 0,!id||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),x?S!==void 0?l.addEventListener(d,m,{capture:!0,passive:S}):l.addEventListener(d,m,!0):S!==void 0?l.addEventListener(d,m,{passive:S}):l.addEventListener(d,m,!1)}function Ob(l,d,m,x,S){var j=x;if((d&1)===0&&(d&2)===0&&x!==null)e:for(;;){if(x===null)return;var M=x.tag;if(M===3||M===4){var G=x.stateNode.containerInfo;if(G===S)break;if(M===4)for(M=x.return;M!==null;){var ee=M.tag;if((ee===3||ee===4)&&M.stateNode.containerInfo===S)return;M=M.return}for(;G!==null;){if(M=lo(G),M===null)return;if(ee=M.tag,ee===5||ee===6||ee===26||ee===27){x=j=M;continue e}G=G.parentNode}}x=x.return}od(function(){var Ne=j,_e=wc(m),ze=[];e:{var Te=hN.get(l);if(Te!==void 0){var $e=Jo,Nt=l;switch(l){case"keypress":if(kc(m)===0)break e;case"keydown":case"keyup":$e=Ut;break;case"focusin":Nt="focus",$e=P;break;case"focusout":Nt="blur",$e=P;break;case"beforeblur":case"afterblur":$e=P;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=ef;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=k;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=la;break;case lN:case cN:case uN:$e=se;break;case dN:$e=Wt;break;case"scroll":case"scrollend":$e=i0;break;case"wheel":$e=Mr;break;case"copy":case"cut":case"paste":$e=ie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=Jt;break;case"toggle":case"beforetoggle":$e=WD}var ft=(d&4)!==0,rs=!ft&&(l==="scroll"||l==="scrollend"),ge=ft?Te!==null?Te+"Capture":null:Te;ft=[];for(var he=Ne,be;he!==null;){var Oe=he;if(be=Oe.stateNode,Oe=Oe.tag,Oe!==5&&Oe!==26&&Oe!==27||be===null||ge===null||(Oe=ol(he,ge),Oe!=null&&ft.push(Vd(he,Oe,be))),rs)break;he=he.return}0<ft.length&&(Te=new $e(Te,Nt,null,m,_e),ze.push({event:Te,listeners:ft}))}}if((d&7)===0){e:{if(Te=l==="mouseover"||l==="pointerover",$e=l==="mouseout"||l==="pointerout",Te&&m!==vc&&(Nt=m.relatedTarget||m.fromElement)&&(lo(Nt)||Nt[za]))break e;if(($e||Te)&&(Te=_e.window===_e?_e:(Te=_e.ownerDocument)?Te.defaultView||Te.parentWindow:window,$e?(Nt=m.relatedTarget||m.toElement,$e=Ne,Nt=Nt?lo(Nt):null,Nt!==null&&(rs=o(Nt),ft=Nt.tag,Nt!==rs||ft!==5&&ft!==27&&ft!==6)&&(Nt=null)):($e=null,Nt=Ne),$e!==Nt)){if(ft=ef,Oe="onMouseLeave",ge="onMouseEnter",he="mouse",(l==="pointerout"||l==="pointerover")&&(ft=Jt,Oe="onPointerLeave",ge="onPointerEnter",he="pointer"),rs=$e==null?Te:Xo($e),be=Nt==null?Te:Xo(Nt),Te=new ft(Oe,he+"leave",$e,m,_e),Te.target=rs,Te.relatedTarget=be,Oe=null,lo(_e)===Ne&&(ft=new ft(ge,he+"enter",Nt,m,_e),ft.target=be,ft.relatedTarget=rs,Oe=ft),rs=Oe,$e&&Nt)t:{for(ft=$e,ge=Nt,he=0,be=ft;be;be=Jc(be))he++;for(be=0,Oe=ge;Oe;Oe=Jc(Oe))be++;for(;0<he-be;)ft=Jc(ft),he--;for(;0<be-he;)ge=Jc(ge),be--;for(;he--;){if(ft===ge||ge!==null&&ft===ge.alternate)break t;ft=Jc(ft),ge=Jc(ge)}ft=null}else ft=null;$e!==null&&D3(ze,Te,$e,ft,!1),Nt!==null&&rs!==null&&D3(ze,rs,Nt,ft,!0)}}e:{if(Te=Ne?Xo(Ne):window,$e=Te.nodeName&&Te.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Te.type==="file")var it=Zw;else if(Xw(Te))if(Qw)it=tR;else{it=JD;var Ot=QD}else $e=Te.nodeName,!$e||$e.toLowerCase()!=="input"||Te.type!=="checkbox"&&Te.type!=="radio"?Ne&&yc(Ne.elementType)&&(it=Zw):it=eR;if(it&&(it=it(l,Ne))){Yw(ze,it,m,_e);break e}Ot&&Ot(l,Te,Ne),l==="focusout"&&Ne&&Te.type==="number"&&Ne.memoizedProps.value!=null&&xc(Te,"number",Te.value)}switch(Ot=Ne?Xo(Ne):window,l){case"focusin":(Xw(Ot)||Ot.contentEditable==="true")&&($c=Ot,h0=Ne,fd=null);break;case"focusout":fd=h0=$c=null;break;case"mousedown":p0=!0;break;case"contextmenu":case"mouseup":case"dragend":p0=!1,oN(ze,m,_e);break;case"selectionchange":if(nR)break;case"keydown":case"keyup":oN(ze,m,_e)}var dt;if(l0)e:{switch(l){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else Ic?qw(l,m)&&(gt="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(gt="onCompositionStart");gt&&(Gw&&m.locale!=="ko"&&(Ic||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&Ic&&(dt=Jp()):(Ga=_e,Sc="value"in Ga?Ga.value:Ga.textContent,Ic=!0)),Ot=Vf(Ne,gt),0<Ot.length&&(gt=new De(gt,l,null,m,_e),ze.push({event:gt,listeners:Ot}),dt?gt.data=dt:(dt=Kw(m),dt!==null&&(gt.data=dt)))),(dt=qD?KD(l,m):XD(l,m))&&(gt=Vf(Ne,"onBeforeInput"),0<gt.length&&(Ot=new De("onBeforeInput","beforeinput",null,m,_e),ze.push({event:Ot,listeners:gt}),Ot.data=dt)),zR(ze,l,Ne,m,_e)}A3(ze,d)})}function Vd(l,d,m){return{instance:l,listener:d,currentTarget:m}}function Vf(l,d){for(var m=d+"Capture",x=[];l!==null;){var S=l,j=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||j===null||(S=ol(l,m),S!=null&&x.unshift(Vd(l,S,j)),S=ol(l,d),S!=null&&x.push(Vd(l,S,j))),l.tag===3)return x;l=l.return}return[]}function Jc(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function D3(l,d,m,x,S){for(var j=d._reactName,M=[];m!==null&&m!==x;){var G=m,ee=G.alternate,Ne=G.stateNode;if(G=G.tag,ee!==null&&ee===x)break;G!==5&&G!==26&&G!==27||Ne===null||(ee=Ne,S?(Ne=ol(m,j),Ne!=null&&M.unshift(Vd(m,Ne,ee))):S||(Ne=ol(m,j),Ne!=null&&M.push(Vd(m,Ne,ee)))),m=m.return}M.length!==0&&l.push({event:d,listeners:M})}var UR=/\r\n?/g,GR=/\u0000|\uFFFD/g;function R3(l){return(typeof l=="string"?l:""+l).replace(UR,"\n").replace(GR,"")}function _3(l,d){return d=R3(d),R3(l)===d}function Uf(){}function as(l,d,m,x,S,j){switch(m){case"children":typeof x=="string"?d==="body"||d==="textarea"&&x===""||Zo(l,x):(typeof x=="number"||typeof x=="bigint")&&d!=="body"&&Zo(l,""+x);break;case"className":pc(l,"class",x);break;case"tabIndex":pc(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":pc(l,m,x);break;case"style":ad(l,x,j);break;case"data":if(d!=="object"){pc(l,"data",x);break}case"src":case"href":if(x===""&&(d!=="a"||m!=="href")){l.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Qo(""+x),l.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(m==="formAction"?(d!=="input"&&as(l,d,"name",S.name,S,null),as(l,d,"formEncType",S.formEncType,S,null),as(l,d,"formMethod",S.formMethod,S,null),as(l,d,"formTarget",S.formTarget,S,null)):(as(l,d,"encType",S.encType,S,null),as(l,d,"method",S.method,S,null),as(l,d,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Qo(""+x),l.setAttribute(m,x);break;case"onClick":x!=null&&(l.onclick=Uf);break;case"onScroll":x!=null&&Lt("scroll",l);break;case"onScrollEnd":x!=null&&Lt("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}m=Qo(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""+x):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":x===!0?l.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,x):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(m,x):l.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(m):l.setAttribute(m,x);break;case"popover":Lt("beforetoggle",l),Lt("toggle",l),hc(l,"popover",x);break;case"xlinkActuate":Ba(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ba(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ba(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ba(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ba(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ba(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ba(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ba(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ba(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":hc(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=r0.get(m)||m,hc(l,m,x))}}function Fb(l,d,m,x,S,j){switch(m){case"style":ad(l,x,j);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"children":typeof x=="string"?Zo(l,x):(typeof x=="number"||typeof x=="bigint")&&Zo(l,""+x);break;case"onScroll":x!=null&&Lt("scroll",l);break;case"onScrollEnd":x!=null&&Lt("scrollend",l);break;case"onClick":x!=null&&(l.onclick=Uf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yu.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(S=m.endsWith("Capture"),d=m.slice(2,S?m.length-7:void 0),j=l[Cs]||null,j=j!=null?j[m]:null,typeof j=="function"&&l.removeEventListener(d,j,S),typeof x=="function")){typeof j!="function"&&j!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(d,x,S);break e}m in l?l[m]=x:x===!0?l.setAttribute(m,""):hc(l,m,x)}}}function In(l,d,m){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lt("error",l),Lt("load",l);var x=!1,S=!1,j;for(j in m)if(m.hasOwnProperty(j)){var M=m[j];if(M!=null)switch(j){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:as(l,d,j,M,m,null)}}S&&as(l,d,"srcSet",m.srcSet,m,null),x&&as(l,d,"src",m.src,m,null);return;case"input":Lt("invalid",l);var G=j=M=S=null,ee=null,Ne=null;for(x in m)if(m.hasOwnProperty(x)){var _e=m[x];if(_e!=null)switch(x){case"name":S=_e;break;case"type":M=_e;break;case"checked":ee=_e;break;case"defaultChecked":Ne=_e;break;case"value":j=_e;break;case"defaultValue":G=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,d));break;default:as(l,d,x,_e,m,null)}}Xn(l,j,G,ee,Ne,M,S,!1),Lr(l);return;case"select":Lt("invalid",l),x=M=j=null;for(S in m)if(m.hasOwnProperty(S)&&(G=m[S],G!=null))switch(S){case"value":j=G;break;case"defaultValue":M=G;break;case"multiple":x=G;default:as(l,d,S,G,m,null)}d=j,m=M,l.multiple=!!x,d!=null?Va(l,!!x,d,!1):m!=null&&Va(l,!!x,m,!0);return;case"textarea":Lt("invalid",l),j=S=x=null;for(M in m)if(m.hasOwnProperty(M)&&(G=m[M],G!=null))switch(M){case"value":x=G;break;case"defaultValue":S=G;break;case"children":j=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(91));break;default:as(l,d,M,G,m,null)}bc(l,x,S,j),Lr(l);return;case"option":for(ee in m)if(m.hasOwnProperty(ee)&&(x=m[ee],x!=null))switch(ee){case"selected":l.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:as(l,d,ee,x,m,null)}return;case"dialog":Lt("beforetoggle",l),Lt("toggle",l),Lt("cancel",l),Lt("close",l);break;case"iframe":case"object":Lt("load",l);break;case"video":case"audio":for(x=0;x<Bd.length;x++)Lt(Bd[x],l);break;case"image":Lt("error",l),Lt("load",l);break;case"details":Lt("toggle",l);break;case"embed":case"source":case"link":Lt("error",l),Lt("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in m)if(m.hasOwnProperty(Ne)&&(x=m[Ne],x!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:as(l,d,Ne,x,m,null)}return;default:if(yc(d)){for(_e in m)m.hasOwnProperty(_e)&&(x=m[_e],x!==void 0&&Fb(l,d,_e,x,m,void 0));return}}for(G in m)m.hasOwnProperty(G)&&(x=m[G],x!=null&&as(l,d,G,x,m,null))}function WR(l,d,m,x){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,j=null,M=null,G=null,ee=null,Ne=null,_e=null;for($e in m){var ze=m[$e];if(m.hasOwnProperty($e)&&ze!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":ee=ze;default:x.hasOwnProperty($e)||as(l,d,$e,null,x,ze)}}for(var Te in x){var $e=x[Te];if(ze=m[Te],x.hasOwnProperty(Te)&&($e!=null||ze!=null))switch(Te){case"type":j=$e;break;case"name":S=$e;break;case"checked":Ne=$e;break;case"defaultChecked":_e=$e;break;case"value":M=$e;break;case"defaultValue":G=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(n(137,d));break;default:$e!==ze&&as(l,d,Te,$e,x,ze)}}gc(l,M,G,ee,Ne,_e,j,S);return;case"select":$e=M=G=Te=null;for(j in m)if(ee=m[j],m.hasOwnProperty(j)&&ee!=null)switch(j){case"value":break;case"multiple":$e=ee;default:x.hasOwnProperty(j)||as(l,d,j,null,x,ee)}for(S in x)if(j=x[S],ee=m[S],x.hasOwnProperty(S)&&(j!=null||ee!=null))switch(S){case"value":Te=j;break;case"defaultValue":G=j;break;case"multiple":M=j;default:j!==ee&&as(l,d,S,j,x,ee)}d=G,m=M,x=$e,Te!=null?Va(l,!!m,Te,!1):!!x!=!!m&&(d!=null?Va(l,!!m,d,!0):Va(l,!!m,m?[]:"",!1));return;case"textarea":$e=Te=null;for(G in m)if(S=m[G],m.hasOwnProperty(G)&&S!=null&&!x.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:as(l,d,G,null,x,S)}for(M in x)if(S=x[M],j=m[M],x.hasOwnProperty(M)&&(S!=null||j!=null))switch(M){case"value":Te=S;break;case"defaultValue":$e=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==j&&as(l,d,M,S,x,j)}nd(l,Te,$e);return;case"option":for(var Nt in m)if(Te=m[Nt],m.hasOwnProperty(Nt)&&Te!=null&&!x.hasOwnProperty(Nt))switch(Nt){case"selected":l.selected=!1;break;default:as(l,d,Nt,null,x,Te)}for(ee in x)if(Te=x[ee],$e=m[ee],x.hasOwnProperty(ee)&&Te!==$e&&(Te!=null||$e!=null))switch(ee){case"selected":l.selected=Te&&typeof Te!="function"&&typeof Te!="symbol";break;default:as(l,d,ee,Te,x,$e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in m)Te=m[ft],m.hasOwnProperty(ft)&&Te!=null&&!x.hasOwnProperty(ft)&&as(l,d,ft,null,x,Te);for(Ne in x)if(Te=x[Ne],$e=m[Ne],x.hasOwnProperty(Ne)&&Te!==$e&&(Te!=null||$e!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,d));break;default:as(l,d,Ne,Te,x,$e)}return;default:if(yc(d)){for(var rs in m)Te=m[rs],m.hasOwnProperty(rs)&&Te!==void 0&&!x.hasOwnProperty(rs)&&Fb(l,d,rs,void 0,x,Te);for(_e in x)Te=x[_e],$e=m[_e],!x.hasOwnProperty(_e)||Te===$e||Te===void 0&&$e===void 0||Fb(l,d,_e,Te,x,$e);return}}for(var ge in m)Te=m[ge],m.hasOwnProperty(ge)&&Te!=null&&!x.hasOwnProperty(ge)&&as(l,d,ge,null,x,Te);for(ze in x)Te=x[ze],$e=m[ze],!x.hasOwnProperty(ze)||Te===$e||Te==null&&$e==null||as(l,d,ze,Te,x,$e)}var Lb=null,Mb=null;function Gf(l){return l.nodeType===9?l:l.ownerDocument}function O3(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F3(l,d){if(l===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&d==="foreignObject"?0:l}function zb(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Pb=null;function HR(){var l=window.event;return l&&l.type==="popstate"?l===Pb?!1:(Pb=l,!0):(Pb=null,!1)}var L3=typeof setTimeout=="function"?setTimeout:void 0,qR=typeof clearTimeout=="function"?clearTimeout:void 0,M3=typeof Promise=="function"?Promise:void 0,KR=typeof queueMicrotask=="function"?queueMicrotask:typeof M3<"u"?function(l){return M3.resolve(null).then(l).catch(XR)}:L3;function XR(l){setTimeout(function(){throw l})}function gi(l){return l==="head"}function z3(l,d){var m=d,x=0,S=0;do{var j=m.nextSibling;if(l.removeChild(m),j&&j.nodeType===8)if(m=j.data,m==="/$"){if(0<x&&8>x){m=x;var M=l.ownerDocument;if(m&1&&Ud(M.documentElement),m&2&&Ud(M.body),m&4)for(m=M.head,Ud(m),M=m.firstChild;M;){var G=M.nextSibling,ee=M.nodeName;M[Fr]||ee==="SCRIPT"||ee==="STYLE"||ee==="LINK"&&M.rel.toLowerCase()==="stylesheet"||m.removeChild(M),M=G}}if(S===0){l.removeChild(j),Zd(d);return}S--}else m==="$"||m==="$?"||m==="$!"?S++:x=m.charCodeAt(0)-48;else x=0;m=j}while(m);Zd(d)}function Bb(l){var d=l.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var m=d;switch(d=d.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Bb(m),dc(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function YR(l,d,m,x){for(;l.nodeType===1;){var S=m;if(l.nodeName.toLowerCase()!==d.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[Fr])switch(d){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(j=l.getAttribute("rel"),j==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(j!==S.rel||l.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||l.getAttribute("title")!==(S.title==null?null:S.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(j=l.getAttribute("src"),(j!==(S.src==null?null:S.src)||l.getAttribute("type")!==(S.type==null?null:S.type)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&j&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(d==="input"&&l.type==="hidden"){var j=S.name==null?null:""+S.name;if(S.type==="hidden"&&l.getAttribute("name")===j)return l}else return l;if(l=xr(l.nextSibling),l===null)break}return null}function ZR(l,d,m){if(d==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=xr(l.nextSibling),l===null))return null;return l}function Vb(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function QR(l,d){var m=l.ownerDocument;if(l.data!=="$?"||m.readyState==="complete")d();else{var x=function(){d(),m.removeEventListener("DOMContentLoaded",x)};m.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function xr(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return l}var Ub=null;function P3(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(d===0)return l;d--}else m==="/$"&&d++}l=l.previousSibling}return null}function B3(l,d,m){switch(d=Gf(m),l){case"html":if(l=d.documentElement,!l)throw Error(n(452));return l;case"head":if(l=d.head,!l)throw Error(n(453));return l;case"body":if(l=d.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function Ud(l){for(var d=l.attributes;d.length;)l.removeAttributeNode(d[0]);dc(l)}var Za=new Map,V3=new Set;function Wf(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var To=K.d;K.d={f:JR,r:e6,D:t6,C:s6,L:n6,m:a6,X:o6,S:r6,M:i6};function JR(){var l=To.f(),d=Ff();return l||d}function e6(l){var d=fr(l);d!==null&&d.tag===5&&d.type==="form"?lS(d):To.r(l)}var eu=typeof document>"u"?null:document;function U3(l,d,m){var x=eu;if(x&&typeof d=="string"&&d){var S=Kn(d);S='link[rel="'+l+'"][href="'+S+'"]',typeof m=="string"&&(S+='[crossorigin="'+m+'"]'),V3.has(S)||(V3.add(S),l={rel:l,crossOrigin:m,href:d},x.querySelector(S)===null&&(d=x.createElement("link"),In(d,"link",l),Us(d),x.head.appendChild(d)))}}function t6(l){To.D(l),U3("dns-prefetch",l,null)}function s6(l,d){To.C(l,d),U3("preconnect",l,d)}function n6(l,d,m){To.L(l,d,m);var x=eu;if(x&&l&&d){var S='link[rel="preload"][as="'+Kn(d)+'"]';d==="image"&&m&&m.imageSrcSet?(S+='[imagesrcset="'+Kn(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(S+='[imagesizes="'+Kn(m.imageSizes)+'"]')):S+='[href="'+Kn(l)+'"]';var j=S;switch(d){case"style":j=tu(l);break;case"script":j=su(l)}Za.has(j)||(l=p({rel:"preload",href:d==="image"&&m&&m.imageSrcSet?void 0:l,as:d},m),Za.set(j,l),x.querySelector(S)!==null||d==="style"&&x.querySelector(Gd(j))||d==="script"&&x.querySelector(Wd(j))||(d=x.createElement("link"),In(d,"link",l),Us(d),x.head.appendChild(d)))}}function a6(l,d){To.m(l,d);var m=eu;if(m&&l){var x=d&&typeof d.as=="string"?d.as:"script",S='link[rel="modulepreload"][as="'+Kn(x)+'"][href="'+Kn(l)+'"]',j=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=su(l)}if(!Za.has(j)&&(l=p({rel:"modulepreload",href:l},d),Za.set(j,l),m.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(Wd(j)))return}x=m.createElement("link"),In(x,"link",l),Us(x),m.head.appendChild(x)}}}function r6(l,d,m){To.S(l,d,m);var x=eu;if(x&&l){var S=co(x).hoistableStyles,j=tu(l);d=d||"default";var M=S.get(j);if(!M){var G={loading:0,preload:null};if(M=x.querySelector(Gd(j)))G.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":d},m),(m=Za.get(j))&&Gb(l,m);var ee=M=x.createElement("link");Us(ee),In(ee,"link",l),ee._p=new Promise(function(Ne,_e){ee.onload=Ne,ee.onerror=_e}),ee.addEventListener("load",function(){G.loading|=1}),ee.addEventListener("error",function(){G.loading|=2}),G.loading|=4,Hf(M,d,x)}M={type:"stylesheet",instance:M,count:1,state:G},S.set(j,M)}}}function o6(l,d){To.X(l,d);var m=eu;if(m&&l){var x=co(m).hoistableScripts,S=su(l),j=x.get(S);j||(j=m.querySelector(Wd(S)),j||(l=p({src:l,async:!0},d),(d=Za.get(S))&&Wb(l,d),j=m.createElement("script"),Us(j),In(j,"link",l),m.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},x.set(S,j))}}function i6(l,d){To.M(l,d);var m=eu;if(m&&l){var x=co(m).hoistableScripts,S=su(l),j=x.get(S);j||(j=m.querySelector(Wd(S)),j||(l=p({src:l,async:!0,type:"module"},d),(d=Za.get(S))&&Wb(l,d),j=m.createElement("script"),Us(j),In(j,"link",l),m.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},x.set(S,j))}}function G3(l,d,m,x){var S=(S=ue.current)?Wf(S):null;if(!S)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(d=tu(m.href),m=co(S).hoistableStyles,x=m.get(d),x||(x={type:"style",instance:null,count:0,state:null},m.set(d,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=tu(m.href);var j=co(S).hoistableStyles,M=j.get(l);if(M||(S=S.ownerDocument||S,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(l,M),(j=S.querySelector(Gd(l)))&&!j._p&&(M.instance=j,M.state.loading=5),Za.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Za.set(l,m),j||l6(S,l,m,M.state))),d&&x===null)throw Error(n(528,""));return M}if(d&&x!==null)throw Error(n(529,""));return null;case"script":return d=m.async,m=m.src,typeof m=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=su(m),m=co(S).hoistableScripts,x=m.get(d),x||(x={type:"script",instance:null,count:0,state:null},m.set(d,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function tu(l){return'href="'+Kn(l)+'"'}function Gd(l){return'link[rel="stylesheet"]['+l+"]"}function W3(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function l6(l,d,m,x){l.querySelector('link[rel="preload"][as="style"]['+d+"]")?x.loading=1:(d=l.createElement("link"),x.preload=d,d.addEventListener("load",function(){return x.loading|=1}),d.addEventListener("error",function(){return x.loading|=2}),In(d,"link",m),Us(d),l.head.appendChild(d))}function su(l){return'[src="'+Kn(l)+'"]'}function Wd(l){return"script[async]"+l}function H3(l,d,m){if(d.count++,d.instance===null)switch(d.type){case"style":var x=l.querySelector('style[data-href~="'+Kn(m.href)+'"]');if(x)return d.instance=x,Us(x),x;var S=p({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),Us(x),In(x,"style",S),Hf(x,m.precedence,l),d.instance=x;case"stylesheet":S=tu(m.href);var j=l.querySelector(Gd(S));if(j)return d.state.loading|=4,d.instance=j,Us(j),j;x=W3(m),(S=Za.get(S))&&Gb(x,S),j=(l.ownerDocument||l).createElement("link"),Us(j);var M=j;return M._p=new Promise(function(G,ee){M.onload=G,M.onerror=ee}),In(j,"link",x),d.state.loading|=4,Hf(j,m.precedence,l),d.instance=j;case"script":return j=su(m.src),(S=l.querySelector(Wd(j)))?(d.instance=S,Us(S),S):(x=m,(S=Za.get(j))&&(x=p({},m),Wb(x,S)),l=l.ownerDocument||l,S=l.createElement("script"),Us(S),In(S,"link",x),l.head.appendChild(S),d.instance=S);case"void":return null;default:throw Error(n(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(x=d.instance,d.state.loading|=4,Hf(x,m.precedence,l));return d.instance}function Hf(l,d,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,j=S,M=0;M<x.length;M++){var G=x[M];if(G.dataset.precedence===d)j=G;else if(j!==S)break}j?j.parentNode.insertBefore(l,j.nextSibling):(d=m.nodeType===9?m.head:m,d.insertBefore(l,d.firstChild))}function Gb(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.title==null&&(l.title=d.title)}function Wb(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.integrity==null&&(l.integrity=d.integrity)}var qf=null;function q3(l,d,m){if(qf===null){var x=new Map,S=qf=new Map;S.set(m,x)}else S=qf,x=S.get(m),x||(x=new Map,S.set(m,x));if(x.has(l))return x;for(x.set(l,null),m=m.getElementsByTagName(l),S=0;S<m.length;S++){var j=m[S];if(!(j[Fr]||j[Ss]||l==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var M=j.getAttribute(d)||"";M=l+M;var G=x.get(M);G?G.push(j):x.set(M,[j])}}return x}function K3(l,d,m){l=l.ownerDocument||l,l.head.insertBefore(m,d==="title"?l.querySelector("head > title"):null)}function c6(l,d,m){if(m===1||d.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return l=d.disabled,typeof d.precedence=="string"&&l==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function X3(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var Hd=null;function u6(){}function d6(l,d,m){if(Hd===null)throw Error(n(475));var x=Hd;if(d.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var S=tu(m.href),j=l.querySelector(Gd(S));if(j){l=j._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(x.count++,x=Kf.bind(x),l.then(x,x)),d.state.loading|=4,d.instance=j,Us(j);return}j=l.ownerDocument||l,m=W3(m),(S=Za.get(S))&&Gb(m,S),j=j.createElement("link"),Us(j);var M=j;M._p=new Promise(function(G,ee){M.onload=G,M.onerror=ee}),In(j,"link",m),d.instance=j}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(x.count++,d=Kf.bind(x),l.addEventListener("load",d),l.addEventListener("error",d))}}function h6(){if(Hd===null)throw Error(n(475));var l=Hd;return l.stylesheets&&l.count===0&&Hb(l,l.stylesheets),0<l.count?function(d){var m=setTimeout(function(){if(l.stylesheets&&Hb(l,l.stylesheets),l.unsuspend){var x=l.unsuspend;l.unsuspend=null,x()}},6e4);return l.unsuspend=d,function(){l.unsuspend=null,clearTimeout(m)}}:null}function Kf(){if(this.count--,this.count===0){if(this.stylesheets)Hb(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Xf=null;function Hb(l,d){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Xf=new Map,d.forEach(p6,l),Xf=null,Kf.call(l))}function p6(l,d){if(!(d.state.loading&4)){var m=Xf.get(l);if(m)var x=m.get(null);else{m=new Map,Xf.set(l,m);for(var S=l.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<S.length;j++){var M=S[j];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(m.set(M.dataset.precedence,M),x=M)}x&&m.set(null,x)}S=d.instance,M=S.getAttribute("data-precedence"),j=m.get(M)||x,j===x&&m.set(null,S),m.set(M,S),this.count++,x=Kf.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),j?j.parentNode.insertBefore(S,j.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(S,l.firstChild)),d.state.loading|=4}}var qd={$$typeof:I,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function f6(l,d,m,x,S,j,M,G){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ko(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ko(0),this.hiddenUpdates=Ko(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=j,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Y3(l,d,m,x,S,j,M,G,ee,Ne,_e,ze){return l=new f6(l,d,m,M,G,ee,Ne,ze),d=1,j===!0&&(d|=24),j=ja(3,null,null,d),l.current=j,j.stateNode=l,d=T0(),d.refCount++,l.pooledCache=d,d.refCount++,j.memoizedState={element:x,isDehydrated:m,cache:d},E0(j),l}function Z3(l){return l?(l=Rc,l):Rc}function Q3(l,d,m,x,S,j){S=Z3(S),x.context===null?x.context=S:x.pendingContext=S,x=ni(d),x.payload={element:m},j=j===void 0?null:j,j!==null&&(x.callback=j),m=ai(l,x,d),m!==null&&(Ea(m,l,d),Sd(m,l,d))}function J3(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<d?m:d}}function qb(l,d){J3(l,d),(l=l.alternate)&&J3(l,d)}function e4(l){if(l.tag===13){var d=Dc(l,67108864);d!==null&&Ea(d,l,67108864),qb(l,67108864)}}var Yf=!0;function m6(l,d,m,x){var S=B.T;B.T=null;var j=K.p;try{K.p=2,Kb(l,d,m,x)}finally{K.p=j,B.T=S}}function g6(l,d,m,x){var S=B.T;B.T=null;var j=K.p;try{K.p=8,Kb(l,d,m,x)}finally{K.p=j,B.T=S}}function Kb(l,d,m,x){if(Yf){var S=Xb(x);if(S===null)Ob(l,d,x,Zf,m),s4(l,x);else if(b6(S,l,d,m,x))x.stopPropagation();else if(s4(l,x),d&4&&-1<x6.indexOf(l)){for(;S!==null;){var j=fr(S);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var M=sn(j.pendingLanes);if(M!==0){var G=j;for(G.pendingLanes|=2,G.entangledLanes|=2;M;){var ee=1<<31-jt(M);G.entanglements[1]|=ee,M&=~ee}Ur(j),(es&6)===0&&(_f=Xe()+500,Pd(0))}}break;case 13:G=Dc(j,2),G!==null&&Ea(G,j,2),Ff(),qb(j,2)}if(j=Xb(x),j===null&&Ob(l,d,x,Zf,m),j===S)break;S=j}S!==null&&x.stopPropagation()}else Ob(l,d,x,null,m)}}function Xb(l){return l=wc(l),Yb(l)}var Zf=null;function Yb(l){if(Zf=null,l=lo(l),l!==null){var d=o(l);if(d===null)l=null;else{var m=d.tag;if(m===13){if(l=i(d),l!==null)return l;l=null}else if(m===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null)}}return Zf=l,null}function t4(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(st()){case St:return 2;case pt:return 8;case Ve:case Je:return 32;case mt:return 268435456;default:return 32}default:return 32}}var Zb=!1,xi=null,bi=null,yi=null,Kd=new Map,Xd=new Map,vi=[],x6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function s4(l,d){switch(l){case"focusin":case"focusout":xi=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Kd.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xd.delete(d.pointerId)}}function Yd(l,d,m,x,S,j){return l===null||l.nativeEvent!==j?(l={blockedOn:d,domEventName:m,eventSystemFlags:x,nativeEvent:j,targetContainers:[S]},d!==null&&(d=fr(d),d!==null&&e4(d)),l):(l.eventSystemFlags|=x,d=l.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),l)}function b6(l,d,m,x,S){switch(d){case"focusin":return xi=Yd(xi,l,d,m,x,S),!0;case"dragenter":return bi=Yd(bi,l,d,m,x,S),!0;case"mouseover":return yi=Yd(yi,l,d,m,x,S),!0;case"pointerover":var j=S.pointerId;return Kd.set(j,Yd(Kd.get(j)||null,l,d,m,x,S)),!0;case"gotpointercapture":return j=S.pointerId,Xd.set(j,Yd(Xd.get(j)||null,l,d,m,x,S)),!0}return!1}function n4(l){var d=lo(l.target);if(d!==null){var m=o(d);if(m!==null){if(d=m.tag,d===13){if(d=i(m),d!==null){l.blockedOn=d,Rn(l.priority,function(){if(m.tag===13){var x=Aa();x=Or(x);var S=Dc(m,x);S!==null&&Ea(S,m,x),qb(m,x)}});return}}else if(d===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Qf(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var m=Xb(l.nativeEvent);if(m===null){m=l.nativeEvent;var x=new m.constructor(m.type,m);vc=x,m.target.dispatchEvent(x),vc=null}else return d=fr(m),d!==null&&e4(d),l.blockedOn=m,!1;d.shift()}return!0}function a4(l,d,m){Qf(l)&&m.delete(d)}function y6(){Zb=!1,xi!==null&&Qf(xi)&&(xi=null),bi!==null&&Qf(bi)&&(bi=null),yi!==null&&Qf(yi)&&(yi=null),Kd.forEach(a4),Xd.forEach(a4)}function Jf(l,d){l.blockedOn===d&&(l.blockedOn=null,Zb||(Zb=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,y6)))}var em=null;function r4(l){em!==l&&(em=l,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){em===l&&(em=null);for(var d=0;d<l.length;d+=3){var m=l[d],x=l[d+1],S=l[d+2];if(typeof x!="function"){if(Yb(x||m)===null)continue;break}var j=fr(m);j!==null&&(l.splice(d,3),d-=3,Y0(j,{pending:!0,data:S,method:m.method,action:x},x,S))}}))}function Zd(l){function d(ee){return Jf(ee,l)}xi!==null&&Jf(xi,l),bi!==null&&Jf(bi,l),yi!==null&&Jf(yi,l),Kd.forEach(d),Xd.forEach(d);for(var m=0;m<vi.length;m++){var x=vi[m];x.blockedOn===l&&(x.blockedOn=null)}for(;0<vi.length&&(m=vi[0],m.blockedOn===null);)n4(m),m.blockedOn===null&&vi.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var S=m[x],j=m[x+1],M=S[Cs]||null;if(typeof j=="function")M||r4(m);else if(M){var G=null;if(j&&j.hasAttribute("formAction")){if(S=j,M=j[Cs]||null)G=M.formAction;else if(Yb(S)!==null)continue}else G=M.action;typeof G=="function"?m[x+1]=G:(m.splice(x,3),x-=3),r4(m)}}}function Qb(l){this._internalRoot=l}tm.prototype.render=Qb.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(n(409));var m=d.current,x=Aa();Q3(m,x,l,d,null,null)},tm.prototype.unmount=Qb.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;Q3(l.current,2,null,l,null,null),Ff(),d[za]=null}};function tm(l){this._internalRoot=l}tm.prototype.unstable_scheduleHydration=function(l){if(l){var d=Qe();l={blockedOn:null,target:l,priority:d};for(var m=0;m<vi.length&&d!==0&&d<vi[m].priority;m++);vi.splice(m,0,l),m===0&&n4(l)}};var o4=e.version;if(o4!=="19.1.0")throw Error(n(527,o4,"19.1.0"));K.findDOMNode=function(l){var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=u(d),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var v6={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sm.isDisabled&&sm.supportsFiber)try{Dt=sm.inject(v6),zt=sm}catch(l){}}return Jd.createRoot=function(l,d){if(!a(l))throw Error(n(299));var m=!1,x="",S=NS,j=SS,M=CS,G=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(S=d.onUncaughtError),d.onCaughtError!==void 0&&(j=d.onCaughtError),d.onRecoverableError!==void 0&&(M=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(G=d.unstable_transitionCallbacks)),d=Y3(l,1,!1,null,null,m,x,S,j,M,G,null),l[za]=d.current,_b(l),new Qb(d)},Jd.hydrateRoot=function(l,d,m){if(!a(l))throw Error(n(299));var x=!1,S="",j=NS,M=SS,G=CS,ee=null,Ne=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(S=m.identifierPrefix),m.onUncaughtError!==void 0&&(j=m.onUncaughtError),m.onCaughtError!==void 0&&(M=m.onCaughtError),m.onRecoverableError!==void 0&&(G=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(ee=m.unstable_transitionCallbacks),m.formState!==void 0&&(Ne=m.formState)),d=Y3(l,1,!0,d,m!=null?m:null,x,S,j,M,G,ee,Ne),d.context=Z3(null),m=d.current,x=Aa(),x=Or(x),S=ni(x),S.callback=null,ai(m,S,x),m=x,d.current.lanes=m,nn(d,m),Ur(d),l[za]=d.current,_b(l),new tm(d)},Jd.version="19.1.0",Jd}var f4;function P6(){if(f4)return e1.exports;f4=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),e1.exports=z6(),e1.exports}var B6=P6();const V6="/assets/home_main-DRHPcj5p.webp",U6="/assets/1-DPRo4wFK.webp",G6="/assets/01-BbHcUcs_.webp",W6="/assets/3-KJkxwrpE.webp",H6="/assets/4-C2gApwXz.webp",q6="/assets/rt-g7O3rNtP.webp",K6="/assets/1-BZ5CiQTk.webp",X6="/assets/2-DHaWy7VR.webp",Y6="/assets/3-sGUhpjh7.webp",Z6="/assets/4-B_Ks_Ass.webp",Q6="/assets/5-Zwpwl2zO.webp",J6="/assets/6-CpCwxMKU.webp",e5="/assets/1-BtDeZQgS.webp",m4="/assets/2-fVtxl_Xa.webp",t5="/assets/3-B-tCmESF.webp",s5="/assets/4-DsXMmwIY.webp",n5="/assets/5-CAmuOKu0.webp",a5="/assets/6-D4WIwbRx.webp",r5="/assets/7-Copt7q84.webp",o5="/assets/8-qe6FMvW6.webp",i5="/assets/9-CLDY04tP.webp",l5="/assets/1-BFB0Wtqm.webp",c5="/assets/2-BbOEF5Ga.webp",u5="/assets/3-CtIKDcst.webp",d5="/assets/4-DSRfeNda.webp",h5="/assets/5-DsqII3x1.webp",p5="/assets/6-BooEANJA.webp",f5="/assets/7-DzV2O-VW.webp",m5="/assets/8-eZFu9_Tx.webp",g5="/assets/9-Bw6rQKm4.webp",x5="/assets/10-DqLecErO.webp",b5="/assets/11-DUoj5H9T.webp",y5="/assets/12-SVTMo18I.webp",v5="/assets/13-eCfY0g4f.webp",ig="/assets/totalsolutions-DyWg9idw.webp",w5=[{image:e5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Bowenpally",phone:"+91 88865 78697  ",color:"bg-cyan-500",imageAlt:"Total Solution Rehabilitation Society Bowenpally"},{image:m4,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Barkatpura",phone:"+91 88864 78697 ",color:"bg-red-500",imageAlt:"Total Solution Rehabilitation Society Barkatpura"},{image:t5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Kukatpally",phone:"+91 90632 08697 ",color:"bg-lime-500",imageAlt:"Total Solution Rehabilitation Society Kukatpally"},{image:s5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Suchitra",phone:"+91 99594 18697 ",color:"bg-yellow-400",imageAlt:"Total Solution Rehabilitation Society Suchitra"},{image:n5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Banjara Hills",phone:"+91 87905 88697",color:"bg-fuchsia-500",imageAlt:"Total Solution Rehabilitation Society Banjara Hills"},{image:a5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Manikonda",phone:"+91 89786 88697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Manikonda"},{image:r5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Nacharam",phone:"+91 90003 28697 ",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Nacharam"},{image:o5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Neredmet",phone:"+91 90003 48697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Neredmet"},{image:i5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Champapet",phone:"+91 99493 08697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Champapet"},{image:m4,name:"SPECIAL EDUCATION CENTER",location:"Barkatpura",phone:"+91 70754 88697",color:"bg-orange-400",imageAlt:"Total Solution Special Education Center Barkatpura"}],N5=[{name:"Assessment & Evaluation",image:K6,path:"/services/assessment-evaluation"},{name:"Occupational Therapy",image:X6,path:"/services/occupational-therapy"},{name:"Behaviour Therapy",image:Y6,path:"/services/behaviour-therapy"},{name:"Remedial Therapy",image:Z6,path:"/services/remedial-therapy"},{name:"Behaviour Modification",image:Q6,path:"/services/behaviour-modification"},{name:"Speech Therapy",image:J6,path:"/services/speech-therapy"}],n1=[{src:V6,alt:"Total Solution Rehabilitation Center - Image 1"},{src:U6,alt:"Total Solution Rehabilitation Center - Image 2"},{src:G6,alt:"Total Solution Rehabilitation Center - Image 3"},{src:W6,alt:"Total Solution Rehabilitation Center - Image 4"},{src:H6,alt:"Total Solution Rehabilitation Center - Image 5"},{src:q6,alt:"Total Solution Rehabilitation Center - Image 6"}],a1=[l5,c5,u5,d5,h5,p5,f5,m5,g5,x5,b5,y5,v5];function S5(){var h;const s=F.useRef(null),[e,t]=F.useState(0),[n,a]=F.useState(0),o=3,i=p=>{const f=n1.length;let g=p==="next"?(e+1)%f:(e-1+f)%f;t(g),s.current&&(s.current.style.transform="translateX(-".concat(g*100,"%)"))},c=()=>{n<a1.length-o&&a(n+1)},u=()=>{n>0&&a(n-1)};return r.jsxs("div",{children:[r.jsxs(Ey,{children:[r.jsx("title",{children:"Total Solution for Learning | Rehabilitation, Therapy & Support"}),r.jsx("meta",{name:"description",content:"Total Solution for Learning provides comprehensive rehabilitation services and learning support for children with autism, ADHD, learning difficulties & developmental disorders in Hyderabad."}),r.jsx("meta",{name:"keywords",content:"total solution, total solution for learning, total solution rehabilitation society, totalsolution4learning, development disorders, emotional difficulties, rehabilitation center Hyderabad, autism therapy, ADHD treatment, learning difficulties, special education, speech therapy, occupational therapy"}),r.jsx("meta",{name:"author",content:"Total Solution"}),r.jsx("meta",{property:"og:title",content:"Total Solution Rehabilitation society"}),r.jsx("meta",{property:"og:description",content:"Helping children with learning and developmental difficulties through expert therapy and professional care."}),r.jsx("meta",{property:"og:image",content:ig,alt:"Total Solution for Learning"}),r.jsx("meta",{property:"og:url",content:"https://totalsolutionforlearning.org"}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org"}),r.jsx("link",{rel:"preload",as:"image",fetchPriority:"high",href:(h=n1[0])==null?void 0:h.src,type:"image/webp"}),r.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"MedicalClinic",name:"Total Solution for Learning",url:"https://totalsolutionforlearning.org",description:"Total Solution for Learning is a leading therapy and rehabilitation center in Hyderabad, specializing in autism, ADHD, dyslexia, and other developmental disorders.",address:{"@type":"PostalAddress",addressLocality:"Hyderabad",addressCountry:"IN"},medicalSpecialty:["AssessmentEvaluation","BehaviourModification","BehaviourTherapy","SpeechTherapy","OccupationalTherapy","RemedialTherapy"]})}}),r.jsx("meta",{name:"robots",content:"index, follow"})]}),r.jsxs("div",{className:"relative w-full  overflow-hidden mx-auto",children:[r.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",ref:s,children:n1.map((p,f)=>r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.src,type:"image/webp"}),r.jsx("img",{src:p.src,alt:p.alt,width:1200,height:800,loading:f===0?"eager":"lazy",fetchPriority:f===0?"high":"auto",decoding:"async",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})]})},f))}),r.jsxs("div",{className:"absolute top-1/2 left-0 right-0 flex justify-between transform -translate-y-1/2 px-6",children:[r.jsx("button",{onClick:()=>i("prev"),className:"bg-white/80 hover:bg-white text-black font-semibold py-2 px-4 rounded-full shadow",children:"Previous"}),r.jsx("button",{onClick:()=>i("next"),className:"bg-white/80 hover:bg-white text-black font-semibold py-2 px-4 rounded-full shadow",children:"Next"})]})]}),r.jsx("div",{className:"py-10 bg-white",children:r.jsx("div",{className:"container mx-auto px-4",children:r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6 px-4",children:N5.map((p,f)=>r.jsxs("div",{className:"relative w-full aspect-square max-w-[180px] mx-auto",children:[r.jsx(nt,{to:p.path,className:"absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-300 hover:opacity-100 z-10 bg-[#ab1c1c] rounded-full",children:r.jsx("span",{className:"text-white text-sm md:text-base font-semibold text-center px-2",children:p.name})}),r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.image,type:"image/webp"}),r.jsx("img",{src:p.image,alt:"".concat(p.name," therapy"),width:180,height:180,loading:"lazy",decoding:"async",className:"relative w-full h-full flex items-center justify-center bg-[#ab1c1c] rounded-full transition-opacity duration-300 hover:opacity-0"})]})]},f))})})}),r.jsxs("section",{className:"bg-white px-4 md:px-16 py-12 text-gray-800",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-center text-blue-900",children:"Welcome to Total Solution Rehabilitation Society"}),r.jsx("div",{className:"w-24 h-1 bg-red-600 mx-auto mt-2 mb-8"}),r.jsx("p",{className:"max-w-6xl mx-auto text-lg text-justify",children:"We are a provider of rehabilitation services for children with Developmental Disorders, Learning Difficulties and Emotional Difficulties. With over 15 years of experience in providing a flexible and varied range of services, including life skills training, packages for out of station clients, home based programs, and school based rehabilitation. The people we support may have a range of needs that require intensive support, including:"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 mt-6 max-w-6xl mx-auto",children:["Autism Spectrum Disorder (ASD).","Sensory processing difficulties.","Epilepsy.","Learning Disorders (SLD).","Attention Deficit Disorder (ADD).","Attention Deficit Hyperactive Disorder (ADHD).","Children with Behavioural challenges and emotional difficulties.","School Rejection","Phobia"].map((p,f)=>r.jsxs("div",{className:"flex items-start space-x-2",children:[r.jsx("span",{className:"text-blue-600",children:""}),r.jsx("p",{children:p})]},f))}),r.jsxs("div",{className:"max-w-6xl mx-auto mt-8 space-y-6 text-lg text-justify",children:[r.jsx("p",{children:"We have succeeded in supporting children to live independently with their own assured tenancies when previously they were in secure accommodation. We aim to support each individual to integrate fully into their local community and live the life of their choice. This is based on a culture of person centered planning and, where appropriate, the use of assistive technology to help people become more independent."}),r.jsx("p",{children:"Total solution Rehabilitation Society has policies in place to ensure all children have equal opportunity to achieve their educational goals. The primary aim of Total solution Rehabilitation Society is to provide confidential support for children identified with Learning Difficulties in, Attention Deficit Hyperactivity Disorder (ADHD) or Autism Spectrum Disorder (ASD), in order to facilitate their academic, personal and career goals."}),r.jsx("p",{children:"Special Education Centre (SEC) is an initiative by Total Solution Rehabilitation Society (TSRS) for rehabilitation of children with special needs in 2018. It was started at Barkatpura as a need to give special education services to children who were not able to gain admission or adjust in a regular school. As on day, the SEC has 25 children with autism spectrum disorder, cerebral palsy, cognitive impairment, downs syndrome, visual impairment and multiple disabilitiestoo."})]})]}),r.jsxs("section",{className:"bg-gray-200 py-12 px-4 text-center",children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-blue-900",children:"Our Branches and Services"}),r.jsx("div",{className:"w-20 h-1 bg-red-600 mx-auto my-2"}),r.jsx("div",{className:"max-w-6xl mx-auto px-4 mt-10",children:r.jsx("div",{className:" grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-10",children:w5.map((p,f)=>r.jsxs("div",{className:"rounded shadow-lg overflow-hidden bg-white",children:[r.jsx("div",{className:"".concat(p.color," p-1"),children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.image,type:"image/webp"}),r.jsx("img",{src:p.image,alt:"".concat(p.name," location in ").concat(p.location),width:400,height:300,loading:"lazy",decoding:"async",className:"w-full h-full object-cover"})]})}),r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:p.name}),r.jsx("p",{className:"text-gray-600 mb-2 text-xl",children:p.location}),r.jsxs("p",{className:"text-red-700 text-sm font-medium",children:["Contact Number : ",p.contact]}),r.jsx("p",{className:"text-gray-800 font-semibold",children:p.phone})]})]},f))})})]}),r.jsxs("section",{className:"bg-white py-10",children:[r.jsx("h2",{className:"text-2xl font-bold text-center text-blue-900",children:"Treatment"}),r.jsx("div",{className:"w-20 h-1 bg-red-600 mx-auto my-2"}),r.jsxs("div",{className:"relative max-w-6xl mx-auto px-4",children:[r.jsx("div",{className:"overflow-hidden",children:r.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:"translateX(-".concat(n*(100/o),"%)")},children:a1.map((p,f)=>r.jsxs("picture",{children:[r.jsx("source",{srcSet:p,type:"image/webp"}),r.jsx("img",{src:p,alt:"Treatment method ".concat(f+1),width:400,height:300,loading:"lazy",decoding:"async",className:"w-full sm:w-1/2 md:w-1/3 flex-shrink-0 object-cover p-2"})]},f))})}),r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2",children:r.jsx("button",{onClick:u,className:"bg-white border rounded-full p-2 shadow hover:bg-gray-100",disabled:n===0,children:""})}),r.jsx("div",{className:"absolute top-1/2 right-0 transform -translate-y-1/2",children:r.jsx("button",{onClick:c,className:"bg-white border rounded-full p-2 shadow hover:bg-gray-100",disabled:n>=a1.length-o,children:""})})]})]})]})}function C5(s){return Un({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"},child:[]}]})(s)}function k5(s){return Un({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(s)}function j5(s){return Un({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(s)}function T5(s){return Un({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"},child:[]}]})(s)}function I5(s){return Un({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(s)}function g4(s){return Un({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M576 240c0-23.63-12.95-44.04-32-55.12V32.01C544 23.26 537.02 0 512 0c-7.12 0-14.19 2.38-19.98 7.02l-85.03 68.03C364.28 109.19 310.66 128 256 128H64c-35.35 0-64 28.65-64 64v96c0 35.35 28.65 64 64 64h33.7c-1.39 10.48-2.18 21.14-2.18 32 0 39.77 9.26 77.35 25.56 110.94 5.19 10.69 16.52 17.06 28.4 17.06h74.28c26.05 0 41.69-29.84 25.9-50.56-16.4-21.52-26.15-48.36-26.15-77.44 0-11.11 1.62-21.79 4.41-32H256c54.66 0 108.28 18.81 150.98 52.95l85.03 68.03a32.023 32.023 0 0 0 19.98 7.02c24.92 0 32-22.78 32-32V295.13C563.05 284.04 576 263.63 576 240zm-96 141.42l-33.05-26.44C392.95 311.78 325.12 288 256 288v-96c69.12 0 136.95-23.78 190.95-66.98L480 98.58v282.84z"},child:[]}]})(s)}function x4(s){return Un({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(s)}function r1(s){return Un({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(s)}function o1(s){return Un({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(s)}function Tk(s){return Un({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(s)}function $5(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(s)}function A5(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(s)}function E5(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(s)}function D5(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(s)}function Ik(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(s)}function R5(s){return Un({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(s)}function _5({isOpen:s,onClose:e}){const t=xs();if(!s)return null;const n=a=>{a.target===a.currentTarget&&e(),a.target.name==="register"?t("/register"):a.target.name==="login"&&t("/login")};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto p-8",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsx("button",{to:"/register",name:"register",className:"bg-red-700 hover:bg-red-800 text-white font-medium py-2 px-6 rounded-full transition-colors duration-300 shadow-md",onClick:n,children:"Register"}),r.jsx("button",{to:"/login",name:"login",className:"bg-red-700 hover:bg-red-800 text-white font-medium py-2 px-6 rounded-full transition-colors duration-300 shadow-md",onClick:n,children:"Login"}),r.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(Tk,{className:"text-2xl"})})]}),r.jsxs("div",{className:"p-2 mb-3",children:[r.jsx("h1",{className:"text-red-600 text-3xl font-bold text-center mb-5",children:"Make an Appointment"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Bowenpally",phone:"+91 88865 78697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Barkatpura",phone:"+91 88864 78697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Kukatpally",phone:"+91 90632 08697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Suchitra",phone:"+91 99594 18697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Banjara Hills",phone:"+91 87905 88697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Manikonda",phone:"+91 89786 88697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Nacharam",phone:"+91 90003 28697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Neredmet",phone:"+91 90003 48697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Champapet",phone:"+91 99493 08697"}),r.jsx(Gr,{name:"Special Education Center",location:"Barkatpura",phone:"+91 70754 88697"})]})]})]})})}function Gr({name:s,location:e,phone:t}){return r.jsxs("div",{className:"border border-red-800 rounded p-4 h-full flex flex-col",children:[r.jsxs("h2",{className:"text-xl font-medium text-center flex-grow",children:[s,",",r.jsx("br",{}),e]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("a",{href:"tel:".concat(t),className:"border border-red-600 text-red-600 rounded-full px-6 py-2 inline-block hover:bg-red-50 transition-colors",children:t})})]})}const O5={user:null,isAuthenticated:!1},$k=wk({name:"auth",initialState:O5,reducers:{login:(s,e)=>{s.user=e.payload,s.isAuthenticated=!0},logout:s=>{s.user=null,s.isAuthenticated=!1},addPropery:(s,e)=>{s.user.details[e.payload.key]=e.payload.value}}}),{login:Ak,logout:Ry,addPropery:F5}=$k.actions,L5=$k.reducer;function M5({menuRef:s}){var h;const e=jh(),t=xs(),n=Ml(p=>p.auth.user),a=(h=n==null?void 0:n.details)==null?void 0:h.name,[o,i]=F.useState(!1),c=F.useRef(null);F.useEffect(()=>{function p(f){(s!=null&&s.current&&!s.current.contains(f.target)||c.current&&!c.current.contains(f.target))&&i(!1)}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[s]);const u=()=>{const p=sessionStorage.getItem("role");sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem("".concat(p,"Id")),e(Ry()),t("/login"),i(!1)};return r.jsxs("div",{className:"relative",ref:c,children:[r.jsxs("button",{onClick:()=>i(!o),className:"flex items-center space-x-2 py-2 border-b-2 border-transparent hover:border-[#ab1c1c] focus:border-[#ab1c1c] cursor-pointer","aria-label":"User profile",children:[r.jsx(Ik,{className:"text-[#ab1c1c] text-2xl"}),r.jsx("span",{className:"text-[#ab1c1c] text-base lg:text-lg",children:a||"User"})]}),o&&r.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-black/90 text-white rounded-lg shadow-lg z-50",children:r.jsxs("ul",{className:"py-2",children:[r.jsx("li",{children:r.jsx(nt,{to:"/profile",className:"block px-4 py-2 hover:bg-red-900 transition-colors",onClick:()=>i(!1),children:"Profile"})}),r.jsx("li",{children:r.jsx("button",{onClick:u,className:"block w-full text-left px-4 py-2 hover:bg-red-900 transition-colors",children:"Logout"})})]})})]})}function b4({setIsMenuOpen:s}){return r.jsxs(r.Fragment,{children:[r.jsxs("ul",{className:"items-stretch hidden font-bold  space-x-3 lg:flex",children:[r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Dashboard"})}),r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard/register",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Register"})}),r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard/existingusers",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Import"})}),r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard/viewappointment",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"View Appointments"})}),r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard/manageappointment",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Manage Appointments"})}),r.jsx("li",{className:"flex",children:r.jsx(nt,{to:"/admindashboard/jwlenquiries",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"JWL Enquiries"})})]}),r.jsxs("ul",{className:"lg:hidden w-full divide-y divide-gray-200",children:[r.jsx("li",{children:r.jsx(nt,{to:"/admindashboard/register",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Register"})}),r.jsx("li",{children:r.jsx(nt,{to:"/admindashboard/existingusers",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Import"})}),r.jsx("li",{children:r.jsx(nt,{to:"/admindashboard/viewappointment",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"View Appointments"})}),r.jsx("li",{children:r.jsx(nt,{to:"/admindashboard/manageappointment",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Manage Appointments"})}),r.jsx("li",{children:r.jsx(nt,{to:"/admindashboard/jwlenquiries",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"JWL Enquiries"})})]})]})}function y4({isMobileMenuOpen:s}){const e=Ml(n=>n.auth.isAuthenticated),t=sessionStorage.getItem("role");return r.jsx("div",{children:e&&t==="No-service-role"&&r.jsxs("div",{className:"container lg:mx-auto lg:mt-1 lg:p-2",children:[r.jsx("div",{className:"hidden lg:flex justify-between ",children:t==="admin"&&r.jsx(b4,{})}),s&&r.jsx("div",{className:"lg:hidden ",children:t==="admin"&&r.jsx(b4,{})})]})})}const z5=({userRole:s})=>{const[e,t]=F.useState([]),n=xs(),a=o=>{o&&(o.startsWith("http://")||o.startsWith("https://")?window.open(o,"_blank","noopener,noreferrer"):n(o))};return F.useEffect(()=>{(async()=>{var i,c;try{const u=sessionStorage.getItem("token"),h=u?{Authorization:"".concat(u)}:{},p=await Le.get("/api/superadmin/announcements",{headers:h}),f=Array.isArray(p.data)?p.data:Array.isArray(p.data.data)?p.data.data:[];if(!Array.isArray(f)){console.error("Announcements response is not an array:",p.data),t([]);return}const g=new Date,b=f.filter(y=>{var N;if(!y.displayInScroller)return!1;const v=new Date(y.createdAt);return(g-v)/(1e3*60*60)>24?!1:s==="superadmin"||s==="public"&&y.targetType==="public"||y.targetType==="all"||!y.targetType?!0:y.targetType==="specific"&&s&&s!=="public"?(N=y.targetRoles)==null?void 0:N.includes(s):!1});t(b)}catch(u){console.error("Error fetching announcements:",u),(((i=u.response)==null?void 0:i.status)===401||((c=u.response)==null?void 0:c.status)===403)&&console.log("No authentication token for public user - this is expected"),t([])}})()},[s]),e.length===0?null:r.jsxs("div",{className:"bg-[#fde8e8] text-[#ab1c1c] py-2 overflow-hidden shadow-sm border-b border-[#fca5a5]",children:[r.jsx("div",{className:"animate-marquee whitespace-nowrap",children:e.map((o,i)=>o.link?r.jsxs("span",{className:"mx-10 font-medium cursor-pointer hover:underline hover:text-[#8b1515] transition-colors",onClick:()=>a(o.link),title:"Click to visit: ".concat(o.link),children:[" ",o.message]},o._id||i):r.jsxs("span",{className:"mx-10 font-medium",children:[" ",o.message]},o._id||i))}),r.jsx("style",{children:"\n        @keyframes marquee {\n          0% { transform: translateX(100%); }\n          100% { transform: translateX(-100%); }\n        }\n        .animate-marquee {\n          display: inline-block;\n          animation: marquee 25s linear infinite;\n        }\n      "})]})};function P5(){var T;const[s,e]=F.useState(!1),[t,n]=F.useState(null),[a,o]=F.useState(!1),i=F.useRef(null),c=F.useRef(null),u=F.useRef(null),h=Ml($=>$.auth.isAuthenticated),p=sessionStorage.getItem("role"),f=Ml($=>$.auth.user),g=(T=f==null?void 0:f.details)==null?void 0:T.name,b=[{label:"Who we are?",path:"/aboutus/whoarewe"},{label:"Why Us?",path:"/aboutus/whyus"},{label:"Founder Messages",path:"/aboutus/foundermessages"},{label:"Goals of Total Solution",path:"/aboutus/goals"},{label:"Research Department",path:"/aboutus/research"}],y=[{label:"Assessment & Evaluation",path:"/services/assessment-evaluation"},{label:"Occupational Therapy",path:"/services/occupational-therapy"},{label:"Behaviour Therapy",path:"/services/behaviour-therapy"},{label:"Remedial Therapy",path:"/services/remedial-therapy"},{label:"Behaviour Modification",path:"/services/behaviour-modification"},{label:"Speech Therapy",path:"/services/speech-therapy"}],v=[{label:"Photo Gallery",path:"/media/photos"},{label:"Video Gallery",path:"/media/videos"}],w=F.useCallback($=>{n(E=>E===$?null:$)},[]),N=F.useCallback($=>{clearTimeout(i.current),n($)},[]),C=F.useCallback(()=>{i.current=setTimeout(()=>{n(null)},300)},[]);F.useEffect(()=>{const $=E=>{var _,L;!((_=c.current)!=null&&_.contains(E.target))&&!((L=u.current)!=null&&L.contains(E.target))&&e(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[]),F.useEffect(()=>{const $=()=>{window.innerWidth>=768&&(e(!1),n(null))};return window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]),F.useEffect(()=>()=>clearTimeout(i.current),[]);const I=()=>{const $=sessionStorage.getItem("role");sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem("".concat($,"Id")),e(!1)};return r.jsxs(r.Fragment,{children:[r.jsxs("nav",{className:"w-full shadow-md bg-white px-4 sm:px-6 py-3 flex items-center justify-between relative z-50",children:[r.jsxs("div",{className:"flex items-center justify-between w-full md:w-auto",children:[r.jsx(nt,{to:"/",className:"flex items-center gap-3",children:r.jsx("img",{src:ig,alt:"Total Solution Logo",width:"200",height:"50",className:"h-10 md:h-12 w-auto"})}),r.jsx("button",{ref:u,className:"md:hidden text-[#ab1c1c] text-2xl",onClick:()=>e(!s),"aria-label":s?"Close menu":"Open menu",children:s?r.jsx(Tk,{}):r.jsx(I5,{})})]}),h?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden md:flex gap-4 items-center",children:[r.jsxs(nt,{to:"/announcements",className:"group relative flex items-center justify-center w-10 h-10 rounded-full bg-[#ab1c1c] hover:bg-[#8d1717] transition-all duration-300 shadow-md",children:[r.jsx(g4,{className:"text-white text-xl"}),r.jsx("span",{className:"absolute top-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded-md px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 mt-2",children:"Announcements"})]}),r.jsxs(nt,{to:p==="superadmin"?"/superadmin/dashboard":"/".concat(p,"dashboard"),className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:[p.charAt(0).toUpperCase()+p.substring(1)," Dashboard"]}),r.jsx(nt,{to:"/calendar",className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",children:"Calendar"}),p==="therapist"&&r.jsx(r.Fragment,{children:r.jsx(nt,{to:"/codeofconduct",className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",children:"Code of Conduct"})}),r.jsx(M5,{menuRef:c})]}),s&&r.jsxs("div",{ref:c,className:"md:hidden absolute top-full left-0 right-0 bg-white shadow-lg z-50 px-4 py-2 animate-fadeIn max-h-[calc(100vh-80px)] overflow-y-auto",children:[r.jsxs(nt,{to:p==="superadmin"?"/superadmin/dashboard":"/".concat(p,"dashboard"),className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:[p.charAt(0).toUpperCase()+p.substring(1)," Dashboard"]}),r.jsx(nt,{to:"/calendar",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Calendar"}),p==="therapist"&&r.jsx(r.Fragment,{children:r.jsx(nt,{to:"/code-of-conduct",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Code of Conduct"})}),r.jsxs(nt,{to:"/announcements",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:[r.jsx(g4,{className:"inline mr-2"}),"Announcements"]}),r.jsx(y4,{isMobileMenuOpen:s,setIsMenuOpen:e}),r.jsxs("div",{className:"border-b py-3 flex items-center gap-2",children:[r.jsx(Ik,{className:"text-[#ab1c1c] text-xl"}),r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:g||"User"})]}),r.jsx(nt,{to:"/profile",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Profile"}),r.jsx(nt,{to:"/login",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:I,children:"Logout"})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden md:flex gap-4 lg:gap-6 items-center relative",children:[r.jsx(nt,{to:"/",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Home"}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("about"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="about"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"About Us"}),r.jsx("div",{className:"absolute ".concat(t==="about"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:b.map(($,E)=>r.jsx(nt,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},E))})]}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("services"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="services"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"Services"}),r.jsx("div",{className:"absolute ".concat(t==="services"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:y.map(($,E)=>r.jsx(nt,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},E))})]}),r.jsx(nt,{to:"/training",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Training"}),r.jsx(nt,{to:"/ourbranches",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Our Branches"}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("media"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="media"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"Media"}),r.jsx("div",{className:"absolute ".concat(t==="media"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:v.map(($,E)=>r.jsx(nt,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},E))})]}),r.jsxs("div",{className:"group flex items-center gap-2 hover:bg-[#ab1c1c] rounded transition-colors px-2 py-1",children:[r.jsx(nt,{to:"/contact",className:"text-base lg:text-lg font-medium text-[#ab1c1c] group-hover:text-white",children:"Contact Us"}),r.jsx(x4,{className:"text-[#ab1c1c] text-xl group-hover:text-white"})]}),r.jsx("button",{className:"border border-[#ab1c1c] text-[#ab1c1c] font-semibold px-3 lg:px-4 py-1 rounded-full hover:bg-[#ab1c1c] hover:text-white transition-all text-sm lg:text-base",onClick:()=>o(!0),children:"Appointment"})]}),s&&r.jsxs("div",{ref:c,className:"md:hidden absolute top-full left-0 right-0 bg-white shadow-lg z-50 px-4 py-2 animate-fadeIn max-h-[calc(100vh-80px)] overflow-y-auto",children:[r.jsx(nt,{to:"/",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Home"}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>w("about"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"About Us"}),t==="about"?r.jsx(r1,{}):r.jsx(o1,{})]}),t==="about"&&r.jsx("div",{className:"pb-2 pl-4",children:b.map(($,E)=>r.jsx(nt,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},E))})]}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>w("services"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"Services"}),t==="services"?r.jsx(r1,{}):r.jsx(o1,{})]}),t==="services"&&r.jsx("div",{className:"pb-2 pl-4",children:y.map(($,E)=>r.jsx(nt,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},E))})]}),r.jsx(nt,{to:"/training",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Training"}),r.jsx(nt,{to:"/ourbranches",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Our Branches"}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>w("media"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"Media"}),t==="media"?r.jsx(r1,{}):r.jsx(o1,{})]}),t==="media"&&r.jsx("div",{className:"pb-2 pl-4",children:v.map(($,E)=>r.jsx(nt,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},E))})]}),r.jsxs(nt,{to:"/contact",className:"flex items-center gap-2 py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:["Contact Us"," ",r.jsx(x4,{className:"text-[#ab1c1c] text-xl"})]}),r.jsx("button",{className:"w-full border border-[#ab1c1c] text-[#ab1c1c] font-semibold px-4 py-2 rounded-full my-3 hover:bg-[#ab1c1c] hover:text-white transition-colors",onClick:()=>{o(!0),e(!1)},children:"Appointment"})]})]}),r.jsx(_5,{isOpen:a,onClose:()=>o(!1)})]}),r.jsx(z5,{userRole:h?p:"public"}),h&&r.jsx("div",{className:"z-40 bg-red-100 shadow-sm border-b-2 border-red-800",children:r.jsx(y4,{isMobileMenuOpen:s,setIsMenuOpen:e})})]})}const B5=[{label:"Who we are?",path:"/aboutus/whoarewe"},{label:"Why Us",path:"/whyus"},{label:"FAQ",path:"/faq"},{label:"Founder Messages",path:"/aboutus/foundermessages"},{label:"Our Goals",path:"/goals"},{label:"Research Department",path:"/research"},{label:"Terms & Conditions",path:"/terms-and-conditions"}],V5=[{label:"Services",path:"/services"},{label:"Assessment & Evaluation",path:"/services/assessment-evaluation"},{label:"Occupational Therapy",path:"/services/occupational-therapy"},{label:"Behaviour Therapy",path:"/services/behaviour-therapy"},{label:"Remedial Therapy",path:"/services/remedial-therapy"},{label:"Behaviour Modification",path:"/services/behaviour-modification"},{label:"Speech Therapy",path:"/services/speech-therapy"}],U5=[{label:"Facebook",path:"https://www.facebook.com/TotalSolution4Learning",icon:r.jsx(C5,{})},{label:"Instagram",path:"https://www.instagram.com/totalsolutionrehabsociety/",icon:r.jsx(k5,{})},{label:"YouTube",path:"https://www.youtube.com/@Totalsolutionrehabsociety",icon:r.jsx(T5,{})},{label:"WhatsApp",path:"https://wa.me/918886008697",icon:r.jsx(j5,{})}];function G5(){return r.jsxs("footer",{className:"bg-[#1c0c0c] text-white pt-10 pb-4",children:[r.jsxs("div",{className:"max-w-7xl mx-auto px-2 grid md:grid-cols-4 gap-8 text-sm",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Contact Details"}),r.jsxs("p",{className:"mb-2",children:[" ",r.jsxs("a",{href:"https://maps.app.goo.gl/WFpmGMazooskNKZY8",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:underline",children:["3-4-495/B, 1st Floor, YMCA, Near More Supermarket,",r.jsx("br",{})," Barkatpura, Hyderabad - 500027"]})]}),r.jsx("p",{className:"mb-2",children:" +91 88860 08697"}),r.jsxs("p",{className:"mb-4",children:[" ",r.jsx("a",{href:"mailto:info@totalsolutionforlearning.com",className:"text-blue-400 hover:underline",children:"info@totalsolutionforlearning.com"})]}),r.jsxs(nt,{to:"/contact",className:"text-white hover:text-blue-400",children:[r.jsx("span",{className:"text-blue-400",children:" "}),"Contact Us"]}),r.jsx("div",{className:"flex flex-wrap gap-4 mt-4",children:U5.map((s,e)=>r.jsx("a",{href:s.path,"aria-label":s.label,className:"text-white hover:text-blue-400 text-lg",target:"_blank",rel:"noopener noreferrer",children:s.icon},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Quick Links  "}),r.jsx("ul",{className:"space-y-2",children:B5.map((s,e)=>r.jsxs("li",{className:"flex items-center gap-2 border-dotted border-b border-white/30 pb-1",children:[r.jsx("span",{className:"text-blue-400",children:""})," ",r.jsx(nt,{to:s.path,className:"hover:underline",children:s.label})]},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Useful Links"}),r.jsx("ul",{className:"space-y-2",children:V5.map((s,e)=>r.jsxs("li",{className:"flex items-center gap-2 border-dotted border-b border-white/30 pb-1",children:[r.jsx("span",{className:"text-blue-400",children:""})," ",r.jsx(nt,{to:s.path,className:"hover:underline",children:s.label})]},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Careers"}),r.jsx("div",{className:"space-y-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"font-medium",children:"Send your resume to:"}),r.jsxs("a",{href:"mailto:humanresource@tsrs.in?subject=Career Opportunity - Resume Submission&body=Dear HR Team,%0D%0A%0D%0AI am interested in career opportunities at Total Solution Rehabilitation Society. Please find my resume attached.%0D%0A%0D%0AThank you for your consideration.%0D%0A%0D%0ABest regards,",className:"text-blue-400 hover:underline block",children:[r.jsx("span",{className:"text-blue-400",children:""})," humanresource@tsrs.in"]})]})})]})]}),r.jsx("div",{className:"text-center text-sm mt-10 border-t border-white/10 pt-4",children:r.jsxs("p",{children:["Copyright 2023 All rights reserved | Maintained by ",r.jsx("span",{className:"text-blue-400 hover:underline",children:"Total Solution Rehabilitation Society"})]})})]})}const Ek="/assets/who_we_are-CRmxMSkv.webp",W5="/assets/corevalues-Ko0ZIR04.webp",H5=()=>r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Ek,alt:"Who We Are",className:"object-cover w-full h-full"})}),r.jsxs("section",{className:"text-center py-12 px-4 md:px-16 bg-white",children:[r.jsx("h2",{className:"text-2xl font-semibold text-blue-900 mb-4",children:"Who we are?"}),r.jsx("p",{className:"text-gray-700 max-w-3xl mx-auto",children:"A team of passionate and dedicated professionals who aims at providing holistic rehabilitation to a developing child and strengthening the family in the same process."})]}),r.jsx("section",{className:"bg-gray-200 py-12 px-4 md:px-16",children:r.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-10",children:[r.jsxs("div",{className:"bg-white border border-red-400 shadow p-6 w-full md:w-1/2",children:[r.jsx("h3",{className:"text-center text-lg font-bold text-blue-900 mb-4",children:"Mission"}),r.jsx("p",{className:"text-sm text-gray-700",children:"Total Solution is an inclusive community of different professionals dedicated to innovations and excellence in rehabilitation services, research activities and training. Total solution supports all children with developmental difficulties and learning difficulties to achieve their maximum potential."})]}),r.jsxs("div",{className:"bg-white border border-red-400 shadow p-6 w-full md:w-1/2",children:[r.jsx("h3",{className:"text-center text-lg font-bold text-blue-900 mb-4",children:"Vision"}),r.jsx("p",{className:"text-sm text-gray-700",children:"Total Solution aspires to be one of the most distinguished learning centers with scientific research based rehabilitation services, excellent teaching and training institute aiming at a productive inclusive society."})]})]})}),r.jsx("section",{className:"bg-white py-12 px-4 md:px-16",children:r.jsx("div",{className:"text-center",children:r.jsx("img",{src:W5,alt:"Core Values",className:"mx-auto w-full max-w-4xl object-contain"})})})]}),q5="/assets/contactus1-Dt9z8oqx.webp",K5=({title:s,location:e,address:t,phone:n})=>{const a="https://maps.google.com/?q=".concat(encodeURIComponent(t));return r.jsxs("div",{className:"border border-red-900 p-6 flex flex-col items-center text-center h-full",children:[r.jsx("h2",{className:"text-red-700 text-xl font-medium mb-4",children:s}),r.jsx("p",{className:"text-gray-800 mb-6 flex-grow",children:r.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-600 hover:underline",children:t})}),r.jsx("a",{href:"tel:".concat(n),className:"text-red-600 border border-red-600 rounded-full px-6 py-2 inline-block hover:bg-red-50",children:n})]})};function X5(){const[s,e]=F.useState({name:"",phone:"",message:""}),t=[{title:"Total Solution Rehabilitation Society, Bowenpally",location:"Bowenpally",address:"Plot 9 SBI Colony, Manovikas Nagar, Old Bowenpally, Secunderabad 500009.",phone:"+91 88865 78697"},{title:"Total Solution Rehabilitation Society, Nacharam",location:"Nacharam",address:"7-38, Road no 1, Bapuji Nagar, Lane opposite to HDFC bank, Nacharam Road.",phone:"+91 90003 28697"},{title:"Total Solution Rehabilitation Society, Barkatpura",location:"Barkatpura",address:"3-4-495 / B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 27.",phone:"+91 88864 78697"},{title:"Total Solution Rehabilitation Society, Neredmet",location:"Neredmet",address:"Plot no - A-16 H. No 37-72/6 J.J.Nagar, behind Sunflower hospital Neredmet X road.",phone:"+91 9866 983 096"},{title:"Total Solution Rehabilitation Society, Kukatpally",location:"Kukatpally",address:"Srinivasan Apts, Flat no. 502, Addagutta Society,Pragathi Nagar Road, Beside Narayana Junior College, Oppo. Road to JNTU, Hyderabad 500029",phone:"+91 90632 08697"},{title:"Total Solution Rehabilitation Society, Champapet",location:"Champapet",address:"H. No. 17-01-382/B/25, Bhanu Nagar, Road no 2, Beside lane Focus Hospital, Champapet, Hyderabad 500079.",phone:"+91 99493 08697"},{title:"Total Solution Rehabilitation Society, Suchitra",location:"Suchitra",address:"Plot No. 105, Block 'A' , Survey no. 91,92,93 Jeedimetla Vill, Lane beside Chennai Shopping Mall, Suchitra, Hyderabad .",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society, Banjara Hills",location:"Banjara Hills",address:"8-2-629, Road no.1, Near Pension Office, Mithila Nagar, Banjara Hills, Hyderabad 500034.",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society, Manikonda",location:"Manikonda",address:"Ground Floor, Phani Plaza, Secretariat Colony, Puppalaguda, Rajendranagar, Hyderabad 500089.",phone:"+91 89786 88697"},{title:"Special Education Center, Barkatpura",location:"Barkatpura",address:"3-4-495/B, 1st Floor, Near More Super market, Barkatpura, Hyderabad 500027.",phone:"+91 70754 88697"}],n=[];for(let c=0;c<t.length;c+=3)n.push(t.slice(c,c+3));const a=c=>{const{name:u,value:h}=c.target;e(p=>({...p,[u]:h}))},o=c=>{c.preventDefault(),console.log("Form submitted:",s)},i="https://maps.google.com/?q="+encodeURIComponent("3-4-495/B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 500027");return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:q5,alt:"Contact Us",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsxs("section",{className:"py-6 dark:text-gray-900",children:[r.jsx("h1",{className:"hidden text-4xl font-bold text-gray-900 md:block text-center mb-10",children:"Contact Us"}),r.jsxs("div",{className:"grid max-w-6xl grid-cols-1 px-6 mx-auto lg:px-8 md:grid-cols-2 md:divide-x",children:[r.jsxs("div",{className:"py-6 md:py-0 md:px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Get in touch"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"flex items-center pt-5",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:r.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),r.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-600 hover:underline",children:"3-4-495/B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 500027"})]}),r.jsxs("p",{className:"flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:r.jsx("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})}),r.jsx("a",{href:"tel:+918886478697",className:"hover:text-red-600 hover:underline",children:"+91 88864 78697"})]}),r.jsxs("p",{className:"flex items-center",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:[r.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),r.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),r.jsx("a",{href:"mailto:info@totalsolutionforlearning.com",className:"hover:text-red-600 hover:underline",children:"info@totalsolutionforlearning.com"})]})]})]}),r.jsx("div",{className:"flex flex-col py-6 space-y-6 md:py-0 md:px-6",children:r.jsxs("form",{onSubmit:o,children:[r.jsxs("div",{className:"relative mb-6",children:[r.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:a,placeholder:" ",className:"block w-full px-3 pt-5 pb-2 rounded-md shadow-sm bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer",required:!0}),r.jsx("label",{htmlFor:"name",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Full name"})]}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:a,placeholder:" ",className:"block w-full px-3 pt-5 pb-2 rounded-md shadow-sm bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer",required:!0}),r.jsx("label",{htmlFor:"phone",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Contact Number"})]}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("textarea",{id:"message",name:"message",value:s.message,onChange:a,placeholder:" ",rows:"3",className:"block w-full px-3 pt-5 pb-2 rounded-md bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer resize-none",required:!0}),r.jsx("label",{htmlFor:"message",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Message"})]}),r.jsx("button",{type:"submit",className:"self-center px-8 py-3 text-lg rounded bg-red-600 text-white hover:bg-red-700 focus:ring focus:ring-opacity-75 focus:ring-red-600 transition-colors",children:"Submit"})]})})]})]}),r.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900 text-center mb-10",children:"Our Centers"}),n.map((c,u)=>r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:c.map((h,p)=>r.jsx("div",{className:"px-2",children:r.jsx(K5,{title:h.title,location:h.location,address:h.address,phone:h.phone})},p))},u))]})]})}const Y5="/assets/whyus-BpbmKTT8.webp",Z5="/assets/10-Db3uzpvB.webp",Q5=[{color:"#fb190f",text:"An organization is led by certified Rehabilitation psychologists."},{color:"#e059ef",text:"Most of the staff is Rehabilitation Council of India (RCI) certified and trained from renowned institutes."},{color:"#ff9900",text:"Largest number of trained occupational therapists in twin cities."},{color:"#045a72",text:"One among three and largest service provider of Tomatis Talks up (listening program) in India with Tomatis talks-up and Forebrain equipment."},{color:"#607333",text:"Total solution also provides PASS Based Reading Enhancement Program (PREP). Cognitive Enhancement Training (COGENT), Math Module by Dr J. P Das, Instrumental Enrichment (A cognitive training program conceived by Professor Reuven Feuerstein), Oral Placement Therapy (level 1 and 2) and Audiblox."},{color:"#f34907",text:"Yearly continuing education programs (CEP) for the staff to update their knowledge."},{color:"#e059e5",text:"Self-contained training institute for Management of Specific Learning Disorders, ADHD, ADD, Slow Learning, learning problems, Autism Spectrum Disorder, pediatric anxiety disorders, school phobia, school refusal."},{color:"#ff9900",text:"Institutes which conduct meticulous baseline assessment program by visiting home, school as well as natural play area of the child, as per requirement."},{color:"#fb190f",text:"Intervention programs are planned in holistic manner by focusing upon, life skills, language processing skills, play behavior and then educational and learning needs."},{color:"#045a72",text:"Focuses upon multidisciplinary approach by involving occupational, behavior, and speech therapists and monitored by rehabilitation psychologist."},{color:"#607333",text:"CCTV monitoring of all ongoing therapies by the center heads of the institute."},{color:"#f34907",text:"Monthly review of goals as per individual therapy plan by the center heads."},{color:"#e059e5",text:"Quarterly review and meeting by multidisciplinary team along with parents and phone based review with school professionals."},{color:"#ff9900",text:"Direct training of parents by involving them in all therapy sessions and making them conduct a part of the session under professional supervision."},{color:"#FF0000",text:"30% clientele receives both discounted and free therapies based on their financial income."},{color:"#004E66",text:"Regular school visits to support teachers for better management of the client in school system."},{color:"#556B2F",text:"Intermittent shadow support to the client in school for better transfer of learning from center to school situation."},{color:"#FF4500",text:"More than 600 free workshops in last 10 years in for creating awareness among teachers and parents about learning difficulties among school going children. 280 workshops for parenting to strengthen them for managing behavioral difficulties among children."},{color:"#DA70D6",text:"Regular free programs for parents attending intervention programs at different branches of total solution, for creating better knowledge about conditions and interventions."},{color:"#FFA500",text:"Supporting more than 350 children in 8 centers across the city, through scientific research-based practices of Remedial therapy, Cognitive behavior therapy, Applied Behavior Therapy, Behavior modification therapy, occupational therapy, speech therapy."},{color:"#004E66",text:"All programs of Autism Spectrum Disorder are supervised by Board Certified Assistant Behavior Analyst (BCABA), Mrs. Sophia Pirani."},{color:"#556B2F",text:"Institute to provide best management for Social Communication Disorder by providing group and individual sessions on Theory of Mind, Social Stories, Teach Me Language Module."},{color:"#FF4500",text:"High Success rate of management of Learning Disorders, School refusal cases, behavior management of children with ADHD, ADD and development of social skills."},{color:"#DA70D6",text:"Collaborative and referral practices with medical, paramedical, therapy and educational centers."},{color:"#FFA500",text:"Friendly environment for therapists so that they can provide best of their potential to children coming for therapies."},{color:"#004E66",text:"The organization takes staff for two picnics / leisure trips at 50% sponsorship."}],J5=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Y5,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsx("div",{className:"timeline-container",children:Q5.map((s,e)=>r.jsxs("div",{className:"timeline-item",style:{backgroundColor:s.color,animationDelay:"".concat(e*.2,"s")},children:[r.jsx("div",{className:"timeline-icon",children:r.jsx("img",{src:Z5,alt:"icon"})}),r.jsx("div",{className:"timeline-text",children:s.text})]},e))})]}),e_="/assets/speech-jOiGDkmv.webp",t_="/assets/receptive_language-C7tgFhol.webp",s_="data:image/webp;base64,UklGRgYHAABXRUJQVlA4TPoGAAAvu8AuEH/BoG0kR8cfcfVe/6dAIGnz/pm33UzbNuMPd7nnEQhC9P8sFhCbJDhHf4z/y5NLeXKrPLmUr93dg7RZ2vQHhATwAAJIAAE8gAQQjoK0DZjVv+09CRExAfIAHyvLtpW6lrqASojxRRfof/duThIBHVV/Ef2fAEgCwESNwuJalJznpKWWOi78/31YlYTeI/o/AfJvsbecCTHBw4CIOZc2tmbUjBHmIuXGG9IyBtCaqIyNGNcB6uNZt6CfCawehdc2rgi2qa6rHuBgOMeKOEfw8mirGQSuxrKSQeBuLKsYBC7HsgI+we1Y3bsCeI7DtZbA+5Pd4hMWGKtTLcIaD3aIT1hmaO70BCs9nblgsWk4wgTLDdWNkWDF2YkWYM3EHhRYdmJ7GRYeuzWCpYdui2DxoVsiWH7odgg2MHQrBFsYug2CTQzdwgnbGLq+AhsZWVuFrUysq4e9AFLFEXYza0LYz6Ynw4aGoaXBliYlHPYEso4DdrVpuMBqb4yxeYs8bwQTfa3hUBSNzRec8xAMGg3nyz5b0GZV0G8LuCzqbMVJHPR1Eu7UNlOQ55ygvhNwr7KZgjFjgPpOwN0qV8cM1Kfg/ipT0L5roL6GlCZT+B2q6yGpyhSUrxqor9LAI1PxK9QnEhWZgvJNA/UPSJ2r+A3qq5OZTEH9ooF+nazOFX5B+wT93QCDIlmZLXqXLcDPAn4VLehkdb6uNxW2Kr45TNTJTL6gP2Mw+UhmbxlfPn47ZvSs2ECRqMDr42cLJ/8nTuHZYaRM1F4al3B1m/hAfcJgtE8j8aoPd65PNvSkWMEqyePCsIabJy7xCZmxMkGB5597uH1iAv1BMIOduE3Zc8MWEk5M8q8Ohjtxk7J4fg1JXzzwV7aEnbhFWTzvQ9p9YAG/0BT2+oYKL44h9cyj/QDrD3lBd3h1SRZGFvmum0M0pfyiqh4vjyH9zALvLgcQ0ZoYb/0QCAOHcEc+pNwovDhAv0HnxkBxZlFvwPkXiYVF/tPNWdPUWmsBAErrsn50FzyJwAL/NFP2UUq4UzfdD0h/siFTQkJZ97mDP6eZVkLqss/cEBE0YiQQ1JlrZmwJJA/eJDYeRUTAYqeApogciX8e2UgngGqPiEji/UM6AWQf0T+Fkcch0vRZAXTLaCKwIk80oYGwiHBLN/2OFki30ZRsw59hBS0d4ZrK/Y4WiJvouaeZkWs0oKipCKck68AG9PVAvo5wSrAO+DtaetBFON22DvhDKgbSRuj2ez4DMo76NANQNsJhvmFzyBqXAMpGiOO8n1snZL4IUP0BIr4+yx6t/+8R2a8CxONLXlGEV1A0fZYOEXFPNhYznf3QuqobYwxeNabDfP9JutQNumqMRaJP9/b+syzL7L1/uYFbERHUZCScl2XbIdXne17D9X3xjlMTEdJjCzhdtD2SdfMWEv5PA5cuIlmNEXCyeCDdwW8h9T6PPEREqpYWvsvGIt3B74Hk4hjEP11JCV9li5TfeyA7D+Twj+ho4Vi0SHlcA+X9RS3fJA0dHJcWKb/2QPxDrNyQBn3UIukp0F8GUv3mUmDgsEXSU+C4DpTktikoD2okPQWe/4TwThSoSCLpZ+Dq6Zw/cB7EFalhYxMcmfojK6lJ+cB3JcM/2jwRFZSGnVGYiCT5PU9H0BHygfNG5HxwTGsOlKWzsQpPGu3BNc2KCJSl8gy8PySCPBzTsD4A1RHxzFYS9ETSNFQHIBoaC7NAoj665ll1ACANhY2bIxDk8ZiHVh0BqDZd4L76MRk9E5yHVn8BEFWftxB2l6q+KAoQ628AoJouwTMDYR/SRHnJQQP2+gQAyPJh7/mELE5pzjdCKhCNPhPLsjH2yivk0acZr7oSRFOcO5S6qo359s9tXdZ0KO9RC2Jfyyvf5cHCY1kW79/ODYjo09UPqh5E7Cp5C5yZ5+X7em5bvv/7+OWcG/FquihfRk2I2DeFSOGQc7rySVEWd02pflCUb6O+Q9PWWv2U/FExcmyNqevfEPgjiZbOZq/I12WHonyfNqhMaPuDMvPYnjZlhM0hmZv3JvAkSRswOufceE+R2X0DEqLMz+Ym770fsxSGAknWMl5EYw+bcojOsieRlQhtSRetnDbkEr09bAeJ5robiVXJtReBRTntROiinjaiiX5O21DEIqdNKGKT0xYUscppA/7ELqflFbHMaXFFjNPKQhXztK7QxcGyqjTExRaWdLA4OdKCsvjJtJrQxNUSloIszo60kCwO51WkLi53XEIWt6/gHg5xnMm3WMX5jn6FzOJ/i04RyxpLdIiGrLOgL4GGrLWRHzGzrHfk6AIWWXUlazEPWTmXw048u6yfK0UD6eqyjf06gqJ0VpbdHDVjmJboarKv3EomxHcRMefW5X8x";function n_(){return r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:e_,alt:"Speech Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-12",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] relative inline-block",children:["Speech Therapy Services",r.jsx("span",{className:"block w-20 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6 mt-10 px-4 pb-16",children:[r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-red-100 via-pink-100 to-white shadow-md p-6 w-full md:w-96 rounded-md",children:[r.jsx("img",{src:t_,alt:"Speech and Language Evaluation",className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:"Speech and Language Evaluation"})]}),r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-blue-100 via-purple-100 to-white shadow-md p-6 w-full md:w-96 rounded-md",children:[r.jsx("img",{src:s_,alt:"Receptive Language Evaluation",className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:"Receptive Language Evaluation"})]})]})]})}const a_="/assets/assesment-CrWlA-Is.webp",r_=()=>r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:a_,alt:"Psychological Testing Services",className:"w-full h-auto object-cover"})}),r.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-8 text-center",children:"Testing and Evaluation Services"}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl ",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Psychological Assessments & IQ Testing"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Brain Based Intelligence Test (BBIT)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Malin's Intelligence Scale for Indian Children (MISIC)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Binet Kamat Test of Intelligence (BKT)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsxs("div",{children:[r.jsx("p",{children:"Wechsler's Intelligence Scale for Children (WISC-IV)"}),r.jsx("p",{className:"text-sm text-gray-600 ml-4",children:"Indian and UK norms are available"})]})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Cognitive Assessment System (CAS)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Raven's Standard Progressive Matrices (SPM)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Raven's Color Progressive Matrices (CPM)"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Developmental Assessments"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Bayley Scale of Infant and Toddler Development"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Developmental Screening Test (DST)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Vineland Social Maturity Scale (VSMS)"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Psycho-Educational Assessments"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Wechsler's Individual Achievement Test (WIAT-II)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Dyslexia Screening Test- Junior"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Dyslexia Screening Test-Senior"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"NIMHANS SLD Index"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Brigance Learning Skills Evaluation"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Diagnostic Evaluation for:"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Specific Learning Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Attention Deficit Hyperactivity Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Autism Spectrum Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Sensory Processing Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Slow Learner"})]})]})]})]})]}),o_="/assets/Raghesh_Pooja-cU6G_R1E.webp",i_="/assets/founder_message-CRrEKR1y.webp",l_=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:i_,alt:"Founder Message",className:"object-cover w-full h-full"})}),r.jsxs("section",{className:"flex flex-col items-center py-16 px-8 bg-white text-gray-800",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-3xl text-[#002b5b] font-semibold",children:"Founder Messages"}),r.jsx("div",{className:"w-16 h-1 bg-[#c9202d] mx-auto mt-2 rounded-sm"})]}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-8 max-w-[1100px] w-full",children:[r.jsxs("div",{className:"text-center max-w-[400px] transition-transform duration-300",children:[r.jsx("img",{src:o_,alt:"Founders",className:"w-full border-[6px] border-white shadow-lg rounded-xl scale-[0.97] transition-transform duration-400 hover:scale-[1.02]"}),r.jsx("p",{className:"mt-4 font-bold text-[#002b5b]",children:"Dr. Raghesh G Nair & Dr. Pooja Jha Nair"})]}),r.jsxs("div",{className:"flex-1 min-w-[280px] max-w-[600px] text-base leading-relaxed",children:[r.jsx("p",{className:"mb-4",children:"Welcome to the world of passionate and professional approach to manage learning issues of children with developmental disorders. Total Solution is group of committed people who are chasing the dream of providing learning opportunity to all children of our society. Come and join our journey, as we all together can contribute to build our nation by making each child a productive citizen of our country."}),r.jsx("p",{className:"mb-4",children:"We are providing holistic services at nine different locations in Hyderabad  Bowenpally, Barkatpura, Kukatpally, Suchitra, Banjara Hills, Manikonda, Nacharam, Neredmet and Champapet, with a total of 9 branches and 1 special education center. A model of intervention programs has been implemented at each premise to maintain the quality of services."}),r.jsxs("div",{className:"mt-6 text-gray-600",children:[r.jsx("p",{children:"Dr. Pooja Jha Nair & Dr. Raghesh G Nair"}),r.jsx("p",{children:"Founder partners"}),r.jsx("p",{children:"Total Solution"})]})]})]})]})]}),c_="/assets/goals-CJYqMSVT.webp",u_=[{text:"Arrange for reasonable academic accommodations for registered students.",color:"#f79568"},{text:"Encourage registered students to develop independence by familiarizing them with policies, procedures and available resources.",color:"#ffde7d"},{text:"Create awareness among parents and children about diagnosis, intervention and correct intervention procedures for children with developmental disorders.",color:"#d5f573"},{text:"Give proper guidelines for the kids to school.",color:"#6de3e4"},{text:"Train teachers as well as the parents so that child is in safe hands.",color:"#a78bfa"},{text:"Establish a unit which will assist in formation of resource rooms at school & design and make teaching learning materials for each child.",color:"#f9a8d4"},{text:"Initiate & support multidisciplinary therapy centers and parent groups of children with learning disturbances.",color:"#86efac"},{text:"Take up research projects on various assessment & intervention methods and their efficacy.",color:"#fca5a5"},{text:"Initiate various short & long term training modules on behavior management, classroom management etc. of children with learning problems.",color:"#93c5fd"},{text:"Collaborate with different private, government and non-government agencies to spread similar models of practice in schools.",color:"#d8b4fe"},{text:"Develop modules of management/intervention on cognitive, behavioral and emotional issues of children with learning problems.",color:"#fecaca"},{text:"Initiate aptitude & talent based vocational centers for adults with learning disturbances.",color:"#bbf7d0"},{text:"Support organizations on initiation of self-necessary for persons with learning disturbances.",color:"#bfdbfe"}],d_=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:c_,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"goals-section",children:[r.jsxs("div",{className:"goals-title",children:[r.jsx("h2",{children:"Goals of Total Solution"}),r.jsx("div",{className:"underline"})]}),r.jsx("div",{className:"goals-list",children:u_.map((s,e)=>r.jsxs("div",{className:"goal-card ".concat(e%2===0?"slide-in-left":"slide-in-right"),style:{backgroundColor:s.color},children:[r.jsx("span",{className:"goal-arrow",children:""}),r.jsx("p",{children:s.text})]},e))})]})]}),h_="/assets/gayathri-3TQKWDI4.webp",p_="/assets/mridulajha-CBWq_s3E.webp",f_="/assets/raichal-NWLXGemt.webp",m_=[{name:"Mrs. GVN Gayathri",title:"Research Head",image:h_},{name:"Ms. Khersingh Komal",title:"Research Assistant",image:p_},{name:"Mrs. Ashwathy R",title:"Research Assistant",image:f_}],g_=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Ek,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"py-8 px-4 sm:px-6 text-center bg-white text-gray-800 font-sans",children:[r.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-[#0e2b5c] mb-4 relative",children:["Research Department",r.jsx("div",{className:"h-1 w-20 bg-[#0e2b5c] mx-auto mt-2"})]}),r.jsxs("div",{className:"max-w-4xl mx-auto mb-8 text-left leading-relaxed",children:[r.jsx("p",{className:"mb-4",children:"Total solution is committed to practice scientific research-based practices. In order to scientifically test our own developed strategies and to statistically validate our own findings, we have a research wing. At present, the following research projects are in progress:"}),r.jsxs("ol",{className:"list-decimal pl-6 space-y-2",children:[r.jsx("li",{children:"1. Cognitive profile of children with Specific Learning Disorder"}),r.jsx("li",{children:"2. Impact of Math Module on curriculum-based math performance"}),r.jsx("li",{children:"3. Impact of parental involvement in behaviour therapy on overall development of children with ASD."})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-6 sm:gap-8",children:m_.map((s,e)=>r.jsxs("div",{className:"w-48 sm:w-56 text-center bg-gray-50 rounded-lg p-4 shadow-md",children:[r.jsx("img",{src:s.image,alt:s.name,className:"w-full h-auto rounded-lg"}),r.jsx("h3",{className:"text-lg sm:text-xl font-medium mt-2 mb-1",children:s.name}),r.jsxs("p",{className:"text-sm sm:text-base text-[#800000]",children:["(",s.title,")"]})]},e))})]})]}),x_="/assets/Web_SubBanner_BM-CcBklMcg.webp";function b_(){return r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:x_,alt:"Behaviour Modification Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Behaviour Modification Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"flex justify-center mt-8 px-4 pb-12",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:[r.jsxs("p",{children:[r.jsx("span",{className:"inline-block mr-2 text-blue-500",children:""}),"Behaviour Modification is provided to manage undesirable behaviours and to improve the frequency of desirable behaviour. In this therapy a triad is maintained among parents-child and therapist. Behaviour contract with mutual consent of child and parent is developed and it is monitored through regular phone calls. Parents are counselled about usage of techniques like application of consequences, reward based techniques and using consistent parenting skills."]}),r.jsxs("p",{children:[r.jsx("span",{className:"inline-block mr-2 text-blue-500",children:""}),"Total solution Rehabilitation Society has expertise to implement behaviour modification therapy and success rate is commendable."]})]})})]})}const y_="/assets/remedial-B7Jw_Yqt.webp";function v_(){return r.jsxs("div",{className:"font-sans text-[#001F3F]",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:y_,alt:"Remedial Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Remedial Therapy Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"flex justify-center mt-8 px-4",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md space-y-4 text-lg leading-relaxed border",children:[r.jsx("p",{className:"font-semibold",children:"In remedial/education therapy we provide a threefold support to the child in following ways:"}),r.jsxs("ul",{className:"space-y-2 pl-4 list-none",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Teaching and reinforcing of cognitive skills. Visual perception / Auditory perception / Working memory / Attention enhancement skills / Reasoning / planning ability / Language processing skills"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Comprehension skills Strengthening the learning of academic based skills (English language / Math / Hindi / study skills)"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Behavior Modification"]})]})]})}),r.jsx("div",{className:"flex justify-center mt-6 px-4 pb-12",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md space-y-4 text-lg leading-relaxed border",children:[r.jsx("p",{className:"font-semibold",children:"The other components of Remedial Therapy that we provide are:"}),r.jsxs("ul",{className:"space-y-2 pl-4 list-none",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Educational intervention to enhance study skills"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Reading skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Writing skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Spelling skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Math basic skills training"]})]})]})})]})}const w_="/assets/Branches-DR2dlVgk.webp",N_=({title:s,location:e,address:t,contactPerson:n,phone:a,isLeftAligned:o,isAlternate:i})=>r.jsx("div",{className:"w-full py-12 ".concat(i?"bg-gray-100":"bg-white"),children:r.jsx("div",{className:"max-w-6xl mx-auto px-6",children:r.jsxs("div",{className:"flex flex-col ".concat(o?"items-start text-left":"items-end text-right"),children:[r.jsxs("h2",{className:"text-red-700 text-2xl font-bold mb-4",children:[s," ",r.jsxs("span",{className:"text-gray-600",children:["(",e,")"]})]}),r.jsx("p",{className:"text-gray-700 mb-3 max-w-2xl",children:t}),r.jsx("a",{href:"tel:".concat(a),className:"text-red-600 border border-red-600 rounded-full px-8 py-2 inline-block hover:bg-red-50 transition-colors",children:a})]})})}),S_=[{title:"Total Solution Rehabilitation Society",location:"Bowenpally",address:"Plot 9 SBI Colony, Manovikas Nagar, Old Bowenpally, Secunderabad 500009.",phone:"+91 88865 78697"},{title:"Total Solution Rehabilitation Society",location:"Barkatpura",address:"3-4-495 / B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad 500027.",phone:"+91 88864 78697"},{title:"Total Solution Rehabilitation Society",location:"Kukatpally",address:"Srinivasan Apts, Flat no. 502, Addagutta Society, Pragathi Nagar Road, Beside Narayana Junior College, Oppo. Road to JNTU, Hyderabad 500072.",phone:"+91 90632 08697"},{title:"Total Solution Rehabilitation Society",location:"Suchitra",address:"Plot No. 105, Block 'A' , Survey no. 91,92,93 Jeedimetla Vill, Lane beside Chennai Shopping Mall, Suchitra, Hyderabad.",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society",location:"Banjara Hills",address:"8-2-629, Road no.1, Near Pension Office, Mithila Nagar, Banjara Hills, Hyderabad 500034.",phone:"+91 87905 88697"},{title:"Total Solution Rehabilitation Society",location:"Manikonda",address:"Ground Floor, Phani Plaza, Secretariat Colony,Puppalaguda, Rajendranagar, Hyderabad 500089.",phone:"+91 89786 88697"},{title:"Total Solution Rehabilitation Society",location:"Nacharam",address:"7-38, Road no 1, Bapuji Nagar, Lane opposite to HDFC bank, Nacharam Road, Secunderabad 500076.",phone:"+91 90003 28697"},{title:"Total Solution Rehabilitation Society",location:"Neredmet",address:"35-67/1, GK Colony, Beside Delhi Mithaiwala Sainikpuri, Neredmet, Secunderabad 500094",phone:"+91 90003 48697"},{title:"Total Solutiion Rehabilitation Society",location:"Champapet",address:"H. No. 17-01-382/B/25, Bhanu Nagar, Road no 2, Beside lane Focus Hospital, Champapet, Hyderabad 500079.",phone:"+91 99493 08697"},{title:"Special Education Center",location:"Barkatpura",address:"3-4-495/B, 1st Floor, Near More Super market Barkatpura, Hyderabad 500027.",phone:"+91 70754 88697"}];function C_(){return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:w_,alt:"Image",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsx("div",{className:"w-full",children:S_.map((s,e)=>r.jsx(N_,{title:s.title,location:s.location,address:s.address,contactPerson:s.contactPerson,phone:s.phone,isLeftAligned:e%2!==0,isAlternate:e%2!==0},e))})]})}const k_="/assets/Behaviour-DkU7Cq4F.webp",j_="/assets/social-BHZdGott.webp",T_="/assets/lifeskills-Cdz4sjde.webp",I_="/assets/selfhelp-CPfcU3dX.webp",$_="/assets/conceptslearning-DeyCKx19.webp",A_="/assets/socialstory-8rviR9Ro.webp",E_="/assets/mindskill-DYA4HHFJ.webp",D_="/assets/grouptherapyl-CSmNRZog.webp",R_="/assets/parentaltraining-STAVNvpQ.webp",__="/assets/BT-BqCRWvbP.webp",O_=[{image:j_,text:"Social Skills Training"},{image:T_,text:"Life training skills"},{image:I_,text:"Self Help Skill training"},{image:$_,text:"Concepts learning through behaviour approach"},{image:A_,text:"Social stories methods to develop experiences for children with special needs"},{image:E_,text:"Theory of Mind skills training"},{image:D_,text:"Group therapy for better generalization"},{image:R_,text:"Parental training during therapy sessions."}];function F_(){return r.jsxs("div",{className:"font-sans text-[#001F3F]",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:k_,alt:"Behaviour Therapy",className:"w-full object-cover"})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Behaviour Therapy Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-10 px-4 max-w-4xl mx-auto pb-16",children:O_.map((s,e)=>r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-red-200 via-red-100 to-red-50 shadow-md p-6 rounded-md",children:[r.jsx("img",{src:s.image,alt:s.text,className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:s.text})]},e))}),r.jsx("section",{className:"flex justify-center mt-4 px-4 pb-12",children:r.jsx("div",{className:" p-6 md:p-8 rounded-md max-w-5xl text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:r.jsx("p",{children:"We provide behavior therapy on principals of A-B-C (Antecedent-Behavior-Consequence) analysis. We incorporate different approaches and focus on systematic intervention style. Following is our plan of action for ASD:"})})}),r.jsx("section",{className:"flex justify-center mt-4 px-4 pb-12",children:r.jsx("div",{className:"p-6 md:p-8 rounded-md max-w-6xl text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:r.jsx("img",{src:__,alt:"Behaviour Therapy",className:"w-full object-cover mt-4"})})})]})}const L_="/assets/training-DJgvaKIg.webp";function M_(){return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:L_,alt:"Image",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsxs("div",{className:"w-full max-w-4xl mx-auto p-6",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-800 border-b-2 border-gray-300 pb-2 text-center",children:"Training Information"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b-2 border-gray-300",children:[r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Row"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Training Programs"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Duration"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Frequency"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Course Coordinator"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"1"}),r.jsx("td",{className:"px-4 py-3",children:"Pedagogy (Short term)"}),r.jsx("td",{className:"px-4 py-3",children:"3 Month"}),r.jsx("td",{className:"px-4 py-3",children:"Twice in a year (May batch and Oct Batch)"}),r.jsx("td",{className:"px-4 py-3",children:"Ms. Khersingh Komal (8121884021)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"2"}),r.jsx("td",{className:"px-4 py-3",children:"Behavioural therapy"}),r.jsx("td",{className:"px-4 py-3",children:"1 Month"}),r.jsx("td",{className:"px-4 py-3",children:"In house Training for staff"}),r.jsx("td",{className:"px-4 py-3",children:"Mrs. Ashwathy R (9603281782)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"3"}),r.jsx("td",{className:"px-4 py-3",children:"PREP, COGENT & Math Module"}),r.jsx("td",{className:"px-4 py-3",children:"3 Month"}),r.jsx("td",{className:"px-4 py-3",children:"Quarterly"}),r.jsx("td",{className:"px-4 py-3",children:"Mr. Sridhar (7702222209)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"4"}),r.jsx("td",{className:"px-4 py-3",children:"Parent Training Program for Behaviour Therapy Skills"}),r.jsx("td",{className:"px-4 py-3",children:"1 Month"}),r.jsx("td",{className:"px-4 py-3",children:"On demand of parents (group of minimum 10 parents)"}),r.jsx("td",{className:"px-4 py-3",children:"Ms. Khersingh Komal (9849053404)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"5"}),r.jsxs("td",{className:"px-4 py-3 space-y-2",children:[r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training in improving handwriting skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training to teach reading skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training to teach spelling skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Behaviour Modification Strategies (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training in attention enhancement (Short term)"})]}),r.jsx("td",{className:"px-4 py-3",children:"As per demand"}),r.jsx("td",{className:"px-4 py-3",children:"As per demand"}),r.jsx("td",{className:"px-4 py-3",children:"Mrs. Gomathi Sharma (9866983096)"})]})]})]})})]})]})}const z_="/assets/servicesmain-CwaFdCCR.webp",P_="/assets/assessment-B2frtg3m.webp",B_="/assets/occupational-BMizKsZD.webp",V_="/assets/behaviour-DiK9likm.webp",U_="/assets/remedial-CUjWK615.webp",G_="/assets/modification-Cjy5WYTQ.webp",W_="/assets/speech-tokNFPWm.webp",H_=[{name:"Assessment & Evaluation",image:P_,color:"#00b2e1"},{name:"Occupational Therapy",image:B_,color:"#ed1c24"},{name:"Behaviour Therapy",image:V_,color:"#8bc53f"},{name:"Remedial Therapy",image:U_,color:"#fcee21"},{name:"Behaviour Modification",image:G_,color:"#92278f"},{name:"Speech Therapy",image:W_,color:"#f7931e"}],q_=()=>r.jsxs(r.Fragment,{children:[r.jsxs(Ey,{children:[r.jsx("title",{children:"Our Services | Total Solution for Learning"}),r.jsx("meta",{name:"description",content:"Explore therapy and rehabilitation services at Total Solution Rehabilitation Society for Learning in Hyderabad  including speech therapy, occupational therapy, remedial education, and behavioral support."}),r.jsx("meta",{name:"keywords",content:"therapy services Hyderabad, speech therapy, occupational therapy, remedial education, autism support, ADHD therapy, developmental disorders"}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org/services"}),r.jsx("script",{type:"application/ld+json",children:'\n    {\n      "@context": "https://schema.org",\n      "@type": "Service",\n      "serviceType": "Therapy and Rehabilitation",\n      "provider": {\n        "@type": "MedicalClinic",\n        "name": "Total Solution for Learning",\n        "url": "https://totalsolutionforlearning.org"\n      },\n      "areaServed": {\n        "@type": "Place",\n        "address": {\n          "@type": "PostalAddress",\n          "addressLocality": "Hyderabad",\n          "addressCountry": "IN"\n        }\n      },\n      "url": "https://totalsolutionforlearning.org/services",\n      "description": "Therapy and rehabilitation services including speech, occupational, remedial education, and behavior therapy for children with developmental needs."\n    }\n    '})]}),r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:z_,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"py-8 px-4 sm:px-6 bg-white text-gray-800 font-sans text-center",children:[r.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-[#0e2b5c] mb-4",children:["Services",r.jsx("div",{className:"h-1 w-16 bg-[#0e2b5c] mx-auto mt-2"})]}),r.jsx("p",{className:"max-w-4xl mx-auto mb-8 text-justify leading-relaxed text-base",children:"The organization was providing service to children and schools and certain NGOs in an informal way. By the end of 2008, we started promoting the organization as a brand with integrated services, training, therapeutics and advocacy as the main theme. Total Solution Rehabilitation Society currently provides solutions through its associate centers across Hyderabad, as given below."}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 my-8 px-2 sm:px-4",children:H_.map((s,e)=>r.jsxs("div",{className:"rounded-lg text-white shadow-md overflow-hidden text-center",style:{backgroundColor:s.color},children:[r.jsx("img",{src:s.image,alt:s.name,className:"w-full h-auto block"}),r.jsx("h3",{className:"p-3 m-0 text-lg font-medium",children:s.name})]},e))}),r.jsxs("p",{className:"max-w-4xl mx-auto text-justify leading-relaxed text-base",children:["Apart from these divisions, Total Solution Rehabilitation Society provides consultations, assessments and evaluations and home based therapy programs. In order to keep up with the changing times, we conduct 'Continuing Learning Education' programs to update already trained personnel.",r.jsx("br",{}),r.jsx("br",{}),"As the saying goes, 'A journey of thousand miles starts with a single step'. We have started the first step and we realize that there are miles to go. We are a learning organization and believe in catering to the emerging needs of the field from time to time."]})]})]}),K_="/assets/Branches-DR2dlVgk.webp",X_=[{question:"What kind of therapies we provide?",answer:"Link of therapies."},{question:"Do you handle Slow learners?",answer:"Yes."},{question:"Do you deal with handwriting?",answer:"We provide handwriting program to improve formation of letters, legibility of writing, speech of writing and organization of handwriting on paper."},{question:"Do we handle behavior issues?",answer:"Yes."},{question:"Do you handle Intellectually disability?",answer:"Only mild Intellectual disability to manage their learning problems and to improve their cognition."},{question:"How to identify child has some issue?",answer:"Observe for gaps between childs age and his existing behaviors or learning skills. if more than 3 signs of large gaps visible across different situations, take professional help to diagnose and intervene. Example age inappropriate development, poor learning when compared to peer group, difficulty to pay attention to given academic tasks specifically in group, poor recall of academic content, poor relationships with peer group etc."},{question:"Do I have to take appointment before visiting the clinic?",answer:"Yes, Appointment is needed."},{question:"What is the follow up consultation fee and follow up duration?",answer:"The Consultation fees is .rs for follow up and the duration for the follow up depends on the Treatment."},{question:"Is clinic accessible by wheelchair?",answer:"No, the clinic is on first floor."},{question:"Who do we need to meet if we want to take consultations?",answer:r.jsxs("div",{className:"space-y-2 text-sm md:text-base",children:[r.jsx("p",{children:"Dr. Pooja Jha Nair or Mr. Raghesh G Nair (For appointment Mr. Sridhar 8886008697), in absence of Dr. Pooja or Mr. Raghesh consult Center Heads:"}),r.jsxs("ul",{className:"list-none space-y-1 pl-2",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Bowenpally"}),"  Mrs. Suma Singh  9346 422 873"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Kukatpally"}),"  Mrs. PadmaSri  8886 778 697"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Banjara Hills"}),"  Mrs. Sophia Pirani  9849 053 404"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Nacharam"}),"  Mrs. Gomati  9866 983 096"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"A S Rao Nagar"}),"  Mrs. Gomati  9866 983 096"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Barakatpura"}),"  Ms. Sirisha  9652 483 265"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Manikonda"}),"  Mrs. Sophia Pirani  9849 053 404"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Champapet"}),"  Mr. Akram  9949 477 055"]})]})]})}];function Y_(){const[s,e]=F.useState(null),t=n=>{e(s===n?null:n)};return r.jsxs("div",{className:"px-4 py-10  mx-auto font-sans",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:K_,alt:"Branches",className:"w-full object-cover"})}),r.jsxs("h2",{className:"text-center text-2xl font-bold text-[#001F3F] mb-8 mt-4",children:["Frequently Asked Questions",r.jsx("div",{className:"w-24 h-1 bg-red-500 mx-auto mt-2"})]}),r.jsx("div",{className:"space-y-4 max-w-4xl justify-center mx-auto",children:X_.map((n,a)=>r.jsxs("div",{className:"border rounded bg-white shadow-sm",children:[r.jsxs("button",{onClick:()=>t(a),className:"w-full text-left px-4 py-3 flex justify-between items-center text-[#001F3F] font-medium",children:[r.jsx("span",{children:n.question}),r.jsx("span",{className:"text-xl",children:s===a?"":"+"})]}),s===a&&r.jsx("div",{className:"px-4 pb-4 text-gray-700",children:n.answer})]},a))})]})}const Z_=["Patient/Caregiver/Doctor/Health Care Professional Name,","Birth date/age,","Gender","Address (including country and pin/postal code),","Phone number/mobile number,","Email address,","Physical, physiological and mental health condition, provided by You and/or your Health Care Professional,","Personal medical records and history,","Valid financial information at time of purchase of product/service and/or online payment,","Login ID and password,","User details as provided at the time of registration or thereafter,","Records of interaction with TSRS representatives,","Your usage details such as time, frequency, duration and pattern of use, features used and the amount of storage used,","Master and transaction data and other data stored in Your user account,","Any other information that is willingly shared by You (collectively referred to as Personal Information).","Biometrics data","Genetic Data","Transgender Status","Intersex Status","Caste or Tribe","Religious or political belief or affiliation","Sexual orientation"],Q_=["When You fill the patient registration form,","When You provide details to a TSRS Professional or TSRS representative,","When You register on Our Website,","When You provide Your Personal Information to Us during course of receiving services,","When You use the features on Our Website,","When you provide access to any other website."],J_=["To provide effective Services","To operate and improve the Website and/or our Services;,","To perform studies, research and analysis for improving Our information, analysis, services and technologies; and ensuring that the content displayed are customized to Your interests and preferences;","To contact You via phone, SMS, WhatsApp or email for appointments, technical issues, payment reminders, deals and offers and other announcements;","To send promotional mailings from Us or any of Our channel partners via SMS, WhatsApp, email;","To advertise products and services of TSRS;","To transfer information about You if we are acquired by or merged with another company;","To share with our business partners for provision of specific services you have ordered so as to enable them to provide effective services to You;","To administer or otherwise carry out Our obligations in relation to any agreement You have with us;","To build your profile on the Website;","To respond to subpoenas, court orders, or legal process, or to establish or exercise Our legal rights or defend against legal claims;","To investigate, prevent, or take action regarding illegal activities, suspected fraud, violations of our Terms of Use, breach of Our agreement with you or as otherwise required by law,","To aggregate Personal Information for research, statistical analysis and business intelligence purposes, and to sell or otherwise transfer such research, statistical or intelligence data in an aggregated or non-personally identifiable form to third parties and affiliates, (referred to as Purpose(s))"],eO=[" Once you have freely consented to share your Personal Information with us, You authorize us to exchange, transfer, share, part with all or any of Your Personal Information, across borders and from Your country to any other countries across the world with the Cloud Service Provider and Our affiliates / agents / third party service providers / partners / banks and financial institutions or any other persons, for the Purposes specified under this Policy or as may be required by applicable law.","You acknowledge that some countries where we may transfer Your Personal Information may not have data protection laws that are as stringent as the laws of Your own country. You acknowledge that it is adequate that when TSRS transfers Your Personal Information to any other entity within or outside Your country of residence, TSRS will place contractual obligations on the transferee which will oblige the transferee to adhere to the provisions of this Privacy Policy."],tO=["The security of your Personal Information is important to us. We have adopted reasonable security practices and procedures including role-based access and need to know basis, password protection, encryption etc. to ensure that the Personal Information collected is secure. We restrict access to your Personal Information to Our and Our affiliates employees, agents, third party service providers, partners, and agencies on a need to know basis and in relation to the Purposes as specified above in this Policy.","While We will endeavour to take all reasonable and appropriate steps to keep secure any information which We hold about You and prevent unauthorized access, you acknowledge that the internet is not 100% secure and that We cannot provide any absolute assurance regarding the security of Your Personal Information. We will not be liable in any way in relation to any breach of security or unintended loss or disclosure of information caused by Us in relation to your Personal Information."],sO=["During Your interactions with Us, it may happen that We provide/include reference to third parties or fiduciaries, and/or links and hyperlinks of third party websites. It may also happen that you include links and hyperlinks of third party websites. The reference of such third parties or listing of such third party external sites (by You or by Us) does not imply endorsement of such party or site by TSRS. Such third parties and third party sites are governed by their own terms and conditions. We do not make any representations regarding the availability and performance of any of the third parties or third party sites. We are not responsible for the content, terms of use, privacy policies and practices of such third party websites.","Do-not-track requests There is no standard for how online service should respond to Do Not Track signals or other mechanisms that may allow you to opt out of the collection of information across networks of websites and online services. Therefore, we do not honour Do Not Track signals. As standards develop, we will revisit this issue and update this notice if our practices change."];function nO(){return r.jsxs("div",{className:"max-w-4xl mx-auto p-6 font-sans text-[#001F3F]",children:[r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["I. TERMS & CONDITIONS",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:"Please read and accept this privacy policy carefully before accessing or using the website. By accessing or using the website, you agree to be bound by the terms & conditions mentioned as well as all terms incorporated by reference."}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:'This document ("Terms") constitutes an electronic record as determined by the Information Technology Act, 2000 and the rules that administer it, as well as the amended provisions in several statutes pertaining to electronic records, as amended from time to time by the Information Technology Act, 2000.'}),r.jsxs("ol",{className:"list-decimal pl-6 space-y-2 text-sm md:text-base",children:[r.jsx("li",{children:'The following privacy statement ("Privacy Statement") applies to website XXX, operated by Total Solution Rehabilitation Society, a firm registered under the Telangana Societies Registration Act 2001... (truncated for brevity).'}),r.jsx("li",{children:"The Website is a digital platform for the services of consultations and assessments provided by registered body-Total Solution Rehabilitation Society."}),r.jsx("li",{children:"Individuals or entities that have agreed to become users of the Website in accordance with the procedure... may access the Services, the term shall also include visitors..."}),r.jsx("li",{children:"As much as we do our best to provide security... the inherent insecurities of the Internet mean that we cannot guarantee or warrant the complete security of your personal information."})]}),r.jsxs("ul",{className:"list-disc pl-6 mt-4 text-sm md:text-base space-y-1",children:[r.jsx("li",{children:"Our Liability"}),r.jsx("li",{children:"Company Information"})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["II. PRIVACY POLICY",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:"Total solutions Rehabilitation society. (TSRS) is committed to respecting the privacy of every person who shares information or data with TSRS. Your privacy protection is important to us and we strive to take due care and protection of the information we receive from you, the User."}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:'This document ("Terms") constitutes an electronic record as determined by the Information Technology Act, 2000...'}),r.jsxs("ul",{className:"list-disc pl-6 text-sm md:text-base space-y-1",children:[r.jsx("li",{children:"The Information Technology Act, 2000  Section 43A."}),r.jsx("li",{children:"The Information Technology (Reasonable Security Practices and Procedures and Sensitive Personal Information) Rules, 2011."})]}),r.jsx("p",{className:"text-sm md:text-base mt-4",children:'This Privacy Policy ("Privacy Policy") applies to the collection, storage, processing, disclosure and transfer of your Personal Information...'}),r.jsx("p",{className:"text-sm md:text-base mt-2",children:"The terms 'You' or 'Your' refer to you as the User (registered or unregistered) of the Website..."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600",children:"1. ACCESS"}),r.jsx("p",{className:"text-sm md:text-base",children:"We collect Your Personal Information directly from You, through Our Website. This Personal Information, for instance, would relate to the type of device You are using, the time that You have logged on to Our Website, Your IP address and other Personal Information as listed in Clause 5 below. You may access the Personal Information shared by You with Us, in the manner given below. You can further choose to share additional Personal Information with Us and you can modify your personal data, through website itself or by writing to Us on tsrsofficial@tsrs.in We keep in mind that the Personal Information shared by You is accessible to You. You can write to Us at the email id specified in Clause 15."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"2. CONSENT"}),r.jsx("p",{className:"text-sm md:text-base",children:"By choosing the Opt-In option on the Website and thereafter, by providing Us Your personal information or availing services of TSRS or by making use of the facilities provided by the Website, it is agreed by You that You have, freely consented to the collection, storage, processing, disclosure and transfer of Your Personal Information in accordance with the provisions of this Privacy Policy and any amendments thereof. You acknowledge that You have provided Your Personal Information out of your free will and after understanding how it will be used. You also consent that the collection, storage, processing, disclosure and transfer of any Personal and privacy Information shall not cause any wrongful loss to You, if it is done in accordance with the provisions of this Privacy Policy. However, we shall not be liable for any loss that may happen to you owing to the provision of wrongful Personal Information by You. We will share personal information outside of TSRS only when we have your consent. We will ask for your explicit consent to share any sensitive personal information."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"3. CONTROL OVER YOUR PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"You have the right to withdraw Your consent at any point, provided such withdrawal of the consent is intimated to us in writing through an email at tsrsofficial@tsrs.in requesting the same. If You wish to rectify the Personal Information that we may have collected to offer You personalized services and offers, as per Clause 12 of this Policy, you may write to Us, as mentioned under Clause 15.1 of this Policy, citing the reason for such rectification of Personal Information. Once You withdraw Your Consent to share the Personal Information collected by Us, We shall have the option not to fulfil the purposes for which the said Personal Information was sought and We may restrict you from using our Services or the Website."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"4. CHANGES TO THE PRIVACY POLICY"}),r.jsx("p",{className:"text-sm md:text-base",children:"We reserve the right to change this Privacy Policy from time to time. We will not reduce your rights under this Privacy Policy without your explicit consent. We always indicate the date when the last changes were published. If changes are significant, well provide a more prominent notice (including, for certain services, email notification of Privacy Policy changes)."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"5. PERSONAL INFORMATION COLLECTED"}),r.jsxs("p",{className:"text-sm md:text-base",children:["The kinds of information that We collect about You include but are not limited to the following:",Z_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"6. HOW WE COLLECT PERSONAL INFORMATION"}),r.jsxs("p",{className:"text-sm md:text-base",children:["The methods by which we collect your Personal Information include but are not limited to the following:",Q_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"7. USE OF PERSONAL INFORMATION"}),r.jsxs("p",{className:"text-sm md:text-base",children:["Your Personal Information may be used or processed for various purposes including but not limited to the following:",J_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"8. SHARING AND TRANSFERRING OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:eO.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"9. SECURITY"}),r.jsx("p",{className:"text-sm md:text-base",children:tO.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"10. THIRD PARTY REFERENCES AND LINKS"}),r.jsx("p",{className:"text-sm md:text-base",children:sO.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"11. RECTIFICATION/CORRECTION OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"If You need to update or correct your Personal Information, you may update/edit the same directly on the website and also send corrections to us at tsrsofficial@tsrs.inwe will take all reasonable efforts to incorporate the changes within a reasonable period."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"12. COMPLIANCE WITH LAWS"}),r.jsx("p",{className:"text-sm md:text-base",children:"You are not allowed to use the services of the Website if any of the terms of this Privacy Policy are not in accordance with the applicable laws of your country."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"13. TERM OF STORAGE OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"TSRS shall store Your Personal Information at least for a period of three years from the last date of use of the Services or Website or for such period as may be required by law.."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"14. GRIEVANCE OFFICER"}),r.jsx("p",{className:"text-sm md:text-base",children:"We have appointed a Grievance Officer to address any concerns or grievances that You may have regarding the processing of Your Personal Information. If you have any such grievances, please write to our Grievance Officer at XXXXX and Our officer will attempt to resolve Your issues in a timely manner."})]}),r.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-10 font-sans text-[#001F3F]",children:[r.jsxs("section",{className:"mb-12",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["III. REFUND/CANCELLATION POLICY",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsxs("div",{className:"text-sm md:text-base",children:[r.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"For online payments-"}),r.jsxs("ol",{className:"list-decimal pl-5 space-y-1 mb-4",children:[r.jsx("li",{children:"If the cancellation is done on the same day - Full refund will be made."}),r.jsx("li",{children:"For cancellation 3 days before a refund of 50% will be made."}),r.jsx("li",{children:"For cancellation of 0-3 days no refund will be made."})]}),r.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[r.jsx("li",{children:"A charge of 200 rs will be collected for all kinds of appointment which is non-refundable for consultations and 500rs non-refundable for assessments."}),r.jsx("li",{children:"If a cancellation occurs from TSRS or the appointed doctor, complete amount will be refunded back to the source."})]})]})]}),r.jsxs("section",{children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["IV. PRICING & SERVICE INFORMATION",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full border border-gray-300 text-sm md:text-base",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-600 text-white",children:[r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Price"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Approx time"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Approx time"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Provisions"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"bg-white",children:[r.jsx("td",{className:"border px-4 py-2",children:"Consultations"}),r.jsx("td",{className:"border px-4 py-2",children:"500.00"}),r.jsx("td",{className:"border px-4 py-2",children:"30mins"}),r.jsx("td",{className:"border px-4 py-2"}),r.jsx("td",{className:"border px-4 py-2",children:"Prescription and clinical suggestions"})]}),r.jsx("tr",{className:"bg-gray-100 font-semibold",children:r.jsx("td",{colSpan:"5",className:"px-4 py-2",children:"IQ Assessments"})}),[{service:"MISIC",price:"5,000.00",time:"60-120 mins"},{service:"BKT",price:"3,000.00",time:"60-90 mins"},{service:"BBIT",price:"7,500.00",time:"90-120 mins"},{service:"WISC&WIAT",price:"12,000.00",time:"240 mins"},{service:"Home Visit- DST/VSMS/CARS",price:"5,000.00",time:"60 mins",note:"Professional will visit the clients home to observe the child in his/her natural habitat"},{service:"BELE",price:"",time:""}].map((s,e)=>r.jsxs("tr",{className:"bg-white",children:[r.jsx("td",{className:"border px-4 py-2",children:s.service}),r.jsx("td",{className:"border px-4 py-2",children:s.price}),r.jsx("td",{className:"border px-4 py-2",children:s.time}),r.jsx("td",{className:"border px-4 py-2",children:s.note||""}),r.jsx("td",{className:"border px-4 py-2",children:"Detailed report"})]},e))]})]})})]})]})]})}const aO="/assets/heroImage3-GVtHZq5Q.webp";function rO({title:s,titleId:e,...t},n){return F.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),s?F.createElement("title",{id:e},s):null,F.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const Ni=F.forwardRef(rO);function oO({title:s,titleId:e,...t},n){return F.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),s?F.createElement("title",{id:e},s):null,F.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const Si=F.forwardRef(oO),iO=()=>{const[s,e]=F.useState({sensoryIntegration:!1,neuroDevelopmental:!1,teachingLearning:!1}),t=n=>{e(a=>({...a,[n]:!a[n]}))};return r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:aO,alt:"Occupational Therapy Services",className:"w-full h-auto object-cover"})}),r.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-12 text-center",children:"Occupational Therapy"}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("sensoryIntegration"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Sensory Integration"}),s.sensoryIntegration?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.sensoryIntegration&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("p",{className:"text-gray-700",children:"Sensory information provides an important foundation for learning and behavior. Sensory integration is a developmental process. Successful integration and organization of sensory information results in and is further developed by adaptive responses. The 'just right challenge' provides the milieu for sensory integration to occur. Children have an innate drive to seek meaningful experiences from their environment. Sensory integration promotes neuroplasticity. Sensory integration is a foundation for participation."})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Setting goals for intervention","Considerations for intervention","The physical environment of intervention","Therapeutic interventions related to modulation","Therapeutic interventions related to sensory discrimination","Therapeutic interventions related to bilateral integration and sequencing","Therapeutic interventions related to promoting praxis"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Key sensory integrative abilities (Sensory modulation)"}),r.jsx("ul",{className:"space-y-2",children:["Sensory discrimination","Postural-ocular control","Praxis","Bilateral integration and sequencing"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Outcomes of adequate sensory integration"}),r.jsx("ul",{className:"space-y-2",children:["Sensory discrimination","Postural-ocular control","Praxis","Bilateral integration and sequencing","Modulation, discrimination, and integration of sensory information","Self-Regulation","Postural control and bilateral motor coordination","Praxis","Organize behavior needed for developmentally appropriate tasks and activities","Self-esteem","Participation in self-care, leisure, and academic and social activities"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))}),r.jsxs("div",{className:"mt-3",children:[r.jsx("h4",{className:"font-medium text-gray-800",children:"Populations for whom this frame of reference is used"}),r.jsx("p",{className:"text-gray-700",children:"Children with sensory processing disorders, autism spectrum disorder, and other developmental conditions."})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Record review","Identifying patterns of dysfunction","Communication with parents, care providers, and teachers"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Sensory modulation abilities","Sensory discrimination","Dyspraxia","Bilateral integration and sequencing dysfunction","Modulation, discrimination, and integration of sensory information","Poor visual perception and visual motor integration (visuodyspraxia)"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("neuroDevelopmental"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Neuro-Developmental Treatment"}),s.neuroDevelopmental?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.neuroDevelopmental&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Development of reach and grasp","Kinesiological and biomechanical concepts","Movement dysfunction"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Range of movement and dissociation of movement","Alignment and patterns of weight bearing","Muscle tone","Postural tone","Balance and postural control","Coordination"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Overall assessment of functional skills","Evaluation of posture and movement","Handling techniques","Qualities of touch","Preparation, facilitation, and inhibition","Learning the process of therapeutic handling","Integration of neuro-developmental treatment into activity","Positioning and adaptive equipment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("teachingLearning"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Teaching - Learning"}),s.teachingLearning?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.teachingLearning&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["The four-quadrant model of facilitated learning","Task specification","Decision making","Key points","Autonomy"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Does the child know what to do and how to do it?","Is the child making astute decisions about their performance?","Is the child aware of errors?","Is the child recalling the steps of the task and other key features of performance?","Are there any signs of self-prompting?"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Mental imagery to complete a task","Self-instruction to complete a task","Successfully uses self-monitoring to complete a task","Successfully uses self-instruction to complete a task","Successfully problem solves to complete a task","Successfully uses automaticity to complete a task"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Task"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("childhoodOccupations"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Childhood Occupations"}),s.childhoodOccupations?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.childhoodOccupations&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Synthesis of child, occupational, performance, and environment - in time"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["The childenvironmentoccupation fit","Work and productivity","Play and leisure","Activities of daily living","Rest and sleep","Occupational patterns"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Work and productivity","Play and leisure","Activities of daily living and self-care","Rest and sleep"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Evaluating occupational performance in time","Evaluating the environment","Evaluation synthesis"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("socialParticipation"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Social Participation"}),s.socialParticipation?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.socialParticipation&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Interaction between caregivers and children","Interaction between caregivers and children with disabilities","Developing habits and routines","Developing habits and routines for children with disabilities","Social participation with peers","Children with disabilities: social participation with peers"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Temperament","Habits and routines","Environment","Peer Interaction"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Assessing caregivers' needs for support in increasing children's social participation","Assessment of children's social participation"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Consulting with caregivers","Role modeling","Activity-based intervention when parents are ill","Promoting social participation in classroom settings","Promoting effortful control in inclusive settings","Occupation-based groups to increase children's social participation with peers","Structuring an activity group","Choosing activities","Dealing with activity group process","Grading the amount of frustration","Aggressive behavior","Group resistance","Culture, beliefs, and values","Termination"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("visualPerception"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Visual Perception"}),s.visualPerception?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.visualPerception&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Visual perception is a developmental process","Visual perceptual processing is learned and increases with development, experience, and practice, and through stimulation from the environment","Children can learn by interacting with and observing adults and other children","Learning does not necessarily follow a developmental sequence. A deficit in one area does not predict a deficit or problem in another area","Difficulty with visual perception can interfere with daily occupations including the development of reading and writing skills"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Visual reception skills","Visual attention","Visual memory","Visual discrimination","Visual spatial","Visual motor integration"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Visual spatial assessment","Visual motor integration assessments"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Input: environmental adaptations","Processing: remediation of visual reception","Processing: remediation of visual cognition","Processing: visual reception strategies","Processing: visual cognition: strategies","Processing: environmental adaptations for visual reception","Visual cognition: environmental adaptations","Output: remediation of performance skills","Output: strategies for performance","Output: strategies for occupation"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("motorSkillAcquisition"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Motor Skill Acquisition"}),s.motorSkillAcquisition?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.motorSkillAcquisition&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Motor control, motor learning, and motor development","Dynamic systems","Learning","Concepts","Child-task-environment match"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Motor task","Child's environment","Task requirements","Child-task-environment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Child","Task","Environment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Occupational therapy evaluation","Observation of task performance","Art project","Goals and objectives","Intervention","Physical education"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("handwritingSkills"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Development of Handwriting Skills"}),s.handwritingSkills?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.handwritingSkills&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Multiple intelligences","Discrete motor skill learning","Optimal challenge point","Teaching writing"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Writing posture","Components","Use of writing tools","Grasp","Writing legibility"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Handwriting legibility","Speed","Tool use","Functional visual skills","Sensory processing","Attentional issues","Learning issues"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Peer Support","Working in a first-grade classroom"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]})]})]})};function lg(){const{pathname:s}=Bo();return F.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[s]),null}const lO="/assets/1-BnObsZdc.jpg",cO="/assets/1-Dk8_KL0H.webp",uO="/assets/10-BORUD9dj.jpg",dO="/assets/10-COYl8Mhq.webp",hO="/assets/11-CCckIIW-.jpg",pO="/assets/2-BbOEF5Ga.webp",fO="/assets/12-34CelbTB.jpg",mO="/assets/4-DSRfeNda.webp",gO="/assets/13-BaeuX0ch.jpg",xO="/assets/13-so1HyMkM.webp",bO="/assets/14-DPj1jJV-.jpg",yO="/assets/14-BfYDixVq.webp",vO="/assets/15-DHawZezg.jpg",wO="/assets/3-CtIKDcst.webp",NO="/assets/16-Co49rxoY.jpg",SO="/assets/5-DsqII3x1.webp",CO="/assets/17-Cfi-Xb7L.jpg",kO="/assets/17-DlehBD01.webp",jO="/assets/18-DyDzeeDR.jpg",TO="/assets/18-B89a2rbx.webp",IO="/assets/19-B4Q31Kas.jpg",$O="/assets/19-QZMTzkj0.webp",AO="/assets/2-Dj2uXSjN.jpg",EO="/assets/2-CIFyAhB1.webp",DO="/assets/20-C5UuCsBs.jpg",RO="/assets/20-0cznj--u.webp",_O="/assets/21-AbRnxVWf.jpg",OO="/assets/21-BWcHhFZi.webp",FO="/assets/22-Dta48Zjp.jpg",LO="/assets/22-DGuwWV2R.webp",MO="/assets/23-DhdRUjg5.jpg",zO="/assets/6-BooEANJA.webp",PO="/assets/24-DvzlpkLl.jpg",BO="/assets/8-eZFu9_Tx.webp",VO="/assets/25-Duv5HZch.jpg",UO="/assets/25-0RkCRcmP.webp",GO="/assets/27-DJnoPXI3.jpg",WO="/assets/10-DqLecErO.webp",HO="/assets/28-Dk36ViFM.jpg",qO="/assets/28-GPewWCEI.webp",KO="/assets/29-BDsaM0LA.jpg",XO="/assets/29-CkTdcWtX.webp",YO="/assets/3-DeKO4UAy.jpg",ZO="/assets/3-uLQFB36t.webp",QO="/assets/30-CM9sH4X5.jpg",JO="/assets/12-SVTMo18I.webp",eF="/assets/31-MFIVDfAp.jpg",tF="/assets/31-fHD-OeFU.webp",sF="/assets/33-DLRk4PLZ.jpg",nF="/assets/13-eCfY0g4f.webp",aF="/assets/34-CHOAIYCO.jpg",rF="/assets/34-B6rH58y9.webp",oF="/assets/35-DJbHNH3R.jpg",iF="/assets/35-v3A2ZKOc.webp",lF="/assets/36-D8pmJiOf.jpg",cF="/assets/36-ByC1vep0.webp",uF="/assets/37-DHeEwHkZ.jpg",dF="/assets/37-C7h4_WDA.webp",hF="/assets/38-BF3mBDg-.jpg",pF="/assets/38-DrzRUi2s.webp",fF="/assets/39-BBR4r84O.jpg",mF="/assets/39-Duz9rRN3.webp",gF="/assets/4-xFHRrwbz.jpg",xF="/assets/4-yWczx5hH.webp",bF="/assets/40-76X0Y0Cr.jpg",yF="/assets/40-BG3nv_OJ.webp",vF="/assets/41-DSSwvMdL.jpg",wF="/assets/41-ixrKDlZc.webp",NF="/assets/5-BDlkQ2IY.jpg",SF="/assets/5-BSBTyMKF.webp",CF="/assets/6-DKaCt2LG.jpg",kF="/assets/1-BFB0Wtqm.webp",jF="/assets/7-BzYobvqI.jpg",TF="/assets/7-UUdBpdJc.webp",IF="/assets/8-B3mE6iWv.jpg",$F="/assets/8-BNP8_4fl.webp",AF="/assets/9-BlBmzaoO.jpg",EF="/assets/9-B_0LmLov.webp",DF=()=>{const e=Object.entries(Object.assign({"/src/assets/Media/PhotoGallery/1.jpg":lO,"/src/assets/Media/PhotoGallery/1.webp":cO,"/src/assets/Media/PhotoGallery/10.jpg":uO,"/src/assets/Media/PhotoGallery/10.webp":dO,"/src/assets/Media/PhotoGallery/11.jpg":hO,"/src/assets/Media/PhotoGallery/11.webp":pO,"/src/assets/Media/PhotoGallery/12.jpg":fO,"/src/assets/Media/PhotoGallery/12.webp":mO,"/src/assets/Media/PhotoGallery/13.jpg":gO,"/src/assets/Media/PhotoGallery/13.webp":xO,"/src/assets/Media/PhotoGallery/14.jpg":bO,"/src/assets/Media/PhotoGallery/14.webp":yO,"/src/assets/Media/PhotoGallery/15.jpg":vO,"/src/assets/Media/PhotoGallery/15.webp":wO,"/src/assets/Media/PhotoGallery/16.jpg":NO,"/src/assets/Media/PhotoGallery/16.webp":SO,"/src/assets/Media/PhotoGallery/17.jpg":CO,"/src/assets/Media/PhotoGallery/17.webp":kO,"/src/assets/Media/PhotoGallery/18.jpg":jO,"/src/assets/Media/PhotoGallery/18.webp":TO,"/src/assets/Media/PhotoGallery/19.jpg":IO,"/src/assets/Media/PhotoGallery/19.webp":$O,"/src/assets/Media/PhotoGallery/2.jpg":AO,"/src/assets/Media/PhotoGallery/2.webp":EO,"/src/assets/Media/PhotoGallery/20.jpg":DO,"/src/assets/Media/PhotoGallery/20.webp":RO,"/src/assets/Media/PhotoGallery/21.jpg":_O,"/src/assets/Media/PhotoGallery/21.webp":OO,"/src/assets/Media/PhotoGallery/22.jpg":FO,"/src/assets/Media/PhotoGallery/22.webp":LO,"/src/assets/Media/PhotoGallery/23.jpg":MO,"/src/assets/Media/PhotoGallery/23.webp":zO,"/src/assets/Media/PhotoGallery/24.jpg":PO,"/src/assets/Media/PhotoGallery/24.webp":BO,"/src/assets/Media/PhotoGallery/25.jpg":VO,"/src/assets/Media/PhotoGallery/25.webp":UO,"/src/assets/Media/PhotoGallery/27.jpg":GO,"/src/assets/Media/PhotoGallery/27.webp":WO,"/src/assets/Media/PhotoGallery/28.jpg":HO,"/src/assets/Media/PhotoGallery/28.webp":qO,"/src/assets/Media/PhotoGallery/29.jpg":KO,"/src/assets/Media/PhotoGallery/29.webp":XO,"/src/assets/Media/PhotoGallery/3.jpg":YO,"/src/assets/Media/PhotoGallery/3.webp":ZO,"/src/assets/Media/PhotoGallery/30.jpg":QO,"/src/assets/Media/PhotoGallery/30.webp":JO,"/src/assets/Media/PhotoGallery/31.jpg":eF,"/src/assets/Media/PhotoGallery/31.webp":tF,"/src/assets/Media/PhotoGallery/33.jpg":sF,"/src/assets/Media/PhotoGallery/33.webp":nF,"/src/assets/Media/PhotoGallery/34.jpg":aF,"/src/assets/Media/PhotoGallery/34.webp":rF,"/src/assets/Media/PhotoGallery/35.jpg":oF,"/src/assets/Media/PhotoGallery/35.webp":iF,"/src/assets/Media/PhotoGallery/36.jpg":lF,"/src/assets/Media/PhotoGallery/36.webp":cF,"/src/assets/Media/PhotoGallery/37.jpg":uF,"/src/assets/Media/PhotoGallery/37.webp":dF,"/src/assets/Media/PhotoGallery/38.jpg":hF,"/src/assets/Media/PhotoGallery/38.webp":pF,"/src/assets/Media/PhotoGallery/39.jpg":fF,"/src/assets/Media/PhotoGallery/39.webp":mF,"/src/assets/Media/PhotoGallery/4.jpg":gF,"/src/assets/Media/PhotoGallery/4.webp":xF,"/src/assets/Media/PhotoGallery/40.jpg":bF,"/src/assets/Media/PhotoGallery/40.webp":yF,"/src/assets/Media/PhotoGallery/41.jpg":vF,"/src/assets/Media/PhotoGallery/41.webp":wF,"/src/assets/Media/PhotoGallery/5.jpg":NF,"/src/assets/Media/PhotoGallery/5.webp":SF,"/src/assets/Media/PhotoGallery/6.jpg":CF,"/src/assets/Media/PhotoGallery/6.webp":kF,"/src/assets/Media/PhotoGallery/7.jpg":jF,"/src/assets/Media/PhotoGallery/7.webp":TF,"/src/assets/Media/PhotoGallery/8.jpg":IF,"/src/assets/Media/PhotoGallery/8.webp":$F,"/src/assets/Media/PhotoGallery/9.jpg":AF,"/src/assets/Media/PhotoGallery/9.webp":EF})).map(([p,f],g)=>({id:g+1,src:f,alt:"Gallery Image ".concat(g+1," at Total Solution Rehabilitation Center")})),[t,n]=F.useState(!1),[a,o]=F.useState(0),i=p=>{o(p),n(!0),document.body.style.overflow="hidden"},c=()=>{n(!1),document.body.style.overflow="auto"},u=()=>{o(p=>p===0?e.length-1:p-1)},h=()=>{o(p=>p===e.length-1?0:p+1)};return r.jsxs("div",{className:"bg-gray-50",children:[r.jsxs("picture",{children:[r.jsx("source",{srcSet:"/src/assets/Media/gallery.webp",type:"image/webp"}),r.jsx("img",{src:"/src/assets/Media/gallery.webp",alt:"Photo Gallery at Total Solution Rehabilitation Center",width:1920,height:1080,loading:"eager",decoding:"sync",className:"w-full h-auto object-cover"})]}),r.jsx("section",{className:"py-16 px-4",children:r.jsxs("div",{className:"container mx-auto",children:[r.jsx("div",{className:"text-center mb-12",children:r.jsx("h3",{className:"text-4xl font-semibold text-gray-800",children:"Photo Gallery"})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map((p,f)=>r.jsx("div",{className:"overflow-hidden rounded-sm shadow-md hover:shadow-lg transition-shadow cursor-pointer group",onClick:()=>i(f),children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.src,type:"image/webp"}),r.jsx("img",{src:p.src,alt:p.alt,width:400,height:300,loading:"lazy",decoding:"async",className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"})]})},p.id))})]})}),t&&r.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:[r.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-white text-2xl hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition-colors","aria-label":"Close lightbox",children:r.jsx(R5,{size:28})}),r.jsx("button",{onClick:u,className:"absolute left-4 text-white text-2xl p-2 bg-black bg-opacity-50 rounded-full hover:bg-opacity-70 transition-colors","aria-label":"Previous image",children:r.jsx(A5,{size:28})}),r.jsx("div",{className:"max-w-4xl w-full max-h-screen overflow-auto",children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:e[a].src,type:"image/webp"}),r.jsx("img",{src:e[a].src,alt:e[a].alt,width:1200,height:800,loading:"eager",decoding:"sync",className:"w-full h-auto object-contain"})]})}),r.jsx("button",{onClick:h,className:"absolute right-4 text-white text-2xl p-2 bg-black bg-opacity-50 rounded-full hover:bg-opacity-70 transition-colors","aria-label":"Next image",children:r.jsx(E5,{size:28})})]})]})},RF="/assets/gallery-5IfLcuL0.webp",_F=[{id:"GrkeZkOjs-4",title:"Video 1"},{id:"Ne8oS3u34cY",title:"Video 2"},{id:"Hl8z80_BEQg",title:"Video 3"},{id:"Q8k4hzBiQ4w",title:"Video 4"},{id:"d--p09oAb5A",title:"Video 5"},{id:"zKEbq4bqR4M",title:"Video 6"},{id:"Ao3RXWVAV0c",title:"Video 7"},{id:"xzJP-e2m3Rc",title:"Video 8"},{id:"HfOHGoqIhWg",title:"Video 9"},{id:"uhgrlzrbb10",title:"Video 10"},{id:"FOClRNk6-x4",title:"Video 11"},{id:"P5ohKGszqVI",title:"Video 12"},{id:"RO2UzZmopyI",title:"Video 13"},{id:"Hkffa2ve9i4",title:"Video 14"}],OF=()=>{const[s,e]=F.useState(null);return r.jsxs("div",{className:"bg-gray-50",children:[r.jsx("img",{src:RF,alt:"Video Gallery",className:"w-full object-cover"}),r.jsx("section",{className:"py-16 px-4",children:r.jsxs("div",{className:"container mx-auto",children:[r.jsx("div",{className:"text-center mb-12",children:r.jsx("h3",{className:"text-4xl font-semibold text-gray-800",children:"Videos Gallery"})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_F.map((t,n)=>r.jsx("div",{className:"relative overflow-hidden rounded-sm shadow-md hover:shadow-lg transition-transform hover:scale-[1.02] cursor-pointer",onClick:()=>e(n),children:r.jsx("div",{className:"relative aspect-video bg-black",children:s===n?r.jsx("iframe",{src:"https://www.youtube.com/embed/".concat(t.id,"?autoplay=1"),title:t.title,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:"https://img.youtube.com/vi/".concat(t.id,"/hqdefault.jpg"),alt:t.title,className:"w-full h-full object-cover",loading:"lazy"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("div",{className:"bg-white bg-opacity-80 rounded-full p-4",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-600",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})})]})})},t.id))})]})})]})},FF=()=>{const s=Ml(e=>e.auth.isAuthenticated);return r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-red-50 flex items-center justify-center px-4",children:r.jsxs("div",{className:"max-w-3xl w-full text-center",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("div",{className:"relative inline-block",children:[r.jsx("span",{className:"text-9xl font-extrabold text-[#ab1c1c] opacity-20",children:"403"}),r.jsx("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-32 w-32 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m0 0v3m0-3h2m-2 0H9m3-3V8m0 0L9 4m6 4l-3-4m-3 4h6"})})]})}),r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Access Forbidden"}),r.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Sorry, you don't have permission to access this page or resource."}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-3",children:"This could be because:"}),r.jsxs("ul",{className:"space-y-2 text-left max-w-md mx-auto",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("span",{className:"text-gray-700",children:"You need to log in to access this content"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})})}),r.jsx("span",{className:"text-gray-700",children:"Your account doesn't have the required permissions"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}),r.jsx("span",{className:"text-gray-700",children:"The content is restricted for security reasons"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-gray-700",children:"There may be an issue with your account status"})]})]})]})}),r.jsx("div",{className:"mt-8 flex flex-wrap justify-center gap-4",children:r.jsxs(nt,{to:s?"/".concat(sessionStorage.getItem("role"),"dashboard"):"/",className:"bg-[#ab1c1c] text-white px-6 py-3 rounded-md font-medium hover:bg-[#8e1818] transition duration-300 inline-flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Return to ",s?"Dashboard":"Homepage"]})})]})})},Zn=({children:s,requiredRole:e})=>{const t=sessionStorage.getItem("token");if(!t)return r.jsx(Eo,{to:"/login",replace:!0});try{const a=Nr(t).user.role;if(e&&!e.includes(a))return r.jsx(FF,{})}catch(n){return console.error("Invalid token:",n),r.jsx(Eo,{to:"/login",replace:!0})}return s},Vs=()=>r.jsx("div",{className:"flex justify-center items-center",children:r.jsx("div",{className:"w-12 h-12 mt-6 border-4 border-red-800 border-dotted rounded-full animate-spin"})});function LF(){const s=jh(),[e,t]=F.useState({mobilenumber:"",password:""}),[n,a]=F.useState(!1),[o,i]=F.useState(!1),c=xs(),u=p=>{const{name:f,value:g}=p.target;t({...e,[f]:g})},h=async p=>{p.preventDefault(),a(!0);try{const f=await Le.post("/api/users/login",e);f.data.success?(sessionStorage.setItem("token",f.data.token),sessionStorage.setItem("role",f.data.role),sessionStorage.setItem("".concat(f.data.role,"Id"),Nr(f.data.token).user._id),s(Ak({token:f.data.token,role:f.data.role,details:Nr(f.data.token).user})),Be.success("Login Successful",{autoClose:2e3}),c("/".concat(f.data.role,"dashboard"))):(a(!1),Be.error("Could not find account with this mobile number",{autoClose:2e3}))}catch(f){a(!1),Be.error("Invalid Credentials",{autoClose:2e3})}};return r.jsxs("div",{className:"px-4 min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[r.jsxs(Ey,{children:[r.jsx("title",{children:"Login | Total Solution for Learning"}),r.jsx("meta",{name:"robots",content:"noindex, nofollow"}),r.jsx("meta",{name:"description",content:"Login to access your personalized therapy and learning dashboard at Total Solution for Learning."}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org/login"}),r.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"WebPage",name:"Login",url:"https://totalsolutionforlearning.org/login"})}})]}),r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx(ao,{}),r.jsxs("div",{className:"w-full max-w-lg p-8 space-y-6 bg-white rounded-xl shadow-lg border border-gray-200",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c]",children:"Welcome Back"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Sign in to your account"})]}),r.jsxs("form",{className:"space-y-6",onSubmit:h,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"mobilenumber",className:"block text-base font-medium text-gray-700",children:"Mobile Number"}),r.jsx("input",{id:"mobilenumber",name:"mobilenumber",type:"number",required:!0,className:"relative block w-full px-4 py-2 mt-1 text-base text-gray-900 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition-all duration-200",placeholder:"Enter your mobile number",value:e.mobilenumber,onChange:u,pattern:"[0-9]{10}",title:"Please enter a valid 10-digit mobile number",maxLength:"10"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-base font-medium text-gray-700",children:"Password"}),r.jsxs("div",{className:"relative mt-1",children:[r.jsx("input",{id:"password",name:"password",type:o?"text":"password",required:!0,className:"block w-full px-4 py-2 text-base text-gray-900 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition-all duration-200",placeholder:"Enter your password",value:e.password,onChange:u}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4",children:r.jsx("button",{type:"button",className:"text-gray-500 hover:text-[#ab1c1c] focus:outline-none transition-colors duration-200",onClick:()=>i(!o),children:o?"Hide":"Show"})})]})]})]}),r.jsx("div",{children:n?r.jsx(Vs,{}):r.jsx("button",{type:"submit",className:"relative flex justify-center w-full px-4 py-3 text-base font-medium text-white bg-[#ab1c1c] border border-transparent rounded-lg group hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c] transition-all duration-200 shadow-md hover:shadow-lg",children:"Sign in"})}),r.jsxs("div",{className:"text-center font-medium text-gray-600",children:["Don't have an account?"," ",r.jsx(nt,{to:"/register",className:"text-[#ab1c1c] hover:text-[#8e1818] hover:underline transition-colors duration-200",children:"Sign up"})]})]})]})]})]})}const MF=()=>{const s=Ml(e=>e.auth.isAuthenticated);return r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-red-50 flex items-center justify-center px-4",children:r.jsxs("div",{className:"max-w-3xl w-full text-center",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("div",{className:"relative inline-block",children:[r.jsx("span",{className:"text-9xl font-extrabold text-[#ab1c1c] opacity-20",children:"404"}),r.jsx("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-32 w-32 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Page Not Found"}),r.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"We're sorry, the page you're looking for doesn't exist or has been moved."}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-3",children:"You might want to:"}),r.jsxs("ul",{className:"space-y-2 text-left max-w-md mx-auto",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Double check the URL for typos"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Go back to the previous page"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Visit our homepage to start fresh"})]})]})]})}),r.jsx("div",{className:"mt-8",children:r.jsxs(nt,{to:s?"/".concat(sessionStorage.getItem("role"),"dashboard"):"/",className:"bg-[#ab1c1c] text-white px-6 py-3 rounded-md font-medium hover:bg-[#8e1818] transition duration-300 inline-flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Return to ",s?"Dashboard":"Homepage"]})})]})})};function zF(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState([]),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(""),[f,g]=F.useState("all"),[b,y]=F.useState(1),[v,w]=F.useState(10);F.useEffect(()=>{(async()=>{try{i(!0);const B=sessionStorage.getItem("token");if(!B)throw new Error("Authentication token not found");const K=Nr(B);sessionStorage.setItem("centreId",K.user.centreId);const Q=(await Le.get("/api/data/allChildren/".concat(K.user.centreId),{headers:{Authorization:B}})).data.map(ae=>(ae.doctorId||ae.therapistId)&&ae.admitStatus==="pending"?{...ae,admitStatus:"active"}:ae);t(Q),a(Q),i(!1)}catch(B){const K=B.response?"Error: ".concat(B.response.status," - ").concat(B.response.statusText):B.message;u(K),i(!1)}})()},[]),F.useEffect(()=>{N(),y(1)},[h,f,e]);const N=()=>{let q=[...e];if(f!=="all"&&(q=q.filter(B=>B.admitStatus===f)),h){const B=h.toLowerCase();q=q.filter(K=>K.name.toLowerCase().includes(B)||K.parentName&&K.parentName.toLowerCase().includes(B)||K.schoolName&&K.schoolName.toLowerCase().includes(B))}a(q)},C=b*v,I=C-v,T=n.slice(I,C),$=q=>y(q),E=[];for(let q=1;q<=Math.ceil(n.length/v);q++)E.push(q);const _=q=>{s("/admindashboard/child/".concat(q._id),{state:{childData:q}})},L=q=>{p(q.target.value)},O=q=>{g(q.target.value)},z=q=>{w(Number(q.target.value)),y(1)},A=({status:q})=>{const B=()=>{switch(q){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return r.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(B()),children:q.charAt(0).toUpperCase()+q.slice(1)})},U=q=>{const B=new Date,K=new Date(q);let J=B.getFullYear()-K.getFullYear();const Q=B.getMonth()-K.getMonth();return(Q<0||Q===0&&B.getDate()<K.getDate())&&J--,J},X=q=>new Date(q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Z=(q,B)=>{q.stopPropagation(),s("/admindashboard/iepreports/".concat(B._id))};return o?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):c?r.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:[r.jsx("p",{children:c}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-[#ab1c1c] text-white rounded hover:bg-[#8e1818]",onClick:()=>window.location.reload(),children:"Retry"})]}):r.jsxs("div",{className:"p-6 mb-16  min-h-screen",children:[r.jsx("div",{className:"justify-between items-center mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] ps-3",children:"Children"})}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 mb-6 border border-gray-200",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),r.jsx("input",{type:"text",id:"search",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",placeholder:"Search by name, parent name, or school...",value:h,onChange:L})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"statusFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Filter"}),r.jsxs("select",{id:"statusFilter",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",value:f,onChange:O,children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"}),r.jsx("option",{value:"pending",children:"Pending"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"itemsPerPage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Items per Page"}),r.jsxs("select",{id:"itemsPerPage",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",value:v,onChange:z,children:[r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"}),r.jsx("option",{value:100,children:"100"})]})]})]}),r.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Showing ",n.length===0?0:I+1,"-",Math.min(C,n.length)," of"," ",n.length," records"]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border border-gray-200",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c]",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Age/Gender"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"School Info"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Added On"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T&&T.length>0?T.map(q=>r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>_(q),children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"\n                          text-sm \n                          font-medium \n                          text-gray-900\n                          inline-block\n                        ",children:q.name})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[U(q.dob)," years"]}),r.jsx("div",{className:"text-sm text-gray-500",children:q.gender})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:q.schoolName||"Not enrolled"}),r.jsx("div",{className:"text-sm text-gray-500",children:q.schoolBoard||"N/A"})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx(A,{status:q.admitStatus})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:X(q.createdAt)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 transition-colors",onClick:B=>Z(B,q),children:"View IEP Reports"})})]},q._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No matching records found"})})})]})}),E.length>0&&r.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",b," of ",E.length]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>$(b-1),disabled:b===1,className:"px-4 py-2 border rounded-md bg-white text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),E.map(q=>r.jsx("button",{onClick:()=>$(q),className:"px-4 py-2 border rounded-md ".concat(b===q?"bg-[#ab1c1c] text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:q},q)),r.jsx("button",{onClick:()=>$(b+1),disabled:b===E.length,className:"px-4 py-2 border rounded-md bg-white text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})}const PF=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]},BF=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,VF=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+14),e.toISOString().split("T")[0]};function UF(){const s=xs(),e=Bo(),n=F.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("childId"),[a,o]=F.useState(!1),[i,c]=F.useState({childName:"",childAge:"",parentName:"",parentId:null,email:"",dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),[u,h]=F.useState([]),[p,f]=F.useState([]),[g,b]=F.useState([]),[y,v]=F.useState([]),[w,N]=F.useState([]),[C,I]=F.useState(null),[T,$]=F.useState(!1),[E,_]=F.useState(null),[L,O]=F.useState(!1),[z,A]=F.useState(10),[U,X]=F.useState("morning"),[Z,q]=F.useState(""),[B,K]=F.useState(!1),[J,Q]=F.useState("");F.useEffect(()=>{if(L){const re=setInterval(()=>{A(ke=>ke<=1?(clearInterval(re),s(-1),0):ke-1)},1e3);return()=>clearInterval(re)}},[L,s]);const ae=(re,ke)=>{c(Me=>({...Me,[re]:ke}))},we=async()=>{try{const re=await Le.get("/api/data/alldoctors",{headers:{Authorization:sessionStorage.getItem("token")}});h(re.data)}catch(re){Be.error("Error fetching doctors"),console.error("Error fetching doctors:",re)}};F.useEffect(()=>{(async()=>{if(n){$(!0);try{const Me=(await Le.get("/api/data/parent/".concat(n),{headers:{Authorization:sessionStorage.getItem("token")}})).data;let Ue="";if(Me.dob){const He=new Date(Me.dob),We=new Date;Ue=We.getFullYear()-He.getFullYear();const je=We.getMonth()-He.getMonth();(je<0||je===0&&We.getDate()<He.getDate())&&Ue--}if(c(He=>({...He,childName:Me.name||"",childAge:Ue.toString(),dob:Me.dob?new Date(Me.dob).toISOString().split("T")[0]:"",gender:Me.gender||"",schoolName:Me.schoolName||"",classGrade:Me.classGrade||"",schoolBoard:Me.schoolBoard||"",parentId:Me.parentId||null})),Me.parentId){const We=(await Le.get("/api/data/allUsers/".concat(Me.parentId),{headers:{Authorization:sessionStorage.getItem("token")}})).data;c(je=>({...je,parentName:We.name||"",parentPhoneNo:We.mobilenumber||"",address:We.address||"",alternativeNumber:We.mobilenumber||""}))}}catch(ke){Be.error("Failed to fetch child or parent details")}finally{$(!1)}}})()},[n]),F.useEffect(()=>{const re=async()=>{try{const Ue=sessionStorage.getItem("centreId"),He=await Le.get("/api/data/alldoctors/".concat(Ue),{headers:{Authorization:sessionStorage.getItem("token")}});f(He.data.doctors)}catch(Ue){console.error("Error fetching centres:",Ue),Be.error("Error fetching centres")}};we(),re();const ke=new Date;ke.setDate(ke.getDate()+1);const Me=ke.toISOString().split("T")[0];ae("appointmentDate",Me)},[]),F.useEffect(()=>{if(i.doctorId&&i.doctorId.trim()!==""){const re=u.find(ke=>ke._id===i.doctorId);re&&re.centreIds?b(re.centreIds):b([])}else b([])},[i.doctorId,u]),F.useEffect(()=>{(async()=>{if(i.doctorId&&i.appointmentDate&&i.consultationType&&i.branch)try{const ke=await Le.get("/api/admins/getAvailableSlots/".concat(i.branch,"/").concat(i.doctorId,"/").concat(i.appointmentDate,"/").concat(i.consultationType),{headers:{Authorization:sessionStorage.getItem("token")}}),Me=ke.data.availableSlots||[];if(ke.data.isHoliday){K(!0),Q(ke.data.holidayName),q(""),v([]),N([]);return}if(ke.data.message){K(!1),Q(""),q(ke.data.message),v([]),N([]);return}K(!1),Q("");const Ue=Me.map(He=>{const We=parseInt(He.split(":")[0]),je=He.includes("AM")&&We<12?"morning":"afternoon";return{time:He,period:je}});v(Ue),N([]),q("")}catch(ke){console.error("Error fetching slots:",ke),Be.error("Error fetching available slots"),q(""),v([{time:"10:30 AM",period:"morning"},{time:"11:30 AM",period:"morning"},{time:"12:30 PM",period:"afternoon"},{time:"2:00 PM",period:"afternoon"},{time:"3:00 PM",period:"afternoon"},{time:"3:30 PM",period:"afternoon"},{time:"4:30 PM",period:"afternoon"},{time:"5:30 PM",period:"afternoon"}])}else v([]),N([]),q("")})()},[i.doctorId,i.appointmentDate,i.consultationType,i.branch]);const Ce=async re=>{var ke,Me,Ue;re.preventDefault(),o(!0);try{const He=new FormData;Object.entries(i).forEach(([st,St])=>He.append(st,St)),C&&He.append("pdf",C),He.append("centreId",sessionStorage.getItem("centreId")),i.parentId&&He.append("parentId",i.parentId),await Le.post("/api/admins/bookAppointment",He,{headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"multipart/form-data"}});const We=new Dy;We.setFontSize(18),We.text("Appointment Details",10,10),We.setFontSize(12),We.text("Child Name: ".concat(i.childName),10,20),We.text("Child Age: ".concat(i.childAge),10,30),We.text("Parent Name: ".concat(i.parentName),10,40),We.text("Parent Phone Number: ".concat(i.parentPhoneNo),10,60),We.text("Appointment Date: ".concat(i.appointmentDate),10,70),We.text("Time: ".concat(i.time),10,80),We.text("Doctor: ".concat(((ke=p.find(st=>st._id===i.doctorId))==null?void 0:ke.name)||"N/A"),10,90),We.text("Branch: ".concat(((Me=g.find(st=>st._id===i.branch))==null?void 0:Me.name)||"N/A"),10,100),We.text("Consultation Type: ".concat(i.consultationType),10,110),We.text("Child Concerns: ".concat(i.childConcerns),10,120),We.text("Address: ".concat(i.address),10,130),We.text("School Name: ".concat(i.schoolName),10,140),We.text("Class/Grade: ".concat(i.classGrade),10,150),We.text("School Board: ".concat(i.schoolBoard),10,160),We.text("Referred By: ".concat(i.referredBy),10,170);const je=We.output("blob"),Xe=URL.createObjectURL(je);_(Xe),Be.success("Appointment booked successfully!"),o(!1),O(!0),A(10)}catch(He){Be.error(((Ue=He.response)==null?void 0:Ue.data)||"Failed to book appointment. Please try again."),o(!1)}},ve=re=>{w.includes(re)||ae("time",re)},pe=()=>["childName","childAge","parentName","parentPhoneNo","appointmentDate","time","doctorId"].every(ke=>i[ke]),xe=re=>{const ke=new Date,Me=new Date(re);return Me.getDate()===ke.getDate()&&Me.getMonth()===ke.getMonth()&&Me.getFullYear()===ke.getFullYear()},ue=re=>{if(!xe(i.appointmentDate))return!1;const ke=new Date,Me=ke.getHours(),Ue=ke.getMinutes(),[He,We]=re.split(" ");let[je,Xe]=He.split(":").map(Number);return We==="PM"&&je<12&&(je+=12),We==="AM"&&je===12&&(je=0),je<Me||je===Me&&Xe<=Ue},ye=()=>y.filter(re=>re.period===U).filter(re=>!w.includes(re.time)).filter(re=>!ue(re.time)).map(re=>re.time),Y=()=>{O(!1),_(null),c({childName:"",childAge:"",parentName:"",parentId:null,email:"",dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),I(null)},ce=()=>{s(-1)};return r.jsxs("div",{className:"max-width mx-auto mt-4 mb-10 py-12 px-4",children:[r.jsx(ao,{}),T?r.jsx(Vs,{}):L?r.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden w-full max-w-lg text-center p-8",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Appointment Booked Successfully!"}),r.jsxs("p",{className:"text-gray-600 mb-2",children:["You will be redirected back in ",z," seconds..."]}),r.jsx("p",{className:"text-gray-600 mb-8",children:"You can download the appointment details below."}),E&&r.jsx("div",{className:"mb-8",children:r.jsx("a",{href:E,download:"appointment_details.pdf",className:"inline-block px-6 py-3 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 w-full",children:"Download Appointment Details"})}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("button",{onClick:Y,className:"px-6 py-3 border border-red-700 text-red-700 font-medium rounded-md hover:bg-red-50 flex-1",children:"Book Another Appointment"}),r.jsx("button",{onClick:ce,className:"px-6 py-3 bg-red-700 text-white font-medium rounded-md hover:bg-red-800 flex-1",children:"Back to Dashboard"})]})]})}):r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"w-full md:w-11/12 lg:w-5/6",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden",children:[r.jsx("div",{className:"bg-red-700 border-b py-4 text-center",children:r.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Book Appointment"})}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:Ce,children:[r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800 pb-1",children:"Child Information"})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Child Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.childName,onChange:re=>ae("childName",re.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.dob,onChange:re=>{const ke=re.target.value;if(ae("dob",ke),ke){const Me=new Date(ke),Ue=new Date;let He=Ue.getFullYear()-Me.getFullYear();const We=Ue.getMonth()-Me.getMonth();(We<0||We===0&&Ue.getDate()<Me.getDate())&&He--,ae("childAge",He.toString())}else ae("childAge","")},max:new Date().toISOString().split("T")[0],required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gender",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.gender,onChange:re=>ae("gender",re.target.value),required:!0,children:[r.jsx("option",{value:"",children:"-- Select Gender --"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Other"})]})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"Parent Information"})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.parentName,onChange:re=>ae("parentName",re.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Phone Number",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.parentPhoneNo,onChange:re=>ae("parentPhoneNo",re.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alternate Number"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.alternativeNumber,onChange:re=>ae("alternativeNumber",re.target.value)})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Concerns",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",rows:"3",value:i.childConcerns,onChange:re=>ae("childConcerns",re.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",rows:"3",value:i.address,onChange:re=>ae("address",re.target.value)})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"School Information"})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.schoolName,onChange:re=>ae("schoolName",re.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class/Grade"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.classGrade,onChange:re=>ae("classGrade",re.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.schoolBoard,onChange:re=>ae("schoolBoard",re.target.value),children:[r.jsx("option",{value:"",children:"Select School Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Camebridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referred By"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.referredBy,onChange:re=>ae("referredBy",re.target.value)})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"Appointment Details"})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Appointment Date",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.appointmentDate,onChange:re=>{const ke=re.target.value;if(BF(ke)){Be.error("Appointments cannot be scheduled on Sundays. Please select another date.");return}ae("appointmentDate",ke),ae("time","")},min:PF(),max:VF(),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Doctor",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.doctorId,onChange:re=>{ae("doctorId",re.target.value),ae("branch",""),ae("time","")},required:!0,children:[r.jsx("option",{value:"",children:"-- Select a Doctor --"}),u.map(re=>r.jsx("option",{value:re._id,children:re.name},re._id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Branch",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.branch,onChange:re=>{ae("branch",re.target.value),ae("time","")},required:!0,disabled:!i.doctorId,children:[r.jsx("option",{value:"",children:"Select Branch"}),g.map(re=>r.jsx("option",{value:re._id,children:re.name},re._id))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Consultation type",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.consultationType,onChange:re=>ae("consultationType",re.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select Consultation Type"}),r.jsx("option",{value:"New Consultation",children:"New Consultation Rs.700/-"}),r.jsx("option",{value:"Assessment(IQ)",children:"Assessment (IQ) Rs.6000/-"}),r.jsx("option",{value:"For IB board Assessment(IQ)",children:"For IB board Assessment (IQ) Rs.12000/-"})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Time Period"}),r.jsxs("div",{className:"flex items-center space-x-4 my-2",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-red-700",name:"timePeriod",value:"morning",checked:U==="morning",onChange:()=>{X("morning"),ae("time","")}}),r.jsx("span",{className:"ml-2",children:"Morning (10:30 AM - 11:30 AM)"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-red-700",name:"timePeriod",value:"afternoon",checked:U==="afternoon",onChange:()=>{X("afternoon"),ae("time","")}}),r.jsx("span",{className:"ml-2",children:"Afternoon/Evening (12:30 PM - 5:30 PM)"})]})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Available Time Slots",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:B?r.jsx("div",{className:"w-full p-6 bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-300 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-orange-800 font-bold text-lg mb-2",children:["Holiday - ",J]}),r.jsx("p",{className:"text-orange-700",children:"No appointments can be booked on this holiday. Please select a different date."})]})}):Z?r.jsx("div",{className:"w-full p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-6 h-6 text-red-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-red-800 font-medium",children:"Center Not Operational"}),r.jsx("p",{className:"text-red-700 text-sm mt-1",children:"The selected center is not operational on this date. Please choose a different date or contact the center for more information."})]})]})}):ye().length>0?ye().map(re=>r.jsx("button",{type:"button",className:"px-4 py-2 rounded-md ".concat(i.time===re?"bg-red-700 text-white":"border border-red-700 text-red-800 hover:bg-red-50"),onClick:()=>ve(re),children:re},re)):r.jsx("p",{className:"text-orange-600 italic",children:!i.doctorId||!i.appointmentDate?"Please select a doctor and date to see available time slots":"No time slots available for the selected period. Please try another date or time period."})}),i.appointmentDate&&xe(i.appointmentDate)&&r.jsx("p",{className:"mt-2 text-sm text-gray-500 italic",children:"Note: Time slots for today that have already passed are not shown."})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsxs("div",{className:"font-[sans-serif] max-w-md",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload previous reports (if any)"}),r.jsx("input",{type:"file",className:"w-full text-gray-400 font-semibold text-sm bg-white border file:cursor-pointer cursor-pointer file:border-0 file:py-3 file:px-4 file:mr-4 file:bg-gray-100 file:hover:bg-gray-200 file:text-gray-500 rounded",onChange:re=>I(re.target.files[0]),accept:".pdf"}),r.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Only PDFs are Allowed."})]})})]}),a?r.jsx(Vs,{}):r.jsx("div",{className:"mt-6",children:r.jsx("button",{type:"submit",className:"w-full md:w-auto px-6 py-3 text-white font-medium rounded-md ".concat(pe()?"bg-red-700 hover:bg-red-800":"bg-gray-400 cursor-not-allowed"),disabled:!pe(),children:"Book Appointment"})})]})})]})})})]})}function GF(){const[s,e]=F.useState({password:"",confirmPassword:"",role:"",name:"",mobilenumber:"",profilePhoto:"",address:"",designation:"",qualification:"",rciNumber:"",childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),[t,n]=F.useState({}),[a,o]=F.useState(!1),[i,c]=F.useState(!1),[u,h]=F.useState(!1),[p,f]=F.useState(!1),[g,b]=F.useState(!1),y=I=>{const{name:T,value:$}=I.target;e({...s,[T]:$}),t[T]&&n({...t,[T]:""})},v=I=>{const T=I.target.files[0];if(T){if(T.size>5*1024*1024){Be.error("File size should not exceed 5MB");return}e({...s,profilePhoto:T}),Be.success("Profile photo selected successfully")}},w=()=>{const I={};return s.name.trim()||(I.name="Name is required"),s.mobilenumber?/^\d{10}$/.test(s.mobilenumber)||(I.mobilenumber="Mobile number must be 10 digits"):I.mobilenumber="Mobile number is required",s.password?s.password.length<6&&(I.password="Password must be at least 6 characters"):I.password="Password is required",s.password!==s.confirmPassword&&(I.confirmPassword="Passwords do not match"),s.role||(I.role="Role is required"),s.role==="parent"&&!s.address&&(I.address="Address is required"),s.role==="parent"&&g&&(s.childName||(I.childName="Child name is required"),s.childDob||(I.childDob="Date of birth is required"),s.childGender||(I.childGender="Gender is required")),I},N=async I=>{var T,$;I.preventDefault(),h(!0);try{const E=w();if(Object.keys(E).length>0){n(E),h(!1),Be.error("Please fix the validation errors before submitting");return}const _=sessionStorage.getItem("centreId");if(!_){Be.error("Centre ID not found in session storage"),h(!1);return}const L=new FormData;L.append("password",s.password),L.append("role",s.role),L.append("name",s.name),L.append("mobilenumber",s.mobilenumber),L.append("centreId",_),s.profilePhoto&&L.append("profilePhoto",s.profilePhoto),s.role==="parent"?(L.append("address",s.address),g&&L.append("childData",JSON.stringify({name:s.childName,dob:s.childDob,gender:s.childGender,schoolName:s.childSchoolName||"",schoolBoard:s.childSchoolBoard||"",centreId:_}))):s.role==="therapist"&&(L.append("designation",s.designation),L.append("qualification",s.qualification||""),L.append("rciNumber",s.rciNumber||"")),await Le.post("/api/admins/register",L,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}}),Be.success("Registration successful!"),f(!0)}catch(E){console.error("Registration error:",E),Be.error((($=(T=E.response)==null?void 0:T.data)==null?void 0:$.message)||"Registration failed")}finally{h(!1)}},C=()=>s.role==="therapist"?r.jsxs("div",{className:"space-y-4 md:space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation"}),r.jsx("input",{type:"text",name:"designation",value:s.designation,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your designation (optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Qualification"}),r.jsx("input",{type:"text",name:"qualification",value:s.qualification,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your qualification (optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RCI Number"}),r.jsx("input",{type:"text",name:"rciNumber",value:s.rciNumber,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your RCI number (optional)"})]})]}):s.role==="parent"?r.jsxs("div",{className:"space-y-4 md:space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{name:"address",value:s.address,onChange:y,className:"w-full p-2 border ".concat(t.address?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Full address",rows:"3"}),t.address&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.address})]}),r.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c]",children:"Child Information"}),r.jsx("button",{type:"button",onClick:()=>b(I=>!I),className:"text-sm text-[#ab1c1c] hover:text-[#8e1818] flex items-center",children:g?"Skip for now":"Add child"})]}),g&&r.jsxs("div",{children:[r.jsxs("div",{className:"grid grid-cols-1  md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Child's Name *"}),r.jsx("input",{type:"text",name:"childName",value:s.childName,onChange:y,className:"w-full p-2 border ".concat(t.childName?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Child's Full Name"}),t.childName&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",name:"childDob",value:s.childDob,onChange:y,className:"w-full p-2 border ".concat(t.childDob?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]")}),t.childDob&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childDob})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{name:"childGender",value:s.childGender,onChange:y,className:"w-full p-2 border ".concat(t.childGender?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white"),children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Others"})]}),t.childGender&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childGender})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",name:"childSchoolName",value:s.childSchoolName,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"School Name (Optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{name:"childSchoolBoard",value:s.childSchoolBoard,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white",children:[r.jsx("option",{value:"",children:"Select Board (Optional)"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Cambridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})]})]})]})]})]}):null;return p?r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(lg,{}),r.jsx("div",{className:"max-w-md w-full bg-white rounded-xl shadow-xl overflow-hidden border border-red-100",children:r.jsxs("div",{className:"px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"mt-3 text-xl font-medium text-gray-900",children:"Registration Successful!"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Your account has been created successfully."}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:()=>{f(!1),e({password:"",confirmPassword:"",role:"",name:"",mobilenumber:"",address:"",childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),b(!1)},className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Register Another Account"})}),r.jsx("div",{className:"mt-3",children:r.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Go to Login"})})]})})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),r.jsxs("div",{className:"max-w-4xl w-full bg-white rounded-xl shadow-xl overflow-hidden mb-20 border-2 border-red-800",children:[r.jsxs("div",{className:"px-6 py-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-3xl font-extrabold text-[#ab1c1c] mb-2",children:"Create account for a User"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Fill in the details to register"})]}),r.jsxs("form",{className:"space-y-6",onSubmit:N,children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),r.jsx("input",{type:"number",name:"mobilenumber",value:s.mobilenumber,onChange:y,className:"w-full p-2 border ".concat(t.mobilenumber?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:"10"}),t.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.mobilenumber})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),r.jsx("input",{type:"text",name:"name",value:s.name,onChange:y,className:"w-full p-2 border ".concat(t.name?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Full Name"}),t.name&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.name})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Photo (optional)"}),r.jsx("input",{type:"file",accept:"image/*",name:"profilePhoto",onChange:v,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsxs("select",{name:"role",value:s.role,onChange:y,className:"w-full p-2 border ".concat(t.role?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white"),children:[r.jsx("option",{value:"",children:"Select Role"}),r.jsx("option",{value:"parent",children:"Parent"}),r.jsx("option",{value:"therapist",children:"Therapist"})]}),t.role&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.role})]})]}),s.role&&C(),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:a?"text":"password",name:"password",value:s.password,onChange:y,className:"w-full p-2 border ".concat(t.password?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>o(!a),children:a?r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),t.password&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.password})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:i?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:y,className:"w-full p-2 border ".concat(t.confirmPassword?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Confirm Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>c(!i),children:i?r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),t.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.confirmPassword})]})]}),t.submit&&r.jsx("div",{className:"bg-red-50 border border-red-500 text-red-700 px-4 py-3 rounded relative",role:"alert",children:r.jsx("span",{className:"block sm:inline",children:t.submit})}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:u,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ".concat(u?"bg-[#8e1818] cursor-not-allowed":"bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]"),children:u?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Register"})})]})]}),(s.password||s.confirmPassword)&&r.jsx("div",{className:"mt-4 max-w-md w-full bg-white rounded-xl shadow-md overflow-hidden border border-red-100",children:r.jsxs("div",{className:"px-6 py-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Password Requirements:"}),r.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 list-disc list-inside",children:[r.jsx("li",{className:s.password.length>=6?"text-green-600":"",children:"At least 6 characters long"}),r.jsx("li",{className:/[A-Z]/.test(s.password)?"text-green-600":"",children:"At least one uppercase letter"}),r.jsx("li",{className:/[a-z]/.test(s.password)?"text-green-600":"",children:"At least one lowercase letter"}),r.jsx("li",{className:/[0-9]/.test(s.password)?"text-green-600":"",children:"At least one number"}),r.jsx("li",{className:/[^A-Za-z0-9]/.test(s.password)?"text-green-600":"",children:"At least one special character"}),r.jsx("li",{className:s.password===s.confirmPassword&&s.password?"text-green-600":"",children:"Passwords match"})]})]})})]})]})}const WF=s=>new Promise((e,t)=>{const n=new Image;n.onload=()=>{const a=document.createElement("canvas");a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0),e(a.toDataURL("image/jpeg"))},n.onerror=t,n.src=s}),_y=async s=>{try{const e=new Dy;if(!s||!s.childName){console.log(s),console.log(s.childName),e.setFontSize(14),e.text("No appointment data available",e.internal.pageSize.width/2,20,{align:"center"}),e.output("dataurlnewwindow");return}try{const N=await WF(ig);e.addImage(N,"PNG",15,10,40,20)}catch(N){console.log("Failed to add logo:",N),e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Hospital Logo",15,20)}e.setFontSize(12),e.setFont("helvetica","normal"),e.text(["Total Solution - Barkatpura","3-4-495/B, 1st Floor, YMCA Near More Super Market, Hyderabad, Telangana 500027, IN","Phone: +91 88860 08697"],15,35),e.setFillColor(197,27,28),e.rect(2,50,e.internal.pageSize.width-4,25,"F"),e.setFontSize(18),e.setTextColor(255,255,255),e.setFont("helvetica","bold"),e.text("Appointment Details",e.internal.pageSize.width/2,65,{align:"center"}),e.setTextColor(0,0,0);const t=85,n=175;e.setFillColor(255,220,222),e.roundedRect(10,t,e.internal.pageSize.width-20,n,3,3,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Patient Information",15,t+12);const a=t+18;e.setDrawColor(255,255,255),e.setLineWidth(.5),e.line(15,a,e.internal.pageSize.width-15,a),e.setFontSize(11);const o=25,i=80,c=12;let u=t+30;const h=(N,C)=>{e.setFont("helvetica","bold"),e.text(N,o,u),e.setFont("helvetica","normal");const I=C?typeof C=="string"?C:C.toString():"N/A";e.text(I,i,u),u+=c},p=N=>N?typeof N=="string"?N:N instanceof Date?N.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}):N.toString():"N/A",f=N=>N?typeof N=="string"?N:N instanceof Date?N.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):N.toString():"N/A";h("Patient Name:",s.childName),h("Parent Name:",s.parentName),h("Doctor:",s.doctorName),h("Centre:",s.centreName),h("Date:",p(s.appointmentDate)),h("Time:",f(s.appointmentTime)),h("Consultation Type:",s.consultationType||"Regular"),h("Status:",s.status),e.setFont("helvetica","bold"),e.text("Child Concerns:",o,u),e.setFont("helvetica","normal");const g=s.childConcerns||"N/A",b=e.splitTextToSize(g,e.internal.pageSize.width-i-15);if(e.text(b,i,u),u+=Math.max(b.length*5+5,c),s.prescription&&s.prescription.trim()){const N=t+n+15;e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Prescription",15,N),e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(15,N+5,80,N+5);const C=e.splitTextToSize(s.prescription,e.internal.pageSize.width-40);D1(e,{startY:N+10,head:[],body:[[C]],theme:"plain",styles:{fontSize:11,cellPadding:5,lineColor:[197,28,27],valign:"middle"},columnStyles:{0:{cellWidth:180}},tableLineColor:[197,27,28],tableLineWidth:.3,margin:{top:5}})}if(s.previousMedicalReports&&s.previousMedicalReports.length>0){const N=s.prescription&&s.prescription.trim()?e.previousAutoTable.finalY+15:t+n+15;e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Previous Medical Reports",15,N),e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(15,N+5,120,N+5);const C=s.previousMedicalReports.map((I,T)=>["".concat(T+1),I]);D1(e,{startY:N+10,head:[["No.","Report Details"]],body:C,styles:{fontSize:11,cellPadding:5,lineColor:[197,28,27],valign:"middle"},headStyles:{fillColor:[197,27,28],textColor:[255,255,255],fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,193,195]},columnStyles:{0:{cellWidth:20,halign:"center"},1:{cellWidth:160}},margin:{top:5}})}const y=e.internal.pageSize.height-20;e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(10,y,e.internal.pageSize.width-10,y),e.setFontSize(10),e.setFont("helvetica","italic"),e.text("Generated on: ".concat(new Date().toLocaleDateString()),e.internal.pageSize.width-15,e.internal.pageSize.height-10,{align:"right"}),e.text("Confidential Medical Document",15,e.internal.pageSize.height-10);const v=e.output("blob"),w=URL.createObjectURL(v);window.open(w,"_blank")}catch(e){console.log("Error generating appointment PDF:",e),alert("Failed to generate appointment PDF")}},v4=["10:30 AM","11:30 AM","12:30 PM","2:00 PM","3:00 PM","3:30 PM","4:30 PM","5:30 PM"];function HF(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(1),[i]=F.useState(5),[c,u]=F.useState({doctorName:"",status:"",date:""}),[h,p]=F.useState([]),[f,g]=F.useState(!1),[b,y]=F.useState(null),[v,w]=F.useState(""),[N,C]=F.useState(""),[I,T]=F.useState([]),[$,E]=F.useState(!1),[_,L]=F.useState(1),[O,z]=F.useState(!1),[A,U]=F.useState(!1),[X,Z]=F.useState(null),q=F.useRef(null),[B,K]=F.useState([]);F.useEffect(()=>{(async()=>{const Xe=sessionStorage.getItem("centreId");try{n(!0);const st=await Le.get("/api/admins/getAppointments/".concat(Xe),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});K(st.data),console.log(st.data);const St=st.data.map(pt=>{var Vt,Dt,zt,Kt,jt,Ls,Hn;const Ve=(Vt=pt.childId)!=null&&Vt.dob?new Date(pt.childId.dob):null,mt=Ve?Math.floor((new Date-Ve)/(365.25*24*60*60*1e3)):"N/A",yt=pt.appointmentDate?new Date(pt.appointmentDate):new Date;return{id:pt._id,childName:((Dt=pt.childId)==null?void 0:Dt.name)||"Unknown",age:mt,appointmentDate:yt,appointmentDateFormatted:yt.toLocaleDateString(),appointmentDateValue:yt.toISOString().split("T")[0],appointmentTime:pt.appointmentTime||"Not specified",consultationType:pt.consultationType||"Not specified",doctorName:((zt=pt.doctorId)==null?void 0:zt.name)||"Not assigned",doctorId:((Kt=pt.doctorId)==null?void 0:Kt._id)||null,status:pt.status||"pending",centreName:((jt=pt.centreId)==null?void 0:jt.name)||"Not specified",parentName:((Hn=(Ls=pt.childId)==null?void 0:Ls.parentId)==null?void 0:Hn.name)||"Not specified",prescription:pt.prescription||null}});e(St),p(St)}catch(st){console.error("Error fetching appointments:",st),Be.error("Failed to load appointments")}finally{n(!1)}})()},[]),F.useEffect(()=>{let je=[...s];if(c.doctorName&&(je=je.filter(Xe=>Xe.doctorName.toLowerCase().includes(c.doctorName.toLowerCase()))),c.status&&(je=je.filter(Xe=>Xe.status===c.status)),c.date){const Xe=new Date(c.date);je=je.filter(st=>st.appointmentDate.getFullYear()===Xe.getFullYear()&&st.appointmentDate.getMonth()===Xe.getMonth()&&st.appointmentDate.getDate()===Xe.getDate())}p(je),o(1)},[c,s]);const J=[...new Set(s.filter(je=>je.doctorName!=="Not assigned").map(je=>je.doctorName))],Q=je=>{const{name:Xe,value:st}=je.target;u(St=>({...St,[Xe]:st}))},ae=()=>{u({doctorName:"",status:"",date:""})},we=je=>{switch(je){case"pending":return"bg-amber-100 text-amber-800 border-amber-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";case"approved":return"bg-emerald-100 text-emerald-800 border-emerald-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},Ce=je=>{const Xe="px-3 py-1 text-xs font-medium rounded-md";switch(je){case"New Consultation":return"".concat(Xe," bg-blue-100 text-blue-800");case"Assessment(IQ)":return"".concat(Xe," bg-purple-100 text-purple-800");default:return"".concat(Xe," bg-gray-100 text-gray-800")}},ve=je=>{y(je),w(""),C(""),T([]),L(1),g(!0)},pe=()=>{g(!1),y(null),w(""),C(""),T([]),L(1)},xe=async()=>{if(!(!v||!(b!=null&&b.doctorId)))try{E(!0);const[je,Xe]=await Promise.all([Le.get("/api/superadmin/slot-config/".concat(b.doctorId,"?date=").concat(v),{headers:{Authorization:sessionStorage.getItem("token")}}),Le.get("/api/admins/getBookedSlots/".concat(b.doctorId,"/").concat(v),{headers:{Authorization:sessionStorage.getItem("token")}})]),st=je.data[0],St=Xe.data;if(st&&st.isHoliday){T([]),C(""),L(2),Be.info("Cannot reschedule - ".concat(st.holidayName," is a holiday"));return}let pt=[];st&&st.availableSlots&&st.availableSlots.length>0?pt=st.availableSlots.filter(mt=>mt.isActive&&!mt.isBlocked).map(mt=>mt.time):pt=v4;const Ve=St.unavailableSlots||[],Je=pt.filter(mt=>!Ve.includes(mt));T(Je),Je.includes(b.appointmentTime)?C(b.appointmentTime):C(Je[0]||""),L(2)}catch(je){console.error("Error fetching slots:",je),Be.error("Failed to fetch available time slots"),T(v4),C(b.appointmentTime),L(2)}finally{E(!1)}},ue=async()=>{if(!(!b||!v||!N))try{if(E(!0),(await Le.put("/api/admins/updateAppointment/".concat(b.id),{appointmentDate:v,appointmentTime:N},{headers:{Authorization:sessionStorage.getItem("token")}})).data.success!==!1){Be.success("Appointment rescheduled successfully"),pe();const Xe=sessionStorage.getItem("centreId"),st=await Le.get("/api/admins/getAppointments/".concat(Xe),{headers:{Authorization:sessionStorage.getItem("token")}});K(st.data)}else Be.error("Failed to reschedule appointment")}catch(je){console.error("Error rescheduling appointment:",je),Be.error("Failed to reschedule appointment")}finally{E(!1)}},ye=je=>{y(je),Z(null),z(!0),q.current&&(q.current.value="")},Y=()=>{z(!1),y(null),Z(null)},ce=je=>{je.target.files.length>0&&Z(je.target.files[0])},re=async()=>{if(!(!b||!X))try{U(!0);const je=new FormData;je.append("prescription",X),je.append("appointmentId",b.id);const Xe=await Le.post("/api/admins/uploadPrescription",je,{headers:{Authorization:"".concat(sessionStorage.getItem("token")),"Content-Type":"multipart/form-data"}});Be.success("Prescription uploaded successfully");const st=s.map(St=>St.id===b.id?{...St,prescription:Xe.data.appointment.prescription}:St);e(st),Y()}catch(je){console.error("Error uploading prescription:",je),Be.error("Failed to upload prescription")}finally{U(!1)}},ke=a*i,Me=ke-i,Ue=h.slice(Me,ke);console.log(h),console.log(Ue);const He=Math.ceil(h.length/i),We=je=>o(je);return t?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(Vs,{})}):r.jsxs("div",{className:"w-full bg-gray-50 p-6 rounded-xl",children:[f&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:[_===1&&"Select New Date",_===2&&"Select Time Slot",_===3&&"Confirm Changes"]}),_===1&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"editDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Date"}),r.jsx("input",{type:"date",id:"editDate",value:v,onChange:je=>w(je.target.value),min:new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:pe,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),r.jsx("button",{onClick:xe,disabled:!v,className:"px-4 py-2 rounded-lg ".concat(v?"bg-[#ab1c1c] text-white hover:bg-[#8a1717]":"bg-gray-300 cursor-not-allowed"),children:"Next"})]})]}),_===2&&r.jsx("div",{children:$?r.jsx("div",{className:"flex justify-center items-center h-32",children:r.jsx(Vs,{})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Available Time Slots for ",new Date(v).toLocaleDateString()]}),r.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto p-2",children:I.length>0?I.map(je=>r.jsx("button",{onClick:()=>C(je),className:"p-2 rounded-md border ".concat(N===je?"bg-[#ab1c1c] text-white":"bg-white hover:bg-gray-100"),children:je},je)):r.jsx("div",{className:"col-span-2 text-center py-4 text-gray-500",children:"No available slots for this date"})})]}),r.jsxs("div",{className:"flex justify-between space-x-3 mt-6",children:[r.jsx("button",{onClick:()=>L(1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back"}),r.jsx("button",{onClick:()=>L(3),disabled:!N,className:"px-4 py-2 rounded-lg ".concat(N?"bg-[#ab1c1c] text-white hover:bg-[#8a1717]":"bg-gray-300 cursor-not-allowed"),children:"Next"})]})]})}),_===3&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Child Name"}),r.jsx("p",{className:"text-lg",children:b.childName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Doctor"}),r.jsx("p",{className:"text-lg",children:b.doctorName})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Current Date"}),r.jsx("p",{className:"text-lg",children:b.appointmentDateFormatted})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"New Date"}),r.jsx("p",{className:"text-lg",children:new Date(v).toLocaleDateString()})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Current Time"}),r.jsx("p",{className:"text-lg",children:b.appointmentTime})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"New Time"}),r.jsx("p",{className:"text-lg",children:N})]})]})]}),r.jsxs("div",{className:"flex justify-between space-x-3 mt-6",children:[r.jsx("button",{onClick:()=>L(2),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back"}),r.jsx("button",{onClick:handleUpdateAppointment,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Confirm Changes"})]})]})]})})}),O&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:"Upload Prescription"}),r.jsxs("div",{className:"mb-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Child Name"}),r.jsx("p",{className:"text-lg",children:b.childName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Doctor"}),r.jsx("p",{className:"text-lg",children:b.doctorName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Appointment Date"}),r.jsx("p",{className:"text-lg",children:b.appointmentDateFormatted})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Appointment Time"}),r.jsx("p",{className:"text-lg",children:b.appointmentTime})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{htmlFor:"prescriptionFile",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Prescription File"}),r.jsx("input",{type:"file",id:"prescriptionFile",ref:q,onChange:ce,accept:".pdf,.jpg,.jpeg,.png",className:"w-full text-sm text-gray-500\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-lg file:border-0\n                      file:text-sm file:font-medium\n                      file:bg-red-50 file:text-[#ab1c1c]\n                      hover:file:bg-red-100"}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Accepted formats: PDF, JPG, JPEG, PNG"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:Y,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:A,children:"Cancel"}),r.jsxs("button",{onClick:re,disabled:!X||A,className:"px-4 py-2 rounded-lg flex items-center ".concat(!X||A?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:[A&&r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),A?"Uploading...":"Upload Prescription"]})]})]})})}),r.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold text-[#ab1c1c]",children:"Appointments"}),r.jsx("p",{className:"text-gray-600 mt-1",children:r.jsxs("span",{children:[h.length," appointments found"]})})]}),r.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-red-200",children:[r.jsx("p",{className:"text-sm font-medium text-[#ab1c1c]",children:"Today's Date"}),r.jsx("p",{className:"text-lg font-bold text-gray-800",children:new Date().toLocaleDateString("en-GB")})]})]}),r.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg shadow border border-red-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-[#ab1c1c] mb-3",children:"Filters"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"doctorName",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Doctor"}),r.jsxs("select",{id:"doctorName",name:"doctorName",value:c.doctorName,onChange:Q,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"All Doctors"}),J.map(je=>r.jsx("option",{value:je,children:je},je))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:Q,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Date"}),r.jsx("input",{type:"date",id:"date",name:"date",value:c.date,onChange:Q,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:ae,className:"bg-red-100 hover:bg-red-200 text-[#ab1c1c] px-4 py-2 rounded-lg transition-colors duration-150 border border-red-300",children:"Reset Filters"})})]})]}),r.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg border border-red-200",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-red-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Consultation Type"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:Ue.length>0?Ue.map((je,Xe)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors duration-150 ".concat(Xe%2===0?"bg-white":"bg-red-50"),children:[r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center",children:r.jsx("div",{className:"ml-4",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:je.childName})})})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center text-sm text-gray-900",children:je.appointmentDateFormatted})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center text-sm text-gray-900",children:je.appointmentTime})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("span",{className:Ce(je.consultationType),children:je.consultationType})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center",children:r.jsx("div",{className:"text-sm text-gray-900",children:je.doctorName!=="Not assigned"?je.doctorName:r.jsx("span",{className:"text-gray-500 italic",children:"Not assigned"})})})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("span",{className:"text-xs font-medium px-3 py-1 rounded-full ".concat(we(je.status)),children:je.status.charAt(0).toUpperCase()+je.status.slice(1)})}),r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>ve(je),className:"text-xs px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition font-medium",children:"Reschedule"}),je.status==="approved"&&r.jsx(r.Fragment,{children:je.prescription?r.jsx("a",{className:"text-xs px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition font-medium",href:"https://totalapi.joywithlearning.com/api/admins/get-prescription/".concat(je.id),target:"_blank",rel:"noopener noreferrer",children:"View Prescription"}):r.jsx("button",{onClick:()=>ye(je),className:"text-xs px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition font-medium",children:"Upload Prescription"})}),r.jsx("button",{onClick:()=>_y(je),className:"text-xs px-3 py-1 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 transition",title:"Download Appointment PDF",children:"Download"})]})})]},je.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"8",className:"py-8 px-6 text-center text-gray-500",children:"No appointments found with the selected filters."})})})]})}),h.length>i&&r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-red-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",r.jsx("span",{className:"font-medium",children:Me+1})," to"," ",r.jsx("span",{className:"font-medium",children:ke>h.length?h.length:ke})," ","of ",r.jsx("span",{className:"font-medium",children:h.length})," results"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>We(a>1?a-1:1),disabled:a===1,className:"px-4 py-2 text-sm rounded-md ".concat(a===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:"Previous"}),Array.from({length:He},(je,Xe)=>Xe+1).map(je=>r.jsx("button",{onClick:()=>We(je),className:"px-4 py-2 text-sm rounded-md ".concat(a===je?"bg-[#ab1c1c] text-white":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:je},je)),r.jsx("button",{onClick:()=>We(a<He?a+1:He),disabled:a===He,className:"px-4 py-2 text-sm rounded-md ".concat(a===He?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:"Next"})]})]})}),s.length===0&&r.jsxs("div",{className:"py-12 px-6 text-center",children:[r.jsx("svg",{className:"mx-auto h-16 w-16 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No appointments found"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"There are no appointments in the system yet."})]})]}),f&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4 shadow-2xl",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c]",children:"Reschedule Appointment"}),r.jsx("button",{onClick:pe,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),_===1&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[r.jsx("strong",{children:"Current appointment:"})," ",b.appointmentDateFormatted," at ",b.appointmentTime]}),r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[r.jsx("strong",{children:"Child:"})," ",b.childName]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{htmlFor:"editDate",className:"block text-sm font-medium text-[#ab1c1c] mb-2",children:"Select New Date"}),r.jsx("input",{type:"date",id:"editDate",value:v,onChange:je=>w(je.target.value),min:new Date().toISOString().split("T")[0],className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:pe,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:xe,disabled:!v||$,className:"px-4 py-2 rounded-lg font-medium ".concat(!v||$?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:$?"Loading...":"Next"})]})]}),_===2&&r.jsxs("div",{children:[r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[r.jsx("strong",{children:"Selected Date:"})," ",new Date(v).toLocaleDateString("en-GB")]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-[#ab1c1c] mb-2",children:"Select Available Time Slot"}),I.length>0?r.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:I.map(je=>r.jsx("button",{onClick:()=>C(je),className:"p-2 text-sm border rounded-lg ".concat(N===je?"bg-[#ab1c1c] text-white border-[#ab1c1c]":"bg-white text-gray-700 border-gray-300 hover:bg-red-50"),children:je},je))}):r.jsx("p",{className:"text-sm text-gray-500 p-4 text-center border rounded-lg",children:"No available time slots for this date"})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>L(1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Back"}),r.jsx("button",{onClick:ue,disabled:!N||$,className:"px-4 py-2 rounded-lg font-medium ".concat(!N||$?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:$?"Rescheduling...":"Reschedule Appointment"})]})]})]})})]})}const w4="\r\nhttps://testingtotalapi.joywithlearning.com",qF=["Case History","Prescription","IEP","IQ Report","OT Report","Speech Report","Other"];function KF(){const s=xs(),{childId:e}=Vo(),t=Bo(),[n,a]=F.useState([]),[o,i]=F.useState([]),[c,u]=F.useState(""),[h,p]=F.useState(""),[f,g]=F.useState(null),[b,y]=F.useState(null),[v,w]=F.useState({name:"",dob:"",gender:"",admitStatus:"active",schoolName:"",schoolBoard:"",caseId:"",registrationId:"",parentName:"",parentMobile:"",parentEmail:"",parentAddress:""}),[N,C]=F.useState([]),[I,T]=F.useState([]),[$,E]=F.useState([]),[_,L]=F.useState(!0),[O,z]=F.useState(!1),[A,U]=F.useState(null);F.useEffect(()=>{t.state&&t.state.childData?X(t.state.childData):Z()},[e]);const X=pe=>{var ue,ye,Y,ce;let xe=pe.admitStatus||"active";(pe.doctorId||pe.therapistId)&&xe==="pending"&&(xe="active"),w({name:pe.name||"",dob:pe.dob?pe.dob.split("T")[0]:"",gender:pe.gender||"",admitStatus:xe,schoolName:pe.schoolName||"",schoolBoard:pe.schoolBoard||"",caseId:pe.caseId||"",registrationId:pe.registrationId||"",parentName:((ue=pe.parentId)==null?void 0:ue.name)||"",parentMobile:((ye=pe.parentId)==null?void 0:ye.mobilenumber)||"",parentEmail:((Y=pe.parentId)==null?void 0:Y.email)||"",parentAddress:((ce=pe.parentId)==null?void 0:ce.address)||"",profilePicture:pe.profilePicture||""}),u(pe.doctorId||""),p(pe.therapistId||""),C(pe.reports||[]),L(!1),q()},Z=async()=>{try{L(!0);const pe=sessionStorage.getItem("token"),xe=await Le.get("/api/data/child/".concat(e),{headers:{Authorization:pe}});X(xe.data)}catch(pe){U("Failed to load child data."),L(!1)}},q=async()=>{var pe,xe,ue,ye;try{const Y=sessionStorage.getItem("token"),[ce,re]=await Promise.all([Le.get("/api/data/allDoctors/".concat(((xe=(pe=t.state)==null?void 0:pe.childData)==null?void 0:xe.centreId)||""),{headers:{Authorization:Y}}),Le.get("/api/data/allTherapists/".concat(((ye=(ue=t.state)==null?void 0:ue.childData)==null?void 0:ye.centreId)||""),{headers:{Authorization:Y}})]);a(ce.data.doctors||[]),i(re.data.therapists||[])}catch(Y){console.error("Failed to fetch staff",Y)}},B=pe=>{const{name:xe,value:ue}=pe.target;w(ye=>({...ye,[xe]:ue}))},K=()=>{T(pe=>[...pe,{id:Date.now(),type:"",file:null}])},J=(pe,xe)=>{T(ue=>ue.map(ye=>ye.id===xe?{...ye,type:pe.target.value}:ye))},Q=(pe,xe)=>{const ue=pe.target.files[0];if(ue&&ue.size>50*1024*1024){alert("File size should not exceed 50MB");return}T(ye=>ye.map(Y=>Y.id===xe?{...Y,file:ue}:Y))},ae=pe=>{T(xe=>xe.filter(ue=>ue.id!==pe))},we=pe=>{const xe=pe.target.files[0];if(xe){if(xe.size>5*1024*1024){alert("Profile picture size should not exceed 5MB"),g(null),y(null);return}g(xe),y(URL.createObjectURL(xe))}else g(null),y(null)},Ce=pe=>{window.confirm("Remove this existing report? It will be deleted when you save.")&&(E([...$,pe]),C(N.filter(xe=>xe._id!==pe)))},ve=async pe=>{var ue,ye;if(pe.preventDefault(),!!window.confirm("Are you sure you want to save all changes?"))try{z(!0);const Y=sessionStorage.getItem("token"),ce=new FormData;let re=v.admitStatus;(c||h)&&(re="active"),Object.keys(v).forEach(ke=>{ke!=="profilePicture"&&ce.append(ke,v[ke])}),ce.set("admitStatus",re),f?ce.append("profilePicture",f):b===null&&v.profilePicture?ce.append("clearProfilePicture","true"):v.profilePicture&&ce.append("existingProfilePicturePath",v.profilePicture),ce.append("doctorId",c),ce.append("therapistId",h),ce.append("reportsToDelete",JSON.stringify($)),I.forEach(ke=>{ke.file&&ke.type&&(ce.append("newReports",ke.file),ce.append("reportTypes",ke.type))}),await Le.put("/api/admins/edit-child/".concat(e),ce,{headers:{Authorization:Y,"Content-Type":"multipart/form-data"}}),alert("Updated successfully!"),s("/admindashboard")}catch(Y){alert("Update failed: ".concat(((ye=(ue=Y.response)==null?void 0:ue.data)==null?void 0:ye.message)||Y.message))}finally{z(!1)}};return _?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):r.jsxs("div",{className:"p-4 sm:p-6 mt-16 max-w-7xl mx-auto pb-20",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8 gap-4 border-b pb-4",children:[r.jsx("div",{children:r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Child Profile"})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{type:"button",onClick:()=>s(-1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md",children:"Cancel"}),r.jsx("button",{onClick:ve,disabled:O,className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md shadow-md disabled:bg-red-300",children:O?"Processing Request...":"Save All Changes"})]})]}),r.jsxs("form",{onSubmit:ve,className:"space-y-8",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Personal Information"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2 flex flex-col items-center gap-4 mb-4",children:[r.jsx("img",{src:b||(v.profilePicture?"".concat(w4).concat(v.profilePicture):"https://via.placeholder.com/150?text=No+Image"),alt:"Child Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-[#ab1c1c]"}),r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mt-2",children:"Upload New Profile Picture"}),r.jsx("input",{type:"file",accept:"image/*",onChange:we,className:"mt-1 w-full p-1.5 border border-gray-300 rounded text-sm bg-white"})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Full Name"}),r.jsx("input",{type:"text",name:"name",value:v.name,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-red-800 outline-none",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"dob",value:v.dob,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Gender"}),r.jsxs("select",{name:"gender",value:v.gender,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Staff"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Assigned Doctor"}),r.jsxs("select",{value:c,onChange:pe=>u(pe.target.value),className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select Doctor"}),n.map(pe=>r.jsx("option",{value:pe._id,children:pe.name},pe._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Assigned Therapist"}),r.jsxs("select",{value:h,onChange:pe=>p(pe.target.value),className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select Therapist"}),o.map(pe=>r.jsx("option",{value:pe._id,children:pe.name},pe._id))]})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Other Information"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"School Name"}),r.jsx("input",{type:"text",name:"schoolName",value:v.schoolName,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Case ID"}),r.jsx("input",{type:"text",name:"caseId",value:v.caseId,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Registration ID"}),r.jsx("input",{type:"text",name:"registrationId",value:v.registrationId,onChange:B,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Manage Reports & Documents"})}),r.jsxs("div",{className:"p-4 space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Currently Stored Files:"}),N.length>0?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:N.map(pe=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded bg-gray-50",children:[r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:pe.type}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(pe.uploadedAt).toLocaleDateString()})]}),r.jsxs("div",{className:"flex gap-2 shrink-0",children:[r.jsx("button",{type:"button",onClick:()=>window.open("".concat(w4).concat(pe.filePath),"_blank"),className:"text-blue-600 text-sm font-medium",children:"View"}),r.jsx("button",{type:"button",onClick:()=>Ce(pe._id),className:"text-red-600 text-sm font-medium",children:"Remove"})]})]},pe._id))}):r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No reports attached."})]}),r.jsx("hr",{}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Upload New Files:"}),r.jsx("div",{className:"space-y-3",children:I.map(pe=>r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-end bg-gray-50 p-3 rounded-md border border-dashed border-gray-300",children:[r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Report Type"}),r.jsxs("select",{value:pe.type,onChange:xe=>J(xe,pe.id),className:"mt-1 w-full p-2 border rounded text-sm bg-white",required:!0,children:[r.jsx("option",{value:"",children:"Select Type"}),qF.map(xe=>r.jsx("option",{value:xe,children:xe},xe))]})]}),r.jsxs("div",{className:"w-full sm:flex-1",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Select File"}),r.jsx("input",{type:"file",onChange:xe=>Q(xe,pe.id),className:"mt-1 w-full p-1.5 border rounded text-sm bg-white",required:!0})]}),r.jsx("button",{type:"button",onClick:()=>ae(pe.id),className:"text-red-600 hover:bg-red-50 p-2 rounded transition",children:""})]},pe.id))}),r.jsx("button",{type:"button",onClick:K,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-sm font-medium",children:"+ Add File"})]})]})]}),r.jsx("div",{className:"flex justify-center pt-6",children:r.jsx("button",{type:"submit",disabled:O,className:"w-full sm:w-auto px-12 py-3 bg-[#ab1c1c] text-white font-bold rounded-lg hover:bg-[#8e1818] shadow-lg disabled:bg-red-300 uppercase",children:O?"Processing Request...":"Save All Changes"})})]})]})}function XF(){const[s,e]=F.useState([]),[t,n]=F.useState(null),[a,o]=F.useState(!1),[i,c]=F.useState(""),[u,h]=F.useState(!1),[p,f]=F.useState(null),[g,b]=F.useState(""),[y,v]=F.useState(1),[w,N]=F.useState([]),C=5,I=xs();F.useEffect(()=>{(async()=>{h(!0);try{const B=sessionStorage.getItem("token");if(!B){c("Authentication token missing. Please log in again."),h(!1);return}const K=await Le.get("/api/therapists/assigned",{headers:{Authorization:"".concat(B)}});if(!K.data){c("No data received from server"),h(!1);return}if(K.data.length===0){c("No Children Assigned"),h(!1);return}c(""),e(K.data),N(K.data)}catch(B){console.error("API Error:",B),f(B.message||"Failed to fetch data"),c("Error loading data. Please try again later.")}finally{h(!1)}})()},[]),F.useEffect(()=>{const q=s.filter(B=>{var K;return(K=B.name)==null?void 0:K.toLowerCase().includes(g.toLowerCase())});N(q),v(1)},[g,s]);const T=q=>{if(!q)return"Unknown";const B=new Date(q),K=new Date;let J=K.getFullYear()-B.getFullYear();const Q=K.getMonth()-B.getMonth();return(Q<0||Q===0&&K.getDate()<B.getDate())&&J--,J},$=q=>{if(!q)return"Not specified";const B={day:"numeric",month:"short",year:"numeric"};return new Date(q).toLocaleDateString("en-GB",B)},E=q=>{try{if(!q||!q._id){console.error("Invalid child data:",q);return}o(!0),n(q)}catch(B){console.error("Error in handleRowClick:",B)}},_=()=>{o(!1),n(null),sessionStorage.removeItem("childId")},L=()=>{console.log(t),t&&t._id&&(sessionStorage.setItem("childId",t._id),I("/reports?childId=".concat(t._id)))},O=()=>{t&&t._id&&(sessionStorage.setItem("childId",t._id),I("/therapistdashboard/iep?childId=".concat(t._id)))},z=y*C,A=z-C,U=w.slice(A,z),X=q=>v(q),Z=()=>t?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-2xl font-bold text-[#ab1c1c]",children:[t.name||"Child","'s Details"]}),r.jsx("button",{onClick:_,className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Personal Information"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",t.name||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Age:"})," ",T(t.dob)," years"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Date of Birth:"})," ",$(t.dob)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Gender:"})," ",t.gender||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Status:"})," ",r.jsx("span",{className:"px-2 py-1 rounded text-xs ".concat(t.admitStatus==="active"?"bg-green-100 text-green-800":t.admitStatus==="inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:t.admitStatus?t.admitStatus.charAt(0).toUpperCase()+t.admitStatus.slice(1):"Pending"})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Education Information"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Name:"})," ",t.schoolName||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Board:"})," ",t.schoolBoard||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Centre Number:"})," ",t.centreId.name||"Not specified"]})]})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Associated Professionals"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Doctor ID:"})," ",t.doctorId.name||"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Therapist ID:"})," ",t.therapistId.name||"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Parent ID:"})," ",t.parentId.name||"Not specified"]})]})]})}),r.jsx("div",{className:"grid grid-cols-1 gap-4 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Records"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IEPs:"})," ",t.IEPs&&t.IEPs.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Prescription Reports:"})," ",t.prescriptionReports&&t.prescriptionReports.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Appointments:"})," ",t.appointments&&t.appointments.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Game Reports:"})," ",t.gameReports&&t.gameReports.length||0," ","records"]})]})]})}),r.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[r.jsx("button",{onClick:O,className:"bg-[#ab1c1c] text-white px-4 py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"IEP"}),r.jsx("button",{onClick:q=>{q.stopPropagation(),localStorage.setItem("childId",t._id),localStorage.setItem("therapistId",t.therapistId._id),I("/games")},className:"bg-green-600 text-white px-4 py-2 rounded-md shadow hover:bg-green-700 transition",children:"Play Games"}),r.jsx("button",{onClick:L,className:"bg-[#8e1818] text-white px-4 py-2 rounded-md shadow hover:bg-red-700 transition",children:"Reports"})]})]})})}):null;return r.jsxs("div",{className:"container mx-auto mt-20 px-4",children:[r.jsx("div",{className:"flex justify-center items-center mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] flex-grow-1 text-center",children:"Therapist Dashboard"})}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by name...",value:g,onChange:q=>b(q.target.value),className:"w-full p-2 sm:p-3 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),u?r.jsx("div",{className:"flex justify-center items-center",children:r.jsx(Vs,{})}):i?r.jsx("h3",{className:"text-center text-gray-500 text-xl",children:i}):null,p&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[r.jsx("p",{className:"font-bold",children:"Error"}),r.jsx("p",{children:p})]}),s&&s.length>0&&!u&&!i&&r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-x-auto mb-6",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Name"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Date of Birth"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Age"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Gender"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"IEP"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Games"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Reports"})]})}),r.jsx("tbody",{className:"divide-y divide-red-200",children:U.map((q,B)=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200 cursor-pointer",onClick:()=>E(q),children:[r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:q.name||"Unnamed Child"}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$(q.dob)}),r.jsxs("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:[T(q.dob)," years"]}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:q.gender||"Not specified"}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"text-[#ab1c1c] hover:underline",onClick:K=>{K.stopPropagation(),sessionStorage.setItem("childId",q._id),sessionStorage.setItem("childName",q.name),I("/therapistdashboard/iep?childId=".concat(q._id))},children:"View"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition duration-200",onClick:K=>{K.stopPropagation(),localStorage.setItem("childId",q._id),localStorage.setItem("therapistId",q.therapistId._id),I("/facedetection")},children:"Play"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"text-[#8e1818] hover:underline",onClick:K=>{K.stopPropagation(),sessionStorage.setItem("childId",q._id),I("/reports?childId=".concat(q._id))},children:"View"})})]},q._id||"item-".concat(B)))})]})}),w.length>C&&!u&&!i&&r.jsx("div",{className:"flex justify-center mt-4 sm:mt-6",children:Array.from({length:Math.ceil(w.length/C)},(q,B)=>r.jsx("button",{onClick:()=>X(B+1),className:"mx-1 px-3 py-1 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base ".concat(y===B+1?"bg-[#ab1c1c] text-white":"bg-red-200 text-[#ab1c1c] hover:bg-red-300"),children:B+1},B+1))}),a&&t&&Z()]})}function YF(){const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState(""),[i,c]=F.useState(1),[u,h]=F.useState(""),[p,f]=F.useState(!1),g=5,b=xs();F.useEffect(()=>{(async()=>{try{const E=await Le.get("/api/doctors/assigned",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});E.data.length===0&&h("No children assigned"),e(E.data),n(E.data)}catch(E){Be.error("Error fetching children")}})()},[]);const y=()=>{b("/doctordashboard/viewappointment")};F.useEffect(()=>{const $=s.filter(E=>E.name.toLowerCase().includes(a.toLowerCase()));n($),c(1)},[a,s]);const v=i*g,w=v-g,N=t.slice(w,v),C=$=>c($),I=async($,E,_,L)=>{if(!E||E===null||E==="null"){f(!0);return}sessionStorage.setItem("childId",$),sessionStorage.setItem("therapistName",E),sessionStorage.setItem("childName",_),sessionStorage.setItem("centreName",L),b("/doctordashboard/iepdoctor")},T=()=>{f(!1)};return r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto \n                sm:mt-6 md:mt-8 lg:mt-10 xl:mt-12\n            ",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6 sm:mb-8",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:"Doctor Dashboard"}),r.jsx("button",{className:"bg-[#ab1c1c] text-white px-2 py-2 rounded-lg hover:bg-[#8e1818]",onClick:y,children:"Appointments"})]}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by name...",value:a,onChange:$=>o($.target.value),className:"w-full p-2 sm:p-3 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Name"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Date of Birth"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Gender"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Centre"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"IEP"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Game Reports"})]})}),u?r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-4",children:"No children assigned"})})}):r.jsx("tbody",{className:"divide-y divide-red-200",children:N.map(($,E)=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.name}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:new Date($.dob).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.gender}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.centreId.name}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded-lg hover:bg-blue-600",onClick:()=>I($._id,$.therapistId?$.therapistId.name:null,$.name,$.centreId.name),children:"Assign/View"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-green-600 text-white px-2 py-1 rounded-lg hover:bg-green-700",onClick:()=>b("/reports?childId=".concat($._id)),children:"View"})})]},E))})]})}),r.jsx("div",{className:"flex justify-center mt-4 sm:mt-6",children:Array.from({length:Math.ceil(t.length/g)},($,E)=>r.jsx("button",{onClick:()=>C(E+1),className:"mx-1 px-3 py-1 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base ".concat(i===E+1?"bg-[#ab1c1c] text-white":"bg-red-200 text-[#ab1c1c] hover:bg-red-300"),children:E+1},E+1))}),p&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-yellow-100 rounded-full mb-4",children:r.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 text-center mb-2",children:"No Therapist Assigned"}),r.jsx("p",{className:"text-gray-600 text-center mb-6",children:"This child does not have a therapist assigned. Please contact the administrator to assign a therapist before proceeding with IEP management."}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:T,className:"bg-[#ab1c1c] text-white px-6 py-2 rounded-lg hover:bg-[#8e1818] transition duration-200",children:"OK"})})]})})})]})]})}const ZF=s=>new Promise((e,t)=>{const n=new Image;n.onload=()=>{const a=document.createElement("canvas");a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0),e(a.toDataURL("image/jpeg"))},n.onerror=t,n.src=s}),$u=async s=>{var e,t,n,a,o,i,c;try{const u=new Dy;let h=15;if(!s||!s.monthlyGoals){u.setFontSize(14),u.text("No IEP data available",u.internal.pageSize.width/2,20,{align:"center"}),u.output("dataurlnewwindow");return}const p=B=>{const K=new Date(B),J=new Date;let Q=J.getFullYear()-K.getFullYear();const ae=J.getMonth()-K.getMonth();return(ae<0||ae===0&&J.getDate()<K.getDate())&&Q--,Q},f=(s==null?void 0:s.therapy)||"N/A",g=(s==null?void 0:s.therapistName)||"N/A",b=s!=null&&s.startingMonth&&(s!=null&&s.startingYear)?"".concat(s.startingMonth," ").concat(s.startingYear):"N/A",y=((e=s==null?void 0:s.doctorId)==null?void 0:e.name)||"N/A",v=((t=s==null?void 0:s.childId)==null?void 0:t.name)||"N/A";let w=((n=s==null?void 0:s.childId)==null?void 0:n.gender)||"N/A";const N=((a=s==null?void 0:s.childId)==null?void 0:a.dob.split("T")[0])||"N/A",C=p((o=s==null?void 0:s.childId)==null?void 0:o.dob)||"N/A";w=w.charAt(0).toUpperCase()+w.slice(1);const I=((c=(i=s==null?void 0:s.childId)==null?void 0:i.centreId)==null?void 0:c.name)||"N/A";try{const B=await ZF(ig);u.addImage(B,"PNG",15,10,40,20)}catch(B){console.log("Failed to add logo:",B),u.setFontSize(12),u.setFont("helvetica","bold"),u.text("Hospital Logo",15,20)}u.setFontSize(12),u.setFont("helvetica","normal"),u.text(["Total Solution - Barkatpura","3-4-495/B, 1st Floor, YMCA Near More Super Market, Hyderabad, Telangana 500027, IN","Phone: +91 88860 08697"],15,35),u.setFillColor(197,27,28),u.rect(2,50,u.internal.pageSize.width-4,25,"F"),u.setFontSize(18),u.setTextColor(255,255,255),u.setFont("helvetica","bold"),u.text("Individualized Education Program (IEP)",u.internal.pageSize.width/2,65,{align:"center"}),u.setTextColor(0,0,0);const T=85,$=75;u.setFillColor(255,193,195),u.roundedRect(10,T,u.internal.pageSize.width-20,$,3,3,"F"),u.setFontSize(14),u.setFont("helvetica","bold"),u.text("Child: ".concat(v),15,T+12);const E=(u.internal.pageSize.width-40)/2,_=20,L=_+E+10,O=25,z=T+18;u.setDrawColor(255,255,255),u.setLineWidth(.2),u.line(15,z,u.internal.pageSize.width-15,z);let A=T+28;u.setFont("helvetica","bold"),u.text("Therapist:",_,A),u.setFont("helvetica","normal"),u.text(g,_+O,A),u.setFont("helvetica","bold"),u.text("Starting:",L,A),u.setFont("helvetica","normal"),u.text(b,L+O,A),A+=12,u.setFont("helvetica","bold"),u.text("Doctor:",_,A),u.setFont("helvetica","normal"),u.text(y,_+O,A),u.setFont("helvetica","bold"),u.text("DOB:",L,A),u.setFont("helvetica","normal"),u.text("".concat(N," (").concat(C," years)"),L+O,A),A+=12,u.setFont("helvetica","bold"),u.text("Therapy:",_,A),u.setFont("helvetica","normal"),u.text(f,_+O,A),u.setFont("helvetica","bold"),u.text("Gender:",L,A),u.setFont("helvetica","normal"),u.text("".concat(w),L+O,A),A+=12,u.setFont("helvetica","bold"),u.text("Centre:",_,A),u.setFont("helvetica","normal"),u.text(I,_+O,A);const U=[];Array.isArray(s.monthlyGoals)&&s.monthlyGoals.length>0&&s.monthlyGoals.forEach(B=>{const K=B.latest,J=Array.isArray(K.goals)?K.goals.map((ae,we)=>"".concat(we+1,") ").concat(ae)).join("\n\n"):"N/A",Q=Array.isArray(K.performance)?K.performance.map((ae,we)=>"".concat(we+1,") ").concat(ae)).join("\n\n"):"N/A";U.push([K.month||"N/A",K.target||"N/A",J,Q,K.therapistFeedback||"N/A",K.doctorFeedback||"N/A"])}),D1(u,{head:[["Month","Long-Term Goals","Short-Term Goals","Performance","Therapist Feedback","Doctor Feedback"]],body:U,startY:T+$+10,styles:{fontSize:10,cellPadding:3,lineColor:[197,28,27],valign:"middle"},headStyles:{fillColor:[197,28,27],textColor:[255,255,255],fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,193,195]},columnStyles:{0:{cellWidth:20,halign:"center"},1:{cellWidth:30,halign:"left"},2:{cellWidth:35,halign:"left"},3:{cellWidth:35,halign:"left"},4:{cellWidth:35,halign:"left"},5:{cellWidth:35,halign:"left"}},margin:{top:10}});const Z=new Date().toLocaleDateString(),q=u.internal.pageSize.height-20;u.setDrawColor(197,27,28),u.setLineWidth(.5),u.line(10,q,u.internal.pageSize.width-10,q),u.setFontSize(10),u.setFont("helvetica","italic"),u.text("Generated on: ".concat(Z),u.internal.pageSize.width-15,u.internal.pageSize.height-10,{align:"right"}),u.text("Confidential Medical Document",15,u.internal.pageSize.height-10),u.output("dataurlnewwindow")}catch(u){console.log("Error generating PDF:",u),alert("Failed to generate PDF")}};function QF(){var pe,xe;const[s,e]=F.useState([]),[t,n]=F.useState(!1),[a,o]=F.useState(null),[i,c]=F.useState(!1),[u,h]=F.useState(""),p=sessionStorage.getItem("therapistName"),[f,g]=F.useState(!1),[b,y]=F.useState(null),v=new Date().getFullYear(),w=new Date().getMonth()+1,[N,C]=F.useState(!1),[I,T]=F.useState(null),[$,E]=F.useState(""),[_,L]=F.useState(!1),[O,z]=F.useState(""),[A,U]=F.useState(null);F.useEffect(()=>{(async()=>{c(!0);try{const ye=await Le.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(ye.data)}catch(ye){console.error("Error fetching data: "+ye)}finally{c(!1)}})()},[]);const X=(ue,ye,Y,ce)=>{const{name:re,value:ke}=ue.target;o(Me=>{const Ue={...Me};if(ce==="goals"&&ye!==void 0&&Y!==void 0)Ue.monthlyGoals[ye].latest.goals[Y]=ke;else if(ce==="target"&&ye!==void 0)Ue.monthlyGoals[ye].latest.target=ke;else if(re==="therapy")Ue.therapy=ke;else if(re==="startingMonth"){const He=parseInt(ke),We=new Date(0,He-1).toLocaleString("default",{month:"long"}),je=[He,He%12+1,(He+1)%12+1],Xe=je.map(st=>new Date(0,st-1).toLocaleString("default",{month:"long"}));Ue.startingMonth=We,Ue.selectedMonths=je,Ue.selectedMonthsNames=Xe,Ue.monthlyGoals=Xe.map(st=>({latest:{month:st,target:"",goals:[""],performance:[],therapistFeedback:"",doctorFeedback:"",childVideo:"",updatedAt:new Date},history:[]}))}else re==="year"?(Ue.startingYear=ke,ke===v.toString()&&(Ue.startingMonth=Math.max(parseInt(Ue.startingMonth),w))):re==="feedback"&&(Ue.feedback=ke);return Ue})},Z=(ue,ye)=>{const Y=ue.monthlyGoals[ye],ce={month:Y.latest.month,performance:Y.latest.performance,target:Y.latest.target,goals:Y.latest.goals,therapistFeedback:Y.latest.therapistFeedback,childVideo:Y.latest.childVideo};z(ue._id),E(Y.latest.doctorFeedback||""),T(ce),console.log(ce),C(!0)},q=(ue,ye)=>{const Y=!!ue;if(g(Y),h(Y?"Update Progress":"Assign"),Y){y(ye);const ce=JSON.parse(JSON.stringify(ue));ce.iepId=ue._id,o(ce)}else{const ce=w,re=[ce,ce%12+1,(ce+1)%12+1],ke=re.map(Me=>new Date(0,Me-1).toLocaleString("default",{month:"long"}));o({iepId:"",doctorId:sessionStorage.getItem("doctorId"),therapy:"",therapistName:p,feedback:"",monthlyGoals:ke.map(Me=>({latest:{month:Me,target:"",goals:[""],performance:[],therapistFeedback:"",doctorFeedback:"",childVideo:"",updatedAt:new Date},history:[]})),startingYear:v,startingMonth:new Date(0,w-1).toLocaleString("default",{month:"long"}),selectedMonths:re,selectedMonthsNames:ke})}n(!0)},B=()=>{o(null),n(!1),g(!1),y(null)},K=async ue=>{if(ue.preventDefault(),L(!0),!f&&!Q()){L(!1);return}const ye=parseInt(a.startingYear,10),Y=a.selectedMonths[0];if(ye<v||ye===v&&Y<w){Be.error("Starting month and year cannot be in the past.",{autoClose:2e3}),L(!1);return}try{if(f){const re={...a.monthlyGoals[b]};re.history.push({...re.latest}),re.latest={...re.latest,updatedAt:new Date};const ke=await Le.put("/api/doctors/updateIEP/".concat(sessionStorage.getItem("childId")),{iepId:a.iepId,monthlyGoals:re,monthIndex:b,feedback:a.feedback},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});Be.success("IEP updated successfully!",{autoClose:2e3})}else{const re=await Le.post("/api/doctors/assignIEP/".concat(sessionStorage.getItem("childId")),{doctorId:a.doctorId,therapy:a.therapy,therapistName:a.therapistName,feedback:a.feedback,monthlyGoals:a.monthlyGoals,startingMonth:a.startingMonth,startingYear:a.startingYear,selectedMonths:a.selectedMonths,selectedMonthsNames:a.selectedMonthsNames},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});Be.success("New IEP created successfully!",{autoClose:2e3})}const ce=await Le.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(ce.data),n(!1)}catch(ce){Be.error("Error submitting form: "+ce.message,{autoClose:2e3}),console.error("Error submitting form:",ce)}finally{L(!1)}},J=ue=>{f&&ue!==b||o(ye=>{const Y=[...ye.monthlyGoals];return Y[ue].latest.goals.push(""),{...ye,monthlyGoals:Y}})},Q=()=>{if(!a.therapy)return Be.error("Therapy type is required",{autoClose:2e3}),!1;if(!a.startingYear)return Be.error("Year is required",{autoClose:2e3}),!1;if(!a.startingMonth)return Be.error("Starting month is required",{autoClose:2e3}),!1;if(a.monthlyGoals.length!==3)return Be.error("Goals for all three months must be provided",{autoClose:2e3}),!1;for(const[ue,ye]of a.monthlyGoals.entries()){if(!ye.latest.target)return Be.error("Long-term goal is required for Month ".concat(ue+1),{autoClose:2e3}),!1;if(ye.latest.goals.length===0)return Be.error("At least one short-term goal is required for Month ".concat(ue+1),{autoClose:2e3}),!1;if(ye.latest.goals.some(Y=>!Y.trim()))return Be.error("All short-term goals must be filled for Month ".concat(ue+1),{autoClose:2e3}),!1}return!0},ae=(ue,ye)=>{f&&ue!==b||o(Y=>{const ce=[...Y.monthlyGoals];return ce[ue].latest.goals=ce[ue].latest.goals.filter((re,ke)=>ke!==ye),{...Y,monthlyGoals:ce}})},we=ue=>{E(ue.target.value)},Ce=async()=>{try{await Le.put("/api/doctors/IEPfeedback/".concat(sessionStorage.getItem("childId")),{iepId:O,month:I.month,doctorFeedback:$},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),Be.success("Feedback submitted successfully!",{autoClose:2e3}),C(!1);const ue=await Le.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(ue.data)}catch(ue){Be.error("Error submitting feedback",{autoClose:2e3}),console.error("Error submitting feedback:",ue)}},ve=()=>a.monthlyGoals.map((ue,ye)=>{const Y=ue.latest;return r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[r.jsxs("h5",{className:"text-lg font-semibold mb-3",children:[Y.month," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("h6",{className:"text-[#ab1c1c] font-medium mb-2",children:["Long-Term Goal ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("div",{className:"mb-3",children:r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Long-Term Goal",value:Y.target,onChange:ce=>X(ce,ye,null,"target"),required:!f})}),r.jsxs("h6",{className:"text-[#ab1c1c] font-medium mb-2",children:["Short-Term Goals ",r.jsx("span",{className:"text-red-500",children:"*"})]}),Y.goals.map((ce,re)=>r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Short-Term Goal ".concat(re+1),value:ce,onChange:ke=>X(ke,ye,re,"goals"),required:!f}),r.jsx("button",{type:"button",className:"ml-2 p-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818]",onClick:()=>ae(ye,re),children:""})]},re)),r.jsx("button",{type:"button",className:"w-full p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",onClick:()=>J(ye),children:"Add Goal"})]},ye)});return F.useEffect(()=>{var ue;if((ue=I==null?void 0:I.childVideo)!=null&&ue.videoUrl)return(async()=>{try{const Y=encodeURIComponent(I.childVideo.videoUrl),ce=await Le.get("/api/doctors/getIEPVideo/".concat(Y),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),re=new Blob([ce.data],{type:ce.headers["content-type"]}),ke=URL.createObjectURL(re);U(ke)}catch(Y){console.error("Error fetching video:",Y),U(null)}})(),()=>{A&&URL.revokeObjectURL(A)}},[(pe=I==null?void 0:I.childVideo)==null?void 0:pe.videoUrl]),r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-16 md:mt-16 lg:mt-20 xl:mt-20 2xl:mt-28",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:["Individual Education Plan (IEP) ",">"," ",sessionStorage.getItem("childName")," "]}),r.jsx("div",{className:"flex space-x-4",children:r.jsx("button",{className:"bg-purple-700 hover:bg-purple-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>q(null),children:"Assign IEP"})})]}),i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):s.length===0?r.jsx("h3",{className:"text-center text-gray-600",children:"No IEPs assigned"}):r.jsx("div",{className:"overflow-x-auto rounded-lg border-2 border-red-800  shadow-md",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"S.No"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 1"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 2"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 3"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:s.sort((ue,ye)=>new Date(ye.createdAt)-new Date(ue.createdAt)).map((ue,ye)=>r.jsxs("tr",{className:"border-b border-red-200 hover:bg-red-50",children:[r.jsx("td",{className:"p-4 text-gray-700",children:ye+1}),r.jsx("td",{className:"p-4 text-gray-700",children:ue.therapy}),ue.selectedMonthsNames.map((Y,ce)=>r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col space-y-2",children:[r.jsx("span",{className:"text-[#ab1c1c] font-semibold",children:Y}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>q(ue,ce),children:"Edit"}),r.jsx("button",{className:"bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>Z(ue,ce),children:"View Performance"})]})]})},ce)),r.jsx("td",{className:"p-4",children:r.jsx("button",{className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>$u(ue),children:"IEP Report"})})]},ye))})]})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsx("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:f?"Edit IEP Progress":"Assign New IEP"}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:B,children:""})]}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:K,children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Therapy Type ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"therapy",value:a.therapy,onChange:X,placeholder:"Enter therapy type",required:!f})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Therapist Name"}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-gray-200 cursor-not-allowed",name:"therapistName",value:p,disabled:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"year",value:a.startingYear,onChange:X,disabled:f,required:!f,children:[r.jsx("option",{value:"",children:"Select year"}),r.jsx("option",{value:v,children:v}),r.jsx("option",{value:v+1,children:v+1})]})]}),!f&&r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Select Starting Month ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"startingMonth",value:a.startingMonth,onChange:ue=>X(ue,null,null,"startingMonth"),children:[r.jsx("option",{value:"",children:"Select month"}),[...Array(12).keys()].map(ue=>{const ye=ue+1,Y=a.startingYear===v.toString()&&ye<w;return r.jsx("option",{value:ye,disabled:Y,children:new Date(0,ue).toLocaleString("default",{month:"long"})},ue)})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Long-Term and Short-Term Goals ",r.jsx("span",{className:"text-red-500",children:"*"})]}),ve()]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Feedback"}),r.jsx("textarea",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"feedback",value:a.feedback,onChange:X,placeholder:"Feedback for the month"})]}),_?r.jsx("div",{className:"flex justify-center items-center",children:r.jsx(Vs,{})}):r.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",children:u})]})})]})}),N&&I&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Performance for ",I.month]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:()=>C(!1),children:""})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl mb-2",children:"Long-Term Goal"}),r.jsx("p",{className:"text-gray-700",children:I.target})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl mb-2",children:"Short-Term Goals and Performances"}),I.goals&&I.performance&&I.goals.length>0?r.jsx("div",{className:"space-y-2",children:I.goals.map((ue,ye)=>r.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[r.jsxs("p",{className:"text-gray-700 text-lg",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-medium",children:[ye+1,"."," "]})," ",ue]}),r.jsxs("p",{className:"text-gray-600 mt-2",children:["Performance:"," ",I.performance[ye]?r.jsxs("span",{className:"bg-purple-500 text-white px-2 py-1 rounded-full",children:[I.performance[ye],"%"]}):r.jsx("span",{className:"text-gray-500",children:"Performance not given"})]})]},ye))}):r.jsx("p",{className:"text-gray-500 italic",children:"No goals or performance data available."})]}),((xe=I==null?void 0:I.childVideo)==null?void 0:xe.videoUrl)&&r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[r.jsx("h6",{className:"text-blue-600 font-medium text-xl mb-3",children:"Session Video"}),r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex flex-col space-y-4",children:[A?r.jsx("video",{controls:!0,className:"w-full h-auto rounded-lg border border-gray-300",src:A,onError:ue=>{console.error("Video playback error:",ue.target.error),URL.revokeObjectURL(A),U(null)},children:"Your browser does not support the video tag."}):r.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading video..."}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Uploaded on: "}),new Date(I.childVideo.videoUploadDate).toLocaleDateString()]}),I.childVideo.videoDescription&&r.jsxs("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Description: "}),I.childVideo.videoDescription]})]})]})})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Therapist Feedback"}),r.jsx("p",{className:"text-gray-700",children:I.therapistFeedback||"No feedback available"})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Feedback"}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:$,onChange:we,placeholder:"Enter feedback based on the child performance",required:!0})]})]}),r.jsxs("div",{className:"p-6 border-t border-red-200",children:[r.jsx("button",{type:"button",className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:Ce,children:"Submit Feedback"}),r.jsx("button",{type:"button",className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ml-2",onClick:()=>C(!1),children:"Close"})]})]})})]})]})}function JF(){const e=new URLSearchParams(Bo().search).get("childId");xs();const[t,n]=F.useState([]),[a,o]=F.useState(!1),[i,c]=F.useState(null),[u,h]=F.useState(!1),[p,f]=F.useState([]),[g,b]=F.useState(""),[y,v]=F.useState(""),[w,N]=F.useState(""),[C,I]=F.useState(""),[T,$]=F.useState(null),[E,_]=F.useState(null),[L,O]=F.useState(""),[z,A]=F.useState(!1),[U,X]=F.useState(null),[Z,q]=F.useState(null),[B,K]=F.useState(!1);F.useEffect(()=>{(async()=>{h(!0);try{const ue=await Le.get("/api/doctors/childIEP/".concat(e),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});n(ue.data)}catch(ue){console.error("Error fetching data:",ue)}finally{h(!1)}})()},[e]);const J=async(xe,ue,ye,Y)=>{const ce=xe.latest;if(c({...ce,responseIndex:ue,monthIndex:ye}),b(ce.month),f(ce.performance&&ce.performance.length?[...ce.performance]:ce.goals.map(()=>"")),N(ce.therapistFeedback||""),v(ce.doctorFeedback||""),I(Y),o(!0),$(null),_(null),O(""),X(null),q(null),K(!1),ce.childVideo&&ce.childVideo.videoUrl){K(!0),X(ce.childVideo.videoUrl);try{const re=encodeURIComponent(ce.childVideo.videoUrl),ke=await Le.get("/api/doctors/getIEPVideo/".concat(re),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),Me=new Blob([ke.data],{type:ke.headers["content-type"]}),Ue=URL.createObjectURL(Me);q(Ue)}catch(re){console.error("Error fetching video:",re),Be.error("Error fetching video",{autoClose:2e3})}finally{K(!1)}}},Q=xe=>{const ue=xe.target.files[0];if(!ue)return;if(!ue.type.startsWith("video/")){Be.warning("Please upload a video file");return}if(ue.size>50*1024*1024){Be.warning("Video size should be less than 50MB");return}X(null),q(null);const ye=document.createElement("video");ye.preload="metadata",ye.onloadedmetadata=()=>{const Y=document.createElement("canvas");Y.width=ye.videoWidth,Y.height=ye.videoHeight,Y.getContext("2d").drawImage(ye,0,0,Y.width,Y.height),_({url:URL.createObjectURL(ue),thumbnail:Y.toDataURL("image/jpeg"),name:ue.name,type:ue.type,size:ue.size}),$(ue)},ye.src=URL.createObjectURL(ue)},ae=()=>{E&&URL.revokeObjectURL(E.url),$(null),_(null),O("")},we=async()=>{try{let xe=null;const ue=new FormData;ue.append("video",T),ue.append("videoDescription",L),ue.append("month",g),ue.append("iepId",C),ue.append("videoUploadDate",new Date().toISOString()),ue.append("therapistFeedback",w),ue.append("performance",JSON.stringify(p)),await Le.put("/api/therapists/updateIEPperformance/".concat(e),ue,{headers:{Authorization:"".concat(sessionStorage.getItem("token")),"Content-Type":"multipart/form-data"}}),n(ye=>{const Y=[...ye],{responseIndex:ce,monthIndex:re}=i;return Y[ce].monthlyGoals[re].latest.performance=[...p],Y[ce].monthlyGoals[re].latest.therapistFeedback=w,Y}),Be.success("All data saved successfully!"),ve()}catch(xe){console.error("Error saving data:",xe),Be.error("Error saving data. Please try again.")}},Ce=xe=>{if(xe===0)return"0 Bytes";const ue=1024,ye=["Bytes","KB","MB","GB"],Y=Math.floor(Math.log(xe)/Math.log(ue));return parseFloat((xe/Math.pow(ue,Y)).toFixed(2))+" "+ye[Y]},ve=()=>{o(!1),c(null),f([]),E&&URL.revokeObjectURL(E.url),$(null),_(null),O("")},pe=(xe,ue)=>{f(ye=>{const Y=[...ye];return Y[xe]=ue,Y})};return r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-16 md:mt-20 lg:mt-24 xl:mt-28",children:[r.jsx("div",{className:"flex justify-between items-center mb-8",children:r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:["Individual Education Plan (IEP) ",">"," ",sessionStorage.getItem("childName")]})}),u?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):t.length===0?r.jsx("h3",{className:"text-center text-gray-600",children:"No IEPs assigned"}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"S.No"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 1"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 2"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 3"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:t.sort((xe,ue)=>new Date(ue.createdAt)-new Date(xe.createdAt)).map((xe,ue)=>r.jsxs("tr",{className:"border-b border-red-200 hover:bg-red-50",children:[r.jsx("td",{className:"p-4 text-gray-700 font-bold",children:ue+1}),r.jsx("td",{className:"p-4 text-gray-700 font-bold",children:xe.therapy}),xe.monthlyGoals.map((ye,Y)=>r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col space-y-2",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-semibold text-lg",children:[ye.latest.month," "]}),r.jsx("div",{className:"flex space-x-2",children:r.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>J(ye,ue,Y,xe._id),children:"View/Update"})})]})},Y)),r.jsx("td",{className:"p-4",children:r.jsx("button",{className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2  px-4 rounded-lg shadow-md transition duration-300",onClick:()=>$u(xe),children:"IEP Report"})})]},ue))})]})}),a&&i&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Edit Performance - ",i.month]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:ve,children:""})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Long-Term Goal"}),r.jsx("p",{className:"text-gray-700 text-lg",children:i.target})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Short-Term Goals"}),i.goals.map((xe,ue)=>r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-gray-700 mb-2 mt-2 text-lg",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-medium",children:[ue+1,"."," "]}),xe]}),r.jsx("input",{type:"number",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:p[ue]||"",onChange:ye=>pe(ue,ye.target.value),placeholder:"Enter performance (0-100 %)",min:"0",max:"100",onWheel:ye=>{ye.target.blur()}})]},ue))]}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx("div",{className:"flex justify-between items-center mb-4",children:r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl",children:"Session Video"})}),U?r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"flex-shrink-0 relative w-full max-w-md mx-auto",children:B?r.jsx("div",{className:"flex justify-center items-center h-32",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[#ab1c1c]"})}):r.jsxs("video",{controls:!0,className:"w-full h-auto rounded object-cover border",children:[r.jsx("source",{src:Z,type:"video/mp4"}),"Your browser does not support the video tag."]})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[r.jsxs("p",{className:"text-sm  text-gray-900",children:[r.jsx("span",{className:"font-semibold",children:"Uploaded on: "}),new Date(i.childVideo.videoUploadDate).toLocaleDateString()]}),r.jsx("div",{className:"text-sm text-gray-900",children:r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Video Description: "}),i.childVideo.videoDescription||"No description provided"]})})]})]})}),r.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-yellow-700",children:"Uploading a new video will replace the existing one."})})]})}),r.jsx("div",{className:"flex items-center justify-center w-full",children:r.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[r.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:r.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),r.jsx("p",{className:"mb-2 text-sm text-gray-500",children:r.jsx("span",{className:"font-semibold",children:"Click to upload new video"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"MP4, MOV, AVI (MAX. 50MB)"})]}),r.jsx("input",{id:"video-upload",type:"file",className:"hidden",accept:"video/*",onChange:Q})]})})]}):E?r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsxs("div",{className:"flex-shrink-0 relative",children:[r.jsx("img",{src:E.thumbnail,alt:"Video thumbnail",className:"h-20 w-32 rounded object-cover border"}),r.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-70 text-white text-xs px-1 rounded",children:Ce(E.size)})]}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:E.name}),r.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-lg text-sm",value:L,onChange:xe=>O(xe.target.value),placeholder:"Enter video description"})]}),r.jsx("button",{onClick:ae,className:"text-red-500 hover:text-red-700 p-1",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})}):r.jsx("div",{className:"flex items-center justify-center w-full",children:r.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[r.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:r.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),r.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[r.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"MP4, MOV, AVI (MAX. 50MB)"})]}),r.jsx("input",{id:"video-upload",type:"file",className:"hidden",accept:"video/*",onChange:Q})]})})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Therapist Feedback"}),r.jsx("textarea",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:w,onChange:xe=>N(xe.target.value),placeholder:"Enter feedback based on the child performance",rows:"3"})]}),y&&r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Doctor's Feedback"}),r.jsx("p",{className:"text-gray-700 text-lg",children:y})]}),r.jsxs("div",{className:"p-6 border-t border-red-200",children:[r.jsx("button",{type:"button",className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:we,disabled:z,children:z?"Saving...":"Save Changes"}),r.jsx("button",{type:"button",className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ml-2",onClick:ve,disabled:z,children:"Cancel"})]})]})]})})]})]})}function e8(){const[s,e]=F.useState([]);return F.useEffect(()=>{Le.get("api/therapists/codeofconduct").then(t=>e(t.data)).catch(t=>console.error("Error fetching data:",t))},[]),r.jsxs("div",{className:"container mx-auto mt-20 px-4",children:[r.jsx("div",{className:"flex justify-center items-center mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] text-center",children:"Therapist Code of Conduct"})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-4xl mx-auto border-t-4 border-[#ab1c1c]",children:[r.jsx("p",{className:"text-lg text-gray-700 mb-6 text-center",children:"Our commitment to ethical practice and professional excellence."}),r.jsx("div",{className:"space-y-6",children:s.length>0?s.map(t=>r.jsxs("div",{className:"flex items-start p-3 bg-red-50 rounded-md border-l-4 border-[#ab1c1c] transition duration-150 ease-in-out hover:shadow-md",children:[r.jsx("svg",{className:"w-5 h-5 text-[#ab1c1c] mt-1 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("circle",{cx:"10",cy:"10",r:"4"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold text-[#ab1c1c] mb-1",children:t.title}),r.jsx("p",{className:"text-gray-600 text-base",children:t.description})]})]},t._id)):r.jsx("p",{className:"text-center text-gray-500",children:"No code of conduct available at this time."})}),r.jsx("div",{className:"mt-8 pt-4 border-t border-red-200 text-center",children:r.jsx("p",{className:"text-sm text-gray-500 italic",children:"Questions regarding this Code of Conduct should be directed to the Ethics Review Board."})})]})]})}const t8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null);F.useEffect(()=>{(async()=>{const u=sessionStorage.getItem("doctorId");if(!u){o("Doctor ID not found"),n(!1);return}try{const h=await Le.get("/api/doctors/getAppointments/".concat(u),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(h.data),n(!1)}catch(h){o("Failed to fetch appointments"),n(!1),console.error(h)}})()},[]);const i=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return t?r.jsx("div",{className:"flex justify-center items-center min-h-screen",children:r.jsx(Vs,{})}):a?r.jsx("div",{className:"text-center text-red-600",children:a}):r.jsx("div",{className:" p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] text-center mb-8",children:"Completed Appointments"}),s.length===0?r.jsx("div",{className:"text-center text-gray-600",children:"No completed appointments found."}):r.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:r.jsxs("table",{className:"min-w-full leading-normal",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#ab1c1c] text-white",children:[r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Consultation Type"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Centre"})]})}),r.jsx("tbody",{children:s.map(c=>{var u,h;return r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:i(c.appointmentDate)})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:c.appointmentTime})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:c.consultationType})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:((u=c.childId)==null?void 0:u.name)||"N/A"})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:((h=c.centreId)==null?void 0:h.name)||"N/A"})})]},c._id)})})]})})]})})};function s8(){const[s,e]=F.useState([]),[t,n]=F.useState(!1),a=xs();F.useEffect(()=>{(async()=>{try{n(!0);const u=await Le.get("/api/parents/children",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(u.data),n(!1)}catch(u){n(!1),console.log("Error fetching children:",u)}})()},[]);const o=c=>{localStorage.setItem("centreId",c.centreId),a("/parentdashboard/child/".concat(c._id))},i=c=>{const u=new Date(c),h=new Date;let p=h.getFullYear()-u.getFullYear();const f=h.getMonth()-u.getMonth();return(f<0||f===0&&h.getDate()<u.getDate())&&p--,p};return r.jsxs("div",{className:"container mx-auto px-4 py-6 min-h-screen bg-gray-50",children:[r.jsx("h1",{className:"text-center text-3xl font-bold text-[#ab1c1c] mt-6 mb-6",children:"Parent Dashboard"}),r.jsx("div",{className:"mt-4",children:r.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t&&r.jsx(Vs,{}),!t&&s.length===0&&r.jsx("div",{className:"col-span-full flex justify-center",children:r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Child Registration Required"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Please schedule an appointment to complete your child's registration process."}),r.jsx("button",{onClick:()=>a("/parentdashboard/bookappointment"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Book Appointment"})]})}),!t&&s.map((c,u)=>r.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 m-2 cursor-pointer hover:shadow-lg transition duration-200 border border-gray-200",onClick:()=>o(c),children:[r.jsx("h3",{className:"text-lg font-bold text-[#ab1c1c]",children:c.name}),r.jsxs("p",{className:"text-gray-600",children:[r.jsx("strong",{children:"Age:"})," ",i(c.dob)," years"]}),r.jsxs("p",{className:"text-gray-600",children:[r.jsx("strong",{children:"School:"})," ",c.schoolName||"Not specified"]}),r.jsx("div",{className:"mt-2 text-right",children:r.jsx("span",{className:"text-xs font-bold text-[#ab1c1c]",children:"Click for details"})})]},u))]})})]})}const nm=({title:s,children:e})=>r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b pb-1",children:s}),e]}),Hs=({label:s,required:e,children:t})=>r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s,e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),t]}),n8=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]},a8=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,r8=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+14),e.toISOString().split("T")[0]};function o8(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState([]),o=Bo(),i=F.useMemo(()=>new URLSearchParams(o.search),[o.search]),[c,u]=F.useState(!1),[h,p]=F.useState({childId:"",childName:"",childAge:"",parentName:"",parentId:null,dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),[f,g]=F.useState([]),[b,y]=F.useState([]),[v,w]=F.useState([]),[N,C]=F.useState(null),[I,T]=F.useState(null),[$,E]=F.useState(!1),[_,L]=F.useState("morning"),[O,z]=F.useState(""),[A,U]=F.useState(""),[X,Z]=F.useState(!1),[q,B]=F.useState(""),K=(Y,ce)=>{p(re=>({...re,[Y]:ce}))},J=Y=>{if(!Y)return"";const ce=new Date(Y),re=new Date;let ke=re.getFullYear()-ce.getFullYear();return(re.getMonth()<ce.getMonth()||re.getMonth()===ce.getMonth()&&re.getDate()<ce.getDate())&&ke--,ke.toString()},Q=async()=>{try{const Y=await Le.get("/api/data/alldoctors",{headers:{Authorization:sessionStorage.getItem("token")}});g(Y.data)}catch(Y){Be.error("Error fetching doctors"),console.error("Error fetching doctors:",Y)}},ae=()=>{const Y=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&Y)try{const re=Nr(Y).user._id;K("parentId",re)}catch(ce){console.error("Error decoding token:",ce),K("parentId",null)}else K("parentId",null)},we=async()=>{const Y=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&Y)try{const re=await Le.get("/api/parents/children",{headers:{Authorization:Y}});re.data&&Array.isArray(re.data)&&t(re.data)}catch(re){console.error("Error fetching children:",re),Be.error("Could not retrieve your children's information")}};F.useEffect(()=>{if(I&&sessionStorage.getItem("role")==="parent"){const Y=()=>{const re=sessionStorage.getItem("token");if(re)try{return Nr(re).user._id}catch(ke){return console.error("Error decoding token:",ke),null}return null},ce=I._id||Y();p(re=>({...re,parentId:ce,parentName:I.name||"",parentPhoneNo:I.mobilenumber||"",address:I.address||"",alternativeNumber:I.mobilenumber||""})),Be.success("Your details have been automatically filled")}},[I]),F.useEffect(()=>{const Y=async()=>{const ke=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&ke){E(!0);try{const He=Nr(ke).user._id,We=await Le.get("/api/data/allUsers/".concat(He),{headers:{Authorization:ke}});We.data&&T(We.data),await we()}catch(Ue){console.error("Error fetching parent details:",Ue)}finally{E(!1)}}};Q(),Y(),ae();const ce=new Date;ce.setDate(ce.getDate()+1);const re=ce.toISOString().split("T")[0];K("appointmentDate",re)},[]);const Ce=Y=>{if(Y==="new"){p(re=>({...re,childId:"new",childName:"",childAge:"",dob:"",gender:"",schoolName:"",classGrade:"",schoolBoard:""}));const ce=new URL(window.location);ce.searchParams.set("childId","new"),window.history.pushState({},"",ce)}else{const ce=e.find(re=>re._id===Y);if(ce){p(ke=>({...ke,childId:Y,childName:ce.name||"",childAge:J(ce.dob),dob:ce.dob?new Date(ce.dob).toISOString().split("T")[0]:"",gender:ce.gender||"",schoolName:ce.schoolName||"",classGrade:ce.classGrade||"",schoolBoard:ce.schoolBoard||""}));const re=new URL(window.location);re.searchParams.set("childId",Y),window.history.pushState({},"",re)}}};F.useEffect(()=>{if(h.doctorId&&h.doctorId.trim()!==""){const Y=f.find(ce=>ce._id===h.doctorId);Y&&Y.centreIds?a(Y.centreIds):a([])}else a([])},[h.doctorId,f]),F.useEffect(()=>{(async()=>{if(h.doctorId&&h.appointmentDate&&h.consultationType&&h.branch)try{const ce=await Le.get("/api/admins/getAvailableSlots/".concat(h.branch,"/").concat(h.doctorId,"/").concat(h.appointmentDate,"/").concat(h.consultationType),{headers:{Authorization:sessionStorage.getItem("token")}}),re=ce.data.availableSlots||[];if(ce.data.isHoliday){Z(!0),B(ce.data.holidayName),U(""),y([]),w([]);return}if(ce.data.message){Z(!1),B(""),U(ce.data.message),y([]),w([]);return}Z(!1),B("");const ke=re.map(Me=>{const Ue=parseInt(Me.split(":")[0]),He=Me.includes("AM")&&Ue<12?"morning":"afternoon";return{time:Me,period:He}});y(ke),w([]),U("")}catch(ce){Be.error("Error fetching slots"),console.error("Error fetching slots:",ce),U(""),y([{time:"10:30 AM",period:"morning"},{time:"11:30 AM",period:"morning"},{time:"12:30 PM",period:"afternoon"},{time:"2:00 PM",period:"afternoon"},{time:"3:00 PM",period:"afternoon"},{time:"3:30 PM",period:"afternoon"},{time:"4:30 PM",period:"afternoon"},{time:"5:30 PM",period:"afternoon"}])}else y([]),w([]),U("")})()},[h.doctorId,h.appointmentDate,h.consultationType,h.branch]),F.useEffect(()=>{const Y=i.get("childId");if(Y&&e.length>0){const ce=e.find(re=>re._id===Y);ce&&p(re=>({...re,childId:Y,childName:ce.name||"",childAge:J(ce.dob),dob:ce.dob?new Date(ce.dob).toISOString().split("T")[0]:"",gender:ce.gender||"",schoolName:ce.schoolName||"",classGrade:ce.classGrade||"",schoolBoard:ce.schoolBoard||""}))}},[e,i]),F.useEffect(()=>{(async()=>{if(h.appointmentDate&&h.parentId)try{const ce=await Le.get("/api/parents/getappointments/".concat(h.parentId),{headers:{Authorization:sessionStorage.getItem("token")}}),re=new Date(h.appointmentDate),ke=ce.data.appointments.find(Me=>new Date(Me.appointmentDate).toDateString()===re.toDateString()&&(Me.status==="pending"||Me.status==="approved"));z(ke?"You already have an appointment scheduled for ".concat(ke.childId.name," on this date. Only one appointment per day is allowed."):"")}catch(ce){console.error("Error checking appointment conflicts:",ce),z("")}else z("")})()},[h.appointmentDate,h.parentId]);const ve=async Y=>{var ce;Y.preventDefault(),u(!0),ae();try{const re=new FormData;Object.entries(h).forEach(([ke,Me])=>{ke!=="childId"&&re.append(ke,Me)}),N&&re.append("pdf",N),re.append("centreId",h.branch),await Le.post("/api/admins/bookAppointment",re,{headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"multipart/form-data"}}),Be.success("Appointment booked successfully!"),u(!1),setTimeout(()=>s(-1),1500)}catch(re){const ke=((ce=re.response)==null?void 0:ce.data)||"Failed to book appointment. Please try again.";Be.error(ke),console.error("Error booking appointment:",re),u(!1)}},pe=Y=>{v.includes(Y)||K("time",Y)},xe=Y=>{if(h.appointmentDate===new Date().toISOString().split("T")[0]){const[ce,re]=Y.replace(/(AM|PM)/,"").trim().split(":"),Me=Y.includes("PM")&&ce!=="12"?parseInt(ce)+12:parseInt(ce),Ue=parseInt(re),He=new Date;return He.setHours(Me,Ue,0),He<=new Date}return!1},ue=()=>b.filter(Y=>Y.period===_).filter(Y=>!v.includes(Y.time)).filter(Y=>!xe(Y.time)).map(Y=>Y.time),ye=()=>["childName","childAge","parentName","parentPhoneNo","appointmentDate","time","doctorId"].every(ke=>h[ke])&&!O;return r.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4",children:[r.jsx(ao,{}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"w-full md:w-4/5 lg:w-2/3",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden border border-gray-200",children:[r.jsx("div",{className:"bg-[#ab1c1c] border-b py-4 text-center",children:r.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Book Appointment"})}),sessionStorage.getItem("role")==="parent"&&$&&r.jsx("div",{className:"bg-red-50 px-6 py-3 flex justify-center items-center",children:r.jsx("div",{className:"flex items-center",children:r.jsx("p",{className:"text-[#ab1c1c] ml-2",children:"Loading your details..."})})}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:ve,children:[r.jsx(nm,{title:"Child Information"}),sessionStorage.getItem("role")==="parent"&&e.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a Child"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onChange:Y=>Ce(Y.target.value),value:h.childId||"",children:[r.jsx("option",{value:"",children:"-- Select a Child --"}),e.map(Y=>r.jsx("option",{value:Y._id,children:Y.name||"Unnamed Child"},Y._id)),r.jsx("option",{value:"new",children:"+ Add a New Child"})]}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select an existing child or enter details for a new child below"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(Hs,{label:"Child Name",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.childName,onChange:Y=>K("childName",Y.target.value),required:!0})}),r.jsx(Hs,{label:"Child Age",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-gray-50",value:h.childAge,readOnly:!0,disabled:!0,tabIndex:"-1",placeholder:"Age will be calculated from Date of Birth"})}),r.jsx(Hs,{label:"Date of Birth",required:!0,children:r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.dob,onChange:Y=>{const ce=Y.target.value;if(K("dob",ce),ce){const re=J(ce);K("childAge",re)}else K("childAge","")},max:new Date().toISOString().split("T")[0],required:!0})}),r.jsx(Hs,{label:"Gender",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.gender,onChange:Y=>K("gender",Y.target.value),required:!0,children:[r.jsx("option",{value:"",children:"-- Select Gender --"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Other"})]})}),r.jsx(nm,{title:"Parent Information"}),r.jsx(Hs,{label:"Parent Name",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.parentName,onChange:Y=>K("parentName",Y.target.value),required:!0})}),r.jsx(Hs,{label:"Parent Phone Number",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.parentPhoneNo,onChange:Y=>K("parentPhoneNo",Y.target.value),required:!0})}),r.jsx(Hs,{label:"Alternate Number",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.alternativeNumber,onChange:Y=>K("alternativeNumber",Y.target.value)})}),r.jsx(Hs,{label:"Concerns",required:!0,children:r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",rows:"3",value:h.childConcerns,onChange:Y=>K("childConcerns",Y.target.value),required:!0})}),r.jsx(Hs,{label:"Address",children:r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",rows:"3",value:h.address,onChange:Y=>K("address",Y.target.value)})}),r.jsx(nm,{title:"School Information"}),r.jsx(Hs,{label:"School Name",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.schoolName,onChange:Y=>K("schoolName",Y.target.value)})}),r.jsx(Hs,{label:"Class/Grade",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.classGrade,onChange:Y=>K("classGrade",Y.target.value)})}),r.jsx(Hs,{label:"School Board",children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.schoolBoard,onChange:Y=>K("schoolBoard",Y.target.value),children:[r.jsx("option",{value:"",children:"Select School Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Camebridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})}),r.jsx(Hs,{label:"Referred By",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.referredBy,onChange:Y=>K("referredBy",Y.target.value)})}),r.jsx(nm,{title:"Appointment Details"}),r.jsx(Hs,{label:"Appointment Date",required:!0,children:r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.appointmentDate,onChange:Y=>{const ce=Y.target.value;if(a8(ce)){alert("Appointments cannot be scheduled on Sundays. Please select another date.");return}K("appointmentDate",ce),K("time","")},min:n8(),max:r8(),required:!0})}),O&&r.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),r.jsx("span",{className:"font-medium",children:"Warning:"})]}),r.jsx("p",{className:"mt-1 text-sm",children:O})]}),r.jsx(Hs,{label:"Select Doctor",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.doctorId,onChange:Y=>{K("doctorId",Y.target.value),K("branch",""),K("time","")},required:!0,children:[r.jsx("option",{value:"",children:"-- Select a Doctor --"}),f.map(Y=>r.jsx("option",{value:Y._id,children:Y.name},Y._id))]})}),r.jsx(Hs,{label:"Select Branch",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.branch,onChange:Y=>{K("branch",Y.target.value),K("time","")},required:!0,disabled:!h.doctorId,children:[r.jsx("option",{value:"",children:"-- Select a Branch --"}),n.map(Y=>r.jsx("option",{value:Y._id,children:Y.name},Y._id))]})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Hs,{label:"Select Consultation type",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.consultationType,onChange:Y=>K("consultationType",Y.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select Consultation Type"}),r.jsx("option",{value:"New Consultation",children:"New Consultation Rs.700/-"}),r.jsx("option",{value:"Assessment(IQ)",children:"Assessment (IQ) Rs.6000/-"}),r.jsx("option",{value:"For IB board Assessment(IQ)",children:"For IB board Assessment (IQ) Rs.12000/-"})]})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Hs,{label:"Select Time Period",children:r.jsxs("div",{className:"flex items-center space-x-4 my-2",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-[#ab1c1c]",name:"timePeriod",value:"morning",checked:_==="morning",onChange:()=>{L("morning"),K("time","")}}),r.jsx("span",{className:"ml-2",children:"Morning (10:30 AM - 11:30 AM)"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-[#ab1c1c]",name:"timePeriod",value:"afternoon",checked:_==="afternoon",onChange:()=>{L("afternoon"),K("time","")}}),r.jsx("span",{className:"ml-2",children:"Afternoon/Evening (12:30 PM - 5:30 PM)"})]})]})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Hs,{label:"Available Time Slots",required:!0,children:r.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:X?r.jsx("div",{className:"w-full p-6 bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-300 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-orange-800 font-bold text-lg mb-2",children:["Holiday - ",q]}),r.jsx("p",{className:"text-orange-700",children:"No appointments can be booked on this holiday. Please select a different date."})]})}):A?r.jsx("div",{className:"w-full p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-6 h-6 text-red-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-red-800 font-medium",children:"Center Not Operational"}),r.jsx("p",{className:"text-red-700 text-sm mt-1",children:"The selected center is not operational on this date. Please choose a different date or contact the center for more information."})]})]})}):ue().length>0?ue().map(Y=>r.jsx("button",{type:"button",className:"px-4 py-2 rounded-md ".concat(h.time===Y?"bg-[#ab1c1c] text-white":"border border-[#ab1c1c] text-[#ab1c1c] hover:bg-red-50"),onClick:()=>pe(Y),children:Y},Y)):r.jsx("p",{className:"text-orange-600 italic",children:!h.doctorId||!h.appointmentDate?"Please select a doctor and date to see available time slots":"No time slots available for the selected period. Please try another date or time period."})})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsxs(Hs,{label:"Upload Previous Reports (Optional)",children:[r.jsx("input",{type:"file",accept:".pdf,.doc,.docx",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onChange:Y=>C(Y.target.files[0])}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload previous medical reports or assessments (PDF, DOC, DOCX)"})]})})]}),r.jsxs("div",{className:"mt-8 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[r.jsx("button",{type:"button",className:"w-full md:w-auto px-6 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onClick:()=>s(-1),children:"Cancel"}),r.jsx("button",{type:"submit",className:"w-full md:w-auto px-6 py-2 rounded-md text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] ".concat(!ye()||c?"opacity-50 cursor-not-allowed":""),disabled:!ye()||c,children:c?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(Vs,{size:5}),r.jsx("span",{className:"ml-2",children:"Booking..."})]}):"Book Appointment"})]})]})})]})})})]})}function i8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(null),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(1),[f]=F.useState(10);return F.useEffect(()=>{(async()=>{try{const[b,y]=await Promise.all([Le.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Le.get("/api/superadmin/children/".concat(s,"/ieps"),{headers:{Authorization:sessionStorage.getItem("token")}})]);a(b.data),t(y.data),i(!1)}catch(b){u("Failed to fetch data"),i(!1)}})()},[s]),o?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):c?r.jsx("div",{className:"text-red-500 text-center py-8",children:c}):r.jsxs("div",{className:"p-6",children:[r.jsxs(nt,{to:"/superadmin/children/".concat(s),className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Child Details"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-2",children:["IEPs for ",n.name]}),r.jsxs("p",{className:"text-gray-600",children:["Total IEPs: ",e.length]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50",children:[r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Starting Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapist"}),r.jsx("th",{className:"px-6 py-3 text-center text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:e.slice((h-1)*f,h*f).map(g=>{var b;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4",children:[g.startingMonth,"/",g.startingYear]}),r.jsx("td",{className:"px-6 py-4",children:g.therapy}),r.jsx("td",{className:"px-6 py-4",children:((b=g.doctorId)==null?void 0:b.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:g.therapistName||"-"}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx("button",{onClick:()=>$u(g),className:"text-[rgb(197,27,28)] hover:text-red-700",children:"View PDF"})})]},g._id)})})]})}),e.length>f&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>p(g=>Math.max(g-1,1)),disabled:h===1,className:"px-4 py-2 rounded ".concat(h===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",h," of ",Math.ceil(e.length/f)]}),r.jsx("button",{onClick:()=>p(g=>Math.min(g+1,Math.ceil(e.length/f))),disabled:h>=Math.ceil(e.length/f),className:"px-4 py-2 rounded ".concat(h>=Math.ceil(e.length/f)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function l8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(null),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(1),[f]=F.useState(10);return F.useEffect(()=>{(async()=>{try{console.log("Fetching appointment data...");const[b,y]=await Promise.all([Le.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Le.get("/api/superadmin/children/".concat(s,"/appointments"),{headers:{Authorization:sessionStorage.getItem("token")}})]);a(b.data),console.log("Appointment response data:",y.data),t(y.data),i(!1)}catch(b){u("Failed to fetch data"),i(!1)}})()},[s]),o?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):c?r.jsx("div",{className:"text-red-500 text-center py-8",children:c}):r.jsxs("div",{className:"p-6",children:[r.jsxs(nt,{to:"/superadmin/children/".concat(s),className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Child Details"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-2",children:["Appointments for ",n.name]}),r.jsxs("p",{className:"text-gray-600",children:["Total Appointments: ",e.length]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50",children:[r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapist"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:e.slice((h-1)*f,h*f).map(g=>{var b,y;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:g.appointmentDate.split("T")[0]||"-"}),r.jsx("td",{className:"px-6 py-4",children:g.appointmentTime||"-"}),r.jsx("td",{className:"px-6 py-4",children:((b=g.doctorId)==null?void 0:b.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((y=g.therapistId)==null?void 0:y.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs ".concat(g.status==="completed"?"bg-green-100 text-green-800":g.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:g.status})}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx("button",{onClick:()=>{var v,w,N;_y({...g,childName:n.name,parentName:(v=n.parentId)==null?void 0:v.name,centreName:(w=n.centreId)==null?void 0:w.name,doctorName:(N=g.doctorId)==null?void 0:N.name,appointmentDate:g.appointmentDate.split("T")[0]||"-",appointmentTime:g.appointmentTime||"-",consultationType:g.type})},className:"text-[rgb(197,27,28)] hover:text-red-700",children:"View PDF"})})]},g._id)})})]})}),e.length>f&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>p(g=>Math.max(g-1,1)),disabled:h===1,className:"px-4 py-2 rounded ".concat(h===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",h," of ",Math.ceil(e.length/f)]}),r.jsx("button",{onClick:()=>p(g=>Math.min(g+1,Math.ceil(e.length/f))),disabled:h>=Math.ceil(e.length/f),className:"px-4 py-2 rounded ".concat(h>=Math.ceil(e.length/f)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}const c8=()=>{const s=xs(),[e,t]=F.useState({parentName:"",mobilenumber:"",password:"",confirmPassword:"",address:"",otp:""}),[n,a]=F.useState(!1),[o,i]=F.useState(!1),[c,u]=F.useState([]),[h,p]=F.useState(!1),[f,g]=F.useState({}),[b,y]=F.useState(!1),[v,w]=F.useState(!1),[N,C]=F.useState(!1),I=()=>{t({parentName:"",mobilenumber:"",password:"",confirmPassword:"",address:"",otp:""}),g({}),y(!1),w(!1),C(!1)};F.useEffect(()=>{(async()=>{p(!0);try{const z=await Le.get("/api/users/allusers");if(z.data.success){const A=z.data.users.map(U=>U.mobilenumber);u(A)}}catch(z){console.error("Error fetching existing data:",z)}finally{p(!1)}})()},[]);const T=O=>{const{name:z,value:A}=O.target;t({...e,[z]:A}),f[z]&&g({...f,[z]:""})},$=()=>{const O={};e.parentName.trim()||(O.parentName="Parent name is required");const z=/^\d{10}$/;return e.mobilenumber.toString().trim()?z.test(e.mobilenumber.toString())?c.includes(e.mobilenumber)&&(O.mobilenumber="This mobile number is already registered"):O.mobilenumber="Please enter a valid 10-digit mobile number":O.mobilenumber="Mobile number is required",e.password?e.password.length<8?O.password="Password must be at least 8 characters":/[A-Z]/.test(e.password)?/[a-z]/.test(e.password)?/[0-9]/.test(e.password)?/[@$]/.test(e.password)||(O.password="Password must contain at least one special character (@ or $)"):O.password="Password must contain at least one number":O.password="Password must contain at least one lowercase letter":O.password="Password must contain at least one uppercase letter":O.password="Password is required",e.confirmPassword?e.password!==e.confirmPassword&&(O.confirmPassword="Passwords do not match"):O.confirmPassword="Please confirm your password",e.address.trim()||(O.address="Address is required"),O},E=async()=>{const O=$();if(g(O),Object.keys(O).length===0){p(!0);try{const z=await Le.post("/api/users/send-otp",{mobileNumber:e.mobilenumber});z.data.success?(Be.success("OTP sent to your mobile number!",{autoClose:2e3}),w(!0)):Be.error(z.data.message,{autoClose:2e3})}catch(z){Be.error("Error sending OTP. Please try again.",{autoClose:2e3})}finally{p(!1)}}else Be.error("Please fill the form correctly.",{autoClose:2e3})},_=async()=>{if(!e.otp.trim()){Be.error("Please enter the OTP.",{autoClose:2e3});return}p(!0);try{const O=await Le.post("/api/users/verify-otp",{mobileNumber:e.mobilenumber,otp:e.otp});O.data.success?(C(!0),Be.success("OTP verified successfully!",{autoClose:2e3}),await L(O.data.token)):Be.error(O.data.message,{autoClose:2e3})}catch(O){Be.error("Error verifying OTP. Please try again.",{autoClose:2e3})}finally{p(!1)}},L=async O=>{try{(await Le.post("/api/users/parentRegister",e,{headers:{Authorization:"".concat(O)}})).data.success?(y(!0),Be.success("Registration Successful! Redirecting to login...",{autoClose:2e3}),setTimeout(()=>s("/login"),5e3)):Be.error("Registration failed. Please try again.",{autoClose:2e3})}catch(z){Be.error("Error during registration. Please try again.",{autoClose:2e3})}};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{}),r.jsx("div",{className:"max-w-3xl mx-auto",children:r.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"bg-[#ab1c1c] px-6 py-8 text-white",children:[r.jsx("h2",{className:"text-3xl font-bold text-center",children:"Create Your Account"}),r.jsx("p",{className:"mt-2 text-center text-red-100",children:"Register to book appointments and access our services"})]}),b?r.jsxs(r.Fragment,{children:[r.jsx(lg,{}),r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"mb-6 mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-[#ab1c1c]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Registration Successful!"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Thank you for registering with us. You can now log in to your account."}),r.jsx(nt,{to:"/login",className:"inline-block bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-medium py-3 px-6 rounded-md transition duration-300",children:"Go to Login"})]})]}):r.jsxs("form",{onSubmit:O=>O.preventDefault(),className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"parentName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Name ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("input",{required:!0,type:"text",id:"parentName",name:"parentName",value:e.parentName,onChange:T,className:"w-full px-4 py-2 border ".concat(f.parentName?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"Enter name"}),f.parentName&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.parentName})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"mobilenumber",className:"block text-sm font-medium text-gray-700 mb-1",children:["Mobile Number"," ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("input",{required:!0,type:"number",id:"mobilenumber",name:"mobilenumber",value:e.mobilenumber,onChange:T,className:"w-full px-4 py-2 border ".concat(f.mobilenumber?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:"10"}),f.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.mobilenumber})]}),r.jsxs("div",{className:"",children:[r.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{required:!0,type:n?"text":"password",id:"password",name:"password",value:e.password,onChange:T,className:"w-full px-4 py-2 border ".concat(f.password?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent pr-10"),placeholder:"Create a secure password"}),r.jsx("button",{type:"button",onClick:()=>a(!n),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),f.password&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.password})]}),r.jsx("div",{className:"bg-red-50 rounded-md p-3 mb-2 border border-red-100",children:r.jsxs("p",{className:"text-xs text-gray-600 flex items-start",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#ab1c1c] mr-1 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Password must be at least 8 characters long, contain at least one uppercase letter, one lowercase letter, one number, and at least one special character (@ or $)."]})}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm Password ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{required:!0,type:o?"text":"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:T,className:"w-full px-4 py-2 border ".concat(f.confirmPassword?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent pr-10"),placeholder:"Confirm your password"}),r.jsx("button",{type:"button",onClick:()=>i(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),f.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.confirmPassword})]})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:["Address ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("textarea",{required:!0,id:"address",name:"address",value:e.address,onChange:T,rows:3,className:"w-full px-4 py-2 border ".concat(f.address?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"Enter your complete address"}),f.address&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.address})]}),v&&r.jsxs("div",{children:[r.jsx("div",{className:"bg-red-50 rounded-md p-3 mb-2 border border-red-100 flex items-center ",children:r.jsxs("p",{className:"text-xs text-gray-600 flex",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#ab1c1c] mr-1 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Please enter OTP  valid for 5 mins."]})}),r.jsx("input",{required:!0,type:"text",id:"otp",name:"otp",value:e.otp,onChange:T,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent",placeholder:"Enter OTP *"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})," Required fields"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{type:"button",onClick:I,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition duration-300",children:"Clear"}),v?r.jsx("button",{type:"button",onClick:_,className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md hover:bg-[#8e1818] transition duration-300 flex items-center",disabled:h||N,children:h?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying OTP..."]}):"Verify OTP and Submit"}):r.jsx("button",{type:"button",onClick:E,className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md hover:bg-[#8e1818] transition duration-300 flex items-center",disabled:h,children:h?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending OTP..."]}):"Send OTP to mobile"})]})]}),r.jsx("div",{className:"text-center mt-6 border-t border-gray-200 pt-4",children:r.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",r.jsx(nt,{to:"/login",className:"text-[#ab1c1c] font-medium hover:text-[#8e1818]",children:"Sign in"})]})})]})]})})]})},u8=(s,e,t)=>{const n=s[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};function d8(){const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState("1"),[i,c]=F.useState(!1);F.useEffect(()=>{(async()=>{c(!0);try{const g=await Le.get("/api/data/allgames",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(g.data),u(g.data,a)}catch(g){console.error("Error fetching icons:",g)}finally{c(!1)}})()},[a]);const u=(f,g)=>{var v;const y=(((v=f.find(w=>w.groupId===g))==null?void 0:v.games)||[]).filter(w=>w.status==="active");Promise.all(y.map(async w=>{const N=await u8(Object.assign({"../assets/icons/AnimalFarm.webp":()=>ha(()=>import("./AnimalFarm-Dd_FYYrw.js"),[]),"../assets/icons/AnimalMatching.webp":()=>ha(()=>import("./AnimalMatching-l3BKKWC_.js"),[]),"../assets/icons/ConnectingLetters.webp":()=>ha(()=>import("./ConnectingLetters-DITF1NAp.js"),[]),"../assets/icons/DragAndMatch.webp":()=>ha(()=>import("./DragAndMatch-BLQrL6CE.js"),[]),"../assets/icons/JoiningShapes.webp":()=>ha(()=>import("./JoiningShapes-DRfGPxs4.js"),[]),"../assets/icons/Memorygame.webp":()=>ha(()=>import("./Memorygame-Cbk3h7nr.js"),[]),"../assets/icons/Search.webp":()=>ha(()=>import("./Search-CR-RX0HI.js"),[]),"../assets/icons/SentenceVerification1.webp":()=>ha(()=>import("./SentenceVerification1-B-AotmmA.js"),[]),"../assets/icons/SentenceVerification2.webp":()=>ha(()=>import("./SentenceVerification2-CVNvNXuQ.js"),[]),"../assets/icons/ShadowMatching.webp":()=>ha(()=>import("./ShadowMatching-DeXzSZWQ.js"),[]),"../assets/icons/Shape-Design.webp":()=>ha(()=>import("./Shape-Design-BqdO_MCz.js"),[]),"../assets/icons/imageMatching.webp":()=>ha(()=>import("./imageMatching-CE0earrI.js"),[]),"../assets/icons/tabledraganddrop.webp":()=>ha(()=>import("./tabledraganddrop-SMFGi8-H.js"),[]),"../assets/icons/windowsequencing.webp":()=>ha(()=>import("./windowsequencing-B9QSss-b.js"),[])}),"../assets/icons/".concat(w.img,".webp"),4);return{...w,url:N.default}})).then(n)};F.useEffect(()=>{s.length>0&&u(s,a)},[a,s]);const h=(f,g)=>{localStorage.setItem("gameId",f),window.open("".concat(g,"?gameId=").concat(f),"_blank")},p=f=>{o(f.target.value)};return r.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-8 md:mt-16 lg:mt-18 xl:mt-20",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("select",{onChange:p,value:a,className:"w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"1",children:"SUCCESSIVE PROCESSING"}),r.jsx("option",{value:"2",children:"SIMULTANEOUS PROCESSING"})]})}),i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(Vs,{})}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.length>0?t.map((f,g)=>r.jsx("div",{className:"bg-white rounded-3xl overflow-hidden shadow-lg hover:shadow-xl transition-shadow duration-300",children:r.jsxs("div",{className:"block cursor-pointer",onClick:()=>h(f.gameId,f.route),children:[r.jsx("div",{className:"p-6",children:r.jsx("img",{src:f.url,alt:f.name,className:"w-full h-48 object-contain"})}),r.jsxs("div",{className:"p-6 bg-blue-500 text-white text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:f.name}),r.jsx("p",{className:"text-sm",children:f.description})]})]})},g)):r.jsx("div",{className:"col-span-full text-center py-10",children:r.jsx("p",{className:"text-gray-500 text-lg",children:"No active games available in this category"})})})]})})}const h8="\r\nhttps://testingtotalapi.joywithlearning.com";function p8(){var q,B,K,J;const s=xs(),{childId:e}=Vo(),t=Bo(),[n,a]=F.useState(null),[o,i]=F.useState([]),[c,u]=F.useState([]),[h,p]=F.useState(""),[f,g]=F.useState(""),[b,y]=F.useState(!0),[v,w]=F.useState(!1),[N,C]=F.useState(!1),[I,T]=F.useState(null);F.useEffect(()=>{t.state&&t.state.childData?(a(t.state.childData),p(t.state.childData.doctorId||""),g(t.state.childData.therapistId||""),y(!1),E()):$()},[e,t.state]);const $=async()=>{try{y(!0);const Q=sessionStorage.getItem("token");if(!Q)throw new Error("Authentication token not found");const ae=await Le.get("/api/data/child/".concat(e),{headers:{Authorization:Q}});a(ae.data),p(ae.data.doctorId||""),g(ae.data.therapistId||""),y(!1),E()}catch(Q){const ae=Q.response?"Error: ".concat(Q.response.status," - ").concat(Q.response.statusText):Q.message;T(ae),y(!1)}},E=async()=>{try{w(!0);const Q=sessionStorage.getItem("token");if(!Q)throw new Error("Authentication token not found");const ae=Nr(Q),we=await Le.get("/api/data/allDoctors/".concat(ae.user.centreId),{headers:{Authorization:Q}}),Ce=await Le.get("/api/data/allTherapists/".concat(ae.user.centreId),{headers:{Authorization:Q}});i(we.data.doctors),u(Ce.data.therapists),w(!1)}catch(Q){const ae=Q.response?"Error: ".concat(Q.response.status," - ").concat(Q.response.statusText):Q.message;T(ae),w(!1)}},_=()=>{if(!(n!=null&&n.doctorId))return"Not Assigned";const Q=o.find(ae=>ae._id===n.doctorId);return Q?Q.name:"Assigned"},L=()=>{if(!(n!=null&&n.therapistId))return"Not Assigned";const Q=c.find(ae=>ae._id===n.therapistId);return Q?Q.name:"Assigned"},O="http://localhost:4001",z=Q=>{window.open("".concat(O).concat(Q),"_blank")},A=()=>{s("/admindashboard/appointment?childId=".concat(n._id))},U=Q=>{const ae=new Date,we=new Date(Q);let Ce=ae.getFullYear()-we.getFullYear();const ve=ae.getMonth()-we.getMonth();return(ve<0||ve===0&&ae.getDate()<we.getDate())&&Ce--,Ce},X=Q=>new Date(Q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Z=({status:Q})=>{const ae=()=>{switch(Q){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return r.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(ae()),children:Q.charAt(0).toUpperCase()+Q.slice(1)})};return b?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-800"})}):I?r.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:[r.jsx("p",{children:I}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})]}):n?r.jsxs("div",{className:"p-4 sm:p-6 mt-16 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Child Details"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 w-full sm:w-auto",onClick:A,children:"Book Appointment"}),r.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",onClick:()=>s("/admindashboard/child/".concat(n._id,"/edit"),{state:{childData:n}}),children:"Edit Details"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Personal Information"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2 flex items-center gap-4 mb-4",children:[r.jsx("img",{src:n.profilePicture?"".concat(h8).concat(n.profilePicture):"https://via.placeholder.com/100?text=No+Image",alt:"Child Profile",className:"w-24 h-24 rounded-full object-cover border-2 border-[#ab1c1c]"}),r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n.name})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Full Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.name})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Date of Birth"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:X(n.dob)})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Age"}),r.jsxs("dd",{className:"text-sm font-medium text-gray-900",children:[U(n.dob)," years"]})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Gender"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.gender})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Registration Date"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:X(n.createdAt)})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Status"}),r.jsx("dd",{children:r.jsx(Z,{status:n.admitStatus})})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Other Info"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"School Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.schoolName||"N/A"})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"School Board"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.schoolBoard||"N/A"})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Case ID"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.caseId||"N/A"})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Registration ID"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.registrationId||"N/A"})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Parent/Guardian Information"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Parent/Guardian Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((q=n.parentId)==null?void 0:q.name)||"Not provided"})]}),r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Contact Number"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((B=n.parentId)==null?void 0:B.mobilenumber)||"Not provided"})]}),r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Email Address"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((K=n.parentId)==null?void 0:K.email)||"Not provided"})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Address"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((J=n.parentId)==null?void 0:J.address)||"Not provided"})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Staff"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Doctor"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:v?"Loading...":_()})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Therapist"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:v?"Loading...":L()})]})]})})]})]}),r.jsxs("div",{className:"mt-6 bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Associated Files"})}),r.jsx("div",{className:"p-4",children:n.reports&&n.reports.length>0?r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Report Type"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Uploaded On"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:n.reports.map(Q=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-800",children:Q.type}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:X(Q.uploadedAt)}),r.jsx("td",{className:"px-4 py-2 text-sm space-x-2",children:r.jsx("button",{onClick:()=>z(Q.filePath),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"View"})})]},Q._id))})]})}):r.jsx("p",{className:"text-sm text-gray-500",children:"No files uploaded for this child."})})]}),r.jsx("div",{className:"mt-8 flex justify-center sm:justify-start",children:r.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 w-full sm:w-auto max-w-xs",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})})]}):r.jsxs("div",{className:"p-4 bg-yellow-100 text-yellow-700 rounded-md",children:[r.jsx("p",{children:"Child data not found."}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})]})}function f8(){var w,N,C,I,T,$;const{childId:s}=Vo(),[e,t]=F.useState(null),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState({}),h=xs();F.useEffect(()=>{s&&(async()=>{try{a(!0);const _=await Le.get("/api/parents/child/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(_.data),u(_.data),localStorage.setItem("centreId",_.data.centreId),a(!1)}catch(_){a(!1),console.log("Error fetching child details:",_)}})()},[s]);const p=E=>{const _=new Date(E),L=new Date;let O=L.getFullYear()-_.getFullYear();const z=L.getMonth()-_.getMonth();return(z<0||z===0&&L.getDate()<_.getDate())&&O--,O},f=E=>{const _={year:"numeric",month:"long",day:"numeric"};return new Date(E).toLocaleDateString(void 0,_)},g=E=>{const{name:_,value:L}=E.target;u(O=>({...O,[_]:L}))},b=()=>{o&&u(e),i(!o)},y=async()=>{try{a(!0),await Le.put("/api/parents/edit-child-details/".concat(s),c,{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),t(c),i(!1),a(!1)}catch(E){a(!1),console.log("Error updating child information:",E),alert("Failed to update information. Please try again.")}},v=["CBSE","SSC","ICSE","Camebridge (IB)","NIOS","Others",""];return n?r.jsx(Vs,{}):e?r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:r.jsxs("div",{className:"container  mx-auto px-4 py-6 bg-gray-50",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[#ab1c1c] ps-6",children:[e.name,"'s Details"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>h("/parentdashboard/iepreports/".concat(s)),className:"bg-blue-500 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"IEP Reports"}),r.jsx("button",{onClick:()=>h("/parentdashboard/reports?childId=".concat(s)),className:"bg-yellow-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"Game Reports"}),r.jsx("button",{onClick:()=>h("/parentdashboard/bookappointment?childId=".concat(s)),className:"bg-purple-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"Book Appointment"}),r.jsx("button",{onClick:b,className:"".concat(o?"bg-red-600 hover:bg-red-700":"bg-slate-600 hover:bg-[#8e1818]"," text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow transition"),children:o?"Cancel":"Edit Information"}),o&&r.jsx("button",{onClick:y,className:"bg-green-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-green-700 transition",children:"Save Changes"})]})]}),r.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 border border-gray-200",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6",children:[r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Personal Information"}),r.jsx("div",{className:"space-y-4",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),r.jsx("input",{type:"text",name:"name",value:c.name||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"dob",value:c.dob?new Date(c.dob).toISOString().split("T")[0]:"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),r.jsxs("select",{name:"gender",value:c.gender||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out appearance-none bg-white",children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",e.name]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Age:"})," ",p(e.dob)," years"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Date of Birth:"})," ",f(e.dob)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Gender:"})," ",e.gender]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Admit Status:"})," ",r.jsx("span",{className:"px-2 py-1 rounded text-xs ".concat(e.admitStatus==="active"?"bg-green-100 text-green-800":e.admitStatus==="inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.admitStatus.charAt(0).toUpperCase()+e.admitStatus.slice(1)})]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Centre name:"})," ",e.centreId.name]})]})})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Education Information"}),r.jsx("div",{className:"space-y-4",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",name:"schoolName",value:c.schoolName||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out",placeholder:"Enter school name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{name:"schoolBoard",value:c.schoolBoard||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out appearance-none bg-white",children:[r.jsx("option",{value:"",children:"Select School Board"}),v.map((E,_)=>E&&r.jsx("option",{value:E,children:E},_))]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Name:"})," ",e.schoolName||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Board:"})," ",e.schoolBoard||"Not specified"]})]})})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Associated Professionals"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Doctor:"})," ",((w=e==null?void 0:e.doctorId)==null?void 0:w.name)||"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Therapist:"})," ",((N=e==null?void 0:e.therapistId)==null?void 0:N.name)||"Not assigned"]})]})]})}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Records"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IEPs:"})," ",((C=e.IEPs)==null?void 0:C.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Prescription Reports:"})," ",((I=e.prescriptionReports)==null?void 0:I.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Appointments:"})," ",((T=e.appointments)==null?void 0:T.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Game Reports:"})," ",(($=e.gameReports)==null?void 0:$.length)||0," records"]})]})]})}),r.jsx("div",{className:"flex justify-center mt-6",children:r.jsx("button",{onClick:()=>h("/parentdashboard"),className:"bg-gray-500 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-gray-600 transition",children:"Back to Dashboard"})})]})]})}):r.jsx("div",{className:"text-center py-10 mt-16",children:"Child not found"})}const Dk=()=>{const[s]=I6(),e=s.get("childId"),[t,n]=F.useState([]);return F.useEffect(()=>{(async()=>{try{const o=await Le.get("/api/data/gameReports/".concat(e));n(o.data)}catch(o){console.error("Error fetching game reports:",o)}})()},[e]),r.jsxs("div",{className:"p-6 ",children:[r.jsx("h1",{className:"text-2xl font-bold text-center text-[#ab1c1c] mb-6",children:"Game Reports"}),t.length===0?r.jsx("div",{className:"text-[#ab1c1c] text-lg",children:"No game reports found"}):r.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md",children:r.jsxs("table",{className:"min-w-full bg-red-100",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-200 text-[#ab1c1c]",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Game"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Tries"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Timer"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Status"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Date Played"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:t.map(a=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:a.name}),r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:a.tries}),r.jsxs("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:[a.timer.toFixed(2)," seconds"]}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium \n        ".concat(a.status==="completed"?"bg-green-200 text-green-800":"bg-red-100 text-red-800"),children:a.status})}),r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:new Date(a.datePlayed).toLocaleDateString("en-GB")})]},a._id))})]})})]})};function Rk(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState(null);F.useEffect(()=>{(async()=>{try{a(!0);const g=await Le.get("/api/parents/iep/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(g.data),a(!1)}catch(g){a(!1),console.log("Error fetching IEP data:",g)}})()},[s]);const h=f=>{u(f),i(!0)},p=()=>c?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Version History for ",c.therapy," IEP"]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-red-500",onClick:()=>i(!1),children:""})]}),r.jsx("div",{className:"p-6",children:c.monthlyGoals.map((f,g)=>{var w;const b=f.history;b.sort((N,C)=>new Date(C.updatedAt)-new Date(N.updatedAt));const y=f.latest,v=b.slice(1);return r.jsxs("div",{className:"mb-8",children:[r.jsxs("h6",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:[f.latest.month," - History"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Current Version"}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",y.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:y.goals.map((N,C)=>r.jsx("li",{children:N},C))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((w=y.performance)==null?void 0:w.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:y.performance.map((N,C)=>r.jsxs("li",{children:[N,"%"]},C))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:y.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:y.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Last Updated:"," ",new Date(y.updatedAt).toLocaleString()]})]})]}),v.length>0?r.jsxs("div",{children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Previous Versions"}),r.jsx("div",{className:"space-y-4",children:v.map((N,C)=>{var I;return r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",N.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:N.goals.map((T,$)=>r.jsx("li",{children:T},$))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((I=N.performance)==null?void 0:I.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:N.performance.map((T,$)=>r.jsxs("li",{children:[T,"%"]},$))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:N.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:N.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Updated:"," ",new Date(N.updatedAt).toLocaleString()]})]},C)})})]}):r.jsx("p",{className:"text-gray-500 italic",children:"No previous versions available"})]},g)})}),r.jsx("div",{className:"p-6 border-t border-red-200",children:r.jsx("button",{type:"button",className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>i(!1),children:"Close"})})]})}):null;return n?r.jsx(Vs,{}):r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-16",children:[r.jsx("h1",{className:"text-2xl font-bold text-center text-[#ab1c1c] mb-6",children:"IEP Reports"}),e.length>0?r.jsx("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6",children:r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Starting Month"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:e.map((f,g)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:f.therapy}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:[f.startingMonth," ",f.startingYear]}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm space-x-2",children:[r.jsx("button",{onClick:()=>$u(f),className:"bg-green-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-green-700 transition",children:"Generate PDF"}),r.jsx("button",{onClick:()=>h(f),className:"bg-purple-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-purple-700 transition",children:"View History"})]})]},g))})]})}):r.jsx("div",{className:"flex items-center justify-center",children:r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No IEP data available"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"IEP has not been assigned to the child yet."})]})}),o&&p()]})}const m8="\r\nhttps://testingtotalapi.joywithlearning.com";function g8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState(null),[h,p]=F.useState([]),[f,g]=F.useState(""),b=xs();F.useEffect(()=>{(async()=>{try{a(!0);const I=await Le.get("/api/admins/iep/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(I.data),a(!1)}catch(I){a(!1),console.log("Error fetching IEP data:",I)}})()},[s]),F.useEffect(()=>{(async()=>{var I;try{const T=await Le.get("/api/admins/child/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}});g(T.data.name||"Child");const $=((I=T.data.reports)==null?void 0:I.filter(E=>E.type==="IEP"))||[];console.log("ieps are : ",$),p($)}catch(T){console.log("Error fetching IEP reports:",T)}})()},[s]);const y=C=>{window.open("".concat(m8).concat(C),"_blank")},v=C=>new Date(C).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),w=C=>{u(C),i(!0)},N=()=>c?r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-4 flex flex-col items-center justify-center",children:[r.jsx("div",{className:"w-full max-w-4xl mb-4 flex justify-start",children:r.jsxs("button",{onClick:()=>b(-1),className:"flex items-center text-[#ab1c1c] hover:text-[#8e1818] transition-colors",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Dashboard"]})}),r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] text-center mb-6",children:"IEP Reports"}),r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Version History for ",c.therapy," IEP"]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-red-500",onClick:()=>i(!1),children:""})]}),r.jsx("div",{className:"p-6",children:c.monthlyGoals.map((C,I)=>{var _;const T=C.history;T.sort((L,O)=>new Date(O.updatedAt)-new Date(L.updatedAt));const $=C.latest,E=T.slice(1);return r.jsxs("div",{className:"mb-8",children:[r.jsxs("h6",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:[C.latest.month," - History"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Current Version"}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",$.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:$.goals.map((L,O)=>r.jsx("li",{children:L},O))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((_=$.performance)==null?void 0:_.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:$.performance.map((L,O)=>r.jsxs("li",{children:[L,"%"]},O))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:$.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:$.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Last Updated:"," ",new Date($.updatedAt).toLocaleString()]})]})]}),E.length>0?r.jsxs("div",{children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Previous Versions"}),r.jsx("div",{className:"space-y-4",children:E.map((L,O)=>{var z;return r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",L.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:L.goals.map((A,U)=>r.jsx("li",{children:A},U))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((z=L.performance)==null?void 0:z.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:L.performance.map((A,U)=>r.jsxs("li",{children:[A,"%"]},U))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:L.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:L.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Updated:"," ",new Date(L.updatedAt).toLocaleString()]})]},O)})})]}):r.jsx("p",{className:"text-gray-500 italic",children:"No previous versions available"})]},I)})}),r.jsx("div",{className:"p-6 border-t border-red-200",children:r.jsx("button",{type:"button",className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>i(!1),children:"Close"})})]})})]}):null;return n?r.jsx(Vs,{}):r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-4 flex flex-col items-center justify-center ",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] text-center mb-6",children:"IEP Reports"}),e.length>0?r.jsx("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 w-full max-w-4xl",children:r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Starting Month"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:e.map((C,I)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:C.therapy}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:[C.startingMonth," ",C.startingYear]}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm space-x-2",children:[r.jsx("button",{onClick:()=>$u(C),className:"bg-green-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-green-700 transition",children:"Generate PDF"}),r.jsx("button",{onClick:()=>w(C),className:"bg-[#ab1c1c] text-white px-3 py-2 text-sm rounded-md shadow hover:bg-[#8e1818] transition",children:"View History"})]})]},I))})]})}):r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center flex flex-col items-center justify-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No IEP data available"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"IEP has not been assigned to the child yet."})]}),o&&N(),r.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 w-full max-w-4xl mt-10",children:[r.jsxs("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:["Past IEP Reports ",f&&" ".concat(f)]}),h.length>0?r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Report Type"}),r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Uploaded On"}),r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Action"})]})}),r.jsx("tbody",{children:h.map(C=>r.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 text-sm",children:C.type}),r.jsx("td",{className:"px-4 py-2 text-sm",children:v(C.uploadedAt)}),r.jsx("td",{className:"px-4 py-2",children:r.jsx("button",{onClick:()=>y(C.filePath),className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",children:"View"})})]},C._id))})]}):r.jsx("p",{className:"text-gray-500 text-sm",children:"No past IEP reports available."})]})]})}const x8=()=>{const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(null),[u,h]=F.useState([]),[p,f]=F.useState(!1),{referenceId:g}=Vo(),b=xs();F.useEffect(()=>((async()=>{try{const N=await Le.get("/api/admins/get-jwl-enquiry/".concat(g),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(N.data);const C=await Le.get("/api/jwl/jwlenquirequestions",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});h(C.data);try{const I=await Le.get("/api/admins/get-jwluser-video/".concat(N.data.parentEmail),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),T=new Blob([I.data],{type:I.headers["content-type"]}),$=URL.createObjectURL(T);c($)}catch(I){console.error("Failed to fetch video",I)}n(!1)}catch(N){o("Failed to fetch data"),n(!1),console.error(N)}})(),()=>{i&&URL.revokeObjectURL(i)}),[g]);const y=w=>{const N=parseInt(w.replace("q",""));return u.find(C=>C.number===N)},v=()=>{f(!p)};return t?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsx(Vs,{})}):a?r.jsx("div",{className:"flex justify-center items-center h-screen text-red-600",children:a}):s?r.jsx("div",{className:"mt-10 mb-16 py-8 px-4 sm:px-6 lg:px-8",children:r.jsx("div",{className:"max-w-6xl mx-auto",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[r.jsx("div",{className:"bg-[#ab1c1c] p-6 text-white",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>b(-1),className:"flex items-center text-sm font-medium text-white hover:text-red-100 transition duration-150",children:[r.jsx("svg",{className:"h-5 w-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Enquiries"]}),r.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Enquiry Details"}),r.jsxs("p",{className:"text-red-100 mt-1",children:["Reference ID: ",s.referenceId]})]}),r.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(s.isArchived?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:s.isArchived?"Archived":"Active"})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Child Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ci,{label:"Name",value:s.childName}),r.jsx(Ci,{label:"Age",value:s.childAge}),r.jsx(Ci,{label:"Gender",value:s.childGender})]})]}),r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Parent Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ci,{label:"Name",value:s.parentName}),r.jsx(Ci,{label:"Email",value:s.parentEmail}),r.jsx(Ci,{label:"Phone",value:s.parentPhoneNo})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg mb-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Other Details"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsx(Ci,{label:"Preferred Center",value:s.preferredCenter}),r.jsx(Ci,{label:"Enquiry Date",value:jk(new Date(s.enquiryDate),"dd MMM yyyy")})]})]}),s.checklist&&r.jsxs("div",{className:"mb-8",children:[r.jsxs("button",{onClick:v,className:"flex items-center justify-between w-full bg-red-50 hover:bg-red-100 text-[#ab1c1c] font-medium py-3 px-4 rounded-lg transition duration-200",children:[r.jsx("span",{children:"View Questionnaire Responses"}),p?r.jsx(D5,{className:"h-5 w-5"}):r.jsx($5,{className:"h-5 w-5"})]}),p&&r.jsx("div",{className:"mt-4 bg-white border border-red-200 rounded-lg p-5 shadow-sm",children:r.jsx("div",{className:"space-y-6",children:Object.entries(s.checklist).map(([w,N])=>{const C=y(w);return r.jsx("div",{className:"pb-4 border-b border-red-100 last:border-0",children:C?r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:C.question}),C.example&&r.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[r.jsx("span",{className:"font-medium",children:"Example:"})," ",C.example]}),r.jsxs("p",{className:"mt-2 text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Response:"})," ",r.jsx("span",{className:"text-[#ab1c1c]",children:N.toString()})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:w}),r.jsxs("p",{className:"mt-2 text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Response:"})," ",r.jsx("span",{className:"text-[#ab1c1c]",children:N.toString()})]})]})},w)})})})]}),s.additionalNotes&&r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg mb-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Additional Notes"}),r.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:s.additionalNotes})]}),i&&r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Video Submission"}),r.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:r.jsxs("video",{controls:!0,className:"w-full",children:[r.jsx("source",{src:i,type:"video/mp4"}),"Your browser does not support the video tag."]})})]})]})]})})}):r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Enquiry not found"})},Ci=({label:s,value:e})=>r.jsxs("div",{className:"flex",children:[r.jsxs("span",{className:"text-gray-600 font-medium w-1/3",children:[s,":"]}),r.jsx("span",{className:"text-gray-800 flex-1",children:e})]}),b8="/assets/defaultUser-Cz2xbWm6.webp";function y8(){const s=jh(),[e,t]=F.useState(null),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState({}),[h,p]=F.useState(!1),[f,g]=F.useState({currentPassword:"",newPassword:"",confirmPassword:""}),b="\r\nhttps://testingtotalapi.joywithlearning.com";console.log("API URL:",b);const y=xs();F.useEffect(()=>{v()},[]);const v=async()=>{const $=sessionStorage.getItem("token");if(!$){y("/login");return}const E=sessionStorage.getItem("role"),_=sessionStorage.getItem("".concat(E,"Id"));try{a(!0);const L=await Le.get("/api/data/allUsers/".concat(_),{headers:{Authorization:"".concat($)}});t(L.data),u(L.data),console.log(L.data)}catch(L){console.error("Error fetching user:",L),T("Failed to load profile data","error")}finally{a(!1)}},w=()=>{o&&u(e),i(!o)},N=$=>{const{name:E,value:_}=$.target;u({...c,[E]:_})},C=async()=>{const $=sessionStorage.getItem("token"),E=sessionStorage.getItem("role"),_=sessionStorage.getItem("".concat(E,"Id"));try{const L=await Le.put("/api/data/updateUser/".concat(_),c,{headers:{Authorization:"".concat($)}});t(L.data),i(!1),T("Profile updated successfully!","success"),s(F5({key:"name",value:L.data.name}))}catch(L){console.error("Error updating profile:",L),T("Failed to update profile","error")}},I=async $=>{var O,z;if($.preventDefault(),f.newPassword!==f.confirmPassword){T("New passwords do not match","error");return}const E=sessionStorage.getItem("token"),_=sessionStorage.getItem("role"),L=sessionStorage.getItem("".concat(_,"Id"));try{await Le.put("/api/data/changePassword/".concat(L),{currentPassword:f.currentPassword,newPassword:f.newPassword},{headers:{Authorization:"".concat(E)}}),p(!1),g({currentPassword:"",newPassword:"",confirmPassword:""}),T("Password changed successfully! \n You will be redirected to Login page","success"),setTimeout(()=>{sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem(_+"Id"),s(Ry()),y("/login")},3e3)}catch(A){console.error("Error changing password:",A),T(((z=(O=A.response)==null?void 0:O.data)==null?void 0:z.message)||"Failed to change password","error")}},T=($,E)=>{switch(E){case"success":Be.success($);break;case"error":Be.error($);break;case"info":Be.info($);break;case"warning":Be.warning($);break;default:Be($)}};return n?r.jsx("div",{className:"flex justify-center items-center ",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 m-20 border-red-800"})}):e?r.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),r.jsx("div",{className:"max-w-3xl mx-auto",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[r.jsxs("div",{className:"bg-[#ab1c1c] px-6 py-8 rounded-t-xl flex flex-col md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex flex-col justify-center md:items-start text-center md:text-left",children:[r.jsx("h1",{className:"text-3xl font-bold text-white",children:"Your Profile"}),r.jsxs("p",{className:"mt-2 text-red-100",children:["Hello, ",e.name||e.mobilenumber||"User","!"]})]}),e.role==="therapist"&&r.jsx("div",{className:"mt-6 md:mt-0 md:ml-8 flex justify-center md:justify-end",children:r.jsx("img",{src:e.profilePhoto?"".concat(b,"/uploads/profilePhotos/").concat(e.profilePhoto.split(/[\\/]/).pop()):b8,alt:"Profile",className:"w-36 h-36 rounded-full border-4 border-white object-cover shadow-xl"})})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-red-50 rounded-lg p-6 mb-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c]",children:"Personal Information"}),r.jsx("button",{onClick:w,className:"px-4 py-2 rounded-lg text-white ".concat(o?"bg-gray-500 hover:bg-gray-600":"bg-[#ab1c1c] hover:bg-[#8e1818]"," transition duration-300"),children:o?"Cancel":"Edit Information"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Name:"}),o?r.jsx("input",{type:"text",name:"name",value:c.name||"",onChange:N,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.name||"Not provided"})]}),e.role==="therapist"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Designation:"}),o?r.jsx("input",{type:"text",name:"designation",value:c.designation||"",onChange:N,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.designation||"Not provided"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Qualification:"}),o?r.jsx("input",{type:"text",name:"qualification",value:c.qualification||"",onChange:N,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.qualification||"Not provided"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"RCI Number:"}),o?r.jsx("input",{type:"text",name:"rciNumber",value:c.rciNumber||"",onChange:N,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.rciNumber||"Not provided"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Phone:"}),o?r.jsx("input",{type:"text",name:"mobilenumber",value:c.mobilenumber||"",onChange:N,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.mobilenumber||"Not provided"})]}),e.role==="parent"?r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Address:"}),o?r.jsx("textarea",{name:"address",value:c.address||"",onChange:N,rows:"3",className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.address||"Not provided"})]}):null,o&&r.jsx("div",{className:"flex justify-end mt-6",children:r.jsx("button",{onClick:C,className:"px-6 py-2 bg-[#8e1818] text-white rounded-lg hover:bg-red-700 transition duration-300",children:"Save Changes"})})]})]}),e.role==="therapist"&&r.jsxs("div",{className:"bg-red-50 rounded-lg p-6 mb-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c] mb-6",children:"Feedback"}),r.jsx("div",{className:"space-y-6",children:e.feedback&&e.feedback.length>0?e.feedback.map(($,E)=>r.jsxs("div",{className:"p-4 bg-white border border-gray-300 rounded-lg shadow-sm",children:[r.jsx("div",{className:"flex justify-between items-center mb-2",children:r.jsx("span",{className:"text-sm text-gray-500",children:$.date?new Date($.date).toLocaleDateString():"Date N/A"})}),r.jsx("p",{className:"text-gray-800 italic whitespace-pre-wrap",children:$.content||"No content provided."})]},$._id||E)):r.jsx("p",{className:"text-gray-700 text-center py-4",children:"No feedback available yet."})})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c] mb-6",children:"Password Management"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:()=>p(!0),className:"px-6 py-3 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300 w-full md:w-1/2",children:"Change Password"})})]})]})]})}),h&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-[#ab1c1c] mb-6",children:"Change Password"}),r.jsxs("form",{onSubmit:I,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"Current Password"}),r.jsx("input",{type:"password",value:f.currentPassword,onChange:$=>g({...f,currentPassword:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"New Password"}),r.jsx("input",{type:"password",value:f.newPassword,onChange:$=>g({...f,newPassword:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"Confirm New Password"}),r.jsx("input",{type:"password",value:f.confirmPassword,onChange:$=>g({...f,confirmPassword:$.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]})]}),r.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[r.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300",children:"Update Password"})]})]})]})})]}):r.jsx("div",{className:"flex justify-center items-center bg-red-50",children:r.jsxs("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c]",children:"User not found"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Please try logging in again"}),r.jsx("button",{onClick:()=>y("/login"),className:"mt-4 px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300",children:"Go to Login"})]})})}const _k="/assets/Delete-Dh1e9pDH.png",v8=()=>r.jsx("div",{className:"flex justify-center items-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#ab1c1c]"})}),w8=({currentDate:s,setCurrentDate:e,handleDayClick:t,role:n,setShowEditHolidaysPopup:a,holidays:o=[]})=>{const i=s.getFullYear(),c=s.getMonth(),u=new Date(i,c,1).getDay(),h=new Date(i,c+1,0).getDate(),p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],g=w=>{const N="".concat(i,"-").concat(String(c+1).padStart(2,"0"),"-").concat(String(w).padStart(2,"0"));return o.some(C=>new Date(C.date).toISOString().split("T")[0]===N)},b=F.useMemo(()=>{const w=[],N=new Date,C=N.getDate(),I=N.getMonth()===c&&N.getFullYear()===i;for(let T=0;T<u;T++)w.push({day:null,isCurrentMonth:!1});for(let T=1;T<=h;T++){const $=I&&T===C,E=g(T);w.push({day:T,isCurrentMonth:!0,isToday:$,isHoliday:E})}return w},[i,c,u,h,o,g]),y=()=>{const w=new Date(i,c-1,1);e(w)},v=()=>{const w=new Date(i,c+1,1);e(w)};return r.jsxs("div",{className:"flex flex-col items-center p-4 w-full max-w-sm",children:[r.jsxs("div",{className:"flex items-center justify-between w-full mb-4 px-2",children:[r.jsx("button",{onClick:y,className:"text-[#ab1c1c] text-xl p-1",children:"Prev"}),r.jsxs("h3",{className:"text-xl font-bold text-[#ab1c1c]",children:[f[c]," ",i]}),r.jsx("button",{onClick:v,className:"text-[#ab1c1c] text-xl p-1",children:"Next"})]}),r.jsx("div",{className:"grid grid-cols-7 text-center text-sm font-semibold text-gray-700 mb-2 w-full",children:p.map(w=>r.jsx("div",{className:"py-1",children:w},w))}),r.jsx("div",{className:"grid grid-cols-7 gap-1 text-center w-full",children:b.map((w,N)=>r.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-full text-sm transition duration-150 mx-auto\n              ".concat(w.day?"cursor-pointer hover:bg-red-100":"text-gray-300","\n              ").concat(w.isToday&&w.isHoliday?"bg-gradient-to-br from-[#ab1c1c] to-green-500 text-white font-bold ring-2 ring-yellow-400":w.isToday?"bg-[#ab1c1c] text-white font-bold ring-2 ring-red-300":w.isHoliday?"bg-green-500 text-white font-semibold":w.day?"text-gray-800":"","\n            "),onClick:w.day?()=>t(w.day):null,children:w.day},N))}),r.jsx("div",{className:"mt-4 space-y-2",children:r.jsxs("div",{className:"flex items-center justify-center space-x-3 text-xs",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-[#ab1c1c] rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Today"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Holiday"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-[#ab1c1c] to-green-500 rounded-full ring-1 ring-yellow-400"}),r.jsx("span",{className:"text-gray-600",children:"Today + Holiday"})]})]})}),n==="superadmin"&&r.jsx("button",{onClick:()=>a(!0),className:"mt-4 w-full bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold py-2 rounded-lg transition duration-150 shadow-lg",children:"Edit Holidays"})]})},N8=({holidays:s})=>{const e=new Date,n=[...s].sort((i,c)=>new Date(i.date)-new Date(c.date)).filter(i=>new Date(i.date).setHours(0,0,0,0)>=e.setHours(0,0,0,0)),a=n[0]||null,o=i=>new Date(i).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:"Upcoming Holidays"}),r.jsx("div",{className:"max-h-[300px] overflow-y-auto pr-2 space-y-3",children:n.length>0?n.map((i,c)=>{const u=a&&i._id===a._id,h=u?"bg-red-100 border-l-8 border-red-500 shadow-md transform scale-[1.02]":"bg-red-50 border-l-4 border-[#ab1c1c] shadow-sm hover:bg-red-100";return r.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg transition duration-300 ".concat(h),children:[r.jsx("span",{className:"text-gray-800 ".concat(u?"font-bold":"font-semibold"),children:i.name}),r.jsx("span",{className:"text-sm text-gray-700 ".concat(u?"font-bold":""),children:o(i.date)})]},i._id||c)}):r.jsx("p",{className:"text-gray-500",children:"No upcoming holidays scheduled."})})]})},S8=({holidays:s,onSave:e,onClose:t})=>{const[n,a]=F.useState(s),[o,i]=F.useState(""),[c,u]=F.useState(""),[h,p]=F.useState(!1),[f,g]=F.useState(null),[b,y]=F.useState(!1),v=sessionStorage.getItem("token"),w=async T=>{const $=n[T];if(g($._id),$._id)try{await Le.delete("/api/superadmin/holidays/".concat($._id),{headers:{Authorization:"".concat(v)}})}catch(E){console.error("Error deleting holiday:",E),alert("Failed to delete holiday."),g(null);return}a(E=>E.filter((_,L)=>L!==T)),g(null)},N=async()=>{if(o&&c){p(!0);try{await Le.post("/api/superadmin/holidays",{name:c,date:o},{headers:{Authorization:"".concat(v)}}),i(""),u("");const T=await Le.get("/api/superadmin/holidays",{headers:{Authorization:"".concat(v)}});a(T.data.data)}catch(T){console.error("Error adding holiday:",T),alert("Failed to add holiday.")}finally{p(!1)}}else alert("Please enter both date and occasion for the new holiday.")},C=async()=>{y(!0);try{await e(),t()}catch(T){console.error("Error saving:",T)}finally{y(!1)}},I=T=>new Date(T).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-auto relative border-t-4 border-[#ab1c1c]",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4 text-center",children:"Edit Holidays"}),r.jsx("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto pr-2",children:n.length>0?n.map((T,$)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded-md border-l-2 border-gray-300",children:[r.jsxs("p",{className:"text-sm text-gray-800",children:[r.jsxs("span",{className:"font-semibold text-gray-700",children:[I(T.date),":"]})," ",T.name]}),r.jsx("button",{onClick:()=>w($),disabled:f===T._id,className:"text-red-600 hover:text-red-800 p-1 rounded-full transition duration-150 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f===T._id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):r.jsx("img",{src:_k,alt:"Delete",className:"w-5 h-5"})})]},T._id||$)):r.jsx("p",{className:"text-gray-500 text-sm text-center",children:"No holidays added yet."})}),r.jsxs("div",{className:"mb-6 border-t pt-4",children:[r.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Add New Holiday"}),r.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 items-end",children:[r.jsxs("div",{className:"col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Date"}),r.jsx("input",{type:"date",value:o,onChange:T=>i(T.target.value),disabled:h,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),r.jsxs("div",{className:"col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Occasion"}),r.jsx("input",{type:"text",value:c,onChange:T=>u(T.target.value),disabled:h,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"e.g., Christmas"})]}),r.jsx("button",{onClick:N,disabled:h||!o||!c,className:"col-span-1 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium py-2 rounded-md transition duration-150 text-sm flex items-center justify-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-1"}),"Adding..."]}):"Add"})]})]}),r.jsx("button",{onClick:C,disabled:b||h||f,className:"w-full bg-[#ab1c1c] hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold py-2 rounded-md transition duration-150 shadow-lg flex items-center justify-center",children:b?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"}),r.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",children:""})]})})};function C8(){const s=xs(),[e,t]=F.useState(new Date),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState([]),[h,p]=F.useState(!1),[f,g]=F.useState("");F.useEffect(()=>{const y=sessionStorage.getItem("token"),v=sessionStorage.getItem("role");if(!y){s("/login");return}g(v),b()},[s]);const b=async(y=!1)=>{try{y?i(!0):a(!0);const v=sessionStorage.getItem("token"),w=await Le.get("/api/superadmin/holidays",{headers:{Authorization:"".concat(v)}});u(w.data.data||[])}catch(v){console.error("Error fetching holidays:",v)}finally{y?i(!1):a(!1)}};return n?r.jsx(v8,{}):r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] mb-4",children:"Calendar"}),r.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-start gap-6",children:[r.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-xl p-4 flex justify-center min-w-[300px]",children:r.jsx(w8,{currentDate:e,setCurrentDate:t,handleDayClick:y=>console.log("Clicked day:",y),role:sessionStorage.getItem("role"),setShowEditHolidaysPopup:p,holidays:c})}),r.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-xl p-4 min-w-[300px]",children:r.jsx(N8,{holidays:c})})]}),f==="superadmin"&&h&&r.jsx(S8,{holidays:c,onSave:()=>b(!0),onClose:()=>p(!1)}),o&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-40",children:r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-700 font-medium",children:"Refreshing holidays..."})]})})]})}const k8=()=>r.jsx("div",{className:"flex justify-center items-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#ab1c1c]"})});function j8(){const[s,e]=F.useState(!0),[t,n]=F.useState([]),[a,o]=F.useState(!1),[i,c]=F.useState(!1),[u,h]=F.useState(null),[p,f]=F.useState(""),[g,b]=F.useState({message:"",link:"",displayInScroller:!1,targetType:"all",targetRoles:[]}),[y,v]=F.useState(!1),[w,N]=F.useState(!1),[C,I]=F.useState([]),T=[{key:"admin",label:"Admin"},{key:"parent",label:"Parent"},{key:"doctor",label:"Doctor"},{key:"therapist",label:"Therapist"},{key:"superadmin",label:"Superadmin"}];F.useEffect(()=>{const A=sessionStorage.getItem("role");if(!sessionStorage.getItem("token")){e(!1);return}f(A),$(A)},[]);const $=async A=>{try{e(!0);const U=sessionStorage.getItem("token");let q=(await Le.get("/api/superadmin/announcements",{headers:{Authorization:"".concat(U)}})).data||[];console.log("All Announcements from API:",q),console.log("User Role:",A),A!=="superadmin"&&(console.log("Filtering announcements for role:",A),q=q.filter(B=>B.targetType==="all"?!0:B.targetType==="specific"&&Array.isArray(B.targetRoles)?B.targetRoles.includes(A):!1)),console.log("Fetched Announcements:",q),n(q)}catch(U){console.error("Error fetching announcements:",U)}finally{e(!1)}},E=()=>{b({message:"",link:"",displayInScroller:!1,targetType:"all",targetRoles:[]}),h(null),v(!1)},_=A=>{b(U=>{const X=U.targetRoles.includes(A);return{...U,targetRoles:X?U.targetRoles.filter(Z=>Z!==A):[...U.targetRoles,A]}})},L=async()=>{if(!g.message.trim()){console.error("Please enter announcement text.");return}if(g.targetType==="specific"&&g.targetRoles.length===0){console.error("Please select at least one target role.");return}try{N(!0);const A=sessionStorage.getItem("token");u?(await Le.put("/api/superadmin/announcements/".concat(u._id||u.id),{message:g.message,link:g.link&&g.link.trim()?g.link.trim():null,displayInScroller:!!g.displayInScroller,targetType:g.targetType,targetRoles:g.targetType==="specific"?g.targetRoles:[]},{headers:{Authorization:"".concat(A)}}),c(!1),h(null)):(await Le.post("/api/superadmin/announcements",{message:g.message,link:g.link&&g.link.trim()?g.link.trim():null,displayInScroller:!!g.displayInScroller,targetType:g.targetType,targetRoles:g.targetType==="specific"?g.targetRoles:[]},{headers:{Authorization:"".concat(A)}}),o(!1)),await $(p),E()}catch(A){console.error("Error saving announcement:",A)}finally{N(!1)}},O=A=>{h(A),b({message:A.message,link:A.link||"",displayInScroller:A.displayInScroller,targetType:A.targetType,targetRoles:A.targetRoles||[]}),c(!0)},z=async A=>{if(window.confirm("Are you sure you want to delete this announcement?")&&!C.includes(A))try{I(X=>[...X,A]);const U=sessionStorage.getItem("token");await Le.delete("/api/superadmin/announcements/".concat(A),{headers:{Authorization:"".concat(U)}}),n(X=>X.filter(Z=>Z._id!==A&&Z.id!==A))}catch(U){console.error("Error deleting announcement:",U),alert("Failed to delete announcement. Please try again.")}finally{I(U=>U.filter(X=>X!==A))}};return s?r.jsx(k8,{}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c]",children:"Announcements"}),p==="superadmin"&&r.jsx("button",{onClick:()=>o(!0),className:"bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow",children:"+ Add Announcement"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-[#ab1c1c] mb-4",children:"Current Announcements"}),t.length===0?r.jsx("p",{className:"text-gray-500",children:"No announcements have been posted yet."}):r.jsx("div",{className:"space-y-4",children:t.map(A=>{const U=A._id||A.id,X=C.includes(U);return r.jsxs("div",{className:"p-4 rounded-lg border border-gray-100 shadow-sm\n               flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[r.jsxs("div",{className:"md:pr-6 flex-1 min-w-0 text-left",children:[r.jsx("p",{className:"text-gray-800 font-medium break-words",children:A.message}),A.link&&r.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:[" Links to: ",A.link]})]}),r.jsxs("div",{className:"md:text-right md:items-end flex flex-col gap-2 md:gap-0 flex-none",children:[r.jsx("p",{className:"text-sm text-gray-500 italic whitespace-nowrap",children:new Date(A.createdAt).toLocaleString()}),r.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[p==="superadmin"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:[A.displayInScroller?r.jsx("span",{className:"mr-2 text-green-600 font-medium",children:"Scroller Display"}):r.jsx("span",{className:"mr-2 text-gray-400",children:"Not in Scroller"}),r.jsx("span",{className:"mx-2 text-gray-300",children:"|"}),r.jsxs("span",{children:["Target:"," ",A.targetType==="all"?"All Users":A.targetType==="public"?"Public (Non-Logged In)":A.targetRoles&&A.targetRoles.length?A.targetRoles.map(Z=>Z.charAt(0).toUpperCase()+Z.slice(1)).join(", "):"Specific Roles"]})]}),r.jsx("button",{onClick:()=>O(A),title:"Edit announcement",className:"p-2 rounded-md hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Edit announcement",children:r.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),r.jsx("button",{onClick:()=>z(U),disabled:X,title:"Delete announcement",className:"p-2 rounded-md hover:bg-gray-100 transition-colors ".concat(X?"opacity-60 cursor-not-allowed":"cursor-pointer"),"aria-label":"Delete announcement",children:X?r.jsx("div",{className:"w-5 h-5 border-b-2 border-red-500 rounded-full animate-spin"}):r.jsx("img",{src:_k,alt:"Delete",className:"w-5 h-5 object-contain",draggable:!1})})]}),p!=="superadmin"&&r.jsxs("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:[A.displayInScroller?r.jsx("span",{className:"mr-2 text-green-600 font-medium",children:"Scroller Display"}):r.jsx("span",{className:"mr-2 text-gray-400",children:"Not in Scroller"}),r.jsx("span",{className:"mx-2 text-gray-300",children:"|"}),r.jsxs("span",{children:["Target:"," ",A.targetType==="all"?"All Users":A.targetType==="public"?"Public (Non-Logged In)":A.targetRoles&&A.targetRoles.length?A.targetRoles.map(Z=>Z.charAt(0).toUpperCase()+Z.slice(1)).join(", "):"Specific Roles"]})]})]})]})]},U)})})]}),a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto relative border-t-4 border-[#ab1c1c]",children:[r.jsx("h3",{className:"text-2xl font-bold text-[#ab1c1c] mb-4",children:"Add Announcement"}),r.jsx("textarea",{value:g.message,onChange:A=>b(U=>({...U,message:A.target.value})),rows:5,placeholder:"Write announcement here...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] mb-4"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link (Optional)"}),r.jsx("input",{type:"text",value:g.link,onChange:A=>b(U=>({...U,link:A.target.value})),placeholder:"Internal route: /training OR External URL: https://google.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Examples: /training, /contact, /services, https://example.com"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-4",children:[r.jsx("input",{type:"checkbox",checked:g.displayInScroller,onChange:A=>b(U=>({...U,displayInScroller:A.target.checked})),className:"form-checkbox h-4 w-4 text-[#ab1c1c] rounded"}),r.jsx("span",{className:"text-gray-800",children:"Display in the scroller"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="all",onChange:()=>b(A=>({...A,targetType:"all",targetRoles:[]})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"All Users"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="specific",onChange:()=>b(A=>({...A,targetType:"specific"})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"Specific Roles"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="public",onChange:()=>b(A=>({...A,targetType:"public",targetRoles:[]})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"Public (Non-Logged In Users)"})]}),g.targetType==="specific"&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>v(A=>!A),type:"button",className:"w-full text-left border border-gray-300 rounded-md p-2 flex items-center justify-between focus:outline-none bg-white hover:bg-gray-50 transition-colors",children:[r.jsx("div",{children:g.targetRoles.length===0?"Select roles...":"".concat(g.targetRoles.length," role(s) selected")}),r.jsx("div",{className:"text-gray-500",children:""})]}),y&&r.jsxs("div",{className:"absolute left-0 mt-2 w-full bg-white border border-gray-200 rounded-md shadow-lg z-10 max-h-40 overflow-y-auto p-3",children:[T.map(A=>r.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer hover:bg-gray-100 p-1 rounded",children:[r.jsx("input",{type:"checkbox",checked:g.targetRoles.includes(A.key),onChange:()=>_(A.key),className:"form-checkbox h-4 w-4 text-[#ab1c1c] rounded"}),r.jsx("span",{className:"text-gray-800",children:A.label})]},A.key)),r.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-gray-100",children:[r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:T.map(U=>U.key)})),className:"text-sm text-[#ab1c1c] hover:underline font-medium",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:[]})),className:"text-sm text-gray-600 hover:underline",children:"Clear"})]}),r.jsx("button",{type:"button",onClick:()=>v(!1),className:"w-full mt-3 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border border-gray-300 transition-colors",children:"Done Selecting Roles"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[r.jsx("button",{onClick:()=>{o(!1),E()},className:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:L,disabled:w,className:"px-4 py-2 rounded-md bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold transition-colors disabled:opacity-50",children:w?"Adding...":"Add"})]}),r.jsx("button",{onClick:()=>{o(!1),E()},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",title:"Close",children:""})]})}),i&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto relative border-t-4 border-blue-600",children:[r.jsx("h3",{className:"text-2xl font-bold text-blue-600 mb-4",children:"Edit Announcement"}),r.jsx("textarea",{value:g.message,onChange:A=>b(U=>({...U,message:A.target.value})),rows:5,placeholder:"Write announcement here...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-blue-600 focus:border-blue-600 mb-4"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link (Optional)"}),r.jsx("input",{type:"text",value:g.link,onChange:A=>b(U=>({...U,link:A.target.value})),placeholder:"Internal route: /training OR External URL: https://google.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-blue-600 focus:border-blue-600"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Examples: /training, /contact, /services, https://example.com"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-4",children:[r.jsx("input",{type:"checkbox",checked:g.displayInScroller,onChange:A=>b(U=>({...U,displayInScroller:A.target.checked})),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),r.jsx("span",{className:"text-gray-800",children:"Display in the scroller"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="all",onChange:()=>b(A=>({...A,targetType:"all",targetRoles:[]})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"All Users"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="specific",onChange:()=>b(A=>({...A,targetType:"specific"})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"Specific Roles"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="public",onChange:()=>b(A=>({...A,targetType:"public",targetRoles:[]})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"Public (Non-Logged In Users)"})]}),g.targetType==="specific"&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>v(A=>!A),type:"button",className:"w-full text-left border border-gray-300 rounded-md p-2 flex items-center justify-between focus:outline-none bg-white hover:bg-gray-50 transition-colors",children:[r.jsx("div",{children:g.targetRoles.length===0?"Select roles...":"".concat(g.targetRoles.length," role(s) selected")}),r.jsx("div",{className:"text-gray-500",children:""})]}),y&&r.jsxs("div",{className:"absolute left-0 mt-2 w-full bg-white border border-gray-200 rounded-md shadow-lg z-10 max-h-40 overflow-y-auto p-3",children:[T.map(A=>r.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer hover:bg-gray-100 p-1 rounded",children:[r.jsx("input",{type:"checkbox",checked:g.targetRoles.includes(A.key),onChange:()=>_(A.key),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),r.jsx("span",{className:"text-gray-800",children:A.label})]},A.key)),r.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-gray-100",children:[r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:T.map(U=>U.key)})),className:"text-sm text-blue-600 hover:underline font-medium",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:[]})),className:"text-sm text-gray-600 hover:underline",children:"Clear"})]}),r.jsx("button",{type:"button",onClick:()=>v(!1),className:"w-full mt-3 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border border-gray-300 transition-colors",children:"Done Selecting Roles"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[r.jsx("button",{onClick:()=>{c(!1),E()},className:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:L,disabled:w,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white font-semibold transition-colors disabled:opacity-50",children:w?"Updating...":"Update"})]}),r.jsx("button",{onClick:()=>{c(!1),E()},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",title:"Close",children:""})]})})]})}const T8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState([]),[i,c]=F.useState([]),[u,h]=F.useState({child:"all",doctor:"all",status:"all",date:""}),[p,f]=F.useState(""),g=sessionStorage.getItem("parentId");F.useEffect(()=>{(async()=>{try{const C=await Le.get("/api/parents/getappointments/".concat(g),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(C.data.appointments),f(C.data.parentName),o(C.data.appointments);const I=C.data.appointments.map(T=>{var O,z,A,U,X;const $=new Date(T.appointmentDate),E=new Date((O=T.childId)==null?void 0:O.dob),_=$-E,L=Math.floor(_/(1e3*60*60*24*365.25));return{id:T._id,childName:((z=T.childId)==null?void 0:z.name)||"Unknown",age:L,appointmentDate:$,appointmentDateFormatted:$.toLocaleDateString(),appointmentDateValue:$.toISOString().split("T")[0],appointmentTime:T.appointmentTime||"Not specified",consultationType:T.consultationType||"Not specified",doctorName:((A=T.doctorId)==null?void 0:A.name)||"Not assigned",doctorId:((U=T.doctorId)==null?void 0:U._id)||null,status:T.status||"pending",centreName:((X=T.centreId)==null?void 0:X.name)||"Not specified",parentName:C.data.parentName||"Not specified"}});c(I),console.log(I)}catch(C){console.error("Error fetching appointments:",C)}finally{n(!1)}})()},[g]),F.useEffect(()=>{let N=s;u.child!=="all"&&(N=N.filter(C=>C.childId.name===u.child)),u.doctor!=="all"&&(N=N.filter(C=>C.doctorId.name===u.doctor)),u.status!=="all"&&(N=N.filter(C=>C.status===u.status)),u.date&&(N=N.filter(C=>new Date(C.appointmentDate).toLocaleDateString()===new Date(u.date).toLocaleDateString())),o(N)},[u,s]);const b=N=>{const{name:C,value:I}=N.target;h({...u,[C]:I})},y=N=>{switch(N){case"pending":return"bg-yellow-100  rounded-lg text-yellow-800";case"rejected":return"bg-red-100 rounded-lg text-red-800";case"approved":return"bg-green-200 rounded-lg  text-green-800";default:return"bg-gray-100 rounded-lg text-gray-800"}};if(t)return r.jsx("div",{className:"mt-16",children:r.jsx(Vs,{})});const v=[...new Set(s.map(N=>N.childId.name))],w=[...new Set(s.map(N=>{var C;return(C=N.doctorId)==null?void 0:C.name}))];return r.jsxs("div",{className:"container mx-auto p-4",children:[r.jsx(lg,{}),r.jsx("h1",{className:"text-3xl text-center font-bold text-[#ab1c1c] mt-10 mb-10",children:"Appointments"}),r.jsxs("div",{className:"flex flex-wrap justify-center mb-6 space-x-4",children:[r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Child"}),r.jsxs("select",{name:"child",value:u.child,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),v.map(N=>r.jsx("option",{value:N,children:N},N))]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Doctor"}),r.jsxs("select",{name:"doctor",value:u.doctor,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),w.map(N=>r.jsx("option",{value:N,children:N},N))]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),r.jsxs("select",{name:"status",value:u.status,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:u.date,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md"})]})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg",children:r.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Child Name"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Doctor Name"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Appointment Date"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Appointment Time"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Status"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Actions"})]})}),r.jsx("tbody",{children:a.map((N,C)=>{var I;return r.jsxs("tr",{className:"hover:bg-red-50",children:[r.jsx("td",{className:"px-4 py-2 border-b text-center",children:N.childId.name}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:(I=N.doctorId)==null?void 0:I.name}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:new Date(N.appointmentDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:N.appointmentTime}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:r.jsxs("p",{className:y(N.status),children:[N.status[0].toUpperCase(),N.status.substring(1)]})}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:r.jsx("button",{onClick:()=>_y(i[C]),className:"text-[#ab1c1c] px-4 py-2 hover:text-[#8e1818] transition duration-300",children:"View PDF"})})]},N._id)})})]})})]})},I8=()=>{const s=sessionStorage.getItem("centreId"),[e,t]=F.useState([]),[n,a]=F.useState([]),[o,i]=F.useState(!0),[c,u]=F.useState(1),[h,p]=F.useState(""),f=10;F.useEffect(()=>{s&&g()},[s]);const g=async()=>{i(!0);try{const C=await Le.get("/api/admins/getPendingAppointments/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(C.data),a(C.data),u(1)}catch(C){console.error("Error fetching appointments:",C)}finally{i(!1)}},b=async(C,I)=>{try{await Le.put("/api/admins/manageAppointment/".concat(C),{status:I},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),g()}catch(T){console.error("Error updating appointment status:",T)}},y=C=>{const I=C.target.value.toLowerCase();if(p(I),I==="")a(e);else{const T=e.filter($=>{var E,_,L,O;return((_=(E=$.childId)==null?void 0:E.name)==null?void 0:_.toLowerCase().includes(I))||((O=(L=$.childId)==null?void 0:L.parentName)==null?void 0:O.toLowerCase().includes(I))});a(T)}u(1)},v=Math.ceil(n.length/f),w=(c-1)*f,N=n.slice(w,w+f);return s?r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-6 text-center",children:"Pending Appointments"}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by child or parent name...",value:h,onChange:y,className:"w-full p-2 border border-red-300 rounded focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o?r.jsxs("div",{className:"p-8 text-center text-[#ab1c1c]",children:["Loading appointments...",r.jsx(Vs,{})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-red-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Child"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Parent"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:N.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:h?"No matching appointments found":"No pending appointments"})}):N.map(C=>{var I,T,$;return r.jsxs("tr",{className:"hover:bg-red-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:((I=C.childId)==null?void 0:I.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:((T=C.childId)==null?void 0:T.parentId.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:(($=C.doctorId)==null?void 0:$.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:new Date(C.appointmentDate).toLocaleDateString()})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:C.appointmentTime})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:C.consultationType})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>b(C._id,"approved"),className:"bg-green-500 hover:bg-green-600 text-white p-2 rounded flex items-center justify-center w-10 h-10",title:"Approve",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),r.jsx("button",{onClick:()=>b(C._id,"rejected"),className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded flex items-center justify-center w-10 h-10",title:"Reject",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})]},C._id)})})]})}),v>1&&r.jsxs("div",{className:"bg-red-50 px-4 py-3 flex items-center justify-between border-t border-red-200",children:[r.jsx("div",{children:r.jsxs("p",{className:"text-sm text-[#ab1c1c]",children:["Page ",r.jsx("span",{className:"font-medium",children:c})," of"," ",r.jsx("span",{className:"font-medium",children:v})," "," ",r.jsx("span",{className:"font-medium",children:n.length})," ","total"]})}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>u(C=>Math.max(1,C-1)),disabled:c===1,className:"px-3 py-1 border border-red-300 rounded text-[#ab1c1c] disabled:opacity-50 hover:bg-red-100",children:"Previous"}),r.jsx("button",{onClick:()=>u(C=>Math.min(v,C+1)),disabled:c===v,className:"px-3 py-1 border border-red-300 rounded text-[#ab1c1c] disabled:opacity-50 hover:bg-red-100",children:"Next"})]})]})]})})]}):r.jsx("div",{className:"container mx-auto px-4 py-8 text-center text-red-500",children:"Centre ID is missing in the URL parameters"})},$8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState([]),[i,c]=F.useState(!0),[u,h]=F.useState(null),[p,f]=F.useState(!1),[g,b]=F.useState(""),[y,v]=F.useState({from:"",to:""}),w=xs(),N=sessionStorage.getItem("centerId"),C=async()=>{try{const O=sessionStorage.getItem("centreId"),A=(await Le.get("/api/admins/get-jwl-enquiries/".concat(O),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}})).data;e(A),n(A.filter(U=>!U.isArchived)),o(A.filter(U=>U.isArchived)),c(!1)}catch(O){h("Failed to fetch users"),c(!1),console.error(O)}};F.useEffect(()=>{C()},[N]);const I=O=>{b(O)},T=O=>{const{name:z,value:A}=O.target;v(U=>({...U,[z]:A}))},$=(p?a:t).filter(O=>{const z=g.toLowerCase(),A=O.childName.toLowerCase().includes(z)||O.parentName.toLowerCase().includes(z)||O.parentEmail.toLowerCase().includes(z)||O.referenceId.toLowerCase().includes(z);if(!y.from&&!y.to)return A;const U=l4(O.enquiryDate),X=y.from?new Date(y.from):null,Z=y.to?new Date(y.to):null;Z&&Z.setHours(23,59,59,999);const q=(!X||U>=X)&&(!Z||U<=Z);return A&&q}),E=()=>{v({from:"",to:""})},_=O=>{w("/admindashboard/jwlenquiries/".concat(O))},L=async O=>{try{await Le.put("/api/admins/archive-jwl-enquiry",{parentEmail:O},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),C()}catch(z){console.error("Failed to archive user",z)}};return i?r.jsx("div",{className:"mt-20",children:r.jsx(Vs,{})}):u?r.jsx("div",{className:"text-center text-red-600",children:u}):r.jsx("div",{className:"mt-16",children:r.jsx("div",{className:"p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8 flex-wrap gap-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:p?"Archived Users":"Active Users"}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("button",{className:"px-4 py-2 rounded-md font-medium transition duration-300 ".concat(p?"bg-gray-300 text-gray-700":"bg-blue-500 text-white"),onClick:()=>f(!1),children:"Active"}),r.jsx("button",{className:"px-4 py-2 rounded-md font-medium transition duration-300 ".concat(p?"bg-[#ab1c1c] text-white":"bg-gray-300 text-gray-700"),onClick:()=>f(!0),children:"Archived"})]})]}),r.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4 items-end",children:[r.jsxs("div",{className:"w-full md:w-1/2 lg:w-2/5 relative",children:[r.jsx("input",{type:"text",placeholder:"Search by child name, parent name, email or reference ID",className:"w-full p-3 pl-10 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:g,onChange:O=>I(O.target.value)}),r.jsx("div",{className:"absolute left-3 top-3 text-gray-400",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),r.jsxs("div",{className:"w-full md:w-1/2 lg:w-3/5 flex flex-col sm:flex-row gap-2 items-end",children:[r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),r.jsx("input",{type:"date",name:"from",value:y.from,onChange:T,className:"w-full p-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),r.jsx("input",{type:"date",name:"to",value:y.to,onChange:T,className:"w-full p-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsx("div",{className:"w-full sm:w-1/3",children:r.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-200",children:"Reset Dates"})})]})]}),r.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full leading-normal",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#ab1c1c] text-white",children:[r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Reference ID"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Phone"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Email"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Enquiry Date"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{children:$.length>0?$.map(O=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:O.referenceId})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:O.childName})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:O.parentName})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:O.parentPhoneNo})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:O.parentEmail})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:jk(l4(O.enquiryDate),"dd-MM-yyyy")})}),r.jsxs("td",{className:"px-5 py-5 border-b border-gray-200 text-sm flex space-x-2",children:[r.jsx("button",{onClick:()=>_(O.referenceId),className:"px-4 py-2 bg-purple-800 text-white rounded-md hover:bg-purple-600 transition duration-200",children:"Details"}),!O.isArchived&&r.jsx("button",{onClick:()=>L(O.parentEmail),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200",children:"Archive"})]})]},O._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"px-5 py-5 border-b border-gray-200 text-sm text-center",children:"No users found"})})})]})})})]})})})},A8=F.forwardRef((s,e)=>{const[t,n]=F.useState(!0),[a,o]=F.useState(!1),[i,c]=F.useState(!0),u=Bo();F.useEffect(()=>{var f;(f=s.onStateChange)==null||f.call(s,{isOpen:t,isMobile:a})},[t,a]),F.useImperativeHandle(e,()=>({getMobile:()=>a,getIsOpen:()=>t}));const h=f=>u.pathname===f||u.pathname===f+"/";F.useEffect(()=>{const f=()=>{const g=window.innerWidth<1024;o(g),g&&(n(!1),c(!1))};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]),F.useEffect(()=>{a&&(n(!1),setTimeout(()=>{c(!1)},300))},[u.pathname,a]),F.useEffect(()=>{if(t)c(!0);else if(!t){const f=setTimeout(()=>{c(!1)},300);return()=>clearTimeout(f)}},[t]);const p=()=>{t||c(!0),n(!t)};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed top-0 left-0 z-40 h-full bg-white shadow-lg transition-all duration-300 ".concat(t?"translate-x-0":"translate-x-[-100%]"," ").concat(t?"w-64":"w-0"," pt-16 overflow-hidden"),children:i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-bold text-[#ab1c1c]",children:"Parent Portal"})}),r.jsxs("nav",{className:"mt-6 w-64",children:[" ",r.jsxs("ul",{className:"space-y-2 px-2",children:[r.jsx("li",{children:r.jsxs(nt,{to:"/parentdashboard",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Nk,{size:18,className:"mr-3"}),r.jsx("span",{children:"Dashboard"}),h("/parentdashboard")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/parentdashboard/bookappointment",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard/bookappointment")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Sk,{size:18,className:"mr-3"}),r.jsx("span",{children:"Book Appointment"}),h("/parentdashboard/bookappointment")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/parentdashboard/viewappointments",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard/viewappointments")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(A6,{size:18,className:"mr-3"}),r.jsx("span",{children:"View Appointments"}),h("/parentdashboard/viewappointments")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})})]})]})]})}),r.jsx("button",{onClick:p,className:"fixed z-40 bg-[#ab1c1c] text-white shadow-md transition-all duration-300 ".concat(a?"top-16 ".concat(t?"left-64":"left-0"):"top-20 ".concat(t?"left-64":"left-0")),style:{borderRadius:"0 50% 50% 0",width:"28px",height:"48px",display:"flex",justifyContent:"center",alignItems:"center"},"aria-label":"Toggle navigation",children:t?r.jsx(Ck,{size:20}):a?r.jsx(Hr,{size:20}):r.jsx(kk,{size:20})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>n(!1)})]})});function N4(){const s=F.useRef(),[e,t]=F.useState(!1),[n,a]=F.useState(!0);return F.useEffect(()=>{s.current&&(t(s.current.getMobile()),a(s.current.getIsOpen()))},[]),r.jsxs("div",{className:" min-h-screen bg-gray-50",children:[r.jsx(A8,{ref:s,onStateChange:({isMobile:o,isOpen:i})=>{t(o),a(i)}}),r.jsx("div",{className:"transition-all duration-300 ".concat(!e&&n?"ml-64":""),children:r.jsxs(og,{children:[r.jsx(tt,{path:"/",element:r.jsx(s8,{})}),r.jsx(tt,{path:"/bookappointment",element:r.jsx(o8,{})}),r.jsx(tt,{path:"/viewappointments",element:r.jsx(T8,{})}),r.jsx(tt,{path:"/child/:childId",element:r.jsx(f8,{})}),r.jsx(tt,{path:"/reports",element:r.jsx(Dk,{})}),r.jsx(tt,{path:"/iepreports/:childId",element:r.jsx(Rk,{})}),r.jsx(tt,{path:"*",element:r.jsx(Eo,{to:"/parentdashboard",replace:!0})})]})})]})}const E8=F.forwardRef((s,e)=>{const[t,n]=F.useState(!0),[a,o]=F.useState(!1),[i,c]=F.useState(!0),u=Bo();F.useEffect(()=>{var f;(f=s.onStateChange)==null||f.call(s,{isOpen:t,isMobile:a})},[t,a]),F.useImperativeHandle(e,()=>({getMobile:()=>a,getIsOpen:()=>t}));const h=f=>u.pathname===f||u.pathname===f+"/";F.useEffect(()=>{const f=()=>{const g=window.innerWidth<1024;o(g),g&&(n(!1),c(!1))};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]),F.useEffect(()=>{a&&(n(!1),setTimeout(()=>{c(!1)},300))},[u.pathname,a]),F.useEffect(()=>{if(t)c(!0);else if(!t){const f=setTimeout(()=>{c(!1)},300);return()=>clearTimeout(f)}},[t]);const p=()=>{t||c(!0),n(!t)};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed top-0 left-0 z-40 h-full bg-white shadow-lg transition-all duration-300 ".concat(t?"translate-x-0 w-64":"translate-x-[-100%] w-0"," pt-16 overflow-hidden"),children:i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-bold text-[#ab1c1c]",children:"Admin Portal"})}),r.jsx("nav",{className:"mt-6 w-64",children:r.jsxs("ul",{className:"space-y-2 px-2",children:[r.jsx("li",{children:r.jsxs(nt,{to:"/admindashboard",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(E6,{size:18,className:"mr-3"}),r.jsx("span",{children:"Dashboard"}),h("/admindashboard")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/admindashboard/register",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/register")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(D6,{size:18,className:"mr-3"}),r.jsx("span",{children:"Register"}),h("/admindashboard/register")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/admindashboard/existingusers",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/existingusers")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Nk,{size:18,className:"mr-3"}),r.jsx("span",{children:"Import"}),h("/admindashboard/existingusers")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/admindashboard/viewappointment",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/viewappointment")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Sk,{size:18,className:"mr-3"}),r.jsx("span",{children:"View Appointments"}),h("/admindashboard/viewappointment")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(nt,{to:"/admindashboard/jwlenquiries",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/jwlenquiries")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(R6,{size:18,className:"mr-3"}),r.jsx("span",{children:"JWL Enquiries"}),h("/admindashboard/jwlenquiries")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})})]})})]})}),r.jsx("button",{onClick:p,className:"fixed z-40 bg-[#ab1c1c] text-white shadow-md transition-all duration-300 ".concat(a?"top-16 ".concat(t?"left-64":"left-0"):"top-20 ".concat(t?"left-64":"left-0")),style:{borderRadius:"0 50% 50% 0",width:"28px",height:"48px",display:"flex",justifyContent:"center",alignItems:"center"},"aria-label":"Toggle navigation",children:t?r.jsx(Ck,{size:20}):a?r.jsx(Hr,{size:20}):r.jsx(kk,{size:20})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>n(!1)})]})}),D8={Neredmet:"NE",Nacharam:"NA","Banjara Hills":"BH",Bowenpally:"BP",Kukatpally:"KP",Barkatpura:"BR",Champapet:"P",Manikonda:"MK",Suchitra:"SH"},R8=["CBSE","SSC","ICSE","Cambridge (IB)","NIOS","Others"];function _8(){const[s,e]=F.useState(1),[t,n]=F.useState({name:"",mobilenumber:"",address:"",role:"Parent",password:"total12345678"}),[a,o]=F.useState([]),[i,c]=F.useState(""),[u,h]=F.useState(null),[p,f]=F.useState(!1),[g,b]=F.useState({childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),[y,v]=F.useState({}),[w,N]=F.useState(!1),[C,I]=F.useState(!1),[T,$]=F.useState([]),E=["Case History","Prescription","IEP","IQ Report","OT Report","Speech Report","Other"],[_,L]=F.useState(!1),[O,z]=F.useState([]),[A,U]=F.useState(""),[X,Z]=F.useState([]),[q,B]=F.useState(""),[K,J]=F.useState(""),[Q,ae]=F.useState(""),[we,Ce]=F.useState(""),[ve,pe]=F.useState(null);F.useEffect(()=>{ye(),Y(),ce()},[]);const xe=Ve=>/^\d{6}\/[A-Z]{2}$/.test(Ve),ue=Ve=>/^\d{6}\/[A-Z]{2}\/[A-Z]{1,2}\/\d{2}$/.test(Ve),ye=async()=>{f(!0);try{const Ve=sessionStorage.getItem("token"),Je=await Le.get("/api/data/parents",{headers:{Authorization:Ve}});o(Array.isArray(Je.data)?Je.data:[])}catch(Ve){console.error("Error fetching parents:",Ve)}finally{f(!1)}},Y=async()=>{try{const Ve=sessionStorage.getItem("token"),Je=await Le.get("/api/data/alldoctors",{headers:{Authorization:Ve}});z(Array.isArray(Je.data)?Je.data:[])}catch(Ve){console.error("Error fetching doctors:",Ve)}},ce=async()=>{try{const Ve=sessionStorage.getItem("token");if(!Ve)throw new Error("Authentication token not found");const mt=Nr(Ve).user.centreId,yt=await Le.get("/api/data/allTherapists/".concat(mt),{headers:{Authorization:Ve}});Z(yt.data.therapists.map(Vt=>({id:Vt._id,name:Vt.name})))}catch(Ve){console.error("Error fetching doctors:",Ve)}},re=Ve=>{n({...t,[Ve.target.name]:Ve.target.value})},ke=async Ve=>{var Je,mt;if(Ve.preventDefault(),!t.name||!t.mobilenumber){Be.error("Please fill Parent Name and Mobile Number");return}N(!0);try{const yt=sessionStorage.getItem("token");let Vt=sessionStorage.getItem("centreId");if(!Vt&&yt){const jt=Nr(yt);Vt=(Je=jt==null?void 0:jt.user)==null?void 0:Je.centreId}if(!Vt){Be.error("Centre ID not found. Please log in again."),N(!1);return}const Dt={...t,role:"parent",centreId:Vt},Kt=(await Le.post("/api/admins/register",Dt,{headers:{Authorization:yt,"Content-Type":"application/json"}})).data.user;Be.success("Parent Account Created Successfully!"),o(jt=>[...jt,Kt]),c(Kt._id),h(Kt),e(2)}catch(yt){console.error("Registration error:",yt);const Vt=((mt=yt.response)==null?void 0:mt.data)||"Error creating parent";Be.error(typeof Vt=="string"?Vt:"Registration failed")}finally{N(!1)}},Me=Ve=>{const{name:Je,value:mt}=Ve.target;b({...g,[Je]:mt})},Ue=()=>$(Ve=>[...Ve,{id:Date.now(),type:"",file:null}]),He=(Ve,Je)=>$(mt=>mt.map(yt=>yt.id===Ve?{...yt,type:Je}:yt)),We=(Ve,Je)=>{if(Je.size>50*1024*1024){Be.error("Max 50MB");return}$(mt=>mt.map(yt=>yt.id===Ve?{...yt,file:Je}:yt))},je=Ve=>$(Je=>Je.filter(mt=>mt.id!==Ve)),Xe=Ve=>{const Je=Ve.target.files[0];if(Je&&Je.size>5*1024*1024){Be.error("Profile picture size should not exceed 5MB"),pe(null);return}pe(Je)},st=async(Ve,Je,mt)=>{const yt=new FormData;yt.append("report",Ve),yt.append("reportType",Je),await Le.post("/api/admins/uploadChildReport/".concat(mt),yt,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}})},St=()=>{const Ve={};return i||(Ve.parent="Please select a parent"),g.childName.trim()||(Ve.childName="Child name is required"),g.childDob||(Ve.childDob="Date of birth is required"),g.childGender||(Ve.childGender="Gender is required"),Ve},pt=async Ve=>{var Je,mt;if(Ve.preventDefault(),!xe(Q)){Be.error("Invalid Registration ID format");return}if(!ue(we)){Be.error("Invalid Case ID format");return}if(!g.childName||!g.childDob||!g.childGender){Be.error("Please fill all child details");return}N(!0);try{const yt=St();if(Object.keys(yt).length>0){v(yt),N(!1),Be.error("Please fix the validation errors before submitting");return}const Vt=sessionStorage.getItem("centreId");if(!Vt){Be.error("Centre ID not found in session storage"),N(!1);return}let Dt="pending";(A||q)&&(Dt="active");const zt={name:g.childName,dob:g.childDob,gender:g.childGender,schoolName:g.childSchoolName||"",schoolBoard:g.childSchoolBoard||"",doctorId:A,therapistId:q,centreId:Vt,registrationId:Q,caseId:we,admitStatus:Dt},jt=(await Le.post("/api/admins/addChild?parentId=".concat(i),{childData:zt},{headers:{"Content-Type":"application/json",Authorization:"".concat(sessionStorage.getItem("token"))}})).data.child._id;if(ve){const Ls=new FormData;Ls.append("profilePicture",ve),await Le.post("/api/admins/uploadProfilePicture/".concat(jt),Ls,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}})}L(!0);try{for(const Ls of T)!Ls.file||!Ls.type||await st(Ls.file,Ls.type,jt)}finally{L(!1)}Be.success("Child registered successfully with all files!"),I(!0),b({childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),$([]),pe(null),c(""),h(null)}catch(yt){console.error("Registration error:",yt),Be.error(((mt=(Je=yt.response)==null?void 0:Je.data)==null?void 0:mt.message)||"Failed to register child")}finally{N(!1)}};return C?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg text-center border-t-4 border-red-800",children:[r.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Registration Complete!"}),r.jsx("button",{onClick:()=>{I(!1),e(1)},className:"mt-6 bg-[#ab1c1c] text-white px-6 py-2 rounded-lg",children:"Add Another"})]})}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{}),r.jsx("div",{className:"max-w-4xl w-full bg-white rounded-xl shadow-xl overflow-hidden mb-20 border-2 border-red-800",children:r.jsx("div",{className:"px-6 py-8",children:s===1?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-2xl font-extrabold text-[#ab1c1c]",children:"Register Parent for Existing Child"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the parent details to import child records"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx("input",{type:"text",name:"mobilenumber",placeholder:"Mobile Number",onChange:re,className:"p-2 border border-gray-300 rounded-lg w-full"}),r.jsx("input",{type:"text",name:"name",placeholder:"Full Name",onChange:re,className:"p-2 border border-gray-300 rounded-lg w-full"}),r.jsx("select",{disabled:!0,className:"p-2 border border-gray-300 rounded-lg bg-gray-100",children:r.jsx("option",{children:"Role: Parent"})}),r.jsx("input",{type:"text",disabled:!0,value:"Password: total12345678",className:"p-2 border border-gray-300 rounded-lg bg-gray-100"})]}),r.jsx("textarea",{name:"address",placeholder:"Full Address",onChange:re,className:"w-full p-2 border border-gray-300 rounded-lg",rows:"3"}),r.jsx("button",{onClick:ke,className:"w-full bg-[#ab1c1c] text-white py-3 rounded-lg font-bold hover:bg-[#8e1818]",disabled:w,children:w?"Creating Parent...":"Add Child"})]}):r.jsxs("form",{className:"space-y-6",onSubmit:pt,children:[r.jsx("button",{type:"button",onClick:()=>e(1),className:"text-red-600 hover:underline decoration-red-600 transition-all",children:"Back"}),r.jsx("div",{className:"text-center",children:r.jsx("h2",{className:"text-2xl font-extrabold text-[#ab1c1c]",children:"Import Existing Child Record"})}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Selected Parent Details"}),r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",u==null?void 0:u.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Mobile:"})," ",u==null?void 0:u.mobilenumber]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Address:"})," ",u==null?void 0:u.address]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Case Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Doctor"}),r.jsxs("select",{value:A,onChange:Ve=>U(Ve.target.value),className:"w-full p-2 border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:"Select Doctor"}),O.map(Ve=>r.jsx("option",{value:Ve._id,children:Ve.name},Ve._id))]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Therapist"}),r.jsxs("select",{value:q,onChange:Ve=>B(Ve.target.value),className:"w-full p-2 border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:"Select Therapist"}),X.map(Ve=>r.jsx("option",{value:Ve.id,children:Ve.name},Ve.id))]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Branch"}),r.jsxs("select",{value:K,onChange:Ve=>J(Ve.target.value),className:"w-full p-2 border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:"Select Branch"}),Object.keys(D8).map(Ve=>r.jsx("option",{value:Ve,children:Ve},Ve))]})]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Child Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Registration ID"}),r.jsx("input",{type:"text",placeholder:"MMYY##/DR",value:Q,onChange:Ve=>ae(Ve.target.value.toUpperCase()),className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Case ID"}),r.jsx("input",{type:"text",placeholder:"MMYY##/DR/BR/##",value:we,onChange:Ve=>Ce(Ve.target.value.toUpperCase()),className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Child Name"}),r.jsx("input",{type:"text",name:"childName",placeholder:"Enter child name",onChange:Me,className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"childDob",onChange:Me,className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Gender"}),r.jsxs("select",{name:"childGender",onChange:Me,className:"p-2 border rounded-lg",children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Profile Picture"}),r.jsx("input",{type:"file",accept:"image/*",onChange:Xe,className:"p-2 border rounded-lg"})]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"font-semibold text-red-700 mb-3",children:"School Information"}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[r.jsx("input",{type:"text",name:"childSchoolName",placeholder:"School Name",onChange:Me,className:"p-2 border rounded"}),r.jsxs("select",{name:"childSchoolBoard",onChange:Me,className:"p-2 border rounded",children:[r.jsx("option",{value:"",children:"Select Board (Optional)"}),R8.map(Ve=>r.jsx("option",{value:Ve,children:Ve},Ve))]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Associated Files"}),T.map(Ve=>r.jsxs("div",{className:"flex gap-2 mb-2 items-end",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-1/4",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Report Type"}),r.jsxs("select",{onChange:Je=>He(Ve.id,Je.target.value),className:"p-2 border rounded",children:[r.jsx("option",{value:"",children:"Select"}),E.map(Je=>r.jsx("option",{value:Je,children:Je},Je))]})]}),r.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Upload File"}),r.jsx("input",{type:"file",onChange:Je=>We(Ve.id,Je.target.files[0]),className:"p-2 border rounded"})]}),r.jsx("button",{type:"button",onClick:()=>je(Ve.id),className:"text-red-600 mb-2",children:""})]},Ve.id)),r.jsx("button",{type:"button",onClick:Ue,className:"bg-gray-200 px-3 py-1 rounded",children:"+ Add File"})]}),r.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 bg-[#ab1c1c] text-white rounded-lg font-bold mt-4",children:w?"Processing...":"Register Child"})]})})})]})}function O8(){const s=F.useRef(),[e,t]=F.useState(!1),[n,a]=F.useState(!0);return F.useEffect(()=>{s.current&&(t(s.current.getMobile()),a(s.current.getIsOpen()))},[]),r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(E8,{ref:s,onStateChange:({isMobile:o,isOpen:i})=>{t(o),a(i)}}),r.jsx("div",{className:"transition-all duration-300 ".concat(!e&&n?"ml-64":""),children:r.jsxs(og,{children:[r.jsx(tt,{path:"/",element:r.jsx(zF,{})}),r.jsx(tt,{path:"/register",element:r.jsx(GF,{})}),r.jsx(tt,{path:"/existingusers",element:r.jsx(_8,{})}),r.jsx(tt,{path:"/viewappointment",element:r.jsx(HF,{})}),r.jsx(tt,{path:"/manageappointment",element:r.jsx(I8,{})}),r.jsx(tt,{path:"/jwlenquiries",element:r.jsx($8,{})}),r.jsx(tt,{path:"/jwlenquiries/:referenceId",element:r.jsx(x8,{})}),r.jsx(tt,{path:"/child/:childId",element:r.jsx(p8,{})}),r.jsx(tt,{path:"/appointment",element:r.jsx(UF,{})}),r.jsx(tt,{path:"/iepreports/:childId",element:r.jsx(g8,{})}),r.jsx(tt,{path:"*",element:r.jsx(Eo,{to:"/admindashboard",replace:!0})})]})})]})}var i1={},S4;function F8(){return S4||(S4=1,(function(){var s;function e(k){var R=0;return function(){return R<k.length?{done:!1,value:k[R++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(k,R,P){return k==Array.prototype||k==Object.prototype||(k[R]=P.value),k};function n(k){k=[typeof globalThis=="object"&&globalThis,k,typeof window=="object"&&window,typeof self=="object"&&self,typeof i4=="object"&&i4];for(var R=0;R<k.length;++R){var P=k[R];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var a=n(this);function o(k,R){if(R)e:{var P=a;k=k.split(".");for(var H=0;H<k.length-1;H++){var se=k[H];if(!(se in P))break e;P=P[se]}k=k[k.length-1],H=P[k],R=R(H),R!=H&&R!=null&&t(P,k,{configurable:!0,writable:!0,value:R})}}o("Symbol",function(k){function R(fe){if(this instanceof R)throw new TypeError("Symbol is not a constructor");return new P(H+(fe||"")+"_"+se++,fe)}function P(fe,ie){this.g=fe,t(this,"description",{configurable:!0,writable:!0,value:ie})}if(k)return k;P.prototype.toString=function(){return this.g};var H="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",se=0;return R}),o("Symbol.iterator",function(k){if(k)return k;k=Symbol("Symbol.iterator");for(var R="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),P=0;P<R.length;P++){var H=a[R[P]];typeof H=="function"&&typeof H.prototype[k]!="function"&&t(H.prototype,k,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return k});function i(k){return k={next:k},k[Symbol.iterator]=function(){return this},k}function c(k){var R=typeof Symbol<"u"&&Symbol.iterator&&k[Symbol.iterator];return R?R.call(k):{next:e(k)}}function u(k){if(!(k instanceof Array)){k=c(k);for(var R,P=[];!(R=k.next()).done;)P.push(R.value);k=P}return k}var h=typeof Object.create=="function"?Object.create:function(k){function R(){}return R.prototype=k,new R},p;if(typeof Object.setPrototypeOf=="function")p=Object.setPrototypeOf;else{var f;e:{var g={a:!0},b={};try{b.__proto__=g,f=b.a;break e}catch(k){}f=!1}p=f?function(k,R){if(k.__proto__=R,k.__proto__!==R)throw new TypeError(k+" is not extensible");return k}:null}var y=p;function v(k,R){if(k.prototype=h(R.prototype),k.prototype.constructor=k,y)y(k,R);else for(var P in R)if(P!="prototype")if(Object.defineProperties){var H=Object.getOwnPropertyDescriptor(R,P);H&&Object.defineProperty(k,P,H)}else k[P]=R[P];k.na=R.prototype}function w(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function N(k){if(k.l)throw new TypeError("Generator is already running");k.l=!0}w.prototype.s=function(k){this.h=k};function C(k,R){k.j={da:R,ea:!0},k.g=k.o||k.u}w.prototype.return=function(k){this.j={return:k},this.g=this.u};function I(k,R,P){return k.g=P,{value:R}}function T(k){this.g=new w,this.h=k}function $(k,R){N(k.g);var P=k.g.i;return P?E(k,"return"in P?P.return:function(H){return{value:H,done:!0}},R,k.g.return):(k.g.return(R),_(k))}function E(k,R,P,H){try{var se=R.call(k.g.i,P);if(!(se instanceof Object))throw new TypeError("Iterator result "+se+" is not an object");if(!se.done)return k.g.l=!1,se;var fe=se.value}catch(ie){return k.g.i=null,C(k.g,ie),_(k)}return k.g.i=null,H.call(k.g,fe),_(k)}function _(k){for(;k.g.g;)try{var R=k.h(k.g);if(R)return k.g.l=!1,{value:R.value,done:!1}}catch(P){k.g.h=void 0,C(k.g,P)}if(k.g.l=!1,k.g.j){if(R=k.g.j,k.g.j=null,R.ea)throw R.da;return{value:R.return,done:!0}}return{value:void 0,done:!0}}function L(k){this.next=function(R){return N(k.g),k.g.i?R=E(k,k.g.i.next,R,k.g.s):(k.g.s(R),R=_(k)),R},this.throw=function(R){return N(k.g),k.g.i?R=E(k,k.g.i.throw,R,k.g.s):(C(k.g,R),R=_(k)),R},this.return=function(R){return $(k,R)},this[Symbol.iterator]=function(){return this}}function O(k){function R(H){return k.next(H)}function P(H){return k.throw(H)}return new Promise(function(H,se){function fe(ie){ie.done?H(ie.value):Promise.resolve(ie.value).then(R,P).then(fe,se)}fe(k.next())})}function z(k){return O(new L(new T(k)))}o("Promise",function(k){function R(ie){this.h=0,this.i=void 0,this.g=[],this.s=!1;var Ie=this.j();try{ie(Ie.resolve,Ie.reject)}catch(De){Ie.reject(De)}}function P(){this.g=null}function H(ie){return ie instanceof R?ie:new R(function(Ie){Ie(ie)})}if(k)return k;P.prototype.h=function(ie){if(this.g==null){this.g=[];var Ie=this;this.i(function(){Ie.l()})}this.g.push(ie)};var se=a.setTimeout;P.prototype.i=function(ie){se(ie,0)},P.prototype.l=function(){for(;this.g&&this.g.length;){var ie=this.g;this.g=[];for(var Ie=0;Ie<ie.length;++Ie){var De=ie[Ie];ie[Ie]=null;try{De()}catch(Ge){this.j(Ge)}}}this.g=null},P.prototype.j=function(ie){this.i(function(){throw ie})},R.prototype.j=function(){function ie(Ge){return function(ot){De||(De=!0,Ge.call(Ie,ot))}}var Ie=this,De=!1;return{resolve:ie(this.D),reject:ie(this.l)}},R.prototype.D=function(ie){if(ie===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(ie instanceof R)this.H(ie);else{e:switch(typeof ie){case"object":var Ie=ie!=null;break e;case"function":Ie=!0;break e;default:Ie=!1}Ie?this.A(ie):this.o(ie)}},R.prototype.A=function(ie){var Ie=void 0;try{Ie=ie.then}catch(De){this.l(De);return}typeof Ie=="function"?this.I(Ie,ie):this.o(ie)},R.prototype.l=function(ie){this.u(2,ie)},R.prototype.o=function(ie){this.u(1,ie)},R.prototype.u=function(ie,Ie){if(this.h!=0)throw Error("Cannot settle("+ie+", "+Ie+"): Promise already settled in state"+this.h);this.h=ie,this.i=Ie,this.h===2&&this.G(),this.B()},R.prototype.G=function(){var ie=this;se(function(){if(ie.C()){var Ie=a.console;typeof Ie<"u"&&Ie.error(ie.i)}},1)},R.prototype.C=function(){if(this.s)return!1;var ie=a.CustomEvent,Ie=a.Event,De=a.dispatchEvent;return typeof De>"u"?!0:(typeof ie=="function"?ie=new ie("unhandledrejection",{cancelable:!0}):typeof Ie=="function"?ie=new Ie("unhandledrejection",{cancelable:!0}):(ie=a.document.createEvent("CustomEvent"),ie.initCustomEvent("unhandledrejection",!1,!0,ie)),ie.promise=this,ie.reason=this.i,De(ie))},R.prototype.B=function(){if(this.g!=null){for(var ie=0;ie<this.g.length;++ie)fe.h(this.g[ie]);this.g=null}};var fe=new P;return R.prototype.H=function(ie){var Ie=this.j();ie.M(Ie.resolve,Ie.reject)},R.prototype.I=function(ie,Ie){var De=this.j();try{ie.call(Ie,De.resolve,De.reject)}catch(Ge){De.reject(Ge)}},R.prototype.then=function(ie,Ie){function De(wt,ct){return typeof wt=="function"?function(Tt){try{Ge(wt(Tt))}catch(Ut){ot(Ut)}}:ct}var Ge,ot,vt=new R(function(wt,ct){Ge=wt,ot=ct});return this.M(De(ie,Ge),De(Ie,ot)),vt},R.prototype.catch=function(ie){return this.then(void 0,ie)},R.prototype.M=function(ie,Ie){function De(){switch(Ge.h){case 1:ie(Ge.i);break;case 2:Ie(Ge.i);break;default:throw Error("Unexpected state: "+Ge.h)}}var Ge=this;this.g==null?fe.h(De):this.g.push(De),this.s=!0},R.resolve=H,R.reject=function(ie){return new R(function(Ie,De){De(ie)})},R.race=function(ie){return new R(function(Ie,De){for(var Ge=c(ie),ot=Ge.next();!ot.done;ot=Ge.next())H(ot.value).M(Ie,De)})},R.all=function(ie){var Ie=c(ie),De=Ie.next();return De.done?H([]):new R(function(Ge,ot){function vt(Tt){return function(Ut){wt[Tt]=Ut,ct--,ct==0&&Ge(wt)}}var wt=[],ct=0;do wt.push(void 0),ct++,H(De.value).M(vt(wt.length-1),ot),De=Ie.next();while(!De.done)})},R});function A(k,R){k instanceof String&&(k+="");var P=0,H=!1,se={next:function(){if(!H&&P<k.length){var fe=P++;return{value:R(fe,k[fe]),done:!1}}return H=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}var U=typeof Object.assign=="function"?Object.assign:function(k,R){for(var P=1;P<arguments.length;P++){var H=arguments[P];if(H)for(var se in H)Object.prototype.hasOwnProperty.call(H,se)&&(k[se]=H[se])}return k};o("Object.assign",function(k){return k||U}),o("Object.is",function(k){return k||function(R,P){return R===P?R!==0||1/R===1/P:R!==R&&P!==P}}),o("Array.prototype.includes",function(k){return k||function(R,P){var H=this;H instanceof String&&(H=String(H));var se=H.length;for(P=P||0,0>P&&(P=Math.max(P+se,0));P<se;P++){var fe=H[P];if(fe===R||Object.is(fe,R))return!0}return!1}}),o("String.prototype.includes",function(k){return k||function(R,P){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(R instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(R,P||0)!==-1}}),o("Array.prototype.keys",function(k){return k||function(){return A(this,function(R){return R})}});var X=this||self;function Z(k,R){k=k.split(".");var P=X;k[0]in P||typeof P.execScript>"u"||P.execScript("var "+k[0]);for(var H;k.length&&(H=k.shift());)k.length||R===void 0?P[H]&&P[H]!==Object.prototype[H]?P=P[H]:P=P[H]={}:P[H]=R}function q(){throw Error("Invalid UTF8")}function B(k,R){return R=String.fromCharCode.apply(null,R),k==null?R:k+R}var K,J=typeof TextDecoder<"u",Q,ae=typeof TextEncoder<"u",we={},Ce=null;function ve(k){var R;R===void 0&&(R=0),ue(),R=we[R];for(var P=Array(Math.floor(k.length/3)),H=R[64]||"",se=0,fe=0;se<k.length-2;se+=3){var ie=k[se],Ie=k[se+1],De=k[se+2],Ge=R[ie>>2];ie=R[(ie&3)<<4|Ie>>4],Ie=R[(Ie&15)<<2|De>>6],De=R[De&63],P[fe++]=Ge+ie+Ie+De}switch(Ge=0,De=H,k.length-se){case 2:Ge=k[se+1],De=R[(Ge&15)<<2]||H;case 1:k=k[se],P[fe]=R[k>>2]+R[(k&3)<<4|Ge>>4]+De+H}return P.join("")}function pe(k){var R=k.length,P=3*R/4;P%3?P=Math.floor(P):"=.".indexOf(k[R-1])!=-1&&(P="=.".indexOf(k[R-2])!=-1?P-2:P-1);var H=new Uint8Array(P),se=0;return xe(k,function(fe){H[se++]=fe}),se!==P?H.subarray(0,se):H}function xe(k,R){function P(De){for(;H<k.length;){var Ge=k.charAt(H++),ot=Ce[Ge];if(ot!=null)return ot;if(!/^[\s\xa0]*$/.test(Ge))throw Error("Unknown base64 encoding at char: "+Ge)}return De}ue();for(var H=0;;){var se=P(-1),fe=P(0),ie=P(64),Ie=P(64);if(Ie===64&&se===-1)break;R(se<<2|fe>>4),ie!=64&&(R(fe<<4&240|ie>>2),Ie!=64&&R(ie<<6&192|Ie))}}function ue(){if(!Ce){Ce={};for(var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),R=["+/=","+/","-_=","-_.","-_"],P=0;5>P;P++){var H=k.concat(R[P].split(""));we[P]=H;for(var se=0;se<H.length;se++){var fe=H[se];Ce[fe]===void 0&&(Ce[fe]=se)}}}}var ye=typeof Uint8Array=="function";function Y(k){return ye&&k!=null&&k instanceof Uint8Array}var ce;function re(k){if(this.L=k,k!==null&&k.length===0)throw Error("ByteString should be constructed with non-empty values")}var ke=typeof Uint8Array.prototype.slice=="function",Me=0,Ue=0;function He(k,R){if(k.constructor===Uint8Array)return k;if(k.constructor===ArrayBuffer)return new Uint8Array(k);if(k.constructor===Array)return new Uint8Array(k);if(k.constructor===String)return pe(k);if(k.constructor===re)return!R&&(R=k.L)&&R.constructor===Uint8Array?R:(R=k.L,R=R==null||Y(R)?R:typeof R=="string"?pe(R):null,(k=k.L=R)?new Uint8Array(k):ce||(ce=new Uint8Array(0)));if(k instanceof Uint8Array)return new Uint8Array(k.buffer,k.byteOffset,k.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}function We(k,R){return Error("Invalid wire type: "+k+" (at position "+R+")")}function je(){return Error("Failed to read varint, encoding is invalid.")}function Xe(k,R){R=R===void 0?{}:R,R=R.v===void 0?!1:R.v,this.h=null,this.g=this.i=this.j=0,this.v=R,k&&st(this,k)}function st(k,R){k.h=He(R,k.v),k.j=0,k.i=k.h.length,k.g=k.j}Xe.prototype.reset=function(){this.g=this.j};function St(k){if(k.g>k.i)throw Error("Tried to read past the end of the data "+k.g+" > "+k.i)}function pt(k){var R=k.h,P=R[k.g],H=P&127;if(128>P)return k.g+=1,St(k),H;if(P=R[k.g+1],H|=(P&127)<<7,128>P)return k.g+=2,St(k),H;if(P=R[k.g+2],H|=(P&127)<<14,128>P)return k.g+=3,St(k),H;if(P=R[k.g+3],H|=(P&127)<<21,128>P)return k.g+=4,St(k),H;if(P=R[k.g+4],k.g+=5,H|=(P&15)<<28,128>P)return St(k),H;if(128<=R[k.g++]&&128<=R[k.g++]&&128<=R[k.g++]&&128<=R[k.g++]&&128<=R[k.g++])throw je();return St(k),H}var Ve=[];function Je(){this.g=[]}Je.prototype.length=function(){return this.g.length},Je.prototype.end=function(){var k=this.g;return this.g=[],k};function mt(k,R){for(;127<R;)k.g.push(R&127|128),R>>>=7;k.g.push(R)}function yt(k){var R={},P=R.W===void 0?!1:R.W;this.l={v:R.v===void 0?!1:R.v},this.W=P,R=this.l,Ve.length?(P=Ve.pop(),R&&(P.v=R.v),k&&st(P,k),k=P):k=new Xe(k,R),this.g=k,this.j=this.g.g,this.h=this.i=-1}yt.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};function Vt(k){var R=k.g;if(R.g==R.i)return!1;k.j=k.g.g;var P=pt(k.g)>>>0;if(R=P>>>3,P&=7,!(0<=P&&5>=P))throw We(P,k.j);if(1>R)throw Error("Invalid field number: "+R+" (at position "+k.j+")");return k.i=R,k.h=P,!0}function Dt(k){switch(k.h){case 0:if(k.h!=0)Dt(k);else e:{k=k.g;for(var R=k.g,P=R+10;R<P;)if((k.h[R++]&128)===0){k.g=R,St(k);break e}throw je()}break;case 1:k=k.g,k.g+=8,St(k);break;case 2:k.h!=2?Dt(k):(R=pt(k.g)>>>0,k=k.g,k.g+=R,St(k));break;case 5:k=k.g,k.g+=4,St(k);break;case 3:R=k.i;do{if(!Vt(k))throw Error("Unmatched start-group tag: stream EOF");if(k.h==4){if(k.i!=R)throw Error("Unmatched end-group tag");break}Dt(k)}while(!0);break;default:throw We(k.h,k.j)}}var zt=[];function Kt(){this.i=[],this.h=0,this.g=new Je}function jt(k,R){R.length!==0&&(k.i.push(R),k.h+=R.length)}function Ls(k,R){if(R=R.ba){jt(k,k.g.end());for(var P=0;P<R.length;P++)jt(k,R[P])}}var Hn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function Dr(k,R){Object.isFrozen(k)||(Hn?k[Hn]|=R:k.N!==void 0?k.N|=R:Object.defineProperties(k,{N:{value:R,configurable:!0,writable:!0,enumerable:!1}}))}function aa(k){var R;return Hn?R=k[Hn]:R=k.N,R==null?0:R}function ra(k){return Dr(k,1),k}function sn(k){return Array.isArray(k)?!!(aa(k)&2):!1}function Rr(k){if(!Array.isArray(k))throw Error("cannot mark non-array as immutable");Dr(k,2)}function _r(k){return k!==null&&typeof k=="object"&&!Array.isArray(k)&&k.constructor===Object}var oa=Object.freeze(ra([]));function sl(k){if(sn(k.m))throw Error("Cannot mutate an immutable Message")}var nl=typeof Symbol<"u"&&typeof Symbol.hasInstance<"u";function Ko(k){return{value:k,configurable:!1,writable:!1,enumerable:!1}}function nn(k,R,P){return R===-1?null:R>=k.i?k.g?k.g[R]:void 0:P!==void 0&&P&&k.g&&(P=k.g[R],P!=null)?P:k.m[R+k.h]}function Ns(k,R,P,H){H=H===void 0?!1:H,sl(k),R<k.i&&!H?k.m[R+k.h]=P:(k.g||(k.g=k.m[k.i+k.h]={}))[R]=P}function al(k,R,P,H){P=P===void 0?!0:P,H=H===void 0?!1:H;var se=nn(k,R,H);return se==null&&(se=oa),sn(k.m)?P&&(Rr(se),Object.freeze(se)):(se===oa||sn(se))&&(se=ra(se.slice()),Ns(k,R,se,H)),se}function qn(k,R,P){return k=nn(k,R),k=k==null?k:+k,k==null?P===void 0?0:P:k}function Or(k,R,P,H){k.j||(k.j={});var se=sn(k.m),fe=k.j[P];if(!fe){H=al(k,P,!0,H===void 0?!1:H),fe=[],se=se||sn(H);for(var ie=0;ie<H.length;ie++)fe[ie]=new R(H[ie]),se&&Rr(fe[ie].m);se&&(Rr(fe),Object.freeze(fe)),k.j[P]=fe}return fe}function Re(k,R,P,H,se){var fe=fe===void 0?!1:fe;return sl(k),fe=Or(k,P,R,fe),P=H||new P,k=al(k,R),se!=null?(fe.splice(se,0,P),k.splice(se,0,P.m)):(fe.push(P),k.push(P.m)),P}function Qe(k,R){return k=nn(k,R),k==null?0:k}function Rn(k,R){return k=nn(k,R),k==null?"":k}function an(k){switch(typeof k){case"number":return isFinite(k)?k:String(k);case"object":if(k&&!Array.isArray(k)){if(Y(k))return ve(k);if(k instanceof re){var R=k.L;return R=R==null||typeof R=="string"?R:ye&&R instanceof Uint8Array?ve(R):null,(k.L=R)||""}}}return k}function Ss(k){var R=io;return R=R===void 0?Ku:R,za(k,R)}function Cs(k,R){if(k!=null){if(Array.isArray(k))k=za(k,R);else if(_r(k)){var P={},H;for(H in k)P[H]=Cs(k[H],R);k=P}else k=R(k);return k}}function za(k,R){for(var P=k.slice(),H=0;H<P.length;H++)P[H]=Cs(P[H],R);return Array.isArray(k)&&aa(k)&1&&ra(P),P}function io(k){return k&&typeof k=="object"&&k.toJSON?k.toJSON():(k=an(k),Array.isArray(k)?Ss(k):k)}function Ku(k){return Y(k)?new Uint8Array(k):k}function uc(k,R,P){k||(k=Xu),Xu=null;var H=this.constructor.h;k||(k=H?[H]:[]),this.h=(H?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=k;e:{if(H=this.m.length,k=H-1,H&&(H=this.m[k],_r(H))){this.i=k-this.h,this.g=H;break e}R!==void 0&&-1<R?(this.i=Math.max(R,k+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE}if(P)for(R=0;R<P.length;R++)if(k=P[R],k<this.i)k+=this.h,(H=this.m[k])?Array.isArray(H)&&ra(H):this.m[k]=oa;else{H=this.g||(this.g=this.m[this.i+this.h]={});var se=H[k];se?Array.isArray(se)&&ra(se):H[k]=oa}}uc.prototype.toJSON=function(){return Ss(this.m)},uc.prototype.toString=function(){return this.m.toString()};var Xu;function Fr(){uc.apply(this,arguments)}if(v(Fr,uc),nl){var dc={};Object.defineProperties(Fr,(dc[Symbol.hasInstance]=Ko(function(){throw Error("Cannot perform instanceof checks for MutableMessage")}),dc))}function lo(k,R,P){if(P){var H={},se;for(se in P){var fe=P[se],ie=fe.ha;ie||(H.F=fe.la||fe.fa.P,fe.aa?(H.U=uo(fe.aa),ie=function(Ie){return function(De,Ge,ot){return Ie.F(De,Ge,ot,Ie.U)}}(H)):fe.ca?(H.T=Xp(fe.X.g,fe.ca),ie=function(Ie){return function(De,Ge,ot){return Ie.F(De,Ge,ot,Ie.T)}}(H)):ie=H.F,fe.ha=ie),ie(R,k,fe.X),H={F:H.F,U:H.U,T:H.T}}}Ls(R,k)}var fr=Symbol();function Xo(k,R,P){return k[fr]||(k[fr]=function(H,se){return R(H,se,P)})}function co(k){var R=k[fr];if(!R){var P=Qp(k);R=function(H,se){return ed(H,se,P)},k[fr]=R}return R}function Us(k){var R=k.aa;if(R)return co(R);if(R=k.ka)return Xo(k.X.g,R,k.ca)}function Kp(k){var R=Us(k),P=k.X,H=k.fa.O;return R?function(se,fe){return H(se,fe,P,R)}:function(se,fe){return H(se,fe,P)}}function Yu(k,R,P,H,se,fe){k=k();var ie=0;for(k.length&&typeof k[0]!="number"&&(P(R,k[0]),ie++);ie<k.length;){P=k[ie++];for(var Ie=ie+1;Ie<k.length&&typeof k[Ie]!="number";)Ie++;var De=k[ie++];switch(Ie-=ie,Ie){case 0:H(R,P,De);break;case 1:H(R,P,De,k[ie++]);break;case 2:se(R,P,De,k[ie++],k[ie++]);break;case 3:Ie=k[ie++];var Ge=k[ie++],ot=k[ie++];Array.isArray(ot)?se(R,P,De,Ie,Ge,ot):fe(R,P,De,Ie,Ge,ot);break;case 4:fe(R,P,De,k[ie++],k[ie++],k[ie++],k[ie++]);break;default:throw Error("unexpected number of binary field arguments: "+Ie)}}return R}var Pa=Symbol();function uo(k){var R=k[Pa];if(!R){var P=Ba(k);R=function(H,se){return td(H,se,P)},k[Pa]=R}return R}function Xp(k,R){var P=k[Pa];return P||(P=function(H,se){return lo(H,se,R)},k[Pa]=P),P}var Zu=Symbol();function Yp(k,R){k.push(R)}function s0(k,R,P){k.push(R,P.P)}function hc(k,R,P,H,se){var fe=uo(se),ie=P.P;k.push(R,function(Ie,De,Ge){return ie(Ie,De,Ge,H,fe)})}function pc(k,R,P,H,se,fe){var ie=Xp(H,fe),Ie=P.P;k.push(R,function(De,Ge,ot){return Ie(De,Ge,ot,H,ie)})}function Ba(k){var R=k[Zu];return R||Yu(k,k[Zu]=[],Yp,s0,hc,pc)}var fc=Symbol();function Zp(k,R){k[0]=R}function Yo(k,R,P,H){var se=P.O;k[R]=H?function(fe,ie,Ie){return se(fe,ie,Ie,H)}:se}function Qu(k,R,P,H,se,fe){var ie=P.O,Ie=co(se);k[R]=function(De,Ge,ot){return ie(De,Ge,ot,H,Ie,fe)}}function Ju(k,R,P,H,se,fe,ie){var Ie=P.O,De=Xo(H,se,fe);k[R]=function(Ge,ot,vt){return Ie(Ge,ot,vt,H,De,ie)}}function Qp(k){var R=k[fc];return R||Yu(k,k[fc]={},Zp,Yo,Qu,Ju)}function ed(k,R,P){for(;Vt(R)&&R.h!=4;){var H=R.i,se=P[H];if(!se){var fe=P[0];fe&&(fe=fe[H])&&(se=P[H]=Kp(fe))}if((!se||!se(R,k,H))&&(se=R,H=k,fe=se.j,Dt(se),!se.W)){var ie=se.g.h;se=se.g.g,se=fe===se?ce||(ce=new Uint8Array(0)):ke?ie.slice(fe,se):new Uint8Array(ie.subarray(fe,se)),(fe=H.ba)?fe.push(se):H.ba=[se]}}return k}function _n(k,R,P){if(zt.length){var H=zt.pop();k&&(st(H.g,k),H.i=-1,H.h=-1),k=H}else k=new yt(k);try{return ed(new R,k,Qp(P))}finally{R=k.g,R.h=null,R.j=0,R.i=0,R.g=0,R.v=!1,k.i=-1,k.h=-1,100>zt.length&&zt.push(k)}}function td(k,R,P){for(var H=P.length,se=H%2==1,fe=se?1:0;fe<H;fe+=2)(0,P[fe+1])(R,k,P[fe]);lo(k,R,se?P[0]:void 0)}function sd(k,R){var P=new Kt;td(k,P,Ba(R)),jt(P,P.g.end()),k=new Uint8Array(P.h),R=P.i;for(var H=R.length,se=0,fe=0;fe<H;fe++){var ie=R[fe];k.set(ie,se),se+=ie.length}return P.i=[k],k}function Lr(k,R){return{O:k,P:R}}var ia=Lr(function(k,R,P){if(k.h!==5)return!1;k=k.g;var H=k.h[k.g],se=k.h[k.g+1],fe=k.h[k.g+2],ie=k.h[k.g+3];return k.g+=4,St(k),se=(H<<0|se<<8|fe<<16|ie<<24)>>>0,k=2*(se>>31)+1,H=se>>>23&255,se&=8388607,Ns(R,P,H==255?se?NaN:1/0*k:H==0?k*Math.pow(2,-149)*se:k*Math.pow(2,H-150)*(se+Math.pow(2,23))),!0},function(k,R,P){if(R=nn(R,P),R!=null){mt(k.g,8*P+5),k=k.g;var H=R;H=(P=0>H?1:0)?-H:H,H===0?0<1/H?Me=Ue=0:(Ue=0,Me=2147483648):isNaN(H)?(Ue=0,Me=2147483647):34028234663852886e22<H?(Ue=0,Me=(P<<31|2139095040)>>>0):11754943508222875e-54>H?(H=Math.round(H/Math.pow(2,-149)),Ue=0,Me=(P<<31|H)>>>0):(R=Math.floor(Math.log(H)/Math.LN2),H*=Math.pow(2,-R),H=Math.round(8388608*H),16777216<=H&&++R,Ue=0,Me=(P<<31|R+127<<23|H&8388607)>>>0),P=Me,k.g.push(P>>>0&255),k.g.push(P>>>8&255),k.g.push(P>>>16&255),k.g.push(P>>>24&255)}}),mc=Lr(function(k,R,P){if(k.h!==0)return!1;for(var H=k.g,se=128,fe=0,ie=k=0;4>ie&&128<=se;ie++)se=H.h[H.g++],St(H),fe|=(se&127)<<7*ie;if(128<=se&&(se=H.h[H.g++],St(H),fe|=(se&127)<<28,k|=(se&127)>>4),128<=se)for(ie=0;5>ie&&128<=se;ie++)se=H.h[H.g++],St(H),k|=(se&127)<<7*ie+3;if(128>se)H=fe>>>0,se=k>>>0,(k=se&2147483648)&&(H=~H+1>>>0,se=~se>>>0,H==0&&(se=se+1>>>0)),H=4294967296*se+(H>>>0);else throw je();return Ns(R,P,k?-H:H),!0},function(k,R,P){if(R=nn(R,P),R!=null&&R!=null){mt(k.g,8*P),k=k.g;var H=R;for(P=0>H,H=Math.abs(H),R=H>>>0,H=Math.floor((H-R)/4294967296),H>>>=0,P&&(H=~H>>>0,R=(~R>>>0)+1,4294967295<R&&(R=0,H++,4294967295<H&&(H=0))),Me=R,Ue=H,P=Me,R=Ue;0<R||127<P;)k.g.push(P&127|128),P=(P>>>7|R<<25)>>>0,R>>>=7;k.g.push(P)}}),n0=Lr(function(k,R,P){return k.h!==0?!1:(Ns(R,P,pt(k.g)),!0)},function(k,R,P){if(R=nn(R,P),R!=null&&R!=null)if(mt(k.g,8*P),k=k.g,P=R,0<=P)mt(k,P);else{for(R=0;9>R;R++)k.g.push(P&127|128),P>>=7;k.g.push(1)}}),Kn=Lr(function(k,R,P){if(k.h!==2)return!1;var H=pt(k.g)>>>0;k=k.g;var se=k.g;k.g+=H,St(k),k=k.h;var fe;if(J)(fe=K)||(fe=K=new TextDecoder("utf-8",{fatal:!0})),fe=fe.decode(k.subarray(se,se+H));else{H=se+H;for(var ie=[],Ie=null,De,Ge,ot;se<H;)De=k[se++],128>De?ie.push(De):224>De?se>=H?q():(Ge=k[se++],194>De||(Ge&192)!==128?(se--,q()):ie.push((De&31)<<6|Ge&63)):240>De?se>=H-1?q():(Ge=k[se++],(Ge&192)!==128||De===224&&160>Ge||De===237&&160<=Ge||((fe=k[se++])&192)!==128?(se--,q()):ie.push((De&15)<<12|(Ge&63)<<6|fe&63)):244>=De?se>=H-2?q():(Ge=k[se++],(Ge&192)!==128||(De<<28)+(Ge-144)>>30!==0||((fe=k[se++])&192)!==128||((ot=k[se++])&192)!==128?(se--,q()):(De=(De&7)<<18|(Ge&63)<<12|(fe&63)<<6|ot&63,De-=65536,ie.push((De>>10&1023)+55296,(De&1023)+56320))):q(),8192<=ie.length&&(Ie=B(Ie,ie),ie.length=0);fe=B(Ie,ie)}return Ns(R,P,fe),!0},function(k,R,P){if(R=nn(R,P),R!=null){var H=!1;if(H=H===void 0?!1:H,ae){if(H&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(R))throw Error("Found an unpaired surrogate");R=(Q||(Q=new TextEncoder)).encode(R)}else{for(var se=0,fe=new Uint8Array(3*R.length),ie=0;ie<R.length;ie++){var Ie=R.charCodeAt(ie);if(128>Ie)fe[se++]=Ie;else{if(2048>Ie)fe[se++]=Ie>>6|192;else{if(55296<=Ie&&57343>=Ie){if(56319>=Ie&&ie<R.length){var De=R.charCodeAt(++ie);if(56320<=De&&57343>=De){Ie=1024*(Ie-55296)+De-56320+65536,fe[se++]=Ie>>18|240,fe[se++]=Ie>>12&63|128,fe[se++]=Ie>>6&63|128,fe[se++]=Ie&63|128;continue}else ie--}if(H)throw Error("Found an unpaired surrogate");Ie=65533}fe[se++]=Ie>>12|224,fe[se++]=Ie>>6&63|128}fe[se++]=Ie&63|128}}R=fe.subarray(0,se)}mt(k.g,8*P+2),mt(k.g,R.length),jt(k,k.g.end()),jt(k,R)}}),gc=Lr(function(k,R,P,H,se){if(k.h!==2)return!1;R=Re(R,P,H),P=k.g.i,H=pt(k.g)>>>0;var fe=k.g.g+H,ie=fe-P;if(0>=ie&&(k.g.i=fe,se(R,k),ie=fe-k.g.g),ie)throw Error("Message parsing ended unexpectedly. Expected to read "+(H+" bytes, instead read "+(H-ie)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return k.g.g=fe,k.g.i=P,!0},function(k,R,P,H,se){if(R=Or(R,H,P),R!=null)for(H=0;H<R.length;H++){var fe=k;mt(fe.g,8*P+2);var ie=fe.g.end();jt(fe,ie),ie.push(fe.h),fe=ie,se(R[H],k),ie=k;var Ie=fe.pop();for(Ie=ie.h+ie.g.length()-Ie;127<Ie;)fe.push(Ie&127|128),Ie>>>=7,ie.h++;fe.push(Ie),ie.h++}});function Xn(){Fr.apply(this,arguments)}if(v(Xn,Fr),nl){var xc={};Object.defineProperties(Xn,(xc[Symbol.hasInstance]=Ko(Object[Symbol.hasInstance]),xc))}function Va(k){Xn.call(this,k)}v(Va,Xn);function nd(){return[1,n0,2,ia,3,Kn,4,Kn]}function bc(k){Xn.call(this,k,-1,a0)}v(bc,Xn),bc.prototype.addClassification=function(k,R){return Re(this,1,Va,k,R),this};function Zo(){return[1,gc,Va,nd]}var a0=[1];function rl(k){Xn.call(this,k)}v(rl,Xn);function ad(){return[1,ia,2,ia,3,ia,4,ia,5,ia]}function yc(k){Xn.call(this,k,-1,o0)}v(yc,Xn);function r0(){return[1,gc,rl,ad]}var o0=[1];function Qo(k){Xn.call(this,k)}v(Qo,Xn);function vc(){return[1,ia,2,ia,3,ia,4,ia,5,ia,6,mc]}var wc=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ho=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],po=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],rd=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Nc=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],od=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ol=[].concat(u(wc),u(ho),u(po),u(rd),u(Nc),u(od));function Ua(k,R,P){if(P=k.createShader(P===0?k.VERTEX_SHADER:k.FRAGMENT_SHADER),k.shaderSource(P,R),k.compileShader(P),!k.getShaderParameter(P,k.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+k.getShaderInfoLog(P));return P}function id(k){return Or(k,Va,1).map(function(R){return{index:Qe(R,1),ga:qn(R,2),label:nn(R,3)!=null?Rn(R,3):void 0,displayName:nn(R,4)!=null?Rn(R,4):void 0}})}function il(k){return{x:qn(k,1),y:qn(k,2),z:qn(k,3),visibility:nn(k,4)!=null?qn(k,4):void 0}}function Ga(k,R){this.h=k,this.g=R,this.l=0}function Sc(k,R,P){return Cc(k,R),typeof k.g.canvas.transferToImageBitmap=="function"?Promise.resolve(k.g.canvas.transferToImageBitmap()):P?Promise.resolve(k.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(k.g.canvas):(k.i===void 0&&(k.i=document.createElement("canvas")),new Promise(function(H){k.i.height=k.g.canvas.height,k.i.width=k.g.canvas.width,k.i.getContext("2d",{}).drawImage(k.g.canvas,0,0,k.g.canvas.width,k.g.canvas.height),H(k.i)}))}function Cc(k,R){var P=k.g;if(k.o===void 0){var H=Ua(P,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),se=Ua(P,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),fe=P.createProgram();if(P.attachShader(fe,H),P.attachShader(fe,se),P.linkProgram(fe),!P.getProgramParameter(fe,P.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+P.getProgramInfoLog(fe));H=k.o=fe,P.useProgram(H),se=P.getUniformLocation(H,"sampler0"),k.j={K:P.getAttribLocation(H,"aVertex"),J:P.getAttribLocation(H,"aTex"),ma:se},k.u=P.createBuffer(),P.bindBuffer(P.ARRAY_BUFFER,k.u),P.enableVertexAttribArray(k.j.K),P.vertexAttribPointer(k.j.K,2,P.FLOAT,!1,0,0),P.bufferData(P.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),P.STATIC_DRAW),P.bindBuffer(P.ARRAY_BUFFER,null),k.s=P.createBuffer(),P.bindBuffer(P.ARRAY_BUFFER,k.s),P.enableVertexAttribArray(k.j.J),P.vertexAttribPointer(k.j.J,2,P.FLOAT,!1,0,0),P.bufferData(P.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),P.STATIC_DRAW),P.bindBuffer(P.ARRAY_BUFFER,null),P.uniform1i(se,0)}H=k.j,P.useProgram(k.o),P.canvas.width=R.width,P.canvas.height=R.height,P.viewport(0,0,R.width,R.height),P.activeTexture(P.TEXTURE0),k.h.bindTexture2d(R.glName),P.enableVertexAttribArray(H.K),P.bindBuffer(P.ARRAY_BUFFER,k.u),P.vertexAttribPointer(H.K,2,P.FLOAT,!1,0,0),P.enableVertexAttribArray(H.J),P.bindBuffer(P.ARRAY_BUFFER,k.s),P.vertexAttribPointer(H.J,2,P.FLOAT,!1,0,0),P.bindFramebuffer(P.DRAW_FRAMEBUFFER?P.DRAW_FRAMEBUFFER:P.FRAMEBUFFER,null),P.clearColor(0,0,0,0),P.clear(P.COLOR_BUFFER_BIT),P.colorMask(!0,!0,!0,!0),P.drawArrays(P.TRIANGLE_FAN,0,4),P.disableVertexAttribArray(H.K),P.disableVertexAttribArray(H.J),P.bindBuffer(P.ARRAY_BUFFER,null),k.h.bindTexture2d(0)}function Jp(k){this.g=k}var kc=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function jc(k,R){return R+k}function ld(k,R){window[k]=R}function On(k){var R=document.createElement("script");return R.setAttribute("src",k),R.setAttribute("crossorigin","anonymous"),new Promise(function(P){R.addEventListener("load",function(){P()},!1),R.addEventListener("error",function(){P()},!1),document.body.appendChild(R)})}function fo(){return z(function(k){switch(k.g){case 1:return k.o=2,I(k,WebAssembly.instantiate(kc),4);case 4:k.g=3,k.o=0;break;case 2:return k.o=0,k.j=null,k.return(!1);case 3:return k.return(!0)}})}function Jo(k){if(this.g=k,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=k&&k.locateFile||jc,typeof window=="object")var R=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")R=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.$=R,k.options){R=c(Object.keys(k.options));for(var P=R.next();!P.done;P=R.next()){P=P.value;var H=k.options[P].default;H!==void 0&&(this.j[P]=typeof H=="function"?H():H)}}}s=Jo.prototype,s.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function ll(k){var R,P,H,se,fe,ie,Ie,De,Ge,ot,vt;return z(function(wt){switch(wt.g){case 1:return k.Z?(R=k.g.files===void 0?[]:typeof k.g.files=="function"?k.g.files(k.j):k.g.files,I(wt,fo(),2)):wt.return();case 2:if(P=wt.h,typeof window=="object")return ld("createMediapipeSolutionsWasm",{locateFile:k.locateFile}),ld("createMediapipeSolutionsPackedAssets",{locateFile:k.locateFile}),ie=R.filter(function(ct){return ct.data!==void 0}),Ie=R.filter(function(ct){return ct.data===void 0}),De=Promise.all(ie.map(function(ct){var Tt=ei(k,ct.url);if(ct.path!==void 0){var Ut=ct.path;Tt=Tt.then(function(cs){return k.overrideFile(Ut,cs),Promise.resolve(cs)})}return Tt})),Ge=Promise.all(Ie.map(function(ct){return ct.simd===void 0||ct.simd&&P||!ct.simd&&!P?On(k.locateFile(ct.url,k.$)):Promise.resolve()})).then(function(){var ct,Tt,Ut;return z(function(cs){if(cs.g==1)return ct=window.createMediapipeSolutionsWasm,Tt=window.createMediapipeSolutionsPackedAssets,Ut=k,I(cs,ct(Tt),2);Ut.h=cs.h,cs.g=0})}),ot=function(){return z(function(ct){return k.g.graph&&k.g.graph.url?ct=I(ct,ei(k,k.g.graph.url),0):(ct.g=0,ct=void 0),ct})}(),I(wt,Promise.all([Ge,De,ot]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return H=R.filter(function(ct){return ct.simd===void 0||ct.simd&&P||!ct.simd&&!P}).map(function(ct){return k.locateFile(ct.url,k.$)}),importScripts.apply(null,u(H)),se=k,I(wt,createMediapipeSolutionsWasm(Module),6);case 6:se.h=wt.h,k.l=new OffscreenCanvas(1,1),k.h.canvas=k.l,fe=k.h.GL.createContext(k.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),k.h.GL.makeContextCurrent(fe),wt.g=4;break;case 7:if(k.l=document.createElement("canvas"),vt=k.l.getContext("webgl2",{}),!vt&&(vt=k.l.getContext("webgl",{}),!vt))return alert("Failed to create WebGL canvas context when passing video frame."),wt.return();k.G=vt,k.h.canvas=k.l,k.h.createContext(k.l,!0,!0,{});case 4:k.i=new k.h.SolutionWasm,k.Z=!1,wt.g=0}})}function i0(k){var R,P,H,se,fe,ie,Ie,De;return z(function(Ge){if(Ge.g==1){if(k.g.graph&&k.g.graph.url&&k.Y===k.g.graph.url)return Ge.return();if(k.s=!0,!k.g.graph||!k.g.graph.url){Ge.g=2;return}return k.Y=k.g.graph.url,I(Ge,ei(k,k.g.graph.url),3)}for(Ge.g!=2&&(R=Ge.h,k.i.loadGraph(R)),P=c(Object.keys(k.C)),H=P.next();!H.done;H=P.next())se=H.value,k.i.overrideFile(se,k.C[se]);if(k.C={},k.g.listeners)for(fe=c(k.g.listeners),ie=fe.next();!ie.done;ie=fe.next())Ie=ie.value,ef(k,Ie);De=k.j,k.j={},k.setOptions(De),Ge.g=0})}s.reset=function(){var k=this;return z(function(R){k.i&&(k.i.reset(),k.o={},k.u={}),R.g=0})},s.setOptions=function(k,R){var P=this;if(R=R||this.g.options){for(var H=[],se=[],fe={},ie=c(Object.keys(k)),Ie=ie.next();!Ie.done;fe={R:fe.R,S:fe.S},Ie=ie.next()){var De=Ie.value;De in this.j&&this.j[De]===k[De]||(this.j[De]=k[De],Ie=R[De],Ie!==void 0&&(Ie.onChange&&(fe.R=Ie.onChange,fe.S=k[De],H.push(function(Ge){return function(){var ot;return z(function(vt){if(vt.g==1)return I(vt,Ge.R(Ge.S),2);ot=vt.h,ot===!0&&(P.s=!0),vt.g=0})}}(fe))),Ie.graphOptionXref&&(De={valueNumber:Ie.type===1?k[De]:0,valueBoolean:Ie.type===0?k[De]:!1,valueString:Ie.type===2?k[De]:""},Ie=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),Ie.graphOptionXref),De),se.push(Ie))))}(H.length!==0||se.length!==0)&&(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(se),this.A=(this.A===void 0?[]:this.A).concat(H))}};function cd(k){var R,P,H,se,fe,ie,Ie;return z(function(De){switch(De.g){case 1:if(!k.s)return De.return();if(!k.A){De.g=2;break}R=c(k.A),P=R.next();case 3:if(P.done){De.g=5;break}return H=P.value,I(De,H(),4);case 4:P=R.next(),De.g=3;break;case 5:k.A=void 0;case 2:if(k.B){for(se=new k.h.GraphOptionChangeRequestList,fe=c(k.B),ie=fe.next();!ie.done;ie=fe.next())Ie=ie.value,se.push_back(Ie);k.i.changeOptions(se),se.delete(),k.B=void 0}k.s=!1,De.g=0}})}s.initialize=function(){var k=this;return z(function(R){return R.g==1?I(R,ll(k),2):R.g!=3?I(R,i0(k),3):I(R,cd(k),0)})};function ei(k,R){var P,H;return z(function(se){return R in k.H?se.return(k.H[R]):(P=k.locateFile(R,""),H=fetch(P).then(function(fe){return fe.arrayBuffer()}),k.H[R]=H,se.return(H))})}s.overrideFile=function(k,R){this.i?this.i.overrideFile(k,R):this.C[k]=R},s.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},s.send=function(k,R){var P=this,H,se,fe,ie,Ie,De,Ge,ot,vt;return z(function(wt){switch(wt.g){case 1:return P.g.inputs?(H=1e3*(R==null?performance.now():R),I(wt,P.D,2)):wt.return();case 2:return I(wt,P.initialize(),3);case 3:for(se=new P.h.PacketDataList,fe=c(Object.keys(k)),ie=fe.next();!ie.done;ie=fe.next())if(Ie=ie.value,De=P.g.inputs[Ie]){e:{var ct=k[Ie];switch(De.type){case"video":var Tt=P.o[De.stream];if(Tt||(Tt=new Ga(P.h,P.G),P.o[De.stream]=Tt),Tt.l===0&&(Tt.l=Tt.h.createTexture()),typeof HTMLVideoElement<"u"&&ct instanceof HTMLVideoElement)var Ut=ct.videoWidth,cs=ct.videoHeight;else typeof HTMLImageElement<"u"&&ct instanceof HTMLImageElement?(Ut=ct.naturalWidth,cs=ct.naturalHeight):(Ut=ct.width,cs=ct.height);cs={glName:Tt.l,width:Ut,height:cs},Ut=Tt.g,Ut.canvas.width=cs.width,Ut.canvas.height=cs.height,Ut.activeTexture(Ut.TEXTURE0),Tt.h.bindTexture2d(Tt.l),Ut.texImage2D(Ut.TEXTURE_2D,0,Ut.RGBA,Ut.RGBA,Ut.UNSIGNED_BYTE,ct),Tt.h.bindTexture2d(0),Tt=cs;break e;case"detections":for(Tt=P.o[De.stream],Tt||(Tt=new Jp(P.h),P.o[De.stream]=Tt),Tt.data||(Tt.data=new Tt.g.DetectionListData),Tt.data.reset(ct.length),cs=0;cs<ct.length;++cs){Ut=ct[cs];var Jt=Tt.data,rn=Jt.setBoundingBox,la=cs,Fn=Ut.boundingBox,Wt=new Qo;if(Ns(Wt,1,Fn.xCenter),Ns(Wt,2,Fn.yCenter),Ns(Wt,3,Fn.height),Ns(Wt,4,Fn.width),Ns(Wt,5,Fn.rotation),Ns(Wt,6,Fn.rectId),Fn=sd(Wt,vc),rn.call(Jt,la,Fn),Ut.landmarks)for(Jt=0;Jt<Ut.landmarks.length;++Jt){Wt=Ut.landmarks[Jt];var Ms=!!Wt.visibility;rn=Tt.data,la=rn.addNormalizedLandmark,Fn=cs,Wt=Object.assign(Object.assign({},Wt),{visibility:Ms?Wt.visibility:0}),Ms=new rl,Ns(Ms,1,Wt.x),Ns(Ms,2,Wt.y),Ns(Ms,3,Wt.z),Wt.visibility&&Ns(Ms,4,Wt.visibility),Wt=sd(Ms,ad),la.call(rn,Fn,Wt)}if(Ut.V)for(Jt=0;Jt<Ut.V.length;++Jt)rn=Tt.data,la=rn.addClassification,Fn=cs,Wt=Ut.V[Jt],Ms=new Va,Ns(Ms,2,Wt.ga),Wt.index&&Ns(Ms,1,Wt.index),Wt.label&&Ns(Ms,3,Wt.label),Wt.displayName&&Ns(Ms,4,Wt.displayName),Wt=sd(Ms,nd),la.call(rn,Fn,Wt)}Tt=Tt.data;break e;default:Tt={}}}switch(Ge=Tt,ot=De.stream,De.type){case"video":se.pushTexture2d(Object.assign(Object.assign({},Ge),{stream:ot,timestamp:H}));break;case"detections":vt=Ge,vt.stream=ot,vt.timestamp=H,se.pushDetectionList(vt);break;default:throw Error("Unknown input config type: '"+De.type+"'")}}return P.i.send(se),I(wt,P.D,4);case 4:se.delete(),wt.g=0}})};function cl(k,R,P){var H,se,fe,ie,Ie,De,Ge,ot,vt,wt,ct,Tt,Ut,cs;return z(function(Jt){switch(Jt.g){case 1:if(!P)return Jt.return(R);for(H={},se=0,fe=c(Object.keys(P)),ie=fe.next();!ie.done;ie=fe.next())Ie=ie.value,De=P[Ie],typeof De!="string"&&De.type==="texture"&&R[De.stream]!==void 0&&++se;1<se&&(k.I=!1),Ge=c(Object.keys(P)),ie=Ge.next();case 2:if(ie.done){Jt.g=4;break}if(ot=ie.value,vt=P[ot],typeof vt=="string")return Ut=H,cs=ot,I(Jt,Tc(k,ot,R[vt]),14);if(wt=R[vt.stream],vt.type==="detection_list"){if(wt){for(var rn=wt.getRectList(),la=wt.getLandmarksList(),Fn=wt.getClassificationsList(),Wt=[],Ms=0;Ms<rn.size();++Ms){var Mr=_n(rn.get(Ms),Qo,vc);Mr={boundingBox:{xCenter:qn(Mr,1),yCenter:qn(Mr,2),height:qn(Mr,3),width:qn(Mr,4),rotation:qn(Mr,5,0),rectId:Qe(Mr,6)},landmarks:Or(_n(la.get(Ms),yc,r0),rl,1).map(il),V:id(_n(Fn.get(Ms),bc,Zo))},Wt.push(Mr)}rn=Wt}else rn=[];H[ot]=rn,Jt.g=7;break}if(vt.type==="proto_list"){if(wt){for(rn=Array(wt.size()),la=0;la<wt.size();la++)rn[la]=wt.get(la);wt.delete()}else rn=[];H[ot]=rn,Jt.g=7;break}if(wt===void 0){Jt.g=3;break}if(vt.type==="float_list"){H[ot]=wt,Jt.g=7;break}if(vt.type==="proto"){H[ot]=wt,Jt.g=7;break}if(vt.type!=="texture")throw Error("Unknown output config type: '"+vt.type+"'");return ct=k.u[ot],ct||(ct=new Ga(k.h,k.G),k.u[ot]=ct),I(Jt,Sc(ct,wt,k.I),13);case 13:Tt=Jt.h,H[ot]=Tt;case 7:vt.transform&&H[ot]&&(H[ot]=vt.transform(H[ot])),Jt.g=3;break;case 14:Ut[cs]=Jt.h;case 3:ie=Ge.next(),Jt.g=2;break;case 4:return Jt.return(H)}})}function Tc(k,R,P){var H;return z(function(se){return typeof P=="number"||P instanceof Uint8Array||P instanceof k.h.Uint8BlobList?se.return(P):P instanceof k.h.Texture2dDataOut?(H=k.u[R],H||(H=new Ga(k.h,k.G),k.u[R]=H),se.return(Sc(H,P,k.I))):se.return(void 0)})}function ef(k,R){for(var P=R.name||"$",H=[].concat(u(R.wants)),se=new k.h.StringList,fe=c(R.wants),ie=fe.next();!ie.done;ie=fe.next())se.push_back(ie.value);fe=k.h.PacketListener.implement({onResults:function(Ie){for(var De={},Ge=0;Ge<R.wants.length;++Ge)De[H[Ge]]=Ie.get(Ge);var ot=k.listeners[P];ot&&(k.D=cl(k,De,R.outs).then(function(vt){vt=ot(vt);for(var wt=0;wt<R.wants.length;++wt){var ct=De[H[wt]];typeof ct=="object"&&ct.hasOwnProperty&&ct.hasOwnProperty("delete")&&ct.delete()}vt&&(k.D=vt)}))}}),k.i.attachMultiListener(se,fe),se.delete()}s.onResults=function(k,R){this.listeners[R||"$"]=k},Z("Solution",Jo),Z("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"});function tf(k){var R=this;k=k||{};var P={url:"face_detection_short.binarypb"},H={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Jo({locateFile:k.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:P,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(se){var fe,ie,Ie,De,Ge,ot;return z(function(vt){switch(vt.g){case 1:fe=se==="short"?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"],ie=c(fe),Ie=ie.next();case 2:if(Ie.done){vt.g=4;break}return De=Ie.value,Ge="third_party/mediapipe/modules/face_detection/"+De,I(vt,ei(R.g,De),5);case 5:ot=vt.h,R.g.overrideFile(Ge,ot),Ie=ie.next(),vt.g=2;break;case 4:return P.url=se==="short"?"face_detection_short.binarypb":"face_detection_full.binarypb",H.graphOptionXref.calculatorName=se==="short"?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",vt.return(!0)}})}},minDetectionConfidence:H}})}s=tf.prototype,s.close=function(){return this.g.close(),Promise.resolve()},s.onResults=function(k){this.g.onResults(k)},s.initialize=function(){var k=this;return z(function(R){return I(R,k.g.initialize(),0)})},s.reset=function(){this.g.reset()},s.send=function(k){var R=this;return z(function(P){return I(P,R.g.send(k),0)})},s.setOptions=function(k){this.g.setOptions(k)},Z("FaceDetection",tf),Z("FACEDETECTION_LIPS",wc),Z("FACEDETECTION_LEFT_EYE",ho),Z("FACEDETECTION_LEFT_EYEBROW",po),Z("FACEDETECTION_RIGHT_EYE",rd),Z("FACEDETECTION_RIGHT_EYEBROW",Nc),Z("FACEDETECTION_FACE_OVAL",od),Z("FACEDETECTION_CONTOURS",ol),Z("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),Z("VERSION","0.4.1646425229")}).call(i1)),i1}var L8=F8();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8=1e-7,z8=1e-4;class Ok{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Oy{refCount(e){return pa("refCount")}incRef(e){return pa("incRef")}timerAvailable(){return!0}time(e){return pa("time")}read(e){return pa("read")}readSync(e){return pa("readSync")}readToGPU(e,t){return pa("readToGPU")}numDataIds(){return pa("numDataIds")}disposeData(e,t){return pa("disposeData")}write(e,t,n){return pa("write")}move(e,t,n,a,o){return pa("move")}createTensorFromGPUData(e,t,n){return pa("createTensorFromGPUData")}memory(){return pa("memory")}floatPrecision(){return pa("floatPrecision")}epsilon(){return this.floatPrecision()===32?M8:z8}dispose(){return pa("dispose")}}function pa(s){throw new Error("'".concat(s,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(s){let e=s.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,ou(s,e,t)}function zl(s,e,t){return Math.max(s,Math.min(e,t))}function Fy(s){return s%2===0?s:s+1}function ou(s,e,t){const n=s[e];s[e]=s[t],s[t]=n}function B8(s){let e=0;for(let t=0;t<s.length;t++)e+=s[t];return e}function V(s,e){if(!s)throw new Error(typeof e=="string"?e:e())}function Sa(s,e,t=""){V(Mt(s,e),()=>t+" Shapes ".concat(s," and ").concat(e," must match"))}function Au(s){V(s!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ae(s){if(s.length===0)return 1;let e=s[0];for(let t=1;t<s.length;t++)e*=s[t];return e}function V8(s,e){if(s===e)return!0;if(s==null||e==null||s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==null&&e[t]!==null&&s[t]!==e[t])return!1;return!0}function Mt(s,e){if(s===e)return!0;if(s==null||e==null||s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function xu(s){return s%1===0}function R1(s){const e=Math.ceil(Math.sqrt(s));return[e,Math.ceil(s/e)]}function uu(s,e){return e<=s.length?s:s+" ".repeat(e-s.length)}function C4(s,e=a=>0,t,n){return new Promise((a,o)=>{let i=0;const c=()=>{if(s()){a();return}i++;const u=e(i);if(t!=null&&i>=t){o();return}n!=null?n(c,u):setTimeout(c,u)};c()})}function Fk(s,e){let t=1,n=-1;for(let o=0;o<s.length;++o)if(s[o]>=0)t*=s[o];else if(s[o]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(n," and dim ").concat(o));n=o}else if(s[o]<0)throw Error("Shapes can not be < 0. Found ".concat(s[o]," at dim ").concat(o));if(n===-1){if(e>0&&e!==t)throw Error("Size(".concat(e,") must match the product of shape ").concat(s));return s}if(t===0)throw Error("Cannot infer the missing size in [".concat(s,"] when ")+"there are 0 elements");if(e%t!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(t));const a=s.slice();return a[n]=e/t,a}function At(s,e){const t=e.length;return s=s==null?e.map((n,a)=>a):[].concat(s),V(s.every(n=>n>=-t&&n<t),()=>"All values in axis param must be in range [-".concat(t,", ").concat(t,") but ")+"got axis ".concat(s)),V(s.every(n=>xu(n)),()=>"All values in axis param must be integers but "+"got axis ".concat(s)),s.map(n=>n<0?t+n:n)}function Gi(s,e){const t=[],n=[],a=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||a?null:At(e,s).sort();let i=0;for(let c=0;c<s.length;++c){if(o!=null){if(o[i]===c&&s[c]!==1)throw new Error("Can't squeeze axis ".concat(c," since its dim '").concat(s[c],"' is not 1"));(o[i]==null||o[i]>c)&&s[c]===1&&(t.push(s[c]),n.push(c)),o[i]<=c&&i++}s[c]!==1&&(t.push(s[c]),n.push(c))}return{newShape:t,keptDims:n}}function vn(s,e){return Ds(s,e)}function Ds(s,e){let t=null;if(s==null||s==="float32")t=new Float32Array(e);else if(s==="int32")t=new Int32Array(e);else if(s==="bool")t=new Uint8Array(e);else if(s==="string")t=new Array(e);else throw new Error("Unknown data type ".concat(s));return t}function U8(s,e){for(let t=0;t<s.length;t++){const n=s[t];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(n,"."))}}function G8(s){return s==="bool"||s==="complex64"||s==="float32"||s==="int32"||s==="string"}function Lk(s,e){return!(e==="complex64"||e==="float32"&&s!=="complex64"||e==="int32"&&s!=="float32"&&s!=="complex64"||e==="bool"&&s==="bool")}function Am(s){if(s==="float32"||s==="int32")return 4;if(s==="complex64")return 8;if(s==="bool")return 1;throw new Error("Unknown dtype ".concat(s))}function W8(s){if(s==null)return 0;let e=0;return s.forEach(t=>e+=t.length),e}function Th(s){return typeof s=="string"||s instanceof String}function H8(s){return typeof s=="boolean"}function _1(s){return typeof s=="number"}function Eu(s){return Array.isArray(s)?Eu(s[0]):s instanceof Float32Array?"float32":s instanceof Int32Array||s instanceof Uint8Array||s instanceof Uint8ClampedArray?"int32":_1(s)?"float32":Th(s)?"string":H8(s)?"bool":"float32"}function O1(s){return!!(s&&s.constructor&&s.call&&s.apply)}function F1(s,e){for(let t=e;t<s;++t)if(s%t===0)return t;return s}function ut(s){const e=s.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=s[e-1];for(let n=e-3;n>=0;--n)t[n]=t[n+1]*s[n+1];return t}function Mk(s,e,t,n=!1){const a=new Array;if(e.length===1){const o=e[0]*(n?2:1);for(let i=0;i<o;i++)a[i]=t[s+i]}else{const o=e[0],i=e.slice(1),c=i.reduce((u,h)=>u*h)*(n?2:1);for(let u=0;u<o;u++)a[u]=Mk(s+u*c,i,t,n)}return a}function or(s,e,t=!1){if(s.length===0)return e[0];const n=s.reduce((a,o)=>a*o)*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error("[".concat(s,"] does not match the input size ").concat(e.length).concat(t?" for a complex tensor":"","."));return Mk(0,s,e,t)}function q8(s,e){if(Array.isArray(s))return s;if(e==="float32")return s instanceof Float32Array?s:new Float32Array(s);if(e==="int32")return s instanceof Int32Array?s:new Int32Array(s);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(s));throw new Error("Unknown dtype ".concat(e))}function Ly(s,e){const t=An(s,e);for(let n=0;n<t.length;n++)t[n]=1;return t}function An(s,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(s);if(e==="int32")return new Int32Array(s);if(e==="bool")return new Uint8Array(s);throw new Error("Unknown data type ".concat(e))}function zk(s,e){const t=s.reduce((n,a)=>n*a,1);if(e==null||e==="float32")return or(s,new Float32Array(t));if(e==="int32")return or(s,new Int32Array(t));if(e==="bool")return or(s,new Uint8Array(t));throw new Error("Unknown data type ".concat(e))}function La(s){s.forEach(e=>{V(Number.isInteger(e)&&e>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(s,"]."))})}function Zr(s,e,t){if(e===0)return 0;if(e===1)return s[0];let n=s[s.length-1];for(let a=0;a<s.length-1;++a)n+=t[a]*s[a];return n}function Du(s,e,t){if(e===0)return[];if(e===1)return[s];const n=new Array(e);for(let a=0;a<n.length-1;++a)n[a]=Math.floor(s/t[a]),s-=n[a]*t[a];return n[n.length-1]=s,n}function Pl(s){return s&&s.then&&typeof s.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4="tfjsflags";class K8{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=X8,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){const a=this.urlFlags[e];Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(a,".")),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Pl(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);k4 in e&&e[k4].split(",").forEach(n=>{const[a,o]=n.split(":");this.urlFlags[a]=Z8(a,o)})}}function X8(s){const e={};return s.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(Y8(e,n[0],n[1]),n.join("="))),e}function Y8(s,e,t){s[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Z8(s,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":"".concat(+t)===t?+t:e}function Se(){return Pk}let Pk=null;function Q8(s){Pk=s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let l1;function Bk(){if(l1==null){let s;if(typeof window<"u")s=window;else if(typeof global<"u")s=global;else if(typeof process<"u")s=process;else if(typeof self<"u")s=self;else throw new Error("Could not find a global object");l1=s}return l1}function J8(){const s=Bk();return s._tfGlobals==null&&(s._tfGlobals=new Map),s._tfGlobals}function My(s,e){const t=J8();if(t.has(s))return t.get(s);{const n=e();return t.set(s,n),t.get(s)}}const cg="Abs",Ih="Acos",$h="Acosh",Ru="Add",ug="AddN",zy="All",Py="Any",dg="ArgMax",hg="ArgMin",Ah="Asin",Eh="Asinh",Dh="Atan",Rh="Atanh",_h="Atan2",pg="AvgPool",By="AvgPoolGrad",fg="AvgPool3D",Vy="AvgPool3DGrad",mg="BatchMatMul",gg="BatchToSpaceND",Uy="Bincount",xg="BitwiseAnd",e7="BroadcastTo",Gy="BroadcastArgs",Oh="Cast",Fh="Ceil",Lh="ClipByValue",Wy="Complex",bg="ComplexAbs",yg="Concat",vg="Conv2D",Hy="Conv2DBackpropFilter",wg="Conv2DBackpropInput",Ng="Conv3D",qy="Conv3DBackpropFilterV2",Ky="Conv3DBackpropInputV2",Mh="Cos",zh="Cosh",Xy="Cumprod",Sg="Cumsum",Yy="CropAndResize",Zy="DenseBincount",Qy="DepthToSpace",Cg="DepthwiseConv2dNative",Jy="DepthwiseConv2dNativeBackpropFilter",e2="DepthwiseConv2dNativeBackpropInput",t2="Diag",kg="Dilation2D",L1="Dilation2DBackpropInput",M1="Dilation2DBackpropFilter",t7="Draw",Ph="RealDiv",s2="Einsum",Bh="Elu",n2="EluGrad",Vh="Erf",jg="Equal",Uh="Exp",Tg="ExpandDims",Gh="Expm1",a2="FFT",r2="Fill",o2="FlipLeftRight",Wh="Floor",Hh="FloorDiv",Ig="FusedBatchNorm",$g="GatherV2",i2="GatherNd",Ag="Greater",qh="GreaterEqual",Kh="Identity",l2="IFFT",c2="Imag",Xh="IsFinite",Yh="IsInf",Zh="IsNan",Eg="LeakyRelu",Dg="Less",Rg="LessEqual",u2="LinSpace",Qh="Log",Jh="Log1p",_g="LogicalAnd",Og="LogicalNot",Fg="LogicalOr",s7="LogSoftmax",Lg="LRN",d2="LRNGrad",Mg="Max",ep="Maximum",zg="MaxPool",h2="MaxPoolGrad",Pg="MaxPool3D",p2="MaxPool3DGrad",f2="MaxPoolWithArgmax",Bg="Mean",Vg="Min",tp="Minimum",Ug="MirrorPad",sp="Mod",m2="Multinomial",np="Multiply",Gg="Neg",Wg="NotEqual",g2="NonMaxSuppressionV3",x2="NonMaxSuppressionV4",b2="NonMaxSuppressionV5",Hg="OnesLike",qg="OneHot",Kg="Pack",Xg="PadV2",ap="Pow",Yg="Prelu",Zg="Prod",y2="RaggedGather",v2="RaggedRange",w2="RaggedTensorToTensor",N2="Range",S2="Real",rp="Reciprocal",op="Relu",Qg="Reshape",Jg="ResizeNearestNeighbor",C2="ResizeNearestNeighborGrad",ex="ResizeBilinear",k2="ResizeBilinearGrad",ip="Relu6",tx="Reverse",lp="Round",cp="Rsqrt",j2="ScatterNd",T2="TensorScatterUpdate",I2="SearchSorted",sx="Select",up="Selu",nx="Slice",dp="Sin",hp="Sinh",pp="Sign",fp="Sigmoid",mp="Softplus",gp="Sqrt",ax="Sum",rx="SpaceToBatchND",ox="SplitV",ix="Softmax",$2="SparseFillEmptyRows",A2="SparseReshape",E2="SparseSegmentMean",D2="SparseSegmentSum",R2="SparseToDense",xp="SquaredDifference",_2="Square",lx="StaticRegexReplace",O2="StridedSlice",F2="StringNGrams",L2="StringSplit",M2="StringToHashBucketFast",bp="Sub",yp="Tan",vp="Tanh",wp="Tile",z2="TopK",P2="Transform",du="Transpose",B2="Unique",cx="Unpack",ux="UnsortedSegmentSum",dx="ZerosLike",Np="Step",z1="FromPixels",V2="RotateWithOffset",Em="_FusedMatMul",Dm="FusedConv2D",Rm="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(...s){Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn(...s)}function n7(...s){Se().getBool("IS_TEST")||Se().getBool("PROD")||console.log(...s)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _m=My("kernelRegistry",()=>new Map),P1=My("gradRegistry",()=>new Map);function B1(s,e){const t=Uk(s,e);return _m.get(t)}function j4(s){return P1.get(s)}function T4(s){const e=_m.entries(),t=[];for(;;){const{done:n,value:a}=e.next();if(n)break;const[o,i]=a,[c]=o.split("_");c===s&&t.push(i)}return t}function Vk(s){const{kernelName:e,backendName:t}=s,n=Uk(e,t);_m.has(n)&&Da("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is already registered")),_m.set(n,s)}function a7(s){const{kernelName:e}=s;P1.has(e)&&Se().getBool("DEBUG")&&Da("Overriding the gradient for '".concat(e,"'")),P1.set(e,s)}function Uk(s,e){return"".concat(e,"_").concat(s)}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gk(s){return s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array||s instanceof Uint8ClampedArray}var c1,I4;function r7(){if(I4)return c1;I4=1,c1=e;var s=null;try{s=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(z){}function e(z,A,U){this.low=z|0,this.high=A|0,this.unsigned=!!U}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(z){return(z&&z.__isLong__)===!0}e.isLong=t;var n={},a={};function o(z,A){var U,X,Z;return A?(z>>>=0,(Z=0<=z&&z<256)&&(X=a[z],X)?X:(U=c(z,(z|0)<0?-1:0,!0),Z&&(a[z]=U),U)):(z|=0,(Z=-128<=z&&z<128)&&(X=n[z],X)?X:(U=c(z,z<0?-1:0,!1),Z&&(n[z]=U),U))}e.fromInt=o;function i(z,A){if(isNaN(z))return A?C:N;if(A){if(z<0)return C;if(z>=y)return _}else{if(z<=-9223372036854776e3)return L;if(z+1>=v)return E}return z<0?i(-z,A).neg():c(z%b|0,z/b|0,A)}e.fromNumber=i;function c(z,A,U){return new e(z,A,U)}e.fromBits=c;var u=Math.pow;function h(z,A,U){if(z.length===0)throw Error("empty string");if(z==="NaN"||z==="Infinity"||z==="+Infinity"||z==="-Infinity")return N;if(typeof A=="number"?(U=A,A=!1):A=!!A,U=U||10,U<2||36<U)throw RangeError("radix");var X;if((X=z.indexOf("-"))>0)throw Error("interior hyphen");if(X===0)return h(z.substring(1),A,U).neg();for(var Z=i(u(U,8)),q=N,B=0;B<z.length;B+=8){var K=Math.min(8,z.length-B),J=parseInt(z.substring(B,B+K),U);if(K<8){var Q=i(u(U,K));q=q.mul(Q).add(i(J))}else q=q.mul(Z),q=q.add(i(J))}return q.unsigned=A,q}e.fromString=h;function p(z,A){return typeof z=="number"?i(z,A):typeof z=="string"?h(z,A):c(z.low,z.high,typeof A=="boolean"?A:z.unsigned)}e.fromValue=p;var f=65536,g=1<<24,b=f*f,y=b*b,v=y/2,w=o(g),N=o(0);e.ZERO=N;var C=o(0,!0);e.UZERO=C;var I=o(1);e.ONE=I;var T=o(1,!0);e.UONE=T;var $=o(-1);e.NEG_ONE=$;var E=c(-1,2147483647,!1);e.MAX_VALUE=E;var _=c(-1,-1,!0);e.MAX_UNSIGNED_VALUE=_;var L=c(0,-2147483648,!1);e.MIN_VALUE=L;var O=e.prototype;return O.toInt=function(){return this.unsigned?this.low>>>0:this.low},O.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},O.toString=function(A){if(A=A||10,A<2||36<A)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(L)){var U=i(A),X=this.div(U),Z=X.mul(U).sub(this);return X.toString(A)+Z.toInt().toString(A)}else return"-"+this.neg().toString(A);for(var q=i(u(A,6),this.unsigned),B=this,K="";;){var J=B.div(q),Q=B.sub(J.mul(q)).toInt()>>>0,ae=Q.toString(A);if(B=J,B.isZero())return ae+K;for(;ae.length<6;)ae="0"+ae;K=""+ae+K}},O.getHighBits=function(){return this.high},O.getHighBitsUnsigned=function(){return this.high>>>0},O.getLowBits=function(){return this.low},O.getLowBitsUnsigned=function(){return this.low>>>0},O.getNumBitsAbs=function(){if(this.isNegative())return this.eq(L)?64:this.neg().getNumBitsAbs();for(var A=this.high!=0?this.high:this.low,U=31;U>0&&(A&1<<U)==0;U--);return this.high!=0?U+33:U+1},O.isZero=function(){return this.high===0&&this.low===0},O.eqz=O.isZero,O.isNegative=function(){return!this.unsigned&&this.high<0},O.isPositive=function(){return this.unsigned||this.high>=0},O.isOdd=function(){return(this.low&1)===1},O.isEven=function(){return(this.low&1)===0},O.equals=function(A){return t(A)||(A=p(A)),this.unsigned!==A.unsigned&&this.high>>>31===1&&A.high>>>31===1?!1:this.high===A.high&&this.low===A.low},O.eq=O.equals,O.notEquals=function(A){return!this.eq(A)},O.neq=O.notEquals,O.ne=O.notEquals,O.lessThan=function(A){return this.comp(A)<0},O.lt=O.lessThan,O.lessThanOrEqual=function(A){return this.comp(A)<=0},O.lte=O.lessThanOrEqual,O.le=O.lessThanOrEqual,O.greaterThan=function(A){return this.comp(A)>0},O.gt=O.greaterThan,O.greaterThanOrEqual=function(A){return this.comp(A)>=0},O.gte=O.greaterThanOrEqual,O.ge=O.greaterThanOrEqual,O.compare=function(A){if(t(A)||(A=p(A)),this.eq(A))return 0;var U=this.isNegative(),X=A.isNegative();return U&&!X?-1:!U&&X?1:this.unsigned?A.high>>>0>this.high>>>0||A.high===this.high&&A.low>>>0>this.low>>>0?-1:1:this.sub(A).isNegative()?-1:1},O.comp=O.compare,O.negate=function(){return!this.unsigned&&this.eq(L)?L:this.not().add(I)},O.neg=O.negate,O.add=function(A){t(A)||(A=p(A));var U=this.high>>>16,X=this.high&65535,Z=this.low>>>16,q=this.low&65535,B=A.high>>>16,K=A.high&65535,J=A.low>>>16,Q=A.low&65535,ae=0,we=0,Ce=0,ve=0;return ve+=q+Q,Ce+=ve>>>16,ve&=65535,Ce+=Z+J,we+=Ce>>>16,Ce&=65535,we+=X+K,ae+=we>>>16,we&=65535,ae+=U+B,ae&=65535,c(Ce<<16|ve,ae<<16|we,this.unsigned)},O.subtract=function(A){return t(A)||(A=p(A)),this.add(A.neg())},O.sub=O.subtract,O.multiply=function(A){if(this.isZero())return N;if(t(A)||(A=p(A)),s){var U=s.mul(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}if(A.isZero())return N;if(this.eq(L))return A.isOdd()?L:N;if(A.eq(L))return this.isOdd()?L:N;if(this.isNegative())return A.isNegative()?this.neg().mul(A.neg()):this.neg().mul(A).neg();if(A.isNegative())return this.mul(A.neg()).neg();if(this.lt(w)&&A.lt(w))return i(this.toNumber()*A.toNumber(),this.unsigned);var X=this.high>>>16,Z=this.high&65535,q=this.low>>>16,B=this.low&65535,K=A.high>>>16,J=A.high&65535,Q=A.low>>>16,ae=A.low&65535,we=0,Ce=0,ve=0,pe=0;return pe+=B*ae,ve+=pe>>>16,pe&=65535,ve+=q*ae,Ce+=ve>>>16,ve&=65535,ve+=B*Q,Ce+=ve>>>16,ve&=65535,Ce+=Z*ae,we+=Ce>>>16,Ce&=65535,Ce+=q*Q,we+=Ce>>>16,Ce&=65535,Ce+=B*J,we+=Ce>>>16,Ce&=65535,we+=X*ae+Z*Q+q*J+B*K,we&=65535,c(ve<<16|pe,we<<16|Ce,this.unsigned)},O.mul=O.multiply,O.divide=function(A){if(t(A)||(A=p(A)),A.isZero())throw Error("division by zero");if(s){if(!this.unsigned&&this.high===-2147483648&&A.low===-1&&A.high===-1)return this;var U=(this.unsigned?s.div_u:s.div_s)(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:N;var X,Z,q;if(this.unsigned){if(A.unsigned||(A=A.toUnsigned()),A.gt(this))return C;if(A.gt(this.shru(1)))return T;q=C}else{if(this.eq(L)){if(A.eq(I)||A.eq($))return L;if(A.eq(L))return I;var B=this.shr(1);return X=B.div(A).shl(1),X.eq(N)?A.isNegative()?I:$:(Z=this.sub(A.mul(X)),q=X.add(Z.div(A)),q)}else if(A.eq(L))return this.unsigned?C:N;if(this.isNegative())return A.isNegative()?this.neg().div(A.neg()):this.neg().div(A).neg();if(A.isNegative())return this.div(A.neg()).neg();q=N}for(Z=this;Z.gte(A);){X=Math.max(1,Math.floor(Z.toNumber()/A.toNumber()));for(var K=Math.ceil(Math.log(X)/Math.LN2),J=K<=48?1:u(2,K-48),Q=i(X),ae=Q.mul(A);ae.isNegative()||ae.gt(Z);)X-=J,Q=i(X,this.unsigned),ae=Q.mul(A);Q.isZero()&&(Q=I),q=q.add(Q),Z=Z.sub(ae)}return q},O.div=O.divide,O.modulo=function(A){if(t(A)||(A=p(A)),s){var U=(this.unsigned?s.rem_u:s.rem_s)(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}return this.sub(this.div(A).mul(A))},O.mod=O.modulo,O.rem=O.modulo,O.not=function(){return c(~this.low,~this.high,this.unsigned)},O.and=function(A){return t(A)||(A=p(A)),c(this.low&A.low,this.high&A.high,this.unsigned)},O.or=function(A){return t(A)||(A=p(A)),c(this.low|A.low,this.high|A.high,this.unsigned)},O.xor=function(A){return t(A)||(A=p(A)),c(this.low^A.low,this.high^A.high,this.unsigned)},O.shiftLeft=function(A){return t(A)&&(A=A.toInt()),(A&=63)===0?this:A<32?c(this.low<<A,this.high<<A|this.low>>>32-A,this.unsigned):c(0,this.low<<A-32,this.unsigned)},O.shl=O.shiftLeft,O.shiftRight=function(A){return t(A)&&(A=A.toInt()),(A&=63)===0?this:A<32?c(this.low>>>A|this.high<<32-A,this.high>>A,this.unsigned):c(this.high>>A-32,this.high>=0?0:-1,this.unsigned)},O.shr=O.shiftRight,O.shiftRightUnsigned=function(A){if(t(A)&&(A=A.toInt()),A&=63,A===0)return this;var U=this.high;if(A<32){var X=this.low;return c(X>>>A|U<<32-A,U>>>A,this.unsigned)}else return A===32?c(U,0,this.unsigned):c(U>>>A-32,0,this.unsigned)},O.shru=O.shiftRightUnsigned,O.shr_u=O.shiftRightUnsigned,O.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},O.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},O.toBytes=function(A){return A?this.toBytesLE():this.toBytesBE()},O.toBytesLE=function(){var A=this.high,U=this.low;return[U&255,U>>>8&255,U>>>16&255,U>>>24,A&255,A>>>8&255,A>>>16&255,A>>>24]},O.toBytesBE=function(){var A=this.high,U=this.low;return[A>>>24,A>>>16&255,A>>>8&255,A&255,U>>>24,U>>>16&255,U>>>8&255,U&255]},e.fromBytes=function(A,U,X){return X?e.fromBytesLE(A,U):e.fromBytesBE(A,U)},e.fromBytesLE=function(A,U){return new e(A[0]|A[1]<<8|A[2]<<16|A[3]<<24,A[4]|A[5]<<8|A[6]<<16|A[7]<<24,U)},e.fromBytesBE=function(A,U){return new e(A[4]<<24|A[5]<<16|A[6]<<8|A[7],A[0]<<24|A[1]<<16|A[2]<<8|A[3],U)},c1}var Wk=r7();const Hk=C6(Wk),o7=_6({__proto__:null,default:Hk},[Wk]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $l=Hk||o7;function hx(s){return $l.fromString(s,!0,16)}const qk=hx("c3a5c85c97cb3127"),Il=hx("b492b66fbe98f273"),zn=hx("9ae16a3b2f90404f");function V1(s){return s.xor(s.shru(47))}function Kk(s,e,t){const n=s.slice(e,e+t);return $l.fromBytes(Array.from(n),!0,!0)}function ds(s,e){return Kk(s,e,8)}function $4(s,e){return Kk(s,e,4)}function cn(s,e){return e===0?s:s.shru(e).or(s.shl(64-e))}function $i(s,e,t=hx("9ddfea08eb382d69")){let n=s.xor(e).mul(t);n=n.xor(n.shru(47));let a=e.xor(n).mul(t);return a=a.xor(a.shru(47)),a=a.mul(t),a}function i7(s,e,t,n,a,o){a=a.add(s),o=cn(o.add(a).add(n),21);const i=a;return a=a.add(e),a=a.add(t),o=o.add(cn(a,44)),[a.add(n),o.add(i)]}function am(s,e,t,n){return i7(ds(s,e),ds(s,e+8),ds(s,e+16),ds(s,e+24),t,n)}function l7(s,e=s.length){if(e>=8){const t=zn.add(e*2),n=ds(s,0).add(zn),a=ds(s,e-8),o=cn(a,37).mul(t).add(n),i=cn(n,25).add(a).mul(t);return $i(o,i,t)}if(e>=4){const t=zn.add(e*2),n=$4(s,0);return $i(n.shl(3).add(e),$4(s,e-4),t)}if(e>0){const t=s[0],n=s[e>>1],a=s[e-1],o=t+(n<<8),i=e+(a<<2);return V1(zn.mul(o).xor(qk.mul(i))).mul(zn)}return zn}function c7(s,e=s.length){const t=zn.add(e*2),n=ds(s,0).mul(Il),a=ds(s,8),o=ds(s,e-8).mul(t),i=ds(s,e-16).mul(zn);return $i(cn(n.add(a),43).add(cn(o,30)).add(i),n.add(cn(a.add(zn),18)).add(o),t)}function u7(s,e=s.length){const t=zn.add(e*2),n=ds(s,0).mul(zn),a=ds(s,8),o=ds(s,e-8).mul(t),i=ds(s,e-16).mul(zn),c=cn(n.add(a),43).add(cn(o,30)).add(i),u=$i(c,n.add(cn(a.add(zn),18)).add(o),t),h=ds(s,16).mul(t),p=ds(s,24),f=c.add(ds(s,e-32)).mul(t),g=u.add(ds(s,e-24)).mul(t);return $i(cn(h.add(p),43).add(cn(f,30)).add(g),h.add(cn(p.add(n),18)).add(f),t)}function d7(s,e=s.length){const t=$l.fromNumber(81,!0);if(e<=32)return e<=16?l7(s,e):c7(s,e);if(e<=64)return u7(s,e);let n=t,a=t.mul(Il).add(113),o=V1(a.mul(zn).add(113)).mul(zn),i=[$l.UZERO,$l.UZERO],c=[$l.UZERO,$l.UZERO];n=n.mul(zn).add(ds(s,0));let u=0;const h=(e-1>>6)*64,p=h+(e-1&63)-63;do n=cn(n.add(a).add(i[0]).add(ds(s,u+8)),37).mul(Il),a=cn(a.add(i[1]).add(ds(s,u+48)),42).mul(Il),n=n.xor(c[1]),a=a.add(i[0]).add(ds(s,u+40)),o=cn(o.add(c[0]),33).mul(Il),i=am(s,u,i[1].mul(Il),n.add(c[0])),c=am(s,u+32,o.add(c[1]),a.add(ds(s,u+16))),[o,n]=[n,o],u+=64;while(u!==h);const f=Il.add(o.and(255).shl(1));return u=p,c[0]=c[0].add(e-1&63),i[0]=i[0].add(c[0]),c[0]=c[0].add(i[0]),n=cn(n.add(a).add(i[0]).add(ds(s,u+8)),37).mul(f),a=cn(a.add(i[1]).add(ds(s,u+48)),42).mul(f),n=n.xor(c[1].mul(9)),a=a.add(i[0].mul(9).add(ds(s,u+40))),o=cn(o.add(c[0]),33).mul(f),i=am(s,u,i[1].mul(f),n.add(c[0])),c=am(s,u+32,o.add(c[1]),a.add(ds(s,u+16))),[o,n]=[n,o],$i($i(i[0],c[0],f).add(V1(a).mul(qk)).add(o),$i(i[1],c[1],f).add(n),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wi(s,e){return e==="string"?Ai(s):ec([s],e)}function h7(s,e){return s instanceof Float32Array&&e==="float32"||s instanceof Int32Array&&e==="int32"||s instanceof Uint8Array&&e==="bool"}function ec(s,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(s)&&(s=Bl(s)),Se().getBool("DEBUG")&&U8(s,e),h7(s,e))return s;if(e==null||e==="float32"||e==="complex64")return new Float32Array(s);if(e==="int32")return new Int32Array(s);if(e==="bool"){const t=new Uint8Array(s.length);for(let n=0;n<t.length;++n)Math.round(s[n])!==0&&(t[n]=1);return t}else throw new Error("Unknown data type ".concat(e))}function Qn(){return Se().platform.now()}function Ai(s,e="utf-8"){return e=e||"utf-8",Se().platform.encode(s,e)}function Ri(s,e="utf-8"){return e=e||"utf-8",Se().platform.decode(s,e)}function lr(s){return Se().platform.isTypedArray!=null?Se().platform.isTypedArray(s):Gk(s)}function Bl(s,e=[],t=!1){if(e==null&&(e=[]),typeof s=="boolean"||typeof s=="number"||typeof s=="string"||Pl(s)||s==null||lr(s)&&t)e.push(s);else if(Array.isArray(s)||lr(s))for(let n=0;n<s.length;++n)Bl(s[n],e,t);else{let n=-1;for(const a of Object.keys(s))/^([1-9]+[0-9]*|0)$/.test(a)&&(n=Math.max(n,Number(a)));for(let a=0;a<=n;a++)Bl(s[a],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p7{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new m7)}profileKernel(e,t,n){let a;const o=()=>{a=n()};let i;const c=Qn();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const h of a)h.dataSync();i=Promise.resolve({kernelMs:Qn()-c})}if(Se().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let h=0;h<a.length;h++){const p=a[h];p.data().then(f=>{f7(f,p.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:i.then(h=>h.kernelMs),extraInfo:i.then(h=>h.getExtraProfileInfo!=null?h.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:a,inputs:o,extraInfo:i}=e;n.forEach(c=>{Promise.all([c.data(),a,i]).then(u=>{this.logger.logKernelProfile(t,c,u[0],u[1],o,u[2])})})}}function f7(s,e,t){if(e!=="float32")return!1;for(let n=0;n<s.length;n++){const a=s[n];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(t,"'")),!0}return!1}class m7{logKernelProfile(e,t,n,a,o,i){const c=typeof a=="number"?uu("".concat(a,"ms"),9):a.error,u=uu(e,25),h=t.rank,p=t.size,f=uu(t.shape.toString(),14);let g="";for(const b in o){const y=o[b];if(y!=null){const v=y.shape||t.shape,w=v.length;g+="".concat(b,": ").concat(w,"D ").concat(w>0?v:""," ")}}console.log("%c".concat(u,"	%c").concat(c,"	%c").concat(h,"D ").concat(f,"	%c").concat(p,"	%c").concat(g,"	%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(s,e,t){const n={},a={};for(let u=0;u<e.length;u++)n[e[u].id]=!0;for(let u=0;u<s.length;u++){const h=s[u],p=h.inputs;for(const f in p){const g=p[f];let b=!1;for(let y=0;y<e.length;y++)if(n[g.id]){h.outputs.forEach(v=>n[v.id]=!0),b=!0,a[h.id]=!0;break}if(b)break}}const o={};o[t.id]=!0;const i={};for(let u=s.length-1;u>=0;u--){const h=s[u],p=h.inputs;for(let f=0;f<h.outputs.length;f++)if(o[h.outputs[f].id]){for(const g in p)o[p[g].id]=!0,i[h.id]=!0;break}}const c=[];for(let u=0;u<s.length;u++){const h=s[u];if(a[h.id]&&i[h.id]){const p={};for(const g in h.inputs){const b=h.inputs[g];n[b.id]&&(p[g]=b)}const f=Object.assign({},h);f.inputs=p,f.outputs=h.outputs,c.push(f)}}return c}function x7(s,e,t,n){for(let a=e.length-1;a>=0;a--){const o=e[a],i=[];if(o.outputs.forEach(u=>{const h=s[u.id];h!=null?i.push(h):i.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));const c=o.gradient(i);for(const u in o.inputs){if(!(u in c))throw new Error("Cannot backprop through input ".concat(u,". ")+"Available gradients found: ".concat(Object.keys(c),"."));const h=t(()=>c[u]());if(h.dtype!=="float32")throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(u," must have 'float32' dtype, but has '").concat(h.dtype,"'"));const p=o.inputs[u];if(!Mt(h.shape,p.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(u,"' has shape '").concat(h.shape,"', which does not match ")+"the shape of the input '".concat(p.shape,"'"));if(s[p.id]==null)s[p.id]=h;else{const f=s[p.id];s[p.id]=n(f,h),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4=20,eh=3,u1=7;function b7(s,e,t,n){const a=ut(e),o=y7(s,e,t,a),i=e.length,c=ym(s,e,t,a,o),u=["Tensor"];return n&&(u.push("  dtype: ".concat(t)),u.push("  rank: ".concat(i)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(c.map(h=>"    "+h).join("\n")),u.join("\n")}function y7(s,e,t,n){const a=Ae(e),o=n[n.length-1],i=new Array(o).fill(0),c=e.length,u=t==="complex64"?rh(s):s;if(c>1)for(let h=0;h<a/o;h++){const p=h*o;for(let f=0;f<o;f++)i[f]=Math.max(i[f],ah(u[p+f],0,t).length)}return i}function ah(s,e,t){let n;return Array.isArray(s)?n="".concat(parseFloat(s[0].toFixed(u1))," + ")+"".concat(parseFloat(s[1].toFixed(u1)),"j"):Th(s)?n="'".concat(s,"'"):t==="bool"?n=Xk(s):n=parseFloat(s.toFixed(u1)).toString(),uu(n,e)}function Xk(s){return s===0?"false":"true"}function ym(s,e,t,n,a,o=!0){const i=t==="complex64"?2:1,c=e[0],u=e.length;if(u===0){if(t==="complex64"){const v=rh(s);return[ah(v[0],0,t)]}return t==="bool"?[Xk(s[0])]:[s[0].toString()]}if(u===1){if(c>A4){const w=eh*i;let N=Array.from(s.slice(0,w)),C=Array.from(s.slice((c-eh)*i,c*i));return t==="complex64"&&(N=rh(N),C=rh(C)),["["+N.map((I,T)=>ah(I,a[T],t)).join(", ")+", ..., "+C.map((I,T)=>ah(I,a[c-eh+T],t)).join(", ")+"]"]}return["["+(t==="complex64"?rh(s):Array.from(s)).map((w,N)=>ah(w,a[N],t)).join(", ")+"]"]}const h=e.slice(1),p=n.slice(1),f=n[0]*i,g=[];if(c>A4){for(let v=0;v<eh;v++){const w=v*f,N=w+f;g.push(...ym(s.slice(w,N),h,t,p,a,!1))}g.push("...");for(let v=c-eh;v<c;v++){const w=v*f,N=w+f;g.push(...ym(s.slice(w,N),h,t,p,a,v===c-1))}}else for(let v=0;v<c;v++){const w=v*f,N=w+f;g.push(...ym(s.slice(w,N),h,t,p,a,v===c-1))}const b=u===2?",":"";g[0]="["+(c>0?g[0]+b:"");for(let v=1;v<g.length-1;v++)g[v]=" "+g[v]+b;let y=",\n";for(let v=2;v<u;v++)y+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(o?"":y),g}function rh(s){const e=[];for(let t=0;t<s.length;t+=2)e.push([s[t],s[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zs{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Ae(e),n!=null){const a=n.length;V(a===this.size,()=>"Length of values '".concat(a,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Ds(t,this.size),this.strides=ut(e)}set(e,...t){t.length===0&&(t=[0]),V(t.length===this.rank,()=>"The number of provided coordinates (".concat(t.length,") must ")+"match the rank (".concat(this.rank,")"));const n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const a of e){if(a<0||a>=this.shape[t]){const o="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(o)}t++}let n=e[e.length-1];for(let a=0;a<e.length-1;++a)n+=this.strides[a]*e[a];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return vr().makeTensor(this.values,this.shape,this.dtype)}}let vr=null,iu=null;function v7(s){vr=s}function w7(s){iu=s}class os{constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ae(e),this.strides=ut(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return iu.buffer(this.shape,this.dtype,e)}bufferSync(){return iu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return or(this.shape,e,this.dtype==="complex64")}arraySync(){return or(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=vr().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(n=>Ri(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),vr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=vr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Ri(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await vr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),vr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return iu.print(this,e)}clone(){return this.throwIfDisposed(),iu.clone(this)}toString(e=!1){const t=this.dataSync();return b7(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),iu.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),vr().makeVariable(this,e,t,n)}}Object.defineProperty(os,Symbol.hasInstance,{value:s=>!!s&&s.data!=null&&s.dataSync!=null&&s.throwIfDisposed!=null});function Ee(){return My("Tensor",()=>os)}Ee();class Om extends os{constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Mt(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));vr().disposeTensor(this),this.dataId=e.dataId,vr().incRef(this,null)}dispose(){vr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Om,Symbol.hasInstance,{value:s=>s instanceof os&&s.assign!=null&&s.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var E4;(function(s){s.R0="R0",s.R1="R1",s.R2="R2",s.R3="R3",s.R4="R4",s.R5="R5",s.R6="R6"})(E4||(E4={}));var U1;(function(s){s.float32="float32",s.int32="int32",s.bool="int32",s.complex64="complex64"})(U1||(U1={}));var G1;(function(s){s.float32="float32",s.int32="int32",s.bool="bool",s.complex64="complex64"})(G1||(G1={}));var W1;(function(s){s.float32="float32",s.int32="float32",s.bool="float32",s.complex64="complex64"})(W1||(W1={}));var H1;(function(s){s.float32="complex64",s.int32="complex64",s.bool="complex64",s.complex64="complex64"})(H1||(H1={}));const N7={float32:W1,int32:U1,bool:G1,complex64:H1};function ya(s,e){if(s==="string"||e==="string"){if(s==="string"&&e==="string")return"string";throw new Error("Can not upcast ".concat(s," with ").concat(e))}return N7[s][e]}function U2(s){return ya(s,"int32")}function Yk(s){return s!=null&&typeof s=="object"&&"texture"in s&&s.texture instanceof WebGLTexture}function Zk(s){return typeof GPUBuffer<"u"&&s!=null&&typeof s=="object"&&"buffer"in s&&s.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(s,e){if(s.dtype===e.dtype)return[s,e];const t=ya(s.dtype,e.dtype);return[s.cast(t),e.cast(t)]}function S7(s,e){V(s.dtype===e.dtype,()=>"The dtypes of the first(".concat(s.dtype,") and")+" second(".concat(e.dtype,") input must match"))}function Qk(s){const e=[];return Jk(s,e,new Set),e}function Jk(s,e,t){if(s==null)return;if(s instanceof os){e.push(s);return}if(!C7(s))return;const n=s;for(const a in n){const o=n[a];t.has(o)||(t.add(o),Jk(o,e,t))}}function C7(s){return Array.isArray(s)||typeof s=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1(s){return s.kernelName!=null}class D4{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class bu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new D4}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(Da("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new p7(this.backendInstance),!0}setupRegisteredKernels(){T4(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){T4(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(n&&!(n instanceof Oy)&&typeof n.then=="function"){const a=++this.pendingBackendInitId,o=n.then(i=>a<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,Da("Initialization of backend ".concat(e," failed")),Da(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return Da("Initialization of backend ".concat(e," failed")),Da(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:a,asyncInit:o}=this.initializeBackend(n);if(o||a)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),a=n.backend,o=this.readSync(t),i=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,o,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let a;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(a),()=>(a=t(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,t,n){e();try{const a=n();return t(),a}catch(a){throw t(),a}}nextTensorId(){return bu.nextTensorId++}nextVariableId(){return bu.nextVariableId++}clone(e){const t=oe.runKernel(Kh,{x:e}),n={x:e},a=i=>({x:()=>{const c="float32",u={x:i},h={dtype:c};return oe.runKernel(Oh,u,h)}}),o=[];return this.addTapeNode(this.state.activeScope.name,n,[t],a,o,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,!(B1(e,this.backendName)!=null))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const a=this.backend.numDataIds();let o=0;n.forEach(u=>{o+=u.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],c=a-t-o-i;if(c>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(c," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const a=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let c;this.backendName==null&&this.backend;let u;const h=d1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(d1(e)){const{kernelName:y,inputs:v,attrs:w}=e;this.backendName==null&&this.backend;const N=B1(y,this.backendName);V(N!=null,()=>"Cannot find registered kernel '".concat(y,"' for backend '").concat(this.backendName,"'")),c=()=>{const C=this.backend.numDataIds();u=N.kernelFunc({inputs:v,attrs:w,backend:this.backend});const I=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,C,I);const T=I.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(a){const $=this.getTensorsForGradient(y,v,T);n=this.saveTensorsForBackwardMode($)}return T}}else{const{forwardFunc:y}=e,v=w=>{a&&(n=w.map(N=>this.keep(this.clone(N))))};c=()=>{const w=this.backend.numDataIds();u=this.tidy(()=>y(this.backend,v));const N=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,w,N),N}}const{inputs:p,attrs:f}=e,g=d1(e)?null:e.backwardsFunc;let b;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=c():(b=this.profiler.profileKernel(h,p,()=>c()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(b),t=b.outputs)}),a&&this.addTapeNode(h,p,t,g,n,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:h,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map(y=>p[y]!=null?p[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:b.timeMs,extraInfo:b.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,t,n){const a=j4(e);if(a!=null){const o=a.inputsToSave||[],i=a.outputsToSave||[];let c;a.saveAllInputs?(V(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),c=Object.keys(t).map(h=>t[h])):c=o.map(h=>t[h]);const u=n.filter((h,p)=>i[p]);return c.concat(u)}return[]}makeTensor(e,t,n,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let o=e;n==="string"&&Th(e[0])&&(o=e.map(u=>Ai(u)));const i=a.write(o,t,n),c=new os(t,n,i,this.nextTensorId());if(this.trackTensor(c,a),n==="string"){const u=this.state.tensorInfo.get(i),h=W8(o);this.state.numBytes+=h-u.bytes,u.bytes=h}return c}makeTensorFromDataId(e,t,n,a){n=n||"float32";const o={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(o,a)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:a,dtype:o}=e,i=new os(a,o,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,a){n=n||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const o=new Om(e,t,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name ".concat(o.name," was already registered"));return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*Am(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Om||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const n=e.size*Am(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,a,o,i){const c={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},u=j4(e);u!=null&&(a=u.gradFunc),a!=null&&(c.gradient=h=>(h=h.map((p,f)=>{if(p==null){const g=n[f],b=An(g.size,g.dtype);return this.makeTensor(b,g.shape,g.dtype)}return p}),a(h.length>1?h:h[0],o,i))),this.state.activeTape.push(c)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Qk(e),n=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!n.has(i.id)&&i.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===a.id&&this.track(o)})}gradients(e,t,n,a=!1){if(V(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));V(o instanceof os,()=>"The result y returned by f() must be a tensor.");const i=g7(this.state.activeTape,t,o);if(!a&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const c={};c[o.id]=n==null?k7(o.shape):n,x7(c,i,h=>this.tidy(h),j7);const u=t.map(h=>c[h.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(h=>{for(const p of h.saved)p.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(e){return V(O1(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{V(t.every(c=>c instanceof os),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n;const a={};t.forEach((c,u)=>{a[u]=c});const o=(c,u)=>(n=e(...t,u),V(n.value instanceof os,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),V(O1(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(c,u)=>{const h=n.gradFunc(c,u),p=Array.isArray(h)?h:[h];V(p.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),V(p.every(g=>g instanceof os),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return p.forEach((g,b)=>{f[b]=()=>g}),f};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Qn(),n=await this.backend.time(e);return n.wallMs=Qn()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new D4;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}bu.nextTensorId=0;bu.nextVariableId=0;function k7(s){const e=Ly(Ae(s),"float32");return oe.makeTensor(e,s,"float32")}function ej(){const s=Bk();if(s._tfengine==null){const e=new K8(s);s._tfengine=new bu(e)}return Q8(s._tfengine.ENV),v7(()=>s._tfengine),s._tfengine}const oe=ej();function j7(s,e){const t={a:s,b:e};return oe.runKernel(Ru,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(){return typeof navigator<"u"&&navigator!=null}function tj(s){if(s||T7()){if(s||(s=navigator),s.product==="ReactNative")return!0;const e=s.userAgent||s.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=s;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function sj(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ta=Se();ta.registerFlag("DEBUG",()=>!1,s=>{s&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ta.registerFlag("IS_BROWSER",()=>sj());ta.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ta.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ta.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ta.registerFlag("PROD",()=>!1);ta.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ta.getBool("DEBUG"));ta.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ta.registerFlag("IS_TEST",()=>!1);ta.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ta.getBool("DEBUG"));ta.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ta.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ta.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(s,e){let t=s;if(lr(s))return e==="string"?[]:[s.length];if(Yk(s)){const a=s.channels||"RGBA";return[s.height,s.width*a.length]}else if(Zk(s))return[s.buffer.size/(e==null?4:Am(e))];if(!Array.isArray(s))return[];const n=[];for(;Array.isArray(t)||lr(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(s)&&Se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&nj(s,n,[]),n}function nj(s,e,t){if(t=t||[],!Array.isArray(s)&&!lr(s)){V(e.length===0,()=>"Element arr[".concat(t.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements"));return}V(e.length>0,()=>"Element arr[".concat(t.join("]["),"] should be a primitive, ")+"but is an array of ".concat(s.length," elements")),V(s.length===e[0],()=>"Element arr[".concat(t.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(s.length," elements"));const n=e.slice(1);for(let a=0;a<s.length;++a)nj(s[a],n,t.concat(a))}function R4(s,e,t,n){if(s!=="string_or_numeric"){if(s==null)throw new Error("Expected dtype cannot be null.");if(s!=="numeric"&&s!==e||s==="numeric"&&e==="string")throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must ")+"be ".concat(s," tensor, but got ").concat(e," tensor"))}}function W(s,e,t,n="numeric"){if(s instanceof Ee())return R4(n,s.dtype,e,t),s;let a=Eu(s);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),R4(n,a,e,t),s==null||!lr(s)&&!Array.isArray(s)&&typeof s!="number"&&typeof s!="boolean"&&typeof s!="string"){const u=s==null?"null":s.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(t,"' must be a ")+"Tensor or TensorLike, but got '".concat(u,"'"))}const o=Hi(s,a);!lr(s)&&!Array.isArray(s)&&(s=[s]);const c=a!=="string"?ec(s,a):Bl(s,[],!0);return oe.makeTensor(c,o,a)}function Fm(s,e,t,n="numeric"){if(!Array.isArray(s))throw new Error("Argument ".concat(e," passed to ").concat(t," must be a ")+"`Tensor[]` or `TensorLike[]`");return s.map((o,i)=>W(o,"".concat(e,"[").concat(i,"]"),t,n))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aj="__op";function te(s){const e=Object.keys(s);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let t=e[0];const n=s[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+aj;const a=(...o)=>{oe.startScope(t);try{const i=n(...o);return Pl(i)&&console.error("Cannot return a Promise inside of tidy."),oe.endScope(i),i}catch(i){throw oe.endScope(null),i}};return Object.defineProperty(a,"name",{value:t,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(s,e){const t=W(s,"real","complex"),n=W(e,"imag","complex");Sa(t.shape,n.shape,"real and imag shapes, ".concat(t.shape," and ").concat(n.shape,", ")+"must match in call to tf.complex().");const a={real:t,imag:n};return oe.runKernel(Wy,a)}const _i=te({complex_:I7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qi(s,e,t,n){if(n==null)n=Eu(s);else if(n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Zk(s)||Yk(s)){if(n!=="float32"&&n!=="int32")throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(n,"."));return oe.backend.createTensorFromGPUData(s,e||t,n)}if(!lr(s)&&!Array.isArray(s)&&typeof s!="number"&&typeof s!="boolean"&&typeof s!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){La(e);const a=Ae(e),o=Ae(t);V(a===o,()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(a," values but has ").concat(o));for(let i=0;i<t.length;++i){const c=t[i],u=i===t.length-1?c!==Ae(e.slice(i)):!0;V(t[i]===e[i]||!u,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(t,") does not match the provided ")+"shape (".concat(e,"). "))}}return!lr(s)&&!Array.isArray(s)&&(s=[s]),e=e||t,s=n!=="string"?ec(s,n):Bl(s,[],!0),oe.makeTensor(s,e,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(s,e,t){const n=Hi(s,t);return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ar{static join(e){return new Ar(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(n=>lr(n)?n.buffer:n),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=t+a.byteLength;this.shards.push({buffer:a,start:t,end:o}),t=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(n===-1)throw new Error("Could not find start shard for byte ".concat(e));const a=t-e,o=new ArrayBuffer(a),i=new Uint8Array(o);let c=0;for(let u=n;u<this.shards.length;u++){const h=this.shards[u],f=e+c-h.start,g=c,y=Math.min(t,h.end)-h.start,v=new Uint8Array(h.buffer,f,y-f);if(i.set(v,g),c+=v.length,t<h.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(a){return e<a.start?-1:e>=a.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const n=$7(this.shards,t);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function $7(s,e){let t=0,n=s.length;for(;t<=n;){const a=Math.floor((n-t)/2)+t,o=e(s[a]);if(o===0)return a;o<0?n=a:t=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(){return oe}function _4(){return oe.memory()}function me(s,e){return oe.tidy(s,e)}function Ct(s){Qk(s).forEach(t=>t.dispose())}function un(s){return oe.keep(s)}function A7(s){return oe.setBackend(s)}function E7(){return oe.ready()}function D7(){return oe.backendName}function rj(s,e,t=1){return oe.registerBackend(s,e,t)}function oj(){return oe.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oi=4;async function q1(s,e){const t=[],n=[],a=Array.isArray(s)?s.map(i=>i.name):Object.keys(s);for(let i=0;i<a.length;++i){const c=a[i],u=Array.isArray(s)?s[i].tensor:s[c];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(u.dtype));const h={name:c,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const p=new Promise(async f=>{const g=await u.bytes(),b=g.reduce((w,N)=>w+N.length,0)+Oi*g.length,y=new Uint8Array(b);let v=0;for(let w=0;w<g.length;w++){const N=g[w],C=new Uint8Array(new Uint32Array([N.length]).buffer);y.set(C,v),v+=Oi,y.set(N,v),v+=N.length}f(y)});n.push(p)}else n.push(u.data());e!=null&&(h.group=e),t.push(h)}const o=await Promise.all(n);return{data:O7(o),specs:t}}function ij(s,e){const t=new Ar(s),n={};let a=0;for(const o of e){const i=R7(o,(c,u)=>t.slice(a+c,a+u));n[o.name]=lj(o,t.slice(a,a+i)),a+=i}return n}function R7(s,e){const t=Ae(s.shape);let n;if("quantization"in s){const a=s.quantization;n=Vl[a.dtype]}else if(s.dtype==="string"){let a=0;for(let o=0;o<t;o++)a+=Oi+new Uint32Array(e(a,a+Oi))[0];return a}else n=Vl[s.dtype];return t*n}async function _7(s,e){const t=Ae(s.shape);let n;if("quantization"in s){const a=s.quantization;n=Vl[a.dtype]}else if(s.dtype==="string"){let a=0;for(let o=0;o<t;o++)a+=Oi+new Uint32Array(await e(a,a+Oi))[0];return a}else n=Vl[s.dtype];return t*n}function lj(s,e){const t=s.name,n=s.dtype,a=s.shape,o=Ae(a);let i,c=0;if("quantization"in s){const u=s.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error("Weight ".concat(s.name," with quantization ").concat(u.dtype," ")+"doesn't have corresponding metadata min and scale.")}else if(u.dtype==="float16"){if(n!=="float32")throw new Error("Weight ".concat(s.name," is quantized with ").concat(u.dtype," ")+"which only supports weights of type float32 not ".concat(n,"."))}else throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(u.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");const h=Vl[u.dtype],p=u.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(n==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){i=new Float32Array(p.length);for(let f=0;f<p.length;f++){const g=p[f];i[f]=g*u.scale+u.min}}else if(u.dtype==="float16")i=B7()(p);else throw new Error("Unsupported quantization type ".concat(u.dtype," ")+"for weight type float32.");else if(n==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error("Unsupported quantization type ".concat(u.dtype," ")+"for weight type int32.");i=new Int32Array(p.length);for(let f=0;f<p.length;f++){const g=p[f];i[f]=Math.round(g*u.scale+u.min)}}else throw new Error("Unsupported dtype in weight '".concat(t,"': ").concat(n));c+=o*h}else if(n==="string"){const u=Ae(s.shape);i=[];for(let h=0;h<u;h++){const p=new Uint32Array(e.slice(c,c+Oi))[0];c+=Oi;const f=new Uint8Array(e.slice(c,c+p));i.push(f),c+=p}}else{const u=Vl[n];if(n==="float32")i=new Float32Array(e);else if(n==="int32")i=new Int32Array(e);else if(n==="bool")i=new Uint8Array(e);else if(n==="complex64"){i=new Float32Array(e);const h=new Float32Array(i.length/2),p=new Float32Array(i.length/2);for(let y=0;y<h.length;y++)h[y]=i[y*2],p[y]=i[y*2+1];const f=Sr(h,a,"float32"),g=Sr(p,a,"float32"),b=_i(f,g);return f.dispose(),g.dispose(),b}else throw new Error("Unsupported dtype in weight '".concat(t,"': ").concat(n));c+=o*u}return Sr(i,a,n)}async function O4(s,e,t){let n=new Uint8Array(e);for(;n.byteLength<t;){const{done:a,value:o}=await s.read();if(a&&o==null){const c=t-n.byteLength;throw new Error("Reader is done but ".concat(c," bytes are still expected"))}const i=new Uint8Array(n.length+o.byteLength);i.set(n,0),i.set(new Uint8Array(o),n.length),n=i}return n.buffer}async function cj(s,e){const t={},n=s.getReader();let a=new ArrayBuffer(0);for(const o of e){const i=await _7(o,async(h,p)=>(a=await O4(n,a,p),a.slice(h,p)));a=await O4(n,a,i);const c=a.slice(0,i);a=a.slice(i);const u=lj(o,c);if(t[o.name]=u,D7()==="webgpu"){const h=oj();"uploadToGPU"in h&&Ae(u.shape)>=Se().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&h.uploadToGPU(u.dataId)}}return t}function O7(s){if(s===null)throw new Error("Invalid input value: ".concat(JSON.stringify(s)));let e=0;const t=[];s.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(o.constructor.name))});const n=new Uint8Array(e);let a=0;return t.forEach(o=>{n.set(new Uint8Array(o.buffer),a),a+=o.byteLength}),n.buffer}const G2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function F4(s){return G2?Buffer.byteLength(s,"utf8"):new Blob([s]).size}function F7(s){if(G2)return Buffer.from(s).toString("base64");const e=new Uint8Array(s);let t="";for(let n=0,a=e.length;n<a;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function L7(s){if(G2){const n=Buffer.from(s,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const e=atob(s),t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t.set([e.charCodeAt(n)],n);return t.buffer}function uj(s){return Ar.join(s)}function L4(s){const e="/";for(s=s.trim();s.endsWith(e);)s=s.slice(0,s.length-1);const t=s.split(e);return t[t.length-1]}function dj(s,e){const t={modelTopology:s.modelTopology,format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy,weightsManifest:e};return s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(t.initializerSignature=s.initializerSignature),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig),t}function hj(s,e,t){const n={modelTopology:s.modelTopology,format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy};if(s.trainingConfig!=null&&(n.trainingConfig=s.trainingConfig),s.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");n.weightSpecs=e,n.weightData=t}return s.signature!=null&&(n.signature=s.signature),s.userDefinedMetadata!=null&&(n.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(n.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(n.initializerSignature=s.initializerSignature),n}async function W2(s,e){let t,n;return s.weightsManifest!=null&&([t,n]=await e(s.weightsManifest)),hj(s,t,n)}function Sp(s){if(s.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:s.modelTopology==null?0:F4(JSON.stringify(s.modelTopology)),weightSpecsBytes:s.weightSpecs==null?0:F4(JSON.stringify(s.weightSpecs)),weightDataBytes:s.weightData==null?0:new Ar(s.weightData).byteLength}}function K1(s){const e=[];for(const t of s)e.push(...t.weights);return e}function M7(){const s=t=>{let n=t<<13,a=0;for(;(n&8388608)===0;)a-=8388608,n<<=1;return n&=-8388609,a+=947912704,n|a},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=s(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function z7(){const s=new Uint32Array(64);s[0]=0,s[31]=1199570944,s[32]=2147483648,s[63]=3347054592;for(let e=1;e<31;e++)s[e]=e<<23;for(let e=33;e<63;e++)s[e]=2147483648+(e-32<<23);return s}function P7(){const s=new Uint32Array(64);for(let e=0;e<64;e++)s[e]=1024;return s[0]=s[32]=0,s}function B7(){const s=M7(),e=z7(),t=P7();return n=>{const a=new ArrayBuffer(4*n.length),o=new Uint32Array(a);for(let i=0;i<n.length;i++){const c=n[i],u=s[t[c>>10]+(c&1023)]+e[c>>10];o[i]=u}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ys{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ys.instance==null&&(ys.instance=new ys),ys.instance}static registerSaveRouter(e){ys.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ys.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ys.getHandlers(e,"save")}static getLoadHandlers(e,t){return ys.getHandlers(e,"load",t)}static getHandlers(e,t,n){const a=[];return(t==="load"?ys.getInstance().loadRouters:ys.getInstance().saveRouters).forEach(i=>{const c=i(e,n);c!==null&&a.push(c)}),a}}const V7=s=>ys.registerSaveRouter(s),U7=s=>ys.registerLoadRouter(s),pj=s=>ys.getSaveHandlers(s),G7=(s,e)=>ys.getLoadHandlers(s,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X1="tensorflowjs",Y1=1,Rl="models_store",ji="model_info_store";function fj(){if(!Se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const s=typeof window>"u"?self:window,e=s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB||s.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Z1(s){const e=s.result;e.createObjectStore(Rl,{keyPath:"modelPath"}),e.createObjectStore(ji,{keyPath:"modelPath"})}class Ul{constructor(e){if(this.indexedDB=fj(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,a)=>{const o=this.indexedDB.open(X1,Y1);o.onupgradeneeded=()=>Z1(o),o.onsuccess=()=>{const i=o.result;if(t==null){const c=i.transaction(Rl,"readonly"),h=c.objectStore(Rl).get(this.modelPath);h.onsuccess=()=>{if(h.result==null)return i.close(),a(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));n(h.result.modelArtifacts)},h.onerror=p=>(i.close(),a(h.error)),c.oncomplete=()=>i.close()}else{t.weightData=Ar.join(t.weightData);const c=Sp(t),u=i.transaction(ji,"readwrite");let h=u.objectStore(ji),p;try{p=h.put({modelPath:this.modelPath,modelArtifactsInfo:c})}catch(g){return a(g)}let f;p.onsuccess=()=>{f=i.transaction(Rl,"readwrite");const g=f.objectStore(Rl);let b;try{b=g.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:c})}catch(y){return a(y)}b.onsuccess=()=>n({modelArtifactsInfo:c}),b.onerror=y=>{h=u.objectStore(ji);const v=h.delete(this.modelPath);v.onsuccess=()=>(i.close(),a(b.error)),v.onerror=w=>(i.close(),a(b.error))}},p.onerror=g=>(i.close(),a(p.error)),u.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}}},o.onerror=i=>a(o.error)})}}Ul.URL_SCHEME="indexeddb://";const mj=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Ul.URL_SCHEME)?W7(s.slice(Ul.URL_SCHEME.length)):null;ys.registerSaveRouter(mj);ys.registerLoadRouter(mj);function W7(s){return new Ul(s)}function H7(s){return s.startsWith(Ul.URL_SCHEME)?s.slice(Ul.URL_SCHEME.length):s}class q7{constructor(){this.indexedDB=fj()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(X1,Y1);n.onupgradeneeded=()=>Z1(n),n.onsuccess=()=>{const a=n.result,o=a.transaction(ji,"readonly"),c=o.objectStore(ji).getAll();c.onsuccess=()=>{const u={};for(const h of c.result)u[h.modelPath]=h.modelArtifactsInfo;e(u)},c.onerror=u=>(a.close(),t(c.error)),o.oncomplete=()=>a.close()},n.onerror=a=>t(n.error)})}async removeModel(e){return e=H7(e),new Promise((t,n)=>{const a=this.indexedDB.open(X1,Y1);a.onupgradeneeded=()=>Z1(a),a.onsuccess=()=>{const o=a.result,i=o.transaction(ji,"readwrite"),c=i.objectStore(ji),u=c.get(e);let h;u.onsuccess=()=>{if(u.result==null)return o.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const p=c.delete(e),f=()=>{h=o.transaction(Rl,"readwrite");const b=h.objectStore(Rl).delete(e);b.onsuccess=()=>t(u.result.modelArtifactsInfo),b.onerror=y=>n(u.error)};p.onsuccess=f,p.onerror=g=>(f(),o.close(),n(u.error))}},u.onerror=p=>(o.close(),n(u.error)),i.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}},a.onerror=o=>n(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Do="/",lu="tensorflowjs_models",gj="info",K7="model_topology",X7="weight_specs",Y7="weight_data",Z7="model_metadata";function xj(s){return{info:[lu,s,gj].join(Do),topology:[lu,s,K7].join(Do),weightSpecs:[lu,s,X7].join(Do),weightData:[lu,s,Y7].join(Do),modelMetadata:[lu,s,Z7].join(Do)}}function bj(s){for(const e of Object.values(s))window.localStorage.removeItem(e)}function Q7(s){const e=s.split(Do);if(e.length<3)throw new Error("Invalid key format: ".concat(s));return e.slice(1,e.length-1).join(Do)}function J7(s){return s.startsWith(Gl.URL_SCHEME)?s.slice(Gl.URL_SCHEME.length):s}class Gl{constructor(e){if(!Se().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=xj(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=Sp(e),o=Ar.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,F7(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch(i){throw bj(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=a;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const c=JSON.parse(o);t.format=c.format,t.generatedBy=c.generatedBy,t.convertedBy=c.convertedBy,c.signature!=null&&(t.signature=c.signature),c.userDefinedMetadata!=null&&(t.userDefinedMetadata=c.userDefinedMetadata),c.modelInitializer!=null&&(t.modelInitializer=c.modelInitializer),c.initializerSignature!=null&&(t.initializerSignature=c.initializerSignature),c.trainingConfig!=null&&(t.trainingConfig=c.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=L7(i),t}}Gl.URL_SCHEME="localstorage://";const yj=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Gl.URL_SCHEME)?eL(s.slice(Gl.URL_SCHEME.length)):null;ys.registerSaveRouter(yj);ys.registerLoadRouter(yj);function eL(s){return new Gl(s)}class tL{constructor(){V(Se().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),V(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=lu+Do,n=Do+gj;for(let a=0;a<this.LS.length;++a){const o=this.LS.key(a);if(o.startsWith(t)&&o.endsWith(n)){const i=Q7(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=J7(e);const t=xj(e);if(this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '".concat(e,"'"));const n=JSON.parse(this.LS.getItem(t.info));return bj(t),n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hu="://";class Mn{constructor(){this.managers={}}static getInstance(){return Mn.instance==null&&(Mn.instance=new Mn),Mn.instance}static registerManager(e,t){V(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(hu)&&(e=e.slice(0,e.indexOf(hu))),V(e.length>0,()=>"scheme must not be an empty string.");const n=Mn.getInstance();V(n.managers[e]==null,()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){const t=Mn.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(Mn.getInstance().managers)}}function vm(s){if(s.indexOf(hu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Mn.getSchemes().join(",")));return{scheme:s.split(hu)[0],path:s.split(hu)[1]}}async function vj(s,e,t=!1){V(s!==e,()=>"Old path and new path are the same: '".concat(s,"'"));const n=ys.getLoadHandlers(s);V(n.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(s,".")),V(n.length<2,()=>"Copying failed because more than one (".concat(n.length,") ")+"load handlers for source URL ".concat(s,"."));const a=n[0],o=ys.getSaveHandlers(e);V(o.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,".")),V(o.length<2,()=>"Copying failed because more than one (".concat(n.length,") ")+"save handlers for destination URL ".concat(e,"."));const i=o[0],c=vm(s).scheme,u=vm(s).path,h=c===vm(s).scheme,p=await a.load();t&&h&&await Mn.getManager(c).removeModel(u);const f=await i.save(p);return t&&!h&&await Mn.getManager(c).removeModel(u),f.modelArtifactsInfo}async function sL(){const s=Mn.getSchemes(),e={};for(const t of s){const n=await Mn.getManager(t).listModels();for(const a in n){const o=t+hu+a;e[o]=n[a]}}return e}async function nL(s){const e=vm(s);return Mn.getManager(e.scheme).removeModel(e.path)}async function aL(s,e){return vj(s,e,!1)}async function rL(s,e){return vj(s,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oL{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Se().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();const a=this.functionRefs[n.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return Gk(e)}}if(Se().get("IS_BROWSER")){Se().setPlatform("browser",new oL);try{Mn.registerManager(Gl.URL_SCHEME,new tL)}catch(s){}try{Mn.registerManager(Ul.URL_SCHEME,new q7)}catch(s){}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iL={importFetch:()=>require("node-fetch")};let h1;class lL{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Se().global.fetch!=null?Se().global.fetch(e,t):(h1==null&&(h1=iL.importFetch()),h1(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Se().get("IS_NODE")&&!Se().get("IS_BROWSER")&&Se().setPlatform("node",new lL);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $t(s,e="float32",t){return e=e||"float32",La(s),new Zs(s,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(s,e){const t=W(s,"x","cast");if(!G8(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const n={x:t},a={dtype:e};return oe.runKernel(Oh,n,a)}const qe=te({cast_:cL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uL(s){const t={x:W(s,"x","clone","string_or_numeric")};return oe.runKernel(Kh,t)}const Ro=te({clone_:uL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wj(s,e=!1){console.log(s.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ej();const dL={buffer:$t,cast:qe,clone:Ro,print:wj};w7(dL);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(s,e){let t=W(s,"a","add"),n=W(e,"b","add");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(Ru,a)}const Fe=te({add_:hL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(s,e){let t=W(s,"a","floorDiv"),n=W(e,"b","floorDiv");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(Hh,a)}const H2=te({floorDiv_:pL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fL(s,e){let t=W(s,"a","div"),n=W(e,"b","div");if([t,n]=Is(t,n),t.dtype==="int32"&&n.dtype==="int32")return H2(t,n);const a={a:t,b:n},o={};return oe.runKernel(Ph,a,o)}const Ze=te({div_:fL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mL(s,e){let t=W(s,"a","mul"),n=W(e,"b","mul");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(np,a)}const ne=te({mul_:mL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(s){const e=W(s,"x","abs");if(e.dtype==="complex64"){const t={x:e};return oe.runKernel(bg,t)}else{const t={x:e};return oe.runKernel(cg,t)}}const qs=te({abs_:gL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xL(s){const t={x:W(s,"x","acos")};return oe.runKernel(Ih,t)}const Nj=te({acos_:xL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bL(s){const t={x:W(s,"x","acosh")};return oe.runKernel($h,t)}const Sj=te({acosh_:bL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yL(s){V(Array.isArray(s),()=>"The argument passed to tf.addN() must be a list of tensors"),V(s.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(s.length));const e=s.map((a,o)=>W(a,"tensors".concat(o),"addN")),t=e[0];e.forEach(a=>{if(a.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!Mt(a.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const n=e;return oe.runKernel(ug,n)}const vL=te({addN_:yL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wL(s,e=null,t=!1){const a={x:W(s,"x","all","bool")},o={axis:e,keepDims:t};return oe.runKernel(zy,a,o)}const q2=te({all_:wL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(s,e=null,t=!1){const a={x:W(s,"x","any","bool")},o={axis:e,keepDims:t};return oe.runKernel(Py,a,o)}const Lm=te({any_:NL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(s,e=0){const n={x:W(s,"x","argMax")},a={axis:e};return oe.runKernel(dg,n,a)}const yu=te({argMax_:SL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(s,e=0){const n={x:W(s,"x","argMin")},a={axis:e};return oe.runKernel(hg,n,a)}const Cj=te({argMin_:CL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(s){const t={x:W(s,"x","asin")};return oe.runKernel(Ah,t)}const kj=te({asin_:kL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jL(s){const t={x:W(s,"x","asinh")};return oe.runKernel(Eh,t)}const jj=te({asinh_:jL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(s){const t={x:W(s,"x","atan")};return oe.runKernel(Dh,t)}const Tj=te({atan_:TL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(s,e){let t=W(s,"a","atan2"),n=W(e,"b","atan2");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(_h,a)}const Ij=te({atan2_:IL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(s){const t={x:W(s,"x","atanh")};return oe.runKernel(Rh,t)}const $j=te({atanh_:$L});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cp(s,e,t,n,a="NHWC",o){const i=s[3],c=[...e,i],u=Go(a);return hn(s,c,t,o,n,null,null,u)}function dr(s,e,t,n,a,o,i="channelsLast"){const[c,u]=dh(e);let h;if(i==="channelsLast")h=[c,u,s[3],s[3]];else if(i==="channelsFirst")h=[c,u,s[1],s[1]];else throw new Error("Unknown dataFormat ".concat(i));return hn(s,h,t,n,a,o,!1,i)}function Uo(s,e,t,n,a,o,i="NDHWC"){const[c,u,h]=Q1(e);let p,f;if(i==="NDHWC")f="channelsLast",p=[c,u,h,s[4],s[4]];else if(i==="NCDHW")f="channelsFirst",p=[c,u,h,s[1],s[1]];else throw new Error("Unknown dataFormat ".concat(i));return Ki(s,p,t,n,a,!1,f,o)}function hn(s,e,t,n,a,o,i=!1,c="channelsLast"){let[u,h,p,f]=[-1,-1,-1,-1];if(c==="channelsLast")[u,h,p,f]=s;else if(c==="channelsFirst")[u,f,h,p]=s;else throw new Error("Unknown dataFormat ".concat(c));const[g,b,,y]=e,[v,w]=dh(t),[N,C]=dh(n),I=pu(g,N),T=pu(b,C),{padInfo:$,outHeight:E,outWidth:_}=DL(a,h,p,v,w,I,T,o,c),L=i?y*f:y;let O;return c==="channelsFirst"?O=[u,L,E,_]:c==="channelsLast"&&(O=[u,E,_,L]),{batchSize:u,dataFormat:c,inHeight:h,inWidth:p,inChannels:f,outHeight:E,outWidth:_,outChannels:L,padInfo:$,strideHeight:v,strideWidth:w,filterHeight:g,filterWidth:b,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationHeight:N,dilationWidth:C,inShape:s,outShape:O,filterShape:e}}function Ki(s,e,t,n,a,o=!1,i="channelsLast",c){let[u,h,p,f,g]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,h,p,f,g]=s;else if(i==="channelsFirst")[u,g,h,p,f]=s;else throw new Error("Unknown dataFormat ".concat(i));const[b,y,v,,w]=e,[N,C,I]=Q1(t),[T,$,E]=Q1(n),_=pu(b,T),L=pu(y,$),O=pu(v,E),{padInfo:z,outDepth:A,outHeight:U,outWidth:X}=RL(a,h,p,f,N,C,I,_,L,O,c),Z=o?w*g:w;let q;return i==="channelsFirst"?q=[u,Z,A,U,X]:i==="channelsLast"&&(q=[u,A,U,X,Z]),{batchSize:u,dataFormat:i,inDepth:h,inHeight:p,inWidth:f,inChannels:g,outDepth:A,outHeight:U,outWidth:X,outChannels:Z,padInfo:z,strideDepth:N,strideHeight:C,strideWidth:I,filterDepth:b,filterHeight:y,filterWidth:v,effectiveFilterDepth:_,effectiveFilterHeight:L,effectiveFilterWidth:O,dilationDepth:T,dilationHeight:$,dilationWidth:E,inShape:s,outShape:q,filterShape:e}}function AL(s,e,t,n,a){n==null&&(n=K2(s,e,t));const o=s[0],i=s[1],c=hh((o-e+2*n)/t+1,a),u=hh((i-e+2*n)/t+1,a);return[c,u]}function EL(s,e,t,n,a,o){a==null&&(a=K2(s,e[0],n[0]));const i=[0,0,0,t];for(let c=0;c<3;c++)s[c]+2*a>=e[c]&&(i[c]=hh((s[c]-e[c]+2*a)/n[c]+1,o));return i}function K2(s,e,t,n=1){const a=pu(e,n);return Math.floor((s[0]*(t-1)-t+a)/2)}function dh(s){return typeof s=="number"?[s,s,s]:s.length===2?[s[0],s[1],1]:s}function Q1(s){return typeof s=="number"?[s,s,s]:s}function pu(s,e){return e<=1?s:s+(s-1)*(e-1)}function DL(s,e,t,n,a,o,i,c,u){let h,p,f;if(typeof s=="number"){h={top:s,bottom:s,left:s,right:s,type:s===0?"VALID":"NUMBER"};const b=AL([e,t],o,n,s,c);p=b[0],f=b[1]}else if(s==="same"){p=Math.ceil(e/n),f=Math.ceil(t/a);const g=Math.max(0,(p-1)*n+o-e),b=Math.max(0,(f-1)*a+i-t),y=Math.floor(g/2),v=g-y,w=Math.floor(b/2),N=b-w;h={top:y,bottom:v,left:w,right:N,type:"SAME"}}else if(s==="valid")h={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((e-o+1)/n),f=Math.ceil((t-i+1)/a);else if(typeof s=="object"){const g=u==="channelsLast"?s[1][0]:s[2][0],b=u==="channelsLast"?s[1][1]:s[2][1],y=u==="channelsLast"?s[2][0]:s[3][0],v=u==="channelsLast"?s[2][1]:s[3][1];h={top:g,bottom:b,left:y,right:v,type:g===0&&b===0&&y===0&&v===0?"VALID":"EXPLICIT"},p=hh((e-o+g+b)/n+1,c),f=hh((t-i+y+v)/a+1,c)}else throw Error("Unknown padding parameter: ".concat(s));return{padInfo:h,outHeight:p,outWidth:f}}function RL(s,e,t,n,a,o,i,c,u,h,p){let f,g,b,y;if(s==="valid"&&(s=0),typeof s=="number"){f={top:s,bottom:s,left:s,right:s,front:s,back:s,type:s===0?"VALID":"NUMBER"};const w=EL([e,t,n,1],[c,u,h],1,[a,o,i],s,p);g=w[0],b=w[1],y=w[2]}else if(s==="same"){g=Math.ceil(e/a),b=Math.ceil(t/o),y=Math.ceil(n/i);const v=(g-1)*a+c-e,w=(b-1)*o+u-t,N=(y-1)*i+h-n,C=Math.floor(v/2),I=v-C,T=Math.floor(w/2),$=w-T,E=Math.floor(N/2),_=N-E;f={top:T,bottom:$,left:E,right:_,front:C,back:I,type:"SAME"}}else throw Error("Unknown padding parameter: ".concat(s));return{padInfo:f,outDepth:g,outHeight:b,outWidth:y}}function hh(s,e){if(!e)return Math.trunc(s);switch(e){case"round":return Math.round(s);case"ceil":return Math.ceil(s);case"floor":return Math.floor(s);default:throw new Error("Unknown roundingMode ".concat(e))}}function Fi(s){const[e,t,n]=dh(s);return e===1&&t===1&&n===1}function Nn(s,e){return Fi(s)||Fi(e)}function Wl(s){return dh(s).every(e=>e>0)}function Go(s){if(s==="NHWC")return"channelsLast";if(s==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat ".concat(s))}function Gn(s,e,t){if(t!=null){if(typeof e=="string")throw Error("Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(e,"."));if(typeof e=="number")V(xu(e),()=>"Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(e,"."));else if(typeof e=="object")e.forEach(n=>{n.forEach(a=>{V(xu(a),()=>"Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(a,"."))})});else throw Error("Error in ".concat(s,": Unknown padding parameter: ").concat(e))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _L(s,e){const n={x:W(s,"x","reshape","string_or_numeric")},a={shape:e};return oe.runKernel(Qg,n,a)}const le=te({reshape_:_L});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OL(s,e,t,n,a){const o=W(s,"x","avgPool","float32"),i=1;V(Nn(t,i),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(i,"'"));let c=o,u=!1;o.rank===3&&(u=!0,c=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(c.rank===4,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(c.rank,".")),Gn("avgPool",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a};let f=oe.runKernel(pg,h,p);return f=qe(f,o.dtype),u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const px=te({avgPool_:OL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FL(s,e,t,n,a,o="NDHWC"){const i=W(s,"x","avgPool3d","float32");let c=i,u=!1;i.rank===4&&(u=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(c.rank===5,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(c.rank,".")),V(o==="NDHWC",()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),V(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(t,"'")),Gn("avgPool3d",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a,dataFormat:o};let f=oe.runKernel(fg,h,p);return f=qe(f,c.dtype),u?le(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Aj=te({avgPool3d_:FL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(s,e=0){V(s.length>=1,()=>"Pass at least one tensor to concat");const t=Fm(s,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(o.dtype,". "))}),t.length===1)return Ro(t[0]);const n=t,a={axis:e};return oe.runKernel(yg,n,a)}const Ts=te({concat_:LL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(s,e,t=!1,n=!1){let a=W(s,"a","matMul"),o=W(e,"b","matMul");[a,o]=Is(a,o);const i={a,b:o},c={transposeA:t,transposeB:n};return oe.runKernel(mg,i,c)}const _t=te({matMul_:ML});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zL(s){const t={x:W(s,"x","sigmoid","float32")};return oe.runKernel(fp,t)}const Cr=te({sigmoid_:zL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(s,e,t){const n=W(s,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");const a={x:n},o={begin:e,size:t};return oe.runKernel(nx,a,o)}const xt=te({slice_:PL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(s){const t={x:W(s,"x","tanh","float32")};return oe.runKernel(vp,t)}const Hl=te({tanh_:BL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(s,e,t,n,a,o){const i=W(s,"forgetBias","basicLSTMCell"),c=W(e,"lstmKernel","basicLSTMCell"),u=W(t,"lstmBias","basicLSTMCell"),h=W(n,"data","basicLSTMCell"),p=W(a,"c","basicLSTMCell"),f=W(o,"h","basicLSTMCell"),g=Ts([h,f],1),b=_t(g,c),y=Fe(b,u),v=y.shape[0],w=y.shape[1]/4,N=[v,w],C=xt(y,[0,0],N),I=xt(y,[0,w],N),T=xt(y,[0,w*2],N),$=xt(y,[0,w*3],N),E=Fe(ne(Cr(C),Hl(I)),ne(p,Cr(Fe(i,T)))),_=ne(Hl(E),Cr($));return[E,_]}const UL=te({basicLSTMCell_:VL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(s,e,t){const n=W(s,"x","batchToSpaceND"),a=e.reduce((c,u)=>c*u);V(n.rank>=1+e.length,()=>"input rank is ".concat(n.rank," but should be > than blockShape.length ").concat(e.length)),V(t.length===e.length,()=>"crops.length is ".concat(t.length," but should be equal to blockShape.length  ").concat(e.length)),V(n.shape[0]%a===0,()=>"input tensor batch is ".concat(n.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(a));const o={x:n},i={blockShape:e,crops:t};return oe.runKernel(gg,o,i)}const fx=te({batchToSpaceND_:GL});function WL(s){let e;return s.rank===0||s.rank===1?e=le(s,[1,1,1,s.size]):s.rank===2?e=le(s,[1,1,s.shape[0],s.shape[1]]):s.rank===3?e=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]):e=s,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(s,e,t,n,a,o){o==null&&(o=.001);const i=W(s,"x","batchNorm"),c=W(e,"mean","batchNorm"),u=W(t,"variance","batchNorm");let h;a!=null&&(h=W(a,"scale","batchNorm"));let p;n!=null&&(p=W(n,"offset","batchNorm")),V(c.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(p==null||c.rank===p.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(h==null||c.rank===h.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const g={x:WL(i),scale:h,offset:p,mean:c,variance:u},b={varianceEpsilon:o},y=oe.runKernel(Ig,g,b);return le(y,i.shape)}const kp=te({batchNorm_:HL});function qL(s,e,t,n,a,o){const i=W(s,"x","batchNorm"),c=W(e,"mean","batchNorm"),u=W(t,"variance","batchNorm");let h;a!=null&&(h=W(a,"scale","batchNorm"));let p;return n!=null&&(p=W(n,"offset","batchNorm")),V(i.rank===2,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(i.rank,".")),V(c.rank===2||c.rank===1,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===2||u.rank===1,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===2||h.rank===1,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===2||p.rank===1,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const Ej=te({batchNorm2d_:qL});function KL(s,e,t,n,a,o){const i=W(s,"x","batchNorm"),c=W(e,"mean","batchNorm"),u=W(t,"variance","batchNorm");let h;a!=null&&(h=W(a,"scale","batchNorm"));let p;return n!=null&&(p=W(n,"offset","batchNorm")),V(i.rank===3,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(i.rank,".")),V(c.rank===3||c.rank===1,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===3||u.rank===1,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===3||h.rank===1,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===3||p.rank===1,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const Dj=te({batchNorm3d_:KL});function XL(s,e,t,n,a,o){const i=W(s,"x","batchNorm"),c=W(e,"mean","batchNorm"),u=W(t,"variance","batchNorm");let h;a!=null&&(h=W(a,"scale","batchNorm"));let p;return n!=null&&(p=W(n,"offset","batchNorm")),V(i.rank===4,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(i.rank,".")),V(c.rank===4||c.rank===1,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===4||u.rank===1,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===4||h.rank===1,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===4||p.rank===1,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const Rj=te({batchNorm4d_:XL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(s,e,t){const n=W(s,"x","bincount"),a=W(e,"weights","bincount");V(n.dtype==="int32",()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(n.dtype)),V(t>=0,()=>"size must be non-negative, but got ".concat(t,".")),V(a.size===n.size||a.size===0,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(n.shape,", weights shape: ")+"".concat(a.shape,"."));const o={x:n,weights:a},i={size:t};return oe.runKernel(Uy,o,i)}const _j=te({bincount_:YL});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZL(s,e){const t=W(s,"x","bitwiseAnd"),n=W(e,"y","bitwiseAnd");if(!Mt(t.shape,n.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(t.shape,", y: ").concat(n.shape));if(t.dtype!=="int32"||n.dtype!=="int32")throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(t.dtype," and type of y: ").concat(n.dtype));const a={a:t,b:n};return oe.runKernel(xg,a)}const QL=te({bitwiseAnd_:ZL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(s,e){const t=W(s,"s0","broadcastArgs","int32"),n=W(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(t.rank));if(n.rank!==1)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(n.rank));const a={s0:t,s1:n};return oe.runKernel(Gy,a)}const eM=te({broadcastArgs_:JL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tM(s,e){let t=W(s,"broadcastTo","x");const n=t.shape;if(La(e),e.length<t.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(t.rank,"."));if(e.length>t.rank){const h=t.shape.slice();for(;h.length<e.length;)h.unshift(1);t=le(t,h)}const a=t.shape,o=Array.from(e);for(let h=e.length-1;h>=0;h--)if(a[h]===e[h])o[h]=1;else if(t.shape[h]!==1)throw new Error("broadcastTo(): [".concat(n,"] cannot be broadcast to [").concat(e,"]."));if(o.map((h,p)=>h>1?p:-1).filter(h=>h>=0).length===0)return Ro(t);const c={x:t},u={reps:o};return oe.runKernel(wp,c,u)}const fu=te({broadcastTo_:tM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sM(s){const t={x:W(s,"x","ceil","float32")};return oe.runKernel(Fh,t)}const Oj=te({ceil_:sM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(s,e,t){La(s),t=t||Eu(e);const n={shape:s,value:e,dtype:t};return oe.runKernel(r2,{},n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nM(s,e,t){const n=W(s,"x","clipByValue");if(V(e<=t,()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(t,").")),e===t)return _u(n.shape,e,n.dtype);const a={x:n},o={clipValueMin:e,clipValueMax:t};return oe.runKernel(Lh,a,o)}const sa=te({clipByValue_:nM});function aM(s){return Ts(s,0)}const Fj=te({concat1d_:aM});function rM(s,e){return Ts(s,e)}const Lj=te({concat2d_:rM});function oM(s,e){return Ts(s,e)}const Mj=te({concat3d_:oM});function iM(s,e){return Ts(s,e)}const zj=te({concat4d_:iM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lM(s,e,t,n,a="NHWC",o=[1,1],i){const c=W(s,"x","conv2d","float32"),u=W(e,"filter","conv2d","float32");let h=c,p=!1;c.rank===3&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(h.rank===4,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(h.rank,".")),V(u.rank===4,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")),Gn("conv2d",n,i);const f=a==="NHWC"?h.shape[3]:h.shape[1];V(f===u.shape[2],()=>"Error in conv2d: depth of input (".concat(f,") must match ")+"input depth for filter ".concat(u.shape[2],".")),V(Nn(t,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'")),V(Wl(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv2D: Strides should be larger than 0.");const g={x:h,filter:u},b={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i},y=oe.runKernel(vg,g,b);return p?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Li=te({conv2d_:lM});function cM(s,e,t,n,a="NWC",o=1,i){const c=W(s,"x","conv1d"),u=W(e,"filter","conv1d");let h=c,p=!1;c.rank===2&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1]])),V(h.rank===3,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(h.rank,".")),V(u.rank===3,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")),Gn("conv1d",n,i),V(h.shape[2]===u.shape[1],()=>"Error in conv1d: depth of input (".concat(h.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")),V(Nn(t,o),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(t," and dilation '").concat(o,"'")),V(Wl(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv1D: Stride should be larger than 0."),V(a==="NWC",()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));const f=le(u,[1,u.shape[0],u.shape[1],u.shape[2]]),g=le(h,[h.shape[0],1,h.shape[1],h.shape[2]]),w=Li(g,f,[1,t],n,"NHWC",[1,o],i);return p?le(w,[w.shape[2],w.shape[3]]):le(w,[w.shape[0],w.shape[2],w.shape[3]])}const X2=te({conv1d_:cM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(s,e,t,n,a,o="NHWC",i){V(s.length===e.rank,()=>"Length of inShape "+"(".concat(s.length,") and rank of dy (").concat(e.rank,") must match"));let c=s,u=e,h=!1;e.rank===3&&(h=!0,u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]),c=[1,s[0],s[1],s[2]]),V(c.length===4,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(c.length,".")),V(u.rank===4,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)),V(t.rank===4,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(t.rank));const p=o==="NHWC"?c[3]:c[1],f=o==="NHWC"?u.shape[3]:u.shape[1];V(p===t.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(p,") must ")+"match input depth for filter ".concat(t.shape[2],".")),V(f===t.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(t.shape[3],".")),Gn("conv2dDerInput",a,i);const g={dy:u,filter:t},b={strides:n,pad:a,dataFormat:o,dimRoundingMode:i,inputShape:c},y=oe.runKernel(wg,g,b);return h?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Y2=te({conv2DBackpropInput_:uM});function dM(s,e,t,n,a,o){const i=W(s,"x","conv2dTranspose"),c=W(e,"filter","conv2dTranspose");return Y2(t,i,c,n,a,"NHWC",o)}const Z2=te({conv2dTranspose_:dM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hM(s,e,t,n,a="NDHWC",o=[1,1,1]){const i=W(s,"x","conv3d"),c=W(e,"filter","conv3d");let u=i,h=!1;i.rank===4&&(h=!0,u=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(u.rank===5,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")),V(c.rank===5,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(c.rank,".")),V(u.shape[4]===c.shape[3],()=>"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(c.shape[3],".")),V(Nn(t,o),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'")),V(a==="NDHWC",()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")),V(Wl(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv3D: Strides should be larger than 0.");const p={x:u,filter:c},f={strides:t,pad:n,dataFormat:a,dilations:o},g=oe.runKernel(Ng,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Pj=te({conv3d_:hM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(s,e,t,n,a){V(s.length===e.rank,()=>"Length of inShape "+"(".concat(s.length,") and rank of dy (").concat(e.rank,") must match"));let o=s,i=e,c=!1;e.rank===4&&(c=!0,i=le(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,s[0],s[1],s[2],s[3]]);const u=o[4],h=i.shape[4];V(o.length===5,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,".")),V(i.rank===5,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)),V(t.rank===5,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(t.rank)),V(u===t.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(t.shape[3],".")),V(h===t.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(t.shape[4],"."));const p={dy:i,filter:t},f={pad:a,strides:n,inputShape:o},g=oe.runKernel(Ky,p,f);return c?le(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Bj=te({conv3DBackpropInput_:pM});function fM(s,e,t,n,a){const o=W(s,"x","conv3dTranspose"),i=W(e,"filter","conv3dTranspose");return Bj(t,o,i,n,a)}const Vj=te({conv3dTranspose_:fM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mM(s){const t={x:W(s,"x","cos","float32")};return oe.runKernel(Mh,t)}const mx=te({cos_:mM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(s){const t={x:W(s,"x","cosh","float32")};return oe.runKernel(zh,t)}const Q2=te({cosh_:gM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xM(s,e=0,t=!1,n=!1){const o={x:W(s,"x","cumprod")},i={axis:e,exclusive:t,reverse:n};return oe.runKernel(Xy,o,i)}const Mm=te({cumprod_:xM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(s,e=0,t=!1,n=!1){const o={x:W(s,"x","cumsum")},i={axis:e,exclusive:t,reverse:n};return oe.runKernel(Sg,o,i)}const J2=te({cumsum_:bM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(s,e,t,n=!1){const a=W(s,"x","denseBincount"),o=W(e,"weights","denseBincount");V(a.dtype==="int32",()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)),V(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")),V(t>=0,()=>"size must be non-negative, but got ".concat(t,".")),V(o.size===a.size||o.size===0,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(o.shape,"."));const i={x:a,weights:o},c={size:t,binaryOutput:n};return oe.runKernel(Zy,i,c)}const J1=te({denseBincount_:yM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vM(s,e,t="NHWC"){const n=W(s,"x","depthToSpace","float32"),a=t==="NHWC"?n.shape[1]:n.shape[2],o=t==="NHWC"?n.shape[2]:n.shape[3],i=t==="NHWC"?n.shape[3]:n.shape[1];V(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e)),V(a*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(n.shape)),V(o*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(e," for depthToSpace with input shape\n        ").concat(n.shape)),V(i%(e*e)===0,()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(i," for depthToSpace with input shape ").concat(n.shape));const c={x:n},u={blockSize:e,dataFormat:t};return oe.runKernel(Qy,c,u)}const Uj=te({depthToSpace_:vM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wM(s,e,t,n,a="NHWC",o=[1,1],i){const c=W(s,"x","depthwiseConv2d","float32"),u=W(e,"filter","depthwiseConv2d","float32");let h=c,p=!1;c.rank===3&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(h.rank===4,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(h.rank,".")),V(u.rank===4,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,"."));const f=a==="NHWC"?h.shape[3]:h.shape[1];V(f===u.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(f,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")),Gn("depthwiseConv2d",n,i);const g={x:h,filter:u},b={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i},y=oe.runKernel(Cg,g,b);return p?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const jp=te({depthwiseConv2d_:wM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NM(s){const t={x:W(s,"x","diag")};return oe.runKernel(t2,t)}const SM=te({diag_:NM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CM(s,e,t,n,a=[1,1],o="NHWC"){const i=W(s,"x","dilation2d"),c=W(e,"filter","dilation2d");V(i.rank===3||i.rank===4,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,".")),V(c.rank===3,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(c.rank,".")),V(o==="NHWC",()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(o));let u=i,h=!1;i.rank===3&&(u=le(i,[1,i.shape[0],i.shape[1],i.shape[2]]),h=!0),V(u.shape[3]===c.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(c.shape[2]));const p={x:u,filter:c},f={strides:t,pad:n,dilations:a},g=oe.runKernel(kg,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Gj=te({dilation2d_:CM});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vu(s,e){const t=s.length,n=[];for(let a=0;a<t;a++){const o=t-1-a,i=s[o]||1;(e[e.length-1-a]||1)>1&&i===1&&n.unshift(o)}return n}function en(s,e){const t=[];for(let n=0;n<e.length;n++){const a=s[s.length-n-1],o=e.length-n-1,i=e[o];(a==null||a===1&&i>1)&&t.unshift(o)}return t}function kt(s,e){const t=Math.max(s.length,e.length),n=new Array(t);for(let a=0;a<t;a++){let o=s[s.length-a-1];o==null&&(o=1);let i=e[e.length-a-1];if(i==null&&(i=1),o===1)n[t-a-1]=i;else if(i===1)n[t-a-1]=o;else if(o!==i){const c="Operands could not be broadcast together with shapes "+"".concat(s," and ").concat(e,".");throw Error(c)}else n[t-a-1]=o}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kM(s,e){let t=W(s,"a","equal","string_or_numeric"),n=W(e,"b","equal","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(jg,a)}const jr=te({equal_:kM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jM(s,e,t){const n=W(e,"a","where"),a=W(t,"b","where"),o=W(s,"condition","where","bool"),i=kt(kt(o.shape,n.shape),a.shape),c=fu(o,i),u=fu(n,i),h=fu(a,i),p={condition:c,t:u,e:h};return oe.runKernel(sx,p)}const $n=te({where_:jM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(s){const t={x:W(s,"x","zerosLike")};return oe.runKernel(dx,t)}const Bt=te({zerosLike_:TM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IM(s,e){let t=W(s,"a","div"),n=W(e,"b","div");[t,n]=Is(t,n);const a=Ze(t,n),o=Bt(a),i=jr(n,o);return $n(i,o,a)}const Wj=te({divNoNan_:IM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $M(s,e){const t=W(s,"t1","dot"),n=W(e,"t2","dot");V((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(t.rank," and ").concat(n.rank,"."));const a=t.rank===1?t.size:t.shape[1],o=n.rank===1?n.size:n.shape[0];if(V(a===o,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(o,".")),t.rank===1&&n.rank===1){const i=le(t,[1,-1]),c=le(n,[-1,1]),u=_t(i,c);return le(u,[])}else if(t.rank===1&&n.rank===2){const i=le(t,[1,-1]),c=le(n,[n.shape[0],n.shape[1]]),u=_t(i,c);return le(u,[u.size])}else if(t.rank===2&&n.rank===1){const i=le(n,[-1,1]),c=_t(t,i);return le(c,[c.size])}else{const i=le(n,[n.shape[0],n.shape[1]]);return _t(t,i)}}const Hj=te({dot_:$M});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(s,...e){const t=e.map((a,o)=>W(a,"tensors".concat(o),"einsum")),n={equation:s};return oe.runKernel(s2,t,n)}const cu=te({einsum_:AM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(s){const t={x:W(s,"x","elu","float32")};return oe.runKernel(Bh,t)}const Tp=te({elu_:EM});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(s,e){const t=W(s,"x","ensureShape","string_or_numeric");if(!V8(t.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(t.shape," is not compatible with expected shape ").concat(e));return s}const RM=te({ensureShape_:DM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _M(s){let e=W(s,"x","erf");V(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=qe(e,"float32"));const t={x:e};return oe.runKernel(Vh,t)}const ev=te({erf_:_M});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(s,e){for(let t=0;t<s.length;++t)if(s[s.length-t-1]!==e-1-t)return!1;return!0}function qj(s,e,t){const n=s.length+e.length,a=[];let o=0,i=0;for(let c=0;c<n;c++)t.indexOf(c)===-1?a.push(s[o++]):a.push(e[i++]);return a}function pn(s,e){const t=[],n=s.length;for(let o=0;o<n;o++)e.indexOf(o)===-1&&t.push(s[o]);const a=e.map(o=>s[o]);return[t,a]}function Rs(s,e){const t=e.map(n=>1);return qj(s,t,e)}function Sn(s,e,t){V(tv(e,t),()=>"".concat(s," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(t," input."))}function ws(s,e){if(tv(s,e))return null;const t=[];for(let n=0;n<e;++n)s.indexOf(n)===-1&&t.push(n);return s.forEach(n=>t.push(n)),t}function Xi(s){return s.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function _s(s,e){const t=[];for(let n=e-s;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OM(s,e=null,t=!1){const a={x:W(s,"x","max")},o={reductionIndices:e,keepDims:t};return oe.runKernel(Mg,a,o)}const ir=te({max_:OM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(s,e=null,t=!1){const a={x:W(s,"x","min")},o={axis:e,keepDims:t};return oe.runKernel(Vg,a,o)}const ph=te({min_:FM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LM(s,e){let t=W(s,"base","pow"),n=W(e,"exp","pow");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(ap,a)}const Oo=te({pow_:LM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(s,e){if((lr(s)&&e!=="string"||Array.isArray(s))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&lr(s)&&!(s instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return qi(s,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MM(s){const t={x:W(s,"x","sqrt","float32")};return oe.runKernel(gp,t)}const wn=te({sqrt_:MM});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(s){const e=W(s,"x","square"),t={};return oe.runKernel("Square",{x:e},t)}const is=te({square_:zM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(s,e=null,t=!1){let n=W(s,"x","sum");n.dtype==="bool"&&(n=qe(n,"int32"));const a={x:n},o={axis:e,keepDims:t};return oe.runKernel(ax,a,o)}const at=te({sum_:PM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(s,e="euclidean",t=null,n=!1){s=W(s,"x","norm");const a=Kj(s,e,t);let o=a.shape;if(n){const i=At(t,s.shape);o=Rs(a.shape,i)}return le(a,o)}function Kj(s,e,t=null){if(s.rank===0)return qs(s);if(s.rank!==1&&t===null)return Kj(le(s,[-1]),e,t);if(s.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return at(qs(s),t);if(e===1/0)return ir(qs(s),t);if(e===-1/0)return ph(qs(s),t);if(e==="euclidean"||e===2)return wn(at(Oo(qs(s),ht(2,"int32")),t));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(t)&&t.length===2){if(e===1)return ir(at(qs(s),t[0]),t[1]-1);if(e===1/0)return ir(at(qs(s),t[1]),t[0]);if(e===-1/0)return ph(at(qs(s),t[1]),t[0]);if(e==="fro"||e==="euclidean")return wn(at(is(s),t));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(t))}const Ip=te({norm_:BM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VM(s,e=null,t=!1){return Ip(s,"euclidean",e,t)}const Xj=te({euclideanNorm_:VM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(s){const t={x:W(s,"x","exp")};return oe.runKernel(Uh,t)}const Bn=te({exp_:UM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GM(s,e=0){const t=W(s,"x","expandDims","string_or_numeric");V(e<=t.rank,()=>"Axis must be <= rank of the tensor");const n={input:t},a={dim:e};return oe.runKernel(Tg,n,a)}const xn=te({expandDims_:GM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WM(s){const t={x:W(s,"x","expm1")};return oe.runKernel(Gh,t)}const Yj=te({expm1_:WM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(s,e){const t=W(s,"x","tile","string_or_numeric");V(t.rank===e.length,()=>"Error in transpose: rank of input ".concat(t.rank," ")+"must match length of reps ".concat(e,"."));const n={x:t},a={reps:e};return oe.runKernel(wp,n,a)}const nr=te({tile_:HM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(s,e,t,n="float32"){e==null&&(e=s);const a=$t([s,e],n),o=s<=e?s:e;for(let c=0;c<o;++c)a.set(1,c,c);const i=le(a.toTensor(),[s,e]);if(t==null)return i;if(t.length===1)return nr(xn(i,0),[t[0],1,1]);if(t.length===2)return nr(xn(xn(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return nr(xn(xn(xn(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(t.length,"D."))}const sv=te({eye_:qM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KM(s){const t={x:W(s,"x","floor","float32")};return oe.runKernel(Wh,t)}const $p=te({floor_:KM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XM(s,e,t=0,n=0){const a=W(s,"x","gather"),o=W(e,"indices","gather","int32"),i={x:a,indices:o},c={axis:t,batchDims:n};return oe.runKernel($g,i,c)}const Ap=te({gather_:XM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YM(s,e){let t=W(s,"a","greater","string_or_numeric"),n=W(e,"b","greater","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(Ag,a)}const Ca=te({greater_:YM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(s,e){let t=W(s,"a","greaterEqual","string_or_numeric"),n=W(e,"b","greaterEqual","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(qh,a)}const Yi=te({greaterEqual_:ZM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(s){const t={input:W(s,"input","imag")};return oe.runKernel(c2,t)}const gx=te({imag_:QM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(s){const t={x:W(s,"x","isFinite")};return oe.runKernel(Xh,t)}const Zj=te({isFinite_:JM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(s){const t={x:W(s,"x","isInf")};return oe.runKernel(Yh,t)}const Qj=te({isInf_:ez});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(s){const t={x:W(s,"x","isNaN")};return oe.runKernel(Zh,t)}const Jj=te({isNaN_:tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(s,e=.2){const n={x:W(s,"x","leakyRelu")},a={alpha:e};return oe.runKernel(Eg,n,a)}const xx=te({leakyRelu_:sz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nz(s,e){let t=W(s,"a","less","string_or_numeric"),n=W(e,"b","less","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(Dg,a)}const fh=te({less_:nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(s,e){let t=W(s,"a","lessEqual","string_or_numeric"),n=W(e,"b","lessEqual","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(Rg,a)}const tc=te({lessEqual_:az});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(s,e,t){if(t<=0)throw new Error("The number of values should be positive.");const n={start:s,stop:e,num:t};return oe.runKernel(u2,{},n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(s,e=5,t=1,n=1,a=.5){const o=W(s,"x","localResponseNormalization");V(o.rank===4||o.rank===3,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(o.rank,".")),V(xu(e),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,"."));let i=o,c=!1;o.rank===3&&(c=!0,i=le(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const u={x:i},h={depthRadius:e,bias:t,alpha:n,beta:a},p=oe.runKernel(Lg,u,h);return c?le(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const eT=te({localResponseNormalization_:oz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(s){const t={x:W(s,"x","log","float32")};return oe.runKernel(Qh,t)}const Oa=te({log_:iz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(s){const t={x:W(s,"x","log1p")};return oe.runKernel(Jh,t)}const bx=te({log1p_:lz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(s,e){V(O1(s),()=>"The f passed in variableGrads(f) must be a function"),V(e==null||Array.isArray(e)&&e.every(h=>h instanceof Om),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const h in oe.registeredVariables)e.push(oe.registeredVariables[h])}const n=t?e.filter(h=>!h.trainable):null,a=e.length;e=e.filter(h=>h.trainable),V(e.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable.");const o=!0,{value:i,grads:c}=oe.gradients(s,e,null,o);V(c.some(h=>h!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),V(i.rank===0,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor"));const u={};return e.forEach((h,p)=>{c[p]!=null&&(u[h.name]=c[p])}),n!=null&&n.forEach(h=>u[h.name]=null),{value:i,grads:u}}function Fo(s){return oe.customGrad(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(s){const t={x:W(s,"x","neg")};return oe.runKernel(Gg,t)}const fs=te({neg_:uz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dz(s){const t={x:W(s,"x","softplus")};return oe.runKernel(mp,t)}const Ou=te({softplus_:dz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(s){const e=W(s,"x","logSigmoid");return Fo(n=>({value:fs(Ou(fs(n))),gradFunc:i=>ne(i,Cr(fs(n)))}))(e)}const tT=te({logSigmoid_:hz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(s,e){let t=W(s,"a","sub"),n=W(e,"b","sub");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(bp,a)}const et=te({sub_:pz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fz(s,e=-1){const t=W(s,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(t.rank," and axis was ").concat(e));return Fo((a,o)=>{const c=ir(a,e,!0),u=et(a,c),h=et(qe(u,"float32"),Oa(at(Bn(u),e,!0)));return o([h]),{value:h,gradFunc:(f,g)=>{const[b]=g,y=!0,v=Bn(b);return et(f,ne(at(f,e,y),v))}}})(t)}const nv=te({logSoftmax_:fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(s,e=null,t=!1){const n=W(s,"x","logSumExp"),a=At(e,n.shape),o=ir(n,a,!0),i=et(n,o),c=Bn(i),u=at(c,a),h=Oa(u),p=Fe(le(o,h.shape),h);if(t){const f=Rs(p.shape,a);return le(p,f)}return p}const yx=te({logSumExp_:mz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(s,e){const t=W(s,"a","logicalAnd","bool"),n=W(e,"b","logicalAnd","bool");kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(_g,a)}const to=te({logicalAnd_:gz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(s){const t={x:W(s,"x","logicalNot","bool")};return oe.runKernel(Og,t)}const vx=te({logicalNot_:xz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(s,e){const t=W(s,"a","logicalOr","bool"),n=W(e,"b","logicalOr","bool");kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(Fg,a)}const av=te({logicalOr_:bz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yz(s,e){const t=W(s,"a","logicalXor","bool"),n=W(e,"b","logicalXor","bool");return kt(t.shape,n.shape),to(av(s,e),vx(to(s,e)))}const sT=te({logicalXor_:yz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rm=2147483648;function vz(s,e,t="left"){const n=W(s,"sortedSequence","searchSorted"),a=W(e,"values","searchSorted"),o=n.shape[n.shape.length-1],i=a.shape[a.shape.length-1],c=le(n,[-1,o]),u=le(a,[-1,i]);if(c.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(c.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ae(u.shape)>=rm)throw new Error("values tensor size must less than ".concat(rm));if(c.shape[1]>=rm)throw new Error("trailing dim_size must less than ".concat(rm," for int32 output type, was ").concat(c.shape[1]));const h={sortedSequence:c,values:u},p={side:t};return oe.runKernel(I2,h,p)}const rv=te({searchSorted_:vz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(s,e){return rv(s,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(s,e,t,n,a){const o=W(s,"x","maxPool"),i=1;let c=o,u=!1;o.rank===3&&(u=!0,c=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(c.rank===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(c.rank,".")),V(Nn(t,i),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(i,"'")),Gn("maxPool",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a},f=oe.runKernel(zg,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const wx=te({maxPool_:Nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(s,e=[1,1,1],t,n,a,o="NDHWC"){const i=W(s,"x","maxPool3d");let c=i,u=!1;i.rank===4&&(u=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(c.rank===5,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(c.rank,".")),V(o==="NDHWC",()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),Gn("maxPool3d",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a,dataFormat:o},f=oe.runKernel(Pg,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const nT=te({maxPool3d_:Sz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(s,e,t,n,a=!1){const i={x:W(s,"x","maxPoolWithArgmax")},c={filterSize:e,strides:t,pad:n,includeBatchInIndex:a},u=oe.runKernel(f2,i,c);return{result:u[0],indexes:u[1]}}const kz=te({maxPoolWithArgmax_:Cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(s,e){let t=W(s,"a","maximum"),n=W(e,"b","maximum");[t,n]=Is(t,n),t.dtype==="bool"&&(t=qe(t,"int32"),n=qe(n,"int32")),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(ep,a)}const Wo=te({maximum_:jz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tz(s,e=null,t=!1){const a={x:W(s,"x","mean")},o={axis:e,keepDims:t};return oe.runKernel(Bg,a,o)}const js=te({mean_:Tz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(s,e="float32"){if(La(s),e==="complex64"){const n=Ks(s,"float32"),a=Ks(s,"float32");return _i(n,a)}const t=An(Ae(s),e);return oe.makeTensor(t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(s,e="float32"){if(La(s),e==="complex64"){const n=xa(s,"float32"),a=Ks(s,"float32");return _i(n,a)}const t=Ly(Ae(s),e);return oe.makeTensor(t,s,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(s,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError("".concat(t," is not a valid third argument to meshgrid"));if(s===void 0)return[];let n=W(s,"x","meshgrid",s instanceof os?s.dtype:"float32");if(e===void 0)return[n];let a=W(e,"y","meshgrid",e instanceof os?e.dtype:"float32");const o=Ae(n.shape),i=Ae(a.shape);return t==="xy"?(n=le(n,[1,-1]),a=le(a,[-1,1]),[_t(xa([i,1],n.dtype),n),_t(a,xa([1,o],a.dtype))]):(n=le(n,[-1,1]),a=le(a,[1,-1]),[_t(n,xa([1,i],n.dtype)),_t(xa([o,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $z(s,e){let t=W(s,"a","minimum"),n=W(e,"b","minimum");[t,n]=Is(t,n),t.dtype==="bool"&&(t=qe(t,"int32"),n=qe(n,"int32")),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(tp,a)}const ql=te({minimum_:$z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Az(s,e,t){V(t==="reflect"||t==="symmetric",()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(t,"."));const n=W(s,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");V(e.length===n.rank,()=>"Padding doesn't match input. Must be ".concat(n.rank,". ")+"Got ".concat(e.length,"."));const a=t==="reflect"?1:0;for(let c=0;c<n.rank;c++)V(e[c].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),V(e[c][0]>=0&&e[c][0]<=n.shape[c]-a&&e[c][1]>=0&&e[c][1]<=n.shape[c]-a,()=>"Padding in dimension ".concat(c," cannot be greater than or equal ")+"to ".concat(n.shape[c]-a," or less than 0 for input of ")+"shape ".concat(n.shape));const o={paddings:e,mode:t},i={x:n};return oe.runKernel(Ug,i,o)}const aT=te({mirrorPad_:Az});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(s,e){let t=W(s,"a","mod"),n=W(e,"b","mod");[t,n]=Is(t,n);const a={a:t,b:n};return oe.runKernel(sp,a)}const rT=te({mod_:Ez});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(s,e=null,t=!1){s=W(s,"x","moments");const n=At(e,s.shape),a=js(s,n,t);let o=a.shape;t||(o=Rs(a.shape,n));const i=is(et(qe(s,"float32"),le(a,o))),c=js(i,n,t);return{mean:a,variance:c}}const Nx=te({moments_:Dz});function Rz(s,e,t,n){const a=W(e,"data","multiRNNCell"),o=Fm(t,"c","multiRNNCell"),i=Fm(n,"h","multiRNNCell");let c=a;const u=[];for(let f=0;f<s.length;f++){const g=s[f](c,o[f],i[f]);u.push(g[0]),u.push(g[1]),c=g[1]}const h=[],p=[];for(let f=0;f<u.length;f+=2)h.push(u[f]),p.push(u[f+1]);return[h,p]}const _z=te({multiRNNCell_:Rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(s,e,t,n=!1){const a=W(s,"logits","multinomial"),o=a.size,i=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(o,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));t=t||Math.random();const u={logits:i===1?le(a,[1,-1]):a},h={numSamples:e,seed:t,normalized:n},p=oe.runKernel(m2,u,h);return i===1?le(p,[p.size]):p}const Fz=te({multinomial_:Oz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(s,e){let t=W(s,"a","notEqual","string_or_numeric"),n=W(e,"b","notEqual","string_or_numeric");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n};return oe.runKernel(Wg,a)}const wu=te({notEqual_:Lz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(s,e,t=1,n=0,a="int32"){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const i={indices:W(s,"indices","oneHot","int32")},c={dtype:a,depth:e,onValue:t,offValue:n};return oe.runKernel(qg,i,c)}const ov=te({oneHot_:Mz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(s){const t={x:W(s,"x","onesLike")};return oe.runKernel(Hg,t)}const Fa=te({onesLike_:zz});function Pz(s,e){const t=W(s,"v1","outerProduct"),n=W(e,"v2","outerProduct");V(t.rank===1&&n.rank===1,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(t.rank," and ").concat(n.rank,"."));const a=le(t,[-1,1]),o=le(n,[1,-1]);return _t(a,o)}const Bz=te({outerProduct_:Pz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(s,e,t=0){const n=W(s,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:t},o={x:n};return oe.runKernel(Xg,o,a)}const Zi=te({pad_:Vz});function Uz(s,e,t=0){return V(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Zi(s,[e],t)}const Gz=te({pad1d_:Uz});function Wz(s,e,t=0){return V(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const Hz=te({pad2d_:Wz});function qz(s,e,t=0){return V(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const Kz=te({pad3d_:qz});function Xz(s,e,t=0){return V(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const Yz=te({pad4d_:Xz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(s,e,t){const n=W(s,"x","spaceToBatchND");V(n.rank>=1+e.length,()=>"input rank ".concat(n.rank," should be > than [blockShape] ").concat(e.length)),V(t.length===e.length,()=>"paddings.shape[0] ".concat(t.length," must be equal to [blockShape] ").concat(e.length)),V(n.shape.reduce((i,c,u)=>u>0&&u<=e.length?i&&(c+t[u-1][0]+t[u-1][1])%e[u-1]===0:i,!0),()=>"input spatial dimensions ".concat(n.shape.slice(1)," with paddings ").concat(t.toString()," must be divisible by blockShapes ").concat(e.toString()));const a={x:n},o={blockShape:e,paddings:t};return oe.runKernel(rx,a,o)}const Sx=te({spaceToBatchND_:Zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(s,e,t,n,a,o,i){a==null&&(a=[1,1]),o==null&&(o=1),n===0&&(n="valid");const c=W(s,"x","maxPool");let u=c,h=!1;c.rank===3&&(h=!0,u=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(Nn(o,a),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(a,"'"));const p=dr(u.shape,e,o,a,n),f=[p.dilationHeight,p.dilationWidth];let g;n==="same"?g=eP([p.filterHeight,p.filterWidth],f):g=[[0,0],[0,0]];const b=f[0]===1&&f[1]===1,[y,v]=Jz([p.inHeight,p.inWidth],f,g),w=b?n:"valid",N=b?u:Sx(u,f,y),I=(t==="avg"?()=>px(N,e,o,w,i):()=>wx(N,e,o,w,i))(),T=b?I:fx(I,f,v);return h?le(T,[T.shape[1],T.shape[2],T.shape[3]]):T}function Jz(s,e,t){const n=t.map(p=>p[0]),a=t.map(p=>p[1]),o=s.concat(n,a),i=e.map((p,f)=>(p-o[f]%p)%p),c=a.map((p,f)=>p+i[f]),u=e.map((p,f)=>[n[f],c[f]]),h=e.map((p,f)=>[0,i[f]]);return[u,h]}function eP(s,e){const n=s.map((i,c)=>i+(i-1)*(e[c]-1)).map(i=>i-1),a=n.map(i=>Math.floor(i/2)),o=n.map((i,c)=>i-a[c]);return n.map((i,c)=>[a[c],o[c]])}const oT=te({pool_:Qz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(s,e){const t=W(s,"x","prelu"),n=W(e,"alpha","prelu"),a={x:t,alpha:n};return oe.runKernel(Yg,a)}const Cx=te({prelu_:tP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(s,e=null,t=!1){let n=W(s,"x","prod");n.dtype==="bool"&&(n=qe(n,"int32"));const a={x:n},o={axis:e,keepDims:t};return oe.runKernel(Zg,a,o)}const iT=te({prod_:sP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(s,e,t,n){const a=s.map((p,f)=>W(p,"tensors".concat(f),"raggedGather","int32")),o=W(e,"paramsDenseValues","raggedGather"),i=W(t,"indices","raggedGather","int32"),c={paramsNestedSplits:a,paramsDenseValues:o,indices:i},u={outputRaggedRank:n},h=oe.runKernel(y2,c,u);return{outputNestedSplits:h.slice(0,h.length-1),outputDenseValues:h[h.length-1]}}const aP=te({raggedGather_:nP});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rP(s,e,t){const n=W(s,"starts","raggedRange"),a=W(e,"limits","raggedRange",n.dtype),o=W(t,"deltas","raggedRange",n.dtype),i={starts:n,limits:a,deltas:o},c=oe.runKernel(v2,i);return{rtNestedSplits:c[0],rtDenseValues:c[1]}}const oP=te({raggedRange_:rP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(s,e,t,n,a){const o=W(s,"shape","raggedTensorToTensor","int32"),i=W(e,"values","raggedTensorToTensor"),c=W(t,"defaultValue","raggedTensorToTensor",i.dtype),u=n.map((f,g)=>W(f,"tensors".concat(g),"raggedTensorToTensor","int32")),h={shape:o,values:i,defaultValue:c,rowPartitionTensors:u},p={rowPartitionTypes:a};return oe.runKernel(w2,h,p)}const lP=te({raggedTensorToTensor_:iP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cP(s,e,t){La(s);const n=Ae(s);let a=null;if(t==null||t==="float32")a=new Float32Array(n);else if(t==="int32")a=new Int32Array(n);else if(t==="bool")a=new Uint8Array(n);else throw new Error("Unknown data type ".concat(t));for(let o=0;o<n;o++)a[o]=e();return oe.makeTensor(a,s,t)}const uP=te({rand_:cP});var wm={exports:{}},dP=wm.exports,M4;function hP(){return M4||(M4=1,function(s){(function(e,t,n){function a(u){var h=this,p=c();h.next=function(){var f=2091639*h.s0+h.c*23283064365386963e-26;return h.s0=h.s1,h.s1=h.s2,h.s2=f-(h.c=f|0)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(u),h.s0<0&&(h.s0+=1),h.s1-=p(u),h.s1<0&&(h.s1+=1),h.s2-=p(u),h.s2<0&&(h.s2+=1),p=null}function o(u,h){return h.c=u.c,h.s0=u.s0,h.s1=u.s1,h.s2=u.s2,h}function i(u,h){var p=new a(u),f=h&&h.state,g=p.next;return g.int32=function(){return p.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.quick=g,f&&(typeof f=="object"&&o(f,p),g.state=function(){return o(p,{})}),g}function c(){var u=4022871197,h=function(p){p=String(p);for(var f=0;f<p.length;f++){u+=p.charCodeAt(f);var g=.02519603282416938*u;u=g>>>0,g-=u,g*=u,u=g>>>0,g-=u,u+=g*4294967296}return(u>>>0)*23283064365386963e-26};return h}t&&t.exports?t.exports=i:this.alea=i})(dP,s)}(wm)),wm.exports}var Nm={exports:{}},pP=Nm.exports,z4;function fP(){return z4||(z4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},c===(c|0)?u.x=c:h+=c;for(var p=0;p<h.length+64;p++)u.x^=h.charCodeAt(p)|0,u.next()}function o(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xor128=i})(pP,s)}(Nm)),Nm.exports}var Sm={exports:{}},mP=Sm.exports,P4;function gP(){return P4||(P4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,c===(c|0)?u.x=c:h+=c;for(var p=0;p<h.length+64;p++)u.x^=h.charCodeAt(p)|0,p==h.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u.v=c.v,u.d=c.d,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xorwow=i})(mP,s)}(Sm)),Sm.exports}var Cm={exports:{}},xP=Cm.exports,B4;function bP(){return B4||(B4=1,function(s){(function(e,t,n){function a(c){var u=this;u.next=function(){var p=u.x,f=u.i,g,b;return g=p[f],g^=g>>>7,b=g^g<<24,g=p[f+1&7],b^=g^g>>>10,g=p[f+3&7],b^=g^g>>>3,g=p[f+4&7],b^=g^g<<7,g=p[f+7&7],g=g^g<<13,b^=g^g<<9,p[f]=b,u.i=f+1&7,b};function h(p,f){var g,b=[];if(f===(f|0))b[0]=f;else for(f=""+f,g=0;g<f.length;++g)b[g&7]=b[g&7]<<15^f.charCodeAt(g)+b[g+1&7]<<13;for(;b.length<8;)b.push(0);for(g=0;g<8&&b[g]===0;++g);for(g==8?b[7]=-1:b[g],p.x=b,p.i=0,g=256;g>0;--g)p.next()}h(u,c)}function o(c,u){return u.x=c.x.slice(),u.i=c.i,u}function i(c,u){c==null&&(c=+new Date);var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(p.x&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xorshift7=i})(xP,s)}(Cm)),Cm.exports}var km={exports:{}},yP=km.exports,V4;function vP(){return V4||(V4=1,function(s){(function(e,t,n){function a(c){var u=this;u.next=function(){var p=u.w,f=u.X,g=u.i,b,y;return u.w=p=p+1640531527|0,y=f[g+34&127],b=f[g=g+1&127],y^=y<<13,b^=b<<17,y^=y>>>15,b^=b>>>12,y=f[g]=y^b,u.i=g,y+(p^p>>>16)|0};function h(p,f){var g,b,y,v,w,N=[],C=128;for(f===(f|0)?(b=f,f=null):(f=f+"\0",b=0,C=Math.max(C,f.length)),y=0,v=-32;v<C;++v)f&&(b^=f.charCodeAt((v+32)%f.length)),v===0&&(w=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,v>=0&&(w=w+1640531527|0,g=N[v&127]^=b+w,y=g==0?y+1:0);for(y>=128&&(N[(f&&f.length||0)&127]=-1),y=127,v=4*128;v>0;--v)b=N[y+34&127],g=N[y=y+1&127],b^=b<<13,g^=g<<17,b^=b>>>15,g^=g>>>12,N[y]=b^g;p.w=w,p.X=N,p.i=y}h(u,c)}function o(c,u){return u.i=c.i,u.w=c.w,u.X=c.X.slice(),u}function i(c,u){c==null&&(c=+new Date);var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(p.X&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xor4096=i})(yP,s)}(km)),km.exports}var jm={exports:{}},wP=jm.exports,U4;function NP(){return U4||(U4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.next=function(){var f=u.b,g=u.c,b=u.d,y=u.a;return f=f<<25^f>>>7^g,g=g-b|0,b=b<<24^b>>>8^y,y=y-f|0,u.b=f=f<<20^f>>>12^g,u.c=g=g-b|0,u.d=b<<16^g>>>16^y,u.a=y-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,c===Math.floor(c)?(u.a=c/4294967296|0,u.b=c|0):h+=c;for(var p=0;p<h.length+20;p++)u.b^=h.charCodeAt(p)|0,u.next()}function o(c,u){return u.a=c.a,u.b=c.b,u.c=c.c,u.d=c.d,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.tychei=i})(wP,s)}(jm)),jm.exports}var Tm={exports:{}};const SP={},CP=Object.freeze(Object.defineProperty({__proto__:null,default:SP},Symbol.toStringTag,{value:"Module"})),kP=k6(CP);var jP=Tm.exports,G4;function TP(){return G4||(G4=1,function(s){(function(e,t,n){var a=256,o=6,i=52,c="random",u=n.pow(a,o),h=n.pow(2,i),p=h*2,f=a-1,g;function b(T,$,E){var _=[];$=$==!0?{entropy:!0}:$||{};var L=N(w($.entropy?[T,I(t)]:T==null?C():T,3),_),O=new y(_),z=function(){for(var A=O.g(o),U=u,X=0;A<h;)A=(A+X)*a,U*=a,X=O.g(1);for(;A>=p;)A/=2,U/=2,X>>>=1;return(A+X)/U};return z.int32=function(){return O.g(4)|0},z.quick=function(){return O.g(4)/4294967296},z.double=z,N(I(O.S),t),($.pass||E||function(A,U,X,Z){return Z&&(Z.S&&v(Z,O),A.state=function(){return v(O,{})}),X?(n[c]=A,U):A})(z,L,"global"in $?$.global:this==n,$.state)}function y(T){var $,E=T.length,_=this,L=0,O=_.i=_.j=0,z=_.S=[];for(E||(T=[E++]);L<a;)z[L]=L++;for(L=0;L<a;L++)z[L]=z[O=f&O+T[L%E]+($=z[L])],z[O]=$;(_.g=function(A){for(var U,X=0,Z=_.i,q=_.j,B=_.S;A--;)U=B[Z=f&Z+1],X=X*a+B[f&(B[Z]=B[q=f&q+U])+(B[q]=U)];return _.i=Z,_.j=q,X})(a)}function v(T,$){return $.i=T.i,$.j=T.j,$.S=T.S.slice(),$}function w(T,$){var E=[],_=typeof T,L;if($&&_=="object")for(L in T)try{E.push(w(T[L],$-1))}catch(O){}return E.length?E:_=="string"?T:T+"\0"}function N(T,$){for(var E=T+"",_,L=0;L<E.length;)$[f&L]=f&(_^=$[f&L]*19)+E.charCodeAt(L++);return I($)}function C(){try{var T;return g&&(T=g.randomBytes)?T=T(a):(T=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(T)),I(T)}catch(_){var $=e.navigator,E=$&&$.plugins;return[+new Date,e,E,e.screen,I(t)]}}function I(T){return String.fromCharCode.apply(0,T)}if(N(n.random(),t),s.exports){s.exports=b;try{g=kP}catch(T){}}else n["seed"+c]=b})(typeof self<"u"?self:jP,[],Math)}(Tm)),Tm.exports}var p1,W4;function IP(){if(W4)return p1;W4=1;var s=hP(),e=fP(),t=gP(),n=bP(),a=vP(),o=NP(),i=TP();return i.alea=s,i.xor128=e,i.xorwow=t,i.xorshift7=n,i.xor4096=a,i.tychei=o,p1=i,p1}var kx=IP();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iv{constructor(e,t,n,a,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=kx.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,t,n=!1;for(;!n;){let a,o,i;do a=2*this.random()-1,o=2*this.random()-1,i=a*a+o*o;while(i>=1||i===0);const c=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*c,t=this.mean+this.stdDev*o*c,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class $P{constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;const o=a||Math.random();this.randu=kx.alea(o.toString()),this.randn=new iv(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,a,o,i;for(;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0);if(i*=i*i,e=a*a,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<t||Math.log(o)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class AP{constructor(e=0,t=1,n,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=kx.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EP(s,e,t=1,n="float32",a){if(La(s),t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type ".concat(n));const o=new $P(e,t,n,a),i=$t(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const DP=te({randomGamma_:EP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(s,e=0,t=1,n,a){if(La(s),n!=null&&n==="bool")throw new Error("Unsupported data type ".concat(n));const o=new iv(e,t,n,!1,a),i=$t(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const lv=te({randomNormal_:RP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(s,e,t){if(e!=null&&e==="bool")throw new Error("Unsupported data type ".concat(e));return lv(s,0,1,e,t)}const OP=te({randomStandardNormal_:_P});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(s,e=0,t=1,n="float32",a){La(s);const o=$t(s,n),i=new AP(e,t,null,a);for(let c=0;c<o.values.length;c++)o.values[c]=i.nextValue();return o.toTensor()}const sc=te({randomUniform_:FP});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LP(s,e,t,n){return sc(s,e,t,"int32",n)}const MP=te({randomUniformInt_:LP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nu(s,e,t=1,n="float32"){if(t===0)throw new Error("Cannot have a step of zero");const a={start:s,stop:e,step:t,dtype:n};return oe.runKernel(N2,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(s){const t={input:W(s,"input","real")};return oe.runKernel(S2,t)}const mh=te({real_:zP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(s){const t={x:W(s,"x","reciprocal")};return oe.runKernel(rp,t)}const lT=te({reciprocal_:PP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(s){const t={x:W(s,"x","relu")};return oe.runKernel(op,t)}const ro=te({relu_:BP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VP(s){const t={x:W(s,"x","relu6")};return oe.runKernel(ip,t)}const cv=te({relu6_:VP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(s,e){const n={x:W(s,"x","reverse")},a={dims:e};return oe.runKernel(tx,n,a)}const cr=te({reverse_:UP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GP(s){const e=W(s,"x","reverse");return V(e.rank===1,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")),cr(e,0)}const WP=te({reverse1d_:GP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(s,e){const t=W(s,"x","reverse");return V(t.rank===2,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(t.rank,".")),cr(t,e)}const qP=te({reverse2d_:HP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(s,e){const t=W(s,"x","reverse");return V(t.rank===3,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(t.rank,".")),cr(t,e)}const XP=te({reverse3d_:KP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(s,e){const t=W(s,"x","reverse");return V(t.rank===4,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(t.rank,".")),cr(t,e)}const ZP=te({reverse4d_:YP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(s){const t={x:W(s,"x","round")};return oe.runKernel(lp,t)}const uv=te({round_:QP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JP(s){const t={x:W(s,"x","rsqrt","float32")};return oe.runKernel(cp,t)}const dv=te({rsqrt_:JP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(s){const t={x:W(s,"x","selu")};return oe.runKernel(up,t)}const hv=te({selu_:eB});function tB(s,e,t,n,a,o=[1,1],i="NHWC"){const c=W(s,"x","separableConv2d"),u=W(e,"depthwiseFilter","separableConv2d"),h=W(t,"pointwiseFilter","separableConv2d");let p=c,f=!1;if(c.rank===3&&(f=!0,p=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");V(p.rank===4,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")),V(u.rank===4,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")),V(h.rank===4,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")),V(h.shape[0]===1,()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(h.shape[0],".")),V(h.shape[1]===1,()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(h.shape[1],"."));const g=u.shape[2],b=u.shape[3];V(h.shape[2]===g*b,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(g*b,", ")+"but got ".concat(h.shape[2],"."));const y=jp(p,u,n,a,i,o),w=Li(y,h,1,"valid",i);return f?le(w,[w.shape[1],w.shape[2],w.shape[3]]):w}const pv=te({separableConv2d_:tB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function sB(s,e){const t=W(s,"x","setdiff1d"),n=W(e,"y","setdiff1d");V(t.dtype===n.dtype,()=>"x and y should have the same dtype, but got x (".concat(t.dtype,") and y (").concat(n.dtype,").")),V(t.rank===1,()=>"x should be 1D tensor, but got x (".concat(t.shape,").")),V(n.rank===1,()=>"y should be 1D tensor, but got y (".concat(n.shape,")."));const a=await t.data(),o=await n.data(),i=new Set(o);let c=0;for(let p=0;p<a.length;p++)i.has(a[p])||c++;const u=new Zs([c],t.dtype),h=new Zs([c],"int32");for(let p=0,f=0;p<a.length;p++)i.has(a[p])||(u.values[f]=a[p],h.values[f]=p,f++);return[u.toTensor(),h.toTensor()]}const nB=sB;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aB(s){const t={x:W(s,"x","sign")};return oe.runKernel(pp,t)}const cT=te({sign_:aB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(s){const t={x:W(s,"x","sin","float32")};return oe.runKernel(dp,t)}const fv=te({sin_:rB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(s){const t={x:W(s,"x","sinh")};return oe.runKernel(hp,t)}const mv=te({sinh_:oB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(s,e,t){const n=W(s,"x","slice1d");return V(n.rank===1,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(n.rank," tensor")),xt(n,[e],[t])}const jx=te({slice1d_:iB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(s,e,t){const n=W(s,"x","slice2d");return V(n.rank===2,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(n.rank," tensor")),xt(n,e,t)}const gv=te({slice2d_:lB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(s,e,t){const n=W(s,"x","slice3d");return V(n.rank===3,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(n.rank," tensor")),xt(n,e,t)}const Tx=te({slice3d_:cB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(s,e,t){const n=W(s,"x","slice4d");return V(n.rank===4,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(n.rank," tensor")),xt(n,e,t)}const gh=te({slice4d_:uB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(s,e=-1){const t=W(s,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(t.rank," and dim was ").concat(e));const n={logits:t},a={dim:e};return oe.runKernel(ix,n,a)}const Ix=te({softmax_:dB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(s){V(s.dtype==="complex64",()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(s.dtype,"."));const e={input:s};return oe.runKernel(a2,e)}const $x=te({fft_:hB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(s){V(s.dtype==="complex64",()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(s.dtype,"."));const e={input:s};return oe.runKernel(l2,e)}const xh=te({ifft_:pB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(s){const e=s.shape[s.shape.length-1],t=s.size/e;let n;if(e<=2){const a=le(s,[t,e]);n=xh(a)}else{const a=[t,2*(e-1)],o=le(mh(s),[t,e]),i=le(gx(s),[t,e]),c=cr(xt(o,[0,1],[t,e-2]),1),u=ne(cr(xt(i,[0,1],[t,e-2]),1),ht(-1)),h=Ts([o,c],1),p=Ts([i,u],1),f=le(_i(h,p),[a[0],a[1]]);n=xh(f)}if(n=mh(n),s.rank===3&&s.shape[0]!==0){const a=n,o=s.shape[0];n=le(n,[o,n.shape[0]/o,n.shape[1]]),a.dispose()}return n}const xv=te({irfft_:fB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(s,e,t=0){const a={x:W(s,"x","split")},o={numOrSizeSplits:e,axis:t};return oe.runKernel(ox,a,o)}const ba=te({split_:mB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(s,e){V(s.dtype==="float32",()=>"The dtype for rfft() must be real value but got ".concat(s.dtype));let t=s.shape[s.shape.length-1];const n=s.size/t;let a;if(e!=null&&e<t){const y=s.shape.map(w=>0),v=s.shape.map(w=>w);v[s.shape.length-1]=e,a=xt(s,y,v),t=e}else if(e!=null&&e>t){const y=s.shape.map(v=>v);y[s.shape.length-1]=e-t,a=Ts([s,Ks(y)],s.shape.length-1),t=e}else a=s;const o=Bt(a),i=le(_i(a,o),[n,t]),c=$x(i),u=Math.floor(t/2)+1,h=mh(c),p=gx(c),f=ba(h,[u,t-u],h.shape.length-1),g=ba(p,[u,t-u],p.shape.length-1),b=a.shape.slice();return b[a.shape.length-1]=u,le(_i(f[0],g[0]),b)}const Ax=te({rfft_:gB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xB(s,e){let t=W(s,"a","squaredDifference"),n=W(e,"b","squaredDifference");[t,n]=Is(t,n),kt(t.shape,n.shape);const a={a:t,b:n},o={};return oe.runKernel(xp,a,o)}const bv=te({squaredDifference_:xB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(s,e){const t=W(s,"x","squeeze","string_or_numeric");return le(t,Gi(t.shape,e).newShape)}const Es=te({squeeze_:bB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(s,e=0){const t=Fm(s,"tensors","stack","string_or_numeric");V(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&V(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const n=t,a={axis:e};return oe.runKernel(Kg,n,a)}const va=te({stack_:yB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(s,e=0){const n={x:W(s,"x","step")},a={alpha:e};return oe.runKernel(Np,n,a)}const Fu=te({step_:vB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(s,e,t,n,a=0,o=0,i=0,c=0,u=0){const p={x:W(s,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:n,beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:c,shrinkAxisMask:u};return oe.runKernel(O2,p,f)}const uT=te({stridedSlice_:wB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(s){const t={x:W(s,"x","tan","float32")};return oe.runKernel(yp,t)}const dT=te({tan_:NB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bs(s,e){Au(s);const t=Hi(s,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return qi(s,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(s,e,t){if(Au(s),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const n=Hi(s,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(s,e,t){if(Au(s),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const n=Hi(s,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(s,e,t){if(Au(s),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const n=Hi(s,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CB(s,e,t){if(Au(s),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const n=Hi(s,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(s,e,t){if(Au(s),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const n=Hi(s,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||n,qi(s,e,n,t)}function pT(s,e,t){const n=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(t.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(s)+", sliceDim: ".concat(n,", and batchDim: ").concat(a,".");if(t.rank<a)throw new Error(o+" update.rank < ".concat(a,". "));if(s.length<n+(t.rank-a))throw new Error(o+" Output shape length < ".concat(n+(t.rank-a)));if(t.rank!==a+s.length-n)throw new Error(o+" update.rank != ".concat(a+s.length-n));for(let i=0;i<a;++i)if(t.shape[i]!==e.shape[i])throw new Error(o+" updates.shape[".concat(i,"] (").concat(t.shape[i],") != indices.shape[").concat(i,"] (").concat(e.shape[i],")."));for(let i=0;i<t.rank-a;++i)if(t.shape[i+a]!==s[i+n])throw new Error(o+" updates.shape[".concat(i+a,"] (").concat(t.shape[i+a],") != shape[").concat(i+a,"] (").concat(s[i+a],")"))}function yv(s,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(s.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(s.rank,"."));if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(t));if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(s.size===0)throw new Error("Updates specified for empty output. updates shape: ".concat(s.shape))}pT(t,e,s)}function nc(s,e,t){const n=e.shape.length,a=n>1?e.shape[n-1]:1,o=t.length;let i=1;for(let f=a;f<o;++f)i*=t[f];const c=a<1?1:a,u=Ae(e.shape)/c,h=[...ut(t.slice(0,a)),1],p=Ae(t);return{sliceRank:a,numUpdates:u,sliceSize:i,strides:h,outputSize:p}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(s,e,t){const n=W(s,"tensor","tensorScatterupdate"),a=W(e,"indices","tensorScatterupdate","int32"),o=W(t,"updates","tensorScatterupdate");if(yv(o,a,n.shape),n.dtype!==o.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(n.dtype," and ").concat(o.dtype,"."));const i={tensor:n,indices:a,updates:o},c={};return oe.runKernel(T2,i,c)}const TB=te({tensorScatterUpdate_:jB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IB(s,e=1,t=!0){const n=W(s,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=n.shape[n.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(e));const o={x:n},i={k:e,sorted:t},[c,u]=oe.runKernel(z2,o,i);return{values:c,indices:u}}const fT=te({topk_:IB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(s,e=0,t=1,n,a){if(La(s),n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new iv(e,t,n,!0,a),i=$t(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const vv=te({truncatedNormal_:$B});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(s,e=0){const t=W(s,"x","unique","string_or_numeric");V(t.rank>0,()=>"The input tensor must be at least 1D");const n={x:t},a={axis:e},[o,i]=oe.runKernel(B2,n,a);return{values:o,indices:i}}const mT=te({unique_:AB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(s,e,t){const n=W(s,"x","unsortedSegmentSum"),a=W(e,"segmentIds","unsortedSegmentSum","int32");V(xu(t),()=>"numSegments must be of dtype int");const o={x:n,segmentIds:a},i={numSegments:t};return oe.runKernel(ux,o,i)}const wv=te({unsortedSegmentSum_:EB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(s,e=0){const t=W(s,"x","unstack","string_or_numeric");V(e>=-t.shape.length&&e<t.shape.length,()=>"Axis = ".concat(e," is not in [-").concat(t.shape.length,", ").concat(t.shape.length,")"));const n={value:t},a={axis:e};return oe.runKernel(cx,n,a)}const ur=te({unstack_:DB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(s,e){return rv(s,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gT(s,e=!0,t,n){return oe.makeVariable(s,e,t,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nv(s,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const n=$t(s,"int32"),a=$t([t.length,s.length],"int32");for(let o=0;o<t.length;o++){const i=n.indexToLoc(t[o]),c=o*s.length;a.values.set(i,c)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _B(s){const e=W(s,"condition","whereAsync","bool"),t=await e.data(),n=Nv(e.shape,t);return s!==e&&e.dispose(),n}const xT=_B;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function OB(s,e,t){const n=W(s,"tensor","boolMask"),a=W(e,"mask","boolMask","bool"),o=t==null?0:t,i=a.rank,c=n.shape;V(i>0,()=>"mask cannot be scalar"),Sa(c.slice(o,o+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let v=o;v<o+i;v++)u*=c[v];const h=c.slice(0,o).concat([u],c.slice(o+i)),p=le(n,h),f=le(a,[-1]),g=await xT(f),b=Es(g,[1]),y=Ap(p,b,o);return s!==n&&n.dispose(),e!==a&&a.dispose(),b.dispose(),p.dispose(),f.dispose(),g.dispose(),y}const FB=OB;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(s,e,t){const n=W(s,"x","transpose");if(e==null&&(e=n.shape.map((i,c)=>c).reverse()),V(n.rank===e.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(e,".")),e.forEach(i=>{V(i>=0&&i<n.rank,()=>"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(e))}),n.rank<=1)return n.clone();const a={x:n},o={perm:e};return n.dtype==="complex64"?me(()=>{let i=mh(n),c=gx(n);return i=oe.runKernel(du,{x:i},o),c=oe.runKernel(du,{x:c},o),t&&(c=fs(c)),_i(i,c)}):oe.runKernel(du,a,o)}const Pt=te({transpose_:LB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(s,e,t,n,a=!0){const o=W(s,"v","movingAverage"),i=W(e,"x","movingAverage"),c=W(t,"decay","movingAverage");S7(o,i),V(Mt(o.shape,i.shape),()=>"Shape mismatch in v and x");const u=ht(1),h=et(u,c);let p=ne(et(i,o),h);if(a){V(n!=null,()=>"When using zeroDebias: true, step is required.");const f=W(n,"step","movingAverage");p=Ze(p,et(u,Oo(c,f)))}return Fe(o,p)}const zB=te({movingAverage_:MB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(s,e,t){La(t);const n=W(s,"indices","scatterND","int32"),a=W(e,"updates","scatterND");yv(a,n,t);const o={indices:n,updates:a},i={shape:t};return oe.runKernel(j2,o,i)}const BB=te({scatterND_:PB});function VB(s,e,t,n){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(s.dtype,"."));if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(s.shape,"."));const a=s.rank>0?s.shape[0]:1,o=s.rank>1?s.shape[1]:1;if(t.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(t.length,", should be: ").concat(o,"."));const i=e.size;if(!(e.rank===0||e.rank===1&&i===a))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(a,"]"));if(e.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(s,e,t,n=0){La(t);const a=W(s,"sparseIndices","sparseToDense","int32"),o=W(e,"sparseValues","sparseToDense","string_or_numeric"),i=W(n,"defaultValue","sparseToDense",o.dtype);VB(a,o,t,i);const c={sparseIndices:a,sparseValues:o,defaultValue:i},u={outputShape:t};return oe.runKernel(R2,c,u)}const GB=te({sparseToDense_:UB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(s,e){const t=W(e,"indices","gatherND","int32"),a={params:W(s,"x","gatherND","string_or_numeric"),indices:t};return oe.runKernel(i2,a)}const HB=te({gatherND_:WB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(s,e){if(e==null)return s.shape.slice();if(Mt(s.shape,e))return e;if(s.shape.length===e.length){const t=[];for(let n=0;n<s.shape.length;n++)e[n]==null&&s.shape[n]!=null?t.push(s.shape[n]):t.push(e[n]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(s,e,t,n){const a=W(s,"x","dropout");if(V(a.dtype==="float32",()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")),V(e>=0&&e<1,()=>"rate must be a float in the range [0, 1), but got ".concat(e,".")),e===0)return s instanceof os?a.clone():a;const o=qB(a,t),i=1-e,c=Ze($p(Fe(sc(o,0,1,"float32",n),i)),i);return ne(a,c)}const bT=te({dropout_:KB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yT(s){return Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2))))}function Sv(s,e,t){const n=1-s%2,a=new Float32Array(s);for(let o=0;o<s;++o){const i=2*Math.PI*o/(s+n-1);a[o]=e-t*Math.cos(i)}return Bs(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function XB(s,e,t=1){const n=W(s,"predictions","inTopK"),a=W(e,"targets","inTopK");V(n.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(n.rank)),V(n.rank-1===a.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(n.rank," and targets rank ").concat(a.rank)),Sa(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=n.shape[n.shape.length-1];V(t>0&&t<=o,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(t));const i=await n.data(),c=await a.data(),[u,h]=[i.length/o,o],p=vn("bool",u);for(let f=0;f<u;f++){const g=f*h,b=i.subarray(g,g+h),y=[];for(let v=0;v<b.length;v++)y.push({value:b[v],index:v});y.sort((v,w)=>w.value-v.value),p[f]=0;for(let v=0;v<t;v++)if(y[v].index===c[f]){p[f]=1;break}}return s!==n&&n.dispose(),e!==a&&a.dispose(),Sr(p,a.shape,"bool")}const YB=XB;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(s,e,t,n,a,o="NHWC",i){let c=s;s.rank===3&&(c=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let u=e;u.rank===3&&(u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]])),V(c.rank===4,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(c.shape,".")),V(u.rank===4,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")),V(t.length===4,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(t,"."));const h=o==="NHWC"?c.shape[3]:c.shape[1],p=o==="NHWC"?u.shape[3]:u.shape[1];V(h===t[2],()=>"Error in conv2dDerFilter: depth of input ".concat(h,") must ")+"match input depth in filter (".concat(t[2],".")),V(p===t[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(p,") must ")+"match output depth for filter (".concat(t[3],").")),Gn("conv2dDerFilter",a,i);const f={x:c,dy:u},g={strides:n,pad:a,dataFormat:o,dimRoundingMode:i,filterShape:t};return oe.runKernel(Hy,f,g)}const Cv=te({conv2DBackpropFilter_:ZB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(s,e,t){if(t==null||t==="linear")return s;if(t==="relu")return ne(s,Fu(e));throw new Error("Cannot compute gradient for fused activation ".concat(t,"."))}function Dx(s,e){let t=e;const n=en(s.shape,e.shape);return n.length>0&&(t=at(t,n)),le(t,s.shape)}function Rx(s,e,t,n){if(e==="linear")return s;if(e==="relu")return ro(s);if(e==="elu")return Tp(s);if(e==="relu6")return cv(s);if(e==="prelu")return Cx(s,t);if(e==="leakyrelu")return xx(s,n);if(e==="sigmoid")return Cr(s);throw new Error("Unknown fused activation ".concat(e,"."))}const _x=(s,e)=>!(s>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB({x:s,filter:e,strides:t,pad:n,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:c,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:p}){if(u=u||"linear",_x(oe.state.gradientDepth,u)===!1){V(a==="NHWC",()=>"Error in fused conv2d: got dataFormat of ".concat(a," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let E=Li(s,e,t,n,a,o,i);return c!=null&&(E=Fe(E,c)),Rx(E,u,h,p)}const f=W(s,"x","conv2d","float32"),g=W(e,"filter","conv2d","float32");let b=f,y=!1;f.rank===3&&(y=!0,b=le(f,[1,f.shape[0],f.shape[1],f.shape[2]])),V(b.rank===4,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(b.rank,".")),V(g.rank===4,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")),Gn("fused conv2d",n,i);const v=a==="NHWC"?b.shape[3]:b.shape[1];V(g.shape[2]===v,()=>"Error in conv2d: depth of input (".concat(v,") must match ")+"input depth for filter ".concat(g.shape[2],".")),V(Nn(t,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'"));const w=hn(b.shape,g.shape,t,o,n,i);let N;c!=null&&(N=W(c,"bias","fused conv2d"),[N]=Is(N,f),a==="NHWC"?kt(w.outShape,N.shape):(V(N.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(N.shape.length,".")),V(N.shape.length===0||N.shape[0]===w.outChannels||N.shape[0]===1,()=>"Error in fused conv2d: bias shape (".concat(N.shape,") is not ")+"compatible with the number of output channels "+"(".concat(w.outChannels,")"))));let C;if(h!=null){const E=h.shape;if(V(E.length<=1||E.length===3,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(E.length,".")),E.length===1)V(E[0]===1||E[0]===w.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(E,") is not compatible with the number of output ")+"channels (".concat(w.outChannels,")."));else if(E.length===3)try{kt(E,w.outShape)}catch(_){const L="Error in fused conv2d: PReLU activation weights (".concat(E,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(w.outShape,").");throw Error(L)}C=W(h,"prelu weights","fused conv2d")}const I=(E,_)=>{V(a==="NHWC",()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported."));const[L,O,z,A]=_,U=Ex(E,z,u);V(Fi(o),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'"));const X=Y2(O.shape,U,L,t,n),Z=Cv(O,U,L.shape,t,n),q=[X,Z];if(A!=null){const B=Dx(A,U);q.push(B)}return q},T={x:b,filter:g,bias:N,preluActivationWeights:C},$={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:p};return c==null?Fo((_,L,O)=>{let z=oe.runKernel(Dm,T,$);return O([L,_,z]),y&&(z=le(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:I}})(b,g):Fo((_,L,O,z)=>{let A=oe.runKernel(Dm,T,$);return z([L,_,A,O]),y&&(A=le(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:I}})(b,g,N)}const vT=te({fusedConv2d_:QB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(s,e,t,n,a,o=[1,1],i){let c=s;s.rank===3&&(c=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let u=e;u.rank===3&&(u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={x:c,dy:u},p={strides:n,pad:a,dimRoundingMode:i,dilations:o,filterShape:t};return oe.runKernel(Jy,h,p)}const wT=te({depthwiseConv2dNativeBackpropFilter_:JB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(s,e,t,n,a,o=[1,1],i){let c=e,u=!1;e.rank===3&&(u=!0,c=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={dy:c,filter:t},p={strides:n,pad:a,dimRoundingMode:i,dilations:o,inputShape:s},f=oe.runKernel(e2,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const NT=te({depthwiseConv2dNativeBackpropInput_:e9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9({x:s,filter:e,strides:t,pad:n,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:c,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:p}){if(_x(oe.state.gradientDepth,u)===!1){let $=jp(s,e,t,n,a,o,i);return c!=null&&($=Fe($,c)),Rx($,u,h,p)}const f=W(s,"x","depthwiseConv2d","float32"),g=W(e,"filter","depthwiseConv2d","float32");let b=f,y=!1;f.rank===3&&(y=!0,b=le(f,[1,f.shape[0],f.shape[1],f.shape[2]])),V(b.rank===4,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(b.rank,".")),V(g.rank===4,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")),V(b.shape[3]===g.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(b.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")),o==null&&(o=[1,1]),V(Nn(t,o),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(t," and dilations '").concat(o,"'")),Gn("fused depthwiseConv2d",n,i);const v=hn(b.shape,g.shape,t,o,n,i,!0);let w;c!=null&&(w=W(c,"bias","fused conv2d"),[w]=Is(w,f),kt(v.outShape,w.shape));let N;h!=null&&(N=W(h,"prelu weights","fused depthwiseConv2d"));const C=($,E)=>{V(Fi(o),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'"));const[_,L,O,z]=E,A=Ex($,O,u),U=NT(L.shape,A,_,t,n,o,i),X=wT(L,A,_.shape,t,n,o,i);if(z!=null){const Z=Dx(w,A);return[U,X,Z]}return[U,X]},I={x:b,filter:g,bias:w,preluActivationWeights:N},T={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:p};return c==null?Fo((E,_,L)=>{let O=oe.runKernel(Rm,I,T);return L([_,E,O]),y&&(O=le(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:C}})(b,g):Fo((E,_,L,O)=>{let z=oe.runKernel(Rm,I,T);return O([_,E,z,L]),y&&(z=le(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:C}})(b,g,w)}const s9=te({fusedDepthwiseConv2d_:t9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9({a:s,b:e,transposeA:t=!1,transposeB:n=!1,bias:a,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:c=.2}){if(_x(oe.state.gradientDepth,o)===!1){let A=_t(s,e,t,n);return a!=null&&(A=Fe(A,a)),Rx(A,o,i,c)}let u=W(s,"a","fused matMul"),h=W(e,"b","fused matMul");[u,h]=Is(u,h);const p=t?u.shape[u.rank-2]:u.shape[u.rank-1],f=n?h.shape[h.rank-1]:h.shape[h.rank-2],g=t?u.shape[u.rank-1]:u.shape[u.rank-2],b=n?h.shape[h.rank-2]:h.shape[h.rank-1],y=u.shape.slice(0,-2),v=h.shape.slice(0,-2),w=Ae(y),N=Ae(v);V(p===f,()=>"Error in fused matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(u.shape," and ")+"".concat(h.shape," and transposeA=").concat(t)+" and transposeB=".concat(n," must match."));const I=kt(u.shape.slice(0,-2),h.shape.slice(0,-2)).concat([g,b]),T=t?le(u,[w,p,g]):le(u,[w,g,p]),$=n?le(h,[N,b,f]):le(h,[N,f,b]);let E;a!=null&&(E=W(a,"bias","fused matMul"),[E]=Is(E,u),kt(I,E.shape));let _;i!=null&&(_=W(i,"prelu weights","fused matMul"));const L=(A,U)=>{const[X,Z,q,B]=U,K=Ex(le(A,q.shape),q,o);let J,Q;if(!t&&!n?(J=_t(K,Z,!1,!0),Q=_t(X,K,!0,!1)):!t&&n?(J=_t(K,Z,!1,!1),Q=_t(K,X,!0,!1)):t&&!n?(J=_t(Z,K,!1,!0),Q=_t(X,K,!1,!1)):(J=_t(Z,K,!0,!0),Q=_t(K,X,!0,!0)),a!=null){const ae=Dx(B,K);return[J,Q,ae]}else return[J,Q]},O={a:T,b:$,bias:E,preluActivationWeights:_},z={transposeA:t,transposeB:n,activation:o,leakyreluAlpha:c};return a==null?Fo((U,X,Z)=>{const q=oe.runKernel(Em,O,z);return Z([U,X,q]),{value:le(q,I),gradFunc:L}})(T,$):Fo((U,X,Z,q)=>{const B=oe.runKernel(Em,O,z);return q([U,X,B,Z]),{value:le(B,I),gradFunc:L}})(T,$,E)}const ey=te({fusedMatMul_:n9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9=Object.freeze(Object.defineProperty({__proto__:null,conv2d:vT,depthwiseConv2d:s9,matMul:ey},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(s){return Sv(s,.54,.46)}const o9=te({hammingWindow_:r9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(s){return Sv(s,.5,.5)}const ST=te({hannWindow_:i9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(s,e,t,n=!1,a=0){let o=0;const i=[];for(;o+e<=s.size;)i.push(xt(s,o,e)),o+=t;if(n)for(;o<s.size;){const c=o+e-s.size,u=Ts([xt(s,o,e-c),_u([c],a)]);i.push(u),o+=t}return i.length===0?Ol([],[0,e]):le(Ts(i),[i.length,e])}const CT=te({frame_:l9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(s,e,t,n,a=ST){n==null&&(n=yT(e));const o=CT(s,e,t),i=ne(o,a(e));return Ax(i,n)}const u9=te({stft_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(s,e,t,n,a="bilinear",o=0){const i=W(s,"image","cropAndResize"),c=W(e,"boxes","cropAndResize","float32"),u=W(t,"boxInd","cropAndResize","int32"),h=c.shape[0];V(i.rank===4,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")),V(c.rank===2&&c.shape[1]===4,()=>"Error in cropAndResize: boxes must be have size [".concat(h,",4] ")+"but had shape ".concat(c.shape,".")),V(u.rank===1&&u.shape[0]===h,()=>"Error in cropAndResize: boxInd must be have size [".concat(h,"] ")+"but had shape ".concat(c.shape,".")),V(n.length===2,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(n.length,".")),V(n[0]>=1&&n[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(n)),V(a==="bilinear"||a==="nearest",()=>"method must be bilinear or nearest, but was ".concat(a));const p={image:i,boxes:c,boxInd:u},f={method:a,extrapolationValue:o,cropSize:n};return oe.runKernel(Yy,p,f)}const h9=te({cropAndResize_:d9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(s){const e=W(s,"image","flipLeftRight","float32");V(e.rank===4,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,"."));const t={image:e};return oe.runKernel(o2,t,{})}const f9=te({flipLeftRight_:p9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(s){const e=W(s,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];V(e.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")),V(n===1,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(n,"."));const a=new Array(e.rank);return a.fill(1,0,t),a[t]=3,nr(e,a)}const g9=te({grayscaleToRGB_:m9});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(s){const e=W(s,"image","RGBToGrayscale"),t=e.rank-1,n=e.shape[t];V(e.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")),V(n===3,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(n,"."));const a=e.dtype,o=qe(e,"float32"),i=Bs([.2989,.587,.114]);let c;switch(e.rank){case 2:c=cu("ij,j->i",o,i);break;case 3:c=cu("ijk,k->ij",o,i);break;case 4:c=cu("ijkl,l->ijk",o,i);break;case 5:c=cu("ijklm,m->ijkl",o,i);break;case 6:c=cu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return c=xn(c,-1),qe(c,a)}const b9=te({rgbToGrayscale_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(s,e,t=0,n=.5){const a=W(s,"image","rotateWithOffset","float32");V(a.rank===4,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,"."));const o={image:a},i={radians:e,fillValue:t,center:n};return oe.runKernel(V2,o,i)}const v9=te({rotateWithOffset_:y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lu(s,e,t,n,a,o){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=s.shape[0];return t=Math.min(t,i),V(0<=n&&n<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(n,"'")),V(s.rank===2,()=>"boxes must be a 2D tensor, but was of rank '".concat(s.rank,"'")),V(s.shape[1]===4,()=>"boxes must have 4 columns, but 2nd dimension was ".concat(s.shape[1])),V(e.rank===1,()=>"scores must be a 1D tensor"),V(e.shape[0]===i,()=>"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(e.shape[0])),V(0<=o&&o<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(o,"'")),{maxOutputSize:t,iouThreshold:n,scoreThreshold:a,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY){const o=W(s,"boxes","nonMaxSuppression","float32"),i=W(e,"scores","nonMaxSuppression","float32"),c=Lu(o,i,t,n,a);t=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold;const u={maxOutputSize:t,iouThreshold:n,scoreThreshold:a};return oe.runKernel(g2,{boxes:o,scores:i},u)}const N9=te({nonMaxSuppression_:w9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(s,e,t){const n=C9(s,e,t),a=n<0?-(n+1):n;s.splice(a,0,e)}function C9(s,e,t){return j9(s,e,t||k9)}function k9(s,e){return s>e?1:s<e?-1:0}function j9(s,e,t){let n=0,a=s.length,o=0,i=!1;for(;n<a;){o=n+(a-n>>>1);const c=t(e,s[o]);c>0?n=o+1:(a=o,i=!c)}return i?n:-n-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kv(s,e,t,n,a){return Iv(s,e,t,n,a,0)}function jv(s,e,t,n,a,o){return Iv(s,e,t,n,a,0,!1,o,!0)}function Tv(s,e,t,n,a,o){return Iv(s,e,t,n,a,o,!0)}function Iv(s,e,t,n,a,o,i=!1,c=!1,u=!1){const h=[];for(let w=0;w<e.length;w++)e[w]>a&&h.push({score:e[w],boxIndex:w,suppressBeginIndex:0});h.sort(H4);const p=o>0?-.5/o:0,f=[],g=[];for(;f.length<t&&h.length>0;){const w=h.pop(),{score:N,boxIndex:C,suppressBeginIndex:I}=w;if(N<a)break;let T=!1;for(let $=f.length-1;$>=I;--$){const E=T9(s,C,f[$]);if(E>=n){T=!0;break}if(w.score=w.score*I9(n,p,E),w.score<=a)break}w.suppressBeginIndex=f.length,T||(w.score===N?(f.push(C),g.push(w.score)):w.score>a&&S9(h,w,H4))}const b=f.length,y=t-b;c&&y>0&&(f.push(...new Array(y).fill(0)),g.push(...new Array(y).fill(0)));const v={selectedIndices:f};return i&&(v.selectedScores=g),u&&(v.validOutputs=b),v}function T9(s,e,t){const n=s.subarray(e*4,e*4+4),a=s.subarray(t*4,t*4+4),o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),h=Math.min(a[0],a[2]),p=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),b=(c-o)*(u-i),y=(f-h)*(g-p);if(b<=0||y<=0)return 0;const v=Math.max(o,h),w=Math.max(i,p),N=Math.min(c,f),C=Math.min(u,g),I=Math.max(N-v,0)*Math.max(C-w,0);return I/(b+y-I)}function I9(s,e,t){const n=Math.exp(e*t*t);return t<=s?n:0}function H4(s,e){return s.score-e.score||s.score===e.score&&e.boxIndex-s.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function $9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY){const o=W(s,"boxes","nonMaxSuppressionAsync"),i=W(e,"scores","nonMaxSuppressionAsync"),c=Lu(o,i,t,n,a);t=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold;const u=await Promise.all([o.data(),i.data()]),h=u[0],p=u[1],{selectedIndices:f}=kv(h,p,t,n,a);return o!==s&&o.dispose(),i!==e&&i.dispose(),Bs(f,"int32")}const A9=$9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=0){const i=W(s,"boxes","nonMaxSuppression"),c=W(e,"scores","nonMaxSuppression"),u=Lu(i,c,t,n,a,o);t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,o=u.softNmsSigma;const h={boxes:i,scores:c},p={maxOutputSize:t,iouThreshold:n,scoreThreshold:a,softNmsSigma:o},f=oe.runKernel(b2,h,p);return{selectedIndices:f[0],selectedScores:f[1]}}const D9=te({nonMaxSuppressionWithScore_:E9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function R9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=0){const i=W(s,"boxes","nonMaxSuppressionAsync"),c=W(e,"scores","nonMaxSuppressionAsync"),u=Lu(i,c,t,n,a,o);t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,o=u.softNmsSigma;const h=await Promise.all([i.data(),c.data()]),p=h[0],f=h[1],{selectedIndices:g,selectedScores:b}=Tv(p,f,t,n,a,o);return i!==s&&i.dispose(),c!==e&&c.dispose(),{selectedIndices:Bs(g,"int32"),selectedScores:Bs(b)}}const _9=R9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=!1){const i=W(s,"boxes","nonMaxSuppression"),c=W(e,"scores","nonMaxSuppression"),u=Lu(i,c,t,n,a,null),h=u.maxOutputSize,p=u.iouThreshold,f=u.scoreThreshold,g={boxes:i,scores:c},b={maxOutputSize:h,iouThreshold:p,scoreThreshold:f,padToMaxOutputSize:o},y=oe.runKernel(x2,g,b);return{selectedIndices:y[0],validOutputs:y[1]}}const F9=te({nonMaxSuppressionPadded_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function L9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=!1){const i=W(s,"boxes","nonMaxSuppressionAsync"),c=W(e,"scores","nonMaxSuppressionAsync"),u=Lu(i,c,t,n,a,null),h=u.maxOutputSize,p=u.iouThreshold,f=u.scoreThreshold,[g,b]=await Promise.all([i.data(),c.data()]),{selectedIndices:y,validOutputs:v}=jv(g,b,h,p,f,o);return i!==s&&i.dispose(),c!==e&&c.dispose(),{selectedIndices:Bs(y,"int32"),validOutputs:ht(v,"int32")}}const M9=L9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(s,e,t=!1,n=!1){const a=W(s,"images","resizeBilinear");V(a.rank===3||a.rank===4,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),V(e.length===2,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")),V(n===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;a.rank===3&&(i=!0,o=le(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={images:o},u={alignCorners:t,halfPixelCenters:n,size:e},h=oe.runKernel(ex,c,u);return i?le(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kT=te({resizeBilinear_:z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(s,e,t=!1,n=!1){const a=W(s,"images","resizeNearestNeighbor");V(a.rank===3||a.rank===4,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),V(e.length===2,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")),V(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),V(n===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;a.rank===3&&(i=!0,o=le(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={images:o},u={alignCorners:t,halfPixelCenters:n,size:e},h=oe.runKernel(Jg,c,u);return i?le(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const jT=te({resizeNearestNeighbor_:P9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(s,e="binary",t=!1,n=.5){const a=W(s,"image","threshold"),o=.2989,i=.587,c=.114,u=a.shape[0]*a.shape[1];let h=ne(Bs([n]),255),p,f,g,b;if(V(a.rank===3,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,".")),V(a.shape[2]===3||a.shape[2]===1,()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],".")),V(a.dtype==="int32"||a.dtype==="float32",()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,".")),V(e==="otsu"||e==="binary",()=>"Method must be binary or otsu, but was ".concat(e)),a.shape[2]===3){[p,f,g]=ba(a,[1,1,1],-1);const w=ne(p,o),N=ne(f,i),C=ne(g,c);b=Fe(Fe(w,N),C)}else b=s;if(e==="otsu"){const w=_j(qe(uv(b),"int32"),Sr([]),256);h=V9(w,u)}const y=t?tc(b,h):Ca(b,h);return qe(ne(y,255),"int32")}function V9(s,e){let t=Bs([-1]),n=Bs([0]),a=Bs([0]),o,i,c,u,h,p;for(let f=0;f<s.size-1;f++){o=xt(s,0,f+1),i=xt(s,f+1),h=Ze(at(o),e),p=Ze(at(i),e);const g=at(ne(o,Nu(0,o.size)));c=Ze(g,at(o));const b=_u(i.shape,o.size),y=Fe(Nu(0,i.size),b),v=ne(i,y);u=Ze(at(v),at(i));const w=et(c,u),N=et(c,u),C=ne(h,p);a=ne(ne(C,w),N);const I=Ca(a,n);n=$n(I,a,n),t=$n(I,Bs([f]),t)}return t}const U9=te({threshold_:B9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(s,e,t="nearest",n="constant",a=0,o){const i=W(s,"image","transform","float32"),c=W(e,"transforms","transform","float32");V(i.rank===4,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,".")),V(c.rank===2&&(c.shape[0]===i.shape[0]||c.shape[0]===1)&&c.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),V(o==null||o.length===2,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(o,"."));const u={image:i,transforms:c},h={interpolation:t,fillMode:n,fillValue:a,outputShape:o};return oe.runKernel(P2,u,h)}const W9=te({transform_:G9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(s,e,t){const n=W(s,"a","bandPart");V(n.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(n.rank,"."));const a=n.shape,[o,i]=n.shape.slice(-2);let c,u;typeof e=="number"?(V(e%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(e,".")),V(e<=o,()=>"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(o,").")),c=W(e<0?o:e,"numLower","bandPart")):(V(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),c=$n(fh(e,0),o,ql(e,o))),typeof t=="number"?(V(t%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(t,".")),V(t<=i,()=>"bandPart(): numUpper (".concat(t,")")+" must not be greater than the number of columns (".concat(i,").")),u=W(t<0?i:t,"numUpper","bandPart")):(V(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=$n(fh(t,0),i,ql(t,i)));const h=le(Nu(0,o,1,"int32"),[-1,1]),p=Nu(0,i,1,"int32"),f=et(h,p),g=to(tc(f,c),Yi(f,fs(u))),b=Ks([o,i],n.dtype);return le(va(ur(le(n,[-1,o,i])).map(y=>$n(g,y,b))),a)}const q9=te({bandPart_:H9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(s){let e;if(Array.isArray(s)){e=!1,V(s!=null&&s.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=s[0].shape[0];for(let o=1;o<s.length;++o)V(s[o].shape[0]===a,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(s[o].shape[0]," vs. ").concat(a,")"))}else e=!0,s=ba(s,s.shape[0],0).map(a=>Es(a,[0]));V(s.length<=s[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(s.length,") exceeds ")+"number of dimensions (".concat(s[0].shape[0],")."));const t=[],n=s;for(let a=0;a<s.length;++a)t.push(oe.tidy(()=>{let o=n[a];if(a>0)for(let i=0;i<a;++i){const c=ne(at(ne(t[i],o)),t[i]);o=et(o,c)}return Ze(o,Ip(o,"euclidean"))}));return e?va(t,0):t}const X9=te({gramSchmidt_:K9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(s,e=!1){if(V(s.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(s.rank)),s.rank===2)return q4(s,e);{const t=s.shape.slice(0,s.shape.length-2).reduce((u,h)=>u*h),n=ur(le(s,[t,s.shape[s.shape.length-2],s.shape[s.shape.length-1]]),0),a=[],o=[];n.forEach(u=>{const[h,p]=q4(u,e);a.push(h),o.push(p)});const i=le(va(a,0),s.shape),c=le(va(o,0),s.shape);return[i,c]}}function q4(s,e=!1){return oe.tidy(()=>{V(s.shape.length===2,()=>"qr2d() requires a 2D Tensor, but got a ".concat(s.shape.length,"D Tensor."));const t=s.shape[0],n=s.shape[1];let a=sv(t),o=Ro(s);const i=Ol([[1]],[1,1]);let c=Ro(i);const u=t>=n?n:t;for(let h=0;h<u;++h){const p=o,f=c,g=a;[c,o,a]=oe.tidy(()=>{const b=xt(o,[h,h],[t-h,1]),y=Ip(b),v=xt(o,[h,h],[1,1]),w=$n(Ca(v,0),Ol([[-1]]),Ol([[1]])),N=et(v,ne(w,y)),C=Ze(b,N);C.shape[0]===1?c=Ro(i):c=Ts([i,xt(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const I=fs(Ze(_t(w,N),y)),T=xt(o,[h,0],[t-h,n]),$=ne(I,c),E=Pt(c);if(h===0)o=et(T,_t($,_t(E,T)));else{const O=et(T,_t($,_t(E,T)));o=Ts([xt(o,[0,0],[h,n]),O],0)}const _=Pt($),L=xt(a,[0,h],[t,a.shape[1]-h]);if(h===0)a=et(L,_t(_t(L,c),_));else{const O=et(L,_t(_t(L,c),_));a=Ts([xt(a,[0,0],[t,h]),O],1)}return[c,o,a]}),Ct([p,f,g])}return!e&&t>n&&(a=xt(a,[0,0],[t,n]),o=xt(o,[0,0],[n,n])),[a,o]})}const Z9=te({qr_:Y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ea;(function(s){s[s.NONE=0]="NONE",s[s.MEAN=1]="MEAN",s[s.SUM=2]="SUM",s[s.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ea||(ea={}));function Q9(s,e,t=ea.SUM_BY_NONZERO_WEIGHTS){const n=W(s,"losses","computeWeightedLoss");let a=null;e!=null&&(a=W(e,"weights","computeWeightedLoss"));const o=a==null?n:ne(n,a);if(t===ea.NONE)return o;if(t===ea.SUM)return at(o);if(t===ea.MEAN){if(a==null)return js(o);{const i=n.size/a.size,c=Ze(at(o),at(a));return i>1?Ze(c,ht(i)):c}}if(t===ea.SUM_BY_NONZERO_WEIGHTS){if(a==null)return Ze(at(o),ht(n.size));{const i=ne(a,xa(n.shape)),c=qe(at(wu(i,ht(0))),"float32");return Ze(at(o),c)}}throw Error("Unknown reduction: ".concat(t))}const Ho=te({computeWeightedLoss_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(s,e,t,n=ea.SUM_BY_NONZERO_WEIGHTS){const a=W(s,"labels","absoluteDifference"),o=W(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=W(t,"weights","absoluteDifference")),Sa(a.shape,o.shape,"Error in absoluteDifference: ");const c=qs(et(a,o));return Ho(c,i,n)}const eV=te({absoluteDifference_:J9});function tV(s,e,t,n,a=ea.SUM_BY_NONZERO_WEIGHTS){const o=W(s,"labels","cosineDistance"),i=W(e,"predictions","cosineDistance");let c=null;n!=null&&(c=W(n,"weights","cosineDistance")),Sa(o.shape,i.shape,"Error in cosineDistance: ");const u=ht(1),h=et(u,at(ne(o,i),t,!0));return Ho(h,c,a)}const sV=te({cosineDistance_:tV});function nV(s,e,t,n=ea.SUM_BY_NONZERO_WEIGHTS){let a=W(s,"labels","hingeLoss");const o=W(e,"predictions","hingeLoss");let i=null;t!=null&&(i=W(t,"weights","hingeLoss")),Sa(a.shape,o.shape,"Error in hingeLoss: ");const c=ht(1);a=et(ne(ht(2),a),c);const u=ro(et(c,ne(a,o)));return Ho(u,i,n)}const aV=te({hingeLoss_:nV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(s,e,t,n=1,a=ea.SUM_BY_NONZERO_WEIGHTS){const o=W(s,"labels","huberLoss"),i=W(e,"predictions","huberLoss");let c=null;t!=null&&(c=W(t,"weights","huberLoss")),Sa(o.shape,i.shape,"Error in huberLoss: ");const u=ht(n),h=qs(et(i,o)),p=ql(h,u),f=et(h,p),g=Fe(ne(ht(.5),is(p)),ne(u,f));return Ho(g,c,a)}const oV=te({huberLoss_:rV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(s,e,t,n=1e-7,a=ea.SUM_BY_NONZERO_WEIGHTS){const o=W(s,"labels","logLoss"),i=W(e,"predictions","logLoss");let c=null;t!=null&&(c=W(t,"weights","logLoss")),Sa(o.shape,i.shape,"Error in logLoss: ");const u=ht(1),h=ht(n),p=fs(ne(o,Oa(Fe(i,h)))),f=ne(et(u,o),Oa(Fe(et(u,i),h))),g=et(p,f);return Ho(g,c,a)}const lV=te({logLoss_:iV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(s,e,t,n=ea.SUM_BY_NONZERO_WEIGHTS){const a=W(s,"labels","meanSquaredError"),o=W(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=W(t,"weights","meanSquaredError")),Sa(a.shape,o.shape,"Error in meanSquaredError: ");const c=bv(a,o);return Ho(c,i,n)}const uV=te({meanSquaredError_:cV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(s,e){const t=W(s,"labels","sigmoidCrossEntropyWithLogits"),n=W(e,"logits","sigmoidCrossEntropyWithLogits");Sa(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=ro(n),o=ne(n,t),i=bx(Bn(fs(qs(n))));return Fe(et(a,o),i)}function hV(s,e,t,n=0,a=ea.SUM_BY_NONZERO_WEIGHTS){let o=W(s,"multiClassLabels","sigmoidCrossEntropy");const i=W(e,"logits","sigmoidCrossEntropy");let c=null;if(t!=null&&(c=W(t,"weights","sigmoidCrossEntropy")),Sa(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),n>0){const h=ht(n),p=ht(1),f=ht(.5);o=Fe(ne(o,et(p,h)),ne(f,h))}const u=dV(o,i);return Ho(u,c,a)}const pV=te({sigmoidCrossEntropy_:hV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(s,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(t));return Fo((a,o,i)=>{const u=yx(o,[t],!0),h=et(qe(o,"float32"),u);i([a,h]);const p=fs(ne(h,a));return{value:at(p,[t]),gradFunc:(b,y)=>{const[v,w]=y,N=Rs(b.shape,[t]);return[ne(le(b,N),et(qe(v,"float32"),Bn(w))),ne(le(b,N),et(Bn(w),qe(v,"float32")))]}}})(s,e)}function mV(s,e,t,n=0,a=ea.SUM_BY_NONZERO_WEIGHTS){let o=W(s,"onehotLabels","softmaxCrossEntropy");const i=W(e,"logits","softmaxCrossEntropy");let c=null;if(t!=null&&(c=W(t,"weights","softmaxCrossEntropy")),Sa(o.shape,i.shape,"Error in softmaxCrossEntropy: "),n>0){const h=ht(n),p=ht(1),f=ht(o.shape[1]);o=Fe(ne(o,et(p,h)),Ze(h,f))}const u=fV(o,i);return Ho(u,c,a)}const gV=te({softmaxCrossEntropy_:mV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(s,e,t,n){const a=W(s,"indices","sparseFillEmptyRows","int32"),o=W(e,"values","sparseFillEmptyRows"),i=W(t,"denseShape","sparseFillEmptyRows","int32"),c=W(n,"defaultValue","sparseFillEmptyRows",o.dtype);if(a.rank!==2)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(o.rank!==1)throw new Error("Values should be Tensor1D but received shape ".concat(o.shape));if(i.rank!==1)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(c.rank!==0)throw new Error("Default value should be a scalar but received shape ".concat(c.shape));const u={indices:a,values:o,denseShape:i,defaultValue:c},h=oe.runKernel($2,u);return{outputIndices:h[0],outputValues:h[1],emptyRowIndicator:h[2],reverseIndexMap:h[3]}}const bV=te({sparseFillEmptyRows_:xV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(s,e,t){const n=W(s,"inputIndices","sparseReshape","int32"),a=W(e,"inputShape","sparseReshape","int32"),o=W(t,"newShape","sparseReshape","int32");if(n.rank!==2)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(n.shape));if(a.rank!==1)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(o.rank!==1)throw new Error("New shape should be Tensor1D but received shape ".concat(o.shape));const i={inputIndices:n,inputShape:a,newShape:o},c=oe.runKernel(A2,i);return{outputIndices:c[0],outputShape:c[1]}}const vV=te({sparseReshape_:yV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(s,e,t){const n=W(s,"data","sparseSegmentMean"),a=W(e,"indices","sparseSegmentMean","int32"),o=W(t,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(o.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(o.shape));const i={data:n,indices:a,segmentIds:o};return oe.runKernel(E2,i)}const NV=te({sparseSegmentMean_:wV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(s,e,t){const n=W(s,"data","sparseSegmentSum"),a=W(e,"indices","sparseSegmentSum","int32"),o=W(t,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(o.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(o.shape));const i={data:n,indices:a,segmentIds:o};return oe.runKernel(D2,i)}const CV=te({sparseSegmentSum_:SV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kV(s,e,t,n,a,o,i,c){const u=W(s,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error("Data must be a vector, saw: ".concat(u.shape));const h=W(e,"dataSplits","stringNGrams");if(h.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const p={separator:t,nGramWidths:n,leftPad:a,rightPad:o,padWidth:i,preserveShortSequences:c},f={data:u,dataSplits:h},g=oe.runKernel(F2,f,p);return{nGrams:g[0],nGramsSplits:g[1]}}const jV=te({stringNGrams_:kV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(s,e,t=!0){const n=W(s,"input","stringSplit","string"),a=W(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error("Input should be Tensor1D but received shape ".concat(n.shape));if(a.rank!==0)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));const o={skipEmpty:t},i={input:n,delimiter:a},c=oe.runKernel(L2,i,o);return{indices:c[0],values:c[1],shape:c[2]}}const IV=te({stringSplit_:TV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(s,e){const t=W(s,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:t};return oe.runKernel(M2,a,n)}const AV=te({stringToHashBucketFast_:$V});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(s,e,t,n=!0){const a=W(s,"input","staticRegexReplace","string"),o={pattern:e,rewrite:t,replaceGlobal:n};return oe.runKernel(lx,{x:a},o)}const DV=te({staticRegexReplace_:EV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RV={fft:$x,ifft:xh,rfft:Ax,irfft:xv},_V={hammingWindow:o9,hannWindow:ST,frame:CT,stft:u9},Ra={flipLeftRight:f9,grayscaleToRGB:g9,resizeNearestNeighbor:jT,resizeBilinear:kT,rgbToGrayscale:b9,rotateWithOffset:v9,cropAndResize:h9,nonMaxSuppression:N9,nonMaxSuppressionAsync:A9,nonMaxSuppressionWithScore:D9,nonMaxSuppressionWithScoreAsync:_9,nonMaxSuppressionPadded:F9,nonMaxSuppressionPaddedAsync:M9,threshold:U9,transform:W9},TT={bandPart:q9,gramSchmidt:X9,qr:Z9},OV={absoluteDifference:eV,computeWeightedLoss:Ho,cosineDistance:sV,hingeLoss:aV,huberLoss:oV,logLoss:lV,meanSquaredError:uV,sigmoidCrossEntropy:pV,softmaxCrossEntropy:gV},FV={sparseFillEmptyRows:bV,sparseReshape:vV,sparseSegmentMean:NV,sparseSegmentSum:CV},LV={stringNGrams:jV,stringSplit:IV,stringToHashBucketFast:AV,staticRegexReplace:DV};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MV=new Map,zV=new Map;class Mu{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class sr{constructor(){this.classNameMap={}}static getMap(){return sr.instance==null&&(sr.instance=new sr),sr.instance}static register(e){sr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Pe(s,e,t){V(s.className!=null,()=>"Class being registered does not have the static className property defined."),V(typeof s.className=="string",()=>"className is required to be a string, but got type "+typeof s.className),V(s.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=s.className);const n=t,a=e+">"+n;return sr.register(s),MV.set(a,s),zV.set(s,a),s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qi extends Mu{minimize(e,t=!1,n){const{value:a,grads:o}=this.computeGradients(e,n);if(n!=null){const i=n.map(c=>({name:c.name,tensor:o[c.name]}));this.applyGradients(i)}else this.applyGradients(o);return Ct(o),t?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return cz(e,t)}dispose(){this.iterations_!=null&&Ct(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ht(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Qi,Symbol.hasInstance,{value:s=>s.minimize!=null&&s.computeGradients!=null&&s.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IT extends Qi{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=oe.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=oe.registeredVariables[n],i=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:"".concat(n,"/accum_grad"),variable:me(()=>Bt(o).variable(i))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:"".concat(n,"/accum_var"),variable:me(()=>Bt(o).variable(i))});const c=Array.isArray(e)?e[a].tensor:e[n];if(c==null)return;const u=this.accumulatedGrads[a].variable,h=this.accumulatedUpdates[a].variable;me(()=>{const p=Fe(ne(u,this.rho),ne(is(c),1-this.rho)),f=ne(Ze(wn(Fe(h,this.epsilon)),wn(Fe(u,this.epsilon))),c),g=Fe(ne(h,this.rho),ne(is(f),1-this.rho));u.assign(p),h.assign(g);const b=Fe(ne(f,-this.learningRate),o);o.assign(b)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ct(this.accumulatedGrads.map(e=>e.variable)),Ct(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $T extends Qi{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=oe.registeredVariables[n];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:"".concat(n,"/accumulator"),variable:me(()=>_u(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[a].tensor:e[n];if(i==null)return;const c=this.accumulatedGrads[a].variable;me(()=>{const u=Fe(c,is(i));c.assign(u);const h=Fe(ne(Ze(i,wn(Fe(u,oe.backend.epsilon()))),-this.learningRate),o);o.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ct(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AT extends Qi{static get className(){return"Adam"}constructor(e,t,n,a=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],me(()=>{this.accBeta1=ht(t).variable(),this.accBeta2=ht(n).variable()}),a==null&&(this.epsilon=oe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);me(()=>{const n=et(1,this.accBeta1),a=et(1,this.accBeta2);t.forEach((o,i)=>{const c=oe.registeredVariables[o],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(o,"/m"),variable:me(()=>Bt(c).variable(u))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:"".concat(o,"/v"),variable:me(()=>Bt(c).variable(u))});const h=Array.isArray(e)?e[i].tensor:e[o];if(h==null)return;const p=this.accumulatedFirstMoment[i].variable,f=this.accumulatedSecondMoment[i].variable,g=Fe(ne(p,this.beta1),ne(h,1-this.beta1)),b=Fe(ne(f,this.beta2),ne(is(h),1-this.beta2)),y=Ze(g,n),v=Ze(b,a);p.assign(g),f.assign(b);const w=Fe(ne(Ze(y,Fe(wn(v),this.epsilon)),-this.learningRate),c);c.assign(w)}),this.accBeta1.assign(ne(this.accBeta1,this.beta1)),this.accBeta2.assign(ne(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ct(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ct(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),me(()=>{this.accBeta1.assign(Oo(this.beta1,this.iterations_+1)),this.accBeta2.assign(Oo(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ET extends Qi{static get className(){return"Adamax"}constructor(e,t,n,a=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],me(()=>{this.iteration=ht(0).variable(),this.accBeta1=ht(t).variable()}),a==null&&(this.epsilon=oe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);me(()=>{const n=et(1,this.accBeta1),a=Ze(-this.learningRate,Fe(ne(this.iteration,this.decay),1));t.forEach((o,i)=>{const c=oe.registeredVariables[o],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(o,"/m"),variable:Bt(c).variable(u)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:"".concat(o,"/v"),variable:Bt(c).variable(u)});const h=Array.isArray(e)?e[i].tensor:e[o];if(h==null)return;const p=this.accumulatedFirstMoment[i].variable,f=this.accumulatedWeightedInfNorm[i].variable,g=Fe(ne(p,this.beta1),ne(h,1-this.beta1)),b=ne(f,this.beta2),y=qs(h),v=Wo(b,y);p.assign(g),f.assign(v);const w=Fe(ne(Ze(a,n),Ze(g,Fe(v,this.epsilon))),c);c.assign(w)}),this.iteration.assign(Fe(this.iteration,1)),this.accBeta1.assign(ne(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ct(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ct(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $v extends Qi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=Array.isArray(e)?e[a].tensor:e[n];if(o==null)return;const i=oe.registeredVariables[n];me(()=>{const c=Fe(ne(this.c,o),i);i.assign(c)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=un(ht(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DT extends $v{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=ht(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=oe.registeredVariables[n];this.accumulations[a]==null&&(this.accumulations[a]={originalName:"".concat(n,"/momentum"),variable:me(()=>Bt(o).variable(!1))});const i=this.accumulations[a].variable,c=Array.isArray(e)?e[a].tensor:e[n];c!=null&&me(()=>{let u;const h=Fe(ne(this.m,i),c);this.useNesterov?u=Fe(ne(this.c,Fe(c,ne(h,this.m))),o):u=Fe(ne(this.c,h),o),i.assign(h),o.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ct(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RT extends Qi{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,a=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,a==null&&(this.epsilon=oe.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=oe.registeredVariables[n],i=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:"".concat(n,"/rms"),variable:me(()=>Bt(o).variable(i))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:"".concat(n,"/momentum"),variable:me(()=>Bt(o).variable(i))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:"".concat(n,"/mg"),variable:me(()=>Bt(o).variable(i))});const c=Array.isArray(e)?e[a].tensor:e[n];if(c==null)return;const u=this.accumulatedMeanSquares[a].variable,h=this.accumulatedMoments[a].variable;me(()=>{const p=Fe(ne(u,this.decay),ne(is(c),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[a].variable,g=Fe(ne(f,this.decay),ne(c,1-this.decay)),b=Ze(ne(c,this.learningRate),wn(et(p,Fe(is(g),this.epsilon)))),y=Fe(ne(h,this.momentum),b);u.assign(p),f.assign(g),h.assign(y);const v=et(o,y);o.assign(v)}else{const f=Fe(ne(u,this.decay),ne(is(c),1-this.decay)),g=Fe(ne(h,this.momentum),Ze(ne(c,this.learningRate),wn(Fe(f,this.epsilon))));u.assign(f),h.assign(g);const b=et(o,g);o.assign(b)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ct(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ct(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ct(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PV=[IT,$T,AT,ET,DT,RT,$v];function BV(){for(const s of PV)Pe(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VV="model",UV=".json",GV=".weights.bin";function K4(s){return new Promise(e=>setTimeout(e)).then(s)}class Kl{constructor(e){if(!Se().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Kl.URL_SCHEME)&&(e=e.slice(Kl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=VV),this.modelJsonFileName=e+UV,this.weightDataFileName=e+GV}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=Ar.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=dj(e,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),c=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(c.download=this.modelJsonFileName,c.href=i,await K4(()=>c.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=n,await K4(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Sp(e)}}}}Kl.URL_SCHEME="downloads://";class WV{constructor(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const n=new FileReader;n.onload=a=>{const o=JSON.parse(a.target.result),i=o.modelTopology;if(i==null){t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));return}if(o.weightsManifest==null){t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const u=W2(o,h=>this.loadWeights(h));e(u)},n.onerror=a=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(e){const t=[],n=[];for(const i of e)t.push(...i.weights),n.push(...i.paths);const a=this.checkManifestAndWeightFiles(e),o=n.map(i=>this.loadWeightsFile(i,a[i]));return Promise.all(o).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((n,a)=>{const o=new FileReader;o.onload=i=>{const c=i.target.result;n(c)},o.onerror=i=>a("Failed to weights data from file of path '".concat(e,"'.")),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map(o=>L4(o.name)),a={};for(const o of e)o.paths.forEach(i=>{const c=L4(i);if(t.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(c,"'"));if(t.push(c),n.indexOf(c)===-1)throw new Error("Weight file with basename '".concat(c,"' is not provided."));a[i]=this.weightsFiles[n.indexOf(c)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return a}}const HV=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Kl.URL_SCHEME)?qV(s.slice(Kl.URL_SCHEME.length)):null;ys.registerSaveRouter(HV);function qV(s="model"){return new Kl(s)}function KV(s){return new WV(s)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(s,e,t,n){i(s),t=t==null?0:t,n=n==null?1:n,c(t,n);let a=0;const o=u=>(u.then(h=>{const p=t+ ++a/s.length*(n-t);return e(p),h}),u);function i(u){V(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function c(u,h){V(u>=0&&u<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(u)),V(h>=0&&h<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(h)),V(h>=u,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(u," and endFraction ")+"".concat(h))}return Promise.all(s.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _T(s,e){e==null&&(e={});const t=e.fetchFunc==null?Se().platform.fetch:e.fetchFunc,n=s.map(f=>t(f,e.requestInit,{isBinary:!0})),c=(e.onProgress==null?await Promise.all(n):await X4(n,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(c):await X4(c,e.onProgress,.5,1)}function XV(s,e){var t;const n=e.fetchFunc==null?Se().platform.fetch:e.fetchFunc;let a=0,o;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async i=>{for(var c;a<s.length;){o||(o=(await n(s[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:h}=await o.read();if(u){a++,o=void 0,(c=e.onProgress)===null||c===void 0||c.call(e,a/s.length);continue}i.enqueue(h);return}i.close()}})}async function YV(s,e="",t,n){return OT(i=>_T(i,{requestInit:n}))(s,e,t)}function OT(s){return async(e,t="",n)=>{const a=e.map(()=>!1),o={},i=n!=null?n.map(()=>!1):[],c=[];if(e.forEach((b,y)=>{let v=0;b.weights.forEach(w=>{const N="quantization"in w?w.quantization.dtype:w.dtype,C=Vl[N]*Ae(w.shape),I=()=>{a[y]=!0,o[y]==null&&(o[y]=[]),o[y].push({manifestEntry:w,groupOffset:v,sizeBytes:C})};n!=null?n.forEach((T,$)=>{T===w.name&&(I(),i[$]=!0)}):I(),c.push(w.name),v+=C})}),!i.every(b=>b)){const b=n.filter((y,v)=>!i[v]);throw new Error("Could not find weights in manifest with names: "+"".concat(b.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(c.join(", "),"."))}const u=a.reduce((b,y,v)=>(y&&b.push(v),b),[]),h=[];u.forEach(b=>{e[b].paths.forEach(y=>{const v=t+(t.endsWith("/")?"":"/")+y;h.push(v)})});const p=await s(h),f={};let g=0;return u.forEach(b=>{const y=e[b].paths.length,v=new Ar(p.slice(g,g+y));o[b].forEach(N=>{const C=v.slice(N.groupOffset,N.groupOffset+N.sizeBytes),I=ij(C,[N.manifestEntry]);for(const T in I)f[T]=I[T]}),g+=y}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZV="application/octet-stream",QV="application/json";class Av{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(V(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Se().platform.fetch,V(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&V(e.length===2,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=dj(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(a)],{type:QV}),"model.json"),e.weightData!=null){const i=Ar.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:ZV}),"model.weights.bin")}const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:Sp(e),responses:[o]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(o){let i="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const n=t.modelTopology,a=t.weightsManifest;if(n==null&&a==null)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return W2(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=K1(e.weightsManifest),a=()=>XV(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:a})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,a]=JV(t),o=this.weightPathPrefix||n,i=[],c=[];for(const u of e)for(const h of u.paths)this.weightUrlConverter!=null?c.push(this.weightUrlConverter(h)):i.push(o+h+a);return this.weightUrlConverter&&i.push(...await Promise.all(c)),i}async loadWeights(e){const t=await this.getWeightUrls(e),n=K1(e),a=await _T(t,this.loadOptions);return[n,a]}}Av.URL_SCHEME_REGEX=/^https?:\/\//;function JV(s){const e=s.lastIndexOf("/"),t=s.lastIndexOf("?"),n=s.substring(0,e),a=t>e?s.substring(t):"";return[n+"/",a]}function ty(s){return s.match(Av.URL_SCHEME_REGEX)!=null}const FT=(s,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(s)?t=s.every(n=>ty(n)):t=ty(s),t)return Ev(s,e)}return null};ys.registerSaveRouter(FT);ys.registerLoadRouter(FT);function Ev(s,e){return new Av(s,e)}function eU(s,e){return Ev(s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f1{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class LT{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class tU{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function sU(s,e,t,n){const a=arguments;return new tU(MT(...a))}function MT(s,e,t,n){return arguments.length===1?s.modelTopology!=null||s.weightSpecs!=null?new f1(s):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new f1({modelTopology:s})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new f1({modelTopology:s,weightSpecs:e,weightData:t,trainingConfig:n}))}function nU(s){return new LT(s)}function aU(s){return new LT(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zT=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ar,browserFiles:KV,browserHTTPRequest:eU,concatenateArrayBuffers:uj,copyModel:aL,decodeWeights:ij,decodeWeightsStream:cj,encodeWeights:q1,fromMemory:sU,fromMemorySync:MT,getLoadHandlers:G7,getModelArtifactsForJSON:W2,getModelArtifactsForJSONSync:hj,getModelArtifactsInfoForJSON:Sp,getSaveHandlers:pj,getWeightSpecs:K1,http:Ev,isHTTPScheme:ty,listModels:sL,loadWeights:YV,moveModel:rL,registerLoadRouter:U7,registerSaveRouter:V7,removeModel:nL,weightsLoaderFactory:OT,withSaveHandler:nU,withSaveHandlerSync:aU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kl;function rU(s,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(s==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,n=!1,a=!1,o=!1,i=!1,c=!1;if(s.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&s instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement)o=!0;else if(s.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&s instanceof ImageBitmap)c=!0;else throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(s.constructor.name));if(B1(z1,oe.backendName)!=null){const y={pixels:s},v={numChannels:e};return oe.runKernel(z1,y,v)}const[h,p]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height];let f;if(i)f=s.getContext("2d").getImageData(0,0,h,p).data;else if(n||t)f=s.data;else if(o||a||c){if(kl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")kl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else kl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});kl.canvas.width=h,kl.canvas.height=p,kl.drawImage(s,0,0,h,p),f=kl.getImageData(0,0,h,p).data}let g;if(e===4)g=new Int32Array(f);else{const y=h*p;g=new Int32Array(y*e);for(let v=0;v<y;v++)for(let w=0;w<e;++w)g[v*e+w]=f[v*4+w]}return hT(g,[p,h,e],"int32")}function oU(s){if(s.rank!==2&&s.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(s.rank,"."));const e=s.rank===2?1:s.shape[2];if(e>4||e===2)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if(s.dtype!=="float32"&&s.dtype!=="int32")throw new Error("Unsupported type for toPixels: ".concat(s.dtype,".")+" Please use float32 or int32 tensors.")}async function iU(s,e){let t=W(s,"img","toPixels");if(!(s instanceof os)){const h=t;t=qe(h,"int32"),h.dispose()}oU(t);const[n,a]=t.shape.slice(0,2),o=t.rank===2?1:t.shape[2],i=await t.data(),c=t.dtype==="float32"?255:1,u=new Uint8ClampedArray(a*n*4);for(let h=0;h<n*a;++h){const p=[0,0,0,255];for(let g=0;g<o;g++){const b=i[h*o+g];if(t.dtype==="float32"){if(b<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(b,"."))}else if(t.dtype==="int32"&&(b<0||b>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(b,"."));o===1?(p[0]=b*c,p[1]=b*c,p[2]=b*c):p[g]=b*c}const f=h*4;u[f+0]=Math.round(p[0]),u[f+1]=Math.round(p[1]),u[f+2]=Math.round(p[2]),u[f+3]=Math.round(p[3])}return t!==s&&t.dispose(),u}const lU=te({fromPixels_:rU});function Dv(s,e){const t=s.shape.length,n=e.shape.length;if(t<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(t,"."));if(n<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[n-1]>t)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[n-1]," vs. ").concat(t));if(Ae(s.shape)===0)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(s.shape,"."));const a=e.shape,o=a[a.length-1];let i=1;for(let f=0;f<a.length-1;++f)i*=a[f];const c=s.shape,u=a.slice();u.pop();let h=1;for(let f=o;f<t;++f)h*=c[f],u.push(c[f]);const p=[...ut(s.shape).map(f=>f/h),1].slice(0,o);return[u,i,h,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sy=-2,cU=-1;function Rv(s,e,t){const n=s.shape.length;V(n===e.length,()=>"Error in slice".concat(n,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(n,").")),V(n===t.length,()=>"Error in slice".concat(n,"D: Length of size ").concat(t," must ")+"match the rank of the array (".concat(n,")."));for(let a=0;a<n;++a)V(e[a]+t[a]<=s.shape[a],()=>"Error in slice".concat(n,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+t[a],") would overflow input.shape[").concat(a,"] (").concat(s.shape[a],")"))}function uU(s){const e=[];let t=0;for(;s>0;)s&1&&e.push(t),s/=2,t++;return e}function _v(s,e,t){const n=[];for(let a=0;a<s.length;a++)n[a]=Math.ceil((e[a]-s[a])/t[a]);return n}function PT(s,e,t,n){const a=[...s];for(let o=a.length;o<n.length;o++)a.push(1);for(let o=0;o<t;o++)o===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function BT(s,e,t){return t<=s?t:t-(e-1)}function VT(s,e){const t=[];for(let n=0;n<s;n++)t.push(e+n);return t}function dU(s,e,t,n,a,o,i,c,u){const h=s.length;let p=new Array(h),f=new Array(h),g=new Array(h);if(e.length&&t>0){const b=e[0],y=t+1;p=UT(i,b,y,n,s),f=GT(c,b,y,a,s),g=PT(o,b,y,s)}else for(let b=0;b<h;b++)p[b]=HT(i,n,o,s,b,u),f[b]=qT(c,a,o,s,b,u),g[b]=WT(o,b,u);return{begin:p,end:f,strides:g}}function UT(s,e,t,n,a){const o=[...a],i=VT(t,e);for(let c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=0;else{const u=BT(e,t,c);let h=n[u];s&1<<u&&(h=0),o[c]=h}return o}function GT(s,e,t,n,a){const o=[...a],i=VT(t,e);for(let c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=Number.MAX_SAFE_INTEGER;else{const u=BT(e,t,c);let h=n[u];s&1<<u&&(h=Number.MAX_SAFE_INTEGER),o[c]=h}for(let c=0;c<o.length;c++){const u=a[c];o[c]<0&&(o[c]+=u),o[c]=zl(0,o[c],a[c])}return o}function WT(s,e,t){let n=s[e];return(t&1<<e||n==null)&&(n=1),n}function HT(s,e,t,n,a,o){let i=e[a];const c=t[a]||1;(s&1<<a||o&1<<a||i==null)&&(c>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const u=n[a];return i<0&&(i+=u),i=zl(0,i,u-1),i}function qT(s,e,t,n,a,o){let i=e[a];const c=t[a]||1;(s&1<<a||o&1<<a||i==null)&&(c>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const u=n[a];return i<0&&(i+=u),c>0?i=zl(0,i,u):i=zl(-1,i,u-1),i}function Ov(s,e,t){let n=t.length;for(let a=0;a<t.length;a++)if(t[a]>1){n=a;break}for(let a=n+1;a<t.length;a++)if(e[a]>0||t[a]!==s[a])return!1;return!0}function Fv(s,e){let t=s.length>0?s[s.length-1]:1;for(let n=0;n<s.length-1;n++)t+=s[n]*e[n];return t}function Ox(s,e,t){let n;const a=s.shape.length;typeof e=="number"?n=[e,...new Array(a-1).fill(0)]:e.length<a?n=e.concat(new Array(a-e.length).fill(0)):n=e.slice(),n.forEach(i=>{V(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(a).fill(-1):typeof t=="number"?o=[t,...new Array(a-1).fill(-1)]:t.length<a?o=t.concat(new Array(a-t.length).fill(-1)):o=t,o=o.map((i,c)=>i>=0?i:(V(i===-1,()=>"Negative size values should be exactly -1 but got "+"".concat(i," for the slice() size at index ").concat(c,".")),s.shape[c]-n[c])),[n,o]}function Lv(s,e,t,n,a,o,i,c,u){let h;if(n==null?(h=new Array(e.length),h.fill(1)):h=n,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let p=!1;const f={dims:h.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:h.slice(),beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:c,shrinkAxisMask:u};for(let I=0;I<f.dims;I++)p&&(1<<I&c)!==0&&f.numAddAxisAfterEllipsis++,1<<I&i&&(p=!0);p||(f.ellipsisMask|=1<<f.dims,f.dims++);const g={dims:s.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};hU(f,g);let b=!0,y=!0,v=!0;const w=[],N=[];for(let I=0;I<s.length;++I){if(g.strides[I]===0)throw Error("strides[".concat(I,"] must be non-zero"));const T=!!(g.shrinkAxisMask&1<<I),$=s[I];if($===-1){w.push(T?1:-1);continue}const E=[g.beginMask&1<<I,g.endMask&1<<I],_=[g.strides[I]>0?0:-1,g.strides[I]>0?$:$-1];if(T&&g.strides[I]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&g.strides[I]===1;const L=!!(g.beginMask&1<<I&&g.endMask&1<<I);if(g.beginValid&&g.endValid){if(T){const U=g.begin[I]<0?$+g.begin[I]:g.begin[I];if(g.begin[I]=U,g.end[I]=g.begin[I]+1,U<0||U>=$)throw Error("slice index ".concat(g.begin[I]," of dimension ").concat(I," out of bounds."))}else g.begin[I]=Y4(g.begin[I],0,g.strides[I],$,E,_),g.end[I]=Y4(g.end[I],1,g.strides[I],$,E,_);const A=g.strides[I]===1&&g.begin[I]===0&&g.end[I]===$;b=b&&A,y=y&&(I===0&&g.strides[I]===1||A)}else b=b&&g.strides[I]===1&&L,y=y&&(I===0&&g.strides[I]===1||L);let O,z=!1;if(g.beginValid&&g.endValid?(O=g.end[I]-g.begin[I],z=!0):T?(O=1,z=!0):L&&$>=0&&(g.strides[I]<0?O=-$:O=$,z=!0),z){let A;O===0||O<0!=g.strides[I]<0?A=0:A=Math.trunc(O/g.strides[I])+(O%g.strides[I]!==0?1:0),w.push(A)}else w.push(-1)}for(let I=0;I<g.finalShapeGatherIndices.length;++I){const T=g.finalShapeGatherIndices[I];T>=0?N.push(w[T]):T===sy&&N.push(1)}return{finalShapeSparse:N.filter((I,T)=>g.finalShapeGatherIndices[T]!==sy),finalShape:N,isIdentity:b,sliceDim0:y,isSimpleSlice:v,begin:g.begin,end:g.end,strides:g.strides}}function hU(s,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=s.begin!=null,e.endValid=s.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let n=0;n<s.dims;n++)if(1<<n&s.ellipsisMask){const a=Math.min(e.dims-(s.dims-n)+1+s.numAddAxisAfterEllipsis,e.dims);for(;t<a;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n}else if(1<<n&s.newAxisMask)e.finalShapeGatherIndices.push(sy),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error("Index out of range using input dim ".concat(t,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));s.begin!=null&&(e.begin[t]=s.begin[n]),s.end!=null&&(e.end[t]=s.end[n]),e.strides[t]=s.strides[n],s.beginMask&1<<n&&(e.beginMask|=1<<t),s.endMask&1<<n&&(e.endMask|=1<<t),s.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(cU),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function Y4(s,e,t,n,a,o){if(a[e])return t>0?o[e]:o[e+1&1];{const i=s<0?n+s:s;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const pU=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Rv,computeFlatOffset:Fv,computeOutShape:_v,getNormalizedAxes:dU,isSliceContinous:Ov,maskToAxes:uU,parseSliceParams:Ox,sliceInfo:Lv,startForAxis:HT,startIndicesWithElidedDims:UT,stopForAxis:qT,stopIndicesWithElidedDims:GT,stridesForAxis:WT,stridesWithElidedDims:PT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fU{static sgd(e){return new $v(e)}static momentum(e,t,n=!1){return new DT(e,t,n)}static rmsprop(e,t=.9,n=0,a=null,o=!1){return new RT(e,t,n,a,o)}static adam(e=.001,t=.9,n=.999,a=null){return new AT(e,t,n,a)}static adadelta(e=.001,t=.95,n=null){return new IT(e,t,n)}static adamax(e=.002,t=.9,n=.999,a=null,o=0){return new ET(e,t,n,a,o)}static adagrad(e,t=.1){return new $T(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nu=fU;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mU=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:s=>s();function KT(){return new Promise(s=>mU(()=>s()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mv(s,e){const t=s[0].length;s.forEach((a,o)=>{V(a.length===t,()=>"Error in concat".concat(t,"D: rank of tensors[").concat(o,"] must be the same ")+"as the rank of the rest (".concat(t,")"))}),V(e>=0&&e<t,()=>"Error in concat".concat(t,"D: axis must be between 0 and ").concat(t-1,"."));const n=s[0];s.forEach((a,o)=>{for(let i=0;i<t;i++)V(i===e||a[i]===n[i],()=>"Error in concat".concat(t,"D: Shape of tensors[").concat(o,"] (").concat(a,") ")+"does not match the shape of the rest (".concat(n,") ")+"along the non-concatenated axis ".concat(o,"."))})}function Qr(s,e){const t=s[0].slice();for(let n=1;n<s.length;n++)t[e]+=s[n][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wr;(function(s){s[s.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",s[s.VALUE_ROWIDS=1]="VALUE_ROWIDS",s[s.ROW_LENGTHS=2]="ROW_LENGTHS",s[s.ROW_SPLITS=3]="ROW_SPLITS",s[s.ROW_LIMITS=4]="ROW_LIMITS",s[s.ROW_STARTS=5]="ROW_STARTS"})(wr||(wr={}));function XT(s,e,t){let n=new Array;if(t==null&&e==null)return n;if(e==null)for(;n.length<s+t.length;)n.push(-1);else n=e.slice();if(t==null)return n;if(s+t.length!==n.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(s+t.length,", but shape.rank = ").concat(n.length));for(let a=1;a<t.length;++a){const o=t[a],i=n[n.length-t.length+a],c=n[i];if(o>=0)if(c>=0){if(c!==o)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(a+s,"] = ").concat(o," but shape[").concat(a+s,"] = ").concat(c))}else n[i]=o}return n}function YT(s){const e={FIRST_DIM_SIZE:wr.FIRST_DIM_SIZE,VALUE_ROWIDS:wr.VALUE_ROWIDS,ROW_LENGTHS:wr.ROW_LENGTHS,ROW_SPLITS:wr.ROW_SPLITS,ROW_LIMITS:wr.ROW_LIMITS,ROW_STARTS:wr.ROW_STARTS},t=[];for(const n of s)if(n in e)t.push(e[n]);else break;return t}function ZT(s){return s.length===0?0:s[0]===wr.FIRST_DIM_SIZE?s.length-1:s.length}function QT(s,e){if(s==null||e==null)return;const t=s.length,n=e.length;if(t>=n)throw new Error("defaultValue.shape=".concat(s," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(t," must be less than ragged tensor input flatValues.rank = ").concat(n,")"));for(let a=0;a<Math.min(t,n-1);++a){const o=s[a],i=e[a+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error("defaultValue.shape=".concat(s,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(a-s.length,"] = ").concat(o," but ragged tensor input.flatValues.shape[").concat(a-s.length,"] = ").concat(i))}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zv=30;function Fx(s){return s<=zv?s:F1(s,Math.floor(Math.sqrt(s)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pv(s,e,t){const n=t*(typeof s=="number"?s:s[0]),a=e*(typeof s=="number"?s:s[1]);return[n,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(s,e,t,n=!0){let a=[];if(n)a=a.concat(e.slice(0)),a.push(s[0]/t),a=a.concat(s.slice(1));else{a=a.concat(s[0]);const o=e.length;for(let i=0;i<o;++i)a=a.concat([s[i+1]/e[i],e[i]]);a=a.concat(s.slice(o+1))}return a}function Dp(s,e,t=!0){const n=[];if(t){n.push(e);for(let a=e+1;a<s;++a)a<=2*e?(n.push(a),n.push(a-(e+1))):n.push(a)}else{const a=[],o=[];for(let i=1;i<s;++i)i>=e*2+1||i%2===1?o.push(i):a.push(i);n.push(...a),n.push(0),n.push(...o)}return n}function Rp(s,e,t,n=!0){const a=[];n?a.push(s[0]/t):a.push(s[0]*t);for(let o=1;o<s.length;++o)o<=e.length?n?a.push(e[o-1]*s[o]):a.push(s[o]/e[o-1]):a.push(s[o]);return a}function Bv(s,e){const t=[0];for(let n=0;n<e;++n)t.push(s[n][0]);return t}function Vv(s,e,t){const n=s.slice(0,1);for(let a=0;a<t;++a)n.push(s[a+1]-e[a][0]-e[a][1]);return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lx=1.7580993408473768,Mx=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uv=.3275911,Gv=.254829592,Wv=-.284496736,Hv=1.421413741,qv=-1.453152027,Kv=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(s,e){if(s.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(s.length,", imag: ").concat(e.length,"."));const t=new Float32Array(s.length*2);for(let n=0;n<t.length;n+=2)t[n]=s[n/2],t[n+1]=e[n/2];return t}function JT(s){const e=new Float32Array(s.length/2),t=new Float32Array(s.length/2);for(let n=0;n<s.length;n+=2)e[n/2]=s[n],t[n/2]=s[n+1];return{real:e,imag:t}}function eI(s){const e=Math.ceil(s.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let a=0;a<s.length;a+=4)t[Math.floor(a/4)]=s[a],n[Math.floor(a/4)]=s[a+1];return{real:t,imag:n}}function tI(s){const e=Math.floor(s.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let a=2;a<s.length;a+=4)t[Math.floor(a/4)]=s[a],n[Math.floor(a/4)]=s[a+1];return{real:t,imag:n}}function Xv(s,e){const t=s[e*2],n=s[e*2+1];return{real:t,imag:n}}function sI(s,e,t,n){s[n*2]=e,s[n*2+1]=t}function nI(s,e){const t=new Float32Array(s/2),n=new Float32Array(s/2);for(let a=0;a<Math.ceil(s/2);a++){const o=(e?2:-2)*Math.PI*(a/s);t[a]=Math.cos(o),n[a]=Math.sin(o)}return{real:t,imag:n}}function aI(s,e,t){const n=(t?2:-2)*Math.PI*(s/e),a=Math.cos(n),o=Math.sin(n);return{real:a,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1="->",gU=/->/g,Z4=",",Q4="...";function Yv(s,e){s=s.replace(/\s/g,"");const t=(s.length-s.replace(gU,"").length)/m1.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error('Equation must contain exactly one arrow ("'.concat(m1,'").'));const[n,a]=s.split(m1);V(n.indexOf(Q4)===-1,()=>'The ellipsis notation ("'.concat(Q4,'") is not supported yet.'));const o=n.split(Z4),i=o.length;if(e!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(e));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const c=[];for(let g=0;g<a.length;++g){const b=a[g];if(!o.some(y=>y.indexOf(b)!==-1))throw new Error("Output subscripts contain the label ".concat(b," ")+"not present in the input subscripts.");c.indexOf(b)===-1&&c.push(b)}for(let g=0;g<n.length;++g){const b=n[g];c.indexOf(b)===-1&&b!==Z4&&c.push(b)}const u=new Array(o.length);for(let g=0;g<i;++g){if(new Set(o[g].split("")).size!==o[g].length)throw new Error("Found duplicate axes in input component ".concat(o[g],". ")+"Support for duplicate axes in input is not implemented yet.");u[g]=[];for(let b=0;b<o[g].length;++b)u[g].push(c.indexOf(o[g][b]))}const h=c.length,p=a.length,f=[];for(let g=p;g<h;++g)f.push(g);return{allDims:c,summedDims:f,idDims:u}}function Zv(s,e){let t=new Array(s);t.fill(-1);for(let a=0;a<e.length;++a)t[e[a]]=a;const n=[];for(let a=0;a<s;++a)t[a]===-1&&n.push(a);return t=t.filter(a=>a!==-1),{permutationIndices:t,expandDims:n}}function Qv(s,e,t){const n=new Array(s);for(let a=0;a<t.length;++a){const o=t[a].shape;for(let i=0;i<e[a].length;++i)n[e[a][i]]===void 0?n[e[a][i]]=o[i]:V(n[e[a][i]]===o[i],()=>"Expected dimension ".concat(n[e[a][i]]," at axis ").concat(i," ")+"of input shaped ".concat(JSON.stringify(o),", ")+"but got dimension ".concat(o[i]))}}function Jv(s,e){const t=s,n=[];let a=0;s.length===0&&t.push(-1),a=s.length+1;for(let i=0;i<a;++i)n.push([]);const o=[];for(let i=0;i<t.length;++i){const c=t[i],u=xU(e,c);for(const h of u)o.indexOf(h)===-1&&(n[i].push(h),o.push(h))}return{path:t,steps:n}}function ew(s){return s.every((e,t)=>e===t)}function xU(s,e){const t=[];for(let n=0;n<s.length;++n)(s[n].length===0||s[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function tw(s,e,t=0){let n=[];if(typeof e=="number")V(s.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),n=new Array(e).fill(s.shape[t]/e);else{const a=e.reduce((i,c)=>(c===-1&&(i+=1),i),0);V(a<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((c,u)=>u>0?c+u:c);e[o]=s.shape[t]-i}V(s.shape[t]===e.reduce((i,c)=>i+c),()=>"The sum of sizes must match the size of the axis dimension."),n=e}return n}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(s){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s)}function oI(s,e){return"indices(".concat(s,", 0) is invalid: ").concat(e," < 0")}function iI(s,e,t){return"indices(".concat(s,", 0) is invalid: ").concat(e," >= ").concat(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lI(s,e){return"only one output dimension may be -1, not both ".concat(s," and ").concat(e)}function cI(s,e){return"size ".concat(s," must be non-negative, not ").concat(e)}function uI(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function dI(s,e){const t=Ae(s),n=Ae(e);return"Input to reshape is a SparseTensor with ".concat(t,"\n  dense values, but the requested shape requires a multiple of ").concat(n,". inputShape=").concat(s," outputShape= ").concat(e)}function hI(s,e){const t=Ae(s),n=Ae(e);return"Input to reshape is a tensor with ".concat(t," dense values, but the requested shape has ").concat(n,". inputShape=").concat(s," outputShape=").concat(e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(){return"segment ids must be >= 0"}function pI(){return"segment ids are not increasing"}function fI(s,e){return"Segment id ".concat(s," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function mI(s,e,t){return"Bad: indices[".concat(s,"] == ").concat(e," out of range [0, ").concat(t,")")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gI(s,e){let t=!1,n;for(s<=zv?(n=s,t=!0):n=F1(s,Math.floor(Math.sqrt(s)));!t;)n>e||n===s?t=!0:n=F1(s,n+1);return n}function xI(s,e,t){const n=[],a=s.length;for(let o=0;o<a;o++)o!==e?n.push(s[o]):n.push(t);return n}function sw(s,e,t,n){const a=e.shape.length,o=s.shape.length;if(n!==0&&(n<-a||n>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(n));if(n<0&&(n+=a),n>o)throw new Error("batchDims (".concat(n,") must be less than rank(x) (\n    ").concat(o,")."));if(t<n)throw new Error("batchDims (".concat(n,") must be less than or equal to axis (").concat(t,")."));for(let f=0;f<n;++f)if(s.shape[f]!==e.shape[f])throw new Error("x.shape[".concat(f,"]: ").concat(s.shape[f]," should be equal to indices.shape[").concat(f,"]: ").concat(e.shape[f],"."));const i=s.shape[t],c=[];let u=1,h=1,p=1;for(let f=0;f<n;++f)c.push(s.shape[f]),u*=s.shape[f];for(let f=n;f<t;f++)c.push(s.shape[f]),h*=s.shape[f];for(let f=n;f<a;f++)c.push(e.shape[f]);for(let f=t+1;f<o;f++)c.push(s.shape[f]),p*=s.shape[f];return{batchSize:u,sliceSize:p,outerSize:h,dimSize:i,outputShape:c}}const bU=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:sw,computeOutShape:xI,segOpComputeOptimalWindowSize:gI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(s){try{return s.map(e=>Ri(e))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(e))}}function bI(s){return s.map(e=>Ai(e))}const yU=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Gv,ERF_A2:Wv,ERF_A3:Hv,ERF_A4:qv,ERF_A5:Kv,ERF_P:Uv,PARALLELIZE_THRESHOLD:zv,get RowPartitionType(){return wr},SELU_SCALE:Mx,SELU_SCALEALPHA:Lx,applyActivation:Rx,assertAndGetBroadcastShape:kt,assertAxesAreInnerMostDims:Sn,assertParamsConsistent:Mv,assignToTypedArray:sI,axesAreInnerMostDims:tv,calculateShapes:nc,checkEinsumDimSizes:Qv,checkPadOnDimRoundingMode:Gn,combineLocations:qj,combineRaggedTensorToTensorShapes:XT,complexWithEvenIndex:eI,complexWithOddIndex:tI,computeConv2DInfo:hn,computeConv3DInfo:Ki,computeDefaultPad:K2,computeDilation2DInfo:Cp,computeOptimalWindowSize:Fx,computeOutAndReduceShapes:pn,computeOutShape:Qr,computePool2DInfo:dr,computePool3DInfo:Uo,convertConv2DDataFormat:Go,decodeEinsumEquation:Yv,eitherStridesOrDilationsAreOne:Nn,expandShapeToKeepDim:Rs,exponent:aI,exponents:nI,fromStringArrayToUint8:bI,fromUint8ToStringArray:Mo,getAxesPermutation:ws,getBroadcastDims:vu,getComplexWithIndex:Xv,getEinsumComputePath:Jv,getEinsumPermutation:Zv,getFusedBiasGradient:Dx,getFusedDyActivation:Ex,getImageCenter:Pv,getInnerMostAxes:_s,getPermuted:Dp,getRaggedRank:ZT,getReductionAxes:en,getReshaped:Ep,getReshapedPermuted:Rp,getRowPartitionTypesHelper:YT,getSliceBeginCoords:Bv,getSliceSize:Vv,getSparseFillEmptyRowsIndicesDenseShapeMismatch:rI,getSparseFillEmptyRowsNegativeIndexErrorMessage:oI,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:iI,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:uI,getSparseReshapeInputOutputMismatchErrorMessage:hI,getSparseReshapeInputOutputMultipleErrorMessage:dI,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:lI,getSparseReshapeNegativeOutputDimErrorMessage:cI,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:mI,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:ny,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:pI,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:fI,getUndoAxesPermutation:Xi,isIdentityPermutation:ew,log:n7,mergeRealAndImagArrays:Lo,prepareAndValidate:Dv,prepareSplitSize:tw,segment_util:bU,shouldFuse:_x,slice_util:pU,splitRealAndImagArrays:JT,stridesOrDilationsArePositive:Wl,tupleValuesAreOne:Fi,upcastType:ya,validateDefaultValueShape:QT,validateInput:yv,validateUpdateShape:pT,warn:Da},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */BV();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vU=Se();vU.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,s=>{s&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var fa;(function(s){s[s.DT_INVALID=0]="DT_INVALID",s[s.DT_FLOAT=1]="DT_FLOAT",s[s.DT_DOUBLE=2]="DT_DOUBLE",s[s.DT_INT32=3]="DT_INT32",s[s.DT_UINT8=4]="DT_UINT8",s[s.DT_INT16=5]="DT_INT16",s[s.DT_INT8=6]="DT_INT8",s[s.DT_STRING=7]="DT_STRING",s[s.DT_COMPLEX64=8]="DT_COMPLEX64",s[s.DT_INT64=9]="DT_INT64",s[s.DT_BOOL=10]="DT_BOOL",s[s.DT_QINT8=11]="DT_QINT8",s[s.DT_QUINT8=12]="DT_QUINT8",s[s.DT_QINT32=13]="DT_QINT32",s[s.DT_BFLOAT16=14]="DT_BFLOAT16",s[s.DT_QINT16=15]="DT_QINT16",s[s.DT_QUINT16=16]="DT_QUINT16",s[s.DT_UINT16=17]="DT_UINT16",s[s.DT_COMPLEX128=18]="DT_COMPLEX128",s[s.DT_HALF=19]="DT_HALF",s[s.DT_RESOURCE=20]="DT_RESOURCE",s[s.DT_VARIANT=21]="DT_VARIANT",s[s.DT_UINT32=22]="DT_UINT32",s[s.DT_UINT64=23]="DT_UINT64",s[s.DT_FLOAT_REF=101]="DT_FLOAT_REF",s[s.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",s[s.DT_INT32_REF=103]="DT_INT32_REF",s[s.DT_UINT8_REF=104]="DT_UINT8_REF",s[s.DT_INT16_REF=105]="DT_INT16_REF",s[s.DT_INT8_REF=106]="DT_INT8_REF",s[s.DT_STRING_REF=107]="DT_STRING_REF",s[s.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",s[s.DT_INT64_REF=109]="DT_INT64_REF",s[s.DT_BOOL_REF=110]="DT_BOOL_REF",s[s.DT_QINT8_REF=111]="DT_QINT8_REF",s[s.DT_QUINT8_REF=112]="DT_QUINT8_REF",s[s.DT_QINT32_REF=113]="DT_QINT32_REF",s[s.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",s[s.DT_QINT16_REF=115]="DT_QINT16_REF",s[s.DT_QUINT16_REF=116]="DT_QUINT16_REF",s[s.DT_UINT16_REF=117]="DT_UINT16_REF",s[s.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",s[s.DT_HALF_REF=119]="DT_HALF_REF",s[s.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",s[s.DT_VARIANT_REF=121]="DT_VARIANT_REF",s[s.DT_UINT32_REF=122]="DT_UINT32_REF",s[s.DT_UINT64_REF=123]="DT_UINT64_REF"})(fa||(fa={}));var J4;(function(s){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(s.CheckpointFormatVersion||(s.CheckpointFormatVersion={}))})(J4||(J4={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wU={};function yI(s){return wU[s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D(s,e,t,n,a){const o=e.inputParams[s];if(o&&o.inputIndexStart!==void 0){const c=o.inputIndexStart,u=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?c+1:o.inputIndexEnd,h=c<0?e.inputNames.length+c:c;if(o.type==="tensor")return bn(e.inputNames[h],t,n,a);if(o.type==="tensors"){const g=e.inputs.slice(c,u);return e.inputNames.slice(c,u).filter((y,v)=>{var w;return((w=g[v])===null||w===void 0?void 0:w.op)!=="NoOp"}).map(y=>bn(y,t,n,a))}const p=bn(e.inputNames[h],t,n,a),f=p.dataSync();return o.type==="number"?f[0]:or(p.shape,f)}const i=e.attrParams[s];return i&&i.value}function bn(s,e,t,n){const[a,o]=ma(s,t);if(n!=null){const c=n.getHashTableHandleByName(a);if(c!=null)return c}const i=t.currentContextIds.find(c=>!!e[zm(a,c)]);return i!==void 0?e[zm(a,i)][o]:void 0}function eC(s,e,t){return e[zm(s,t.currentContextId)]}function Io(s,e){const[t,n,a]=ma(s,e);return[zm(t,e&&e.currentContextId),n,a]}function zm(s,e){return e?"".concat(s,"-").concat(e):s}function ma(s,e){if(s==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const o=e.parseNodeNameCache.get(s);if(o!=null)return o}const n=s.split(":");let a;if(n.length===1)a=[s,0,void 0];else{const o=n[0],i=n.length===3?n[1]:void 0,c=Number(n[n.length-1]);a=[o,c,i]}return t&&e.parseNodeNameCache.set(s,a),a}function Im(s,e,t){let n=D("pad",s,e,t);if(n==="explicit"){n=D("explicitPaddings",s,e,t);const a=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)a[o][0]=n[o*2],a[o][1]=n[o*2+1];return a}return n}function $o(s){return s.kept?s:Ro(s)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],SU=Object.freeze(Object.defineProperty({__proto__:null,json:NU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CU=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kU=Object.freeze(Object.defineProperty({__proto__:null,json:CU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jU=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],TU=Object.freeze(Object.defineProperty({__proto__:null,json:jU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IU=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],$U=Object.freeze(Object.defineProperty({__proto__:null,json:IU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AU=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],EU=Object.freeze(Object.defineProperty({__proto__:null,json:AU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DU=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RU=Object.freeze(Object.defineProperty({__proto__:null,json:DU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _U=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],OU=Object.freeze(Object.defineProperty({__proto__:null,json:_U},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FU=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],LU=Object.freeze(Object.defineProperty({__proto__:null,json:FU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MU=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],zU=Object.freeze(Object.defineProperty({__proto__:null,json:MU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PU=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],BU=Object.freeze(Object.defineProperty({__proto__:null,json:PU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VU=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],UU=Object.freeze(Object.defineProperty({__proto__:null,json:VU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GU=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],WU=Object.freeze(Object.defineProperty({__proto__:null,json:GU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],qU=Object.freeze(Object.defineProperty({__proto__:null,json:HU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],XU=Object.freeze(Object.defineProperty({__proto__:null,json:KU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],ZU=Object.freeze(Object.defineProperty({__proto__:null,json:YU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],JU=Object.freeze(Object.defineProperty({__proto__:null,json:QU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eG=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],tG=Object.freeze(Object.defineProperty({__proto__:null,json:eG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sG=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],nG=Object.freeze(Object.defineProperty({__proto__:null,json:sG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aG=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],rG=Object.freeze(Object.defineProperty({__proto__:null,json:aG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tC{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[SU,kU,TU,$U,EU,RU,OU,LU,zU,BU,UU,WU,qU,XU,ZU,JU,tG,nG,rG],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,a)=>(n[a.tfOpName]=a,n),{})}transformGraph(e,t={}){const n=e.node,a=[],o=[],i=[],c=n.reduce((v,w)=>(v[w.name]=this.mapNode(w),w.op.startsWith("Placeholder")?a.push(v[w.name]):w.op==="Const"?o.push(v[w.name]):(w.input==null||w.input.length===0)&&i.push(v[w.name]),v),{});let u=[];const h=[];let p={},f={};t!=null&&(p=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const g=Object.keys(c);g.forEach(v=>{const w=c[v];w.inputNames.forEach((N,C)=>{const[I,,T]=Io(N),$=c[I];if($.outputs!=null){const E=$.outputs.indexOf(T);if(E!==-1){const _="".concat(I,":").concat(E);w.inputNames[C]=_}}w.inputs.push($),$.children.push(w)})}),Object.keys(f).length===0?g.forEach(v=>{const w=c[v];w.children.length===0&&h.push(w)}):Object.keys(f).forEach(v=>{const[w]=Io(v),N=c[w];N!=null&&(N.signatureKey=f[v],h.push(N))}),Object.keys(p).length>0?Object.keys(p).forEach(v=>{const[w]=Io(v),N=c[w];N&&(N.signatureKey=p[v],u.push(N))}):u=a;let b={};e.library!=null&&e.library.function!=null&&(b=e.library.function.reduce((v,w)=>(v[w.signature.name]=this.mapFunction(w),v),{}));const y={nodes:c,inputs:u,outputs:h,weights:o,placeholders:a,signature:t,functions:b};return i.length>0&&(y.initNodes=i),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=yI(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((a,o)=>(a[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},a),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((a,o)=>{const i=o.type;let c;switch(o.type){case"string":c=ay(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=ay(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":c=dy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=dy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":c=oy(e.attr,o.tfName,o.defaultValue||0),c===void 0&&o.tfDeprecatedName&&(c=oy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":c=uy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=uy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":c=ry(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=ry(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":c=py(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=py(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":c=cy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=cy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":c=hy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=hy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":c=iy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=iy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":c=ly(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=ly(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":c=sC(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=sC(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(o.type," for op: ").concat(e.op))}return a[o.name]={value:c,type:i},a},{})),n}mapFunction(e){const t=e.nodeDef,n=[],a=[];let o={};t!=null&&(o=t.reduce((f,g)=>(f[g.name]=this.mapNode(g),g.op==="Const"&&a.push(f[g.name]),f),{}));const i=[],c=[];e.signature.inputArg.forEach(f=>{const[g]=Io(f.name),b={name:g,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:nw(f.type),type:"dtype"}},children:[]};b.signatureKey=f.name,i.push(b),o[g]=b}),Object.keys(o).forEach(f=>{const g=o[f];g.inputNames.forEach((b,y)=>{const[v,,w]=Io(b),N=o[v];if(N.outputs!=null){const C=N.outputs.indexOf(w);if(C!==-1){const I="".concat(v,":").concat(C);g.inputNames[y]=I}}g.inputs.push(N),N.children.push(g)})});const h=e.ret;e.signature.outputArg.forEach(f=>{const[g,b]=Io(h[f.name]),y=o[g];y!=null&&(y.defaultOutput=b,c.push(y))});const p=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:c,weights:a,placeholders:n,signature:p}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}}function oG(s){const e=Se().global;if(typeof e.atob<"u")return e.atob(s);if(typeof Buffer<"u")return new Buffer(s,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function vI(s,e){const t=Array.isArray(s)?String.fromCharCode.apply(null,s):oG(s);return e?t:t.toLowerCase()}function ay(s,e,t,n=!1){const a=s[e];return a!=null?vI(a.s,n):t}function ry(s,e,t){const n=s[e];return n?n.b:t}function oy(s,e,t){const n=s[e]||{},a=n.i!=null?n.i:n.f!=null?n.f:t;return typeof a=="number"?a:parseInt(a,10)}function nw(s){switch(typeof s=="string"&&(s=fa[s]),s){case fa.DT_FLOAT:case fa.DT_HALF:return"float32";case fa.DT_INT32:case fa.DT_INT64:case fa.DT_INT8:case fa.DT_UINT8:return"int32";case fa.DT_BOOL:return"bool";case fa.DT_DOUBLE:return"float32";case fa.DT_STRING:return"string";case fa.DT_COMPLEX64:case fa.DT_COMPLEX128:return"complex64";default:return null}}function sC(s,e,t){const n=s[e];return n&&n.func?n.func.name:t}function iy(s,e,t){const n=s[e];return n&&n.type?nw(n.type):t}function ly(s,e,t){const n=s[e];return n&&n.list&&n.list.type?n.list.type.map(a=>nw(a)):t}function wI(s){if(!s.unknownRank)return s.dim!=null?s.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function cy(s,e,t){const n=s[e];return n&&n.shape?wI(n.shape):t}function uy(s,e,t){const n=s[e];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):t}function dy(s,e,t,n=!1){const a=s[e];return a&&a.list&&a.list.s?a.list.s.map(o=>vI(o,n)):t}function hy(s,e,t){const n=s[e];return n&&n.list&&n.list.shape?n.list.shape.map(a=>wI(a)):t}function py(s,e,t){const n=s[e];return n&&n.list&&n.list.b?n.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iG{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,o)=>(a[o]=this.getAttr(o),a),{}))}getInput(e){return bn(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(n.tensor!=null)return bn(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return oy(this.node.rawAttrs,e,t);if(n.s!=null)return ay(this.node.rawAttrs,e,t);if(n.b!=null)return ry(this.node.rawAttrs,e,t);if(n.shape!=null)return cy(this.node.rawAttrs,e,t);if(n.type!=null)return iy(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return uy(this.node.rawAttrs,e,t);if(n.list.s!=null)return dy(this.node.rawAttrs,e,t);if(n.list.shape!=null)return hy(this.node.rawAttrs,e,t);if(n.list.b!=null)return py(this.node.rawAttrs,e,t);if(n.list.type!=null)return ly(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:aj,abs:qs,acos:Nj,acosh:Sj,add:Fe,addN:vL,all:q2,any:Lm,argMax:yu,argMin:Cj,asin:kj,asinh:jj,atan:Tj,atan2:Ij,atanh:$j,avgPool:px,avgPool3d:Aj,basicLSTMCell:UL,batchNorm:kp,batchNorm2d:Ej,batchNorm3d:Dj,batchNorm4d:Rj,batchToSpaceND:fx,bincount:_j,bitwiseAnd:QL,booleanMaskAsync:FB,broadcastArgs:eM,broadcastTo:fu,buffer:$t,cast:qe,ceil:Oj,clipByValue:sa,clone:Ro,complex:_i,concat:Ts,concat1d:Fj,concat2d:Lj,concat3d:Mj,concat4d:zj,conv1d:X2,conv2d:Li,conv2dTranspose:Z2,conv3d:Pj,conv3dTranspose:Vj,cos:mx,cosh:Q2,cosineWindow:Sv,cumprod:Mm,cumsum:J2,denseBincount:J1,depthToSpace:Uj,depthwiseConv2d:jp,diag:SM,dilation2d:Gj,div:Ze,divNoNan:Wj,dot:Hj,dropout:bT,einsum:cu,elu:Tp,enclosingPowerOfTwo:yT,ensureShape:RM,equal:jr,erf:ev,euclideanNorm:Xj,exp:Bn,expandDims:xn,expm1:Yj,eye:sv,fft:$x,fill:_u,floor:$p,floorDiv:H2,fused:a9,gather:Ap,gatherND:HB,greater:Ca,greaterEqual:Yi,ifft:xh,imag:gx,image:Ra,inTopKAsync:YB,irfft:xv,isFinite:Zj,isInf:Qj,isNaN:Jj,leakyRelu:xx,less:fh,lessEqual:tc,linalg:TT,linspace:rz,localResponseNormalization:eT,log:Oa,log1p:bx,logSigmoid:tT,logSoftmax:nv,logSumExp:yx,logicalAnd:to,logicalNot:vx,logicalOr:av,logicalXor:sT,losses:OV,lowerBound:wz,matMul:_t,max:ir,maxPool:wx,maxPool3d:nT,maxPoolWithArgmax:kz,maximum:Wo,mean:js,meshgrid:Iz,min:ph,minimum:ql,mirrorPad:aT,mod:rT,moments:Nx,movingAverage:zB,mul:ne,multiRNNCell:_z,multinomial:Fz,neg:fs,norm:Ip,notEqual:wu,oneHot:ov,ones:xa,onesLike:Fa,op:te,outerProduct:Bz,pad:Zi,pad1d:Gz,pad2d:Hz,pad3d:Kz,pad4d:Yz,pool:oT,pow:Oo,prelu:Cx,print:wj,prod:iT,raggedGather:aP,raggedRange:oP,raggedTensorToTensor:lP,rand:uP,randomGamma:DP,randomNormal:lv,randomStandardNormal:OP,randomUniform:sc,randomUniformInt:MP,range:Nu,real:mh,reciprocal:lT,relu:ro,relu6:cv,reshape:le,reverse:cr,reverse1d:WP,reverse2d:qP,reverse3d:XP,reverse4d:ZP,rfft:Ax,round:uv,rsqrt:dv,scalar:ht,scatterND:BB,searchSorted:rv,selu:hv,separableConv2d:pv,setdiff1dAsync:nB,sigmoid:Cr,sign:cT,signal:_V,sin:fv,sinh:mv,slice:xt,slice1d:jx,slice2d:gv,slice3d:Tx,slice4d:gh,softmax:Ix,softplus:Ou,spaceToBatchND:Sx,sparse:FV,sparseToDense:GB,spectral:RV,split:ba,sqrt:wn,square:is,squaredDifference:bv,squeeze:Es,stack:va,step:Fu,stridedSlice:uT,string:LV,sub:et,sum:at,tan:dT,tanh:Hl,tensor:Sr,tensor1d:Bs,tensor2d:Ol,tensor3d:hT,tensor4d:SB,tensor5d:CB,tensor6d:kB,tensorScatterUpdate:TB,tile:nr,topk:fT,transpose:Pt,truncatedNormal:vv,unique:mT,unsortedSegmentSum:wv,unstack:ur,upperBound:RB,variable:gT,where:$n,whereAsync:xT,zeros:Ks,zerosLike:Bt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lG=(s,e,t,n=Cn)=>{switch(s.op){case"BiasAdd":case"AddV2":case"Add":return[n.add(D("a",s,e,t),D("b",s,e,t))];case"AddN":return[n.addN(D("tensors",s,e,t))];case"FloorMod":case"Mod":return[n.mod(D("a",s,e,t),D("b",s,e,t))];case"Mul":return[n.mul(D("a",s,e,t),D("b",s,e,t))];case"RealDiv":case"Div":return[n.div(D("a",s,e,t),D("b",s,e,t))];case"DivNoNan":return[n.divNoNan(D("a",s,e,t),D("b",s,e,t))];case"FloorDiv":return[n.floorDiv(D("a",s,e,t),D("b",s,e,t))];case"Sub":return[n.sub(D("a",s,e,t),D("b",s,e,t))];case"Minimum":return[n.minimum(D("a",s,e,t),D("b",s,e,t))];case"Maximum":return[n.maximum(D("a",s,e,t),D("b",s,e,t))];case"Pow":return[n.pow(D("a",s,e,t),D("b",s,e,t))];case"SquaredDifference":return[n.squaredDifference(D("a",s,e,t),D("b",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cG=(s,e,t,n=Cn)=>{switch(s.op){case"Abs":case"ComplexAbs":return[n.abs(D("x",s,e,t))];case"Acos":return[n.acos(D("x",s,e,t))];case"Acosh":return[n.acosh(D("x",s,e,t))];case"Asin":return[n.asin(D("x",s,e,t))];case"Asinh":return[n.asinh(D("x",s,e,t))];case"Atan":return[n.atan(D("x",s,e,t))];case"Atan2":return[n.atan2(D("x",s,e,t),D("y",s,e,t))];case"Atanh":return[n.atanh(D("x",s,e,t))];case"Ceil":return[n.ceil(D("x",s,e,t))];case"Complex":return[n.complex(D("real",s,e,t),D("imag",s,e,t))];case"Cos":return[n.cos(D("x",s,e,t))];case"Cosh":return[n.cosh(D("x",s,e,t))];case"Elu":return[n.elu(D("x",s,e,t))];case"Erf":return[n.erf(D("x",s,e,t))];case"Exp":return[n.exp(D("x",s,e,t))];case"Expm1":return[n.expm1(D("x",s,e,t))];case"Floor":return[n.floor(D("x",s,e,t))];case"Log":return[n.log(D("x",s,e,t))];case"Log1p":return[n.log1p(D("x",s,e,t))];case"Imag":return[n.imag(D("x",s,e,t))];case"Neg":return[n.neg(D("x",s,e,t))];case"Reciprocal":return[n.reciprocal(D("x",s,e,t))];case"Real":return[n.real(D("x",s,e,t))];case"Relu":return[n.relu(D("x",s,e,t))];case"Round":return[n.round(D("x",s,e,t))];case"Selu":return[n.selu(D("x",s,e,t))];case"Sigmoid":return[n.sigmoid(D("x",s,e,t))];case"Sin":return[n.sin(D("x",s,e,t))];case"Sign":return[n.sign(D("x",s,e,t))];case"Sinh":return[n.sinh(D("x",s,e,t))];case"Softplus":return[n.softplus(D("x",s,e,t))];case"Sqrt":return[n.sqrt(D("x",s,e,t))];case"Square":return[n.square(D("x",s,e,t))];case"Tanh":return[n.tanh(D("x",s,e,t))];case"Tan":return[n.tan(D("x",s,e,t))];case"ClipByValue":return[n.clipByValue(D("x",s,e,t),D("clipValueMin",s,e,t),D("clipValueMax",s,e,t))];case"Relu6":return[n.relu6(D("x",s,e,t))];case"Rsqrt":return[n.rsqrt(bn(s.inputNames[0],e,t))];case"LeakyRelu":return[n.leakyRelu(D("x",s,e,t),D("alpha",s,e,t))];case"Prelu":return[n.prelu(D("x",s,e,t),D("alpha",s,e,t))];case"IsNan":return[n.isNaN(bn(s.inputNames[0],e,t))];case"IsInf":return[n.isInf(bn(s.inputNames[0],e,t))];case"IsFinite":return[n.isFinite(bn(s.inputNames[0],e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tr(s,e,t=""){if(!(typeof s=="number"||typeof e=="number")){V(s.length===e.length,()=>t+" Shapes ".concat(s," and ").concat(e," must match"));for(let n=0;n<s.length;n++){const a=s[n],o=e[n];V(a<0||o<0||a===o,()=>t+" Shapes ".concat(s," and ").concat(e," must match"))}}}function nC(s){return!(typeof s=="number"||s.some(e=>e<0))}function th(s,e,t){let n=fy(s,t);const a=!nC(n);if(a&&e.length===0)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(n));if(a&&e.forEach(o=>{n=fy(o.shape,n)}),!nC(n))throw new Error("Non-fully-defined elementShape: ".concat(n));return n}function fy(s,e){if(typeof s=="number")return e;if(typeof e=="number")return s;if(s.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(s," vs. ").concat(e));const t=[];for(let n=0;n<s.length;++n){const a=s[n],o=e[n];if(a>=0&&o>=0&&a!==o)throw new Error("Incompatible shape during merge: ".concat(s," vs. ").concat(e));t[n]=a>=0?a:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uG{constructor(e,t,n,a,o,i,c){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=c,this.tensors=[],this.closed_=!1,this.idTensor=ht(0),un(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));const t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),tr(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,un(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((n,a)=>this.write(n,t[a]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return Sr([],[0].concat(this.elementShape));const n=this.readMany(e);return tr(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),va(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(this.size()===0)return Sr([],[0].concat(this.elementShape));const t=[];for(let a=0;a<this.size();a++)t.push(a);const n=this.readMany(t);return tr(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),Ts(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,ur(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0;const a=e.map(u=>(n+=u,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const o=n===0?0:t.size/n,i=[];me(()=>{t=le(t,[1,n,o]);for(let u=0;u<e.length;++u){const p=[0,u===0?0:a[u-1],0],f=[1,e[u],o];i[u]=le(xt(t,p,f),this.elementShape)}return i});const c=[];for(let u=0;u<e.length;u++)c[u]=u;this.writeMany(c,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xl{get id(){return this.idTensor.id}constructor(e,t,n,a=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(o=>{if(n!==o.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(o.dtype));tr(t,o.shape,"TensorList shape mismatch: "),un(o)}),this.idTensor=ht(0),this.maxNumElements=a,un(this.idTensor)}copy(){return new Xl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(n!==-1&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));tr(e,this.elementShape,"TensorList shape mismatch: ");const a=th(this.elementShape,this.tensors,e);return me(()=>{const o=this.tensors.map(i=>le(i,a));return va(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(this.size()===0)throw new Error("Trying to pop from an empty list.");const n=th(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,tr(a.shape,e,"TensorList shape mismatch: "),le(a,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(tr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");un(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));const t=new Xl([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(this.tensors[e]==null)throw new Error("element at index ".concat(e," is null."));tr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const a=th(this.elementShape,this.tensors,t);return le(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));tr(this.elementShape,t.shape,"TensorList shape mismatch: "),un(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));tr(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=th(this.elementShape,this.tensors,n);return e.length===0?Sr([],[0].concat(a)):me(()=>{const o=e.map(i=>le(this.tensors[i],a));return va(o,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));tr(this.elementShape,t,"TensorList shape mismatch: ");const n=th(this.elementShape,this.tensors,t);return this.size()===0?Sr([],[0].concat(n)):me(()=>{const a=this.tensors.map(o=>le(o,n));return Ts(a,0)})}}function dG(s,e,t){const n=s.dtype;if(s.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(s.shape));if(s.dtype!==t)throw new Error("Invalid data types; op elements ".concat(s.dtype,", but list elements ").concat(t));const a=s.shape.slice(1);tr(a,e,"TensorList shape mismatch: ");const o=ur(s);return new Xl(o,e,n)}function hG(s,e,t,n){return new Xl([],s,e,n)}function pG(s,e,t,n){if(e.length!==s.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(s.shape[0]));const a=Math.max(...e);if(n!=null&&n!==-1&&a>=n)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(n,")"));const o=new Xl([],t,s.dtype,n),i=ur(s,0);return e.forEach((c,u)=>{o.setItem(c,i[u])}),o}function fG(s,e,t){let n=0;const a=e.map(p=>(n+=p,n));if(n!==s.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(s.shape));const o=s.shape.slice(1),i=fy(o,t),c=n===0?0:s.size/n,u=me(()=>{const p=[];s=le(s,[1,n,c]);for(let f=0;f<e.length;++f){const b=[0,f===0?0:a[f-1],0],y=[1,e[f],c];p[f]=le(xt(s,b,y),i)}return s.dispose(),p}),h=new Xl([],t,s.dtype,e.length);for(let p=0;p<u.length;p++)h.setItem(p,u[p]);return h}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG=async(s,e,t)=>{switch(s.op){case"If":case"StatelessIf":{const n=D("thenBranch",s,e,t),a=D("elseBranch",s,e,t),o=D("cond",s,e,t),i=D("args",s,e,t);return(await o.data())[0]?t.functionMap[n].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[a].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const n=D("body",s,e,t),a=D("cond",s,e,t),o=D("args",s,e,t),i=await t.functionMap[a].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),c=o.map(p=>p.id);let u=await i[0].data();i.forEach(p=>{!p.kept&&c.indexOf(p.id)===-1&&p.dispose()});let h=o;for(;u[0];){const p=h;h=await t.functionMap[n].executeFunctionAsync(h,t.tensorArrayMap,t.tensorListMap);const f=h.map(b=>b.id);p.forEach(b=>{!b.kept&&c.indexOf(b.id)===-1&&f.indexOf(b.id)===-1&&b.dispose()});const g=await t.functionMap[a].executeFunctionAsync(h,t.tensorArrayMap,t.tensorListMap);u=await g[0].data(),g.forEach(b=>{!b.kept&&c.indexOf(b.id)===-1&&f.indexOf(b.id)===-1&&b.dispose()})}return h}case"LoopCond":{const n=D("pred",s,e,t);return[$o(n)]}case"Switch":{const n=D("pred",s,e,t);let a=D("data",s,e,t);return a.kept||(a=$o(a)),(await n.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const n=s.inputNames.find(a=>bn(a,e,t)!==void 0);if(n){const a=bn(n,e,t);return[$o(a)]}return}case"Enter":{const n=D("frameName",s,e,t),a=D("tensor",s,e,t);return t.enterFrame(n),[$o(a)]}case"Exit":{const n=D("tensor",s,e,t);return t.exitFrame(),[$o(n)]}case"NextIteration":{const n=D("tensor",s,e,t);return t.nextIteration(),[$o(n)]}case"TensorArrayV3":{const n=D("size",s,e,t),a=D("dtype",s,e,t),o=D("elementShape",s,e,t),i=D("dynamicSize",s,e,t),c=D("clearAfterRead",s,e,t),u=D("identicalElementShapes",s,e,t),h=D("name",s,e,t),p=new uG(h,a,n,o,u,i,c);return t.addTensorArray(p),[p.idTensor,ht(1)]}case"TensorArrayWriteV3":{const n=D("tensorArrayId",s,e,t),a=D("index",s,e,t),o=D("tensor",s,e,t),i=t.getTensorArray(n.id);return i.write(a,o),[i.idTensor]}case"TensorArrayReadV3":{const n=D("tensorArrayId",s,e,t),a=D("index",s,e,t);return[t.getTensorArray(n.id).read(a)]}case"TensorArrayGatherV3":{const n=D("tensorArrayId",s,e,t),a=D("indices",s,e,t),o=D("dtype",s,e,t);return[t.getTensorArray(n.id).gather(a,o)]}case"TensorArrayScatterV3":{const n=D("tensorArrayId",s,e,t),a=D("indices",s,e,t),o=D("tensor",s,e,t),i=t.getTensorArray(n.id);return i.scatter(a,o),[i.idTensor]}case"TensorArrayConcatV3":{const n=D("tensorArrayId",s,e,t),a=t.getTensorArray(n.id),o=D("dtype",s,e,t);return[a.concat(o)]}case"TensorArraySplitV3":{const n=D("tensorArrayId",s,e,t),a=D("tensor",s,e,t),o=D("lengths",s,e,t),i=t.getTensorArray(n.id);return i.split(o,a),[i.idTensor]}case"TensorArraySizeV3":{const n=D("tensorArrayId",s,e,t),a=t.getTensorArray(n.id);return[ht(a.size(),"int32")]}case"TensorArrayCloseV3":{const n=D("tensorArrayId",s,e,t),a=t.getTensorArray(n.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const n=D("tensorListId",s,e,t),a=D("index",s,e,t),o=D("tensor",s,e,t),i=t.getTensorList(n.id);return i.setItem(a,o),[i.idTensor]}case"TensorListGetItem":{const n=D("tensorListId",s,e,t),a=D("index",s,e,t),o=D("elementShape",s,e,t),i=D("elementDType",s,e,t);return[t.getTensorList(n.id).getItem(a,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const n=D("indices",s,e,t),a=D("tensor",s,e,t),o=D("elementShape",s,e,t),i=D("numElements",s,e,t),c=pG(a,n,o,i);return t.addTensorList(c),[c.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const n=D("elementShape",s,e,t),a=D("elementDType",s,e,t);let o;s.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=D(o,s,e,t),c=s.op==="TensorListReserve"?-1:i,u=hG(n,a,i,c);return t.addTensorList(u),[u.idTensor]}case"TensorListGather":{const n=D("tensorListId",s,e,t),a=D("indices",s,e,t),o=D("elementShape",s,e,t),i=D("elementDType",s,e,t);return[t.getTensorList(n.id).gather(a,i,o)]}case"TensorListStack":{const n=D("tensorListId",s,e,t),a=D("elementShape",s,e,t),o=D("elementDType",s,e,t),i=D("numElements",s,e,t);return[t.getTensorList(n.id).stack(a,o,i)]}case"TensorListFromTensor":{const n=D("tensor",s,e,t),a=D("elementShape",s,e,t),o=D("elementDType",s,e,t),i=dG(n,a,o);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const n=D("tensorListId",s,e,t),a=t.getTensorList(n.id),o=D("dtype",s,e,t),i=D("elementShape",s,e,t);return[a.concat(o,i)]}case"TensorListPushBack":{const n=D("tensorListId",s,e,t),a=D("tensor",s,e,t),o=t.getTensorList(n.id);return o.pushBack(a),[o.idTensor]}case"TensorListPopBack":{const n=D("tensorListId",s,e,t),a=D("elementShape",s,e,t),o=D("elementDType",s,e,t);return[t.getTensorList(n.id).popBack(a,o)]}case"TensorListSplit":{const n=D("tensor",s,e,t),a=D("elementShape",s,e,t),o=D("lengths",s,e,t),i=fG(n,o,a);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const n=D("tensorListId",s,e,t),a=t.getTensorList(n.id);return[ht(a.size(),"int32")]}case"TensorListResize":{const n=D("tensorListId",s,e,t),a=D("size",s,e,t),i=t.getTensorList(n.id).resize(a);return t.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aC(s,e,t){const[n,a]=D("fusedOps",s,e,t),o=n==="biasadd",i=!o,c=a==="prelu",u=n==="fusedbatchnorm",h=D("numArgs",s,e,t);if(o){if(c&&h!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&o&&h!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const p=D("strides",s,e,t),f=Im(s,e,t),g=D("dataFormat",s,e,t).toUpperCase(),b=D("dilations",s,e,t);let[y,v]=D("args",s,e,t);i&&(v=y,y=void 0);const w=D("leakyreluAlpha",s,e,t);return{stride:p,pad:f,dataFormat:g,dilations:b,biasArg:y,preluArg:v,activationFunc:a,leakyreluAlpha:w}}const gG=(s,e,t,n=Cn)=>{switch(s.op){case"Conv1D":{const a=D("stride",s,e,t),o=D("pad",s,e,t),i=D("dataFormat",s,e,t).toUpperCase(),c=D("dilation",s,e,t);return[n.conv1d(D("x",s,e,t),D("filter",s,e,t),a,o,i,c)]}case"Conv2D":{const a=D("strides",s,e,t),o=Im(s,e,t),i=D("dataFormat",s,e,t).toUpperCase(),c=D("dilations",s,e,t);return[n.conv2d(D("x",s,e,t),D("filter",s,e,t),[a[1],a[2]],o,i,[c[1],c[2]])]}case"_FusedConv2D":{const{stride:a,pad:o,dataFormat:i,dilations:c,biasArg:u,preluArg:h,activationFunc:p,leakyreluAlpha:f}=aC(s,e,t);return[n.fused.conv2d({x:D("x",s,e,t),filter:D("filter",s,e,t),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[c[1],c[2]],bias:u,activation:p,preluActivationWeights:h,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:o,dataFormat:i,dilations:c,biasArg:u,preluArg:h,activationFunc:p,leakyreluAlpha:f}=aC(s,e,t);return[n.fused.depthwiseConv2d({x:D("x",s,e,t),filter:D("filter",s,e,t),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[c[1],c[2]],bias:u,activation:p,preluActivationWeights:h,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=D("outputShape",s,e,t),o=D("strides",s,e,t),i=Im(s,e,t);return[n.conv2dTranspose(D("x",s,e,t),D("filter",s,e,t),a,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=D("strides",s,e,t),o=Im(s,e,t),i=D("dilations",s,e,t),c=D("dataFormat",s,e,t).toUpperCase();return[n.depthwiseConv2d(D("input",s,e,t),D("filter",s,e,t),[a[1],a[2]],o,c,[i[1],i[2]])]}case"Conv3D":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("dataFormat",s,e,t).toUpperCase(),c=D("dilations",s,e,t);return[n.conv3d(D("x",s,e,t),D("filter",s,e,t),[a[1],a[2],a[3]],o,i,[c[1],c[2],c[3]])]}case"AvgPool":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("kernelSize",s,e,t);return[n.avgPool(D("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPool":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("kernelSize",s,e,t);return[n.maxPool(D("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPoolWithArgmax":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("kernelSize",s,e,t),c=D("includeBatchInIndex",s,e,t),{result:u,indexes:h}=n.maxPoolWithArgmax(D("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o,c);return[u,h]}case"AvgPool3D":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("kernelSize",s,e,t);return[n.avgPool3d(D("x",s,e,t),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"MaxPool3D":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("kernelSize",s,e,t);return[n.maxPool3d(D("x",s,e,t),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"Dilation2D":{const a=D("strides",s,e,t),o=D("pad",s,e,t),i=D("dilations",s,e,t),c=a[1],u=a[2],h=i[1],p=i[2];return[n.dilation2d(D("x",s,e,t),D("filter",s,e,t),[c,u],o,[h,p],"NHWC")]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xG=(s,e,t,n=Cn)=>{switch(s.op){case"Fill":{const a=D("shape",s,e,t),o=D("dtype",s,e,t),i=D("value",s,e,t);return[n.fill(a,i,o)]}case"LinSpace":{const a=D("start",s,e,t),o=D("stop",s,e,t),i=D("num",s,e,t);return[n.linspace(a,o,i)]}case"Multinomial":{const a=D("logits",s,e,t),o=D("numSamples",s,e,t),i=D("seed",s,e,t);return[n.multinomial(a,o,i)]}case"OneHot":{const a=D("indices",s,e,t),o=D("depth",s,e,t),i=D("onValue",s,e,t),c=D("offValue",s,e,t),u=D("dtype",s,e,t);return[n.oneHot(a,o,i,c,u)]}case"Ones":return[n.ones(D("shape",s,e,t),D("dtype",s,e,t))];case"OnesLike":return[n.onesLike(D("x",s,e,t))];case"RandomStandardNormal":return[n.randomStandardNormal(D("shape",s,e,t),D("dtype",s,e,t),D("seed",s,e,t))];case"RandomUniform":return[n.randomUniform(D("shape",s,e,t),D("minval",s,e,t),D("maxval",s,e,t),D("dtype",s,e,t))];case"RandomUniformInt":return[n.randomUniformInt(D("shape",s,e,t),D("minval",s,e,t),D("maxval",s,e,t),D("seed",s,e,t))];case"Range":{const a=D("start",s,e,t),o=D("stop",s,e,t),i=D("step",s,e,t);return[n.range(a,o,i,D("dtype",s,e,t))]}case"TruncatedNormal":{const a=D("shape",s,e,t),o=D("mean",s,e,t),i=D("stdDev",s,e,t),c=D("seed",s,e,t);return[n.truncatedNormal(a,o,i,D("dtype",s,e,t),c)]}case"Zeros":return[n.zeros(D("shape",s,e,t),D("dtype",s,e,t))];case"ZerosLike":return[n.zerosLike(D("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(s,e,t){const n=D("boxes",s,e,t),a=D("scores",s,e,t),o=D("maxOutputSize",s,e,t),i=D("iouThreshold",s,e,t),c=D("scoreThreshold",s,e,t),u=D("softNmsSigma",s,e,t);return{boxes:n,scores:a,maxOutputSize:o,iouThreshold:i,scoreThreshold:c,softNmsSigma:u}}const bG=async(s,e,t,n,a=Cn)=>{switch(s.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h,softNmsSigma:p}=g1(s,e,t),f=await a.image.nonMaxSuppressionWithScoreAsync(o,i,c,u,h,p);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h}=g1(s,e,t),p=D("padToMaxOutputSize",s,e,t),f=await a.image.nonMaxSuppressionPaddedAsync(o,i,c,u,h,p);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h}=g1(s,e,t);return[await a.image.nonMaxSuppressionAsync(o,i,c,u,h)]}case"Where":{const o=a.cast(D("condition",s,e,t),"bool"),i=[await a.whereAsync(o)];return o.dispose(),i}case"ListDiff":return a.setdiff1dAsync(D("x",s,e,t),D("y",s,e,t));default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yG=(s,e,t,n=Cn)=>{switch(s.op){case"LowerBound":{const a=D("sortedSequence",s,e,t),o=D("values",s,e,t);return[n.lowerBound(a,o)]}case"TopKV2":{const a=D("x",s,e,t),o=D("k",s,e,t),i=D("sorted",s,e,t),c=n.topk(a,o,i);return[c.values,c.indices]}case"UpperBound":{const a=D("sortedSequence",s,e,t),o=D("values",s,e,t);return[n.upperBound(a,o)]}case"Unique":{const a=D("x",s,e,t),o=n.unique(a);return[o.values,o.indices]}case"UniqueV2":{const a=D("x",s,e,t),o=D("axis",s,e,t),i=n.unique(a,o);return[i.values,i.indices]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG=(s,e,t,n=Cn)=>{switch(s.op){case"Const":return e[s.name];case"PlaceholderWithDefault":const a=D("default",s,e,t);return[bn(s.name,e,t)||a];case"Placeholder":return[bn(s.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const p=D("x",s,e,t);return[$o(p)]}case"IdentityN":return D("x",s,e,t).map(p=>$o(p));case"Snapshot":const o=D("x",s,e,t);return[$o(o)];case"Shape":return[n.tensor1d(D("x",s,e,t).shape,"int32")];case"ShapeN":return D("x",s,e,t).map(p=>n.tensor1d(p.shape));case"Size":return[n.scalar(D("x",s,e,t).size,"int32")];case"Rank":return[n.scalar(D("x",s,e,t).rank,"int32")];case"NoOp":return[n.scalar(1)];case"Print":const i=D("x",s,e,t),c=D("data",s,e,t),u=D("message",s,e,t),h=D("summarize",s,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let p=0;p<c.length;p++)console.log(Array.prototype.slice.call(c[p].dataSync()).slice(0,h));return[i];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wG{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=ht(0),this.tensorMap=new Map,un(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ht(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),me(()=>{const a=ur(t),o=n.length,i=a.length;V(o===i,()=>"The number of elements doesn't match, keys has "+"".concat(o," elements, the values has ").concat(i," ")+"elements.");for(let c=0;c<o;c++){const u=n[c],h=a[c];un(h),this.tensorMap.set(u,h)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return me(()=>{const a=[];for(let o=0;o<n.length;o++){const i=n[o],c=this.findWithDefault(i,t);a.push(c)}return va(a)})}findWithDefault(e,t){const n=this.tensorMap.get(e);return n!=null?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NG=async(s,e,t,n)=>{switch(s.op){case"HashTable":case"HashTableV2":{const a=n.getHashTableHandleByName(s.name);if(a!=null)return[a];{const o=D("keyDType",s,e,t),i=D("valueDType",s,e,t),c=new wG(o,i);return n.addHashTable(s.name,c),[c.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=D("tableHandle",s,e,t,n),o=D("keys",s,e,t),i=D("values",s,e,t);return[await n.getHashTableById(a.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const a=D("tableHandle",s,e,t,n),o=D("keys",s,e,t),i=D("defaultValue",s,e,t);return[await n.getHashTableById(a.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=D("tableHandle",s,e,t,n);return[n.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG=(s,e,t,n=Cn)=>{switch(s.op){case"ResizeBilinear":{const a=D("images",s,e,t),o=D("size",s,e,t),i=D("alignCorners",s,e,t),c=D("halfPixelCenters",s,e,t);return[n.image.resizeBilinear(a,[o[0],o[1]],i,c)]}case"ResizeNearestNeighbor":{const a=D("images",s,e,t),o=D("size",s,e,t),i=D("alignCorners",s,e,t),c=D("halfPixelCenters",s,e,t);return[n.image.resizeNearestNeighbor(a,[o[0],o[1]],i,c)]}case"CropAndResize":{const a=D("image",s,e,t),o=D("boxes",s,e,t),i=D("boxInd",s,e,t),c=D("cropSize",s,e,t),u=D("method",s,e,t),h=D("extrapolationValue",s,e,t);return[n.image.cropAndResize(a,o,i,c,u,h)]}case"ImageProjectiveTransformV3":{const a=D("images",s,e,t),o=D("transforms",s,e,t),i=D("outputShape",s,e,t),c=D("fillValue",s,e,t),u=D("interpolation",s,e,t),h=D("fillMode",s,e,t);return[n.image.transform(a,o,u.toLowerCase(),h.toLowerCase(),c,i)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CG=(s,e,t,n=Cn)=>{switch(s.op){case"Equal":return[n.equal(D("a",s,e,t),D("b",s,e,t))];case"NotEqual":return[n.notEqual(D("a",s,e,t),D("b",s,e,t))];case"Greater":return[n.greater(D("a",s,e,t),D("b",s,e,t))];case"GreaterEqual":return[n.greaterEqual(D("a",s,e,t),D("b",s,e,t))];case"Less":return[n.less(D("a",s,e,t),D("b",s,e,t))];case"LessEqual":return[n.lessEqual(D("a",s,e,t),D("b",s,e,t))];case"LogicalAnd":return[n.logicalAnd(D("a",s,e,t),D("b",s,e,t))];case"LogicalNot":return[n.logicalNot(D("a",s,e,t))];case"LogicalOr":return[n.logicalOr(D("a",s,e,t),D("b",s,e,t))];case"Select":case"SelectV2":return[n.where(D("condition",s,e,t),D("a",s,e,t),D("b",s,e,t))];case"BitwiseAnd":return[n.bitwiseAnd(D("a",s,e,t),D("b",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kG=(s,e,t,n=Cn)=>{switch(s.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[n.matMul(D("a",s,e,t),D("b",s,e,t),D("transposeA",s,e,t),D("transposeB",s,e,t))];case"Einsum":return[n.einsum(D("equation",s,e,t),...D("tensors",s,e,t))];case"Transpose":return[n.transpose(D("x",s,e,t),D("perm",s,e,t))];case"_FusedMatMul":const[a,o]=D("fusedOps",s,e,t),i=a==="biasadd",c=o==="prelu",u=D("numArgs",s,e,t),h=D("leakyreluAlpha",s,e,t);if(i){if(c&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[p,f]=D("args",s,e,t);return[n.fused.matMul({a:D("a",s,e,t),b:D("b",s,e,t),transposeA:D("transposeA",s,e,t),transposeB:D("transposeB",s,e,t),bias:p,activation:o,preluActivationWeights:f,leakyreluAlpha:h})];case"MatrixBandPart":return[n.linalg.bandPart(D("a",s,e,t),D("numLower",s,e,t),D("numUpper",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jG=(s,e,t,n=Cn)=>{switch(s.op){case"EuclideanNorm":return[n.euclideanNorm(D("x",s,e,t),D("axis",s,e,t),D("keepDims",s,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[n.batchNorm(D("x",s,e,t),D("mean",s,e,t),D("variance",s,e,t),D("offset",s,e,t),D("scale",s,e,t),D("epsilon",s,e,t))];case"FusedBatchNormV3":return[n.batchNorm(D("x",s,e,t),D("mean",s,e,t),D("variance",s,e,t),D("offset",s,e,t),D("scale",s,e,t),D("epsilon",s,e,t))];case"LRN":return[n.localResponseNormalization(D("x",s,e,t),D("radius",s,e,t),D("bias",s,e,t),D("alpha",s,e,t),D("beta",s,e,t))];case"Softmax":return[n.softmax(D("x",s,e,t))];case"LogSoftmax":return[n.logSoftmax(D("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG=(s,e,t,n=Cn)=>{switch(s.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:o}=n.raggedGather(D("paramsNestedSplits",s,e,t),D("paramsDenseValues",s,e,t),D("indices",s,e,t),D("outputRaggedRank",s,e,t));return a.concat(o)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:o}=n.raggedRange(D("starts",s,e,t),D("limits",s,e,t),D("splits",s,e,t));return[a,o]}case"RaggedTensorToTensor":return[n.raggedTensorToTensor(D("shape",s,e,t),D("values",s,e,t),D("defaultValue",s,e,t),D("rowPartitionTensors",s,e,t),D("rowPartitionTypes",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IG=(s,e,t,n=Cn)=>{switch(s.op){case"Max":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.max(D("x",s,e,t),c,u)]}case"Mean":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.mean(D("x",s,e,t),c,u)]}case"Min":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.min(D("x",s,e,t),c,u)]}case"Sum":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.sum(D("x",s,e,t),c,u)]}case"All":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.all(D("x",s,e,t),c,u)]}case"Any":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.any(D("x",s,e,t),c,u)]}case"ArgMax":{const c=D("axis",s,e,t);return[n.argMax(D("x",s,e,t),c)]}case"ArgMin":{const c=D("axis",s,e,t);return[n.argMin(D("x",s,e,t),c)]}case"Prod":{const c=D("axis",s,e,t),u=D("keepDims",s,e,t);return[n.prod(D("x",s,e,t),c,u)]}case"Cumprod":{const c=D("axis",s,e,t),u=D("exclusive",s,e,t),h=D("reverse",s,e,t);return[n.cumprod(D("x",s,e,t),c,u,h)]}case"Cumsum":{const c=D("axis",s,e,t),u=D("exclusive",s,e,t),h=D("reverse",s,e,t);return[n.cumsum(D("x",s,e,t),c,u,h)]}case"Bincount":const a=D("x",s,e,t),o=D("weights",s,e,t),i=D("size",s,e,t);return[n.bincount(a,o,i)];case"DenseBincount":{const c=D("x",s,e,t),u=D("weights",s,e,t),h=D("size",s,e,t),p=D("binaryOutput",s,e,t);return[n.denseBincount(c,u,h,p)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $G=(s,e,t,n=Cn)=>{switch(s.op){case"ConcatV2":case"Concat":{const a=D("n",s,e,t),o=D("axis",s,e,t);let i=D("tensors",s,e,t);return i=i.slice(0,a),[n.concat(i,o)]}case"Gather":{const a=D("x",s,e,t),o=D("indices",s,e,t);return[n.gather(a,n.cast(o,"int32"),0)]}case"GatherV2":{const a=D("axis",s,e,t),o=D("batchDims",s,e,t),i=D("x",s,e,t),c=D("indices",s,e,t);return[n.gather(i,n.cast(c,"int32"),a,o)]}case"Reverse":{const a=D("dims",s,e,t),o=[];for(let c=0;c<a.length;c++)a[c]&&o.push(c);const i=D("x",s,e,t);return[n.reverse(i,o)]}case"ReverseV2":{const a=D("axis",s,e,t),o=D("x",s,e,t);return[n.reverse(o,a)]}case"Slice":{const a=D("begin",s,e,t),o=D("size",s,e,t);return[n.slice(D("x",s,e,t),a,o)]}case"StridedSlice":{const a=D("begin",s,e,t),o=D("end",s,e,t),i=D("strides",s,e,t),c=D("beginMask",s,e,t),u=D("endMask",s,e,t),h=D("ellipsisMask",s,e,t),p=D("newAxisMask",s,e,t),f=D("shrinkAxisMask",s,e,t),g=D("x",s,e,t);return[n.stridedSlice(g,a,o,i,c,u,h,p,f)]}case"Pack":return me(()=>{const a=D("axis",s,e,t),o=D("tensors",s,e,t),i=o[0].shape,c=n.squeeze(o[0]).shape,u=o.map(h=>{const p=Mt(h.shape,i);if(!p&&!Mt(n.squeeze(h).shape,c))throw new Error("the input tensors shape does not match");return p?h:n.reshape(h,i)});return[n.stack(u,a)]});case"Unpack":{const a=D("axis",s,e,t),o=D("tensor",s,e,t);return n.unstack(o,a)}case"Tile":{const a=D("reps",s,e,t);return[n.tile(D("x",s,e,t),a)]}case"Split":case"SplitV":{const a=D("axis",s,e,t),o=D("numOrSizeSplits",s,e,t),i=D("x",s,e,t);return n.split(i,o,a)}case"ScatterNd":{const a=D("indices",s,e,t),o=D("values",s,e,t),i=D("shape",s,e,t);return[n.scatterND(a,o,i)]}case"GatherNd":{const a=D("x",s,e,t),o=D("indices",s,e,t);return[n.gatherND(a,o)]}case"SparseToDense":{const a=D("sparseIndices",s,e,t),o=D("outputShape",s,e,t),i=D("sparseValues",s,e,t),c=D("defaultValue",s,e,t);return[n.sparseToDense(a,i,o,i.dtype===c.dtype?c:n.cast(c,i.dtype))]}case"TensorScatterUpdate":{const a=D("indices",s,e,t),o=D("values",s,e,t),i=D("tensor",s,e,t);return[n.tensorScatterUpdate(i,a,o)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AG=(s,e,t,n=Cn)=>{switch(s.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:o,emptyRowIndicator:i,reverseIndexMap:c}=n.sparse.sparseFillEmptyRows(D("indices",s,e,t),D("values",s,e,t),D("denseShape",s,e,t),D("defaultValue",s,e,t));return[a,o,i,c]}case"SparseReshape":{const{outputIndices:a,outputShape:o}=n.sparse.sparseReshape(D("inputIndices",s,e,t),D("inputShape",s,e,t),D("newShape",s,e,t));return[a,o]}case"SparseSegmentMean":return[n.sparse.sparseSegmentMean(D("data",s,e,t),D("indices",s,e,t),D("segmentIds",s,e,t))];case"SparseSegmentSum":return[n.sparse.sparseSegmentSum(D("data",s,e,t),D("indices",s,e,t),D("segmentIds",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=(s,e,t,n=Cn)=>{switch(s.op){case"FFT":return[n.fft(D("x",s,e,t))];case"IFFT":return[n.ifft(D("x",s,e,t))];case"RFFT":return[n.rfft(D("x",s,e,t))];case"IRFFT":return[n.irfft(D("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DG=(s,e,t,n=Cn)=>{switch(s.op){case"StaticRegexReplace":return[n.string.staticRegexReplace(D("input",s,e,t),D("pattern",s,e,t),D("rewrite",s,e,t),D("replaceGlobal",s,e,t))];case"StringNGrams":{const{nGrams:a,nGramsSplits:o}=n.string.stringNGrams(D("data",s,e,t),D("dataSplits",s,e,t),D("separator",s,e,t),D("nGramWidths",s,e,t),D("leftPad",s,e,t),D("rightPad",s,e,t),D("padWidth",s,e,t),D("preserveShortSequences",s,e,t));return[a,o]}case"StringSplit":{const{indices:a,values:o,shape:i}=n.string.stringSplit(D("input",s,e,t),D("delimiter",s,e,t),D("skipEmpty",s,e,t));return[a,o,i]}case"StringToHashBucketFast":return[n.string.stringToHashBucketFast(D("input",s,e,t),D("numBuckets",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RG=(s,e,t,n=Cn)=>{switch(s.op){case"Cast":return[n.cast(D("x",s,e,t),D("dtype",s,e,t))];case"ExpandDims":{const a=D("axis",s,e,t);return[n.expandDims(D("x",s,e,t),a)]}case"Squeeze":{const a=D("axis",s,e,t);return[n.squeeze(D("x",s,e,t),a)]}case"Reshape":return[n.reshape(D("x",s,e,t),D("shape",s,e,t))];case"EnsureShape":return[n.ensureShape(D("x",s,e,t),D("shape",s,e,t))];case"MirrorPad":return[n.mirrorPad(D("x",s,e,t),D("padding",s,e,t),D("mode",s,e,t))];case"PadV2":case"Pad":return[n.pad(D("x",s,e,t),D("padding",s,e,t),D("constantValue",s,e,t))];case"SpaceToBatchND":{const a=D("blockShape",s,e,t),o=D("paddings",s,e,t);return[n.spaceToBatchND(D("x",s,e,t),a,o)]}case"BatchToSpaceND":{const a=D("blockShape",s,e,t),o=D("crops",s,e,t);return[n.batchToSpaceND(D("x",s,e,t),a,o)]}case"DepthToSpace":{const a=D("blockSize",s,e,t),o=D("dataFormat",s,e,t).toUpperCase();return[n.depthToSpace(D("x",s,e,t),a,o)]}case"BroadcastTo":return[n.broadcastTo(D("x",s,e,t),D("shape",s,e,t))];case"BroadcastArgs":return[n.broadcastArgs(D("s0",s,e,t),D("s1",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rC(s,e,t,n,a=me){const o=((i,c,u)=>{switch(i.category){case"arithmetic":return a(()=>lG(i,c,u));case"basic_math":return a(()=>cG(i,c,u));case"control":return mG(i,c,u);case"convolution":return a(()=>gG(i,c,u));case"creation":return a(()=>xG(i,c,u));case"dynamic":return bG(i,c,u);case"evaluation":return a(()=>yG(i,c,u));case"image":return a(()=>SG(i,c,u));case"graph":return a(()=>vG(i,c,u));case"logical":return a(()=>CG(i,c,u));case"matrices":return a(()=>kG(i,c,u));case"normalization":return a(()=>jG(i,c,u));case"ragged":return a(()=>TG(i,c,u));case"reduction":return a(()=>IG(i,c,u));case"slice_join":return a(()=>$G(i,c,u));case"sparse":return a(()=>AG(i,c,u));case"spectral":return a(()=>EG(i,c,u));case"string":return a(()=>DG(i,c,u));case"transformation":return a(()=>RG(i,c,u));case"hash_table":return NG(i,c,u,n);case"custom":const h=yI(i.op);if(h&&h.customExecutor)return h.customExecutor(new iG(i,c,u));throw TypeError("Custom op ".concat(i.op," is not registered."));default:throw TypeError("Unknown op '".concat(i.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(s,e,t);return Pl(o)?o.then(i=>[].concat(i)):[].concat(o)}class oC{constructor(e={},t={},n={},a={},o){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=a,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":"".concat(t.frameName,"-").concat(t.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iC(s,e,t,n){const a=new Set,o=[];let i=null,c=null;const u=new Set,h=new Set(Object.keys(s).map(g=>ma(g)[0]));n=n||[];const p=new Set(n.map(g=>ma(g.name)[0])),f=[...e];for(;f.length>0;){const g=f.pop();if((Al(g)||BG(g)||VG(g))&&i==null&&(i=g,c=i.children.map(b=>b.name).filter(b=>a.has(b))),a.add(g.name),t[g.name]==null&&!h.has(g.name)&&!p.has(g.name)){if(g.inputs.length===0){o.push(g.name);continue}g.inputs.forEach(b=>{u.has(b.name)||(u.add(b.name),f.push(b))})}}return{inputs:s,outputs:e,usedNodes:a,missingInputs:o,dynamicNode:i,syncInputs:c}}function _G(s,e){const{usedNodes:t,inputs:n}=e,a=Object.keys(n).map(w=>ma(w)[0]).map(w=>s.nodes[w]),o=s.initNodes||[],i=w=>t.has(typeof w=="string"?w:w.name);function c(w){return[...new Map(w.map(N=>[N.name,N])).values()]}const u=c([...a,...s.weights,...o]).filter(i),h=c([...u,...Object.values(s.nodes)]).filter(i),p=new Map(h.map(w=>[w.name,w])),f={};for(const w of h){f[w.name]=f[w.name]||0;for(const N of w.children)i(N)||(f[N.name]=Number.POSITIVE_INFINITY),f[N.name]=(f[N.name]||0)+1}const g=Object.entries(f).filter(([,w])=>w===0).map(([w])=>w),b=[...g];for(;g.length>0;){const w=g.pop(),N=p.get(w);for(const C of N.children.filter(i))--f[C.name]===0&&(b.push(C.name),g.push(C.name))}const y=b.map(w=>p.get(w)),v=OG(y,u);return FG(v,u),v}function OG(s,e){const t=new Map(s.map(i=>[i.name,i])),n=e.map(i=>i.name),a=new Set(n);for(;n.length>0;){const i=n.pop(),c=t.get(i);for(const u of c.children)!t.has(u.name)||a.has(u.name)||(a.add(u.name),n.push(u.name))}return s.filter(i=>a.has(i.name))}class om extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}}function FG(s,e){const t=new Map(s.map((c,u)=>[c.name,u])),n=new Set(e.map(c=>c.name)),a=c=>n.has(typeof c=="string"?c:c.name),o=new Set(s.map(c=>c.name)),i=c=>o.has(typeof c=="string"?c:c.name);for(const c of s){for(const u of c.children.filter(i)){if(!t.has(u.name))throw new om("Child ".concat(u.name," of node ").concat(c.name," is unreachable."));if(t.get(c.name)>t.get(u.name))throw new om("Node ".concat(c.name," is scheduled to run after its child ").concat(u.name,"."))}if(!a(c))for(const u of c.inputs){if(!t.has(u.name))throw new om("Input ".concat(u.name," of node ").concat(c.name," is unreachable."));if(t.get(u.name)>t.get(c.name))throw new om("Node ".concat(c.name," is scheduled to run before its input ").concat(u.name,"."))}}}function LG(s){const e=new Map(s.map((c,u)=>[c.name,u])),t=Number.MAX_SAFE_INTEGER,n=s.map((c,u)=>Al(c)?t:u),a=c=>{const u=n[e.get(c.name)];return u==null?-1:u},o=s.map((c,u)=>c.children.map(a).reduce((h,p)=>Math.max(h,p),n[u])),i=new Map;for(let c=0;c<s.length;++c){const u=o[c];if(u===t)continue;const h=s[c],p=s[u];i.has(p.name)||i.set(p.name,[]),i.get(p.name).push(h)}return i}const MG=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),zG=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),PG=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Al(s){return MG.has(s.op)}function BG(s){return zG.has(s.op)}function VG(s){return PG.has(s.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pm{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(n=>e[n].map(a=>a.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(n=>{this._functionExecutorMap[n]=new Pm(e.functions[n],this)})}getCompilationKey(e,t){const n=e.map(o=>o.name).sort(),a=t.map(o=>o.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){const n=iC(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:o,syncInputs:i}=n;if(o!=null)throw new Error("This execution contains the node '".concat(o.name,"', which has ")+"the dynamic op '".concat(o.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(a.length>0){const h=t.map(f=>f.name),p=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(h,"] from the provided inputs ")+"[".concat(p,"]. Missing the following inputs: [").concat(a,"]"))}const c=_G(this.graph,n),u=LG(c);return{orderedNodes:c,nodeLiveUntilMap:u}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return un(t),t}cloneTensorList(e){return e?e.map(n=>this.cloneAndKeepTensor(n)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,this.cloneTensorList(n)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const a=n.map(g=>this.graph.nodes[ma(g)[0]]),o=t.map(g=>ma(g)[0]),i=new Set(o);let c=o.map(g=>this.graph.nodes[g]);c.length===0&&(c=this._outputs);const u=this.getCompilationKey(a,c);let h=this.compiledMap.get(u);h==null&&(h=this.compile(e,c),this.compiledMap.set(u,h));try{this.keepIntermediateTensors=Se().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const p={},f={};return me(()=>{const g=new oC(this.weightMap,p,f,this.functionExecutorMap,this.parseNodeNameCache),b=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(N=>{const[C,I]=ma(N,g),T=[];T[I]=e[N],b[C]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[C]=this.cloneTensorList(T))});const y=this.getFrozenTensorIds(b),{orderedNodes:v,nodeLiveUntilMap:w}=h;for(const N of v){if(b[N.name])continue;const C=rC(N,b,g,this._resourceManager);if(Pl(C))throw new Error("The execution of the op '".concat(N.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");b[N.name]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[N.name]=this.cloneTensorList(C)),this.checkTensorForDisposalWithNodeLiveUntilInfo(N,b,g,y,i,w.get(N.name))}return this.parent==null&&g.dispose(y),t.map(N=>bn(N,b,g))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(n=>e[n]).map(n=>n.map(a=>a.id)));return new Set(t)}checkTensorForDisposal(e,t,n,a,o,i,c){if(!(Al(t)||i.has(e))){for(const u of n[e])u!=null&&(c[u.id]=(c[u.id]||0)+t.children.length);for(const u of t.inputs){if(Al(u))continue;const h=eC(u.name,n,a);if(h!=null)for(const p of h){if(!p||p.kept||o.has(p.id))continue;const f=c[p.id];f===1?(p.dispose(),delete c[p.id]):f!=null&&c[p.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,a,o,i){function c(u){return Al(u)||o.has(u.name)}if(!(Al(e)||i==null))for(const u of i){if(c(u))continue;const h=eC(u.name,t,n);for(const p of h)!p||p.kept||a.has(p.id)||p.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,a={},o={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Se().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const i=new oC(this.weightMap,a,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const c=await this.executeWithControlFlow(e,i,t,n),u=t.map(g=>bn(g,c,i)),h=u.map(g=>g.id),p=Object.keys(e).map(g=>e[g].id),f=new Set([...h,...p,...this.weightIds]);return Object.values(c).forEach(g=>{g.forEach(b=>{b&&!b.isDisposed&&!f.has(b.id)&&b.dispose()})}),this.parent==null&&i.dispose(f),u}async executeFunctionAsync(e,t,n){const a=e.reduce((o,i,c)=>(o[this.inputs[c].name]=i,o),{});return this._executeAsync(a,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,a){const o=Object.keys(e),i=o.map(T=>this.graph.nodes[ma(T)[0]]),c=n.map(T=>ma(T)[0]),u=new Set(c);let h=c.map(T=>this.graph.nodes[T]);h.length===0&&(h=this._outputs);const{usedNodes:p,missingInputs:f,dynamicNode:g,syncInputs:b}=iC(e,h,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(T=>({node:T,contexts:t.currentContext})),v=Object.assign({},this.weightMap);Object.keys(e).forEach(T=>{const[$,E]=ma(T),_=[];_[E]=e[T],v[$]=_});const w={},N=this.getFrozenTensorIds(v),C={};for(;y.length>0;){const T=this.processStack(i,y,t,v,C,N,u,w,p);await Promise.all(T)}g==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const I=h.filter(T=>!Al(T)&&!bn(T.name,v,t)).map(T=>T.name);if(I.length>0){let T="";throw g!=null&&(T="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(b,"]")),new Error("Cannot compute the outputs [".concat(I,"] from the provided ")+"inputs [".concat(o,"]. Consider providing the following inputs: ")+"[".concat(f,"]. ").concat(T))}return v}processStack(e,t,n,a,o,i,c,u,h){const p=[];for(;t.length>0;){const f=t.pop();n.currentContext=f.contexts;let g="";if(f.node.op==="Enter"&&D("isConstant",f.node,a,n)&&([g]=Io(f.node.name,n)),a[f.node.name]==null){const b=rC(f.node,a,n,this._resourceManager);g||([g]=Io(f.node.name,n));const y=n.currentContext;Pl(b)?p.push(b.then(v=>(a[g]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(v)),n.currentContext=y,this.checkTensorForDisposal(g,f.node,a,n,i,c,u),this.processChildNodes(f.node,t,n,a,o,h),v))):(a[g]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(b)),this.checkTensorForDisposal(g,f.node,a,n,i,c,u),this.processChildNodes(f.node,t,n,a,o,h))}else this.processChildNodes(f.node,t,n,a,o,h)}return p}processChildNodes(e,t,n,a,o,i){e.children.forEach(c=>{const[u]=Io(c.name,n);o[u]||!i.has(c.name)||(c.op==="Merge"?c.inputNames.some(h=>!!bn(h,a,n))&&(o[u]=!0,t.push({contexts:n.currentContext,node:c})):c.inputNames.every(h=>!!bn(h,a,n))&&(o[u]=!0,t.push({contexts:n.currentContext,node:c})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[a]=ma(t),o=this.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,c=i.length===n.shape.length&&n.shape.every((u,h)=>i[h]===-1||i[h]===u);V(c,()=>"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(i,"], but was ")+"[".concat(n.shape,"]"))}o.attrParams.dtype&&o.attrParams.dtype.value&&V(n.dtype===o.attrParams.dtype.value,()=>"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;const a={};for(const o in e){const i=(n=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||n===void 0?void 0:n[o];i!=null?a[i.name]=e[o]:a[o]=e[o]}return a}checkInputs(e){const t=Object.keys(e).filter(n=>{const[a]=ma(n);return this.graph.nodes[a]==null});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(t=>{var n,a;const o=(a=(n=this._signature)===null||n===void 0?void 0:n.outputs)===null||a===void 0?void 0:a[t];return o!=null?o.name:t},{})}checkOutputs(e){e.forEach(t=>{const[n]=ma(t);if(!this.graph.nodes[n])throw new Error("The output '".concat(t,"' is not found in the graph"))})}}class UG{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GG="?tfjs-format=file",WG="model.json";class HG{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=zT){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new UG}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Pl(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await cj(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(a=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=a,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new Pm(tC.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=tC.Instance.transformGraph(e.modelInitializer);this.initializer=new Pm(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(n.length>1)throw new Error("Found more than one (".concat(n.length,") save handlers for ")+"URL '".concat(e,"'"));e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof os?[e]:e,n={};return t.forEach((a,o)=>n[this.structuredOutputKeys[o]]=a),n}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof os)&&!Array.isArray(e)){const o=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(o!=null)for(const i in o){const c=o[i];c.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[c.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let a=0;return this.inputNodes.reduce((o,i)=>{var c,u,h;const p=(h=(u=(c=this.signature)===null||c===void 0?void 0:c.inputs)===null||u===void 0?void 0:u[i])===null||h===void 0?void 0:h.resourceId;return p!=null?o[i]=this.resourceIdToCapturedInput[p]:o[i]=e[a++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let a=0;a<n.length;a++){const o=n[a],i=t[o];this.resourceIdToCapturedInput[i.resourceId]=e[a]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Ct(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function qG(s,e={},t=zT){if(s==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof s=="string"&&(s=KG(s));const n=new HG(s,e,t);return await n.load(),n}function KG(s){return s.endsWith("/")||(s=s+"/"),"".concat(s).concat(WG).concat(GG)}/**
    * @license
    * Copyright 2024 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var Mi=function(){return Mi=Object.assign||function(s){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a]);return s},Mi.apply(this,arguments)};function zo(s,e,t,n){return new(t||(t=Promise))(function(a,o){function i(h){try{u(n.next(h))}catch(p){o(p)}}function c(h){try{u(n.throw(h))}catch(p){o(p)}}function u(h){var p;h.done?a(h.value):(p=h.value,p instanceof t?p:new t(function(f){f(p)})).then(i,c)}u((n=n.apply(s,[])).next())})}function Po(s,e){var t,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return function(p){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(a=2&p[0]?n.return:p[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,p[1])).done)return a;switch(n=0,a&&(p=[2&p[0],a.value]),p[0]){case 0:case 1:a=p;break;case 4:return i.label++,{value:p[1],done:!1};case 5:i.label++,n=p[1],p=[0];continue;case 7:p=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!((a=a.length>0&&a[a.length-1])||p[0]!==6&&p[0]!==2)){i=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){i.label=p[1];break}if(p[0]===6&&i.label<a[1]){i.label=a[1],a=p;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(p);break}a[2]&&i.ops.pop(),i.trys.pop();continue}p=e.call(s,i)}catch(f){p=[6,f],n=0}finally{t=a=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([u,h])}}}var NI=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],x1={modelType:"short",runtime:"mediapipe",maxFaces:1},XG=function(){function s(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new L8.FaceDetection({locateFile:function(n,a){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(n)}return"".concat(a,"/").concat(n)}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:e.modelType}),this.faceDetectorSolution.onResults(function(n){if(t.height=n.image.height,t.width=n.image.width,t.faces=[],n.detections!==null)for(var a=0,o=n.detections;a<o.length;a++){var i=o[a];t.faces.push(t.normalizedToAbsolute(i.landmarks,(c=i.boundingBox,u=void 0,h=void 0,p=void 0,u=c.xCenter-c.width/2,h=u+c.width,p=c.yCenter-c.height/2,{xMin:u,xMax:h,yMin:p,yMax:p+c.height,width:c.width,height:c.height})))}var c,u,h,p})}return s.prototype.normalizedToAbsolute=function(e,t){var n=this;return{keypoints:e.map(function(a,o){return{x:a.x*n.width,y:a.y*n.height,name:NI[o]}}),box:{xMin:t.xMin*this.width,yMin:t.yMin*this.height,xMax:t.xMax*this.width,yMax:t.yMax*this.height,width:t.width*this.width,height:t.height*this.height}}},s.prototype.estimateFaces=function(e,t){return zo(this,void 0,void 0,function(){var n,a;return Po(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),e instanceof os?(a=ImageData.bind,[4,iU(e)]):[3,2];case 1:return n=new(a.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,o.label=3;case 3:return e=n,[4,this.faceDetectorSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}})})},s.prototype.dispose=function(){this.faceDetectorSolution.close()},s.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},s.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},s}();function YG(s){return zo(this,void 0,void 0,function(){var e,t;return Po(this,function(n){switch(n.label){case 0:return e=function(a){if(a==null)return Mi({},x1);var o=Mi({},a);return o.runtime="mediapipe",o.modelType==null&&(o.modelType=x1.modelType),o.maxFaces==null&&(o.maxFaces=x1.maxFaces),o}(s),[4,(t=new XG(e)).initialize()];case 1:return n.sent(),[2,t]}})})}function ZG(s,e,t,n){var a=s.width,o=s.height,i=1,c=Math.cos(s.rotation),u=Math.sin(s.rotation),h=s.xCenter,p=s.yCenter,f=1/e,g=1/t,b=new Array(16);return b[0]=a*c*i*f,b[1]=-o*u*f,b[2]=0,b[3]=(-.5*a*c*i+.5*o*u+h)*f,b[4]=a*u*i*g,b[5]=o*c*g,b[6]=0,b[7]=(-.5*o*c-.5*a*u*i+p)*g,b[8]=0,b[9]=0,b[10]=a*f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,function(y){if(y.length!==16)throw new Error("Array length must be 16 but got ".concat(y.length));return[[y[0],y[1],y[2],y[3]],[y[4],y[5],y[6],y[7]],[y[8],y[9],y[10],y[11]],[y[12],y[13],y[14],y[15]]]}(b)}function SI(s){return s instanceof os?{height:s.shape[0],width:s.shape[1]}:{height:s.height,width:s.width}}function CI(s){return s instanceof os?s:lU(s)}function b1(s,e){V(s.width!==0,function(){return"".concat(e," width cannot be 0.")}),V(s.height!==0,function(){return"".concat(e," height cannot be 0.")})}function QG(s,e){var t=function(n,a,o,i){var c=a-n,u=i-o,h=u/c;return{scale:h,offset:o-n*h}}(0,255,e[0],e[1]);return me(function(){return Fe(ne(s,t.scale),t.offset)})}function JG(s,e,t){var n=e.outputTensorSize,a=e.keepAspectRatio,o=e.borderMode,i=e.outputTensorFloatRange,c=SI(s),u=function(g,b){return{xCenter:.5*g.width,yCenter:.5*g.height,width:g.width,height:g.height,rotation:0}}(c),h=function(g,b,y){if(y===void 0&&(y=!1),!y)return{top:0,left:0,right:0,bottom:0};var v=b.height,w=b.width;b1(b,"targetSize"),b1(g,"roi");var N,C,I=v/w,T=g.height/g.width,$=0,E=0;return I>T?(N=g.width,C=g.width*I,E=(1-T/I)/2):(N=g.height/I,C=g.height,$=(1-I/T)/2),g.width=N,g.height=C,{top:E,left:$,right:$,bottom:E}}(u,n,a),p=ZG(u,c.width,c.height),f=me(function(){var g=CI(s),b=Ol(function(w,N,C){return b1(C,"inputResolution"),[1/C.width*w[0][0]*N.width,1/C.height*w[0][1]*N.width,w[0][3]*N.width,1/C.width*w[1][0]*N.height,1/C.height*w[1][1]*N.height,w[1][3]*N.height,0,0]}(p,c,n),[1,8]),y=o==="zero"?"constant":"nearest",v=Ra.transform(xn(qe(g,"float32")),b,"bilinear",y,0,[n.height,n.width]);return i!=null?QG(v,i):v});return{imageTensor:f,padding:h,transformationMatrix:p}}function lC(s){s.reduceBoxesInLowestLayer==null&&(s.reduceBoxesInLowestLayer=!1),s.interpolatedScaleAspectRatio==null&&(s.interpolatedScaleAspectRatio=1),s.fixedAnchorSize==null&&(s.fixedAnchorSize=!1);for(var e=[],t=0;t<s.numLayers;){for(var n=[],a=[],o=[],i=[],c=t;c<s.strides.length&&s.strides[c]===s.strides[t];){var u=cC(s.minScale,s.maxScale,c,s.strides.length);if(c===0&&s.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),i.push(.1),i.push(u),i.push(u);else{for(var h=0;h<s.aspectRatios.length;++h)o.push(s.aspectRatios[h]),i.push(u);if(s.interpolatedScaleAspectRatio>0){var p=c===s.strides.length-1?1:cC(s.minScale,s.maxScale,c+1,s.strides.length);i.push(Math.sqrt(u*p)),o.push(s.interpolatedScaleAspectRatio)}}c++}for(var f=0;f<o.length;++f){var g=Math.sqrt(o[f]);n.push(i[f]/g),a.push(i[f]*g)}var b=0,y=0;if(s.featureMapHeight.length>0)b=s.featureMapHeight[t],y=s.featureMapWidth[t];else{var v=s.strides[t];b=Math.ceil(s.inputSizeHeight/v),y=Math.ceil(s.inputSizeWidth/v)}for(var w=0;w<b;++w)for(var N=0;N<y;++N)for(var C=0;C<n.length;++C){var I={xCenter:(N+s.anchorOffsetX)/y,yCenter:(w+s.anchorOffsetY)/b,width:0,height:0};s.fixedAnchorSize?(I.width=1,I.height=1):(I.width=a[C],I.height=n[C]),e.push(I)}t=c}return e}function cC(s,e,t,n){return n===1?.5*(s+e):s+(e-s)*t/(n-1)}function uC(s,e){var t=e[0],n=e[1];return[t*s[0]+n*s[1]+s[3],t*s[4]+n*s[5]+s[7]]}function eW(s){return me(function(){var e=function(a){return me(function(){return[xt(a,[0,0,0],[1,-1,1]),xt(a,[0,0,1],[1,-1,-1])]})}(s),t=e[0],n=e[1];return{boxes:Es(n),logits:Es(t)}})}function tW(s,e,t,n){return zo(this,void 0,void 0,function(){var a,o,i,c,u;return Po(this,function(h){switch(h.label){case 0:return s.sort(function(p,f){return Math.max.apply(Math,f.score)-Math.max.apply(Math,p.score)}),a=Ol(s.map(function(p){return[p.locationData.relativeBoundingBox.yMin,p.locationData.relativeBoundingBox.xMin,p.locationData.relativeBoundingBox.yMax,p.locationData.relativeBoundingBox.xMax]})),o=Bs(s.map(function(p){return p.score[0]})),[4,Ra.nonMaxSuppressionAsync(a,o,e,t)];case 1:return[4,(i=h.sent()).array()];case 2:return c=h.sent(),u=s.filter(function(p,f){return c.indexOf(f)>-1}),Ct([a,o,i]),[2,u]}})})}function sW(s,e,t){return zo(this,void 0,void 0,function(){var n,a,o,i,c;return Po(this,function(u){switch(u.label){case 0:return n=s[0],a=s[1],o=function(h,p,f){return me(function(){var g,b,y,v;f.reverseOutputOrder?(b=Es(xt(h,[0,f.boxCoordOffset+0],[-1,1])),g=Es(xt(h,[0,f.boxCoordOffset+1],[-1,1])),v=Es(xt(h,[0,f.boxCoordOffset+2],[-1,1])),y=Es(xt(h,[0,f.boxCoordOffset+3],[-1,1]))):(g=Es(xt(h,[0,f.boxCoordOffset+0],[-1,1])),b=Es(xt(h,[0,f.boxCoordOffset+1],[-1,1])),y=Es(xt(h,[0,f.boxCoordOffset+2],[-1,1])),v=Es(xt(h,[0,f.boxCoordOffset+3],[-1,1]))),b=Fe(ne(Ze(b,f.xScale),p.w),p.x),g=Fe(ne(Ze(g,f.yScale),p.h),p.y),f.applyExponentialOnBoxSize?(y=ne(Bn(Ze(y,f.hScale)),p.h),v=ne(Bn(Ze(v,f.wScale)),p.w)):(y=ne(Ze(y,f.hScale),p.h),v=ne(Ze(v,f.wScale),p.h));var w=et(g,Ze(y,2)),N=et(b,Ze(v,2)),C=Fe(g,Ze(y,2)),I=Fe(b,Ze(v,2)),T=Ts([le(w,[f.numBoxes,1]),le(N,[f.numBoxes,1]),le(C,[f.numBoxes,1]),le(I,[f.numBoxes,1])],1);if(f.numKeypoints)for(var $=0;$<f.numKeypoints;++$){var E=f.keypointCoordOffset+$*f.numValuesPerKeypoint,_=void 0,L=void 0;f.reverseOutputOrder?(_=Es(xt(h,[0,E],[-1,1])),L=Es(xt(h,[0,E+1],[-1,1]))):(L=Es(xt(h,[0,E],[-1,1])),_=Es(xt(h,[0,E+1],[-1,1])));var O=Fe(ne(Ze(_,f.xScale),p.w),p.x),z=Fe(ne(Ze(L,f.yScale),p.h),p.y);T=Ts([T,le(O,[f.numBoxes,1]),le(z,[f.numBoxes,1])],1)}return T})}(a,e,t),i=me(function(){var h=n;return t.sigmoidScore?(t.scoreClippingThresh!=null&&(h=sa(n,-t.scoreClippingThresh,t.scoreClippingThresh)),h=Cr(h)):h}),[4,nW(o,i,t)];case 1:return c=u.sent(),Ct([o,i]),[2,c]}})})}function nW(s,e,t){return zo(this,void 0,void 0,function(){var n,a,o,i,c,u,h,p,f,g,b,y;return Po(this,function(v){switch(v.label){case 0:return n=[],[4,s.data()];case 1:return a=v.sent(),[4,e.data()];case 2:for(o=v.sent(),i=0;i<t.numBoxes;++i)if(!(t.minScoreThresh!=null&&o[i]<t.minScoreThresh||(c=i*t.numCoords,u=aW(a[c+0],a[c+1],a[c+2],a[c+3],o[i],t.flipVertically,i),(h=u.locationData.relativeBoundingBox).width<0||h.height<0))){if(t.numKeypoints>0)for((p=u.locationData).relativeKeypoints=[],f=t.numKeypoints*t.numValuesPerKeypoint,g=0;g<f;g+=t.numValuesPerKeypoint)b=c+t.keypointCoordOffset+g,y={x:a[b+0],y:t.flipVertically?1-a[b+1]:a[b+1]},p.relativeKeypoints.push(y);n.push(u)}return[2,n]}})})}function aW(s,e,t,n,a,o,i){return{score:[a],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-t:s,xMax:n,yMax:o?1-s:t,width:n-e,height:t-s}}}}var rW={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},oW={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},y1={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},iW={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},lW={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},cW=.3,uW={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},dW={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},Bm,hW=function(){function s(e,t,n){this.detectorModel=t,this.maxFaces=n,e==="full"?(this.imageToTensorConfig=dW,this.tensorsToDetectionConfig=lW,this.anchors=lC(oW)):(this.imageToTensorConfig=uW,this.tensorsToDetectionConfig=iW,this.anchors=lC(rW));var a=Bs(this.anchors.map(function(u){return u.width})),o=Bs(this.anchors.map(function(u){return u.height})),i=Bs(this.anchors.map(function(u){return u.xCenter})),c=Bs(this.anchors.map(function(u){return u.yCenter}));this.anchorTensor={x:i,y:c,w:a,h:o}}return s.prototype.dispose=function(){this.detectorModel.dispose(),Ct([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},s.prototype.reset=function(){},s.prototype.detectFaces=function(e,t){return t===void 0&&(t=!1),zo(this,void 0,void 0,function(){var n,a,o,i,c,u,h,p,f,g,b;return Po(this,function(y){switch(y.label){case 0:return e==null?(this.reset(),[2,[]]):(n=me(function(){var v=qe(CI(e),"float32");return t&&(v=Es(Ra.flipLeftRight(xn(v,0)),[0])),v}),a=JG(n,this.imageToTensorConfig),o=a.imageTensor,i=a.transformationMatrix,c=this.detectorModel.execute(o,"Identity:0"),u=eW(c),h=u.boxes,[4,sW([p=u.logits,h],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return(f=y.sent()).length===0?(Ct([n,o,c,p,h]),[2,f]):[4,tW(f,this.maxFaces,cW)];case 2:return g=y.sent(),b=function(v,w){v===void 0&&(v=[]);var N,C=(N=w,[].concat.apply([],N));return v.forEach(function(I){var T=I.locationData;T.relativeKeypoints.forEach(function(z){var A=uC(C,[z.x,z.y]),U=A[0],X=A[1];z.x=U,z.y=X});var $=T.relativeBoundingBox,E=Number.MAX_VALUE,_=Number.MAX_VALUE,L=Number.MIN_VALUE,O=Number.MIN_VALUE;[[$.xMin,$.yMin],[$.xMin+$.width,$.yMin],[$.xMin+$.width,$.yMin+$.height],[$.xMin,$.yMin+$.height]].forEach(function(z){var A=uC(C,z),U=A[0],X=A[1];E=Math.min(E,U),L=Math.max(L,U),_=Math.min(_,X),O=Math.max(O,X)}),T.relativeBoundingBox={xMin:E,xMax:L,yMin:_,yMax:O,width:L-E,height:O-_}}),v}(g,i),Ct([n,o,c,p,h]),[2,b]}})})},s.prototype.estimateFaces=function(e,t){return zo(this,void 0,void 0,function(){var n,a;return Po(this,function(o){return n=SI(e),a=!!t&&t.flipHorizontal,[2,this.detectFaces(e,a).then(function(i){return i.map(function(c){for(var u=c.locationData.relativeKeypoints.map(function(y,v){return Mi(Mi({},y),{x:y.x*n.width,y:y.y*n.height,name:NI[v]})}),h=c.locationData.relativeBoundingBox,p=0,f=["width","xMax","xMin"];p<f.length;p++)h[f[p]]*=n.width;for(var g=0,b=["height","yMax","yMin"];g<b.length;g++)h[b[g]]*=n.height;return{keypoints:u,box:h}})})]})})},s}();function pW(s){return zo(this,void 0,void 0,function(){var e,t,n;return Po(this,function(a){switch(a.label){case 0:return e=function(o){if(o==null)return Mi({},y1);var i=Mi({},o);return i.modelType==null&&(i.modelType=y1.modelType),i.maxFaces==null&&(i.maxFaces=y1.maxFaces),i.detectorModelUrl==null&&(i.modelType==="full"?i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),i}(s),t=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,qG(e.detectorModelUrl,{fromTFHub:t})];case 1:return n=a.sent(),[2,new hW(e.modelType,n,e.maxFaces)]}})})}function fW(s,e){return zo(this,void 0,void 0,function(){var t,n;return Po(this,function(a){if(s===Bm.MediaPipeFaceDetector){if(n=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,pW(t)];if(t.runtime==="mediapipe")return[2,YG(t)];n=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(n))}throw new Error("".concat(s," is not a supported model name."))})})}(function(s){s.MediaPipeFaceDetector="MediaPipeFaceDetector"})(Bm||(Bm={}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kI={kernelName:cg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,Fu(qe(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mW={kernelName:Ih,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=is(qe(t,"float32")),a=wn(et(ht(1),n));return fs(Ze(s,a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gW={kernelName:$h,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=wn(et(is(qe(t,"float32")),1));return Ze(s,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xW={kernelName:Ru,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{let c=s;const u=en(t.shape,a);return u.length>0&&(c=at(c,u)),le(c,t.shape)},b:()=>{let c=s;const u=en(n.shape,a);return u.length>0&&(c=at(c,u)),le(c,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bW={kernelName:ug,saveAllInputs:!0,gradFunc:(s,e)=>{const t={};return e.forEach((n,a)=>{t[a]=()=>s.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yW={kernelName:dg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Bt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vW={kernelName:hg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Bt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW={kernelName:Ah,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,wn(et(ht(1),is(qe(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NW={kernelName:Eh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=wn(Fe(ht(1),is(qe(t,"float32"))));return Ze(s,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SW={kernelName:_h,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{const c=Fe(is(t),is(n));let u=ne(s,Ze(n,c));const h=en(t.shape,a);return h.length>0&&(u=at(u,h)),le(u,t.shape)},b:()=>{const c=Fe(is(t),is(n));let u=fs(ne(s,Ze(t,c)));const h=en(n.shape,a);return h.length>0&&(u=at(u,h)),le(u,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW={kernelName:Dh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,Fe(is(qe(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW={kernelName:Rh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,et(ht(1),is(qe(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(s,e,t,n,a,o){const i=W(s,"dy","avgPool3dGrad"),c=W(e,"input","avgPool3dGrad");let u=i,h=c,p=!1;c.rank===4&&(p=!0,u=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),h=le(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),V(u.rank===5,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),V(h.rank===5,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")),Gn("avgPool3dGrad",a,o);const f={dy:u,input:h},g={filterSize:t,strides:n,pad:a,dimRoundingMode:o},b=oe.runKernel(Vy,f,g);return p?le(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const TW=te({avgPool3dGrad_:jW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW={kernelName:fg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{filterSize:a,strides:o,pad:i,dimRoundingMode:c}=t;return{x:()=>TW(s,n,a,o,i,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(s,e,t,n,a){const o=W(s,"dy","avgPoolGrad"),i=W(e,"input","avgPoolGrad");V(i.rank===o.rank,()=>"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(o.rank,")"));let c=i,u=o,h=!1;i.rank===3&&(h=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(u.rank===4,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")),V(c.rank===4,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,"."));const p={dy:u,input:c},f={filterSize:t,strides:n,pad:a},g=oe.runKernel(By,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const AW=te({avgPoolGrad_:$W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EW={kernelName:pg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{filterSize:a,strides:o,pad:i}=t;return{x:()=>AW(s,n,a,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DW={kernelName:mg,inputsToSave:["a","b"],gradFunc:(s,e,t)=>{const[n,a]=e,{transposeA:o,transposeB:i}=t;return!o&&!i?{a:()=>_t(s,a,!1,!0),b:()=>_t(n,s,!0,!1)}:!o&&i?{a:()=>_t(s,a,!1,!1),b:()=>_t(s,n,!0,!1)}:o&&!i?{a:()=>_t(a,s,!1,!0),b:()=>_t(n,s,!1,!1)}:{a:()=>_t(a,s,!0,!0),b:()=>_t(s,n,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RW={kernelName:gg,gradFunc:(s,e,t)=>{const{blockShape:n,crops:a}=t;return{x:()=>Sx(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _W={kernelName:e7,gradFunc:(s,e,t)=>{const n=t,a=n.inputShape,o=n.shape,i=Array.from(o);for(let u=a.length-1;u>=0;u--)if(a[u]===o[u])i[u]=1;else if(a[u]!==1)throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(o,"]."));const c=[];for(let u=0;u<i.length;u++)i[u]>1&&c.push(u);return{x:()=>at(s,c,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OW={kernelName:Oh,gradFunc:s=>({x:()=>s.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FW={kernelName:Fh,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW={kernelName:Lh,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{clipValueMin:a,clipValueMax:o}=t;return{x:()=>$n(to(Yi(n,a),tc(n,o)),s,Bt(s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MW={kernelName:bg,inputsToSave:["x"],gradFunc:kI.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zW={kernelName:yg,saveAllInputs:!0,gradFunc:(s,e,t)=>{const n=e.map(u=>u.shape),{axis:a}=t,o=At(a,e[0].shape)[0],i=n.map(u=>u[o]);return ba(s,i,o).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PW={kernelName:vg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,{dilations:o,strides:i,pad:c,dataFormat:u}=t;return V(Fi(o),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")),{x:()=>Y2(n.shape,s,a,i,c,u),filter:()=>Cv(n,s,a.shape,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BW={kernelName:wg,inputsToSave:["dy","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,{strides:o,pad:i,dataFormat:c,dimRoundingMode:u}=t;return{dy:()=>Li(s,a,o,i,c,1,u),filter:()=>Cv(s,n,a.shape,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(s,e,t,n,a){let o=s;s.rank===4&&(o=le(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));let i=e;i.rank===4&&(i=le(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),V(o.rank===5,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(o.shape,".")),V(i.rank===5,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(i.shape,".")),V(t.length===5,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(t,".")),V(o.shape[4]===t[3],()=>"Error in conv3dDerFilter: depth of input ".concat(o.shape[4],") must ")+"match input depth in filter (".concat(t[3],".")),V(i.shape[4]===t[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must ")+"match output depth for filter (".concat(t[4],")."));const c={x:o,dy:i},u={strides:n,pad:a,filterShape:t};return oe.runKernel(qy,c,u)}const UW=te({conv3DBackpropFilter_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GW={kernelName:Ng,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const{dilations:n,strides:a,pad:o}=t;V(Fi(n),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(n,"'"));const[i,c]=e;return{x:()=>Bj(i.shape,s,c,a,o),filter:()=>UW(i,s,c.shape,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WW={kernelName:Mh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(fs(fv(qe(t,"float32"))),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HW={kernelName:zh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(mv(qe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qW={kernelName:Sg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a,exclusive:o,reverse:i}=t;return{x:()=>{const c=ws([a],n.rank);let u=J2(s,a,o,!i);return c!=null&&(u=Pt(u,c)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW={kernelName:Cg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const{dilations:n,strides:a,pad:o,dimRoundingMode:i}=t,c=n==null?[1,1]:n;V(Fi(c),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'"));const[u,h]=e;return V(u.rank===4,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(u.rank,".")),V(h.rank===4,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(h.rank,".")),V(u.shape[3]===h.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(u.shape[3],") must match the inChannels dimension ")+"in filter ".concat(h.shape[2],".")),V(Nn(a,c),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(c,"'.")),Gn("depthwiseConv2d",o,i),{x:()=>NT(u.shape,s,h,a,o,c,i),filter:()=>wT(u,s,h.shape,a,o,c,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XW={kernelName:kg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,o={x:n,filter:a,dy:s},i={x:n,filter:a,dy:s};return{x:()=>oe.runKernel(L1,o,t),filter:()=>oe.runKernel(M1,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW={kernelName:Bh,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e,n={dy:s,y:t};return{x:()=>oe.runKernel(n2,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZW={kernelName:Vh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e,n=ne(Bn(fs(is(t))),2/Math.sqrt(Math.PI));return{x:()=>ne(s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QW={kernelName:Uh,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JW={kernelName:Tg,inputsToSave:["input"],gradFunc:(s,e)=>{const[t]=e;return{input:()=>le(s,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eH={kernelName:Gh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,Bn(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH={kernelName:Wh,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH={kernelName:Hh,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{const c=Ze(s,qe(n,"float32")),u=en(t.shape,a);return u.length>0?le(at(c,u),t.shape):c},b:()=>{let c=ne(s,qe(t,"float32"));const u=en(n.shape,a);u.length>0&&(c=le(at(c,u),n.shape));const h=is(n);return fs(Ze(c,qe(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH={kernelName:Ig,inputsToSave:["x","mean","variance","scale"],gradFunc:(s,e,t)=>{const{varianceEpsilon:n}=t,[a,o,i,c]=e,u=c==null?ht(1):c,h=en(o.shape,a.shape),p=[];if(o.rank===1){for(let T=0;T<a.shape.length-1;++T)p.push(a.shape[T]);p.push(1)}const f=et(a,o),g=ne(s,u),b=dv(Fe(i,ht(n))),y=ne(ne(ne(b,b),b),ht(-.5));return{x:()=>o.rank===1?le(ne(ne(s,nr(le(b,[1,1,1,o.shape[0]]),p)),u),a.shape):le(ne(ne(s,b),u),a.shape),mean:()=>{let T=ne(ne(b,ht(-1)),g);return o.rank===1&&(T=at(T,h)),le(T,o.shape)},variance:()=>{let T=ne(ne(y,f),g);return o.rank===1&&(T=at(T,h)),le(T,o.shape)},scale:()=>{const T=ne(f,b);let $=ne(s,T);return o.rank===1&&($=at($,h)),le($,o.shape)},offset:()=>{let T=s;return o.rank===1&&(T=at(T,h)),le(T,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH={kernelName:$g,inputsToSave:["x","indices"],gradFunc:(s,e,t)=>{const[n,a]=e,{axis:o,batchDims:i}=t,c=At(o,n.shape)[0],u=(h,p,f)=>()=>{const g=h.shape,b=p.size,y=g.slice(0,c),v=y.length,w=g.slice(o,g.length).slice(1),N=w.length,C=dC(0,v),I=dC(v+1,v+1+N),T=hC([y,[b],w]),$=le(f,T),E=le(p,[b]),_=hC([[v],C,I]),L=Pt($,_);let O=wv(L,E,h.shape[c]);const z=Xi(_);return O=Pt(O,z),O};if(i===1){const h=n.shape[0],p=n.split(h,0);return{x:()=>va(p.map((b,y)=>u(b,a.slice(y,1),s.slice(y,1))())).reshape(n.shape),indices:()=>a}}else return{x:u(n,a,s),indices:()=>a}}};function dC(s,e){const t=[];for(let n=s;n<e;++n)t.push(n);return t}function hC(s){const e=[];for(let t=0;t<s.length;++t)for(let n=0;n<s[t].length;++n)e.push(s[t][n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH={kernelName:qh,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>Bt(t),b:()=>Bt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH={kernelName:Kh,gradFunc:s=>({x:()=>qe(s,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH={kernelName:Xh,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH={kernelName:Yh,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH={kernelName:Zh,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uH={kernelName:Eg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{alpha:a}=t,o=Ca(n,0);return{x:()=>$n(o,s,ne(s,a))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH={kernelName:Jh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,Fe(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH={kernelName:Qh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,qe(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH={kernelName:s7,inputsToSave:[],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t;return{logits:()=>{const i=Bn(n);return et(s,ne(at(s,a,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(s,e,t,n=5,a=1,o=1,i=.5){const c={x:s,y:e,dy:t},u={depthRadius:n,bias:a,alpha:o,beta:i};return oe.runKernel(d2,c,u)}const mH=te({localResponseNormalizationBackprop_:fH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH={kernelName:Lg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{depthRadius:o,bias:i,alpha:c,beta:u}=t;return{x:()=>mH(n,a,s,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jI(s,e,t,n){return e.rank<t.rank&&(e=le(e,Rs(e.shape,n))),s.rank<t.rank&&(s=le(s,Rs(s.shape,n))),{x:()=>ne(s,qe(jr(t,e),s.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pC={kernelName:Mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const n=t,{reductionIndices:a}=n,o=e[0],i=e[1],c=At(a,o.shape),u=jI(s,i,o,c);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xH={kernelName:ep,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>ne(s,qe(Yi(t,n),"float32")),b:()=>ne(s,qe(fh(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bH(s,e,t,n,a,o,i){const c=W(s,"dy","maxPool3dGrad"),u=W(e,"input","maxPool3dGrad"),h=W(t,"output","maxPool3dGrad");let p=c,f=u,g=h,b=!1;u.rank===4&&(b=!0,p=le(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),f=le(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),g=le(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),V(p.rank===5,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(p.rank,".")),V(f.rank===5,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")),V(g.rank===5,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(g.rank,".")),Gn("maxPool3dGrad",o,i);const y={dy:p,input:f,output:g},v={filterSize:n,strides:a,pad:o,dimRoundingMode:i},w=oe.runKernel(p2,y,v);return b?le(w,[w.shape[1],w.shape[2],w.shape[3],w.shape[4]]):w}const yH=te({maxPool3dGrad_:bH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH={kernelName:Pg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=t;return{x:()=>yH(s,n,a,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(s,e,t,n,a,o,i){const c=W(s,"dy","maxPoolGrad"),u=W(e,"input","maxPoolGrad"),h=W(t,"output","maxPoolGrad");V(u.rank===c.rank,()=>"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(c.rank,")")),V(c.rank===4,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,".")),V(u.rank===4,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")),Gn("maxPoolGrad",o,i);const p={dy:c,input:u,output:h},f={filterSize:n,strides:a,pad:o,dimRoundingMode:i};return oe.runKernel(h2,p,f)}const NH=te({maxPoolGrad_:wH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SH={kernelName:zg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{filterSize:o,strides:i,pad:c}=t;return{x:()=>NH(s,n,a,o,i,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH={kernelName:Bg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t,o=At(a,n.shape),c=pn(n.shape,o)[1],u=Ae(c);return{x:()=>{const p=n.shape.slice();o.forEach(b=>{p[b]=1});const f=le(s,p);return Ze(ne(f,xa(n.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kH={kernelName:Vg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const n=t,{axis:a}=n,[o,i]=e,c=At(a,o.shape),u=jI(s,i,o,c);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jH={kernelName:tp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>ne(s,qe(tc(t,n),"float32")),b:()=>ne(s,qe(Ca(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH={kernelName:Ug,inputsToSave:["x"],gradFunc:(s,e,t)=>{const n=e[0],{paddings:a}=t,o=a.map(i=>i[0]);return{x:()=>xt(s,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH={kernelName:sp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{const c=en(t.shape,a);return c.length>0?le(at(s,c),t.shape):s},b:()=>{const c=ne(s,fs($p(Ze(t,n)))),u=en(n.shape,a);return u.length>0?le(at(c,u),n.shape):c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H={kernelName:np,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{const c=ne(s,qe(n,"float32")),u=en(t.shape,a);return u.length>0?le(at(c,u),t.shape):c},b:()=>{const c=ne(s,qe(t,"float32")),u=en(n.shape,a);return u.length>0?le(at(c,u),n.shape):c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AH={kernelName:Gg,gradFunc:s=>({x:()=>fs(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH={kernelName:qg,inputsToSave:["indices"],gradFunc:(s,e)=>{const t=e[0];return{indices:()=>Ks(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DH={kernelName:Hg,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH={kernelName:Kg,saveAllInputs:!0,gradFunc:(s,e,t)=>{const{axis:n}=t;return ur(s,n).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC={kernelName:Xg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const n=e[0],{paddings:a}=t,o=a.map(i=>i[0]);return{x:()=>xt(s,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:ap,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(s,e)=>{const[t,n,a]=e,o=t,i=n,c=kt(o.shape,i.shape);return{a:()=>{const p=qe(i,"float32");let f=ne(s,ne(p,Oo(o,et(p,ht(1)))));const g=en(o.shape,c);return g.length>0&&(f=at(f,g)),le(f,o.shape)},b:()=>{const p=Ca(o,0),f=$n(p,Oa(o),Bt(o));let g=ne(s,ne(a,f));const b=en(i.shape,c);return b.length>0&&(g=at(g,b)),le(g,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OH={kernelName:Yg,inputsToSave:["x","alpha"],gradFunc:(s,e)=>{const[t,n]=e,a=Ca(t,0);return{x:()=>$n(a,s,ne(s,n)),alpha:()=>{let o=$n(a,Bt(s),ne(s,t));const i=en(n.shape,s.shape);return i.length>0&&(o=at(o,i)),le(o,n.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(s,e,t){const n=s.shape.slice();n[t]=1;const a=le(e,n),o=Mm(s,t,!0,!1),i=Mm(s,t,!0,!0),c=ne(o,i);return ne(a,c)}function LH(s,e,t){const n=s.shape.length,a=n-t.length,o=ws(t,n);let i=s;o!=null&&(i=Pt(s,o));const c=i.shape.slice(),h=c.splice(n-t.length,t.length).reduce((g,b)=>g*b,1);c.push(h);const p=i.reshape(c);let f=FH(p,e,a);if(f=f.reshape(i.shape),o!=null){const g=Xi(o);f=Pt(f,g)}return f}const MH={kernelName:Zg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t;let o=[];return a==null?o=n.shape.map((i,c)=>c):typeof a=="number"?o=[a]:o=a,{x:()=>LH(n,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH={kernelName:Ph,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{const c=Ze(s,qe(n,"float32")),u=en(t.shape,a);return u.length>0?le(at(c,u),t.shape):c},b:()=>{let c=ne(s,qe(t,"float32"));const u=en(n.shape,a);u.length>0&&(c=le(at(c,u),n.shape));const h=is(n);return fs(Ze(c,qe(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH={kernelName:rp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,fs(is(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BH={kernelName:ip,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e,n=ne(tc(t,6),Fu(t));return{x:()=>ne(s,qe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH={kernelName:op,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,qe(Fu(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH={kernelName:Qg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>le(s,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH={kernelName:ex,inputsToSave:["images"],gradFunc:(s,e,t)=>{const[n]=e,a={dy:s,images:n};return{images:()=>oe.runKernel(k2,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH={kernelName:Jg,inputsToSave:["images"],gradFunc:(s,e,t)=>{const[n]=e,a={dy:s,images:n};return{images:()=>oe.runKernel(C2,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HH={kernelName:tx,gradFunc:(s,e,t)=>{const{dims:n}=t,a=At(n,s.shape);return{x:()=>cr(s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qH={kernelName:lp,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH={kernelName:cp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>fs(Ze(s,ne(Oo(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XH={kernelName:sx,inputsToSave:["condition"],gradFunc:(s,e)=>{const[t]=e;return{condition:()=>qe(Bt(t),"float32"),t:()=>ne(s,qe(t,s.dtype)),e:()=>ne(s,qe(vx(t),s.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH={kernelName:up,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=Ca(t,ht(0)),a=ht(Lx),o=ht(Mx),i=ne(s,o),c=ne(ne(s,a),Bn(qe(t,"float32")));return $n(n,i,c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH={kernelName:fp,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,ne(t,et(ht(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QH={kernelName:pp,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH={kernelName:dp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(mx(qe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq={kernelName:hp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(Q2(qe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tq={kernelName:nx,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{begin:a,size:o}=t,i=n.shape,[c,u]=Ox(n,a,o),h=[];for(let p=0;p<s.rank;p++)h.push([c[p],i[p]-c[p]-u[p]]);return{x:()=>Zi(s,h)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sq={kernelName:ix,outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n]=e,{dim:a}=t,o=!0,i=ne(s,n);return{logits:()=>et(i,ne(at(i,[a],o),n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nq={kernelName:mp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,Cr(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC={kernelName:rx,gradFunc:(s,e,t)=>{const{blockShape:n,paddings:a}=t;return{x:()=>fx(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC={kernelName:ox,gradFunc:(s,e,t)=>{const{axis:n}=t;return{x:()=>Ts(s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:gp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,ne(wn(qe(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rq={kernelName:_2,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(s,ne(qe(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq={kernelName:xp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=ht(2);return{a:()=>ne(s,ne(a,et(t,n))),b:()=>ne(s,ne(a,et(n,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iq={kernelName:Np,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:bp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=kt(t.shape,n.shape);return{a:()=>{let c=s;const u=en(t.shape,a);return u.length>0&&(c=at(c,u)),le(c,t.shape)},b:()=>{let c=s;const u=en(n.shape,a);return u.length>0&&(c=at(c,u)),le(fs(c),n.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq={kernelName:ax,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,a=n.shape.slice(),{axis:o}=t;At(o,n.shape).forEach(h=>{a[h]=1});const c=le(s,a),u=ne(c,xa(n.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uq={kernelName:yp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Ze(s,is(mx(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq={kernelName:vp,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ne(et(ht(1),is(t)),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq={kernelName:wp,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{reps:a}=t;return{x:()=>{let i=Bt(n);if(n.rank===1)for(let c=0;c<a[0];++c)i=Fe(i,xt(s,[c*n.shape[0]],[n.shape[0]]));else if(n.rank===2)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)i=Fe(i,xt(s,[c*n.shape[0],u*n.shape[1]],[n.shape[0],n.shape[1]]));else if(n.rank===3)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)for(let h=0;h<a[2];++h)i=Fe(i,xt(s,[c*n.shape[0],u*n.shape[1],h*n.shape[2]],[n.shape[0],n.shape[1],n.shape[2]]));else if(n.rank===4)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)for(let h=0;h<a[2];++h)for(let p=0;p<a[3];++p)i=Fe(i,xt(s,[c*n.shape[0],u*n.shape[1],h*n.shape[2],p*n.shape[3]],[n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));else throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(n.rank," tensors yet."));return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pq={kernelName:du,gradFunc:(s,e,t)=>{const n=t,{perm:a}=n,o=Xi(a);return{x:()=>Pt(s,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fq={kernelName:cx,gradFunc:(s,e,t)=>{const n=t,{axis:a}=n;return{value:()=>va(s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq={kernelName:ux,inputsToSave:["segmentIds"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>gq(s,t)}}};function gq(s,e){const t=Wo(e,Bt(e)),n=Ap(s,t);let a=Yi(e,ht(0,"int32"));const o=n.rank-a.rank;for(let c=0;c<o;++c)a=xn(a,c+1);a=to(a,xa(n.shape,"bool"));const i=Bt(n);return $n(a,n,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xq={kernelName:dx,gradFunc:s=>({x:()=>Bt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bq=[kI,mW,gW,xW,bW,yW,vW,wW,NW,SW,CW,kW,IW,EW,DW,RW,_W,OW,FW,LW,MW,zW,BW,PW,GW,WW,HW,qW,KW,XW,zH,YW,ZW,QW,JW,eH,sH,tH,nH,aH,rH,oH,iH,lH,cH,uH,dH,hH,pH,gH,pC,pC,xH,vH,SH,CH,kH,jH,TH,IH,$H,AH,EH,DH,RH,fC,fC,_H,OH,MH,PH,BH,VH,UH,GH,WH,HH,qH,KH,XH,YH,ZH,QH,JH,eq,tq,sq,nq,mC,mC,gC,gC,aq,oq,rq,iq,lq,cq,uq,dq,hq,pq,fq,mq,xq];for(const s of bq)a7(s);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.abs=function(){return this.throwIfDisposed(),qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.acos=function(){return this.throwIfDisposed(),Nj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.acosh=function(){return this.throwIfDisposed(),Sj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.add=function(s){return this.throwIfDisposed(),Fe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.all=function(s,e){return this.throwIfDisposed(),q2(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.any=function(s,e){return this.throwIfDisposed(),Lm(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.argMax=function(s){return this.throwIfDisposed(),yu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.argMin=function(s){return this.throwIfDisposed(),Cj(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asScalar=function(){return this.throwIfDisposed(),V(this.size===1,()=>"The array must have only 1 element."),le(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asType=function(s){return this.throwIfDisposed(),qe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as1D=function(){return this.throwIfDisposed(),le(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as2D=function(s,e){return this.throwIfDisposed(),le(this,[s,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as3D=function(s,e,t){return this.throwIfDisposed(),le(this,[s,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as4D=function(s,e,t,n){return this.throwIfDisposed(),le(this,[s,e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as5D=function(s,e,t,n,a){return this.throwIfDisposed(),le(this,[s,e,t,n,a])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asin=function(){return this.throwIfDisposed(),kj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asinh=function(){return this.throwIfDisposed(),jj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atan=function(){return this.throwIfDisposed(),Tj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atan2=function(s){return this.throwIfDisposed(),Ij(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atanh=function(){return this.throwIfDisposed(),$j(this)};Ee().prototype.avgPool=function(s,e,t,n){return this.throwIfDisposed(),px(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.batchToSpaceND=function(s,e){return this.throwIfDisposed(),fx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.batchNorm=function(s,e,t,n,a){return this.throwIfDisposed(),kp(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.broadcastTo=function(s){return this.throwIfDisposed(),fu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cast=function(s){return this.throwIfDisposed(),qe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.ceil=function(){return this.throwIfDisposed(),Oj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.clipByValue=function(s,e){return this.throwIfDisposed(),sa(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.concat=function(s,e){return this.throwIfDisposed(),s instanceof os&&(s=[s]),Ts([this,...s],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv1d=function(s,e,t,n,a,o){return this.throwIfDisposed(),X2(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv2dTranspose=function(s,e,t,n,a){return this.throwIfDisposed(),Z2(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),Li(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cos=function(){return this.throwIfDisposed(),mx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cosh=function(){return this.throwIfDisposed(),Q2(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cumprod=function(s,e,t){return this.throwIfDisposed(),Mm(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cumsum=function(s,e,t){return this.throwIfDisposed(),J2(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.depthToSpace=function(s,e){return this.throwIfDisposed(),Uj(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.depthwiseConv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),jp(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.dilation2d=function(s,e,t,n,a){return this.throwIfDisposed(),Gj(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.divNoNan=function(s){return this.throwIfDisposed(),Wj(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.div=function(s){return this.throwIfDisposed(),Ze(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.dot=function(s){return this.throwIfDisposed(),Hj(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.elu=function(){return this.throwIfDisposed(),Tp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.equal=function(s){return this.throwIfDisposed(),jr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.erf=function(){return this.throwIfDisposed(),ev(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.euclideanNorm=function(s,e){return this.throwIfDisposed(),Xj(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.exp=function(){return this.throwIfDisposed(),Bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.expandDims=function(s){return this.throwIfDisposed(),xn(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.expm1=function(){return this.throwIfDisposed(),Yj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.fft=function(){return this.throwIfDisposed(),$x(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.flatten=function(){return this.throwIfDisposed(),le(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.floor=function(){return this.throwIfDisposed(),$p(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.floorDiv=function(s){return this.throwIfDisposed(),H2(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.gather=function(s,e,t){return this.throwIfDisposed(),Ap(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.greaterEqual=function(s){return this.throwIfDisposed(),Yi(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.greater=function(s){return this.throwIfDisposed(),Ca(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.ifft=function(){return this.throwIfDisposed(),xh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.irfft=function(){return this.throwIfDisposed(),xv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isFinite=function(){return this.throwIfDisposed(),Zj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isInf=function(){return this.throwIfDisposed(),Qj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isNaN=function(){return this.throwIfDisposed(),Jj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.leakyRelu=function(s){return this.throwIfDisposed(),xx(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.lessEqual=function(s){return this.throwIfDisposed(),tc(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.less=function(s){return this.throwIfDisposed(),fh(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.localResponseNormalization=function(s,e,t,n){return this.throwIfDisposed(),eT(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSigmoid=function(){return this.throwIfDisposed(),tT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSoftmax=function(s){return this.throwIfDisposed(),nv(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSumExp=function(s,e){return this.throwIfDisposed(),yx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.log=function(){return this.throwIfDisposed(),Oa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.log1p=function(){return this.throwIfDisposed(),bx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalAnd=function(s){return this.throwIfDisposed(),to(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalNot=function(){return this.throwIfDisposed(),vx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalOr=function(s){return this.throwIfDisposed(),av(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalXor=function(s){return this.throwIfDisposed(),sT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.matMul=function(s,e,t){return this.throwIfDisposed(),_t(this,s,e,t)};Ee().prototype.maxPool=function(s,e,t,n){return this.throwIfDisposed(),wx(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.max=function(s,e){return this.throwIfDisposed(),ir(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.maximum=function(s){return this.throwIfDisposed(),Wo(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mean=function(s,e){return this.throwIfDisposed(),js(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.min=function(s,e){return this.throwIfDisposed(),ph(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.minimum=function(s){return this.throwIfDisposed(),ql(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mirrorPad=function(s,e){return this.throwIfDisposed(),aT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mod=function(s){return this.throwIfDisposed(),rT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mul=function(s){return this.throwIfDisposed(),ne(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.neg=function(){return this.throwIfDisposed(),fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.norm=function(s,e,t){return this.throwIfDisposed(),Ip(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.notEqual=function(s){return this.throwIfDisposed(),wu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.oneHot=function(s,e=1,t=0){return this.throwIfDisposed(),ov(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.onesLike=function(){return this.throwIfDisposed(),Fa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.pad=function(s,e){return this.throwIfDisposed(),Zi(this,s,e)};Ee().prototype.pool=function(s,e,t,n,a,o){return this.throwIfDisposed(),oT(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.pow=function(s){return this.throwIfDisposed(),Oo(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.prelu=function(s){return this.throwIfDisposed(),Cx(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.prod=function(s,e){return this.throwIfDisposed(),iT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reciprocal=function(){return this.throwIfDisposed(),lT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.relu=function(){return this.throwIfDisposed(),ro(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.relu6=function(){return this.throwIfDisposed(),cv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reshapeAs=function(s){return this.throwIfDisposed(),le(this,s.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reshape=function(s){return this.throwIfDisposed(),le(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.resizeBilinear=function(s,e,t){return this.throwIfDisposed(),kT(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.resizeNearestNeighbor=function(s,e,t){return this.throwIfDisposed(),jT(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reverse=function(s){return this.throwIfDisposed(),cr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.rfft=function(){return this.throwIfDisposed(),Ax(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.round=function(){return this.throwIfDisposed(),uv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.rsqrt=function(){return this.throwIfDisposed(),dv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.selu=function(){return this.throwIfDisposed(),hv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.separableConv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),pv(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sigmoid=function(){return this.throwIfDisposed(),Cr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sign=function(){return this.throwIfDisposed(),cT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sin=function(){return this.throwIfDisposed(),fv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sinh=function(){return this.throwIfDisposed(),mv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.slice=function(s,e){return this.throwIfDisposed(),xt(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.softmax=function(s){return this.throwIfDisposed(),Ix(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.softplus=function(){return this.throwIfDisposed(),Ou(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.spaceToBatchND=function(s,e){return this.throwIfDisposed(),Sx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.split=function(s,e){return this.throwIfDisposed(),ba(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sqrt=function(){return this.throwIfDisposed(),wn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.square=function(){return this.throwIfDisposed(),is(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.squaredDifference=function(s){return this.throwIfDisposed(),bv(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.squeeze=function(s){return this.throwIfDisposed(),Es(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.stack=function(s,e){this.throwIfDisposed();const t=s instanceof os?[this,s]:[this,...s];return va(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.step=function(s){return this.throwIfDisposed(),Fu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.stridedSlice=function(s,e,t,n,a,o,i,c){return this.throwIfDisposed(),uT(this,s,e,t,n,a,o,i,c)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sub=function(s){return this.throwIfDisposed(),et(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sum=function(s,e){return this.throwIfDisposed(),at(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tan=function(){return this.throwIfDisposed(),dT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tanh=function(){return this.throwIfDisposed(),Hl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tile=function(s){return this.throwIfDisposed(),nr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toBool=function(){return this.throwIfDisposed(),qe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toFloat=function(){return this.throwIfDisposed(),qe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toInt=function(){return this.throwIfDisposed(),qe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.topk=function(s,e){return this.throwIfDisposed(),fT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.transpose=function(s){return this.throwIfDisposed(),Pt(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unique=function(s){return this.throwIfDisposed(),mT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unsortedSegmentSum=function(s,e){return this.throwIfDisposed(),wv(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unstack=function(s){return this.throwIfDisposed(),ur(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.where=function(s,e){return this.throwIfDisposed(),$n(s,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.zerosLike=function(){return this.throwIfDisposed(),Bt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,qr.prototype)}}class ar extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ar.prototype)}}class de extends Error{constructor(e){super(e),Object.setPrototypeOf(this,de.prototype)}}class It extends Error{constructor(e){super(e),Object.setPrototypeOf(this,It.prototype)}}class aw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,aw.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TI{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yl(s,e){if(Array.isArray(s)){let t=[];for(let n=0;n<e;n++)t=t.concat(s);return t}else{const t=new Array(e);return t.fill(s),t}}function Kr(s,e){if(!s)throw new aw(e)}function xC(s,e){let t=0;for(const n of s)n===e&&t++;return t}function Jn(s){return s.length===1?s[0]:s}function Zt(s){return Array.isArray(s)?s:[s]}function Ao(s){const t=s.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function El(s){return s.length<=1||s.indexOf("_")===-1?s:s.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Qa={};function rw(s){if(s==null)return null;const e={};return e.className=s.getClassName(),e.config=s.getConfig(),e}function my(s){if(!(s==null||typeof s!="object"))if(Array.isArray(s))s.forEach(e=>my(e));else{const e=Object.keys(s);for(const t of e){const n=s[t];n!=null&&typeof n=="object"&&(!Array.isArray(n)&&n.type==="ndarray"&&typeof n.value=="number"?s[t]=n.value:my(n))}}}function _p(s,e={},t={},n="object",a=!1){if(typeof s=="string"){const o=s;let i;if(o in t)i=t[o];else if(o in Qa)i=Qa[o];else if(i=e[o],i==null)throw new de("Unknown ".concat(n,": ").concat(s,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(n," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(n," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}else{const o=s;if(o.className==null||o.config==null)throw new de("".concat(n,": Improper config format: ")+"".concat(JSON.stringify(o),".\n")+"'className' and 'config' must set.");const i=o.className;let c,u;if(i in t?[c,u]=t[i]:i in Qa?[c,u]=Qa.className:i in e&&([c,u]=e[i]),c==null)throw new de("Unknown ".concat(n,": ").concat(i,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(n," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(n," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(u!=null){const h={};for(const b of Object.keys(Qa))h[b]=Qa[b];for(const b of Object.keys(t))h[b]=t[b];const p=o.config;p.customObjects=h;const f=Object.assign({},Qa);for(const b of Object.keys(t))Qa[b]=t[b];my(o.config);const g=u(c,o.config,t,a);return Qa=Object.assign({},f),g}else{const h=Object.assign({},Qa);for(const f of Object.keys(t))Qa[f]=t[f];const p=new c(o.config);return Qa=Object.assign({},h),p}}}function yq(s,e){return s<e?-1:s>e?1:0}function im(s,e){return-1*yq(s,e)}function Ei(s){if(s==null)return s;const e=[];for(const t of s)e.indexOf(t)===-1&&e.push(t);return e}function vq(s){if(s==null)throw new de("Invalid value in obj: ".concat(JSON.stringify(s)));for(const e in s)if(s.hasOwnProperty(e))return!1;return!0}function ac(s,e,t){if(t!=null&&s.indexOf(t)<0)throw new de("".concat(t," is not a valid ").concat(e,".  Valid values are ").concat(s," or null/undefined."))}function ow(s,e,t=0,n=1/0){return Kr(t>=0),Kr(n>=t),Array.isArray(s)&&s.length>=t&&s.length<=n&&s.every(a=>typeof a===e)}function dn(s,e){Array.isArray(s)?(V(s.length>0,()=>"".concat(e," is unexpectedly an empty array.")),s.forEach((t,n)=>dn(t,"element ".concat(n+1," of ").concat(e)))):V(Number.isInteger(s)&&s>0,()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(II(s),"."))}function II(s){return s===null?"null":Array.isArray(s)?"["+s.map(e=>II(e)).join(",")+"]":typeof s=="string"?'"'.concat(s,'"'):"".concat(s)}function wq(s,e,t){let n=t!=null?t():Qn(),a;return(...i)=>{const c=t!=null?t():Qn();return c-n<e||(n=c,a=s(...i)),a}}function $I(s){return s==="relu"?"relu":s==="linear"?"linear":s==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Nq=0;function AI(){return Nq++}const lm={};function zx(s=""){return s in lm||(lm[s]=0),lm[s]+=1,s+lm[s].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Sq=["channelsFirst","channelsLast"],Cq=["nearest","bilinear"],kq=["valid","same","causal"],jq=["max","avg"],Tq=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const au=new Map;function Os(s){ac(Sq,"DataFormat",s)}function Iq(s){ac(Cq,"InterpolationFormat",s)}function Ma(s){ac(kq,"PaddingMode",s)}function EI(s){ac(jq,"PoolMode",s)}const uh=[],bC="/";function Fl(s,e){uh.push(s);try{const t=e();return uh.pop(),t}catch(t){throw uh.pop(),t}}function $q(){return uh.length===0?"":uh.join(bC)+bC}function DI(s){if(!_I(s))throw new Error("Not a valid tensor name: '"+s+"'");return $q()+s}function RI(s){if(!_I(s))throw new Error("Not a valid tensor name: '"+s+"'");au.has(s)||au.set(s,0);const e=au.get(s);if(au.set(s,au.get(s)+1),e>0){const t="".concat(s,"_").concat(e);return au.set(t,1),t}else return s}const Aq=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function _I(s){return!!s.match(Aq)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Eq(s){return s===parseInt(s.toString(),10)}function Di(s,e,t){e==null&&(e=0),t==null&&(t=s.length);let n=1;for(let a=e;a<t;++a)n*=s[a];return n}function Su(s){if(s.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<s.length;t++){const n=s[t];n<e&&(e=n)}return e}function zi(s){if(s.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<s.length;t++){const n=s[t];n>e&&(e=n)}return e}function Tr(s,e){if(e<s)throw new de("end (".concat(e,") < begin (").concat(s,") is forbidden."));const t=[];for(let n=s;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let v1;function Xs(){return v1==null&&(v1=oj().epsilon()),v1}function Ir(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jr(s,e){return qe(s,e)}function Op(s,e=-1){const t=s.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),le(s,t)}function Dq(s,e){return me(()=>{if(s.shape.length!==2)throw new de("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(s.shape.length," tensor."));const t=Op(s,1);return gy(t,[1,e,1])})}function Rq(s){const e=[Di(s.shape)];return le(s,e)}function _q(s){if(s.rank<=1)throw new de("batchFlatten requires a minimum rank of 2. Got rank: ".concat(s.rank,"."));const e=[s.shape[0],Di(s.shape,1)];return le(s,e)}function Ll(s,e,t){return me(()=>{switch(s.rank){case 1:return jx(s,e,t);case 2:return gv(s,[e,0],[t,s.shape[1]]);case 3:return Tx(s,[e,0,0],[t,s.shape[1],s.shape[2]]);case 4:return gh(s,[e,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3]]);case 5:return xt(s,[e,0,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3],s.shape[4]]);case 6:return xt(s,[e,0,0,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3],s.shape[4],s.shape[5]]);default:throw new de("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function w1(s,e,t){return me(()=>{switch(s.rank){case 1:return jx(s,e,t);case 2:return gv(s,[0,e],[s.shape[0],t]);case 3:return Tx(s,[0,0,e],[s.shape[0],s.shape[1],t]);case 4:return gh(s,[0,0,0,e],[s.shape[0],s.shape[1],s.shape[2],t]);default:throw new de("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function cm(s,e,t,n){return me(()=>{switch(s.rank){case 1:return jx(s,e,t);case 2:switch(n){case 1:return Ll(s,e,t);case 2:return w1(s,e,t);default:throw new de("The axis is not within the rank of the tensor "+"".concat(n))}case 3:switch(n){case 1:return Ll(s,e,t);case 2:return Tx(s,[0,e,0],[s.shape[0],t,s.shape[2]]);case 3:return w1(s,e,t);default:throw new de("The axis is not within the rank of the tensor "+"".concat(n))}case 4:switch(n){case 1:return Ll(s,e,t);case 2:return gh(s,[0,e,0,0],[s.shape[0],t,s.shape[2],s.shape[3]]);case 3:return gh(s,[0,0,e,0],[s.shape[0],s.shape[1],t,s.shape[3]]);case 4:return w1(s,e,t);default:throw new de("The axis is not within the rank of the tensor "+"".concat(n))}default:throw new de("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function iw(s,e=-1){let t;return e<0&&(t=s[0].rank,t!==0?e=t:e=0),e===s[0].rank&&(e=-1),Ts(s,e)}function yC(s,e){switch(s.rank){case 1:return Fj([s,e]);case 2:return Lj([s,e],0);case 3:return Mj([s,e],0);case 4:return zj([s,e],0);default:throw new de("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(s.rank))}}function gy(s,e){if(Array.isArray(e)||(e=[e]),s.rank!==e.length)throw new de("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(s.rank,")"));return nr(s,e)}function Px(s,e=0,t=1,n,a){return lv(s,e,t,n,a)}function eo(s,e,t,n){if(s.rank<2||e.rank<2)throw new It("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(s.shape," and y shape = ").concat(e.shape));if(e.rank>=3){const a=s.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(a!==o)throw new It("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(s.shape," and ")+" y shape = ".concat(e.shape))}if(s.rank===2&&e.rank===2)return ey({a:s,b:e,transposeA:!1,transposeB:!1,bias:n?xy(s.rank,n,Ir()):null,activation:t});{const a=s.shape.slice(),o=a.pop();s=le(s,[-1,o]);const i=e.shape.slice(),c=i.pop(),u=i.pop(),h=[...i,c],p=Array.from({length:e.rank},(y,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=le(Pt(e,p),[u,-1]);const f=[...a,...h];return le(ey({a:s,b:e,transposeA:!1,transposeB:!1,bias:n?xy(s.rank,n,Ir()):null,activation:t}),f)}}function OI(s,e,t){return me(()=>(Array.isArray(e)?e=Bs(e,"int32"):e=qe(e,"int32"),Ap(s,e,t)))}function Fp(s){return ne(s,s)}function xy(s,e,t){const n=e.shape;if(e.rank!==1&&e.rank!==s)throw new de("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(s));if(s===5){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1,1,1]):le(e,[1,n[3],n[0],n[1],n[2]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,1,1,n[0]]):le(e,[1].concat(n))}else if(s===4){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1,1]):le(e,[1,n[2],n[0],n[1]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,1,n[0]]):le(e,[1].concat(n))}else if(s===3){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1]):le(e,[1,n[1],n[0]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,n[0]]):le(e,[1].concat(n))}else if(s<3)return e;throw new de("Unsupported input rank by biasAdd: ".concat(e.rank))}function Er(s,e,t){return me(()=>(t==null&&(t=Ir()),Os(t),Fe(s,xy(s.rank,e,t))))}function Oq(s,e=1){if(e!==1)throw new It("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return Tp(s)}function Fq(s){return me(()=>Ze(s,Fe(qs(s),1)))}function FI(s,e,t,n){return me(()=>bT(s,e,t,n))}function Lq(s){return me(()=>{const e=Fe(.5,ne(.2,s));return sa(e,0,1)})}function Lp(s,e,t=!1){return t?s():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Mq=["fanIn","fanOut","fanAvg"],zq=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pq(s){ac(Mq,"FanMode",s)}function Bq(s){ac(zq,"Distribution",s)}class hr extends Mu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class LI extends hr{apply(e,t){return Ks(e,t)}}LI.className="Zeros";Pe(LI);class lw extends hr{apply(e,t){return xa(e,t)}}lw.className="Ones";Pe(lw);class MI extends hr{constructor(e){if(super(),typeof e!="object")throw new de("Expected argument of type ConstantConfig but got ".concat(e));if(e.value===void 0)throw new de("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return me(()=>ne(ht(this.value),xa(e,t)))}getConfig(){return{value:this.value}}}MI.className="Constant";Pe(MI);class zI extends hr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return sc(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}zI.className="RandomUniform";Pe(zI);class PI extends hr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new It("randomNormal does not support dType ".concat(t,"."));return Px(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}PI.className="RandomNormal";Pe(PI);class BI extends hr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new It("truncatedNormal does not support dType ".concat(t,"."));return vv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}BI.className="TruncatedNormal";Pe(BI);class VI extends hr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return me(()=>{if(e.length!==2||e[0]!==e[1])throw new de("Identity matrix initializer can only be used for 2D square matrices.");return ne(this.gain,sv(e[0]))})}getConfig(){return{gain:this.gain}}}VI.className="Identity";Pe(VI);function Vq(s,e="channelsLast"){let t,n;if(Os(e),s.length===2)t=s[0],n=s[1];else if([3,4,5].indexOf(s.length)!==-1){if(e==="channelsFirst"){const a=Di(s,2);t=s[1]*a,n=s[0]*a}else if(e==="channelsLast"){const a=Di(s,0,s.length-2);t=s[s.length-2]*a,n=s[s.length-1]*a}}else{const a=Di(s);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}class wa extends hr{constructor(e){if(super(),e.scale<0)throw new de("scale must be a positive float. Got: ".concat(e.scale));this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Pq(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Bq(this.distribution),this.seed=e.seed}apply(e,t){const n=Vq(e),a=n[0],o=n[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,a):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(a+o)/2),this.distribution==="normal"){const c=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new It("".concat(this.getClassName()," does not support dType ").concat(t,"."));return vv(e,0,c,t,this.seed)}else{const c=Math.sqrt(3*i);return sc(e,-c,c,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}wa.className="VarianceScaling";Pe(wa);class cw extends wa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wa.className}}cw.className="GlorotUniform";Pe(cw);class uw extends wa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wa.className}}uw.className="GlorotNormal";Pe(uw);class dw extends wa{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wa.className}}dw.className="HeNormal";Pe(dw);class hw extends wa{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wa.className}}hw.className="HeUniform";Pe(hw);class pw extends wa{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wa.className}}pw.className="LeCunNormal";Pe(pw);class fw extends wa{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wa.className}}fw.className="LeCunUniform";Pe(fw);class UI extends hr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return me(()=>{if(e.length<2)throw new It("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError("Unsupported data type ".concat(t,"."));t=t;const n=Ae(e.slice(0,-1)),a=e[e.length-1],o=n*a;o>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(o,") elements: ")+"Slowness may result.");const i=[Math.max(a,n),Math.min(a,n)],c=Px(i,0,1,t,this.seed),u=TT.qr(c,!1);let h=u[0];const f=u[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return h=ne(h,f.sign()),n<a&&(h=h.transpose()),ne(ht(this.gain),h.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}UI.className="Orthogonal";Pe(UI);const vC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function wC(s,e={}){return _p(s,sr.getMap().classNameMap,e,"initializer")}function vs(s){return rw(s)}function ms(s){if(typeof s=="string"){const e=s in vC?vC[s]:s;if(e==="GlorotNormal")return new uw;if(e==="GlorotUniform")return new cw;if(e==="HeNormal")return new dw;if(e==="HeUniform")return new hw;if(e==="LeCunNormal")return new pw;if(e==="LeCunUniform")return new fw;{const t={};return t.className=e,t.config={},wC(t)}}else return s instanceof hr?s:wC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function by(s){return Array.isArray(s)&&Array.isArray(s[0])}function Vm(s){return s.length===0?[]:Array.isArray(s[0])?s:[s]}function bt(s){let e;if(Array.isArray(s)){if(s.length!==1)throw new de("Expected Tensor length to be 1; got ".concat(s.length));e=s[0]}else e=s;return e}function qt(s){if(Array.isArray(s)&&Array.isArray(s[0])){if(s.length===1)return s=s,s[0];throw new de("Expected exactly 1 Shape; got ".concat(s.length))}else return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Um(s){let e=0;for(const t of s)t.shape.length===0?e+=1:e+=t.shape.reduce((n,a)=>n*a);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const NC="Variable";class Uq{constructor(e,t="float32",n=NC,a=!0,o=null){this.dtype=t==null?"float32":t,this.shape=e.shape,this.id=AI(),n=n==null?NC:n,this.originalName=DI(n),this.name=RI(this.originalName),this.trainable_=a,this.constraint=o,this.val=gT(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Gq(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Gq(s,e){if(s.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(s.shape)+" vs. "+JSON.stringify(e.shape))}function yy(s){return s.map(e=>e.read())}function mw(s){s.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ys{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class so{constructor(e,t,n,a,o,i,c){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=o,this.outputTensorIndex=c,this.id=AI(),i!=null&&(this.originalName=DI(i),this.name=RI(this.originalName)),this.rank=t.length}}let Wq=0;class Bx{constructor(e,t){this.callArgs=t,this.id=Wq++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Hq=0;class Et extends Mu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Hq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const n=this.getClassName();t=Ao(n)+"_"+zx(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),n=[o].concat(e.inputShape)}this.batchInputShape=n;let a=e.dtype;a==null&&(a=e.inputDType),a==null&&(a="float32"),this.dtype=a}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new ar("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new de("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return Jn(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Jn(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new qr("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new qr("Layer ".concat(this.name)+" is not connected, no input to return.");return Jn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new qr("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new qr("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Jn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Zt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const n=Zt(this.inputSpec);if(t.length!==n.length)throw new de("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let a=0;a<t.length;a++){const o=t[a],i=n[a];if(i==null)continue;const c=o.rank;if(i.ndim!=null&&c!==i.ndim)throw new de("Input ".concat(a," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(c));if(i.maxNDim!=null&&c>i.maxNDim)throw new de("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(c));if(i.minNDim!=null&&c<i.minNDim)throw new de("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(c,"."));if(i.dtype!=null&&o.dtype!==i.dtype)throw new de("Input ".concat(a," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(o.dtype,"."));if(i.axes){const u=o.shape;for(const h in i.axes){const p=Number(h),f=i.axes[h],g=p>=0?u[p]:u[u.length+p];if(f!=null&&[f,null].indexOf(g)===-1)throw new de("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(p," of input shape to ")+"have value ".concat(f," but got shape ").concat(u,"."))}}if(i.shape!=null)for(let u=0;u<i.shape.length;++u){const h=i.shape[u],p=o.shape[u];if(h!=null&&p!=null&&h!==p)throw new de("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(o.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=Zt(e),a=Xq(e),o=Yq(e);if(a===o)throw new de("Arguments to apply() must be all SymbolicTensors or all Tensors");return Fl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const c of Zt(e))i.push(c.shape);this.build(Jn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,i);const c=Zt(i),u=[];for(let h of c)n.indexOf(h)!==-1&&(h=h.clone()),u.push(h);if(i=Jn(u),this.activityRegularizer!=null)throw new It("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=qq(e),c=this.computeOutputShape(i);let u;const h=Kq(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),c!=null&&c.length>0&&Array.isArray(c[0])?u=c.map((p,f)=>new so(h,p,this,Zt(e),t,this.name,f)):u=new so(h,c,this,Zt(e),t,this.name),this.addInboundNode(e,u,null,null,i,c,t),this._refCount++,this.activityRegularizer!=null)throw new It("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{n!=null&&e[a]!=null&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new qr("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new qr("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new ar("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Um(this.weights)}build(e){this.built=!0}getWeights(e=!1){return yy(e?this.trainableWeights:this.weights)}setWeights(e){me(()=>{const t=this.weights;if(t.length!==e.length)throw new de('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(t.length===0)return;const n=[],a=yy(t);for(let o=0;o<a.length;++o){const i=a[o],c=t[o],u=e[o];if(!Mt(i.shape,u.shape))throw new de("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(u.shape));n.push([c,u])}mw(n)})}addWeight(e,t,n,a,o,i,c,u){if(this._addedWeightNames.indexOf(e)!==-1)throw new de("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(a=u!=null?u():ms("zeros"));const h=a.apply(t,n),p=new Uq(h,n,e,i,c);return h.dispose(),o!=null&&this.addLoss(()=>o.apply(p.read())),i==null&&(i=!0),i?this._trainableWeights.push(p):this._nonTrainableWeights.push(p),p}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Zt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")});else throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const a=this.computeMask(e,n),o=Zt(t),i=Zt(a);if(o.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(o.length," tensors ")+"but ".concat(o.length," masks for those tensors"));for(let c=0;c<o.length;c++)o[c].kerasMask=i[c]}addInboundNode(e,t,n,a,o,i,c=null){const u=Zt(e);t=Zt(t),n=Zt(n),a=Zt(a),o=Vm(o),i=Vm(i);const h=[],p=[],f=[];for(const g of u)h.push(g.sourceLayer),p.push(g.nodeIndex),f.push(g.tensorIndex);new Bx({outboundLayer:this,inboundLayers:h,nodeIndices:p,tensorIndices:f,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:o,outputShapes:i},c);for(let g=0;g<t.length;g++)t[g].sourceLayer=this,t[g].nodeIndex=this.inboundNodes.length-1,t[g].tensorIndex=g}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function qq(s){s=Zt(s);const e=[];for(const t of s)e.push(t.shape);return Jn(e)}function Kq(s){return"float32"}function GI(s,e,t){if((e==null||t!=null&&t>0)&&(e=s.sourceLayer,t=s.nodeIndex),e.inboundNodes.length===0)return[s];{const n=e.inboundNodes[t];if(n.inboundLayers.length===0)return n.inputTensors;{const a=[];for(let o=0;o<n.inboundLayers.length;o++){const i=n.inputTensors[o],c=n.inboundLayers[o],u=n.nodeIndices[o],h=GI(i,c,u);for(const p of h)a.indexOf(p)===-1&&a.push(p)}return a}}}function Xq(s){let e=!0;for(const t of Zt(s))if(!(t instanceof so)){e=!1;break}return e}function Yq(s){let e=!0;for(const t of Zt(s))if(t instanceof so){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mp extends Et{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:zx("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new de("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new de("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new de("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const a=new so(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new Bx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new de("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Mp.className="InputLayer";Pe(Mp);function Zq(s){if(s.batchShape==null&&s.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(s.batchShape!=null&&s.shape!=null)throw new de("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=s.batchShape;s.shape!=null&&e==null&&(e=[null].concat(s.shape));let t=s.dtype;return t==null&&(t="float32"),new Mp({batchInputShape:e,name:s.name,dtype:t,sparse:s.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qq(s,e){if(s.dtype==null||s.dtype===e.dtype)return e;try{return qe(e,s.dtype)}catch(t){throw new de("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(s.name,"' (").concat(s.dtype,")."))}}class Ti{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Ti)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Qq(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new de("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof so){if(this.id2Value[e.id]==null)throw new de("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new de("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof so){if(this.id2Value[e.id]==null)throw new de("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new de("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Ct(this.id2Mask)}}const Gm=new TI,Wm=new TI;function Jq(s){Gm!=null&&Gm.setMaxEntries(s),Wm!=null&&Wm.setMaxEntries(s)}function oh(s,e,t,n){const a=t==null?!1:t.training,o=Array.isArray(s),i=o?s:[s],c=i.map(y=>y.name),u=[],h=e.names();for(const y of c)h.indexOf(y)!==-1?u.push(e.getValue(y)):u.push(null);const p=c.join(",")+"|"+e.names().sort().join(",");let f=Gm.get(p),g;if(f==null){const y=eK(i,e);f=y.sorted,g=y.recipientCounts,Gm.put(p,f),Wm.put(p,g)}g={},a||Object.assign(g,Wm.get(p));const b=new Ti(e);for(let y=0;y<f.length;++y){const v=f[y],w=v.sourceLayer;if(w instanceof Mp)continue;const N=[],C=[],I=[];let T=!1;for(const O of v.inputs){const z=b.getValue(O),A=b.getMask(O);N.push(z),C.push(A),A!=null&&(T=!0),a||(g[O.name]--,g[O.name]===0&&!e.hasKey(O)&&c.indexOf(O.name)===-1&&!z.isDisposed&&O.sourceLayer.stateful!==!0&&I.push(z))}T&&(t=t||{},t.mask=C[0]);const $=Zt(w.apply(N,t));let E=null;w.supportsMasking&&(E=w.computeMask(N,C));const _=sK(v),L=Array.isArray(_)?_:[_];for(let O=0;O<L.length;++O){b.hasKey(L[O])||b.add(L[O],$[O],Array.isArray(E)?E[0]:E);const z=c.indexOf(L[O].name);z!==-1&&(u[z]=$[O])}a||Ct(I)}return b.disposeMasks(),o?u:u[0]}function eK(s,e){V(s!=null&&s.length>0,()=>"Expected at least one fetch, got none");let t=[],n={};if(s.length===1){const a=SC(s[0],e);t=a.sorted,n=a.recipientMap}else{const a=new Set;for(const o of s){const{sorted:i,recipientMap:c}=SC(o,e);for(const u of i)a.has(u.name)||(t.push(u),a.add(u.name));for(const u in c)n[u]==null&&(n[u]=new Set),c[u].forEach(h=>n[u].add(h))}}return{sorted:t,recipientCounts:tK(n)}}function tK(s){const e={};for(const t in s)e[t]=s[t].size;return e}function SC(s,e){const t=new Set,n=[],a={};for(const c of e.names())t.add(c);const o=[],i=[];for(o.push(s);o.length>0;){const c=o[o.length-1];if(t.has(c.name)){o.pop();continue}const u=i[i.length-1]===o.length-1;if(c.inputs.length===0||u)o.pop(),n.push(c),t.add(c.name),u&&i.pop();else{i.push(o.length-1);for(const h of c.inputs)a[h.name]==null&&(a[h.name]=new Set),a[h.name].add(c.name),!t.has(h.name)&&o.push(h)}}return{sorted:n,recipientMap:a}}function sK(s){let e;if(s.sourceLayer.inboundNodes.length===1)e=s.sourceLayer.output;else{let t=null;for(let n=0;n<s.sourceLayer.inboundNodes.length;++n)for(const a of s.sourceLayer.inboundNodes[n].outputTensors)if(a.id===s.id){t=n;break}e=s.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nK=Se();nK.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Jq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gw(s,e){return me(()=>wn(at(ne(s,s),e,!0)))}class zp extends Mu{getConfig(){return{}}}class WI extends zp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>{const t=gw(e,this.axis),n=sa(t,0,this.maxValue);return ne(e,Ze(n,Fe(Xs(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}WI.className="MaxNorm";Pe(WI);class HI extends zp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>Ze(e,Fe(Xs(),gw(e,this.axis))))}getConfig(){return{axis:this.axis}}}HI.className="UnitNorm";Pe(HI);class qI extends zp{apply(e){return ro(e)}}qI.className="NonNeg";Pe(qI);class KI extends zp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>{const t=gw(e,this.axis),n=Fe(ne(this.rate,sa(t,this.minValue,this.maxValue)),ne(1-this.rate,t));return ne(e,Ze(n,Fe(Xs(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}KI.className="MinMaxNorm";Pe(KI);const CC={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Qs(s){return rw(s)}function kC(s,e={}){return _p(s,sr.getMap().classNameMap,e,"constraint")}function Js(s){if(s==null)return null;if(typeof s=="string"){const t={className:s in CC?CC[s]:s,config:{}};return kC(t)}else return s instanceof zp?s:kC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function jl(s){if(s==null)return;const e=[],t=[],n=[];for(const a in s){const o=s[a];if(typeof o!="number"){const i=o;e.push(i.data()),t.push(a),n.push(i)}}if(e.length>0){const a=await Promise.all(e);for(let o=0;o<a.length;++o)s[t[o]]=a[o][0];Ct(n)}}function XI(s){if(s!=null)for(const e in s){const t=s[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var jC;(function(s){s[s.SILENT=0]="SILENT",s[s.VERBOSE=1]="VERBOSE"})(jC||(jC={}));const aK=125;class bh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class rK{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class oK extends bh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const n=t.size==null?0:t.size;this.seen+=n;for(const a in t){const o=t[a];if(typeof o=="number")this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+o*n;else{let i;a in this.totals?i=this.totals[a]:this.totals[a]=0;const c=me(()=>Fe(this.totals[a],ne(o,n)));this.totals[a]=c,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:me(()=>{const a=ne(Ze(1,this.seen),this.totals[n]);t[n]=a,this.totals[n].dispose(),un(t[n])}))}}class iK extends bh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const o in this.history){const i=this.history[o];for(let c=0;c<i.length;++c)if(typeof i[c]!="number"){const u=i[c];e.push(u.data()),t.push(o),n.push(c)}}const a=await Promise.all(e);for(let o=0;o<a.length;++o)this.history[t[o]][n[o]].dispose(),this.history[t[o]][n[o]]=a[o][0]}}class lK extends bh{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||KT,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=aK),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");_1(this.yieldEvery)&&(this.maybeWait=wq(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const a=[];this.yield!=null&&(await jl(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await jl(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];this.epochEnd!=null&&(await jl(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await jl(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];this.batchEnd!=null&&(await jl(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):_1(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await jl(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await jl(e),await this.trainEnd(e))}}function YI(s,e){return s==null&&(s={}),s instanceof bh?[s]:Array.isArray(s)&&s[0]instanceof bh?s:Zt(s).map(n=>new lK(n,e))}class er{constructor(){}static registerCallbackConstructor(e,t){V(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)),er.checkForDuplicate(t),er.constructors[e]==null&&(er.constructors[e]=[]),er.constructors[e].push(t)}static checkForDuplicate(e){for(const t in er.constructors)er.constructors[+t].forEach(a=>{if(a===e)throw new de("Duplicate callback constructor.")})}static clear(){er.constructors={}}static createCallbacks(e){const t=[];for(const n in er.constructors){const a=+n;e>=a&&t.push(...er.constructors[a])}return t.map(n=>new n)}}er.constructors={};function ZI(s,e,t,n,a,o,i,c,u){const h=new iK,p=[new oK,...er.createCallbacks(e)];s!=null&&p.push(...s),p.push(h);const f=new rK(p);return f.setParams({epochs:t,initialEpoch:n,samples:a,steps:o,batchSize:i,verbose:e,doValidation:c,metrics:u}),{callbackList:f,history:h}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _o(s,e={},t=!1){return _p(s,sr.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hm(s,e){return me(()=>{s.dtype!=="float32"&&(s=qe(s,"float32"));const t=at(Fp(s),e,!0),n=_u(t.shape,Xs()),a=wn(Wo(t,n));return Ze(s,a)})}function Vx(s,e){return me(()=>js(Fp(et(e,s)),-1))}function xw(s,e){return me(()=>js(qs(et(e,s)),-1))}function bw(s,e){return me(()=>{const t=et(s,e),n=sa(qs(s),Xs(),Number.MAX_VALUE),a=qs(Ze(t,n));return ne(100,js(a,-1))})}function cK(s,e){return me(()=>{const t=sa(e,Xs(),Number.MAX_VALUE),n=Oa(Fe(1,t)),a=sa(s,Xs(),Number.MAX_VALUE),o=Oa(Fe(1,a));return js(Fp(et(n,o)),-1)})}function uK(s,e){return me(()=>{const t=Wo(0,et(1,ne(s,e)));return js(Fp(t),-1)})}function dK(s,e){return me(()=>{const t=Wo(0,et(1,ne(s,e)));return js(t,-1)})}function hK(s,e){return me(()=>{const t=at(ne(s,e),-1),n=ir(ne(et(1,s),e),-1);return Wo(0,Fe(1,et(n,t)))})}function pK(s,e){return me(()=>{const t=Math.log(2),n=et(e,s),a=et(Fe(n,Ou(ne(-2,n))),t);return js(a,-1)})}function yh(s,e,t=!1){return me(()=>{if(t)e=Ix(e);else{const n=at(e,e.shape.length-1,!0);e=Ze(e,n)}return e=sa(e,Xs(),1-Xs()),fs(at(ne(qe(s,"float32"),Oa(e)),e.shape.length-1))})}function qm(s,e,t=!1){return me(()=>{const n=qe($p(Rq(s)),"int32");e=sa(e,Xs(),1-Xs());const a=e.shape,o=le(ov(n,a[a.length-1]),a);return yh(o,e,t)})}function fK(s,e){if(!Mt(s.shape,e.shape))throw new de("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(s.shape)," and ").concat(JSON.stringify(e.shape)));return me(()=>{const t=ro(e),n=fs(qs(e));return Fe(et(t,ne(e,s)),bx(Bn(n)))})}function Ux(s,e){return me(()=>{let t;return t=sa(e,Xs(),1-Xs()),t=Oa(Ze(t,et(1,t))),js(fK(s,t),-1)})}function mK(s,e){return me(()=>{const t=sa(s,Xs(),1),n=sa(e,Xs(),1);return at(ne(s,Oa(Ze(t,n))),-1)})}function gK(s,e){return me(()=>{const t=Oa(Fe(Xs(),e));return js(et(e,ne(s,t)),-1)})}function QI(s,e){return me(()=>{const t=Hm(s,-1),n=Hm(e,-1),a=ne(t,n);return fs(at(a,-1))})}const Km={meanSquaredError:Vx,meanAbsoluteError:xw,meanAbsolutePercentageError:bw,meanSquaredLogarithmicError:cK,squaredHinge:uK,hinge:dK,categoricalHinge:hK,logcosh:pK,categoricalCrossentropy:yh,sparseCategoricalCrossentropy:qm,binaryCrossentropy:Ux,kullbackLeiblerDivergence:mK,poisson:gK,cosineProximity:QI};function N1(s){if(typeof s=="string"){if(s in Km)return Km[s];let e="Unknown loss ".concat(s);throw s.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(s,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new de(e)}else return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JI(s,e){return me(()=>{const t=ne(.5,Fa(e)),n=Jr(Ca(e,t),s.dtype);return js(jr(s,n),-1)})}function e$(s,e){return me(()=>Jr(jr(yu(s,-1),yu(e,-1)),"float32"))}function xK(s,e){return me(()=>qe(at(to(jr(s,1),jr(e,1))),"float32"))}function bK(s,e){return me(()=>qe(at(to(jr(s,0),jr(e,1))),"float32"))}function yK(s,e){return me(()=>{const t=xK(s,e),n=bK(s,e),a=Fe(t,n);return qe($n(Ca(a,0),Ze(t,a),0),"float32")})}function vK(s,e){return Ux(s,e)}function wK(s,e){return s.rank===e.rank&&(s=Es(s,[s.rank-1])),e=yu(e,-1),e.dtype!==s.dtype&&(e=qe(e,s.dtype)),qe(jr(s,e),"float32")}const NK=Vx,SK=Vx,CK=xw,kK=xw,jK=bw,TK=bw,t$=yh,IK=QI,s$=qm,Xm={binaryAccuracy:JI,categoricalAccuracy:e$,precision:yK,categoricalCrossentropy:t$,sparseCategoricalCrossentropy:s$,mse:NK,MSE:SK,mae:CK,MAE:kK,mape:jK,MAPE:TK,cosine:IK};function $K(s){if(typeof s=="string"&&s in Xm)return Xm[s];if(typeof s!="string"&&s!=null)return s;throw new de("Unknown metric ".concat(s))}function um(s){if(Kr(s!==null,"Unknown LossOrMetricFn ".concat(s)),typeof s=="string")return s;{let e;for(const t of Object.keys(Km))if(Km[t]===s){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Xm))if(Xm[t]===s){e=t;break}return e!==void 0?e:s.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AK(s){const e={Adagrad:()=>nu.adagrad(.01),Adadelta:()=>nu.adadelta(1,.95,Xs()),Adam:()=>nu.adam(.001,.9,.999,Xs()),Adamax:()=>nu.adamax(.002,.9,.999,Xs(),0),RMSProp:()=>nu.rmsprop(.001,.9,0,Xs()),SGD:()=>nu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,s in e)return e[s]();throw new de("Unknown Optimizer ".concat(s))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const TC=1*1024*1024;function IC(s,e,t=!1){if(s==null||typeof s!="object"||Object.getPrototypeOf(s)!==Object.prototype||!vy(s))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const n=JSON.stringify(s);n.length>TC&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(TC,"."))}}function vy(s){if(s===null)return!0;if(typeof s=="object")if(Object.getPrototypeOf(s)===Object.prototype){const e=Object.keys(s);for(const t of e)if(typeof t!="string"||!vy(s[t]))return!1;return!0}else if(Array.isArray(s)){for(const e of s)if(!vy(e))return!1;return!0}else return!1;else{const e=typeof s;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EK(s,e,t,n=console.log){const a=RK(s),o=["Layer (type)","Input Shape","Output shape","Param #"];a?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(p=>Math.floor(e*p)));let i;if(!a){o.push("Receives inputs"),i=[];for(const p in s.nodesByDepth)i.push(...s.nodesByDepth[p])}n("_".repeat(e)),Ym(o,t,n),n("=".repeat(e));const c=s.layers;for(let p=0;p<c.length;++p)a?_K(c[p],t,n):OK(c[p],t,i,n),n((p===c.length-1?"=":"_").repeat(e));s.checkTrainableWeightsConsistency();const u=DK(s),h=Um(s.nonTrainableWeights);n("Total params: ".concat(u+h)),n("Trainable params: ".concat(u)),n("Non-trainable params: ".concat(h)),n("_".repeat(e))}function DK(s){let e;return s.collectedTrainableWeights!=null?e=Um(s.collectedTrainableWeights):e=Um(s.trainableWeights),e}function RK(s){let e=!0;const t=[],n=[];for(const a in s.nodesByDepth)t.push(s.nodesByDepth[a]);for(const a of t){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){e=!1;break}n.push(...a)}if(e)for(const a of s.layers){let o=!1;for(const i of a.inboundNodes)if(n.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Ym(s,e,t=console.log){let n="";for(let a=0;a<s.length;++a)a>0&&(n=n.slice(0,n.length-1)+" "),n+=s[a],n=n.slice(0,e[a]),n+=" ".repeat(e[a]-n.length);t(n)}function _K(s,e,t){let n,a;try{a=s.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch(u){a="multiple"}try{n=JSON.stringify(s.outputShape)}catch(u){n="multiple"}const o=s.name,i=s.getClassName(),c=["".concat(o," (").concat(i,")"),a,n,s.countParams().toString()];Ym(c,e,t)}function OK(s,e,t,n){let a,o;try{o=s.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch(f){o="multiple"}try{a=JSON.stringify(s.outputShape)}catch(f){a="multiple"}const i=[];for(const f of s.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let g=0;g<f.inboundLayers.length;++g){const b=f.inboundLayers[g].name,y=f.nodeIndices[g],v=f.tensorIndices[g];i.push("".concat(b,"[").concat(y,"][").concat(v,"]"))}const c=s.name,u=s.getClassName(),h=i.length===0?"":i[0],p=["".concat(c," (").concat(u,")"),o,a,s.countParams().toString(),h];Ym(p,e,n);for(let f=1;f<i.length;++f)Ym(["","","","",i[f]],e,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n$(s,e,t){return(s==="inboundNodes"||s==="outputLayers"||s==="inputLayers")&&e===0&&typeof t=="string"}function wy(s,e){if(s===null)return null;if(typeof s=="string")return El(s);if(typeof s=="number"||typeof s=="boolean")return s;if(s instanceof Array){const t=[],n=s.length;for(let a=0;a<n;++a){const o=s[a];n$(e,a,o)?t.push(o):t.push(wy(o,e))}return t}else{const t={};for(const n of Object.keys(s)){const a=s[n];if(n==="name"&&typeof a=="string")t[n]=a;else{const o=El(n);t[o]=wy(a,o)}}return t}}function Ny(s,e){if(s==null)return null;if(typeof s=="string")return Ao(s);if(typeof s=="number"||typeof s=="boolean")return s;if(s instanceof Array){const t=[],n=s.length;for(let a=0;a<n;++a){const o=s[a];n$(e,a,o)?t.push(o):t.push(Ny(o,e))}return t}else{const t={};for(const n of Object.keys(s)){const a=s[n],o=Ao(n);(n==="name"||n==="className")&&typeof a=="string"?t[o]=a:t[o]=Ny(a,n)}return t}}/** @license See the LICENSE file. */const a$="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const FK=s=>{const e=Object.keys(s);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class yr extends Et{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=zx(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ei(this.inputs).length!==this.inputs.length)throw new de("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(C=>C.name)));Ei(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(C=>C.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const I=C.sourceLayer,T=C.nodeIndex,$=C.tensorIndex;this.outputLayers.push(I),this.outputLayersNodeIndices.push(T),this.outputLayersTensorIndices.push($)}for(const C of this.inputs){const I=C.sourceLayer,T=C.nodeIndex,$=C.tensorIndex;Kr(T===0,"input layer has >1 nodes"),Kr($===0,"input layer has >1 tensors"),this.inputLayers.push(I),this.inputLayersNodeIndices.push(T),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const I=this.inputLayers[C];if(!(I instanceof Mp))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(C," (0-based) originates ")+"from layer type ".concat(I.getClassName(),"."));this.inputNames.push(I.name),this.feedInputShapes.push(I.batchInputShape),this.feedInputNames.push(I.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const t={},n={},a={},o={},i={},c=[],u=(C,I,T,$,E,_)=>{($==null||E==null||_==null)&&($=C.sourceLayer,E=C.nodeIndex,_=C.tensorIndex);const L=$.inboundNodes[E];if(T.indexOf(L)!==-1)throw new ar("The tensor ".concat(C.name,' at layer "').concat($.name,'" ')+"is part of a cycle.");if(I.indexOf(L)!==-1)return;this.containerNodes.add(yr.nodeKey($,E)),$.id in i||(i[$.id]=Object.keys(i).length),T.indexOf(L)===-1&&T.push(L);const O=L.inboundLayers.length;for(let z=0;z<O;z++){const A=L.inputTensors[z],U=L.inboundLayers[z],X=L.nodeIndices[z],Z=L.tensorIndices[z];u(A,I,T,U,X,Z)}for(I.push(L);T.indexOf(L)>=0;)T.splice(T.indexOf(L),1);c.push(L)},h=[],p=[];for(const C of this.outputs)u(C,h,p);const f=c.slice().reverse();for(const C of f){n[C.id]=C,C.id in t||(t[C.id]=0);let I=t[C.id];const T=a[C.outboundLayer.id]==null?0:a[C.outboundLayer.id];I=Math.max(I,T),a[C.outboundLayer.id]=I,o[C.outboundLayer.id]=C.outboundLayer,t[C.id]=I;for(let $=0;$<C.inboundLayers.length;$++){const E=C.inboundLayers[$],_=C.nodeIndices[$],L=E.inboundNodes[_],O=t[L.id]==null?0:t[L.id];t[L.id]=Math.max(I+1,O),n[L.id]=L}}const g={};for(const C in t){const I=t[C];I in g||(g[I]=[]),g[I].push(n[C])}const b={};for(const C in a){const I=a[C];I in b||(b[I]=[]),b[I].push(o[C])}let y=Object.keys(b).map(C=>parseInt(C,10)).sort(im);this.layers=[];for(const C of y){const I=b[C];I.sort((T,$)=>{const E=i[T.id],_=i[$.id];return E<_?-1:E>_?1:0});for(const T of I)T instanceof yr&&this.internalContainerRefs.push(T),this.layers.push(T)}this.layersByDepth=b,y=Object.keys(g).map(C=>parseInt(C,10)).sort(im);const v=this.inputs.slice(),w=[];for(const C of y)for(const I of g[C]){const T=I.outboundLayer;if(T!=null){for(const $ of I.inputTensors)if(v.indexOf($)===-1)throw new ar("Graph disconnected: cannot obtain value for tensor ".concat($)+' at layer "'.concat(T.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(w));for(const $ of I.outputTensors)v.push($);w.push(T.name)}}this.nodesByDepth=g;const N=this.layers.map(C=>C.name);for(const C of N){const I=N.filter(T=>T===C).length;if(I!==1)throw new ar('The name "'.concat(C,'" is used ').concat(I," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(N))}this.outboundNodes=[],this.inboundNodes=[],new Bx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(n=>n.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new de("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.layers)t.push(...n.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const n={};let a=0;const o=FK(e);o&&this.parseWeights(e);for(const c of this.layers)for(const[u,h]of c.weights.entries()){const p=o?"".concat(h.name.split("/").slice(0,-1).join("/")+"/").concat(u):h.originalName;if(n[p]!=null)throw new de("Duplicate weight name: ".concat(p));n[p]=h,a++}const i=[];for(const c in e){let u=c;if(n[c]==null){const h=c.split("/");u=h.slice(0,-2).concat([h[h.length-1]]).join("/")}if(n[u]!=null)i.push([n[u],e[c]]);else if(t)throw new de("Provided weight data has no target variable: ".concat(c));delete n[u]}if(t){const c=[];for(const u in n)c.push(u);if(c.length>0)throw new de("".concat(c.length," of ").concat(a," weights are not set: ")+"".concat(c))}mw(i)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],o=n.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");o!==t&&(e[o]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(a$),t.backend="TensorFlow.js",t}toJSON(e,t=!0){const n=Ny(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return me(()=>{e=Zt(e);const n=new Ti;for(let a=0;a<this.inputs.length;++a)n.add(this.inputs[a],e[a]);return oh(this.outputs,n,t)})}computeMask(e,t){return me(()=>{e=Zt(e);let n;return t==null?n=Yl(null,e.length):n=Zt(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){const t=Vm(e);if(t.length!==this.inputLayers.length)throw new de("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let c=0;c<t.length;c++){const u=this.inputLayers[c],h=t[c],p=u.name+"_0_0";n[p]=h}const a=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(im);if(a.length>1)for(const c of a){const u=this.nodesByDepth[c];for(const h of u){const p=h.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(p.id)!==-1)continue;const f=[];for(let v=0;v<h.inboundLayers.length;v++){const w=h.inboundLayers[v],N=h.nodeIndices[v],C=h.tensorIndices[v],I="".concat(w.name,"_").concat(N,"_").concat(C),T=n[I];f.push(T)}const g=p.computeOutputShape(Jn(f)),b=Vm(g),y=p.inboundNodes.indexOf(h);for(let v=0;v<b.length;v++){const w="".concat(p.name,"_").concat(y,"_").concat(v);n[w]=b[v]}}}const o=[],i=[];for(let c=0;c<this.outputLayers.length;c++){const u=this.outputLayers[c],h=this.outputLayersNodeIndices[c],p=this.outputLayersTensorIndices[c],f="".concat(u.name,"_").concat(h,"_").concat(p);i.push(f)}for(let c=0;c<i.length;c++){const u=i[c];Kr(u in n),o.push(n[u])}return Jn(o)}runInternalGraph(e,t){t==null&&(t=Yl(null,e.length));const n={};for(let u=0;u<this.inputs.length;++u){const h=this.inputs[u],p=e[u],f=t[u];n[h.id]=[p,f]}const a=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(im);for(const u of a){const h=this.nodesByDepth[u];for(const p of h){const f=p.outboundLayer,g=p.inputTensors,b=p.outputTensors,y=new Array;for(const v of g)v.id in n&&y.push(n[v.id]);if(y.length===g.length){let v={},w,N,C,I;if(p.callArgs!=null&&(v=p.callArgs),y.length===1){const[T,$]=y[0];v.mask==null&&(v.mask=$),C=Zt(f.call(T,v)),I=Zt(f.computeMask(T,$)),w=[T],N=[$]}else w=y.map(T=>T[0]),N=y.map(T=>T[1]),v.mask==null&&(v.mask=N),C=Zt(f.call(w,v)),I=Zt(f.computeMask(w,N));if(f.activityRegularizer)throw new It("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let T=0;T<b.length;++T){const $=b[T],E=C[T],_=I[T];n[$.id]=[E,_]}}}}const o=[],i=[],c=[];for(const u of this.outputs){Kr(u.id in n,"Could not compute output ".concat(u.name," : ").concat(u.id));const[h,p]=n[u.id];c.push(h.shape),o.push(h),i.push(p)}return[o,i,c]}buildNodeConversionMap(e){const t={};let n;for(const a of this.layers){n=a instanceof yr?1:0;for(let o=0;o<a.inboundNodes.length;o++){const i=yr.nodeKey(a,o);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new de("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new de("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new de("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return me(()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const a=yr.nodeKey(t,n);this.containerNodes.has(a)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const c=i.getClassName(),u=i.getConfig(),h=[];for(let f=0;f<i.inboundNodes.length;f++){const g=i.inboundNodes[f],b=yr.nodeKey(i,f);let y={};if(this.containerNodes.has(b)){if(g.callArgs)try{JSON.stringify(g.callArgs),y=g.callArgs}catch(v){console.warn("Layer ".concat(i.name," was passed ")+"non-serializable keyword arguments: "+"".concat(g.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),y={}}if(g.inboundLayers.length>0){const v=[];for(let w=0;w<g.inboundLayers.length;w++){const N=g.inboundLayers[w],C=g.nodeIndices[w],I=g.tensorIndices[w],T=yr.nodeKey(N,C);let $=t[T];$==null&&($=0),v.push([N.name,$,I,y])}h.push(v)}}}const p={};p.name=i.name,p.className=c,p.config=u,p.inboundNodes=h,n.push(p)}e.layers=n;const a=[];for(let i=0;i<this.inputLayers.length;i++){const c=this.inputLayers[i],u=this.inputLayersNodeIndices[i],h=yr.nodeKey(c,u);if(!this.containerNodes.has(h))continue;let p=t[h];p==null&&(p=0);const f=this.inputLayersTensorIndices[i];a.push([c.name,p,f])}e.inputLayers=a;const o=[];for(let i=0;i<this.outputLayers.length;i++){const c=this.outputLayers[i],u=this.outputLayersNodeIndices[i],h=yr.nodeKey(c,u);if(!this.containerNodes.has(h))continue;let p=t[h];p==null&&(p=0);const f=this.outputLayersTensorIndices[i];o.push([c.name,p,f])}return e.outputLayers=o,e}static fromConfig(e,t,n={},a=!1){const o={},i={};function c(w,N){w.name in i?i[w.name].push(N):i[w.name]=[N]}function u(w,N){const C=[];let I;for(const T of N){const $=T[0],E=T[1],_=T[2];if(I=T[3]==null?{}:T[3],!($ in o)){c(w,N);return}const L=o[$];if(L.inboundNodes.length<=E){c(w,N);return}const O=L.inboundNodes[E];C.push(O.outputTensors[_])}C.length>0&&w.apply(Jn(C),I)}function h(w){const N=w.name,C=_o(w,t.customObjects!=null?t.customObjects:{});C.setFastWeightInitDuringBuild(a),o[N]=C,w.inboundNodes.forEach(T=>{if(!(T instanceof Array))throw new de("Corrupted configuration, expected array for nodeData: ".concat(T));c(C,T)})}const p=t.name,f=t.layers;for(const w of f)h(w);for(;!vq(i);)for(const w of f){const N=o[w.name];if(N.name in i){const C=i[N.name];delete i[N.name];for(const I of C)u(N,I)}}const g=[],b=[],y=t.inputLayers;for(const w of y){const N=w[0],C=w[1],I=w[2];Kr(N in o);const $=o[N].inboundNodes[C].outputTensors;g.push($[I])}const v=t.outputLayers;for(const w of v){const N=w[0],C=w[1],I=w[2];Kr(N in o);const $=o[N].inboundNodes[C].outputTensors;b.push($[I])}return new e({inputs:g,outputs:b,name:p})}get stateful(){if(this._stateful)throw new de("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){me(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LK(s,e,t){const n=e.length;if(s==null||Array.isArray(s)&&s.length===0)return e.map(a=>null);if(n===1)return Array.isArray(s)&&s.length===1?s:typeof s=="object"&&e[0]in s?[s[e[0]]]:[s];if(Array.isArray(s)){if(s.length!==n)throw new Error("Provided ".concat(t," is an array of ").concat(s.length," ")+"element(s), but the model has ".concat(n," outputs. ")+"Make sure a set of weights is provided for each model output.");return s}else if(typeof s=="object"&&Object.keys(s).length>0&&typeof s[Object.keys(s)[0]]=="object"){const a=[];return e.forEach(o=>{o in s?a.push(s[o]):a.push(null)}),a}else throw new Error("The model has multiple (".concat(n,") outputs, ")+"so ".concat(t," must be either an array with ")+"".concat(n," elements or an object with ").concat(e," keys. ")+"Provided ".concat(t," not understood: ").concat(JSON.stringify(s)))}function r$(s,e){return LK(s,e,"classWeight")}async function o$(s,e,t,n){if(t!=null){const a=me(()=>{if(s.shape.length===1)return Ro(s);if(s.shape.length===2){if(s.shape[1]>1)return yu(s,1);if(s.shape[1]===1)return le(s,[s.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(s.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}else throw new Error("Unexpected rank of target (y) tensor (".concat(s.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),o=Array.from(await a.data());Ct(a);const i=[];return o.forEach(c=>{if(t[c]==null)throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(c," exists in the data but not in ")+"classWeight");i.push(t[c])}),Bs(i,"float32")}else return null}function MK(s,e){return ne(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zK=32;function i$(s,e){let t,n;const a=e;t=a.xs,n=a.ys,V(t!=null&&n!=null,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e));const o=$C("input",s.inputNames,t),i=$C("output",s.outputNames,n),c=o[0].shape[0];V(o.length===s.inputs.length,()=>"LayersModel has ".concat(s.inputs.length," inputs, but the dataset ")+"provides ".concat(o.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(s.inputNames),")")),V(i.length===s.outputs.length,()=>"LayersModel has ".concat(s.outputs.length," outputs, but the dataset ")+"provides ".concat(i.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(s.outputNames),")"));for(let u=0;u<o.length;u++)V(o[u].shape[0]===c,()=>"Batch size mismatch: input "+"".concat(s.inputNames[u]," has ").concat(o[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(s.inputNames[0],"."));for(let u=0;u<i.length;u++)V(i[u].shape[0]===c,()=>"Batch size mismatch: output "+"".concat(s.outputNames[u]," has ").concat(i[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(s.inputNames[0],"."));return{xs:o,ys:i}}function $C(s,e,t){if(t instanceof os)return[t];if(Array.isArray(t))return V(t.length===e.length,()=>"Received an array of ".concat(t.length," Tensors, but expected ").concat(e.length," to match the ").concat(s," keys ").concat(e,".")),t;{const n=[];for(const a of e){if(t[a]==null)throw new de("The feature data generated by the dataset lacks the required "+"".concat(s," key '").concat(a,"'."));n.push(t[a])}return n}}function PK(s){if(s.length===3)throw new It("Validation with sample weights is not implemented yet.");return{xs:s[0],ys:s[1]}}async function BK(s,e,t){const n=t.batchesPerEpoch!=null;if(V(s.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),V(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),V(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(t.epochs)),V(!n||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(t.batchesPerEpoch)),V(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");s.isTraining=!0;try{const a=t.validationData!=null;let o,i;if(a)if(AC(t.validationData))V(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(t.validationBatches));else{const w=PK(t.validationData);o=w.xs,i=w.ys}const c=s.makeTrainFunction(),u=s.getDedupedMetricsNames();let h;a?h=u.slice().concat(u.map(w=>"val_"+w)):h=u.slice();const p=YI(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:g,history:b}=ZI(p,f,t.epochs,null,null,VK(e,t),null,a,h);g.setModel(s),s.history=b,await g.onTrainBegin(),s.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,v=await e.iterator();for(;y<t.epochs;){const w={};await g.onEpochBegin(y);let N=0,C=0;for(n||(v=await e.iterator());!n||N<t.batchesPerEpoch;){const I=await v.next();if(n&&I.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(t.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(N," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(t.batchesPerEpoch*t.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(I.value!=null){const{xs:T,ys:$}=i$(s,I.value),E={};E.batch=C,E.size=T[0].shape[0],await g.onBatchBegin(C,E);const _=[];if(t.classWeight!=null){const z=r$(t.classWeight,s.outputNames);for(let A=0;A<z.length;++A)_.push(await o$($[A],null,z[A]))}const L=T.concat($).concat(_),O=c(L);Ct(L);for(let z=0;z<u.length;++z){const A=u[z],U=O[z];E[A]=U,un(U)}await g.onBatchEnd(C,E),XI(E),C++,N++}if(n?N>=t.batchesPerEpoch:I.done){if(a){let T;AC(t.validationData)?T=Zt(await s.evaluateDataset(t.validationData,{batches:t.validationBatches})):T=Zt(s.evaluate(o,i,{batchSize:t.validationBatchSize==null?zK:t.validationBatchSize,verbose:0}));for(let $=0;$<s.metricsNames.length;++$)w["val_".concat(s.metricsNames[$])]=T[$]}break}if(s.stopTraining_)break}if(await g.onEpochEnd(y,w),y++,s.stopTraining_)break}return await g.onTrainEnd(),await s.history.syncData(),s.history}finally{s.isTraining=!1}}function VK(s,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(s.size)&&(t=s.size),t}function AC(s){return typeof s.iterator=="function"}function UK(s){return typeof s.next=="function"}async function GK(s,e,t){t=t||{};const n=t.batches!=null,a=s.testFunction;let o=[];if(t.verbose>0)throw new It("Verbose mode is not implemented yet.");V(!n||t.batches>0&&Number.isInteger(t.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(t.batches)));const i=UK(e)?e:await e.iterator();let c=0,u=0;for(;!n||u<t.batches;){const h=await i.next();if(o=me(()=>{if(h.value){const{xs:p,ys:f}=i$(s,h.value),g=p.concat(f),b=me(()=>a(g));if(Ct(g),u===0)for(let v=0;v<b.length;++v)o.push(ht(0));const y=g[0].shape[0];for(let v=0;v<b.length;++v){const w=b[v],N=o[v];o[v]=me(()=>Fe(o[v],ne(y,w))),u>0&&Ct(N)}Ct(b),c+=y,++u}return o}),h.done){n&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(t.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let h=0;h<o.length;++h){const p=o[h];o[h]=Ze(o[h],c),Ct(p)}return Jn(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S1(s){V(s>0&&Number.isInteger(s),()=>"batchSize is required to be a positive integer, but got ".concat(s))}function sh(s,e,t){return s==null?[null]:Array.isArray(s)?s.map(n=>Ll(n,e,t-e)):Ll(s,e,t-e)}function Sy(s,e){return me(()=>s==null?null:Array.isArray(s)?s.map(t=>Sy(t,e)):OI(s,e.dtype==="int32"?e:qe(e,"int32")))}function C1(s,e){const t=[];let n=0,a=null;for(;n<s;)a=n+e,a>=s&&(a=s),t.push([n,a]),n=a;return t}function l$(s){const e=[];s instanceof os&&(s=[s]);for(let t=0;t<s.length;++t){const n=s[t];if(n.rank===1)e.push(Op(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(n)}}return e}function br(s,e){if(s==null)return;const t=[];if(e instanceof os)t.push(e.id);else if(Array.isArray(e))e.forEach(a=>t.push(a.id));else if(e!=null)for(const a in e){const o=e[a];t.push(o.id)}const n=[];if(s instanceof os)t.indexOf(s.id)===-1&&n.push(s);else if(Array.isArray(s))s.forEach(a=>{t.indexOf(a.id)===-1&&n.push(a)});else if(s!=null)for(const a in s){const o=s[a];t.indexOf(o.id)===-1&&n.push(o)}n.forEach(a=>{a.isDisposed||a.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WK(s){return s instanceof os}function Cy(s){return Array.isArray(s)}function EC(s){return!WK(s)&&!Cy(s)}function DC(s,e,t,n=!0,a=""){if(e==null||e.length===0){if(s!=null){let i=!1;if(Cy(s)&&s.length>0)i=!0;else if(EC(s)){for(const c in s)if(s.hasOwnProperty(c)){i=!0;break}}else i=!0;if(i)throw new de("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(s))}return[]}if(s==null)return e.map(i=>null);let o;if(EC(s)){s=s,o=[];for(const i of e){if(s[i]==null)throw new de('No data provided for "'.concat(i,'". Need data for each key in: ')+"".concat(e));o.push(s[i])}}else if(Cy(s)){if(s=s,s.length!==e.length)throw new de("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(s));o=s}else{if(s=s,e.length>1)throw new de("The model ".concat(a," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(s.shape));o=[s]}if(o=l$(o),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const c=o[i];if(c.shape.length!==t[i].length)throw new de("Error when checking ".concat(a,": expected ").concat(e[i]," ")+"to have ".concat(t[i].length," dimension(s). but got array with ")+"shape ".concat(c.shape));for(let u=0;u<t[i].length;++u){if(u===0&&!n)continue;const h=c.shape[u],p=t[i][u];if(p!=null&&p>=0&&h!==p)throw new de("".concat(a," expected a batch of elements where each ")+"example has shape [".concat(t[i].slice(1,t[i].length),"] ")+"(i.e.,tensor shape [*,".concat(t[i].slice(1,t[i].length),"])")+" but the ".concat(a," received an input with ").concat(c.shape[0])+" examples, each with shape [".concat(c.shape.slice(1,c.shape.length),"]")+" (tensor shape [".concat(c.shape,"])"))}}return o}function HK(s,e,t){const n=Ei(s.map(o=>o.shape[0]));n.sort();const a=Ei(e.map(o=>o.shape[0]));if(a.sort(),n.length>1)throw new de("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(s.map(o=>o.shape))));if(a.length>1)throw new de("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map(o=>o.shape))));if(n.length>0&&a.length>0&&!Mt(n,a))throw new de("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function qK(s,e,t){const n=[Vx,Ux,yh];for(let a=0;a<s.length;++a){const o=s[a],i=e[a],c=t[a];if(i!=null){if(i===yh&&o.shape[o.shape.length-1]===1)throw new de("You are passing a target array of shape ".concat(o.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(n.indexOf(i)!==-1){const u=o.shape.slice(1),h=c.slice(1);for(let p=0;p<u.length;++p){const f=u[p],g=h[p];if(g!=null&&f!==g)throw new de("A target Tensor with shape ".concat(o.shape," was passed for an ")+"output of shape ".concat(c,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}function RC(s,e,t,n=!0,a=""){let o;if(Array.isArray(s)){if(s.length!==e.length)throw new de("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(s.length," Tensors(s)."));o=s}else{if(e.length>1)throw new de("The model expects ".concat(e.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(s.shape),"."));o=[s]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const c=o[i];if(c.shape.length!==t[i].length)throw new de("Error when checking ".concat(a,": expected ").concat(e[i]," ")+"to have ".concat(t[i].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(c.shape)));for(let u=0;u<t[i].length;++u){if(u===0&&!n)continue;const h=c.shape[u],p=t[i][u];if(p!=null&&p!==h)throw new de("Error when checking ".concat(a,": expected ")+"".concat(e[i]," to have shape ").concat(JSON.stringify(t[i])," but ")+"got array with shape ".concat(JSON.stringify(c.shape),"."))}}}function KK(s,e){if(s==null||Array.isArray(s)&&s.length===0)return e.map(n=>[]);let t;if(typeof s=="string"||typeof s=="function")t=[s];else if(Array.isArray(s)||typeof s=="object")t=s;else throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(s));if(Array.isArray(t))return e.map(n=>t);{const n=[];for(const a of e){let o=t.hasOwnProperty(a)?t[a]:[];Array.isArray(o)||(o=[o]),n.push(o)}return n}}const XK="layers-model";class mu extends yr{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new de("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");EK(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=AK(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Qi))throw new de("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new de('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const i of this.outputNames)e.loss[i]==null&&console.warn('Output "'.concat(i,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(i," during training")),t.push(N1(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new de("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));t=e.loss.map(c=>N1(c))}else{const i=N1(e.loss);this.outputs.forEach(c=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const c=this.internalOutputShapes[i],u=this.outputNames[i];this.feedOutputNames.push(u),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Fl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;const c=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([c,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const a=KK(e.metrics,this.outputNames),o=(i,c,u)=>{this.outputNames.length>1&&(c=this.outputNames[i]+"_"+c),this.metricsNames.push(c),this.metricsTensors.push([u,i])};Fl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;const c=a[i];(h=>{const p="";let f,g,b;for(const y of h){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const w=this.internalOutputShapes[i];w[w.length-1]===1||this.lossFunctions[i]===Ux?["accuracy","acc"].indexOf(y)!==-1?g=JI:["crossentropy","ce"].indexOf(y)!==-1&&(g=vK):this.lossFunctions[i]===qm?["accuracy","acc"].indexOf(y)!==-1?g=wK:["crossentropy","ce"].indexOf(y)!==-1&&(g=s$):["accuracy","acc"].indexOf(y)!==-1?g=e$:["crossentropy","ce"].indexOf(y)!==-1&&(g=t$);let N;["accuracy","acc"].indexOf(y)!==-1?N="acc":["crossentropy","ce"].indexOf(y)!==-1&&(N="ce"),b=g,f=p+N}else b=$K(y),f=p+um(y);let v;Fl(f,()=>{v=b}),o(i,f,v)}})(c)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){const a=n.batchSize==null?32:n.batchSize;S1(a);const i=this.standardizeUserDataXY(e,t,!0,a);try{const c=i[0].concat(i[1]);this.makeTestFunction();const u=this.testFunction,h=this.testLoop(u,c,a,n.verbose,n.steps);return Jn(h)}finally{br(i[0],e),br(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),GK(this,e,t)}checkNumSamples(e,t,n,a="steps"){let o;if(n!=null){if(o=null,t!=null)throw new de("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new de("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));return o}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new de("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),a=n?t:[t],o=this.retrieveSymbolicTensors(a),i=new Ti;if(e instanceof os&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new de("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let u=0;u<this.inputs.length;++u)i.add(this.inputs[u],e[u])}else for(const u of this.inputs){const h=e[u.name];if(h==null)throw new de("No value is provided for the model's input ".concat(u.name));i.add(u,h)}const c=oh(o,i);return n?c:c[0]}retrieveSymbolicTensors(e){const t=Yl(null,e.length);let n=e.length;for(const a of this.layers){const o=Array.isArray(a.output)?a.output:[a.output],i=o.map(c=>c.name);for(let c=0;c<e.length;++c){const u=i.indexOf(e[c]);if(u!==-1&&(t[c]=o[u],n--),n===0)break}if(n===0)break}if(n>0){const a=[];throw t.forEach((o,i)=>{o==null&&a.push(e[i])}),new de("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(a)))}return t}predictLoop(e,t=32,n=!1){return me(()=>{const a=this.checkNumSamples(e);if(n)throw new It("Verbose predictLoop() is not implemented yet.");const o=C1(a,t),i=this.outputs.map(c=>[]);for(let c=0;c<o.length;++c)me(()=>{const h=o[c][0],p=o[c][1],f=sh(e,h,p),g=[];if(Array.isArray(f))for(let y=0;y<f.length;++y)g.push({key:this.inputs[y],value:f[y]});else g.push({key:this.inputs[0],value:f});const b=new Ti(g);return oh(this.outputs,b)}).forEach((h,p)=>i[p].push(h));return Jn(i.map(c=>Ts(c,0)))})}predict(e,t={}){const n=l$(e);RC(n,this.inputNames,this.feedInputShapes,!1);try{const a=t.batchSize==null?32:t.batchSize;return S1(a),this.predictLoop(n,a)}finally{br(n,e)}}predictOnBatch(e){RC(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,a){if(this.optimizer_==null)throw new ar("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const c=this.feedOutputShapes[i];this.feedLossFns[i]===qm?o.push(c.slice(0,c.length-1).concat([1])):o.push(c)}if(e=DC(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=DC(t,this.feedOutputNames,o,!1,"target"),HK(e,t),qK(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&e[0].shape[0]%a!==0)throw new de("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(a,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a,o=!0,i){const[c,u]=this.standardizeUserDataXY(e,t,o,i);if(n!=null)throw new Error("sample weight is not supported yet.");let h=null;if(a!=null){const p=r$(a,this.outputNames);h=[];for(let f=0;f<p.length;++f)h.push(await o$(u[f],null,p[f]))}return[c,u,h]}testLoop(e,t,n,a=0,o){return me(()=>{const i=this.checkNumSamples(t,n,o,"steps"),c=[];if(a>0)throw new It("Verbose mode is not implemented yet.");if(o!=null)throw new It("steps mode in testLoop() is not implemented yet");{const u=C1(i,n),h=Bs(Tr(0,i));for(let p=0;p<u.length;++p){const f=u[p][0],g=u[p][1],b=Ll(h,f,g-f),y=Sy(t,b),v=e(y);if(p===0)for(let w=0;w<v.length;++w)c.push(ht(0));for(let w=0;w<v.length;++w){const N=v[w];c[w]=Fe(c[w],ne(g-f,N))}}for(let p=0;p<c.length;++p)c[p]=Ze(c[p],i)}return c})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const a=e[n];let o=a;if(xC(e,a)>1){const i=xC(e.slice(0,n),a);o+="_".concat(i)}t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],c=()=>{const f=[];for(let v=0;v<this.inputs.length;++v)f.push({key:this.inputs[v],value:n[v]});const g=new Ti(f),b=oh(this.outputs,g,{training:!0});let y;for(let v=0;v<this.lossFunctions.length;++v){const w=this.lossFunctions[v];let N=w(a[v],b[v]);o[v]!=null&&(N=MK(N,o[v]));const C=js(N);t.push(C),v===0?y=N:y=Fe(y,N)}for(let v=0;v<this.metricsTensors.length;++v){let w;if(this.outputs.length>1&&v<this.outputs.length)w=t[v];else{const N=this.metricsTensors[v][0],C=this.metricsTensors[v][1];w=js(N(a[C],b[C]))}un(w),i.push(w)}return y=js(y),this.calculateLosses().forEach(v=>{y=Fe(y,v)}),y},u=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(c,!0,u)].concat(i)}}makeTestFunction(){this.testFunction=e=>me(()=>{const t=[];let n;const a=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let h=0;h<this.inputs.length;++h)i.push({key:this.inputs[h],value:a[h]});const c=new Ti(i),u=oh(this.outputs,c);for(let h=0;h<this.lossFunctions.length;++h){const p=this.lossFunctions[h],f=js(p(o[h],u[h]));h===0?n=f:n=Fe(n,f),t.push(n)}for(let h=0;h<this.metricsTensors.length;++h){const p=this.metricsTensors[h][0],f=this.metricsTensors[h][1],g=js(p(o[f],u[f]));t.push(g)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,o,i,c,u,h,p,f,g;try{const b=n.batchSize==null?32:n.batchSize;S1(b);const v=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,!1,b);a=v[0],o=v[1],g=v[2];let w=!1,N;if(n.validationData!=null&&n.validationData.length>0){if(w=!0,n.validationData.length===2)u=n.validationData[0],h=n.validationData[1];else throw n.validationData.length===3?new It("validationData including sample weights is not supported yet."):new de("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(n.validationData," is invalid."));const z=await this.standardizeUserData(u,h,null,null,!0,b);p=z[0],f=z[1],N=p.concat(f)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){w=!0;const O=Math.floor(a[0].shape[0]*(1-n.validationSplit)),z=a[0].shape[0];p=sh(a,O,z),i=a,a=sh(a,0,O),f=sh(o,O,z),c=o,o=sh(o,0,O),N=p.concat(f)}else n.validationSteps!=null&&(w=!0);const C=a.concat(o).concat(g);this.checkTrainableWeightsConsistency();const I=this.makeTrainFunction(),T=this.getDedupedMetricsNames();let $,E;w?(this.makeTestFunction(),$=this.testFunction,E=T.slice().concat(T.map(O=>"val_"+O))):($=null,N=[],E=T.slice());const _=YI(n.callbacks,n.yieldEvery);return await this.fitLoop(I,C,T,b,n.epochs,n.verbose,_,$,N,n.shuffle,E,n.initialEpoch,null,null)}finally{this.isTraining=!1,br(a,e),br(o,t),br(i,e),br(c,t),br(p,u),br(f,h),g!=null&&Ct(g)}}async fitLoop(e,t,n,a,o,i,c,u,h,p,f,g,b,y){a==null&&(a=32),o==null&&(o=1),p==null&&(p=!0),g==null&&(g=0);let v=!1;if(u!=null&&h!=null&&(v=!0),y!=null&&(v=!0,b==null))throw new de("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const w=this.checkNumSamples(t,a,b,"steps_per_epoch");let N;w!=null&&(N=Tr(0,w)),i==null&&(i=1);const{callbackList:C,history:I}=ZI(c,i,o,g,w,b,a,v,f);C.setModel(this),this.history=I,await C.onTrainBegin(),this.stopTraining_=!1;for(let T=g;T<o;++T){await C.onEpochBegin(T);const $={};if(b!=null)throw new It("stepsPerEpoch mode is not implemented yet.");{if(p==="batch")throw new It("batch shuffling is not implemneted yet");p&&P8(N);const E=Bs(N),_=C1(w,a);for(let L=0;L<_.length;++L){const O={};if(await C.onBatchBegin(L,O),me(()=>{const z=_[L][0],A=_[L][1],U=Ll(E,z,A-z);O.batch=L,O.size=A-z;const X=Sy(t,U),Z=e(X);for(let q=0;q<n.length;++q){const B=n[q],K=Z[q];O[B]=K,un(K)}if(L===_.length-1&&v){const q=this.testLoop(u,h,a);for(let B=0;B<n.length;++B){const K=n[B],J=q[B];un(J),$["val_"+K]=J}}}),await C.onBatchEnd(L,O),XI(O),this.stopTraining_)break}E.dispose()}if(await C.onEpochEnd(T,$),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return BK(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),a=n[0],o=n[1],c=this.makeTrainFunction()(a.concat(o)),u=[];for(const h of c){const p=await h.data();u.push(p[0])}return Ct(c),br(n[0],e),br(n[1],t),Jn(u)}getNamedWeights(e){const t=[],n=e!=null&&e.trainableOnly,a=n?this.trainableWeights:this.weights,o=this.getWeights(n);for(let i=0;i<a.length;++i)n&&!a[i].trainable||t.push({name:a[i].originalName,tensor:o[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=_4().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-_4().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ao(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Ao(t))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const a of t)if(typeof n[a]=="string")e[a]=Ao(n[a]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ao(um(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ao(um(e)));{const e={};for(const t in this.metrics)e[t]=Ao(um(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=wy(e.optimizer_config),n=_o(t);let a;if(typeof e.loss=="string")a=El(e.loss);else if(Array.isArray(e.loss))a=e.loss.map(i=>El(i));else if(e.loss!=null){a={};for(const i in e.loss)a[i]=El(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>El(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=El(e.metrics[i])}this.compile({loss:a,metrics:o,optimizer:n})}async save(e,t){if(typeof e=="string"){const h=pj(e);if(h.length===0)throw new de("Cannot find any save handlers for URL '".concat(e,"'"));if(h.length>1)throw new de("Found more than one (".concat(h.length,") save handlers for ")+"URL '".concat(e,"'"));e=h[0]}if(e.save==null)throw new de("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await q1(this.getNamedWeights(t)),c={modelTopology:this.toJSON(null,!1),format:XK,generatedBy:"TensorFlow.js tfjs-layers v".concat(a$),convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){c.trainingConfig=this.getTrainingConfig();const h="optimizer",{data:p,specs:f}=await q1(await this.optimizer.getWeights(),h);n.specs.push(...f),n.data=uj([n.data,p])}return this.userDefinedMetadata!=null&&(IC(this.userDefinedMetadata,this.name,!0),c.userDefinedMetadata=this.userDefinedMetadata),c.weightData=n.data,c.weightSpecs=n.specs,e.save(c)}setUserDefinedMetadata(e){IC(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}mu.className="Model";Pe(mu);class c$ extends mu{}c$.className="Functional";Pe(c$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vh extends mu{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:zx("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(n=>n<0))throw new de("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof vh||e instanceof mu;let n;if(t){if(n=e,n.outputs.length!==1)throw new de("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new de("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new de("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const a=Zq({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new de("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(e.inboundNodes[0].outputTensors.length!==1)throw new de("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=GI(this.outputs[0])}this.inboundNodes=[],new Bx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Yl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{const a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(qt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new mu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},a=!1){let o,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new de("Legacy serialization format not supported yet.");o=t}else V(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=t.layers,delete t.layers,i=t;const c=new e(i);if(!(c instanceof vh))throw new It("Sequential.fromConfig called on non-Sequential input: ".concat(c));for(const u of o){const p=_o(u,void 0,a);a&&p.setFastWeightInitDuringBuild(!0),c.add(p)}return c}set stopTraining(e){if(this.model==null)throw new de("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new de("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}vh.className="Sequential";Pe(vh);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let En=class extends Mu{getConfig(){return{}}};class u$ extends En{apply(e,t=1){return Oq(e,t)}}u$.className="elu";Pe(u$);class d$ extends En{apply(e){return hv(e)}}d$.className="selu";Pe(d$);class h$ extends En{apply(e){return ro(e)}}h$.className="relu";Pe(h$);class p$ extends En{apply(e){return me(()=>ql(6,ro(e)))}}p$.className="relu6";Pe(p$);class f$ extends En{apply(e){return e}}f$.className="linear";Pe(f$);class m$ extends En{apply(e){return Cr(e)}}m$.className="sigmoid";Pe(m$);class g$ extends En{apply(e){return Lq(e)}}g$.className="hardSigmoid";Pe(g$);class x$ extends En{apply(e){return Ou(e)}}x$.className="softplus";Pe(x$);class b$ extends En{apply(e){return Fq(e)}}b$.className="softsign";Pe(b$);class y$ extends En{apply(e){return Hl(e)}}y$.className="tanh";Pe(y$);let yw=class extends En{apply(e,t=-1){return Ix(e,t)}};yw.className="softmax";Pe(yw);class v$ extends En{apply(e,t=-1){return nv(e,t)}}v$.className="logSoftmax";Pe(v$);class w$ extends En{apply(e){return me(()=>me(()=>{const t=Math.sqrt(2),n=ne(.5,Fe(1,ev(Ze(e,t))));return ne(e,n)}))}}w$.className="gelu";Pe(w$);class N$ extends En{apply(e){return me(()=>ne(.5,ne(e,Fe(1,Hl(ne(wn(Ze(2,Math.PI)),Fe(e,ne(.044715,Oo(e,3)))))))))}}N$.className="gelu_new";Pe(N$);class S$ extends En{apply(e){return me(()=>ne(e,Hl(Ou(e))))}}S$.className="mish";Pe(S$);class C$ extends En{apply(e,t=1){return me(()=>ne(Cr(ne(e,t)),e))}}C$.className="swish";Pe(C$);function Pi(s){return s.getClassName()}function k1(s,e={}){return _p(s,sr.getMap().classNameMap,e,"activation")}function Bi(s){if(s==null){const e={};return e.className="linear",e.config={},k1(e)}if(typeof s=="string"){const e={};return e.className=s,e.config={},k1(e)}else return s instanceof En?s:k1(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YK(s){if(s!=null&&typeof s!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(s))}class k$ extends Mu{}class j$ extends k${constructor(e){super(),YK(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return me(()=>{let t=Ks([1]);return this.hasL1&&(t=Fe(t,at(ne(this.l1,qs(e))))),this.hasL2&&(t=Fe(t,at(ne(this.l2,Fp(e))))),le(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}j$.className="L1L2";Pe(j$);const _C={l1l2:"L1L2"};function ls(s){return rw(s)}function OC(s,e={}){return _p(s,sr.getMap().classNameMap,e,"regularizer")}function gs(s){if(s==null)return null;if(typeof s=="string"){const t={className:s in _C?_C[s]:s,config:{}};return OC(t)}else return s instanceof k$?s:OC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T$ extends Et{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=bt(e);let n=ro(e);return this.maxValue!=null&&(n=sa(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}T$.className="ReLU";Pe(T$);class I$ extends Et{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=bt(e);return xx(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}I$.className="LeakyReLU";Pe(I$);class $$ extends Et{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=ms(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=gs(e.alphaRegularizer),this.alphaConstraint=Js(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new de("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes))}build(e){e=qt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const a of this.sharedAxes)t[a-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(this.sharedAxes!=null)for(let a=1;a<e.length;++a)n[a]=e[a];this.inputSpec=[new Ys({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=bt(e),Cx(e,this.alpha.read())}getConfig(){const e={alphaInitializer:vs(this.alphaInitializer),alphaRegularizer:ls(this.alphaRegularizer),alphaConstraint:Qs(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}$$.className="PReLU";Pe($$);let A$=class extends Et{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new It("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=bt(e);return Tp(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};A$.className="ELU";Pe(A$);class E$ extends Et{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const n=bt(e);return ne(n,qe(Ca(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}E$.className="ThresholdedReLU";Pe(E$);class D$ extends Et{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new yw().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return me(()=>{let n=bt(e);const a=t.mask;if(a!=null){const o=ne(et(xa(n.shape),qe(a,n.dtype)),ht(-1e9));n=Fe(n,o)}return this.axis instanceof Array?this.axis.length>1?Bn(et(n,yx(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}D$.className="Softmax";Pe(D$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gu(s,e,t){if(typeof s=="number")return Yl(s,e);if(s.length!==e)throw new de("The ".concat(t," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(s.length," elements."));for(let n=0;n<e;++n){const a=s[n];if(!Eq(a))throw new de("The ".concat(t," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(s)," including a")+" non-integer number ".concat(a))}return s}function kr(s,e,t,n,a=1){if(s==null)return s;const o=e+(e-1)*(a-1);let i;return t==="same"?i=s:i=s-o+1,Math.floor((i+n-1)/n)}function Xr(s,e,t,n){if(s==null)return null;if(n==="valid")s=s*e+zi([t-e,0]);else if(n==="same")s=s*e;else throw new de("Unsupport padding mode: ".concat(n,"."));return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vw(s,e){return me(()=>(Os(e),e==="channelsFirst"?Pt(s,[0,2,3,1]):s))}function R$(s,e){return me(()=>(Os(e),e==="channelsFirst"?Pt(s,[0,2,3,4,1]):s))}function ZK(s,e,t,n=1,a="valid",o,i=1){return me(()=>{if(o==null&&(o=Ir()),Os(o),s.shape.length!==3)throw new de("The input of a conv1dWithBias operation should be 3, but is "+"".concat(s.shape.length," instead."));if(e.shape.length!==3)throw new de("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(t!=null&&t.shape.length!==1)throw new de("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if(o==="channelsFirst"&&(s=Pt(s,[0,2,1])),a==="causal")throw new It("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let c=X2(s,e,n,a==="same"?"same":"valid","NWC",i);return t!=null&&(c=Er(c,t)),c})}function FC(s,e,t,n=[1,1],a="valid",o,i,c=null){return me(()=>{if(o==null&&(o=Ir()),Os(o),s.rank!==3&&s.rank!==4)throw new de("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(s.rank,"."));if(e.rank!==3&&e.rank!==4)throw new de("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(s.rank,"."));let u=vw(s,o);if(a==="causal")throw new It("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=vT({x:u,filter:e,strides:n,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:c}),o==="channelsFirst"&&(u=Pt(u,[0,3,1,2])),u})}function QK(s,e,t,n=[1,1,1],a="valid",o,i){return me(()=>{if(o==null&&(o=Ir()),Os(o),s.rank!==4&&s.rank!==5)throw new de("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(s.rank,"."));if(e.rank!==4&&e.rank!==5)throw new de("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(s.rank,"."));let c=R$(s,o);if(a==="causal")throw new It("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return c=Pj(c,e,n,a==="same"?"same":"valid","NDHWC",i),t!=null&&(c=Er(c,t)),o==="channelsFirst"&&(c=Pt(c,[0,4,1,2,3])),c})}class Gx extends Et{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Gx.verifyArgs(t),this.rank=e,dn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new It("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=gu(t.kernelSize,e,"kernelSize"),this.strides=gu(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,Ma(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Os(this.dataFormat),this.activation=Bi(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=ms(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Js(t.biasConstraint),this.biasRegularizer=gs(t.biasRegularizer),this.activityRegularizer=gs(t.activityRegularizer),this.dilationRate=gu(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new de("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new de("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new de("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}}static verifyArgs(e){if(Kr("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!ow(e.kernelSize,"number",1,3))throw new de("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Pi(this.activation),useBias:this.useBias,biasInitializer:vs(this.biasInitializer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),biasConstraint:Qs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class zu extends Gx{constructor(e,t){super(e,t),this.kernel=null,zu.verifyArgs(t),this.filters=t.filters,dn(this.filters,"filters"),this.kernelInitializer=ms(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Js(t.kernelConstraint),this.kernelRegularizer=gs(t.kernelRegularizer)}build(e){e=qt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new de("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return me(()=>{e=bt(e);let n;const a=this.bias==null?null:this.bias.read(),o=$I(this.activation.getClassName());if(o!=null&&this.rank===2)n=FC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)n=ZK(e,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=FC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=QK(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new It("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(e){e=qt(e);const t=[],n=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<n.length;++o){const i=kr(n[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);t.push(i)}let a=[e[0]];return this.dataFormat==="channelsLast"?(a=a.concat(t),a.push(this.filters)):(a.push(this.filters),a=a.concat(t)),a}getConfig(){const e={filters:this.filters,kernelInitializer:vs(this.kernelInitializer),kernelRegularizer:ls(this.kernelRegularizer),kernelConstraint:Qs(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new de("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class Pp extends zu{constructor(e){super(2,e),Pp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ow(e.kernelSize,"number",1,2))throw new de("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Pp.className="Conv2D";Pe(Pp);class Bp extends zu{constructor(e){super(3,e),Bp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new de("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}Bp.className="Conv3D";Pe(Bp);class _$ extends Pp{constructor(e){if(super(e),this.inputSpec=[new Ys({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new de("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=qt(e),e.length!==4)throw new de("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new de("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ys({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{let n=bt(e);if(n.shape.length!==4)throw new de("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(n.shape.length));const a=n.shape,o=a[0];let i,c;this.dataFormat==="channelsFirst"?(i=2,c=3):(i=1,c=2);const u=a[i],h=a[c],p=this.kernelSize[0],f=this.kernelSize[1],g=this.strides[0],b=this.strides[1],y=Xr(u,g,p,this.padding),v=Xr(h,b,f,this.padding),w=[o,y,v,this.filters];this.dataFormat!=="channelsLast"&&(n=Pt(n,[0,2,3,1]));let N=Z2(n,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(N=Pt(N,[0,3,1,2])),this.bias!=null&&(N=Er(N,this.bias.read(),this.dataFormat)),this.activation!=null&&(N=this.activation.apply(N)),N})}computeOutputShape(e){e=qt(e);const t=e.slice();let n,a,o;this.dataFormat==="channelsFirst"?(n=1,a=2,o=3):(n=3,a=1,o=2);const i=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],h=this.strides[1];return t[n]=this.filters,t[a]=Xr(t[a],u,i,this.padding),t[o]=Xr(t[o],h,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}_$.className="Conv2DTranspose";Pe(_$);class O$ extends Bp{constructor(e){if(super(e),this.inputSpec=[new Ys({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new de("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=qt(e),e.length!==5)throw new de("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new de("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ys({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{let n=bt(e);if(n.shape.length!==5)throw new de("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(n.shape.length));const a=n.shape,o=a[0];let i,c,u;this.dataFormat==="channelsFirst"?(u=2,i=3,c=4):(u=1,i=2,c=3);const h=a[u],p=a[i],f=a[c],g=this.kernelSize[0],b=this.kernelSize[1],y=this.kernelSize[2],v=this.strides[0],w=this.strides[1],N=this.strides[2],C=Xr(h,v,g,this.padding),I=Xr(p,w,b,this.padding),T=Xr(f,N,y,this.padding),$=[o,C,I,T,this.filters];this.dataFormat!=="channelsLast"&&(n=Pt(n,[0,2,3,4,1]));let E=Vj(n,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(E=Pt(E,[0,4,1,2,3])),this.bias!==null&&(E=Er(E,this.bias.read(),this.dataFormat)),this.activation!==null&&(E=this.activation.apply(E)),E})}computeOutputShape(e){e=qt(e);const t=e.slice();let n,a,o,i;this.dataFormat==="channelsFirst"?(n=1,a=2,o=3,i=4):(n=4,a=1,o=2,i=3);const c=this.kernelSize[0],u=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],f=this.strides[1],g=this.strides[2];return t[n]=this.filters,t[a]=Xr(t[a],p,c,this.padding),t[o]=Xr(t[o],f,u,this.padding),t[i]=Xr(t[i],g,h,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}O$.className="Conv3DTranspose";Pe(O$);class F$ extends zu{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new de("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new de("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new de("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=ms(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=gs(t.depthwiseRegularizer),this.depthwiseConstraint=Js(t.depthwiseConstraint),this.pointwiseInitializer=ms(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=gs(t.pointwiseRegularizer),this.pointwiseConstraint=Js(t.pointwiseConstraint)}build(e){if(e=qt(e),e.length<this.rank+2)throw new de("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new de("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),o=[];for(let c=0;c<this.rank;++c)o.push(1);o.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Ys({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{e=bt(e);let n;if(this.rank===1)throw new It("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Pt(e,[0,2,3,1])),n=pv(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=Er(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Pt(n,[0,3,1,2])),n})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=vs(this.depthwiseInitializer),e.pointwiseInitializer=vs(this.pointwiseInitializer),e.depthwiseRegularizer=ls(this.depthwiseRegularizer),e.pointwiseRegularizer=ls(this.pointwiseRegularizer),e.depthwiseConstraint=Qs(this.depthwiseConstraint),e.pointwiseConstraint=Qs(this.pointwiseConstraint),e}}F$.className="SeparableConv";class L$ extends F${constructor(e){super(2,e)}}L$.className="SeparableConv2D";Pe(L$);class Wx extends zu{constructor(e){super(1,e),Wx.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ow(e.kernelSize,"number",1,1))throw new de("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Wx.className="Conv1D";Pe(Wx);class M$ extends Et{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return me(()=>{if(e=bt(e),this.dataFormat==="channelsLast"){const n=cm(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return cm(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const n=cm(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return cm(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}M$.className="Cropping2D";Pe(M$);class z$ extends Et{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Os(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Iq(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{const t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return me(()=>{let n=bt(e);const a=n.shape;if(this.dataFormat==="channelsFirst"){n=Pt(n,[0,2,3,1]);const o=this.size[0]*a[2],i=this.size[1]*a[3],c=this.interpolation==="nearest"?Ra.resizeNearestNeighbor(n,[o,i]):Ra.resizeBilinear(n,[o,i]);return Pt(c,[0,3,1,2])}else{const o=this.size[0]*a[1],i=this.size[1]*a[2];return this.interpolation==="nearest"?Ra.resizeNearestNeighbor(n,[o,i]):Ra.resizeBilinear(n,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}z$.className="UpSampling2D";Pe(z$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JK(s,e,t=[1,1],n="valid",a,o){return me(()=>{a==null&&(a=Ir()),Os(a);let i=vw(s,a);if(s.rank!==4)throw new de("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(s.rank,"-D"));if(e.rank!==4)throw new de("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return i=jp(i,e,t,n==="same"?"same":"valid","NHWC",o),a==="channelsFirst"&&(i=Pt(i,[0,3,1,2])),i})}class P$ extends Gx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=ms(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Js(e.depthwiseConstraint),this.depthwiseRegularizer=gs(e.depthwiseRegularizer)}build(e){if(e=qt(e),e.length<4)throw new de("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new de("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{e=bt(e);let n=JK(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=Er(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=qt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=kr(t,this.kernelSize[0],this.padding,this.strides[0]),i=kr(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],a,o,i]:[e[0],o,i,a]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=vs(this.depthwiseInitializer),e.depthwiseRegularizer=ls(this.depthwiseRegularizer),e.depthwiseConstraint=Qs(this.depthwiseRegularizer),e}}P$.className="DepthwiseConv2D";Pe(P$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function B$(s,e,t,n){if(Array.isArray(s)){if(e!=null||t!=null)throw new de("When inputs is an array, neither initialState or constants should be provided");n!=null&&(t=s.slice(s.length-n,s.length),s=s.slice(0,s.length-n)),s.length>1&&(e=s.slice(1,s.length)),s=s[0]}function a(o){return o==null||Array.isArray(o)?o:[o]}return e=a(e),t=a(t),{inputs:s,initialState:e,constants:t}}function V$(s,e,t,n=!1,a,o,i=!1,c=!1){return me(()=>{const u=e.shape.length;if(u<3)throw new de("Input should be at least 3D, but is ".concat(u,"D."));const h=[1,0].concat(Tr(2,u));e=Pt(e,h),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=qe(qe(a,"bool"),"float32"),a.rank===u-1&&(a=xn(a,-1)),a=Pt(a,h)),n&&(e=cr(e,0),a!=null&&(a=cr(a,0)));const p=[];let f,g=t;const b=e.shape[0],y=ur(e);let v;a!=null&&(v=ur(a));for(let N=0;N<b;++N){const C=y[N],I=me(()=>s(C,g));if(a==null)f=I[0],g=I[1];else{const T=me(()=>{const $=v[N],E=et(Fa($),$),_=Fe(ne(I[0],$),ne(g[0],E)),L=g.map((O,z)=>Fe(ne(I[1][z],$),ne(O,E)));return{output:_,newStates:L}});f=T.output,g=T.newStates}c&&p.push(f)}let w;return c&&(w=va(p,1)),[f,w,g]})}class Ji extends Et{constructor(e){super(e);let t;if(e.cell==null)throw new de("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new Sw({cells:e.cell}):t=e.cell,t.stateSize==null)throw new de("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ys({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Tr(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){by(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let a;if(this.returnSequences?a=[e[0],e[1],n]:a=[e[0],n],this.returnState){const o=[];for(const i of t)o.push([e[0],i]);return[a].concat(o)}else return a}computeMask(e,t){return me(()=>{Array.isArray(t)&&(t=t[0]);const n=this.returnSequences?t:null;if(this.returnState){const a=this.states.map(o=>null);return[n].concat(a)}else return n})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new It("Constants support is not implemented in RNN yet.");by(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Ys({shape:[t,null,...n]});const a=[e[0]].concat(e.slice(2));this.cell.build(a);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Mt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new de("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=o.map(i=>new Ys({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){me(()=>{if(!this.stateful)throw new qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(n==null)throw new de("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Ks([n,a])):this.states_=[Ks([n,this.cell.stateSize])];else if(e==null)Ct(this.states_),this.keptStates!=null&&(Ct(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Ks([n,a])):this.states_[0]=Ks([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new de("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t===!0?this.keptStates.push(this.states_.slice()):Ct(this.states_);for(let a=0;a<this.states_.length;++a){const o=e[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,c=[n,i];if(!Mt(o.shape,c))throw new de("State ".concat(a," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(c,", received shape=").concat(o.shape));this.states_[a]=o}}this.states_=this.states_.map(a=>un(a.clone()))})}apply(e,t){let n=t==null?null:t.initialState,a=t==null?null:t.constants;t==null&&(t={});const o=B$(e,n,a,this.numConstants);e=o.inputs,n=o.initialState,a=o.constants;let i=[],c=[];if(n!=null){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(const h of n)this.stateSpec.push(new Ys({shape:h.shape}));c=c.concat(this.stateSpec)}if(a!=null&&(t.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof so){const h=[e].concat(i),p=this.inputSpec.concat(c),f=this.inputSpec;this.inputSpec=p;const g=super.apply(h,t);return this.inputSpec=f,g}else return super.apply(e,t)}call(e,t){return me(()=>{const n=t==null?null:t.mask,a=t==null?null:t.training;let o=t==null?null:t.initialState;e=bt(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new de("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(o.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const c={training:a},h=V$((y,v)=>{const w=this.cell.call([y].concat(v),c);return[w[0],w.slice(1)]},e,o,this.goBackwards,n,null,this.unroll,this.returnSequences),p=h[0],f=h[1],g=h[2];this.stateful&&this.resetStates(g,a);const b=this.returnSequences?f:p;return this.returnState?[b].concat(g):b})}getInitialState(e){return me(()=>{let t=Ks(e.shape);return t=at(t,[1,2]),t=Op(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?gy(t,[1,n]):t):this.cell.stateSize>1?[gy(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Ji.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){const a=t.cell,o=_o(a,n);return new e(Object.assign(t,{cell:o}))}}Ji.className="RNN";Pe(Ji);class Hx extends Et{}class ww extends Hx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,dn(this.units,"units"),this.activation=Bi(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=Js(e.kernelConstraint),this.recurrentConstraint=Js(e.recurrentConstraint),this.biasConstraint=Js(e.biasConstraint),this.dropout=Su([1,zi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,zi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=qt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{if(e=e,e.length!==2)throw new de("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const a=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Fa(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Fa(n),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,c=this.recurrentDropoutMask;i!=null?o=eo(ne(e,i),this.kernel.read()):o=eo(e,this.kernel.read()),this.bias!=null&&(o=Er(o,this.bias.read())),c!=null&&(n=ne(n,c));let u=Fe(o,eo(n,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Pi(this.activation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:Qs(this.kernelConstraint),recurrentConstraint:Qs(this.recurrentConstraint),biasConstraint:Qs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}ww.className="SimpleRNNCell";Pe(ww);class U$ extends Ji{constructor(e){e.cell=new ww(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return new e(t)}}U$.className="SimpleRNN";Pe(U$);class Nw extends Hx{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new de("GRUCell does not support reset_after parameter set to true.");this.units=e.units,dn(this.units,"units"),this.activation=Bi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Bi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=Js(e.kernelConstraint),this.recurrentConstraint=Js(e.recurrentConstraint),this.biasConstraint=Js(e.biasConstraint),this.dropout=Su([1,zi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,zi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=qt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{if(e=e,e.length!==2)throw new de("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training==null?!1:t.training;let a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Fa(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Fa(a),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let c,u,h;0<this.dropout&&this.dropout<1&&(e=ne(e,o[0]));let p=eo(e,this.kernel.read());this.useBias&&(p=Er(p,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ne(a,i[0]));const f=this.recurrentKernel.read(),[g,b]=ba(f,[2*this.units,this.units],f.rank-1),y=eo(a,g),[v,w,N]=ba(p,3,p.rank-1),[C,I]=ba(y,2,y.rank-1);c=this.recurrentActivation.apply(Fe(v,C)),u=this.recurrentActivation.apply(Fe(w,I));const T=eo(ne(u,a),b);h=this.activation.apply(Fe(N,T));const $=Fe(ne(c,a),ne(Fe(1,fs(c)),h));return[$,$]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Pi(this.activation),recurrentActivation:Pi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:Qs(this.kernelConstraint),recurrentConstraint:Qs(this.recurrentConstraint),biasConstraint:Qs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Nw.className="GRUCell";Pe(Nw);class G$ extends Ji{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Nw(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}G$.className="GRU";Pe(G$);class qx extends Hx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,dn(this.units,"units"),this.activation=Bi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Bi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=Js(e.kernelConstraint),this.recurrentConstraint=Js(e.recurrentConstraint),this.biasConstraint=Js(e.biasConstraint),this.dropout=Su([1,zi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,zi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=qt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let a;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;a=new(t=class extends hr{apply(u,h){const p=o.apply([i]),f=new lw().apply([i]),g=o.apply([i*2]);return yC(yC(p,f),g)}},t.className="CustomInit",t)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return me(()=>{const n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new de("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let a=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Fa(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Fa(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,c=this.recurrentDropoutMask;let u,h,p,f;0<this.dropout&&this.dropout<1&&(e=ne(e,i[0]));let g=eo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ne(a,c[0])),g=Fe(g,eo(a,this.recurrentKernel.read())),this.useBias&&(g=Er(g,this.bias.read()));const[b,y,v,w]=ba(g,4,g.rank-1);u=this.recurrentActivation.apply(b),h=this.recurrentActivation.apply(y),p=Fe(ne(h,o),ne(u,this.activation.apply(v))),f=this.recurrentActivation.apply(w);const N=ne(f,this.activation.apply(p));return[N,N,p]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Pi(this.activation),recurrentActivation:Pi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:Qs(this.kernelConstraint),recurrentConstraint:Qs(this.recurrentConstraint),biasConstraint:Qs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}qx.className="LSTMCell";Pe(qx);class W$ extends Ji{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new qx(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}W$.className="LSTM";Pe(W$);class Sw extends Hx{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return me(()=>{e=e;let n=e.slice(1);const a=[];for(const c of this.cells.slice().reverse())Array.isArray(c.stateSize)?a.push(n.splice(0,c.stateSize.length)):a.push(n.splice(0,1));a.reverse();const o=[];let i;for(let c=0;c<this.cells.length;++c){const u=this.cells[c];n=a[c],c===0?i=[e[0]].concat(n):i=[i[0]].concat(n),i=u.call(i,t),o.push(i.slice(1))}n=[];for(const c of o.slice().reverse())n.push(...c);return[i[0]].concat(n)})}build(e){by(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,a)=>{Fl("RNNCell_".concat(a),()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=o=>({className:o.getClassName(),config:o.getConfig()}),a={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),a)}static fromConfig(e,t,n={}){const a=[];for(const o of t.cells)a.push(_o(o,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return yy(e)}setWeights(e){const t=[];for(const n of this.cells){const a=n.weights.length,o=e.splice(a);for(let i=0;i<n.weights.length;++i)t.push([n.weights[i],o[i]])}mw(t)}}Sw.className="StackedRNNCells";Pe(Sw);function Vi(s){const{ones:e,rate:t,training:n=!1,count:a=1,dropoutFunc:o}=s,i=()=>o!=null?o(e(),t):FI(e(),t),c=()=>Lp(i,e,n);return!a||a<=1?un(c().clone()):Array(a).fill(void 0).map(c).map(h=>un(h.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var eX=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};class H$ extends Ji{constructor(e){if(e.unroll)throw new It("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new It("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ys({ndim:5})]}call(e,t){return me(()=>{if(this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new de("ConvRNN2D cell does not support constants");const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return me(()=>{const{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),o=[a[0],...a.slice(2)],i=Ks(o);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){me(()=>{if(!this.stateful)throw new qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),o=[a[0],...a.slice(2)];if(n[0]==null)throw new de("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ks(o)):this.states_=[Ks(o)];else if(e==null)Ct(this.states_),this.keptStates!=null&&(Ct(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ks(o)):this.states_[0]=Ks(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new de("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):Ct(this.states_);for(let c=0;c<this.states_.length;++c){const u=e[c],h=o;if(!Mt(u.shape,h))throw new de("State ".concat(c," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(h,", received shape=").concat(u.shape));this.states_[c]=u}}this.states_=this.states_.map(c=>un(c.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:a,padding:o,strides:i,dilationRate:c}=this.cell,u=t==="channelsFirst",h=e[u?3:2],p=e[u?4:3],f=kr(h,a[0],o,i[0],c[0]),g=kr(p,a[1],o,i[1],c[1]);return[...e.slice(0,2),...u?[n,f,g]:[f,g,n]]}}H$.className="ConvRNN2D";class Cw extends qx{constructor(e){const{filters:t,kernelSize:n,strides:a,padding:o,dataFormat:i,dilationRate:c}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,dn(this.filters,"filters"),this.kernelSize=gu(n,2,"kernelSize"),this.kernelSize.forEach(u=>dn(u,"kernelSize")),this.strides=gu(a||1,2,"strides"),this.strides.forEach(u=>dn(u,"strides")),this.padding=o||"valid",Ma(this.padding),this.dataFormat=i||"channelsLast",Os(this.dataFormat),this.dilationRate=gu(c||1,2,"dilationRate"),this.dilationRate.forEach(u=>dn(u,"dilationRate"))}build(e){var t;e=qt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new de("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const a=e[n],o=4,i=this.kernelSize.concat([a,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const c=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",c,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const h=this.biasInitializer,p=this.filters;u=new(t=class extends hr{apply(g,b){const y=h.apply([p]),v=xa([p]),w=h.apply([p*2]);return iw([y,v,w])}},t.className="CustomInit",t)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return me(()=>{if(e.length!==3)throw new de("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,a=e[0],o=e[1],i=e[2],c=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Fa(a),rate:this.dropout,training:n,count:c,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,h=(ae,we,Ce)=>!we||!we[Ce]?ae:ne(we[Ce],ae);let p=h(a,u,0),f=h(a,u,1),g=h(a,u,2),b=h(a,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Fa(o),rate:this.recurrentDropout,training:n,count:c,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let v=h(o,y,0),w=h(o,y,1),N=h(o,y,2),C=h(o,y,3);const I=3,[T,$,E,_]=ba(this.kernel.read(),c,I),[L,O,z,A]=this.useBias?ba(this.bias.read(),c):[null,null,null,null];p=this.inputConv(p,T,L,this.padding),f=this.inputConv(f,$,O,this.padding),g=this.inputConv(g,E,z,this.padding),b=this.inputConv(b,_,A,this.padding);const[U,X,Z,q]=ba(this.recurrentKernel.read(),c,I);v=this.recurrentConv(v,U),w=this.recurrentConv(w,X),N=this.recurrentConv(N,Z),C=this.recurrentConv(C,q);const B=this.recurrentActivation.apply(Fe(p,v)),K=this.recurrentActivation.apply(Fe(f,w)),J=Fe(ne(K,i),ne(B,this.activation.apply(Fe(g,N)))),Q=ne(this.recurrentActivation.apply(Fe(b,C)),this.activation.apply(J));return[Q,Q,J]})}getConfig(){const e=super.getConfig(),{units:t}=e,n=eX(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){const o=Li(e,t,this.strides,a||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?Er(o,n,this.dataFormat):o}recurrentConv(e,t){return Li(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Cw.className="ConvLSTM2DCell";Pe(Cw);class q$ extends H${constructor(e){const t=new Cw(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}q$.className="ConvLSTM2D";Pe(q$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kw extends Et{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,n=[];for(let a=0;a<this.noiseShape.length;++a)n.push(this.noiseShape[a]==null?t[a]:this.noiseShape[a]);return n}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e);if(0<this.rate&&this.rate<1){const a=t.training==null?!1:t.training,o=this.getNoiseShape(n);return Lp(()=>FI(n,this.rate,o,this.seed),()=>n,a)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}kw.className="Dropout";Pe(kw);class K$ extends kw{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}K$.className="SpatialDropout1D";Pe(K$);class X$ extends Et{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,dn(this.units,"units"),this.activation=Bi(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Js(e.kernelConstraint),this.biasConstraint=Js(e.biasConstraint),this.kernelRegularizer=gs(e.kernelRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=qt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=qt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e),a=$I(this.activation.getClassName());let o;return a!=null?o=eo(n,this.kernel.read(),a,this.bias?this.bias.read():null):(o=eo(n,this.kernel.read()),this.bias!=null&&(o=Er(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:Pi(this.activation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:Qs(this.kernelConstraint),biasConstraint:Qs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}X$.className="Dense";Pe(X$);class Y$ extends Et{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=qt(e);for(const t of e.slice(1))if(t==null)throw new de('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],Di(e,1)]}call(e,t){return me(()=>{this.invokeCallHook(e,t);let n=bt(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){const a=[0];for(let o=2;o<n.rank;++o)a.push(o);a.push(1),n=Pt(n,a)}return _q(n)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}Y$.className="Flatten";Pe(Y$);class Z$ extends Et{constructor(e){super(e),this.supportsMasking=!0,this.activation=Bi(e.activation)}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e);return this.activation.apply(n)})}getConfig(){const e={activation:Pi(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}Z$.className="Activation";Pe(Z$);class Q$ extends Et{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return me(()=>(e=bt(e),Dq(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}Q$.className="RepeatVector";Pe(Q$);class J$ extends Et{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",a=t.slice();let o=1,i=null;for(let u=0;u<a.length;++u){const h=a[u];if(this.isUnknown(h))if(i===null)i=u;else throw new de("Can only specifiy one unknown dimension.");else o*=h}const c=Di(e);if(i!==null){if(o===0||c%o!==0)throw new de(n);a[i]=c/o}else if(c!==o)throw new de(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e),a=n.shape,o=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return le(n,o)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}J$.className="Reshape";Pe(J$);class eA extends Et{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=Tr(1,e.dims.length+1);if(!Mt(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ys({ndim:this.dims.length+1})]}computeOutputShape(e){e=qt(e);const t=e.slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return Pt(bt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}eA.className="Permute";Pe(eA);class tA extends Et{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=bt(e);return Lm(wu(n,this.maskValue),-1)}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e),i=Lm(wu(n,this.maskValue),-1,!0);return ne(n,qe(i,n.dtype))})}}tA.className="Masking";Pe(tA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sA extends Et{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Zt(e.inputLength))}this.inputDim=e.inputDim,dn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,dn(this.outputDim,"outputDim"),this.embeddingsInitializer=ms(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=gs(e.embeddingsRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.embeddingsConstraint=Js(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return me(()=>this.maskZero?(e=bt(e),wu(e,Bt(e))):null)}computeOutputShape(e){if(e=qt(e),this.inputLength==null)return[...e,this.outputDim];const t=Zt(this.inputLength);if(t.length!==e.length-1)throw new de('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let a=0;a<t.length;++a){const o=t[a],i=e[a+1];if(o!=null&&i!=null&&o!==i)throw new de('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));o==null&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return me(()=>{this.invokeCallHook(e,t);let n=bt(e);n.dtype!=="int32"&&(n=Jr(n,"int32"));const a=OI(this.embeddings.read(),le(n,[n.size]));return le(a,qt(this.computeOutputShape(n.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vs(this.embeddingsInitializer),embeddingsRegularizer:ls(this.embeddingsRegularizer),activityRegularizer:ls(this.activityRegularizer),embeddingsConstraint:Qs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}sA.className="Embedding";Pe(sA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rc extends Et{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new It}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){const o=e[e.length-t.length+a],i=t[a];if(o==null||i==null||o<0||i<0)n.push(null);else if(o===1)n.push(i);else if(i===1)n.push(o);else{if(o!==i)throw new de("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(o)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[qt(e)]),e=e,e.length<2)throw new de("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const o of e)o!=null&&o[0]!==null&&t.push(o[0]);if(t=Ei(t),t.length>1)throw new de("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}const a=e.map(o=>o.length);e.indexOf(null)===-1&&Ei(a).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return me(()=>{if(e=e,this.reshapeRequired){const n=[],a=e.map(o=>o.rank);if(a.indexOf(null)===-1){const o=zi(a);for(let i of e){const c=i.rank;for(let u=0;u<o-c;++u)i=Op(i,1);n.push(i)}return this.mergeFunction(n)}else{let o=!1;for(const u of e){const h=u.rank;if(h==null){const p=u.shape,f=p[0],g=p.slice(1).concat([f]);let b=le(u,[f].concat(Di(p.slice(1))));b=Pt(b,[1,0]),b=le(b,g),n.push(b),o=!0}else if(h>1){const p=Tr(1,h).concat([0]);n.push(Pt(u,p)),o=!0}else n.push(u)}let i=this.mergeFunction(n);const c=i.rank;if(o){if(c==null){const u=i.shape,h=u.length,p=u[h-1],f=[p].concat(u.slice(0,u.length-1));i=le(Pt(le(i,[-1,p]),[1,0]),f)}else if(c>1){const u=[c-1].concat(Tr(0,c-1));i=Pt(i,u)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let a=1;a<e.length;++a){const o=e[a]==null?null:e[a].slice(1);t=this.computeElementwiseOpOutputShape(t,o)}let n=[];for(const a of e)a!=null&&a[0]!==null&&n.push(a[0]);return n=Ei(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return me(()=>{if(t==null)return null;if(!Array.isArray(t))throw new de("`mask` should be an Array");if(!Array.isArray(e))throw new de("`inputs` should be an Array");if(t.length!==e.length)throw new de("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every(a=>a==null))return null;t=t.map(a=>a==null?a:xn(a,0));let n=t[0];for(let a=1;a<t.length-1;++a)n=to(n,t[a]);return n})}}class nA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Fe(t,e[n]);return t})}}nA.className="Add";Pe(nA);class aA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ne(t,e[n]);return t})}}aA.className="Multiply";Pe(aA);class rA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Fe(t,e[n]);return ne(1/e.length,t)})}}rA.className="Average";Pe(rA);class oA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Wo(t,e[n]);return t})}}oA.className="Maximum";Pe(oA);class iA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=ql(t,e[n]);return t})}}iA.className="Minimum";Pe(iA);class lA extends rc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new de("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const a of e)if(a!=null){t=!1;break}if(t)return;const n=[];for(let a=0;a<e.length;++a){const o=e[a].slice();o.splice(this.axis,1);let i=!1;for(const c of n)if(Mt(c,o)){i=!0;break}i||n.push(o)}if(n.length>1)throw new de("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return me(()=>iw(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new de("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),a=this.axis<0?n.length+this.axis:this.axis;for(const o of t.slice(1)){if(n[a]==null||o[a]==null){n[a]=null;break}n[a]+=o[a]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new de("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new de("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new de("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return me(()=>{let n=!0;if(t.forEach(i=>{if(i!=null){n=!1;return}}),n)return null;const a=[];for(let i=0;i<e.length;++i)t[i]==null?a.push(qe(Fa(e[i]),"bool")):t[i].rank<e[i].rank?a.push(xn(t[i],-1)):a.push(t[i]);const o=Ts(a,this.axis);return q2(o,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}lA.className="Concatenate";Pe(lA);function nh(s,e){for(;s<0;)s+=e;return s}function tX(s,e,t){if(s.shape.length>3||e.shape.length>3)throw new It("batchDot is not implemented for tensors of 4D or higher rank yet");if(V(s.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(s.shape.length)),V(s.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length)),typeof t=="number"&&(t=[t,t]),s.dtype==="complex64"||e.dtype==="complex64")throw new It("batchDot is not implemented for complex64-type Tensors yet.");const n=s.shape.length,a=e.shape.length;t==null&&(t=[n-1,a-2]);const o=t;return me(()=>{let i;if(n>a){i=n-a;const u=[];for(let h=0;h<i;++h)u.push(1);e=le(e,e.shape.concat(u))}else if(a>n){i=a-n;const u=[];for(let h=0;h<i;++h)u.push(1);s=le(s,s.shape.concat(u))}else i=0;let c;if(s.shape.length===2&&e.shape.length===2)o[0]===o[1]?c=at(ne(s,e),o[0]):c=at(ne(Pt(s,[1,0]),e),o[1]);else{const u=o[0]!==s.shape.length-1,h=o[1]===e.shape.length-1;c=_t(s,e,u,h)}if(i>0){let u;n>a?u=n+a-3:u=n-1;const h=[];for(let p=u;p<u+i;++p)h.push(p);c=Es(c,h)}return c.shape.length===1&&(c=xn(c,1)),c})}class cA extends rc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){V(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new It("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new de("Dimension incompatibility: "+"".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){if(e.length!==2)throw new de("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t=e[0],n=e[1],a;return Array.isArray(this.axes)?a=this.axes.map((o,i)=>nh(o,e[i].shape.length)):a=[nh(this.axes,t.shape.length),nh(this.axes,n.shape.length)],this.normalize&&(t=Hm(t,a[0]),n=Hm(n,a[1])),tX(t,n,a)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[nh(this.axes,e.length),nh(this.axes,t.length)],n}computeOutputShape(e){V(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new It("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);const o=t.concat(n);return o.length===1&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}cA.className="Dot";Pe(cA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uA extends Et{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e);return Lp(()=>Fe(Px(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}}uA.className="GaussianNoise";Pe(uA);class dA extends Et{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=bt(e);return this.rate>0&&this.rate<1?Lp(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return ne(n,Px(n.shape,1,o))},()=>n,t.training||!1):n})}}dA.className="GaussianDropout";Pe(dA);class hA extends Et{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||bt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return me(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e);return Lp(()=>{const o=bt(e),c=-1.6732632423543772*1.0507009873554805;let u=Yi(sc(n),this.rate);u=Jr(u,"float32");const h=((1-this.rate)*(1+this.rate*c**2))**-.5,p=-h*c*this.rate,f=Fe(ne(o,u),ne(Fe(u,-1),c));return Fe(ne(f,h),p)},()=>bt(e),t.training||!1)}return e})}}hA.className="AlphaDropout";Pe(hA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wh(s,e,t,n,a,o=.001){let i;if(s.rank===2)i=Ej(s,e,t,n,a,o);else if(s.rank===3)i=Dj(s,e,t,n,a,o);else if(s.rank===4)i=Rj(s,e,t,n,a,o);else throw new It("batchNormalization is not implemented for array of rank ".concat(s.rank," ")+"yet");return i}function sX(s,e,t,n,a=.001){return me(()=>{const o=Nx(s,n),i=o.mean,c=o.variance;return[wh(s,i,c,t,e,a),i,c]})}function nX(s,e,t,n,a=.001){return me(()=>{const o=Nx(s,n),i=o.mean,c=o.variance,u=[];for(const y of Tr(0,s.rank))n.indexOf(y)!==-1?u.push(1):u.push(s.shape[y]);const h=le(i,u),p=le(c,u),f=e==null?null:le(e,u),g=t==null?null:le(t,u);return[wh(s,h,p,g,f,a),i,c]})}function aX(s,e,t,n,a=.001){return Mt(n.slice().sort(),Tr(0,s.rank-1))?sX(s,e,t,n,a):nX(s,e,t,n,a)}class pA extends Et{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ms(e.betaInitializer||"zeros"),this.gammaInitializer=ms(e.gammaInitializer||"ones"),this.movingMeanInitializer=ms(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ms(e.movingVarianceInitializer||"ones"),this.betaConstraint=Js(e.betaConstraint),this.gammaConstraint=Js(e.gammaConstraint),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer)}build(e){e=qt(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new de("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Ys({ndim:e.length,axes:{[t]:n}})];const a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return me(()=>{const n=t.training==null?!1:t.training,a=bt(e),o=a.shape,i=o.length,c=Tr(0,i),u=this.axis>=0?this.axis:this.axis+i;c.splice(u,1);const h=Yl(1,i);h[u]=o[u];const p=c.slice();p.sort();const f=!Mt(p,Tr(0,i).slice(0,i-1)),g=()=>{if(f){const C=le(this.movingMean.read(),h),I=le(this.movingVariance.read(),h),T=this.center?le(this.beta.read(),h):null,$=this.scale?le(this.gamma.read(),h):null;return wh(a,C,I,T,$,this.epsilon)}else return wh(a,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return g();const[b,y,v]=aX(a,this.gamma.read(),this.beta.read(),c,this.epsilon),w=(C,I,T)=>{me(()=>{const $=1-T,E=C.read(),_=ne(et(E,I),$);C.write(et(E,_))})};return(()=>{w(this.movingMean,y,this.momentum),w(this.movingVariance,v,this.momentum)})(),b})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vs(this.betaInitializer),gammaInitializer:vs(this.gammaInitializer),movingMeanInitializer:vs(this.movingMeanInitializer),movingVarianceInitializer:vs(this.movingVarianceInitializer),betaRegularizer:ls(this.betaRegularizer),gammaRegularizer:ls(this.gammaRegularizer),betaConstraint:Qs(this.betaConstraint),gammaConstraint:Qs(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}pA.className="BatchNormalization";Pe(pA);class fA extends Et{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}else throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ms(e.betaInitializer||"zeros"),this.gammaInitializer=ms(e.gammaInitializer||"ones"),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=qt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error("Invalid axis: ".concat(o));if(this.axis.length!==Ei(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map(o=>e[o]),a=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,t){const n=bt(e),a=n.shape,o=a.length;return me(()=>{let{mean:c,variance:u}=Nx(n,this.axis,!0);const h=Yl(1,o);for(const v of this.axis)h[v]=a[v];const p=v=>v!=null&&v.shape.length!==o?le(v,h):v;let f=this.scale?p(this.gamma.read()):null,g=this.center?p(this.beta.read()):null;const b=[],y=[];for(let v=0;v<o;++v)this.axis.indexOf(v)!==-1?(b.push(a[v]),y.push(1)):(b.push(1),y.push(a[v]));return c=nr(c,b),u=nr(u,b),f!=null&&(f=nr(f,y)),g!=null&&(g=nr(g,y)),wh(n,c,u,g,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vs(this.betaInitializer),gammaInitializer:vs(this.gammaInitializer),betaRegularizer:ls(this.betaRegularizer),gammaRegularizer:ls(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}fA.className="LayerNormalization";Pe(fA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rX(s,e,t){return me(()=>{if(s.rank!==4)throw new de("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(s.rank,"-D tensor."));if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new de("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Ir()),t!=="channelsLast"&&t!=="channelsFirst")throw new de("Unknown data format: ".concat(t,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let n;return t==="channelsFirst"?n=[[0,0],[0,0],e[0],e[1]]:n=[[0,0],e[0],e[1],[0,0]],Zi(s,n)})}class mA extends Et{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ir():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new de("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new de("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],e.padding[1].length!==2)throw new de("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new Ys({ndim:4})]}computeOutputShape(e){e=qt(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return me(()=>rX(bt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}mA.className="ZeroPadding2D";Pe(mA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kx(s,e,t,n,a,o){return me(()=>{Os(a),EI(o),Ma(n),t==null&&(t=[1,1]),n==null&&(n="valid"),a==null&&(a=Ir()),o==null&&(o="max"),s=vw(s,a);let i;const c=n==="same"?"same":"valid";return o==="max"?i=wx(s,e,t,c):i=px(s,e,t,c),a==="channelsFirst"&&(i=Pt(i,[0,3,1,2])),i})}function gA(s,e,t,n,a,o){return me(()=>{Os(a),EI(o),Ma(n),t==null&&(t=[1,1,1]),n==null&&(n="valid"),a==null&&(a=Ir()),o==null&&(o="max"),s=R$(s,a);let i;const c=n==="same"?"same":"valid";return o==="max"?i=nT(s,e,t,c):i=Aj(s,e,t,c),a==="channelsFirst"&&(i=Pt(i,[0,4,1,2,3])),i})}class xA extends Et{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new de("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));if(dn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new de("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ma(this.padding),this.inputSpec=[new Ys({ndim:3})]}computeOutputShape(e){e=qt(e);const t=kr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return me(()=>{this.invokeCallHook(e,t),e=Op(bt(e),2);const n=this.poolingFunction(bt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Es(n,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class bA extends xA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),Kx(e,t,n,a,o,"max")}}bA.className="MaxPooling1D";Pe(bA);class yA extends xA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),Kx(e,t,n,a,o,"avg")}}yA.className="AveragePooling1D";Pe(yA);class vA extends Et{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new de("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];dn(this.poolSize,"poolSize"),dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Os(this.dataFormat),Ma(this.padding),this.inputSpec=[new Ys({ndim:4})]}computeOutputShape(e){e=qt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=kr(t,this.poolSize[0],this.padding,this.strides[0]),n=kr(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return me(()=>(this.invokeCallHook(e,t),this.poolingFunction(bt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class wA extends vA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),Kx(e,t,n,a,o,"max")}}wA.className="MaxPooling2D";Pe(wA);class NA extends vA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),Kx(e,t,n,a,o,"avg")}}NA.className="AveragePooling2D";Pe(NA);class SA extends Et{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new de("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];dn(this.poolSize,"poolSize"),dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Os(this.dataFormat),Ma(this.padding),this.inputSpec=[new Ys({ndim:5})]}computeOutputShape(e){e=qt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=kr(t,this.poolSize[0],this.padding,this.strides[0]),n=kr(n,this.poolSize[1],this.padding,this.strides[1]),a=kr(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return me(()=>(this.invokeCallHook(e,t),this.poolingFunction(bt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class CA extends SA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),gA(e,t,n,a,o,"max")}}CA.className="MaxPooling3D";Pe(CA);class kA extends SA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Os(o),Ma(a),gA(e,t,n,a,o,"avg")}}kA.className="AveragePooling3D";Pe(kA);class jA extends Et{constructor(e){super(e),this.inputSpec=[new Ys({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new It}}class TA extends jA{constructor(e){super(e||{})}call(e,t){return me(()=>{const n=bt(e);return js(n,1)})}}TA.className="GlobalAveragePooling1D";Pe(TA);class IA extends jA{constructor(e){super(e||{})}call(e,t){return me(()=>{const n=bt(e);return ir(n,1)})}}IA.className="GlobalMaxPooling1D";Pe(IA);class $A extends Et{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Os(this.dataFormat),this.inputSpec=[new Ys({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new It}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class AA extends $A{call(e,t){return me(()=>{const n=bt(e);return this.dataFormat==="channelsLast"?js(n,[1,2]):js(n,[2,3])})}}AA.className="GlobalAveragePooling2D";Pe(AA);class EA extends $A{call(e,t){return me(()=>{const n=bt(e);return this.dataFormat==="channelsLast"?ir(n,[1,2]):ir(n,[2,3])})}}EA.className="GlobalMaxPooling2D";Pe(EA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DA extends Et{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){const a=t.layer,o=_o(a,n);delete t.layer;const i={layer:o};return Object.assign(i,t),new e(i)}}class RA extends DA{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=qt(e),e.length<3)throw new de("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=qt(e);const t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return me(()=>(e=bt(e),V$((i,c)=>[bt(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}RA.className="TimeDistributed";Pe(RA);function oX(s){ac(Tq,"BidirectionalMergeMode",s)}const iX="concat";class _A extends DA{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=_o(n),t.goBackwards=t.goBackwards!==!0;const a={};if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=_o(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?iX:e.mergeMode,oX(this.mergeMode),e.weights)throw new It("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,a,o;return this.returnState&&(o=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,a=[n]):this.mergeMode==null?a=[n,n.slice()]:a=[n],this.returnState?this.mergeMode==null?a.concat(o).concat(o.slice()):[n].concat(o).concat(o.slice()):Jn(a)}apply(e,t){let n=t==null?null:t.initialState,a=t==null?null:t.constants;t==null&&(t={});const o=B$(e,n,a,this.numConstants);if(e=o.inputs,n=o.initialState,a=o.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&a==null)return super.apply(e,t);const i=[],c=[];if(n!=null){const h=n.length;if(h%2>0)throw new de("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);const p=n.map(f=>new Ys({shape:f.shape}));this.forwardLayer.stateSpec=p.slice(0,h/2),this.backwardLayer.stateSpec=p.slice(h/2),c.push(...p)}if(a!=null)throw new It("Support for constants in Bidirectional layers is not implemented yet.");const u=i[0]instanceof so;for(const h of i)if(h instanceof so!==u)throw new de("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const h=[e].concat(i),p=this.inputSpec.concat(c),f=this.inputSpec;this.inputSpec=p;const g=super.apply(h,t);return this.inputSpec=f,g}else return super.apply(e,t)}call(e,t){return me(()=>{const n=t.initialState;let a,o;if(n==null)a=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const u=n.slice(0,n.length/2),h=n.slice(n.length/2);a=this.forwardLayer.call(e,Object.assign(t,{initialState:u})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:h}))}let i;this.returnState&&(Array.isArray(a)&&(i=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),this.returnSequences&&(o=cr(o,1));let c;return this.mergeMode==="concat"?c=iw([a,o]):this.mergeMode==="sum"?c=Fe(a,o):this.mergeMode==="ave"?c=ne(.5,Fe(a,o)):this.mergeMode==="mul"?c=ne(a,o):this.mergeMode==null&&(c=[a,o]),this.returnState?this.mergeMode==null?c.concat(i):[c].concat(i):c})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Fl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Fl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(n)?n.concat(o).concat(o):[n].concat(o).concat(o)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=_o(t.layer);if(delete t.layer,t.numConstants!=null)throw new It("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const a=t;return a.layer=n,new e(a)}}_A.className="Bidirectional";Pe(_A);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class OA extends Et{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return me(()=>(e=bt(e),e.dtype!=="float32"&&(e=Jr(e,"float32")),Fe(ne(e,this.scale),this.offset)))}}OA.className="Rescaling";Pe(OA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:lX,cropAndResize:cX}=Ra;class FA extends Et{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,a,o,i,c,u){return me(()=>{let h,p=!1;const f=t/i,g=n/c,b=(a+t)/i,y=(o+n)/c,v=[f,g,b,y],w=[];e.rank===3?(p=!0,h=va([e])):h=e;for(let $=0;$<h.shape[0];$++)w.push(v);const N=Sr(w,[w.length,4]),C=Nu(0,w.length,1,"int32"),T=cX(h,N,C,[a,o],"nearest");return Jr(p?bt(ur(T)):T,u)})}upsize(e,t,n,a){return me(()=>{const o=lX(e,[t,n]);return Jr(o,a)})}call(e,t){return me(()=>{const n=bt(e),a=n.dtype,o=n.shape,i=o[o.length-3],c=o[o.length-2];let u=0;i!==this.height&&(u=Math.floor((i-this.height)/2));let h=0;return c!==this.width&&(h=Math.floor((c-this.width)/2),h===0&&(h=1)),u>=0&&h>=0?this.centerCrop(n,u,h,this.height,this.width,i,c,a):this.upsize(e,this.height,this.width,a)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=qt(e);const t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}FA.className="CenterCrop";Pe(FA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uX(s,e,t,n){let a=bt(s);if(a.dtype!=="int32"&&(a=Jr(a,"int32")),e==="int")return a;const o=a.shape;if(a.rank===0&&(a=xn(a,-1)),e==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=xn(a,-1)),a.rank>2)throw new de("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(e," and input shape ").concat(o)+" which would result in output rank ".concat(a.rank,"."));const i=["multiHot","oneHot"].includes(e),c=a;let u;if(typeof n<"u"&&e==="count"?u=J1(c,n,t,i):u=J1(c,[],t,i),e!=="tfIdf")return u;if(n)return ne(u,n);throw new de("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LA extends Et{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=qt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return me(()=>{e=bt(e),e.dtype!=="int32"&&(e=Jr(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new de("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=bt(t.countWeights)}const a=ir(e),o=ph(e),i=Ca(this.numTokens,a).bufferSync().get(0),c=Yi(o,0).bufferSync().get(0);if(!(i&&c))throw new de("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return uX(e,this.outputMode,this.numTokens,n)})}}LA.className="CategoryEncoding";Pe(LA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dX=["bilinear","nearest"],LC=new Set(dX);class MA extends Et{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(LC.has(e.interpolation))this.interpolation=e.interpolation;else throw new de("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=qt(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return me(()=>{const n=[this.height,this.width];if(this.interpolation==="bilinear")return Ra.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Ra.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...LC]," are supported"))})}}MA.className="Resizing";Pe(MA);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zA{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}zA.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PA extends Et{constructor(e){super(e),this.randomGenerator=new zA(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}PA.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hX=["bilinear","nearest"],MC=new Set(hX);class BA extends PA{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new de("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));if(this.widthLower<-1||this.widthUpper<-1)throw new de("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new de("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n)if(MC.has(n))this.interpolation=n;else throw new de("Invalid interpolation parameter: ".concat(n," is not implemented"))}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=qt(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return me(()=>{const n=bt(e);this.imgHeight=n.shape[n.shape.length-3];const a=n.shape[n.shape.length-2];this.widthFactor=sc([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*a;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return Ra.resizeBilinear(e,i);case"nearest":return Ra.resizeNearestNeighbor(e,i);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...MC]," are supported"))}})}}BA.className="RandomWidth";Pe(BA);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var zC;(function(s){s[s.FAIL=0]="FAIL",s[s.SHORTEST=1]="SHORTEST",s[s.LONGEST=2]="LONGEST"})(zC||(zC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(s,e){Array.isArray(s)||(s=[s]),s.forEach(t=>{t!=null&&V(t.dtype!=="complex64",()=>"".concat(e," does not support complex64 tensors in the CPU backend."))})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=Nv;class Xx extends Oy{nextDataId(){return Xx.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Ok(this,Wr())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Se().get("IS_NODE")&&Da("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if(t==="string"&&n!=null&&n.length>0&&Th(n[0])){const o=n.map(i=>Ai(i));a=this.write(o,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,n,a,o){this.data.set(e,{values:t,dtype:a,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){const a=this.readSync(n.real.dataId),o=this.readSync(n.imag.dataId);return Lo(a,o)}return q8(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(a=>Ri(a));return $t(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return $t(e.shape,e.dtype,t)}makeOutput(e,t,n){return Wr().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Qn();return e(),{kernelMs:Qn()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){rt([e],"where");const t=this.readSync(e.dataId);return pX(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Xx.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VA(s){const e=new Float32Array(s.length);for(let t=0;t<s.length;++t)e[t]=Math.abs(s[t]);return e}const fX=s=>{const{x:e}=s.inputs,t=s.backend;rt(e,"abs");let n=new Float32Array(Ae(e.shape));const a=t.data.get(e.dataId).values;return n=VA(a),t.makeOutput(n,e.shape,e.dtype)},mX={kernelName:cg,backendName:"cpu",kernelFunc:fX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(s){return(e,t,n,a,o)=>{const i=kt(e,t),c=i.length,u=ut(i),h=Ae(i),p=vn(o,h),f=e.length,g=t.length,b=ut(e),y=ut(t),v=vu(e,i),w=vu(t,i);if(v.length+w.length===0)for(let N=0;N<p.length;++N)p[N]=s(n[N%n.length],a[N%a.length]);else for(let N=0;N<p.length;++N){const C=Du(N,c,u),I=C.slice(-f);v.forEach(_=>I[_]=0);const T=Zr(I,f,b),$=C.slice(-g);w.forEach(_=>$[_]=0);const E=Zr($,g,y);p[N]=s(n[T],a[E])}return[p,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(s){const{inputs:e,backend:t}=s,{real:n,imag:a}=e,o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,c=t.makeTensorInfo(n.shape,"complex64"),u=t.data.get(c.dataId);return u.complexTensorInfos={real:t.makeTensorInfo(n.shape,"float32",o),imag:t.makeTensorInfo(a.shape,"float32",i)},c}const gX={kernelName:Wy,backendName:"cpu",kernelFunc:ga};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zm(s,e,t="float32"){if(t==="complex64"){const a=Zm(s,e,"float32"),o=Zm(s,e,"float32");return ga({inputs:{real:a,imag:o},backend:s})}const n=An(Ae(e),t);return s.makeTensorInfo(e,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(s){const{inputs:e,backend:t}=s,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const xX={kernelName:Kh,backendName:"cpu",kernelFunc:no};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zl(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.data.get(n.dataId).complexTensorInfos.real,o=t.data.get(a.dataId).values;return t.makeTensorInfo(a.shape,a.dtype,o)}const bX={kernelName:S2,backendName:"cpu",kernelFunc:Zl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UA(s,e,t,n){if(n==="int32"){const a=Int32Array.from(s);return[e,"int32",a]}if(n==="bool"){const a=ec([0],t),[o,i]=Fs((c,u)=>c!==u?1:0)(e,[],s,a,"bool");return[i,"bool",o]}throw new Error("Error in Cast: failed to cast ".concat(t," to ").concat(n))}function Ui(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dtype:o}=n;if(o==="complex64"){if(a.dtype==="complex64")return no({inputs:{x:a},backend:t});const p=Zm(t,a.shape,a.dtype),f=Ui({inputs:{x:a},backend:t,attrs:{dtype:"float32"}}),g=ga({inputs:{real:f,imag:p},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),g}if(a.dtype==="complex64"){const p=Zl({inputs:{input:a},backend:t}),f=Ui({inputs:{x:p},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(p),f}if(!Lk(a.dtype,o)){const p=no({inputs:{x:a},backend:t});return{dataId:p.dataId,shape:p.shape,dtype:o}}const i=t.data.get(a.dataId).values,[c,u,h]=UA(i,a.shape,a.dtype,o);return t.makeTensorInfo(c,u,h)}const yX={kernelName:Oh,backendName:"cpu",kernelFunc:Ui};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(s,e,t,n){return t==null?({inputs:a,backend:o})=>{const{a:i,b:c}=a,u=o;rt([i,c],s);const h=u.data.get(i.dataId).values,p=u.data.get(c.dataId).values,f=i.dtype==="string"?Mo(h):h,g=i.dtype==="string"?Mo(p):p,b=n||i.dtype,[y,v]=e(i.shape,c.shape,f,g,b);return u.makeTensorInfo(v,b,y)}:({inputs:a,backend:o})=>{const{a:i,b:c}=a,u=o;if(i.dtype==="complex64"||c.dtype==="complex64"){const h=Ui({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),p=u.data.get(h.dataId),f=p.complexTensorInfos.real,g=p.complexTensorInfos.imag,b=u.data.get(f.dataId).values,y=u.data.get(g.dataId).values,v=Ui({inputs:{x:c},backend:u,attrs:{dtype:"complex64"}}),w=u.data.get(v.dataId),N=w.complexTensorInfos.real,C=w.complexTensorInfos.imag,I=u.data.get(N.dataId).values,T=u.data.get(C.dataId).values,[$,E,_]=t(i.shape,c.shape,b,y,I,T),L=u.makeTensorInfo(_,"float32",$),O=u.makeTensorInfo(_,"float32",E),z=ga({inputs:{real:L,imag:O},backend:u});return u.disposeIntermediateTensorInfo(h),u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(L),u.disposeIntermediateTensorInfo(O),z}else{const h=u.data.get(i.dataId).values,p=u.data.get(c.dataId).values,f=n||i.dtype,[g,b]=e(i.shape,c.shape,h,p,f);return u.makeTensorInfo(b,f,g)}}}function jw(s){return(e,t,n,a,o,i)=>{const c=kt(e,t),u=Ae(c),h=c.length,p=ut(c),f=vn("float32",u),g=vn("float32",u),b=vu(e,c),y=vu(t,c),v=Lo(n,a),w=Lo(o,i),N=e.length,C=ut(e),I=t.length,T=ut(t);if(b.length+y.length===0)for(let $=0;$<f.length;$++){const E=$%v.length,_=$%w.length,L=s(v[E*2],v[E*2+1],w[_*2],w[_*2+1]);f[$]=L.real,g[$]=L.imag}else for(let $=0;$<f.length;$++){const E=Du($,h,p),_=E.slice(-N);b.forEach(U=>_[U]=0);const L=Zr(_,N,C),O=E.slice(-I);y.forEach(U=>O[U]=0);const z=Zr(O,I,T),A=s(v[L*2],v[L*2+1],w[z*2],w[z*2+1]);f[$]=A.real,g[$]=A.imag}return[f,g,c]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GA=Fs((s,e)=>s+e),vX=jw((s,e,t,n)=>({real:s+t,imag:e+n})),Cu=tn(Ru,GA,vX),wX={kernelName:Ru,backendName:"cpu",kernelFunc:Cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tw(s,e,t,n,a){const o=Ae(n),i=An(a,t);for(let c=0;c<s.length;c++){const u=s[c];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o>0?i[u]+=e[c]:i[u]+=1)}return i}function WA(s,e,t,n=!1){const a=s.shape[0],o=s.shape[1],i=$t([a,t],e.dtype);for(let c=0;c<a;c++)for(let u=0;u<o;u++){const h=s.get(c,u);if(h<0)throw new Error("Input x must be non-negative!");h>=t||(n?i.set(1,c,h):e.size>0?i.set(i.get(c,h)+e.get(c,u),c,h):i.set(i.get(c,h)+1,c,h))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HA=Fs((s,e)=>s&e),NX=tn(xg,HA),SX={kernelName:xg,backendName:"cpu",kernelFunc:NX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oo(s){return(e,t,n)=>{const a=Ds(t,e.length);for(let o=0;o<e.length;++o)a[o]=s(e[o],n);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(s,e,t){const n=oo(e);return el(s,n,t)}function el(s,e,t){return({inputs:n,attrs:a,backend:o})=>{const{x:i}=n;rt(i,s);const c=o,u=c.data.get(i.dataId).values;let h;if(i.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");h=Mo(u)}else h=u;const p=t||i.dtype,f=e(h,p,a);return c.makeTensorInfo(i.shape,p,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qA=oo(s=>Math.ceil(s)),CX=el(Fh,qA),kX={kernelName:Fh,backendName:"cpu",kernelFunc:CX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KA(s,e,t,n){const a=Ds(t,Ae(e));if(n&&t!=="string"){let o=0;s.forEach(i=>{const c=Ae(i.shape);a.set(i.vals,o),o+=c})}else{let o=0;s.forEach(i=>{const c=t==="string"?Mo(i.vals):i.vals;let u=0;for(let h=0;h<i.shape[0];++h){const p=h*e[1]+o;for(let f=0;f<i.shape[1];++f)a[p+f]=c[u++]}o+=i.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XA=Fs((s,e)=>s===e?1:0),YA=tn(jg,XA,null,"bool"),jX={kernelName:jg,backendName:"cpu",kernelFunc:YA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZA=oo(s=>Math.exp(s)),QA=el(Uh,ZA,"float32"),TX={kernelName:Uh,backendName:"cpu",kernelFunc:QA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA=oo(s=>Math.expm1(s)),IX=el(Gh,JA),$X={kernelName:Gh,backendName:"cpu",kernelFunc:IX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE=oo(s=>Math.floor(s)),AX=el(Wh,eE),EX={kernelName:Wh,backendName:"cpu",kernelFunc:AX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tE=Fs((s,e)=>Math.floor(s/e)),DX=tn(Hh,tE,null,"int32"),RX={kernelName:Hh,backendName:"cpu",kernelFunc:DX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sE(s,e,t,n,a,o,i,c,u){const h=$t([n,o],t);for(let p=0;p<n;p++){const f=[];let g=0;for(let b=0;b<a;b++){const y=s[p*a+b];g+=y*i[b],f.push(y)}if(g<0||g>=u/o)throw new Error("Invalid indices: ".concat(f," does not index into ").concat(c));for(let b=0;b<o;b++)h.values[p*o+b]=e.get(...e.indexToLoc(g*o+b))}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nE(s,e,t){const n=$t(t,s.dtype);for(let a=0;a<n.size;++a){const i=n.indexToLoc(a).slice(),c=i[0],u=i[2],h=e.locToIndex([c,u]);i[2]=e.values[h];const p=s.locToIndex(i);0<=p&&p<s.values.length&&(n.values[a]=s.values[p])}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aE=Fs((s,e)=>s>e?1:0),_X=tn(Ag,aE,null,"bool"),OX={kernelName:Ag,backendName:"cpu",kernelFunc:_X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE=Fs((s,e)=>s>=e?1:0),FX=tn(qh,rE,null,"bool"),LX={kernelName:qh,backendName:"cpu",kernelFunc:FX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE=Fs((s,e)=>s<e?1:0),MX=tn(Dg,oE,null,"bool"),zX={kernelName:Dg,backendName:"cpu",kernelFunc:MX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE=Fs((s,e)=>s<=e?1:0),PX=tn(Rg,iE,null,"bool"),BX={kernelName:Rg,backendName:"cpu",kernelFunc:PX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lE(s,e,t){const n=(e-s)/(t-1),a=An(t,"float32");a[0]=s;for(let o=1;o<a.length;o++)a[o]=a[o-1]+n;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cE=oo(s=>Math.log(s)),VX=el(Qh,cE),UX={kernelName:Qh,backendName:"cpu",kernelFunc:VX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(s,e,t,n){const a=vn(n,Ae(t));for(let o=0;o<a.length;++o){const i=o*e;let c=s[i];for(let u=0;u<e;++u){const h=s[i+u];(Number.isNaN(h)||h>c)&&(c=h)}a[o]=c}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dE=Fs((s,e)=>Math.max(s,e)),GX=tn(ep,dE),WX={kernelName:ep,backendName:"cpu",kernelFunc:GX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hE=Fs((s,e)=>Math.min(s,e)),HX=tn(tp,hE),qX={kernelName:tp,backendName:"cpu",kernelFunc:HX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iw=Fs((s,e)=>s*e),KX=jw((s,e,t,n)=>({real:s*t-e*n,imag:s*n+e*t})),Yx=tn(np,Iw,KX),XX={kernelName:np,backendName:"cpu",kernelFunc:Yx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pE(s,e,t){const n=Wi(-1,t);return Iw([],e,n,s,t)}function YX(s){const{inputs:e,backend:t}=s,{x:n}=e;rt(n,"neg");const a=t.data.get(n.dataId).values,[o,i]=pE(a,n.shape,n.dtype);return t.makeTensorInfo(i,n.dtype,o)}const ZX={kernelName:Gg,backendName:"cpu",kernelFunc:YX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE=Fs((s,e)=>s!==e?1:0),QX=tn(Wg,fE,null,"bool"),JX={kernelName:Wg,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $w(s,e,t,n,a){const o=e.length,i=Ae(e),c=ut(e),u=ut(a),h=vn(t,Ae(a));for(let p=0;p<i;++p){const f=Du(p,o,c),g=new Array(f.length);for(let y=0;y<g.length;y++)g[y]=f[n[y]];const b=Zr(g,o,u);h[b]=s[p]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(s){const{inputs:e,attrs:t,backend:n}=s,{x:a}=e,{perm:o}=t;rt(a,"transpose");const i=a.shape.length,c=new Array(i);for(let f=0;f<c.length;f++)c[f]=a.shape[o[f]];const u=n.data.get(a.dataId).values,h=$w(u,a.shape,a.dtype,o,c);return{dataId:n.write(h,c,a.dtype),shape:c,dtype:a.dtype}}const eY={kernelName:du,backendName:"cpu",kernelFunc:na};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mE(s,e,t,n){const[a,o]=pn(s,n),i=ya(e,"int32"),c=An(Ae(a),i),u=Ae(o);for(let h=0;h<c.length;++h){const p=h*u;let f=1;for(let g=0;g<u;++g)f*=t[p+g];c[h]=f}return{outVals:c,outShape:a,outDtype:i}}function tY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;rt(a,"prod");const c=a.shape.length,u=At(o,a.shape),h=ws(u,c);let p=u,f=a;const g=[];h!=null&&(f=na({inputs:{x:a},backend:t,attrs:{perm:h}}),g.push(f),p=_s(p.length,c));const b=t.data.get(f.dataId).values,{outVals:y,outShape:v,outDtype:w}=mE(f.shape,f.dtype,b,p);let N=v;return i&&(N=Rs(v,u)),g.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(N,w,y)}const sY={kernelName:Zg,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(s,e,t){s.forEach((n,a)=>{if(n<0||n>=t){const o=Du(a,e.length,ut(e)).join(",");throw new Error("indices[".concat(o,"] = ").concat(n," is not in [0, ").concat(t,")"))}})}function aY(s,e){for(let t=0;t<s.length;++t){const n=s[t],a=t===s.length-1?e:s[t+1].length;if(n.length===0)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>a)throw new Error("Ragged splits must not point past values");for(let o=1;o<n.length;++o)if(n[o-1]>n[o])throw new Error("Ragged splits must be sorted in ascending order")}}function rY(s,e,t,n){const a=[];let o=0;const i=e.length-1+t.length,c=new Array(i).fill(null).map(()=>[0]);aY(t,n);let u=1;for(let h=0;h<e.length-1;++h){u*=e[h];const p=e[h+1];for(let f=1;f<u+1;++f)c[h].push(f*p)}for(let h=0;h<s.length;++h){let p=s[h],f=s[h]+1;for(let g=0;g<t.length;++g){const b=t[g],y=g+e.length-1;if(y>=0){const v=c[y],w=v[v.length-1]-b[p];for(let N=p;N<f;++N)c[y].push(b[N+1]+w)}p=b[p],f=b[f]}f!==p&&(a.push([p,f]),o+=f-p)}return{outSplits:c,valueSlices:a,numValues:o}}function oY(s){const e=[];for(let t=0;t<s.length;++t){const n=s[t].length,a=Ds("int32",n);e.push(a),s[t].forEach((o,i)=>a[i]=o)}return e}function PC(s,e){const t=s.slice(0,e);for(;t.length<e;)t.push(1);for(let n=e;n<s.length;n++)t[e-1]*=s[n];return t}function iY(s,e,t,n,a,o){const i=PC(e,2)[1],c=PC(o,2)[1];let u=0;for(const h of t)for(let p=h[0];p<h[1];++p){for(let f=0;f<n;++f)a[u*c+f]=s[p*i+f];++u}}function lY(s,e,t,n,a){const o=e.slice();o[0]=a;const i=Ds(t,Ae(o)),c=s.length,u=c===0?0:c/e[0];return iY(s,e,n,u,i,o),[i,o]}function gE(s,e,t,n,a,o,i,c){if(s.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(nY(o,i,u),n.length===0)throw new Error("params.rank must be nonzero");const h=n[0],{outSplits:p,valueSlices:f,numValues:g}=rY(o,i,s,h),b=oY(p),y=lY(t,n,a,f,g);return[b,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BC=2147483647;function xE(s,e,t,n,a,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const c=e.length===0,u=a.length===0,h=i.length===0,p=[];c||p.push(e[0]),u||p.push(a[0]),h||p.push(i[0]);for(let w=1;w<p.length;++w)if(p[w]!==p[w-1])throw new Error("starts, limits, and deltas must have the same shape");const f=p.length===0?1:p[0],g=Ds("int32",f+1);g[0]=0;for(let w=0;w<f;++w){const N=c?s[0]:s[w],C=u?n[0]:n[w],I=h?o[0]:o[w];if(I===0)throw new Error("Requires delta != 0");let T;if(I>0&&C<N||I<0&&C>N)T=0;else if(T=Math.ceil(Math.abs((C-N)/I)),T>BC)throw new Error("Requires ((limit - start) / delta) <= ".concat(BC));g[w+1]=g[w]+T}const b=g[f],y=Ds(t,b);let v=0;for(let w=0;w<f;++w){const N=g[w+1]-g[w];let C=c?s[0]:s[w];const I=h?o[0]:o[w];for(let T=0;T<N;++T)y[v++]=C,C+=I}return[g,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ja=wr;class Qm{constructor(e,t,n,a,o,i,c,u,h,p){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=c,this.rowPartitionValues=u,this.rowPartitionValuesShapes=h,this.rowPartitionTypes=YT(p),this.raggedRank=ZT(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ja.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ja.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ja.VALUE_ROWIDS:return Qm.getMaxWidthValueRowID(t);case Ja.ROW_SPLITS:return Qm.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(Ja[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let n=0;for(let a=0;a<t-1;++a){const o=e[a+1]-e[a];o>n&&(n=o)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let n=0,a=e[0],o=0;for(let i=1;i<t;++i){const c=e[i];c!==a&&(a=c,o=Math.max(i-n,o),n=i)}return Math.max(t-n,o)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return UC(e,n)}calculateOutputSize(e){const t=this.valuesShape,n=this.defaultValueShape;QT(n,t);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=XT(this.raggedRank,a,t);i[0]<0&&(i[0]=e);for(let c=1;c<=this.raggedRank;++c)i[c]<0&&(i[c]=this.getMaxWidth(c));return i}calculateFirstParentOutputIndex(e,t,n){const a=Math.min(e,n),o=[];let i=0;for(let c=0;c<a;++c,i+=t)o.push(i);for(let c=a;c<e;++c)o.push(-1);return V(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,n,a){const o=e.length,i=[];for(let c=0;c<o-1;++c){const u=e[c+1]-e[c];let h=Math.min(a,u),p=t[c];p===-1&&(h=0);for(let f=0;f<h;++f)i.push(p),p+=n;for(let f=0;f<u-h;++f)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,a){const o=e.length,i=[];if(o===0)return[];let c=0,u=e[0];if(u>=t.length)throw new Error("Got currentValueRowId=".concat(u,", which is not less than ").concat(t.length));let h=t[u];i.push(h);for(let p=1;p<o;++p){const f=e[p];if(f===u)h>=0&&(++c,c<a?h+=n:h=-1);else{if(c=0,u=f,f>=t.length)throw new Error("Got nextValueRowId=".concat(f," which is not less than ").concat(t.length));h=t[f]}i.push(h)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,a){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ja.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,n,a);case Ja.ROW_SPLITS:if(o.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(o.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(o,t,n,a);default:throw new Error("Unsupported partition type: ".concat(Ja[i]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Ja.FIRST_DIM_SIZE:return e[0];case Ja.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ja.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Ja[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let u=a.length-2;u>=0;--u)a[u]=a[u+1]*n[u+1];const o=UC(n,!1),i=Ds(this.valuesDType,Ae(o));if(a[0]*n[0]>0){let u=this.calculateFirstParentOutputIndex(t,a[0],n[0]);for(let h=1;h<=this.raggedRank;++h)u=this.calculateOutputIndex(h-1,u,a[h],n[h]);this.setOutput(this.raggedRank,u,i,o)}return[o,i]}setOutput(e,t,n,a){if(n.length===0)return;const o=this.values,i=n;let c=a.slice();c=c.slice(e+1);const u=Ae(c),h=t.length;let p=this.defaultValue;if(p.length!==u&&p.length!==1){const y=this.defaultValueShape;me(()=>{const v=le(p,y);p=fu(v,c).dataSync()})}let f=0,g=0,b=0;for(let y=0;y<=h;++y){let v=y<h?t[y]:-1;if(v===b){++b;continue}if(g<b){const w=o.subarray(f*u),N=i.subarray(g*u),C=(b-g)*u;VC(N,w,C)}if(y>=h){const w=n.length;v=Math.floor(w/u)}if(v>b)if(this.defaultValue.length===1)i.subarray(b*u,v*u).fill(this.defaultValue[0]),b=v;else for(;v>b;){const w=i.slice(b*u);VC(w,p,u),++b}v<0?(f=y+1,g=b):(f=y,g=b,b=g+1)}}}function VC(s,e,t){for(let n=0;n<t;n++)s[n]=e[n]}function UC(s,e){const t=[];for(let n of s){if(n<0){if(!e)throw new Error("Dimension ".concat(n," must be >= 0"));if(n<-1)throw new Error("Dimension ".concat(n," must be >= -1"));n=-1}t.push(n)}return t}function bE(s,e,t,n,a,o,i,c,u,h){return new Qm(s,e,t,n,a,o,i,c,u,h).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yE(s,e,t,n){const a=s===e,o=s<e&&t<0,i=e<s&&t>1;if(a||o||i)return An(0,n);const c=Math.abs(Math.ceil((e-s)/t)),u=An(c,n);e<s&&t===1&&(t=-1),u[0]=s;for(let h=1;h<u.length;h++)u[h]=u[h-1]+t;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vE=oo(s=>1/Math.sqrt(s)),cY=el(cp,vE),uY={kernelName:cp,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _l(s,e,t,n,a,o,i,c,u,h){const p=[n/a,a],f=s.values,g=e.values;if(n===0)return $t(t,e.dtype);const b=u instanceof Zs?u:$t(p,e.dtype);typeof u=="string"||typeof u=="number"?b.values.fill(u):typeof u=="boolean"&&b.values.fill(+u);for(let y=0;y<o;y++){const v=[];let w=0;for(let N=0;N<i;N++){const C=f[y*i+N];v.push(C),w+=C*c[N]}if(w<0||w>=n/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(t));for(let N=0;N<a;N++)h?b.values[w*a+N]+=g[y*a+N]:b.values[w*a+N]=e.rank===0?g[0]:g[y*a+N]}return b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY=oo(s=>1/(1+Math.exp(-s))),wE=Qt(fp,s=>1/(1+Math.exp(-s))),hY={kernelName:fp,backendName:"cpu",kernelFunc:wE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NE(s,e,t,n,a){const o=Ov(n,e,t),i=Ae(t),c=ut(n);if(o){const f=Fv(e,c);return a==="string"?s.slice(f,f+i):s.subarray(f,f+i)}const u=a==="string"?Mo(s):s,h=$t(n,a,u),p=$t(t,a);for(let f=0;f<p.size;++f){const g=p.indexToLoc(f),b=g.map((y,v)=>y+e[v]);p.set(h.get(...b),...g)}return a==="string"?bI(p.values):p.values}function Ql(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,size:i}=n;rt(a,"slice");const[c,u]=Ox(a,o,i);Rv(a,c,u);const h=t.data.get(a.dataId).values,p=NE(h,c,u,a.shape,a.dtype);return t.makeTensorInfo(u,a.dtype,p)}const pY={kernelName:nx,backendName:"cpu",kernelFunc:Ql};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SE(s,e,t,n,a,o,i){const c=e[0],u=o[0],h=new Array(u),p=new Array(c),f=e[1];if(u===0){if(c!==0)throw new Error(rI(c));const w=Ds(t,0),N=Ds(a,0);return[w,[0,f],N,h,p]}let g=!0,b=0;const y=new Array(u).fill(0);for(let w=0;w<c;++w){const N=s[w*f];if(N<0)throw new Error(oI(w,N));if(N>=u)throw new Error(iI(w,N,u));++y[N],g=g&&N>=b,b=N}let v=!0;for(let w=0;w<u;++w){const N=y[w]===0;h[w]=N,v=v&&!N,y[w]=Math.max(y[w],1),w>0&&(y[w]+=y[w-1])}if(v&&g){const w=s,N=n;for(let C=0;C<c;++C)p[C]=C;return[w,[c,f],N,h,p]}else{const w=y[u-1],N=Ds(t,w*f),C=Ds(a,w),I=new Array(u).fill(0);for(let T=0;T<c;++T){const $=s[T*f],E=I[$],_=($===0?0:y[$-1])+E;I[$]++;for(let L=0;L<f;++L)N[_*f+L]=s[T*f+L];C[_]=n[T],p[T]=_}for(let T=0;T<u;++T)if(I[T]===0){const E=T===0?0:y[T-1];N[E*f+0]=T;for(let _=1;_<f;++_)N[E*f+_]=0;C[E]=i}return[N,[w,f],C,h,p]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CE(s,e,t,n,a){const o=Ae(n),i=e[0],c=a.length,u=[];let h=1,p=-1;for(let w=0;w<c;++w){const N=a[w];if(N===-1){if(p!==-1)throw new Error(lI(p,w));p=w,u.push(1)}else{if(N<0)throw new Error(cI(w,N));h*=N,u.push(N)}}if(p!==-1){if(h<=0)throw new Error(uI());const w=Math.trunc(o/h);if(h*w!==o)throw new Error(dI(n,u));u[p]=w}if(Ae(u)!==o)throw new Error(hI(n,u));const g=n.length,b=[];if(g>0){b[g-1]=1;for(let w=g-2;w>=0;--w)b[w]=b[w+1]*n[w+1]}const y=[];if(c>0){y[c-1]=1;for(let w=c-2;w>=0;--w)y[w]=y[w+1]*u[w+1]}const v=Ds(t,i*c);for(let w=0;w<i;++w){let N=0;for(let C=0;C<g;++C)N+=s[w*g+C]*b[C];for(let C=0;C<c;++C)v[w*c+C]=Math.trunc(N/y[C]),N%=y[C]}return[v,[i,c],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aw(s,e,t,n,a,o=!1,i=0){const c=n.length,u=[e[0],s.length/e[0]],h=u[1],f=c>0?a[c-1]+1:0;if(f<0)throw new Error(ny());const g=e.slice();g[0]=f;const b=g.reduce((I,T)=>I*T,1),y=Ds(t,b);if(c===0)return f>0&&y.fill(i),[y,g];if(f<=0)throw new Error(ny());let v=0,w=1,N=0,C=a[v];for(;;){let I=0;if(w<c){if(I=a[w],C===I){++w;continue}if(C>=I)throw new Error(pI())}if(C<0||C>=f)throw new Error(fI(C,f));C>N&&y.fill(i,N*h,C*h);for(let T=v;T<w;++T){const $=n[T];if($<0||$>=u[0])throw new Error(mI(T,n[T],u[0]));for(let E=0;E<h;E++)y[C*h+E]+=s[$*h+E]}if(o)for(let T=0;T<h;T++)y[C*h+T]/=w-v;if(v=w,++w,N=C+1,C=I,w>c)break}return N<f&&y.fill(i,N*h,f*h),[y,g]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY=oo(s=>Math.sqrt(s)),mY=Qt(gp,s=>Math.sqrt(s)),gY={kernelName:gp,backendName:"cpu",kernelFunc:mY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kE=Fs((s,e)=>{const t=s-e;return t*t}),xY=tn(xp,kE),bY={kernelName:xp,backendName:"cpu",kernelFunc:xY};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jE=oo((s,e)=>{const{pattern:t,replaceGlobal:n,rewrite:a}=e;return s.replace(new RegExp(t,n?"g":""),a)}),yY=el(lx,jE),vY={kernelName:lx,backendName:"cpu",kernelFunc:yY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TE(s,e,t,n){const a=$t(s,e.dtype);for(let o=0;o<a.size;o++){const i=a.indexToLoc(o),c=new Array(i.length);for(let u=0;u<c.length;u++)c[u]=i[u]*t[u]+n[u];a.set(e.get(...c),...i)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wY{constructor(e,t,n,a,o,i){this.separator=Ai(e),this.nGramWidths=t,this.leftPad=Ai(n),this.rightPad=Ai(a),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,o,i){for(let c=0;c<o;++c){const u=this.getPadWidth(i),h=Math.max(0,u-c),p=Math.max(0,u-(o-(c+1))),f=i-(h+p),g=t+(h>0?0:c-u);let b=0;b+=h*this.leftPad.length;for(let C=0;C<f;++C)b+=e[g+C].length;b+=p*this.rightPad.length;const y=h+p+f-1;b+=y*this.separator.length,n[a+c]=new Uint8Array(b);const v=n[a+c];let w=0;const N=C=>C.forEach(I=>v[w++]=I);for(let C=0;C<h;++C)N(this.leftPad),N(this.separator);for(let C=0;C<f-1;++C)N(e[g+C]),N(this.separator);if(f>0){N(e[g+f-1]);for(let C=0;C<p;++C)N(this.separator),N(this.rightPad)}else{for(let C=0;C<p-1;++C)N(this.rightPad),N(this.separator);N(this.rightPad)}}}compute(e,t){const n=e.length,a=t.length;if(a>0){let u=t[0];if(u!==0)throw new Error("First split value must be 0, got ".concat(u));for(let h=1;h<a;++h){let p=t[h]>=u;if(p=p&&t[h]<=n,!p)throw new Error("Invalid split value ".concat(t[h],", must be in [").concat(u,", ").concat(n,"]"));u=t[h]}if(u!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(u))}const o=a-1,i=Ds("int32",a);if(n===0||a===0){const u=new Array(n);for(let h=0;h<=o;++h)i[h]=0;return[u,i]}i[0]=0;for(let u=1;u<=o;++u){const h=t[u]-t[u-1];let p=0;this.nGramWidths.forEach(f=>{p+=this.getNumNGrams(h,f)}),this.preserveShort&&h>0&&p===0&&(p=1),i[u]=i[u-1]+p}const c=new Array(i[o]);for(let u=0;u<o;++u){const h=t[u];let p=i[u];if(this.nGramWidths.forEach(f=>{const g=t[u+1]-t[u],b=this.getNumNGrams(g,f);this.createNGrams(e,h,c,p,b,f),p+=b}),this.preserveShort&&p===i[u]){const f=t[u+1]-t[u];if(f===0)continue;const g=f+2*this.padWidth;this.createNGrams(e,h,c,p,1,g)}}return[c,i]}}function IE(s,e,t,n,a,o,i,c){return new wY(t,n,a,o,i,c).compute(s,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(s,e,t,n){if(!s.length)return;if(e.length===0){for(let o=0;o<s.length;++o)n.push(s.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=s.indexOf(o);for(;i!==-1;){const c=s.subarray(0,i);(!t||c.length!==0)&&n.push(c),s=s.subarray(i+1),i=s.indexOf(o)}(!t||s.length!==0)&&n.push(s);return}let a=0;for(let o=0;o<s.length+1;o++)if(o===s.length||e.indexOf(s[o])!==-1){const i=s.subarray(a,o);(!t||i.length!==0)&&n.push(i),a=o+1}}function $E(s,e,t){const n=s.length,a=[];let o=0,i=0;const c=new Array(n);for(let g=0;g<n;++g){const b=a.length;NY(s[g],e,t,a);const y=a.length-b;c[g]=y,o+=y,i=Math.max(i,y)}const u=Ds("int32",o*2),h=new Array(o),p=[n,i];let f=0;for(let g=0;g<n;++g)for(let b=0;b<c[g];++b)u[f*2]=g,u[f*2+1]=b,h[f]=a[f],++f;return[u,h,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AE(s,e){const t=Ds("int32",s.length);for(let n=0;n<s.length;++n)t[n]=d7(s[n]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EE=Fs((s,e)=>s-e),SY=jw((s,e,t,n)=>({real:s-t,imag:e-n})),Ew=tn(bp,EE,SY),CY={kernelName:bp,backendName:"cpu",kernelFunc:Ew};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DE(s,e){const t=new Array(s.rank);for(let a=0;a<t.length;a++)t[a]=s.shape[a]*e[a];const n=$t(t,s.dtype);for(let a=0;a<n.values.length;++a){const o=n.indexToLoc(a),i=new Array(s.rank);for(let u=0;u<i.length;u++)i[u]=o[u]%s.shape[u];const c=s.locToIndex(i);n.values[a]=s.values[c]}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ih=(s,e)=>{const t=e.value-s.value;return t===0?s.index-e.index:t};function RE(s,e,t=0,n=s.length-1){for(;n>t;){if(n-t>600){const c=n-t+1,u=e-t+1,h=Math.log(c),p=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*p*(c-p)/c)*Math.sign(u-c/2),g=Math.max(t,Math.floor(e-u*p/c+f)),b=Math.min(n,Math.floor(e+(c-u)*p/c+f));RE(s,e,g,b)}const a=s[e];let o=t,i=n;for(ou(s,t,e),ih(s[n],a)>0&&ou(s,t,n);o<i;){for(ou(s,o,i),o++,i--;ih(s[o],a)<0;)o=o+1;for(;ih(s[i],a)>0;)i=i-1}ih(s[t],a)===0?ou(s,t,i):(i=i+1,ou(s,i,n)),i<=e&&(t=i+1),e<=i&&(n=i-1)}}function _E(s,e,t,n,a){const o=e[e.length-1],[i,c]=[s.length/o,o],u=vn(t,i*n),h=vn("int32",i*n);for(let f=0;f<i;f++){const g=f*c,b=s.subarray(g,g+c);let y=new Array(b.length);b.forEach((C,I)=>y[I]={value:C,index:I}),n<y.length&&(RE(y,n),y=y.slice(0,n)),a&&y.sort(ih);const v=f*n,w=u.subarray(v,v+n),N=h.subarray(v,v+n);for(let C=0;C<n;C++)w[C]=y[C].value,N[C]=y[C].index}const p=e.slice();return p[p.length-1]=n,[$t(p,t,u),$t(p,"int32",h)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OE(s,e,t,n){const a=At(e,t)[0],o=[1,t[0],1];for(let y=0;y<a;y++)o[0]*=t[y];o[1]=t[a];for(let y=a+1;y<t.length;y++)o[2]*=t[y];const i=new Map,c=new Int32Array(t[a]),u=new Zs(o,n,s),h=[],p=o[0]===1&&o[2]===1;for(let y=0;y<t[a];y++){let v;if(p)v=s[y].toString();else{const N=[];for(let C=0;C<o[0];C++)for(let I=0;I<o[2];I++)N.push(u.get(C,y,I));v=N.join(",")}const w=i.get(v);if(w!=null)c[y]=w;else{const N=i.size;i.set(v,N),c[y]=N,h.push(y)}}const f=o.slice();f[1]=i.size;const g=new Zs(f,n);h.forEach((y,v)=>{for(let w=0;w<o[0];w++)for(let N=0;N<o[2];N++)g.set(u.get(w,y,N),w,v,N)});const b=t.slice();return b[a]=f[1],{outputValues:g.values,outputShape:b,indices:c}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kY=Object.freeze(Object.defineProperty({__proto__:null,addImpl:GA,bincountImpl:Tw,bincountReduceImpl:WA,bitwiseAndImpl:HA,castImpl:UA,ceilImpl:qA,concatImpl:KA,equalImpl:XA,expImpl:ZA,expm1Impl:JA,floorDivImpl:tE,floorImpl:eE,gatherNdImpl:sE,gatherV2Impl:nE,greaterEqualImpl:rE,greaterImpl:aE,lessEqualImpl:iE,lessImpl:oE,linSpaceImpl:lE,logImpl:cE,maxImpl:uE,maximumImpl:dE,minimumImpl:hE,multiplyImpl:Iw,negImpl:pE,notEqualImpl:fE,prodImpl:mE,raggedGatherImpl:gE,raggedRangeImpl:xE,raggedTensorToTensorImpl:bE,rangeImpl:yE,rsqrtImpl:vE,scatterImpl:_l,sigmoidImpl:dY,simpleAbsImpl:VA,sliceImpl:NE,sparseFillEmptyRowsImpl:SE,sparseReshapeImpl:CE,sparseSegmentReductionImpl:Aw,sqrtImpl:fY,squaredDifferenceImpl:kE,staticRegexReplaceImpl:jE,stridedSliceImpl:TE,stringNGramsImpl:IE,stringSplitImpl:$E,stringToHashBucketFastImpl:AE,subImpl:EE,tileImpl:DE,topKImpl:_E,transposeImpl:$w,uniqueImpl:OE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */rj("cpu",()=>new Xx,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FE=Qt(Bh,s=>s>=0?s:Math.exp(s)-1),jY={kernelName:Bh,backendName:"cpu",kernelFunc:FE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{alpha:o}=n;rt([a],"leakyRelu");const i=Ae(a.shape),c=t.data.get(a.dataId).values,u=vn("float32",i);for(let h=0;h<c.length;h++)u[h]=c[h]<0?o*c[h]:c[h];return t.makeTensorInfo(a.shape,"float32",u)}const TY={kernelName:Eg,backendName:"cpu",kernelFunc:LE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY=Fs((s,e)=>s<0?e*s:s);function ME(s){const{inputs:e,backend:t}=s,{x:n,alpha:a}=e;rt([n,a],"prelu");const o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,[c,u]=IY(n.shape,a.shape,o,i,"float32");return t.makeTensorInfo(u,"float32",c)}const $Y={kernelName:Yg,backendName:"cpu",kernelFunc:ME};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zE=Qt(op,s=>Math.max(0,s)),AY={kernelName:op,backendName:"cpu",kernelFunc:zE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE=Qt(ip,s=>Math.min(Math.max(0,s),6)),EY={kernelName:ip,backendName:"cpu",kernelFunc:PE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jm(s,e,t,n,a){if(t==="linear")return no({inputs:{x:e},backend:s});if(t==="relu")return zE({inputs:{x:e},backend:s});if(t==="elu")return FE({inputs:{x:e},backend:s});if(t==="relu6")return PE({inputs:{x:e},backend:s});if(t==="prelu")return ME({inputs:{x:e,alpha:n},backend:s});if(t==="leakyrelu")return LE({inputs:{x:e},backend:s,attrs:{alpha:a}});if(t==="sigmoid")return wE({inputs:{x:e},backend:s});throw new Error("Activation ".concat(t," has not been implemented for the CPU backend."))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{shape:o}=n,i=Ae(a.shape),c=Fk(o,i),u=Ae(c);V(i===u,()=>"The new shape (".concat(c,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(i," elements. The new shape and old ")+"shape must have the same number of elements."),t.incRef(a.dataId);const h=t.data.get(a.dataId);if(h.complexTensorInfos!=null){const p=h.complexTensorInfos.real,f=h.complexTensorInfos.imag;p.shape=c,f.shape=c}return{dataId:a.dataId,shape:c,dtype:a.dtype}}const DY={kernelName:Qg,backendName:"cpu",kernelFunc:hs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BE(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o}=e,{transposeA:i,transposeB:c}=n;rt([a,o],"matMul");const u=a.shape.length,h=o.shape.length,p=i?a.shape[u-2]:a.shape[u-1],f=c?o.shape[h-1]:o.shape[h-2],g=i?a.shape[u-1]:a.shape[u-2],b=c?o.shape[h-2]:o.shape[h-1],y=a.shape.slice(0,-2),v=o.shape.slice(0,-2),w=Ae(y),N=Ae(v),I=kt(a.shape.slice(0,-2),o.shape.slice(0,-2)).concat([g,b]);V(p===f,()=>"Error in matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(i)+" and transposeB=".concat(c," must match."));const T=i?[w,p,g]:[w,g,p],$=c?[N,b,f]:[N,f,b],E=hs({inputs:{x:a},backend:t,attrs:{shape:T}}),_=hs({inputs:{x:o},backend:t,attrs:{shape:$}}),L=i?E.shape[1]:E.shape[2],O=i?E.shape[2]:E.shape[1],z=c?_.shape[1]:_.shape[2],A=Math.max(w,N),U=t.data.get(E.dataId).values,X=t.data.get(_.dataId).values,Z=ut(E.shape),q=ut(_.shape),[B,K,J]=i?[Z[0],1,Z[1]]:[Z[0],Z[1],1],[Q,ae,we]=c?[1,q[1],q[0]]:[q[1],1,q[0]],Ce=O*z,ve=$t([A,O,z],E.dtype),pe=ve.values,xe=t.blockSize;for(let ue=0;ue<A;ue++){const ye=ue%w,Y=ue%N;for(let ce=0;ce<O;ce+=xe){const re=Math.min(ce+xe,O);for(let ke=0;ke<z;ke+=xe){const Me=Math.min(ke+xe,z);for(let Ue=0;Ue<L;Ue+=xe){const He=Math.min(Ue+xe,L);for(let We=ce;We<re;We++)for(let je=ke;je<Me;je++){let Xe=0;for(let st=Ue;st<He;st++){const St=U[ye*B+We*K+st*J],pt=X[st*Q+je*ae+Y*we];Xe+=St*pt}pe[ue*Ce+(We*z+je)]+=Xe}}}}}return t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(_),t.makeTensorInfo(I,ve.dtype,ve.values)}const RY={kernelName:mg,backendName:"cpu",kernelFunc:BE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o,bias:i,preluActivationWeights:c}=e,{transposeA:u,transposeB:h,activation:p,leakyreluAlpha:f}=n;let g,b,y;const v=[];g=BE({inputs:{a,b:o},attrs:{transposeA:u,transposeB:h},backend:t}),i&&(b=Cu({inputs:{a:g,b:i},backend:t}),v.push(g),g=b),p&&(y=Jm(t,g,p,c,f),v.push(g),g=y);for(const N of v)t.disposeIntermediateTensorInfo(N);return g}const OY={kernelName:Em,backendName:"cpu",kernelFunc:_Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FY=Qt(Ih,s=>Math.acos(s)),LY={kernelName:Ih,backendName:"cpu",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY=Qt($h,s=>Math.acosh(s)),zY={kernelName:$h,backendName:"cpu",kernelFunc:MY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PY(s){const{inputs:e,backend:t}=s,n=e;rt(e,"addN");const a=n.map(c=>t.data.get(c.dataId).values),o=$t(n[0].shape,n[0].dtype),i=o.values;for(let c=0;c<n.length;c++){const u=a[c];for(let h=0;h<i.length;h++)i[h]+=u[h]}return t.makeTensorInfo(o.shape,o.dtype,o.values)}const BY={kernelName:ug,backendName:"cpu",kernelFunc:PY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;rt(a,"all");const c=At(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=na({inputs:{x:a},backend:t,attrs:{perm:h}}),u=_s(u.length,a.shape.length)),Sn("all",u,p.shape.length);const[f,g]=pn(p.shape,u),b=Ae(g),y=An(Ae(f),p.dtype),v=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let I=v[C];for(let T=0;T<b;++T){const $=v[C+T];I=I&&$}y[N]=I}h!=null&&t.disposeIntermediateTensorInfo(p);const w=t.makeTensorInfo(f,p.dtype,y);if(i){const N=Rs(f,c),C=hs({inputs:{x:w},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(w),C}return w}const UY={kernelName:zy,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;rt(a,"any");const c=At(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=na({inputs:{x:a},backend:t,attrs:{perm:h}}),u=_s(u.length,a.shape.length)),Sn("any",u,p.shape.length);const[f,g]=pn(p.shape,u),b=Ae(g),y=An(Ae(f),p.dtype),v=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let I=v[C];for(let T=0;T<b;++T){const $=v[C+T];I=I||$}y[N]=I}h!=null&&t.disposeIntermediateTensorInfo(p);const w=t.makeTensorInfo(f,p.dtype,y);if(i){const N=Rs(f,c),C=hs({inputs:{x:w},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(w),C}return w}const WY={kernelName:Py,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;rt(a,"argMax");let i=At(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=na({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=_s(i.length,u.shape.length)),i=[i[0]],Sn("argMax",i,u.shape.length);const[p,f]=pn(u.shape,i),g=Ae(p),b=An(g,"int32"),y=Ae(f),v=t.data.get(u.dataId).values;for(let w=0;w<b.length;++w){const N=w*y;let C=v[N],I=0;for(let T=0;T<y;++T){const $=v[N+T];$>C&&(C=$,I=T)}b[w]=I}return h.forEach(w=>t.disposeIntermediateTensorInfo(w)),t.makeTensorInfo(p,"int32",b)}const qY={kernelName:dg,backendName:"cpu",kernelFunc:HY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;rt(a,"argMin");let i=At(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=na({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=_s(i.length,u.shape.length)),i=[i[0]],Sn("argMin",i,u.shape.length);const[p,f]=pn(u.shape,i),g=Ae(p),b=An(g,"int32"),y=Ae(f),v=t.data.get(u.dataId).values;for(let w=0;w<b.length;++w){const N=w*y;let C=v[N],I=0;for(let T=0;T<y;++T){const $=v[N+T];$<C&&(C=$,I=T)}b[w]=I}return h.forEach(w=>t.disposeIntermediateTensorInfo(w)),t.makeTensorInfo(p,"int32",b)}const XY={kernelName:hg,backendName:"cpu",kernelFunc:KY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YY=Qt(Ah,s=>Math.asin(s)),ZY={kernelName:Ah,backendName:"cpu",kernelFunc:YY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QY=Qt(Eh,s=>Math.asinh(s)),JY={kernelName:Eh,backendName:"cpu",kernelFunc:QY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eZ=Qt(Dh,s=>Math.atan(s)),tZ={kernelName:Dh,backendName:"cpu",kernelFunc:eZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sZ=Fs((s,e)=>Math.atan2(s,e)),nZ=tn(_h,sZ),aZ={kernelName:_h,backendName:"cpu",kernelFunc:nZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rZ=Qt(Rh,s=>Math.atanh(s)),oZ={kernelName:Rh,backendName:"cpu",kernelFunc:rZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dw(s,e,t,n,a,o){const i=a.strideHeight,c=a.strideWidth,u=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.top,b=a.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=$t(a.outShape,t),w=v.values,N=a.outShape[1]*a.outShape[2]*a.outShape[3],C=a.outShape[2]*a.outShape[3],I=a.outShape[3];for(let T=0;T<a.batchSize;++T){const $=T*N,E=T*n[0];for(let _=0;_<a.inChannels;++_)for(let L=0;L<a.outHeight;++L){const O=L*i-g,z=Math.max(0,O),A=Math.min(a.inHeight,p+O),U=$+L*C;for(let X=0;X<a.outWidth;++X){const Z=X*c-b,q=Math.max(0,Z),B=Math.min(a.inWidth,f+Z);let K=y,J=0,Q=0;for(let we=z;we<A;we+=u){const Ce=E+we*n[1];for(let ve=q;ve<B;ve+=h){const pe=Ce+ve*n[2],xe=s[pe+_];o==="max"&&xe>K?K=xe:o==="avg"&&(J+=xe,Q++)}if(isNaN(K))break}const ae=U+X*I+_;w[ae]=o==="avg"?J/Q:K}}}return v}function VE(s,e,t,n,a=!1,o=!1){const i=$t(n.outShape,"int32"),c=n.strideHeight,u=n.strideWidth,h=n.dilationHeight,p=n.dilationWidth,f=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.top,y=n.padInfo.left,v=$t(e,t,s);for(let w=0;w<n.batchSize;++w)for(let N=0;N<n.inChannels;++N)for(let C=0;C<n.outHeight;++C){const I=C*c-b;let T=I;for(;T<0;)T+=h;const $=Math.min(n.inHeight,f+I);for(let E=0;E<n.outWidth;++E){const _=E*u-y;let L=_;for(;L<0;)L+=p;const O=Math.min(n.inWidth,g+_);let z=Number.NEGATIVE_INFINITY,A=-1;for(let U=T;U<$;U+=h){const X=U-I;for(let Z=L;Z<O;Z+=p){const q=Z-_,B=v.get(w,U,Z,N);B>z&&(z=B,a?A=o?((w*n.inHeight+U)*n.inWidth+Z)*n.inChannels+N:(U*n.inWidth+Z)*n.inChannels+N:A=X*g+q)}}i.set(A,w,C,E,N)}}return i}function UE(s,e,t,n,a,o){const i=a.strideDepth,c=a.strideHeight,u=a.strideWidth,h=a.dilationDepth,p=a.dilationHeight,f=a.dilationWidth,g=a.effectiveFilterDepth,b=a.effectiveFilterHeight,y=a.effectiveFilterWidth,v=a.padInfo.front,w=a.padInfo.top,N=a.padInfo.left,C=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=$t(a.outShape,t),T=I.values,$=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],E=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],L=a.outShape[4];for(let O=0;O<a.batchSize;++O){const z=O*$,A=O*n[0];for(let U=0;U<a.inChannels;++U)for(let X=0;X<a.outDepth;++X){const Z=X*i-v;let q=Z;for(;q<0;)q+=h;const B=Math.min(a.inDepth,g+Z),K=z+X*E;for(let J=0;J<a.outHeight;++J){const Q=J*c-w;let ae=Q;for(;ae<0;)ae+=p;const we=Math.min(a.inHeight,b+Q),Ce=K+J*_;for(let ve=0;ve<a.outWidth;++ve){const pe=ve*u-N;let xe=pe;for(;xe<0;)xe+=f;const ue=Math.min(a.inWidth,y+pe),ye=Ce+ve*L;let Y=C,ce=0,re=0;for(let Me=q;Me<B;Me+=h){const Ue=A+Me*n[1];for(let He=ae;He<we;He+=p){const We=Ue+He*n[2];for(let je=xe;je<ue;je+=f){const Xe=We+je*n[3],st=s[Xe+U];if(o==="max"&&st>Y?Y=st:o==="avg"&&(ce+=st,re++),isNaN(Y))break}if(isNaN(Y))break}if(isNaN(Y))break}const ke=ye+U;T[ke]=o==="avg"?ce/Math.max(re,1):Y}}}}return I}function iZ(s,e){const t=$t(e.outShape,"int32"),n=e.strideDepth,a=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,g=e.padInfo.front,b=e.padInfo.top,y=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let w=0;w<e.inChannels;++w)for(let N=0;N<e.outDepth;++N){const C=N*n-g;let I=C;for(;I<0;)I+=i;const T=Math.min(e.inDepth,h+C);for(let $=0;$<e.outHeight;++$){const E=$*a-b;let _=E;for(;_<0;)_+=c;const L=Math.min(e.inHeight,p+E);for(let O=0;O<e.outWidth;++O){const z=O*o-y;let A=z;for(;A<0;)A+=u;const U=Math.min(e.inWidth,f+z);let X=Number.NEGATIVE_INFINITY,Z=-1;for(let q=I;q<T;q+=i){const B=q-C;for(let K=_;K<L;K+=c){const J=K-E;for(let Q=A;Q<U;Q+=u){const ae=Q-z,we=s.get(v,q,K,Q,w);we>=X&&(X=we,Z=B*p*f+J*p+ae)}}}t.set(Z,v,N,$,O,w)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;rt(a,"avgPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(Nn(i,h),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=dr(a.shape,o,i,h,c,u);let f;if(p.filterWidth===1&&p.filterHeight===1&&Mt(p.inShape,p.outShape))f=no({inputs:{x:a},backend:t});else{const g=t.data.get(a.dataId).values,b=ut(a.shape),y=Dw(g,a.shape,a.dtype,b,p,"avg");f=t.makeTensorInfo(p.outShape,a.dtype,y.values)}return f}const cZ={kernelName:pg,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n;rt(a,"avgPool3d");const p=Uo(a.shape,o,i,1,c,u,h),f=t.data.get(a.dataId).values,g=UE(f,a.shape,a.dtype,ut(a.shape),p,"avg");return t.makeTensorInfo(g.shape,"float32",g.values)}const dZ={kernelName:fg,backendName:"cpu",kernelFunc:uZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,{filterSize:i,strides:c,pad:u,dimRoundingMode:h}=n;rt([a,o],"avgPool3DGrad");const p=Uo(o.shape,i,c,1,u,h),f=p.strideDepth,g=p.strideHeight,b=p.strideWidth,y=p.filterDepth,v=p.filterHeight,w=p.filterWidth,N=p.dilationDepth,C=p.dilationHeight,I=p.dilationWidth,T=p.effectiveFilterDepth,$=p.effectiveFilterHeight,E=p.effectiveFilterWidth,_=T-1-p.padInfo.front,L=E-1-p.padInfo.left,O=$-1-p.padInfo.top,z=$t(o.shape,"float32"),A=1/(y*v*w),U=t.bufferSync(a);for(let X=0;X<p.batchSize;++X)for(let Z=0;Z<p.inChannels;++Z)for(let q=0;q<p.inDepth;++q)for(let B=0;B<p.inHeight;++B)for(let K=0;K<p.inWidth;++K){const J=q-_,Q=B-O,ae=K-L;let we=0;for(let Ce=0;Ce<T;Ce+=N){const ve=(J+Ce)/f;if(!(ve<0||ve>=p.outDepth||Math.floor(ve)!==ve))for(let pe=0;pe<$;pe+=C){const xe=(Q+pe)/g;if(!(xe<0||xe>=p.outHeight||Math.floor(xe)!==xe))for(let ue=0;ue<E;ue+=I){const ye=(ae+ue)/b;if(ye<0||ye>=p.outWidth||Math.floor(ye)!==ye)continue;const Y=U.get(X,ve,xe,ye,Z);we+=Y}}}z.set(we*A,X,q,B,K,Z)}return t.makeTensorInfo(z.shape,z.dtype,z.values)}const pZ={kernelName:Vy,backendName:"cpu",kernelFunc:hZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o;rt([a,o],"avgPoolGrad");const{filterSize:c,strides:u,pad:h}=n,p=dr(i.shape,c,u,1,h),f=p.strideHeight,g=p.strideWidth,b=p.filterHeight,y=p.filterWidth,v=p.dilationHeight,w=p.dilationWidth,N=p.effectiveFilterHeight,C=p.effectiveFilterWidth,I=C-1-p.padInfo.left,T=N-1-p.padInfo.top,$=$t(i.shape,"float32"),E=1/(b*y),_=t.data.get(a.dataId).values,L=$t(a.shape,"float32",_);for(let O=0;O<p.batchSize;++O)for(let z=0;z<p.inChannels;++z)for(let A=0;A<p.inHeight;++A)for(let U=0;U<p.inWidth;++U){const X=A-T,Z=U-I;let q=0;for(let B=0;B<N;B+=v){const K=(X+B)/f;if(!(K<0||K>=p.outHeight||Math.floor(K)!==K))for(let J=0;J<C;J+=w){const Q=(Z+J)/g;if(Q<0||Q>=p.outWidth||Math.floor(Q)!==Q)continue;const ae=L.get(O,K,Q,z);q+=ae}}$.set(q*E,O,A,U,z)}return t.makeTensorInfo($.shape,$.dtype,$.values)}const mZ={kernelName:By,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,scale:o,offset:i,mean:c,variance:u}=e;V(c.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(i==null||c.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(o==null||c.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),rt([a,c,u,o,i],"batchNorm");let{varianceEpsilon:h}=n;h==null&&(h=.001);const p=t.data.get(a.dataId).values,f=t.data.get(c.dataId).values,g=t.data.get(u.dataId).values,b=o?t.data.get(o.dataId).values:new Float32Array([1]),y=i?t.data.get(i.dataId).values:new Float32Array([0]),v=new Float32Array(p.length),w=y.length,N=b.length,C=g.length,I=f.length;let T=0,$=0,E=0,_=0;for(let L=0;L<p.length;++L)v[L]=y[T++]+(p[L]-f[$++])*b[E++]/Math.sqrt(g[_++]+h),T>=w&&(T=0),$>=I&&($=0),E>=N&&(E=0),_>=C&&(_=0);return t.makeTensorInfo(a.shape,a.dtype,v)}const xZ={kernelName:Ig,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,crops:i}=n;rt([a],"batchToSpaceND");const c=o.reduce((N,C)=>N*C),u=Ep(a.shape,o,c),h=Dp(u.length,o.length),p=Rp(a.shape,o,c),f=Bv(i,o.length),g=Vv(p,i,o.length),b=hs({inputs:{x:a},backend:t,attrs:{shape:u}}),y=na({inputs:{x:b},backend:t,attrs:{perm:h}}),v=hs({inputs:{x:y},backend:t,attrs:{shape:p}}),w=Ql({inputs:{x:v},backend:t,attrs:{begin:f,size:g}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),w}const yZ={kernelName:gg,backendName:"cpu",kernelFunc:bZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i}=n,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,h=Tw(c,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}const wZ={kernelName:Uy,backendName:"cpu",kernelFunc:vZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(s){const{inputs:e,backend:t}=s,{s0:n,s1:a}=e,o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,c=kt(Array.from(o),Array.from(i));return t.makeTensorInfo([c.length],"int32",Int32Array.from(c))}const SZ={kernelName:Gy,backendName:"cpu",kernelFunc:NZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ=Qt(Lh,(s,e)=>{const t=e;return s>t.clipValueMax?t.clipValueMax:s<t.clipValueMin?t.clipValueMin:s}),kZ={kernelName:Lh,backendName:"cpu",kernelFunc:CZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jZ=s=>{const{x:e}=s.inputs,t=s.backend,n=new Float32Array(Ae(e.shape)),a=t.data.get(e.dataId),o=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,c=t.data.get(o.dataId).values,u=t.data.get(i.dataId).values;for(let h=0;h<c.length;h++){const p=c[h],f=u[h];n[h]=Math.hypot(p,f)}return t.makeOutput(n,e.shape,"float32")},TZ={kernelName:bg,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ku(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.data.get(n.dataId).complexTensorInfos.imag,o=t.data.get(a.dataId).values;return t.makeTensorInfo(a.shape,a.dtype,o)}const IZ={kernelName:c2,backendName:"cpu",kernelFunc:ku};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ju(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n,o=At(a,e[0].shape)[0],i=e.map(v=>v.shape);Mv(i,o);let c=Qr(e.map(v=>v.shape),o);if(Ae(c)===0)return t.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter(v=>Ae(v.shape)>0);if(u.length===1)return no({inputs:{x:u[0]},backend:t});if(u[0].dtype==="complex64"){const v=u.map(T=>Zl({inputs:{input:T},backend:t})),w=u.map(T=>ku({inputs:{input:T},backend:t})),N=ju({inputs:v,backend:t,attrs:{axis:o}}),C=ju({inputs:w,backend:t,attrs:{axis:o}}),I=ga({inputs:{real:N,imag:C},backend:t});return v.forEach(T=>t.disposeIntermediateTensorInfo(T)),w.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(C),I}const h=u.map(v=>{const N=[-1,Ae(v.shape.slice(o))];return hs({inputs:{x:v},backend:t,attrs:{shape:N}})}),p=h.map(v=>({vals:t.data.get(v.dataId).values,shape:v.shape}));c=Qr(h.map(v=>v.shape),1);const f=h[0].shape[0]===1,g=KA(p,c,e[0].dtype,f),b=Qr(u.map(v=>v.shape),o),y=t.makeTensorInfo(b,e[0].dtype,g);return h.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const $Z={kernelName:yg,backendName:"cpu",kernelFunc:ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}=n;rt([a,o],"conv2d");const f=Go(u),g=hn(a.shape,o.shape,i,h,c,p,!1,f),b=g.filterHeight,y=g.filterWidth,v=g.dilationHeight,w=g.dilationWidth,N=g.padInfo.left,C=g.padInfo.top,I=g.dataFormat==="channelsLast",T=new Zs(g.outShape,a.dtype),$=ut(a.shape),E=ut(o.shape),_=$[0],L=I?$[1]:$[2],O=I?$[2]:1,z=I?1:$[1],A=T.strides[0],U=I?T.strides[1]:T.strides[2],X=I?T.strides[2]:1,Z=I?1:T.strides[1],q=t.data.get(a.dataId).values,B=t.data.get(o.dataId).values,K=T.values;for(let J=0;J<g.batchSize;++J){const Q=J*_,ae=J*A;for(let we=0;we<g.outHeight;++we){const Ce=ae+we*U,ve=we*g.strideHeight-C;for(let pe=0;pe<b;++pe){const xe=ve+pe*v;if(xe<0||xe>=g.inHeight)continue;const ue=pe*E[0],ye=Q+xe*L;for(let Y=0;Y<g.outWidth;++Y){const ce=Ce+Y*X,re=Y*g.strideWidth-N;for(let ke=0;ke<y;++ke){const Me=re+ke*w;if(Me<0||Me>=g.inWidth)continue;const Ue=ue+ke*E[1],He=ye+Me*O;let We=Ue;for(let je=0;je<g.inChannels;++je){const Xe=q[He+je*z];for(let st=0;st<g.outChannels;++st)K[ce+st*Z]+=Xe*B[We+st];We+=g.outChannels}}}}}}return t.makeTensorInfo(T.shape,T.dtype,K)}const AZ={kernelName:vg,backendName:"cpu",kernelFunc:GE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,dataFormat:u,dimRoundingMode:h,filterShape:p}=n;rt([a,o],"conv2dBackpropFilter");const f=Go(u),g=hn(a.shape,p,i,1,c,h,!1,f),{strideHeight:b,strideWidth:y,filterHeight:v,filterWidth:w}=g,N=g.dataFormat==="channelsLast",C=new Zs(g.filterShape,"float32"),I=g.padInfo.left,T=g.padInfo.top,$=t.data.get(a.dataId).values,E=t.data.get(o.dataId).values,_=new Zs(a.shape,a.dtype,$),L=new Zs(o.shape,o.dtype,E);for(let O=0;O<v;++O){const z=Math.max(0,Math.ceil((T-O)/b)),A=Math.min(g.outHeight,(g.inHeight+T-O)/b);for(let U=0;U<w;++U){const X=Math.max(0,Math.ceil((I-U)/y)),Z=Math.min(g.outWidth,(g.inWidth+I-U)/y);for(let q=0;q<g.inChannels;++q)for(let B=0;B<g.outChannels;++B){let K=0;for(let J=0;J<g.batchSize;++J)for(let Q=z;Q<A;++Q){const ae=O+Q*b-T;for(let we=X;we<Z;++we){const Ce=U+we*y-I;N?K+=_.get(J,ae,Ce,q)*L.get(J,Q,we,B):K+=_.get(J,q,ae,Ce)*L.get(J,B,Q,we)}}C.set(K,O,U,q,B)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const DZ={kernelName:Hy,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{inputShape:i,strides:c,pad:u,dataFormat:h,dimRoundingMode:p}=n;rt([a,o],"conv2dBackpropInput");const f=ut(o.shape),g=ut(a.shape);let b=Go(h);const y=hn(i,o.shape,c,1,u,p,!1,b),v=new Zs(y.inShape,"float32"),w=v.values,N=t.data.get(a.dataId).values,C=t.data.get(o.dataId).values,[I,T,$]=f,{batchSize:E,filterHeight:_,filterWidth:L,inChannels:O,inHeight:z,inWidth:A,outChannels:U,outHeight:X,outWidth:Z,strideHeight:q,strideWidth:B}=y;b=y.dataFormat;const K=_-1-y.padInfo.top,J=L-1-y.padInfo.left,Q=b==="channelsLast",ae=v.strides[0],we=Q?v.strides[1]:v.strides[2],Ce=Q?v.strides[2]:1,ve=Q?1:v.strides[1],pe=g[0],xe=Q?g[1]:g[2],ue=Q?g[2]:1,ye=Q?1:g[1];for(let Y=0;Y<E;++Y)for(let ce=0;ce<O;++ce)for(let re=0;re<z;++re){const ke=re-K,Me=Math.max(0,Math.ceil(ke/q)),Ue=Math.min(X,(_+ke)/q);for(let He=0;He<A;++He){const We=He-J,je=Math.max(0,Math.ceil(We/B)),Xe=Math.min(Z,(L+We)/B);let st=0;for(let pt=Me;pt<Ue;++pt){const Ve=pt*q-ke;for(let Je=je;Je<Xe;++Je){const mt=Je*B-We,yt=pe*Y+xe*pt+ue*Je,Vt=I*(_-1-Ve)+T*(L-1-mt)+$*ce;for(let Dt=0;Dt<U;++Dt){const zt=N[yt+ye*Dt],Kt=C[Vt+Dt];st+=zt*Kt}}}const St=ae*Y+we*re+Ce*He+ve*ce;w[St]=st}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const _Z={kernelName:wg,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n;rt([a,o],"conv3d");const h=Ki(a.shape,o.shape,i,u,c),{filterDepth:p,filterHeight:f,filterWidth:g,dilationDepth:b,dilationHeight:y,dilationWidth:v,padInfo:w}=h,N=w.front,C=w.left,I=w.top,T=new Zs(h.outShape,a.dtype),$=t.data.get(a.dataId).values,E=t.data.get(o.dataId).values,_=T.values,L=ut(a.shape),O=ut(o.shape);for(let z=0;z<h.batchSize;++z){const A=z*L[0],U=z*T.strides[0];for(let X=0;X<h.outDepth;++X){const Z=U+X*T.strides[1],q=X*h.strideDepth-N;for(let B=0;B<p;++B){const K=q+B*b;if(K<0||K>=h.inDepth)continue;const J=B*O[0],Q=A+K*L[1];for(let ae=0;ae<h.outHeight;++ae){const we=Z+ae*T.strides[2],Ce=ae*h.strideHeight-I;for(let ve=0;ve<f;++ve){const pe=Ce+ve*y;if(pe<0||pe>=h.inHeight)continue;const xe=J+ve*O[1],ue=Q+pe*L[2];for(let ye=0;ye<h.outWidth;++ye){const Y=we+ye*h.outChannels,ce=ye*h.strideWidth-C;for(let re=0;re<g;++re){const ke=ce+re*v;if(ke<0||ke>=h.inWidth)continue;const Me=xe+re*O[2],Ue=ue+ke*h.inChannels;let He=Me;for(let We=0;We<h.inChannels;++We){const je=$[Ue+We];for(let Xe=0;Xe<h.outChannels;++Xe)_[Y+Xe]+=je*E[He+Xe];He+=h.outChannels}}}}}}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const FZ={kernelName:Ng,backendName:"cpu",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,filterShape:u}=n;rt([a,o],"conv3dBackpropFilterV2");const h=ut(a.shape),p=ut(o.shape),f=Ki(a.shape,u,i,1,c),g=f.strideDepth,b=f.strideHeight,y=f.strideWidth,v=f.filterDepth,w=f.filterHeight,N=f.filterWidth,C=new Zs(f.filterShape,"float32"),I=C.values,[T,$,E,_]=C.strides,L=t.data.get(o.dataId).values,[O,z,A,U]=p,X=t.data.get(a.dataId).values,[Z,q,B,K]=h,J=f.padInfo.front,Q=f.padInfo.left,ae=f.padInfo.top;for(let we=0;we<v;++we){const Ce=Math.max(0,Math.ceil((J-we)/g)),ve=Math.min(f.outDepth,(f.inDepth+J-we)/g),pe=we*T;for(let xe=0;xe<w;++xe){const ue=Math.max(0,Math.ceil((ae-xe)/b)),ye=Math.min(f.outHeight,(f.inHeight+ae-xe)/b),Y=xe*$+pe;for(let ce=0;ce<N;++ce){const re=Math.max(0,Math.ceil((Q-ce)/y)),ke=Math.min(f.outWidth,(f.inWidth+Q-ce)/y),Me=ce*E+Y;for(let Ue=0;Ue<f.inChannels;++Ue){const He=Ue*_+Me;for(let We=0;We<f.outChannels;++We){let je=0;for(let Xe=0;Xe<f.batchSize;++Xe){const st=Xe*Z,St=Xe*O;for(let pt=Ce;pt<ve;++pt){const Je=(we+pt*g-J)*q+st,mt=pt*z+St;for(let yt=ue;yt<ye;++yt){const Dt=(xe+yt*b-ae)*B+Je,zt=yt*A+mt;for(let Kt=re;Kt<ke;++Kt){const Ls=(ce+Kt*y-Q)*K+Dt,Hn=Kt*U+zt;je+=X[Ls+Ue]*L[Hn+We]}}}}I[He+We]=je}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const MZ={kernelName:qy,backendName:"cpu",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{pad:i,strides:c,inputShape:u}=n;rt([a],"conv3dBackpropInputV2");const h=ut(a.shape),p=ut(o.shape),f=Ki(u,o.shape,c,1,i),g=new Zs(f.inShape,"float32"),b=g.values,[y,v,w,N]=g.strides,C=t.data.get(a.dataId).values,[I,T,$,E]=h,_=t.data.get(o.dataId).values,[L,O,z,A]=p,{batchSize:U,filterDepth:X,filterHeight:Z,filterWidth:q,inChannels:B,inDepth:K,inHeight:J,inWidth:Q,outChannels:ae,outDepth:we,outHeight:Ce,outWidth:ve,strideDepth:pe,strideHeight:xe,strideWidth:ue}=f,ye=X-1-f.padInfo.front,Y=Z-1-f.padInfo.top,ce=q-1-f.padInfo.left;for(let re=0;re<U;++re)for(let ke=0;ke<B;++ke)for(let Me=0;Me<K;++Me){const Ue=Me-ye,He=Math.max(0,Math.ceil(Ue/pe)),We=Math.min(we,(X+Ue)/pe);for(let je=0;je<J;++je){const Xe=je-Y,st=Math.max(0,Math.ceil(Xe/xe)),St=Math.min(Ce,(Z+Xe)/xe);for(let pt=0;pt<Q;++pt){const Ve=pt-ce,Je=Math.max(0,Math.ceil(Ve/ue)),mt=Math.min(ve,(q+Ve)/ue);let yt=0;for(let Vt=He;Vt<We;++Vt){const Dt=Vt*pe-Ue;for(let zt=st;zt<St;++zt){const Kt=zt*xe-Xe;for(let jt=Je;jt<mt;++jt){const Ls=jt*ue-Ve,Hn=I*re+T*Vt+$*zt+E*jt,Dr=L*(X-1-Dt)+O*(Z-1-Kt)+z*(q-1-Ls)+A*ke;for(let aa=0;aa<ae;++aa){const ra=C[Hn+aa],sn=_[Dr+aa];yt+=ra*sn}}}}b[y*re+v*Me+w*je+N*pt+ke]=yt}}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const PZ={kernelName:Ky,backendName:"cpu",kernelFunc:zZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BZ=Qt(Mh,s=>Math.cos(s)),VZ={kernelName:Mh,backendName:"cpu",kernelFunc:BZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=Qt(zh,s=>Math.cosh(s)),GZ={kernelName:zh,backendName:"cpu",kernelFunc:UZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(s){const{inputs:e,backend:t,attrs:n}=s,{image:a,boxes:o,boxInd:i}=e,{cropSize:c,method:u,extrapolationValue:h}=n,[p,f,g,b]=a.shape,y=o.shape[0],[v,w]=c,N=$t([y,v,w,b],"float32"),C=t.data.get(o.dataId).values,I=t.data.get(i.dataId).values,T=t.data.get(a.dataId).values,$=ut(a.shape),E=ut(N.shape);for(let _=0;_<y;_++){const L=_*4,O=C[L],z=C[L+1],A=C[L+2],U=C[L+3],X=I[_];if(X>=p)continue;const Z=v>1?(A-O)*(f-1)/(v-1):0,q=w>1?(U-z)*(g-1)/(w-1):0;for(let B=0;B<v;B++){const K=v>1?O*(f-1)+B*Z:.5*(O+A)*(f-1);if(K<0||K>f-1){for(let J=0;J<w;J++)for(let Q=0;Q<b;Q++){const ae=Q+J*E[2]+B*E[1]+_*E[0];N.values[ae]=h}continue}if(u==="bilinear"){const J=Math.floor(K),Q=Math.ceil(K),ae=K-J;for(let we=0;we<w;we++){const Ce=w>1?z*(g-1)+we*q:.5*(z+U)*(g-1);if(Ce<0||Ce>g-1){for(let ue=0;ue<b;ue++){const ye=ue+we*E[2]+B*E[1]+_*E[0];N.values[ye]=h}continue}const ve=Math.floor(Ce),pe=Math.ceil(Ce),xe=Ce-ve;for(let ue=0;ue<b;ue++){let ye=ue+ve*$[2]+J*$[1]+X*$[0];const Y=T[ye];ye=ue+pe*$[2]+J*$[1]+X*$[0];const ce=T[ye];ye=ue+ve*$[2]+Q*$[1]+X*$[0];const re=T[ye];ye=ue+pe*$[2]+Q*$[1]+X*$[0];const ke=T[ye],Me=Y+(ce-Y)*xe,Ue=re+(ke-re)*xe;ye=ue+we*E[2]+B*E[1]+_*E[0],N.values[ye]=Me+(Ue-Me)*ae}}}else for(let J=0;J<w;++J){const Q=w>1?z*(g-1)+J*q:.5*(z+U)*(g-1);if(Q<0||Q>g-1){for(let Ce=0;Ce<b;Ce++){const ve=Ce+J*E[2]+B*E[1]+_*E[0];N.values[ve]=h}continue}const ae=Math.round(Q),we=Math.round(K);for(let Ce=0;Ce<b;Ce++){const ve=Ce+ae*$[2]+we*$[1]+X*$[0],pe=Ce+J*E[2]+B*E[1]+_*E[0];N.values[pe]=T[ve]}}}}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const HZ={kernelName:Yy,backendName:"cpu",kernelFunc:WZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;rt(a,"cumprod");const u=ws([o],a.shape.length);let h=a;u!=null&&(h=na({inputs:{x:a},backend:t,attrs:{perm:u}}));const p=_s(1,a.shape.length)[0];if(p!==h.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(h.shape.length-1," but got axis=").concat(p));const f=ya(h.dtype,"int32"),g=Ly(Ae(h.shape),f),b=t.data.get(h.dataId).values,y=h.shape[h.shape.length-1],v=c?(N,C)=>N+y-C-1:(N,C)=>N+C;for(let N=0;N<b.length;N+=y)for(let C=0;C<y;C++){const I=v(N,C);if(C===0)g[I]=i?1:b[I];else{const T=v(N,C-1);g[I]=i?b[T]*g[T]:b[I]*g[T]}}const w=t.makeTensorInfo(h.shape,f,g);if(u!=null){const N=Xi(u),C=na({inputs:{x:w},backend:t,attrs:{perm:N}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(h),C}return w}const KZ={kernelName:Xy,backendName:"cpu",kernelFunc:qZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;rt(a,"cumsum");const u=ws([o],a.shape.length);let h=a;u!=null&&(h=na({inputs:{x:a},backend:t,attrs:{perm:u}}));const p=_s(1,a.shape.length)[0];if(p!==h.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(h.shape.length-1," but got axis=").concat(p));const f=ya(h.dtype,"int32"),g=An(Ae(h.shape),f),b=t.data.get(h.dataId).values,y=h.shape[h.shape.length-1],v=c?(N,C)=>N+y-C-1:(N,C)=>N+C;for(let N=0;N<b.length;N+=y)for(let C=0;C<y;C++){const I=v(N,C);if(C===0)g[I]=i?0:b[I];else{const T=v(N,C-1);g[I]=i?b[T]+g[T]:b[I]+g[T]}}const w=t.makeTensorInfo(h.shape,f,g);if(u!=null){const N=Xi(u),C=na({inputs:{x:w},backend:t,attrs:{perm:N}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(h),C}return w}const YZ={kernelName:Sg,backendName:"cpu",kernelFunc:XZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i,binaryOutput:c}=n;if(a.shape.length===1){const u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=Tw(u,h,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,p)}else if(a.shape.length===2){const u=t.bufferSync(a),h=t.bufferSync(o),p=WA(u,h,i,c);return t.makeTensorInfo(p.shape,o.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}const QZ={kernelName:Zy,backendName:"cpu",kernelFunc:ZZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockSize:o,dataFormat:i}=n;V(i==="NHWC",()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(i));const c=a.shape[0],u=a.shape[1],h=a.shape[2],p=a.shape[3],f=u*o,g=h*o,b=p/(o*o),y=t.data.get(a.dataId).values,v=new Float32Array(c*f*g*b);let w=0;for(let N=0;N<c;++N)for(let C=0;C<f;++C){const I=Math.floor(C/o),T=C%o;for(let $=0;$<g;++$){const E=Math.floor($/o),_=$%o,L=(T*o+_)*b;for(let O=0;O<b;++O){const A=O+L+p*(E+h*(I+u*N));v[w++]=y[A]}}}return t.makeTensorInfo([c,f,g,b],a.dtype,v)}const eQ={kernelName:Qy,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u,dimRoundingMode:h}=n;rt([a,o],"depthwiseConv2DNative");const p=ut(a.shape),f=ut(o.shape);let g=u;g==null&&(g=[1,1]),V(Nn(i,g),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(g,"'"));const b=hn(a.shape,o.shape,i,g,c,h,!0),{filterHeight:y,filterWidth:v,dilationHeight:w,dilationWidth:N,padInfo:C}=b,I=C.left,T=C.top,$=b.outChannels/b.inChannels,E=new Zs(b.outShape,a.dtype),_=t.data.get(a.dataId).values,L=t.data.get(o.dataId).values,O=E.values;for(let z=0;z<b.batchSize;++z){const A=z*p[0],U=z*E.strides[0];for(let X=0;X<b.outHeight;++X){const Z=U+X*E.strides[1],q=X*b.strideHeight-T;for(let B=0;B<y;++B){const K=q+B*w;if(K<0||K>=b.inHeight)continue;const J=B*f[0],Q=A+K*p[1];for(let ae=0;ae<b.outWidth;++ae){const we=Z+ae*E.strides[2],Ce=ae*b.strideWidth-I;for(let ve=0;ve<v;++ve){const pe=Ce+ve*N;if(pe<0||pe>=b.inWidth)continue;const xe=J+ve*f[1],ue=Q+pe*b.inChannels;let ye=we,Y=xe;for(let ce=0;ce<b.inChannels;++ce){const re=_[ue+ce];for(let ke=0;ke<$;++ke)O[ye+ke]+=re*L[Y+ke];ye+=$,Y+=$}}}}}}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const tQ={kernelName:Cg,backendName:"cpu",kernelFunc:WE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,filterShape:p}=n;rt([a,o],"depthwiseConv2dNativeBackpropFilter");const f=hn(a.shape,p,i,c,u,h,!0),{strideHeight:g,strideWidth:b,filterHeight:y,filterWidth:v}=f,w=new Zs(f.filterShape,"float32"),N=f.padInfo.left,C=f.padInfo.top,I=f.outChannels/f.inChannels,T=t.data.get(a.dataId).values,$=new Zs(a.shape,a.dtype,T),E=t.data.get(o.dataId).values,_=new Zs(o.shape,o.dtype,E);for(let L=0;L<y;++L){const O=Math.max(0,Math.ceil((C-L)/g)),z=Math.min(f.outHeight,(f.inHeight+C-L)/g);for(let A=0;A<v;++A){const U=Math.max(0,Math.ceil((N-A)/b)),X=Math.min(f.outWidth,(f.inWidth+N-A)/b);for(let Z=0;Z<f.outChannels;++Z){const q=Math.trunc(Z/I),B=Z%I;let K=0;for(let J=0;J<f.batchSize;++J)for(let Q=O;Q<z;++Q){const ae=L+Q*g-C;for(let we=U;we<X;++we){const Ce=A+we*b-N;K+=$.get(J,ae,Ce,q)*_.get(J,Q,we,Z)}}w.set(K,L,A,q,B)}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const nQ={kernelName:Jy,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,inputShape:p}=n;rt([a,o],"depthwiseConv2DNativeBackpropInput");const f=ut(a.shape),g=ut(o.shape),b=hn(p,o.shape,i,c,u,h,!0),y=new Zs(b.inShape,"float32"),v=y.values,[w,N,C]=y.strides,I=t.data.get(a.dataId).values,[T,$,E]=f,_=t.data.get(o.dataId).values,[L,O,z]=g,{batchSize:A,filterHeight:U,filterWidth:X,inChannels:Z,inHeight:q,inWidth:B,outChannels:K,outHeight:J,outWidth:Q,strideHeight:ae,strideWidth:we}=b,Ce=U-1-b.padInfo.top,ve=X-1-b.padInfo.left,pe=K/Z;for(let xe=0;xe<A;++xe)for(let ue=0;ue<Z;++ue)for(let ye=0;ye<q;++ye){const Y=ye-Ce,ce=Math.max(0,Math.ceil(Y/ae)),re=Math.min(J,(U+Y)/ae);for(let ke=0;ke<B;++ke){const Me=ke-ve,Ue=Math.max(0,Math.ceil(Me/we)),He=Math.min(Q,(X+Me)/we);let We=0;for(let je=ce;je<re;++je){const Xe=je*ae-Y;for(let st=Ue;st<He;++st){const St=st*we-Me,pt=T*xe+$*je+E*st,Ve=L*(U-1-Xe)+O*(X-1-St)+z*ue;for(let Je=0;Je<pe;++Je){const mt=ue*pe+Je,yt=I[pt+mt],Vt=_[Ve+Je];We+=yt*Vt}}}v[w*xe+N*ye+C*ke+ue]=We}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const rQ={kernelName:e2,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQ(s){const{inputs:e,backend:t}=s,{x:n}=e,a=Ae(n.shape),o=t.data.get(n.dataId).values,i=$t([a,a],n.dtype),c=i.values;for(let h=0;h<o.length;h++)c[h*a+h]=o[h];const u=[...n.shape,...n.shape];return t.makeTensorInfo(u,i.dtype,i.values)}const iQ={kernelName:t2,backendName:"cpu",kernelFunc:oQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQ={kernelName:kg,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a}=s,{strides:o,pad:i,dilations:c}=t,u=e,h=u.data.get(n.dataId).values,p=n.shape.length,f=u.data.get(a.dataId).values,g=a.shape.length,{batchSize:b,inHeight:y,inWidth:v,inChannels:w,outHeight:N,outWidth:C,padInfo:I,strideHeight:T,strideWidth:$,filterHeight:E,filterWidth:_,dilationHeight:L,dilationWidth:O,outShape:z}=Cp(n.shape,a.shape,o,i,"NHWC",c),A=Ae(z),U=z.length,X=Ds(n.dtype,A);for(let q=0;q<b;++q)for(let B=0;B<N;++B){const K=B*T-I.top;for(let J=0;J<C;++J){const Q=J*$-I.left;for(let ae=0;ae<w;++ae){let we=Number.MIN_SAFE_INTEGER;for(let ve=0;ve<E;++ve){const pe=K+ve*L;if(pe>=0&&pe<y)for(let xe=0;xe<_;++xe){const ue=Q+xe*O;if(ue>=0&&ue<v){const ye=Zr([q,pe,ue,ae],p,ut(n.shape)),Y=Zr([ve,xe,ae],g,ut(a.shape)),ce=h[ye]+f[Y];ce>we&&(we=ce)}}}const Ce=Zr([q,B,J,ae],U,ut(z));X[Ce]=we}}}return{dataId:u.write(ec(X,n.dtype),z,n.dtype),shape:z,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQ={kernelName:M1,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a,dy:o}=s,{strides:i,pad:c,dilations:u}=t,h=e,p=or(n.shape,h.data.get(n.dataId).values),f=or(a.shape,h.data.get(a.dataId).values),{batchSize:g,inHeight:b,inWidth:y,inChannels:v,outHeight:w,outWidth:N,padInfo:C,strideHeight:I,strideWidth:T,filterHeight:$,filterWidth:E,dilationHeight:_,dilationWidth:L,outShape:O}=Cp(n.shape,a.shape,i,c,"NHWC",u);V(o.rank===O.length,()=>"Error in ".concat(M1,", dy ")+"must have the same rank as output ".concat(O.length,", but got ")+"".concat(o.rank));const z=or(O,h.data.get(o.dataId).values),A=zk(a.shape,a.dtype);for(let X=0;X<g;++X)for(let Z=0;Z<w;++Z){const q=Z*I-C.top;for(let B=0;B<N;++B){const K=B*T-C.left;for(let J=0;J<v;++J){let Q=Number.MIN_SAFE_INTEGER,ae=0,we=0;for(let Ce=0;Ce<$;++Ce){const ve=q+Ce*_;if(ve>=0&&ve<b)for(let pe=0;pe<E;++pe){const xe=K+pe*L;if(xe>=0&&xe<y){const ue=p[X][ve][xe][J]+f[Ce][pe][J];ue>Q&&(Q=ue,ae=Ce,we=pe)}}}A[ae][we][J]+=z[X][Z][B][J]}}}return{dataId:h.write(ec(A,n.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ={kernelName:L1,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a,dy:o}=s,{strides:i,pad:c,dilations:u}=t,h=e,p=or(n.shape,h.data.get(n.dataId).values),f=or(a.shape,h.data.get(a.dataId).values),{batchSize:g,inHeight:b,inWidth:y,inChannels:v,outHeight:w,outWidth:N,padInfo:C,strideHeight:I,strideWidth:T,filterHeight:$,filterWidth:E,dilationHeight:_,dilationWidth:L,outShape:O}=Cp(n.shape,a.shape,i,c,"NHWC",u);V(o.rank===O.length,()=>"Error in ".concat(L1,", dy ")+"must have the same rank as output ".concat(O.length,", but got ")+"".concat(o.rank));const z=or(O,h.data.get(o.dataId).values),A=zk(n.shape,n.dtype);for(let X=0;X<g;++X)for(let Z=0;Z<w;++Z){const q=Z*I-C.top;for(let B=0;B<N;++B){const K=B*T-C.left;for(let J=0;J<v;++J){let Q=Number.MIN_SAFE_INTEGER,ae=q<0?0:q,we=K<0?0:K;for(let Ce=0;Ce<$;++Ce){const ve=q+Ce*_;if(ve>=0&&ve<b)for(let pe=0;pe<E;++pe){const xe=K+pe*L;if(xe>=0&&xe<y){const ue=p[X][ve][xe][J]+f[Ce][pe][J];ue>Q&&(Q=ue,ae=ve,we=xe)}}}A[X][ae][we][J]+=z[X][Z][B][J]}}}return{dataId:h.write(ec(A,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(s){const{inputs:e,backend:t,attrs:n}=s,{image:a}=e,{canvas:o,options:i}=n,{contextOptions:c,imageOptions:u}=i||{},h=(u==null?void 0:u.alpha)||1,p=(c==null?void 0:c.contextType)||"2d";if(p!=="2d")throw new Error("Context type ".concat(c.contextType," is not supported by the CPU backend."));const f=o.getContext(p,(c==null?void 0:c.contextAttributes)||{});if(f==null)throw new Error("Could not get the context with ".concat(p," type."));const[g,b]=a.shape.slice(0,2),y=a.shape.length===2?1:a.shape[2],v=t.data.get(a.dataId).values,w=a.dtype==="float32"?255:1,N=new Uint8ClampedArray(b*g*4);for(let I=0;I<g*b;++I){const T=[0,0,0,255*h];for(let E=0;E<y;E++){const _=v[I*y+E];if(a.dtype==="float32"){if(_<0||_>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(_,"."))}else if(a.dtype==="int32"&&(_<0||_>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(_,"."));y===1?(T[0]=_*w,T[1]=_*w,T[2]=_*w):T[E]=_*w}const $=I*4;N[$+0]=Math.round(T[0]),N[$+1]=Math.round(T[1]),N[$+2]=Math.round(T[2]),N[$+3]=Math.round(T[3])}o.width=b,o.height=g;const C=new ImageData(N,b,g);return f.putImageData(C,0,0),a}const hQ={kernelName:t7,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vp(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;rt(a,"sum");let c;a.dtype==="bool"?c=Ui({inputs:{x:a},backend:t,attrs:{dtype:"int32"}}):c=no({inputs:{x:a},backend:t});const u=c.shape.length,h=At(o,c.shape),p=ws(h,u);let f=h,g=c;p!=null&&(g=na({inputs:{x:c},backend:t,attrs:{perm:p}}),f=_s(f.length,u)),Sn("sum",f,g.shape.length);const[b,y]=pn(g.shape,f),v=ya(g.dtype,"int32");let w=Zm(t,b,v);const N=Ae(y),C=t.data.get(w.dataId).values,I=t.data.get(g.dataId).values;for(let T=0;T<C.length;++T){const $=T*N;let E=0;for(let _=0;_<N;++_)E+=I[$+_];C[T]=E}if(i){const T=Rs(w.shape,h),$=w;w=hs({inputs:{x:w},backend:t,attrs:{shape:T}}),t.disposeIntermediateTensorInfo($)}return t.disposeIntermediateTensorInfo(c),p!=null&&t.disposeIntermediateTensorInfo(g),w}const pQ={kernelName:ax,backendName:"cpu",kernelFunc:Vp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(s){const{inputs:e,backend:t,attrs:n}=s,{equation:a}=n,o=e,{allDims:i,summedDims:c,idDims:u}=Yv(a,o.length);Qv(i.length,u,o);const{path:h,steps:p}=Jv(c,u),f=p.length;let g=null,b=i.length;const y=[];for(let v=0;v<f;++v){for(const w of p[v]){const{permutationIndices:N,expandDims:C}=Zv(b,u[w]);let I;ew(N)?I=o[w]:(I=na({inputs:{x:o[w]},backend:t,attrs:{perm:N}}),y.push(I));const T=I.shape.slice();for(let $=0;$<C.length;++$)T.splice(C[$],0,1);Mt(I.shape,T)||(I=hs({inputs:{x:I},backend:t,attrs:{shape:T}}),y.push(I)),g===null?g=I:(g=Yx({inputs:{a:I,b:g},backend:t}),y.push(g))}v<f-1&&(h[v]>=0&&(g=Vp({inputs:{x:g},backend:t,attrs:{axis:h[v]-(i.length-b),keepDims:!1}}),y.push(g)),b--)}for(const v of y)v!==g&&t.disposeIntermediateTensorInfo(v);return g}const mQ={kernelName:s2,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(s){const{inputs:e,backend:t}=s,{dy:n,y:a}=e;rt([n,a],"eluGrad");const o=new Float32Array(Ae(a.shape)),i=t.data.get(a.dataId).values,c=t.data.get(n.dataId).values;for(let u=0;u<i.length;++u){const h=i[u];h>=0?o[u]=c[u]:o[u]=c[u]*(h+1)}return t.makeTensorInfo(a.shape,"float32",o)}const xQ={kernelName:n2,backendName:"cpu",kernelFunc:gQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ=Uv,yQ=Gv,vQ=Wv,wQ=Hv,NQ=qv,SQ=Kv,CQ=Qt(Vh,s=>{const e=Math.sign(s),t=Math.abs(s),n=1/(1+bQ*t);return e*(1-((((SQ*n+NQ)*n+wQ)*n+vQ)*n+yQ)*n*Math.exp(-t*t))}),kQ={kernelName:Vh,backendName:"cpu",kernelFunc:CQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(s){const{inputs:e,backend:t,attrs:n}=s,{input:a}=e,{dim:o}=n,i=a.shape.length,c=a.shape.slice();let u=o;return o<0&&(V(-(i+1)<=o,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),u=i+o+1),c.splice(u,0,1),hs({inputs:{x:a},backend:t,attrs:{shape:c}})}const jQ={kernelName:Tg,backendName:"cpu",kernelFunc:eg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ=Fs((s,e)=>s/e),Rw=tn(Ph,TQ),ky={kernelName:Ph,backendName:"cpu",kernelFunc:Rw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HE(s,e,t){const n=s.shape,a=n[0],o=n[1],i=t.data.get(s.dataId),c=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,h=[a,o],p=Ae(h),f=vn("float32",p),g=vn("float32",p);for(let w=0;w<a;w++){const N=Ql({inputs:{x:c},backend:t,attrs:{begin:[w,0],size:[1,o]}}),C=Ql({inputs:{x:u},backend:t,attrs:{begin:[w,0],size:[1,o]}}),I=ga({inputs:{real:N,imag:C},backend:t}),{real:T,imag:$}=IQ(I,e,t),E=Lo(T,$);for(let _=0;_<o;_++){const L=Xv(E,_);f[w*o+_]=L.real,g[w*o+_]=L.imag}t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo(I)}const b=t.makeTensorInfo(h,"float32",f),y=t.makeTensorInfo(h,"float32",g),v=ga({inputs:{real:b,imag:y},backend:t});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),v}function IQ(s,e,t){const n=Ae(s.shape),a=t.data.get(s.dataId),o=t.data.get(a.complexTensorInfos.real.dataId).values,i=t.data.get(a.complexTensorInfos.imag.dataId).values;if($Q(n)){const c=jy(o,i,n,e,t),u=[s.shape[0],s.shape[1]];if(e){const h=t.makeTensorInfo(u,"float32",c.real),p=t.makeTensorInfo(u,"float32",c.imag),f=t.makeTensorInfo([],"float32",Wi(n,"float32")),g=no({inputs:{x:f},backend:t}),b=ky.kernelFunc({inputs:{a:h,b:f},backend:t}),y=ky.kernelFunc({inputs:{a:p,b:g},backend:t}),v=t.data.get(b.dataId).values,w=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),{real:v,imag:w}}return c}else{const c=Lo(o,i),u=AQ(c,n,e);return JT(u)}}function $Q(s){return(s&s-1)===0}function jy(s,e,t,n,a){if(t===1)return{real:s,imag:e};const o=Lo(s,e),i=t/2,c=eI(o),u=c.real,h=c.imag,p=[u.length],f=a.makeTensorInfo(p,"float32",u),g=a.makeTensorInfo(p,"float32",h),b=ga({inputs:{real:f,imag:g},backend:a}),y=tI(o),v=y.real,w=y.imag,N=[v.length],C=a.makeTensorInfo(N,"float32",v),I=a.makeTensorInfo(N,"float32",w),T=ga({inputs:{real:C,imag:I},backend:a}),$=jy(u,h,i,n,a),E=$.real,_=$.imag,L=[E.length],O=a.makeTensorInfo(L,"float32",E),z=a.makeTensorInfo(L,"float32",_),A=ga({inputs:{real:O,imag:z},backend:a}),U=jy(v,w,i,n,a),X=U.real,Z=U.imag,q=[X.length],B=a.makeTensorInfo(q,"float32",X),K=a.makeTensorInfo(q,"float32",Z),J=ga({inputs:{real:B,imag:K},backend:a}),Q=nI(t,n),ae=[Q.real.length],we=a.makeTensorInfo(ae,"float32",Q.real),Ce=a.makeTensorInfo(ae,"float32",Q.imag),ve=ga({inputs:{real:we,imag:Ce},backend:a}),pe=Yx({inputs:{a:ve,b:J},backend:a}),xe=Cu({inputs:{a:A,b:pe},backend:a}),ue=Ew({inputs:{a:A,b:pe},backend:a}),ye=Zl({inputs:{input:xe},backend:a}),Y=Zl({inputs:{input:ue},backend:a}),ce=ku({inputs:{input:xe},backend:a}),re=ku({inputs:{input:ue},backend:a}),ke=ju({inputs:[ye,Y],backend:a,attrs:{axis:0}}),Me=ju({inputs:[ce,re],backend:a,attrs:{axis:0}}),Ue=a.data.get(ke.dataId).values,He=a.data.get(Me.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(g),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(J),a.disposeIntermediateTensorInfo(we),a.disposeIntermediateTensorInfo(Ce),a.disposeIntermediateTensorInfo(ve),a.disposeIntermediateTensorInfo(pe),a.disposeIntermediateTensorInfo(xe),a.disposeIntermediateTensorInfo(ue),a.disposeIntermediateTensorInfo(ye),a.disposeIntermediateTensorInfo(ce),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(re),a.disposeIntermediateTensorInfo(ke),a.disposeIntermediateTensorInfo(Me),{real:Ue,imag:He}}function AQ(s,e,t){const n=new Float32Array(e*2);for(let a=0;a<e;a++){let o=0,i=0;for(let c=0;c<e;c++){const u=aI(a*c,e,t),h=Xv(s,c);o+=h.real*u.real-h.imag*u.imag,i+=h.real*u.imag+h.imag*u.real}t&&(o/=e,i/=e),sI(n,o,i,a)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(s){const{inputs:e,backend:t}=s,{input:n}=e,a=Ae(n.shape),o=n.shape[n.shape.length-1],i=a/o,c=hs({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),u=HE(c,!1,t),h=hs({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),h}const DQ={kernelName:a2,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _w(s){const{backend:e,attrs:t}=s,{shape:n,value:a,dtype:o}=t,i=o||Eu(a),c=Ds(i,Ae(n));return _Q(c,a,i),e.makeTensorInfo(n,i,c)}const RQ={kernelName:r2,backendName:"cpu",kernelFunc:_w};function _Q(s,e,t){s.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ={kernelName:o2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,a=t,o=vn(n.dtype,Ae(n.shape)),[i,c,u,h]=n.shape,p=a.data.get(n.dataId).values;for(let g=0;g<i;g++){const b=g*u*c*h;for(let y=0;y<c;y++){const v=y*(u*h);for(let w=0;w<u;w++){const N=w*h;for(let C=0;C<h;C++){const I=Math.round(u-w-1),T=b+v+N+C;let $=p[T];if(I>=0&&I<u){const E=I*h,_=b+v+E+C;$=p[_]}o[T]=$}}}}return{dataId:a.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n;let v=GE({inputs:{x:a,filter:o},backend:t,attrs:{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g}});if(i){const w=v;if(p==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const N=hs({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});v=Cu({inputs:{a:v,b:N},backend:t}),t.disposeIntermediateTensorInfo(N)}else v=Cu({inputs:{a:v,b:i},backend:t});t.disposeIntermediateTensorInfo(w)}if(b){const w=v;if(p==="NCHW"&&b==="prelu"&&c.shape.length===1&&c.shape[0]!==1){const N=hs({inputs:{x:c},backend:t,attrs:{shape:[c.shape[0],1,1]}});v=Jm(t,v,b,N,y),t.disposeIntermediateTensorInfo(N)}else v=Jm(t,v,b,c,y);t.disposeIntermediateTensorInfo(w)}return v}const LQ={kernelName:Dm,backendName:"cpu",kernelFunc:FQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n;let v=WE({inputs:{x:a,filter:o},backend:t,attrs:{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g}});if(i){const w=v;v=Cu({inputs:{a:v,b:i},backend:t}),t.disposeIntermediateTensorInfo(w)}if(b){const w=v;v=Jm(t,v,b,c,y),t.disposeIntermediateTensorInfo(w)}return v}const zQ={kernelName:Rm,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(s){const{inputs:e,backend:t}=s,{params:n,indices:a}=e,o=Ae(n.shape),i=a.shape,c=i[i.length-1],[u,h,p,f]=Dv(n,a);if(h===0)return t.makeTensorInfo(u,n.dtype,[]);const g=t.data.get(a.dataId).values,b=t.bufferSync(n),y=sE(g,b,n.dtype,h,c,p,f,n.shape,o);return t.makeTensorInfo(u,n.dtype,y.values)}const BQ={kernelName:i2,backendName:"cpu",kernelFunc:PQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,indices:o}=e,{axis:i,batchDims:c}=n;rt([a,o],"gatherV2");const u=At(i,a.shape)[0],h=t.data.get(o.dataId).values,p=a.shape[u];for(let T=0;T<h.length;++T){const $=h[T];V($<=p-1&&$>=0,()=>"GatherV2: the index value ".concat($," is not in [0, ").concat(p-1,"]"))}let f=c;c==null&&(f=0);const g=Ae(o.shape),b=sw(a,o,u,f),y=hs({inputs:{x:a},backend:t,attrs:{shape:[b.batchSize,b.outerSize,b.dimSize,b.sliceSize]}}),v=hs({inputs:{x:o},backend:t,attrs:{shape:[b.batchSize,g/b.batchSize]}}),w=[b.batchSize,b.outerSize,g/b.batchSize,b.sliceSize],N=t.bufferSync(v),C=t.bufferSync(y),I=nE(C,N,w);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.makeTensorInfo(b.outputShape,I.dtype,I.values)}const UQ={kernelName:$g,backendName:"cpu",kernelFunc:VQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(s){const{inputs:e,backend:t}=s,{input:n}=e,a=Ae(n.shape),o=n.shape[n.shape.length-1],i=a/o,c=hs({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),u=HE(c,!0,t),h=hs({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),h}const WQ={kernelName:l2,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HQ=Qt(Xh,s=>Number.isFinite(s)?1:0,"bool"),qQ={kernelName:Xh,backendName:"cpu",kernelFunc:HQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ=Qt(Yh,s=>Math.abs(s)===1/0?1:0,"bool"),XQ={kernelName:Yh,backendName:"cpu",kernelFunc:KQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YQ=Qt(Zh,s=>Number.isNaN(s)?1:0,"bool"),ZQ={kernelName:Zh,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(s){const{backend:e,attrs:t}=s,{start:n,stop:a,num:o}=t,i=lE(n,a,o);return e.makeTensorInfo([i.length],"float32",i)}const JQ={kernelName:u2,backendName:"cpu",kernelFunc:QQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eJ=Qt(Jh,s=>Math.log1p(s)),tJ={kernelName:Jh,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=Fs((s,e)=>s&&e),nJ=tn(_g,sJ,null,"bool"),aJ={kernelName:_g,backendName:"cpu",kernelFunc:nJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ=Qt(Og,s=>s?0:1,"bool"),oJ={kernelName:Og,backendName:"cpu",kernelFunc:rJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iJ=Fs((s,e)=>s||e),lJ=tn(Fg,iJ,null,"bool"),cJ={kernelName:Fg,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{depthRadius:o,bias:i,alpha:c,beta:u}=n;rt(a,"LRN");const h=a.shape[3],p=h-1,f=t.data.get(a.dataId).values,g=Ae(a.shape),b=new Float32Array(g);function y(v){const w=v%h;let N=v-w+Math.max(0,w-o);const C=v-w+Math.min(w+o,p);let I=0;for(;N<=C;N++){const T=f[N];I+=T*T}return I}for(let v=0;v<g;v++){const w=y(v),N=f[v]*Math.pow(i+c*w,-u);b[v]=N}return t.makeTensorInfo(a.shape,a.dtype,b)}const dJ={kernelName:Lg,backendName:"cpu",kernelFunc:uJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,y:o,dy:i}=e,{depthRadius:c,bias:u,alpha:h,beta:p}=n;rt(i,"LRNGrad");const f=Ae(i.shape),g=i.shape[3],b=t.data.get(i.dataId).values,y=t.data.get(a.dataId).values,v=t.data.get(o.dataId).values,w=new Float32Array(f),N=f;for(let C=0;C<N;C++){const I=C%g,T=C-I+Math.max(0,I-c),$=C-I+Math.min(g,I+c+1);let E=0;for(let _=T;_<$;_++)E+=Math.pow(y[_],2);E=h*E+u;for(let _=T;_<$;_++){let L=-2*h*p*y[_]*v[C]/E;C===_&&(L+=Math.pow(E,-p)),L*=b[C],w[_]+=L}}return t.makeTensorInfo(i.shape,a.dtype,w)}const pJ={kernelName:d2,backendName:"cpu",kernelFunc:hJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reductionIndices:o,keepDims:i}=n,c=t;let u=a.shape;const h=u.length,p=At(o,u);let f=p;const g=ws(f,h);let b=c.data.get(a.dataId).values;if(g!=null){const T=new Array(h);for(let $=0;$<T.length;$++)T[$]=u[g[$]];b=$w(b,u,a.dtype,g,T),f=_s(f.length,h),u=T}rt(a,"max"),Sn("max",f,h);const[y,v]=pn(u,f),w=Ae(v),N=uE(b,w,y,a.dtype),C=c.write(N,y,a.dtype);let I=y;return i&&(I=Rs(y,p)),{dataId:C,shape:I,dtype:a.dtype}}const fJ={kernelName:Mg,backendName:"cpu",kernelFunc:qE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;rt(a,"maxPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(Nn(i,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=dr(a.shape,o,i,h,c,u);let f;if(p.filterWidth===1&&p.filterHeight===1&&Mt(p.inShape,p.outShape))f=no({inputs:{x:a},backend:t});else{const g=t.data.get(a.dataId).values,b=ut(a.shape),y=Dw(g,a.shape,a.dtype,b,p,"max");f=t.makeTensorInfo(p.outShape,a.dtype,y.values)}return f}const gJ={kernelName:zg,backendName:"cpu",kernelFunc:mJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n;rt(a,"maxPool3d");const p=Uo(a.shape,o,i,1,c,u,h),f=t.data.get(a.dataId).values,g=UE(f,a.shape,a.dtype,ut(a.shape),p,"max");return t.makeTensorInfo(g.shape,"float32",g.values)}const bJ={kernelName:Pg,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,{filterSize:i,strides:c,pad:u,dimRoundingMode:h}=n;rt([a,o],"maxPool3DGrad");const p=Uo(o.shape,i,c,1,u,h),f=t.bufferSync(o),g=iZ(f,p),b=p.strideDepth,y=p.strideHeight,v=p.strideWidth,w=p.dilationDepth,N=p.dilationHeight,C=p.dilationWidth,I=p.effectiveFilterDepth,T=p.effectiveFilterHeight,$=p.effectiveFilterWidth,E=I-1-p.padInfo.front,_=$-1-p.padInfo.left,L=T-1-p.padInfo.top,O=$t(o.shape,"float32"),z=t.bufferSync(a);for(let A=0;A<p.batchSize;++A)for(let U=0;U<p.inChannels;++U)for(let X=0;X<p.inDepth;++X)for(let Z=0;Z<p.inHeight;++Z)for(let q=0;q<p.inWidth;++q){const B=X-E,K=Z-L,J=q-_;let Q=0;for(let ae=0;ae<I;ae+=w){const we=(B+ae)/b;if(!(we<0||we>=p.outDepth||Math.floor(we)!==we))for(let Ce=0;Ce<T;Ce+=N){const ve=(K+Ce)/y;if(!(ve<0||ve>=p.outHeight||Math.floor(ve)!==ve))for(let pe=0;pe<$;pe+=C){const xe=(J+pe)/v;if(xe<0||xe>=p.outWidth||Math.floor(xe)!==xe)continue;const ue=I*T*$-1-g.get(A,we,ve,xe,U),ye=ae*T*$+Ce*$+pe,Y=ue===ye?1:0;if(Y===0)continue;const ce=z.get(A,we,ve,xe,U);Q+=ce*Y}}}O.set(Q,A,X,Z,q,U)}return t.makeTensorInfo(O.shape,O.dtype,O.values)}const vJ={kernelName:p2,backendName:"cpu",kernelFunc:yJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o,output:i}=e,c=o;rt([o,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:p,dimRoundingMode:f}=n,g=dr(c.shape,u,h,1,p,f),b=t.data.get(c.dataId).values,y=$t(g.outShape,c.dtype,VE(b,c.shape,c.dtype,g).values),v=g.strideHeight,w=g.strideWidth,N=g.dilationHeight,C=g.dilationWidth,I=g.effectiveFilterHeight,T=g.effectiveFilterWidth,$=T-1-g.padInfo.left,E=I-1-g.padInfo.top,_=$t(c.shape,"float32"),L=t.data.get(a.dataId).values,O=$t(a.shape,"float32",L);for(let z=0;z<g.batchSize;++z)for(let A=0;A<g.inChannels;++A)for(let U=0;U<g.inHeight;++U)for(let X=0;X<g.inWidth;++X){const Z=U-E,q=X-$;let B=0;for(let K=0;K<I;K+=N){const J=(Z+K)/v;if(!(J<0||J>=g.outHeight||Math.floor(J)!==J))for(let Q=0;Q<T;Q+=C){const ae=(q+Q)/w;if(ae<0||ae>=g.outWidth||Math.floor(ae)!==ae)continue;const we=I*T-1-y.get(z,J,ae,A),Ce=K*T+Q,ve=we===Ce?1:0;if(ve===0)continue;const pe=O.get(z,J,ae,A);B+=pe*ve}}_.set(B,z,U,X,A)}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const NJ={kernelName:h2,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(s,e,t,n,a){const o=ut(e),i=Dw(s,e,t,o,a,"max"),c=VE(s,e,t,a,!0,n);return[i.values,c.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ={kernelName:f2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{filterSize:a,strides:o,pad:i,includeBatchInIndex:c}=e,u=t;rt(n,"MaxPoolWithArgmax");const h=u.data.get(n.dataId).values,p=dr(n.shape,a,o,[1,1],i),[f,g]=SJ(h,n.shape,n.dtype,c,p),b=u.write(f,p.outShape,n.dtype),y=u.write(g,p.outShape,n.dtype);return[{dataId:b,shape:p.outShape,dtype:n.dtype},{dataId:y,shape:p.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=At(o,a.shape),h=pn(a.shape,c)[1],p=Ae(h),f=[],g=t.makeTensorInfo([],"float32",new Float32Array([p]));f.push(g);const b=Ui({inputs:{x:a},backend:t,attrs:{dtype:"float32"}});f.push(b);const y=Rw({inputs:{a:b,b:g},backend:t});f.push(y);const v=Vp({inputs:{x:y},backend:t,attrs:{axis:o,keepDims:i}});return f.forEach(w=>t.disposeIntermediateTensorInfo(w)),v}const jJ={kernelName:Bg,backendName:"cpu",kernelFunc:kJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;rt(a,"min");const c=At(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=na({inputs:{x:a},backend:t,attrs:{perm:h}}),u=_s(u.length,a.shape.length)),Sn("min",u,p.shape.length);const[f,g]=pn(p.shape,u),b=Ae(g),y=An(Ae(f),p.dtype),v=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let I=v[C];for(let T=0;T<b;++T){const $=v[C+T];(Number.isNaN($)||$<I)&&(I=$)}y[N]=I}h!=null&&t.disposeIntermediateTensorInfo(p);const w=t.makeTensorInfo(f,p.dtype,y);if(i){const N=Rs(f,c),C=hs({inputs:{x:w},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(w),C}return w}const IJ={kernelName:Vg,backendName:"cpu",kernelFunc:TJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $J(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,mode:i}=n;rt(a,"mirrorPad");const c=o.map((I,T)=>I[0]+a.shape[T]+I[1]),u=o.map(I=>I[0]),h=o.map((I,T)=>I[0]+a.shape[T]),p=i==="reflect"?0:1,f=t.data.get(a.dataId).values,g=a.shape.length,b=ut(a.shape),y=Ae(c),v=c.length,w=ut(c),N=vn(a.dtype,y);for(let I=0;I<y;I++){let T=Du(I,v,w);for(let E=0;E<v;E++)T[E]<u[E]?T[E]=u[E]*2-T[E]-p:T[E]>=h[E]&&(T[E]=(h[E]-1)*2-T[E]+p);T=T.map((E,_)=>E-u[_]);const $=Zr(T,g,b);N[I]=f[$]}return{dataId:t.write(N,c,a.dtype),shape:c,dtype:a.dtype}}const AJ={kernelName:Ug,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ=Fs((s,e)=>{const t=s%e;return s<0&&e<0||s>=0&&e>=0?t:(t+e)%e}),DJ=tn(sp,EJ),RJ={kernelName:sp,backendName:"cpu",kernelFunc:DJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KE(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{dim:o}=n,i=a.shape.length;let c=o;if(c===-1&&(c=i-1),c!==i-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(i," and dim was ").concat(c));const u=At([c],a.shape),h=qE({inputs:{x:a},backend:t,attrs:{reductionIndices:u,keepDims:!1}}),p=Rs(h.shape,u),f=hs({inputs:{x:h},backend:t,attrs:{shape:p}}),g=Ew({inputs:{a,b:f},backend:t}),b=QA({inputs:{x:g},backend:t}),y=Vp({inputs:{x:b},backend:t,attrs:{axis:u,keepDims:!1}}),v=hs({inputs:{x:y},backend:t,attrs:{shape:p}}),w=Rw({inputs:{a:b,b:v},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),w}const _J={kernelName:ix,backendName:"cpu",kernelFunc:KE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{numSamples:o,seed:i,normalized:c}=n;rt(a,"multinomial");const u=c?a:KE({inputs:{logits:a},backend:t,attrs:{dim:-1}}),h=u.shape[0],p=u.shape[1],f=t.data.get(u.dataId).values,g=[h,o],b=An(Ae(g),"int32");for(let y=0;y<h;++y){const v=y*p,w=new Float32Array(p-1);w[0]=f[v];for(let I=1;I<w.length;++I)w[I]=w[I-1]+f[v+I];const N=kx.alea(i.toString()),C=y*o;for(let I=0;I<o;++I){const T=N();b[C+I]=w.length;for(let $=0;$<w.length;$++)if(T<w[$]){b[C+I]=$;break}}}return c||t.disposeIntermediateTensorInfo(u),t.makeTensorInfo(g,"int32",b)}const FJ={kernelName:m2,backendName:"cpu",kernelFunc:OJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ=kv;function MJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u}=n;rt(a,"NonMaxSuppression");const h=t.data.get(a.dataId).values,p=t.data.get(o.dataId).values,{selectedIndices:f}=LJ(h,p,i,c,u);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const zJ={kernelName:g2,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJ=jv;function BJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,padToMaxOutputSize:h}=n;rt(a,"NonMaxSuppressionPadded");const p=t.data.get(a.dataId).values,f=t.data.get(o.dataId).values,{selectedIndices:g,validOutputs:b}=PJ(p,f,i,c,u,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([],"int32",new Int32Array([b]))]}const VJ={kernelName:x2,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ=Tv;function GJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,softNmsSigma:h}=n;rt(a,"NonMaxSuppressionWithScore");const p=t.data.get(a.dataId).values,f=t.data.get(o.dataId).values,g=i,b=c,y=u,v=h,{selectedIndices:w,selectedScores:N}=UJ(p,f,g,b,y,v);return[t.makeTensorInfo([w.length],"int32",new Int32Array(w)),t.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const WJ={kernelName:b2,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a}=e,{dtype:o,depth:i,onValue:c,offValue:u}=n;rt(a,"oneHot");const h=Ae(a.shape),p=new Float32Array(h*i);p.fill(u);const f=t.data.get(a.dataId).values;for(let g=0;g<h;++g)f[g]>=0&&f[g]<i&&(p[g*i+f[g]]=c);return t.makeTensorInfo([...a.shape,i],o,p)}const qJ={kernelName:qg,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tg(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){const a=Zl({inputs:{input:n},backend:t}),o=tg({inputs:{x:a},backend:t}),i=ku({inputs:{input:n},backend:t}),c=tg({inputs:{x:i},backend:t}),u=ga({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return _w({backend:t,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}const KJ={kernelName:dx,backendName:"cpu",kernelFunc:tg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XE(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){const a=Zl({inputs:{input:n},backend:t}),o=XE({inputs:{x:a},backend:t}),i=ku({inputs:{input:n},backend:t}),c=tg({inputs:{x:i},backend:t}),u=ga({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return _w({backend:t,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}const XJ={kernelName:Hg,backendName:"cpu",kernelFunc:XE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YE(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n;if(e.length===1)return eg({inputs:{input:e[0]},backend:t,attrs:{dim:a}});const o=e[0].shape,i=e[0].dtype;e.forEach(p=>{Sa(o,p.shape,"All tensors passed to stack must have matching shapes"),V(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});const c=[],u=e.map(p=>{const f=eg({inputs:{input:p},backend:t,attrs:{dim:a}});return c.push(f),f}),h=ju({inputs:u,backend:t,attrs:{axis:a}});return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const YJ={kernelName:Kg,backendName:"cpu",kernelFunc:YE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,constantValue:i}=n;rt(a,"pad");const c=o.map((C,I)=>C[0]+a.shape[I]+C[1]),u=o.map(C=>C[0]),h=t.data.get(a.dataId).values,p=Ae(a.shape),f=a.shape.length,g=ut(a.shape),b=Ae(c),y=c.length,v=ut(c),w=vn(a.dtype,b);i!==0&&w.fill(i);for(let C=0;C<p;C++){const T=Du(C,f,g).map((E,_)=>E+u[_]),$=Zr(T,y,v);w[$]=h[C]}return{dataId:t.write(w,c,a.dtype),shape:c,dtype:a.dtype}}const ZE={kernelName:Xg,backendName:"cpu",kernelFunc:ZJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ=Fs((s,e)=>Math.pow(s,e)),JJ=tn(ap,QJ),eee={kernelName:ap,backendName:"cpu",kernelFunc:JJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tee(s){const{inputs:e,backend:t,attrs:n}=s,{paramsNestedSplits:a,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:c}=n,u=a.map(N=>t.data.get(N.dataId).values),h=a.map(N=>N.shape),p=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,[g,b,y]=gE(u,h,p,o.shape,o.dtype,f,i.shape),v=g.map(N=>t.makeTensorInfo([N.length],"int32",N)),w=t.makeTensorInfo(y,o.dtype,b);return v.concat([w])}const see={kernelName:y2,backendName:"cpu",kernelFunc:tee};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(s){const{inputs:e,backend:t}=s,{starts:n,limits:a,deltas:o}=e,i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=xE(i,n.shape,n.dtype,c,a.shape,u,o.shape),f=t.makeTensorInfo([h.length],"int32",h),g=t.makeTensorInfo([p.length],n.dtype,p);return[f,g]}const aee={kernelName:v2,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(s){const{inputs:e,backend:t,attrs:n}=s,{shape:a,values:o,defaultValue:i,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=n,h=t.data.get(a.dataId).values,p=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,g=c.map(w=>t.data.get(w.dataId).values),b=c.map(w=>w.shape),[y,v]=bE(h,a.shape,p,o.shape,o.dtype,f,i.shape,g,b,u);return t.makeTensorInfo(y,o.dtype,v)}const oee={kernelName:w2,backendName:"cpu",kernelFunc:ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(s){const{backend:e,attrs:t}=s,{start:n,stop:a,dtype:o,step:i}=t,c=yE(n,a,i,o);return e.makeTensorInfo([c.length],o,c)}const lee={kernelName:N2,backendName:"cpu",kernelFunc:iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cee=Qt(rp,s=>1/s),uee={kernelName:rp,backendName:"cpu",kernelFunc:cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n;rt(a,"resizeBilinear");const u=ut(a.shape),[h,p]=c,[f,g,b,y]=a.shape,v=t.data.get(a.dataId).values,w=new Float32Array(Ae([f,h,p,y])),N=[o&&h>1?g-1:g,o&&p>1?b-1:b],C=[o&&h>1?h-1:h,o&&p>1?p-1:p];let I=0;const T=N[0]/C[0],$=N[1]/C[1];for(let E=0;E<f;E++)for(let _=0;_<h;_++){let L;i?L=T*(_+.5)-.5:L=T*_;const O=Math.max(0,Math.floor(L)),z=L-O,A=Math.min(g-1,Math.ceil(L)),U=E*u[0]+O*u[1],X=E*u[0]+A*u[1];for(let Z=0;Z<p;Z++){let q;i?q=$*(Z+.5)-.5:q=$*Z;const B=Math.max(0,Math.floor(q)),K=q-B,J=Math.min(b-1,Math.ceil(q)),Q=U+B*u[2],ae=X+B*u[2],we=U+J*u[2],Ce=X+J*u[2];for(let ve=0;ve<y;ve++){const pe=v[Q+ve],xe=v[ae+ve],ue=v[we+ve],ye=v[Ce+ve],Y=pe+(ue-pe)*K,ce=xe+(ye-xe)*K,re=Y+(ce-Y)*z;w[I++]=re}}}return t.makeTensorInfo([f,h,p,y],"float32",w)}const hee={kernelName:ex,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n;rt([o,a],"resizeBilinearGrad");const c=ut(a.shape),[u,h,p,f]=a.shape,[,g,b]=o.shape,y=new Float32Array(u*h*p*f),v=[i&&g>1?h-1:h,i&&b>1?p-1:p],w=[i&&g>1?g-1:g,i&&b>1?b-1:b],N=v[0]/w[0],C=v[1]/w[1],I=t.data.get(o.dataId).values;let T=0;for(let $=0;$<u;$++){const E=$*c[0];for(let _=0;_<g;_++){const L=_*N,O=Math.floor(L),z=Math.min(Math.ceil(L),h-1),A=E+O*c[1],U=E+z*c[1],X=L-O,Z=1-X;for(let q=0;q<b;q++){const B=q*C,K=Math.floor(B),J=Math.min(Math.ceil(B),p-1),Q=B-K,ae=1-Q,we=A+K*c[2],Ce=A+J*c[2],ve=U+K*c[2],pe=U+J*c[2],xe=Z*ae,ue=Z*Q,ye=X*ae,Y=X*Q;for(let ce=0;ce<f;ce++){const re=I[T++];y[we+ce]+=re*xe,y[Ce+ce]+=re*ue,y[ve+ce]+=re*ye,y[pe+ce]+=re*Y}}}}return t.makeTensorInfo([u,p,h,f],"float32",y)}const fee={kernelName:k2,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n;rt(a,"resizeNearestNeighbor");const u=ut(a.shape),[h,p]=c,[f,g,b,y]=a.shape,v=t.data.get(a.dataId).values,w=new Float32Array(f*h*p*y),N=[o&&h>1?g-1:g,o&&p>1?b-1:b],C=[o&&h>1?h-1:h,o&&p>1?p-1:p],I=N[0]/C[0],T=N[1]/C[1];let $=0;for(let E=0;E<f;E++){const _=E*u[0];for(let L=0;L<h;L++){const O=i?I*(L+.5):I*L;let z=Math.min(g-1,o?Math.round(O):Math.floor(O));i&&(z=Math.max(0,z));const A=_+z*u[1];for(let U=0;U<p;U++){const X=i?T*(U+.5):T*U;let Z=Math.min(b-1,o?Math.round(X):Math.floor(X));i&&(Z=Math.max(0,Z));const q=A+Z*u[2];for(let B=0;B<y;B++){const K=v[q+B];w[$++]=K}}}}return t.makeTensorInfo([f,h,p,y],a.dtype,w)}const gee={kernelName:Jg,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n;rt([o,a],"resizeNearestNeighborGrad");const c=ut(a.shape),u=ut(o.shape),[h,p,f,g]=a.shape,[,b,y]=o.shape,v=new Float32Array(h*p*f*g),w=t.data.get(o.dataId).values,N=[i&&b>1?p-1:p,i&&y>1?f-1:f],C=[i&&b>1?b-1:b,i&&y>1?y-1:y],I=N[0]/C[0],T=N[1]/C[1],$=1/I,E=1/T,_=Math.ceil($)*2+2,L=Math.ceil(E)*2+2;for(let O=0;O<h;O++){const z=O*c[0];for(let A=0;A<p;A++){const U=z+A*c[1],X=Math.floor(A*$),Z=Math.floor(X-_/2);for(let q=0;q<f;q++){const B=U+q*c[2],K=Math.floor(q*E),J=Math.floor(K-L/2);for(let Q=0;Q<g;Q++){let ae=0;for(let we=0;we<_;we++){const Ce=we+Z;if(Ce<0||Ce>=b)continue;const ve=z+Ce*u[1],pe=Ce*I,xe=Math.min(p-1,i?Math.round(pe):Math.floor(pe));if(A===xe)for(let ue=0;ue<L;ue++){const ye=ue+J;if(ye<0||ye>=y)continue;const Y=ve+ye*u[2],ce=ye*T,re=Math.min(f-1,i?Math.round(ce):Math.floor(ce));q===re&&(ae+=w[Y+Q])}}v[B+Q]=ae}}}}return t.makeTensorInfo(a.shape,a.dtype,v)}const bee={kernelName:C2,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dims:o}=n;rt(a,"reverse");const i=a.shape.length,c=At(o,a.shape);if(i===0)return no({inputs:{x:a},backend:t});const u=new Zs(a.shape,a.dtype),h=t.bufferSync(a);for(let p=0;p<u.size;p++){const f=u.indexToLoc(p),g=f.slice();c.forEach(b=>g[b]=a.shape[b]-1-g[b]),u.set(h.get(...g),...f)}return t.makeTensorInfo(u.shape,u.dtype,u.values)}const vee={kernelName:tx,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee={kernelName:V2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,{radians:a,fillValue:o,center:i}=e,c=t,u=vn(n.dtype,Ae(n.shape)),[h,p,f,g]=n.shape,[b,y]=Pv(i,p,f),v=255,w=Math.sin(a),N=Math.cos(a),C=c.data.get(n.dataId).values;for(let T=0;T<h;T++){const $=T*f*p*g;for(let E=0;E<p;E++){const _=E*(f*g);for(let L=0;L<f;L++){const O=L*g;for(let z=0;z<g;z++){const A=[h,E,L,z],U=A[2],X=A[1];let Z=(U-b)*N-(X-y)*w,q=(U-b)*w+(X-y)*N;Z=Math.round(Z+b),q=Math.round(q+y);let B=o;if(typeof o!="number"&&(z===3?B=v:B=o[z]),Z>=0&&Z<f&&q>=0&&q<p){const J=q*(f*g),Q=Z*g,ae=$+J+Q+z;B=C[ae]}const K=$+_+O+z;u[K]=B}}}}return{dataId:c.write(u,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=Qt(lp,s=>{const e=Math.floor(s);return s-e<.5?Math.floor(s):s-e>.5?Math.ceil(s):e%2===0?e:e+1}),See={kernelName:lp,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a,updates:o}=e,{shape:i}=n,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(o,a,i),g=!0,b=t.bufferSync(a),y=t.bufferSync(o),v=_l(b,y,i,f,h,u,c,p,0,g);return t.makeTensorInfo(i,v.dtype,v.values)}const kee={kernelName:j2,backendName:"cpu",kernelFunc:Cee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(s,e){let t=0,n=s.length,a=0;for(;t<n;)a=Math.floor((t+n)/2),s[a]<e?t=a+1:n=a;return n}function Tee(s,e){let t=0,n=s.length,a=0;for(;t<n;)a=Math.floor((t+n)/2),s[a]<=e?t=a+1:n=a;return n}function Iee(s,e,t,n,a,o){const i=Ds("int32",t*a);for(let c=0;c<t;++c){const u=s.slice(c*n,(c+1)*n),h=c*a;for(let p=0;p<a;++p)i[h+p]=o==="left"?jee(u,e[p+h]):Tee(u,e[p+h])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(s){const{inputs:e,backend:t,attrs:n}=s,{sortedSequence:a,values:o}=e,{side:i}=n,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,h=Iee(c,u,a.shape[0],a.shape[1],o.shape[1],i);return t.makeTensorInfo(o.shape,"int32",h)}const Aee={kernelName:I2,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eee(s){const{inputs:e,backend:t}=s,{condition:n,t:a,e:o}=e;rt([n,a,o],"select");const i=n.shape.length,c=t.data.get(n.dataId).values,u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=ya(a.dtype,o.dtype),f=An(Ae(a.shape),p);let g=0;const b=i===0||i>1||a.shape.length===1?1:Ae(a.shape.slice(1));for(let y=0;y<c.length;y++)for(let v=0;v<b;v++)c[y]===1?f[g++]=u[y]:f[g++]=h[y];return t.makeTensorInfo(a.shape,p,f)}const Dee={kernelName:sx,backendName:"cpu",kernelFunc:Eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ree=Lx,_ee=Mx,Oee=Qt(up,s=>s>=0?_ee*s:Ree*(Math.exp(s)-1)),Fee={kernelName:up,backendName:"cpu",kernelFunc:Oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lee=Qt(pp,s=>s<0?-1:s>0?1:0),Mee={kernelName:pp,backendName:"cpu",kernelFunc:Lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zee=Qt(dp,s=>Math.sin(s)),Pee={kernelName:dp,backendName:"cpu",kernelFunc:zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bee=Qt(hp,s=>Math.sinh(s)),Vee={kernelName:hp,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uee=11920928955078125e-23,GC=Math.log(Uee)+2,Gee=Qt(mp,s=>{const e=s>-GC,t=s<GC,n=Math.exp(s);let a;return t?a=n:e?a=s:a=Math.log(1+n),a}),Wee={kernelName:mp,backendName:"cpu",kernelFunc:Gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,paddings:i}=n;rt([a],"spaceToBatchND");const c=Ae(o),u=[[0,0]];u.push(...i);for(let E=1+o.length;E<a.shape.length;++E)u.push([0,0]);const h=ZE.kernelFunc({inputs:{x:a},backend:t,attrs:{paddings:u,constantValue:0}}),p=Ep(h.shape,o,c,!1),f=Dp(p.length,o.length,!1),g=Rp(h.shape,o,c,!1),v=hs({inputs:{x:h},backend:t,attrs:{shape:p}}),C=na({inputs:{x:v},backend:t,attrs:{perm:f}}),$=hs({inputs:{x:C},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(C),$}const qee={kernelName:rx,backendName:"cpu",kernelFunc:Hee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(s){const{inputs:e,backend:t}=s,{indices:n,values:a,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n        ".concat(o.shape));if(n.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n        ".concat(n.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(i.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const c=t.data.get(n.dataId).values,u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=t.data.get(i.dataId).values[0],[f,g,b,y,v]=SE(c,n.shape,n.dtype,u,a.dtype,h,p);return[t.makeTensorInfo(g,n.dtype,f),t.makeTensorInfo([g[0]],a.dtype,b),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(w=>Number(w)))),t.makeTensorInfo([v.length],n.dtype,new Int32Array(v))]}const Xee={kernelName:$2,backendName:"cpu",kernelFunc:Kee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(s){const{inputs:e,backend:t}=s,{inputIndices:n,inputShape:a,newShape:o}=e;if(n.shape.length!==2)throw new Error("Input indices should be a matrix but received shape\n        ".concat(n.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(o.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const i=Array.from(t.data.get(a.dataId).values),c=t.data.get(n.dataId).values,u=Array.from(t.data.get(o.dataId).values),[h,p,f]=CE(c,n.shape,n.dtype,i,u);return[t.makeTensorInfo(p,n.dtype,h),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const Zee={kernelName:A2,backendName:"cpu",kernelFunc:Yee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n          ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=Aw(i,n.shape,n.dtype,c,u,!0);return t.makeTensorInfo(p,n.dtype,h)}const Jee={kernelName:E2,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n         ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=Aw(i,n.shape,n.dtype,c,u);return t.makeTensorInfo(p,n.dtype,h)}const tte={kernelName:D2,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(s){const{inputs:e,backend:t,attrs:n}=s,{sparseIndices:a,sparseValues:o,defaultValue:i}=e,{outputShape:c}=n,{sliceRank:u,numUpdates:h,sliceSize:p,strides:f,outputSize:g}=nc(o,a,c),b=!1,y=t.bufferSync(a);let v;switch(o.dtype){case"bool":{const w=t.bufferSync(o),N=!!t.data.get(i.dataId).values[0];v=_l(y,w,c,g,p,h,u,f,N,b);break}case"float32":{const w=t.bufferSync(o),N=t.data.get(i.dataId).values[0];v=_l(y,w,c,g,p,h,u,f,N,b);break}case"int32":{const w=t.bufferSync(o),N=t.data.get(i.dataId).values[0];v=_l(y,w,c,g,p,h,u,f,N,b);break}case"string":{const w=t.bufferSync(o),N=Ri(t.data.get(i.dataId).values[0]);v=_l(y,w,c,g,p,h,u,f,N,b);break}default:throw new Error("Unsupported type ".concat(o.dtype))}return t.makeTensorInfo(c,v.dtype,v.values)}const nte={kernelName:R2,backendName:"cpu",kernelFunc:ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{numOrSizeSplits:o,axis:i}=n,c=At(i,a.shape)[0],u=tw(a,o,c),h=new Array(a.shape.length).fill(0),p=a.shape.slice();return u.map(f=>{const g=[...p];g[c]=f;const b=Ql({inputs:{x:a},backend:t,attrs:{begin:h,size:g}});return h[c]+=f,b})}const rte={kernelName:ox,backendName:"cpu",kernelFunc:ate};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ote={kernelName:_2,backendName:"cpu",kernelFunc:({inputs:s,backend:e})=>{const{x:t}=s,n=e;rt(t,"square");const a=n.data.get(t.dataId).values,o=new Float32Array(a.length);for(let c=0;c<a.length;++c){const u=a[c];o[c]=u*u}return{dataId:n.write(o,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ite=Qt(Np,(s,e)=>{const t=e;return isNaN(s)?NaN:s>0?1:t.alpha}),lte={kernelName:Np,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,end:i,strides:c,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:g}=n;rt(a,"stridedSlice");const{finalShapeSparse:b,finalShape:y,isIdentity:v,sliceDim0:w,isSimpleSlice:N,begin:C,end:I,strides:T}=Lv(a.shape,o,i,c,u,h,p,f,g);let $;if(v)$=hs({inputs:{x:a},backend:t,attrs:{shape:y}});else if(w||N){V(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const E=_v(C,I,T),_=Ql({inputs:{x:a},backend:t,attrs:{begin:C,size:E}});$=hs({inputs:{x:_},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(_)}else{const E=t.bufferSync(a),_=TE(b,E,T,C);$=t.makeTensorInfo(y,_.dtype,_.values)}return $}const ute={kernelName:O2,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(s){const{inputs:e,backend:t,attrs:n}=s,{separator:a,nGramWidths:o,leftPad:i,rightPad:c,padWidth:u,preserveShortSequences:h}=n,{data:p,dataSplits:f}=e,g=t.data.get(p.dataId).values,b=t.data.get(f.dataId).values,[y,v]=IE(g,b,a,o,i,c,u,h);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",v)]}const hte={kernelName:F2,backendName:"cpu",kernelFunc:dte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(s){const{inputs:e,backend:t,attrs:n}=s,{skipEmpty:a}=n,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(i.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const c=t.data.get(o.dataId).values,u=t.data.get(i.dataId).values[0],[h,p,f]=$E(c,u,a),g=p.length;return[t.makeTensorInfo([g,2],"int32",h),t.makeTensorInfo([g],"string",p),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const fte={kernelName:L2,backendName:"cpu",kernelFunc:pte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(s){const{inputs:e,backend:t,attrs:n}=s,{numBuckets:a}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(o.dataId).values,c=AE(i,a);return t.makeTensorInfo(o.shape,"int32",c)}const gte={kernelName:M2,backendName:"cpu",kernelFunc:mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=Qt(yp,s=>Math.tan(s)),bte={kernelName:yp,backendName:"cpu",kernelFunc:xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yte=Qt(vp,s=>Math.tanh(s)),vte={kernelName:vp,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(s){const{inputs:e,backend:t}=s,{tensor:n,indices:a,updates:o}=e,{sliceRank:i,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=nc(o,a,n.shape),f=!1,g=t.bufferSync(a),b=t.bufferSync(o),y=t.bufferSync(n),v=_l(g,b,n.shape,p,u,c,i,h,y,f);return t.makeTensorInfo(n.shape,v.dtype,v.values)}const Nte={kernelName:T2,backendName:"cpu",kernelFunc:wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reps:o}=n;rt(a,"tile");const i=DE(t.bufferSync(a),o);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Cte={kernelName:wp,backendName:"cpu",kernelFunc:Ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{k:o,sorted:i}=n;rt(a,"topk");const c=t.data.get(a.dataId).values,[u,h]=_E(c,a.shape,a.dtype,o,i);return[t.makeTensorInfo(u.shape,u.dtype,u.values),t.makeTensorInfo(h.shape,h.dtype,h.values)]}const jte={kernelName:z2,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(s){const{inputs:e,attrs:t,backend:n}=s,{image:a,transforms:o}=e,{interpolation:i,fillMode:c,fillValue:u,outputShape:h}=t,[p,f,g,b]=a.shape,[y,v]=h!=null?h:[f,g],w=[p,y,v,b],N=ut(a.shape),C=N[0],I=N[1],T=N[2],$=ut(w),E=$[0],_=$[1],L=$[2],O=vn(a.dtype,Ae(w));O.fill(u);const z=n.data.get(a.dataId).values,A=n.data.get(o.dataId).values;for(let X=0;X<p;++X){const Z=o.shape[0]===1?A:A.subarray(X*8,X*8+8);for(let q=0;q<y;++q)for(let B=0;B<v;++B)for(let K=0;K<b;++K){let J;const Q=Z[6]*B+Z[7]*q+1;if(Q===0)continue;const ae=(Z[0]*B+Z[1]*q+Z[2])/Q,we=(Z[3]*B+Z[4]*q+Z[5])/Q,Ce=WC(ae,g,c),ve=WC(we,f,c);switch(i){case"nearest":J=Rte(z,f,g,C,I,T,X,ve,Ce,K,u);break;case"bilinear":J=_te(z,f,g,C,I,T,X,ve,Ce,K,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(i))}const pe=X*E+q*_+B*L+K;O[pe]=J}return n.makeTensorInfo(w,a.dtype,O)}return{dataId:n.write(O,w,a.dtype),shape:a.shape,dtype:a.dtype}}const Ite={kernelName:P2,backendName:"cpu",kernelFunc:Tte};function WC(s,e,t){switch(t){case"reflect":return $te(s,e);case"wrap":return Ate(s,e);case"nearest":return Dte(s,e);case"constant":default:return Ete(s)}}function $te(s,e){let t=s;if(t<0)if(e<=1)t=0;else{const n=2*e;t<n&&(t=n*Math.trunc(-t/n)+t),t=t<-e?t+n:-t-1}else if(t>e-1)if(e<=1)t=0;else{const n=2*e;t-=n*Math.trunc(t/n),t>=e&&(t=n-t-1)}return zl(0,t,e-1)}function Ate(s,e){let t=s;if(t<0)if(e<=1)t=0;else{const n=e-1;t+=e*(Math.trunc(-t/n)+1)}else if(t>e-1)if(e<=1)t=0;else{const n=e-1;t-=e*Math.trunc(t/n)}return zl(0,t,e-1)}function Ete(s,e){return s}function Dte(s,e){return zl(0,s,e-1)}function lh(s,e,t,n,a,o,i,c,u,h,p){const f=i*n+c*a+u*o+h;return 0<=c&&c<e&&0<=u&&u<t?s[f]:p}function Rte(s,e,t,n,a,o,i,c,u,h,p){const f=Math.round(c),g=Math.round(u);return lh(s,e,t,n,a,o,i,f,g,h,p)}function _te(s,e,t,n,a,o,i,c,u,h,p){const f=Math.floor(c),g=Math.floor(u),b=f+1,y=g+1,v=(y-u)*lh(s,e,t,n,a,o,i,f,g,h,p)+(u-g)*lh(s,e,t,n,a,o,i,f,y,h,p),w=(y-u)*lh(s,e,t,n,a,o,i,b,g,h,p)+(u-g)*lh(s,e,t,n,a,o,i,b,y,h,p);return(b-c)*v+(c-f)*w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(s){const{inputs:e,attrs:t,backend:n}=s,{axis:a}=t,{x:o}=e;rt(o,"unique");const i=n.data.get(o.dataId).values,{outputValues:c,outputShape:u,indices:h}=OE(i,a,o.shape,o.dtype);return[n.makeTensorInfo(u,o.dtype,c),n.makeTensorInfo([h.length],"int32",h)]}const Fte={kernelName:B2,backendName:"cpu",kernelFunc:Ote};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(s){const{inputs:e,backend:t,attrs:n}=s,{value:a}=e;let{axis:o}=n;o<0&&(o+=a.shape.length);const i=a.shape.length,c=a.shape[o],u=new Array(i-1);let h=0;for(let b=0;b<i;b++)b!==o&&(u[h++]=a.shape[b]);const p=new Array(i).fill(0),f=a.shape.slice();f[o]=1;const g=new Array(c);for(let b=0;b<g.length;b++){p[o]=b;const y=Ql({inputs:{x:a},backend:t,attrs:{begin:p,size:f}});g[b]=hs({inputs:{x:y},backend:t,attrs:{shape:u}}),t.disposeIntermediateTensorInfo(y)}return g}const Mte={kernelName:cx,backendName:"cpu",kernelFunc:Lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,segmentIds:o}=e,{numSegments:i}=n;rt(a,"unsortedSegmentSum");const c=a.shape.length,u=o.shape.length,h=[],p=[],f=c-u;let g=o;for(let y=0;y<f;++y){const v=eg({inputs:{input:g},backend:t,attrs:{dim:y+1}});g=v,p.push(v)}for(let y=0;y<i;++y){const v=Wi(y,"int32"),w=t.makeTensorInfo([],"int32",v),N=YA({inputs:{a:w,b:g},backend:t}),C=Ui({inputs:{x:N},backend:t,attrs:{dtype:"float32"}}),I=Yx({inputs:{a:C,b:a},backend:t}),T=Vp({inputs:{x:I},backend:t,attrs:{axis:0,keepDims:!1}});h.push(T),p.push(w),p.push(N),p.push(C),p.push(I),p.push(T)}const b=YE({inputs:h,backend:t,attrs:{axis:0}});return p.forEach(y=>t.disposeIntermediateTensorInfo(y)),b}const Pte={kernelName:ux,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bte=[OY,mX,LY,zY,wX,BY,UY,WY,qY,XY,ZY,JY,tZ,aZ,oZ,cZ,dZ,pZ,mZ,RY,xZ,yZ,wZ,SX,SZ,yX,kX,kZ,gX,TZ,$Z,AZ,DZ,_Z,FZ,MZ,PZ,VZ,GZ,HZ,KZ,YZ,QZ,eQ,tQ,nQ,rQ,iQ,lQ,cQ,uQ,hQ,mQ,jY,xQ,jX,kQ,TX,jQ,$X,DQ,RQ,OQ,EX,RX,LQ,zQ,BQ,UQ,OX,LX,xX,WQ,IZ,qQ,XQ,ZQ,TY,zX,BX,JQ,UX,tJ,aJ,oJ,cJ,dJ,pJ,fJ,WX,gJ,bJ,vJ,NJ,CJ,jJ,IJ,qX,AJ,RJ,FJ,XX,ZX,zJ,VJ,WJ,JX,qJ,XJ,YJ,ZE,eee,$Y,sY,see,aee,oee,lee,bX,ky,uee,AY,EY,DY,hee,fee,gee,bee,vee,wee,See,uY,kee,Aee,Dee,Fee,hY,Mee,Pee,Vee,pY,_J,Wee,qee,Xee,Zee,Jee,tte,nte,rte,gY,ote,bY,vY,lte,ute,hte,fte,gte,CY,pQ,bte,vte,Nte,Cte,jte,Ite,eY,Fte,Mte,Pte,KJ];for(const s of Bte)Vk(s);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dl={},dm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Vte(s,e){Dl[s]=e}function $r(s,e){if(!(s in Dl)||e!=null){const n=Gte(s,e);if(n!==null)Dl[s]=n;else return console.log("Could not get context for WebGL version",s),null}const t=Dl[s];return t==null||t.isContextLost()?(delete Dl[s],$r(s)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Dl[s])}function Ute(s){if(!Se().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&s===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Gte(s,e){if(s!==1&&s!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e==null?Ute(s):e;return t.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete Dl[s]},!1),Se().getBool("SOFTWARE_WEBGL_ENABLED")&&(dm.failIfMajorPerformanceCaveat=!1),s===1?t.getContext("webgl",dm)||t.getContext("experimental-webgl",dm):t.getContext("webgl2",dm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Nh;(function(s){s[s.DENSE=0]="DENSE",s[s.SHARED_BATCH=1]="SHARED_BATCH"})(Nh||(Nh={}));var _a;(function(s){s[s.RENDER=0]="RENDER",s[s.UPLOAD=1]="UPLOAD",s[s.PIXELS=2]="PIXELS",s[s.DOWNLOAD=3]="DOWNLOAD"})(_a||(_a={}));var yn;(function(s){s[s.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",s[s.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",s[s.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",s[s.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",s[s.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(yn||(yn={}));function Up(s,e){return[e,s]}function Wte(s,e){return s*e}function hm(s){const e=Ae(s),t=Math.ceil(e/4);return R1(t)}function Pu(s,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(s/2))]}function Hte(s,e){const[t,n]=Pu(s,e);return t*n*4}function Ow(s,e){const t=s;let n,a,o,i,c,u,h,p,f,g;return Se().getNumber("WEBGL_VERSION")===2?(n=t.R32F,a=t.R16F,o=t.RGBA16F,i=t.RGBA32F,c=t.RED,h=4,p=1,f=t.HALF_FLOAT,g=t.FLOAT,u=t.RGBA8):(n=s.RGBA,a=s.RGBA,o=s.RGBA,i=t.RGBA,c=s.RGBA,h=4,p=4,f=e!=null?e.HALF_FLOAT_OES:null,g=s.FLOAT,u=s.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:c,downloadTextureFormat:u,downloadUnpackNumChannels:h,defaultNumChannels:p,textureTypeHalfFloat:f,textureTypeFloat:g}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ye(s,e){const t=e();return Se().getBool("DEBUG")&&qte(s),t}function qte(s){const e=s.getError();if(e!==s.NO_ERROR)throw new Error("WebGL Error: "+Zte(s,e))}const Kte=596e-10,Xte=65504;function Yte(s){return!!(Se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||s===0||Kte<Math.abs(s)&&Math.abs(s)<Xte)}function Zte(s,e){switch(e){case s.NO_ERROR:return"NO_ERROR";case s.INVALID_ENUM:return"INVALID_ENUM";case s.INVALID_VALUE:return"INVALID_VALUE";case s.INVALID_OPERATION:return"INVALID_OPERATION";case s.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case s.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case s.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}function pm(s,e){return qo(s,()=>s.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Qte(s,e){const t=qo(s,()=>s.createShader(s.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ye(s,()=>s.shaderSource(t,e)),Ye(s,()=>s.compileShader(t)),s.getShaderParameter(t,s.COMPILE_STATUS)===!1)throw console.log(s.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function Jte(s,e){const t=qo(s,()=>s.createShader(s.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ye(s,()=>s.shaderSource(t,e)),Ye(s,()=>s.compileShader(t)),Se().get("ENGINE_COMPILE_ONLY"))return t;if(s.getShaderParameter(t,s.COMPILE_STATUS)===!1)throw QE(e,s.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const ese=/ERROR: [0-9]+:([0-9]+):/g;function QE(s,e){const t=ese.exec(e);if(t==null){console.log("Couldn't parse line number in error: ".concat(e)),console.log(s);return}const n=+t[1],a=s.split("\n"),o=a.length.toString().length+2,i=a.map((f,g)=>uu((g+1).toString(),o)+f);let c=0;for(let f=0;f<i.length;f++)c=Math.max(i[f].length,c);const u=i.slice(0,n-1),h=i.slice(n-1,n),p=i.slice(n);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(uu(h[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join("\n"))}function tse(s){return qo(s,()=>s.createProgram(),"Unable to create WebGLProgram.")}function sse(s,e){if(Ye(s,()=>s.linkProgram(e)),!Se().get("ENGINE_COMPILE_ONLY")&&s.getProgramParameter(e,s.LINK_STATUS)===!1)throw console.log(s.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function j1(s,e){if(Ye(s,()=>s.validateProgram(e)),s.getProgramParameter(e,s.VALIDATE_STATUS)===!1)throw console.log(s.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function nse(s,e){const t=qo(s,()=>s.createBuffer(),"Unable to create WebGLBuffer");return Ye(s,()=>s.bindBuffer(s.ARRAY_BUFFER,t)),Ye(s,()=>s.bufferData(s.ARRAY_BUFFER,e,s.STATIC_DRAW)),t}function ase(s,e){const t=qo(s,()=>s.createBuffer(),"Unable to create WebGLBuffer");return Ye(s,()=>s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t)),Ye(s,()=>s.bufferData(s.ELEMENT_ARRAY_BUFFER,e,s.STATIC_DRAW)),t}function rse(s){return qo(s,()=>s.createTexture(),"Unable to create WebGLTexture.")}function ose(s,e){const t=Se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(s<=0||e<=0){const n="[".concat(s,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(s>t||e>t){const n="[".concat(s,"x").concat(e,"]"),a="[".concat(t,"x").concat(t,"]");throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+a+".")}}function ise(s){return qo(s,()=>s.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function HC(s,e,t,n,a,o,i){const c=s.getAttribLocation(e,t);return c===-1?!1:(Ye(s,()=>s.bindBuffer(s.ARRAY_BUFFER,n)),Ye(s,()=>s.vertexAttribPointer(c,a,s.FLOAT,!1,o,i)),Ye(s,()=>s.enableVertexAttribArray(c)),!0)}function lse(s,e,t){pse(s,t),Ye(s,()=>s.activeTexture(s.TEXTURE0+t)),Ye(s,()=>s.bindTexture(s.TEXTURE_2D,e))}function cse(s,e,t){return qo(s,()=>s.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function use(s,e,t){return s.getUniformLocation(e,t)}function dse(s,e,t,n){Ye(s,()=>lse(s,e,n)),Ye(s,()=>s.uniform1i(t,n))}function T1(s,e,t){Ye(s,()=>s.bindFramebuffer(s.FRAMEBUFFER,t)),Ye(s,()=>s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0))}function qC(s,e){Ye(s,()=>s.bindFramebuffer(s.FRAMEBUFFER,e)),Ye(s,()=>s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,null,0))}function fm(s){const e=s.checkFramebufferStatus(s.FRAMEBUFFER);if(e!==s.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+hse(s,e))}function hse(s,e){switch(e){case s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case s.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}function qo(s,e,t){const n=Ye(s,()=>e());if(n==null)throw new Error(t);return n}function pse(s,e){const t=s.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+s.TEXTURE0;if(n<s.TEXTURE0||n>t){const a="[gl.TEXTURE0, gl.TEXTURE".concat(t,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function Tu(s,e=2){return Ae(s.slice(0,s.length-e))}function Iu(s){if(s.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[s.length>1?s[s.length-2]:1,s[s.length-1]]}function mm(s){let e=[1,1,1];return s.length===0||s.length===1&&s[0]===1||(e=[Tu(s),...Iu(s)]),e}function fse(s,e=!1){let t=Se().getNumber("WEBGL_MAX_TEXTURE_SIZE"),n=Se().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");n===1/0&&Se().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(n=t/2),e&&(t=t*2,n=n*2,s=s.map((c,u)=>u>=s.length-2?Fy(s[u]):s[u]),s.length===1&&(s=[2,s[0]])),s.length!==2&&(s=Gi(s).newShape);let a=Ae(s),o=null;s.length<=1&&a<=t?o=[1,a]:s.length===2&&s[0]<=t&&s[1]<=t?o=s:s.length===3&&s[0]*s[1]<=t&&s[2]<=t?o=[s[0]*s[1],s[2]]:s.length===3&&s[0]<=t&&s[1]*s[2]<=t?o=[s[0],s[1]*s[2]]:s.length===4&&s[0]*s[1]*s[2]<=t&&s[3]<=t?o=[s[0]*s[1]*s[2],s[3]]:s.length===4&&s[0]<=t&&s[1]*s[2]*s[3]<=t&&(o=[s[0],s[1]*s[2]*s[3]]);const i=o!=null&&Math.max(...o)>n&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const c=Tu(s);let u=2,h=2;s.length&&([u,h]=Iu(s)),a=c*(u/2)*(h/2),o=R1(a).map(p=>p*2)}else o=R1(a);return o}function gm(s){return s%2===0}function sg(s,e){if(s=s.slice(-2),e=e.slice(-2),Mt(s,e)||!s.length||!e.length||s[0]===0||s[1]===0||e[0]===0||e[1]===0)return!0;if(s.length!==e.length){const t=s[s.length-1],n=e[e.length-1];if(t===n||gm(t)&&gm(n)&&(s[0]===1||e[0]===1))return!0}return s[1]===e[1]&&gm(s[0])&&gm(e[0])}let I1,$1;function mse(s){if(I1==null){const e=$r(s);I1=e.getParameter(e.MAX_TEXTURE_SIZE)}return I1}function gse(s){if($1==null){const e=$r(s);$1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$1)}function xse(s){if(s===0)return 0;let e;const t=$r(s);return rr(t,"EXT_disjoint_timer_query_webgl2")&&s===2?e=2:rr(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function rr(s,e){return s.getExtension(e)!=null}function KC(s){try{if($r(s)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function bse(s){if(s===0)return!1;const e=$r(s);if(s===1){if(!rr(e,"OES_texture_float"))return!1}else if(!rr(e,"EXT_color_buffer_float"))return!1;return Ty(e)}function yse(s){if(s===0)return!1;const e=$r(s);if(s===1){if(!rr(e,"OES_texture_float")||!rr(e,"WEBGL_color_buffer_float"))return!1}else{if(rr(e,"EXT_color_buffer_float"))return Ty(e);const n="EXT_color_buffer_half_float";if(rr(e,n)){const a=e.getExtension(n);return vse(e,a)}return!1}return Ty(e)}function Ty(s){const e=Ow(s),t=s.createTexture();s.bindTexture(s.TEXTURE_2D,t),s.texImage2D(s.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,o),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0);const i=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;return s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteTexture(t),s.deleteFramebuffer(o),i}function vse(s,e){const t=Ow(s,e),n=s.createTexture();s.bindTexture(s.TEXTURE_2D,n),s.texImage2D(s.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,i),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0);const c=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;return s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteTexture(n),s.deleteFramebuffer(i),c}function wse(s){return s!==2?!1:$r(s).fenceSync!=null}function Gp(s,e){Array.isArray(s)||(s=[s]),s.forEach(t=>{t!=null&&V(t.dtype!=="complex64",()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend.")})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lt=Se();lt.registerFlag("HAS_WEBGL",()=>lt.getNumber("WEBGL_VERSION")>0);lt.registerFlag("WEBGL_VERSION",()=>KC(2)?2:KC(1)?1:0);lt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);lt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>lt.get("WEBGL_VERSION")===2);lt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);lt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);lt.registerFlag("WEBGL_PACK",()=>lt.getBool("HAS_WEBGL"));lt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_CLIP",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_REDUCE",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_LAZILY_UNPACK",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_CONV_IM2COL",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>lt.getBool("WEBGL_PACK"));lt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>mse(lt.getNumber("WEBGL_VERSION")));lt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>gse(lt.getNumber("WEBGL_VERSION")));lt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const s=lt.getNumber("WEBGL_VERSION");return s===0?0:xse(s)});lt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>lt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!tj());lt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>bse(lt.getNumber("WEBGL_VERSION")));lt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>lt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:lt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));lt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>yse(lt.getNumber("WEBGL_VERSION")));lt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>wse(lt.getNumber("WEBGL_VERSION")));lt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>lt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);lt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,s=>{if(typeof s!="number")throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(s,"."));if(s<0&&s!==-1)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(s,"."))});lt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>tj()?1:-1,s=>{if(typeof s!="number")throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(s,"."));if(s<0&&s!==-1)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(s,"."))});lt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);lt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);lt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);lt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);lt.registerFlag("WEBGL_EXP_CONV",()=>!1);lt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>lt.getBool("IS_TEST"));lt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);lt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);lt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);lt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wn(){let s,e,t,n,a,o,i,c,u,h;return Se().getNumber("WEBGL_VERSION")===2?(s="#version 300 es",e="in",t="out",n="in",a="texture",o="outputColor",i="out vec4 outputColor;",c=Se().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",h="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(s="",e="attribute",t="varying",n="varying",a="texture2D",o="gl_FragColor",i="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",h="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:s,attribute:e,varyingVs:t,varyingFs:n,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:c,defineSpecialInf:u,defineRound:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oc(s,e,t="index"){const n=ut(e);return n.map((a,o)=>{const i="int ".concat(s[o]," = ").concat(t," / ").concat(a),c=o===n.length-1?"int ".concat(s[o+1]," = ").concat(t," - ").concat(s[o]," * ").concat(a):"index -= ".concat(s[o]," * ").concat(a);return"".concat(i,"; ").concat(c,";")}).join("")}function Zx(s,e,t="index"){const n=ut(e);return n.map((a,o)=>{const i="int ".concat(s[o]," = ").concat(t," / outShapeStrides[").concat(o,"]"),c=o===n.length-1?"int ".concat(s[o+1]," = ").concat(t," - ").concat(s[o]," * outShapeStrides[").concat(o,"]"):"index -= ".concat(s[o]," * outShapeStrides[").concat(o,"]");return"".concat(i,"; ").concat(c,";")}).join("")}function Nse(s,e){const t=s.length,n=s.map(o=>"".concat(e,"[").concat(o,"]")),a=new Array(t-1);a[t-2]=n[t-1];for(let o=t-3;o>=0;--o)a[o]="(".concat(a[o+1]," * ").concat(n[o+1],")");return a}function Sse(s,e,t="index"){const n=s.map((o,i)=>i),a=Nse(n,e);return a.map((o,i)=>{const c="int ".concat(s[i]," = ").concat(t," / ").concat(a[i]),u=i===a.length-1?"int ".concat(s[i+1]," = ").concat(t," - ").concat(s[i]," * ").concat(a[i]):"index -= ".concat(s[i]," * ").concat(a[i]);return"".concat(c,"; ").concat(u,";")}).join("")}function Fw(s){const e=ut(s).map(t=>t.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}function Lw(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}const JE="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:eD}=yU;function Cse(s,e,t){const n=[];if(s.forEach(b=>{const y=Ae(b.shapeInfo.logicalShape);if(b.shapeInfo.isUniform?n.push("uniform float ".concat(b.name).concat(y>1?"[".concat(y,"]"):"",";")):(n.push("uniform sampler2D ".concat(b.name,";")),n.push("uniform int offset".concat(b.name,";"))),t.enableShapeUniforms){const{uniformShape:v}=Mw(t.packedInputs,b.shapeInfo.logicalShape,b.shapeInfo.texShape);switch(v.length){case 1:n.push("uniform int ".concat(b.name,"Shape;"));break;case 2:n.push("uniform ivec2 ".concat(b.name,"Shape;"));break;case 3:n.push("uniform ivec3 ".concat(b.name,"Shape;"));break;case 4:n.push("uniform ivec4 ".concat(b.name,"Shape;"));break}n.push("uniform ivec2 ".concat(b.name,"TexShape;"))}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;");break}n.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(b=>{n.push("uniform ".concat(b.type," ").concat(b.name).concat(b.arrayIndex?"[".concat(b.arrayIndex,"]"):"",";"))});const a=n.join("\n"),o=s.map(b=>kse(b,e,t.packedInputs,t.enableShapeUniforms)).join("\n"),i=e.texShape,c=Wn(),u=Ise(c);let h,p,f=Ese(c);return e.isPacked?(h=jse(e.logicalShape,i,t.enableShapeUniforms),p=Ase(c)):(h=Tse(e.logicalShape,i,t.enableShapeUniforms),p=$se(c)),t.packedInputs&&(f+=Ose),[f,u,p,a,h,o,t.userCode].join("\n")}function Bu(s,e=!1){const t=s.shapeInfo.logicalShape;switch(t.length){case 0:return qse(s,e);case 1:return Xse(s,e);case 2:return Zse(s,e);case 3:return Jse(s,e);case 4:return tne(s,e);case 5:return sne(s);case 6:return nne(s);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function tD(s,e){switch(s.shapeInfo.logicalShape.length){case 0:return Hse(s);case 1:return Kse(s,e);case 2:return Yse(s,e);case 3:return Qse(s,e);default:return ene(s,e)}}function kse(s,e,t=!1,n){let a="";t?a+=tD(s,n):a+=Bu(s,n);const o=s.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(t?a+=ane(s,e):a+=rne(s,e)),a}function jse(s,e,t){switch(s.length){case 0:return sD();case 1:return Fse(s,e,t);case 2:return Gse(s,e,t);case 3:return Mse(s,e,t);default:return Pse(s,e,t)}}function Tse(s,e,t){switch(s.length){case 0:return sD();case 1:return Lse(s,e,t);case 2:return Wse(s,e,t);case 3:return zse(s,e,t);case 4:return Bse(s,e,t);case 5:return Vse(s,e);case 6:return Use(s,e);default:throw new Error("".concat(s.length,"-D output sampling is not yet supported"))}}function Ise(s){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(s.texture2D,"(textureSampler, uv).r;\n    }\n  ")}function $se(s){return"\n    void setOutput(float val) {\n      ".concat(s.output," = vec4(val, 0, 0, 0);\n    }\n  ")}function Ase(s){return"\n    void setOutput(vec4 val) {\n      ".concat(s.output," = val;\n    }\n  ")}function Ese(s){return"".concat(s.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(s.varyingFs," vec2 resultUV;\n    ").concat(s.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(s.defineSpecialNaN,"\n    ").concat(s.defineSpecialInf,"\n    ").concat(s.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Dse,"\n    ").concat(Rse,"\n    ").concat(_se,"\n  ")}const Dse="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Rse="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_se="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ose="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function sD(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function Fse(s,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return n[0]===1?t?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):n[1]===1?t?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):t?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}function Lse(s,e,t){return e[0]===1?t?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    "):e[1]===1?t?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    "):t?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}function Mse(s,e,t){if(t)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(s[2]/2),o=a*Math.ceil(s[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}function zse(s,e,t){if(t){const a=Zx(["r","c","d"],s);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(a,"\n    return ivec3(r, c, d);\n  }\n")}const n=oc(["r","c","d"],s);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}function Pse(s,e,t){if(t)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(s[s.length-1]/2),o=a*Math.ceil(s[s.length-2]/2);let i=o,c="",u="b, r, c";for(let h=2;h<s.length-1;h++)i*=s[s.length-h-1],c="\n      int b".concat(h," = index / ").concat(i,";\n      index -= b").concat(h," * ").concat(i,";\n    ")+c,u="b".concat(h,", ")+u;return"\n    ivec".concat(s.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(c,"\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(s.length,"(").concat(u,");\n    }\n  ")}function Bse(s,e,t){if(t){const a=Zx(["r","c","d","d2"],s);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const n=oc(["r","c","d","d2"],s);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}function Vse(s,e){const t=oc(["r","c","d","d2","d3"],s);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(t,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}function Use(s,e){const t=oc(["r","c","d","d2","d3","d4"],s);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(t,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}function Gse(s,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Mt(s,e))return t?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");const a=Math.ceil(s[1]/2);return t?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}function Wse(s,e,t){return Mt(s,e)?t?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    "):s[1]===1?t?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):s[0]===1?t?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):t?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(s[1],";\n      int c = index - r * ").concat(s[1],";\n      return ivec2(r, c);\n    }\n  ")}function ic(s){return"offset".concat(s)}function Hse(s){const e=s.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),n=Wn();return"\n    vec4 ".concat(t,"() {\n      return ").concat(n.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}function qse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(s.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");const[a,o]=s.shapeInfo.texShape;if(a===1&&o===1)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");const i=ic(t);if(e)return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(t,"TexShape[0], ").concat(t,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ");const[c,u]=s.shapeInfo.texShape;return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", ").concat(i,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Kse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=s.shapeInfo.texShape,o=Wn();if(e)return"\n    vec4 ".concat(n,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(t,"TexShape[0]) / 2.0), ceil(float(").concat(t,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }\n  ");const i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }\n  ")}function Xse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(Vu(s),"\n      }\n    ");const a=s.shapeInfo.texShape,o=a[0],i=a[1];if(i===1&&o===1)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");const c=ic(t);return i===1?e?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / float(").concat(t,"TexShape[0]));\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / ").concat(o,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):o===1?e?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / float(").concat(t,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):e?"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(t,"TexShape[0], ").concat(t,"TexShape[1], index + ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(i,", index + ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Yse(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape,i=o[0],c=o[1],u=Wn();if(o!=null&&Mt(t,o))return e?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ");const h=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],p=Math.ceil(t[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(p,", ").concat(h[0],", ").concat(h[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}function Zse(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape;if(o!=null&&Mt(t,o)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const g=o[0],b=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(b,".0, ").concat(g,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}const{newShape:i,keptDims:c}=Gi(t),u=i;if(u.length<t.length){const g=Uu(s,u),b=["row","col"];return"\n      ".concat(Bu(g,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Gu(b,c),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const h=o[0],p=o[1],f=ic(n);return p===1?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):h===1?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(p,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):e?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(n,"Shape[1] + col + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(f,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}function Qse(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const g=t.slice(1),b=[1,2],y=Uu(s,g),v=["b","row","col"];return"\n        ".concat(tD(y,e),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Gu(v,b),");\n        }\n      ")}const c=Wn();if(e)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ");const u=i[0],h=i[1],p=Math.ceil(t[2]/2),f=p*Math.ceil(t[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(h,", ").concat(f,", ").concat(p,", b, row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ")}function Jse(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],i=t[2],{newShape:c,keptDims:u}=Gi(t),h=c;if(h.length<t.length){const v=Uu(s,h),w=["row","col","depth"];return"\n        ".concat(Bu(v,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Gu(w,u),");\n        }\n      ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(i,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.texShape,f=p[0],g=p[1],b=s.shapeInfo.flatOffset;if(g===o&&b==null)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(n,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(g,".0, ").concat(f,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(g===i&&b==null)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(n,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(g,".0, ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const y=ic(n);return e?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(n,"Shape[1] * ").concat(n,"Shape[2];\n      int stride1 = ").concat(n,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index);\n      return sampleTexture(").concat(n,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(i," + depth + ").concat(y,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(g,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}function ene(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=Wn();if(e)return"\n    vec4 ".concat(n,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(t,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(t,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(t,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(t,"TexShape[0]) / 2.0), ceil(float(").concat(t,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(t,", uv);\n    }\n  ");const o=s.shapeInfo.logicalShape,i=o.length,c=s.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],h=u[0],p=u[1],f=Math.ceil(o[i-1]/2);let g=f*Math.ceil(o[i-2]/2),b="int b, int row, int col",y="b * ".concat(g," + (row / 2) * ").concat(f," + (col / 2)");for(let v=2;v<i-1;v++)b="int b".concat(v,", ")+b,g*=o[i-v-1],y="b".concat(v," * ").concat(g," + ")+y;return"\n    vec4 ".concat(n,"(").concat(b,") {\n      int index = ").concat(y,";\n      int texR = index / ").concat(p,";\n      int texC = index - texR * ").concat(p,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,", ").concat(h,");\n      return ").concat(a.texture2D,"(").concat(t,", uv);\n    }\n  ")}function tne(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],i=t[2]*o,c=t[1]*i,{newShape:u,keptDims:h}=Gi(t);if(u.length<t.length){const C=Uu(s,u),I=["row","col","depth","depth2"];return"\n      ".concat(Bu(C,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Gu(I,h),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(c,", ").concat(i,", ").concat(o,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.flatOffset,f=s.shapeInfo.texShape,g=f[0],b=f[1],y="int stride2 = ".concat(n,"Shape[3];"),v="int stride1 = ".concat(n,"Shape[2] * stride2;"),w="int stride0 = ".concat(n,"Shape[1] * stride1;");if(b===c&&p==null)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(y,"\n        ").concat(v,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(b===o&&p==null)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n,"Shape[1] * ").concat(n,"Shape[2], ").concat(n,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const N=ic(n);return e?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(y,"\n      ").concat(v,"\n      ").concat(w,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(N,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(b,", index + ").concat(N,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function sne(s){const e=s.shapeInfo.logicalShape,t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=e[4],o=e[3]*a,i=e[2]*o,c=e[1]*i,{newShape:u,keptDims:h}=Gi(e);if(u.length<e.length){const v=Uu(s,u),w=["row","col","depth","depth2","depth3"];return"\n      ".concat(Bu(v),"\n      float ").concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(n,"(").concat(Gu(w,h),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(i,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.flatOffset,f=s.shapeInfo.texShape,g=f[0],b=f[1];if(b===c&&p==null)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(b===a&&p==null)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");const y=ic(t);return"\n    float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(b,", index);\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function nne(s){const e=s.shapeInfo.logicalShape,t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:a,keptDims:o}=Gi(e);if(a.length<e.length){const w=Uu(s,a),N=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Bu(w),"\n      float ").concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(n,"(").concat(Gu(N,o),");\n      }\n    ")}const i=e[5],c=e[4]*i,u=e[3]*c,h=e[2]*u,p=e[1]*h;if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(h,", ").concat(u,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const f=s.shapeInfo.flatOffset,g=s.shapeInfo.texShape,b=g[0],y=g[1];if(y===p&&f==null)return"\n      float ".concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(u,", ").concat(c,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(y,".0, ").concat(b,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(y===i&&f==null)return"\n      float ".concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(y,".0, ").concat(b,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");const v=ic(t);return"\n    float ".concat(n,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(h," + depth * ").concat(u," +\n          depth2 * ").concat(c," + depth3 * ").concat(i," + depth4 + ").concat(v,";\n      vec2 uv = uvFromFlat(").concat(b,", ").concat(y,", index);\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Vu(s){const e=s.name,t=Ae(s.shapeInfo.logicalShape);return t<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(t,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function ane(s,e){const t=s.name,n=t.charAt(0).toUpperCase()+t.slice(1),a="get"+n+"AtOutCoords",o=s.shapeInfo.logicalShape.length,i=e.logicalShape.length,c=eD(s.shapeInfo.logicalShape,e.logicalShape),u=ss(i),h=i-o;let p;const f=["x","y","z","w","u","v"];o===0?p="":i<2&&c.length>=1?p="coords = 0;":p=c.map(C=>"coords.".concat(f[C+h]," = 0;")).join("\n");let g="";i<2&&o>0?g="coords":g=s.shapeInfo.logicalShape.map((C,I)=>"coords.".concat(f[I+h])).join(", ");let b="return outputValue;";const v=Ae(s.shapeInfo.logicalShape)===1,N=Ae(e.logicalShape)===1;if(o===1&&!v&&!N)b="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";else if(v&&!N)i===1?b="\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":b="\n        return vec4(outputValue.x);\n      ";else if(c.length){const C=o-2,I=o-1;c.indexOf(C)>-1&&c.indexOf(I)>-1?b="return vec4(outputValue.x);":c.indexOf(C)>-1?b="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(I)>-1&&(b="return vec4(outputValue.xx, outputValue.zz);")}return"\n    vec4 ".concat(a,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(p,"\n      vec4 outputValue = get").concat(n,"(").concat(g,");\n      ").concat(b,"\n    }\n  ")}function rne(s,e){const t=s.name,n=t.charAt(0).toUpperCase()+t.slice(1),a="get"+n+"AtOutCoords",o=e.texShape,i=s.shapeInfo.texShape,c=s.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!s.shapeInfo.isUniform&&c===u&&s.shapeInfo.flatOffset==null&&Mt(i,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(t,", resultUV);\n      }\n    ");const h=ss(u),p=eD(s.shapeInfo.logicalShape,e.logicalShape),f=u-c;let g;const b=["x","y","z","w","u","v"];c===0?g="":u<2&&p.length>=1?g="coords = 0;":g=p.map(v=>"coords.".concat(b[v+f]," = 0;")).join("\n");let y="";return u<2&&c>0?y="coords":y=s.shapeInfo.logicalShape.map((v,w)=>"coords.".concat(b[w+f])).join(", "),"\n    float ".concat(a,"() {\n      ").concat(h," coords = getOutputCoords();\n      ").concat(g,"\n      return get").concat(n,"(").concat(y,");\n    }\n  ")}function ss(s){if(s<=1)return"int";if(s===2)return"ivec2";if(s===3)return"ivec3";if(s===4)return"ivec4";if(s===5)return"ivec5";if(s===6)return"ivec6";throw Error("GPU for rank ".concat(s," is not yet supported"))}function Mw(s,e,t){const{newShape:n,keptDims:a}=Gi(e),o=e.length,i=s&&o===3&&e[0]===1,c=i?e.slice(1):n,u=!s&&o>1&&!Mt(e,t)&&n.length<o||i;return{useSqueezeShape:u,uniformShape:u?c:e,keptDims:a}}function Uu(s,e){const t=JSON.parse(JSON.stringify(s));return t.shapeInfo.logicalShape=e,t}function Gu(s,e){return e.map(t=>s[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(s,e,t,n){const a=t.map((p,f)=>{const g={logicalShape:p.shape,texShape:p.isUniform?null:p.texData.texShape,isUniform:p.isUniform,isPacked:p.isUniform?!1:p.texData.isPacked,flatOffset:null};return p.texData!=null&&p.texData.slice!=null&&p.texData.slice.flatOffset>0&&(g.flatOffset=p.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:g}}),o=a.map(p=>p.shapeInfo),i={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},c=Cse(a,i,e),u=Jte(s.gl,c),h=s.createProgram(u);return Se().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:c,webGLProgram:h,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(s.buildVao(h),Object.assign({program:e,fragmentShader:u,source:c,webGLProgram:h,inShapeInfos:o,outShapeInfo:i},nD(s,e,h)))}function nD(s,e,t){const n=[],a=[];let o,i,c,u=null,h=null;h=s.getUniformLocation(t,"NAN",!1),Se().getNumber("WEBGL_VERSION")===1&&(u=s.getUniformLocation(t,"INFINITY",!1));const p=!1;for(const f of e.variableNames){const g={name:f,uniform:s.getUniformLocation(t,f,p),offset:s.getUniformLocation(t,"offset".concat(f),p)};e.enableShapeUniforms&&(g.shape=s.getUniformLocation(t,"".concat(f,"Shape"),p),g.texShape=s.getUniformLocation(t,"".concat(f,"TexShape"),p)),n.push(g)}if(e.enableShapeUniforms&&(o=s.getUniformLocation(t,"outShape",p),c=s.getUniformLocation(t,"outShapeStrides",p),i=s.getUniformLocation(t,"outTexShape",p)),e.customUniforms)for(const f of e.customUniforms)a.push(s.getUniformLocation(t,f.name,p));return{variablesLocations:n,customUniformLocations:a,infLoc:u,nanLoc:h,outShapeLocation:o,outShapeStridesLocation:c,outTexShapeLocation:i}}function XC(s,e){if(s.length!==e.length)throw Error("Binary was compiled with ".concat(s.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));s.forEach((t,n)=>{const a=t.logicalShape,o=e[n],i=o.shape;if(!Mt(a,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(a," and ").concat(i," must match"));if(t.isUniform&&o.isUniform)return;const c=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!Mt(c,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(c," and ").concat(u," must match"))})}function ine(s,e,t,n,a){e.program.enableShapeUniforms||(XC(e.inShapeInfos,t),XC([e.outShapeInfo],[n]));const o=n.texData.texture,i=n.texData.texShape;n.texData.isPacked?s.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):s.setOutputMatrixTexture(o.texture,i[0],i[1]),s.setProgram(e.webGLProgram),s.bindVertexArray(e.webGLProgram.vao),Se().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&s.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&s.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<t.length;++u){const h=t[u],{uniform:p,offset:f,shape:g,texShape:b}=e.variablesLocations[u];if(g){const{uniformShape:y}=Mw(e.program.packedInputs,h.shape,h.texData.texShape);switch(y.length){case 1:s.gl.uniform1iv(g,new Int32Array(y));break;case 2:s.gl.uniform2iv(g,new Int32Array(y));break;case 3:s.gl.uniform3iv(g,new Int32Array(y));break;case 4:s.gl.uniform4iv(g,new Int32Array(y));break}}if(b&&s.gl.uniform2i(b,h.texData.texShape[0],h.texData.texShape[1]),p!=null){if(h.isUniform){if(Ae(h.shape)<2)s.gl.uniform1f(p,h.uniformValues[0]);else{let y=h.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),s.gl.uniform1fv(p,y)}continue}h.texData.slice!=null&&f!=null&&s.gl.uniform1i(f,h.texData.slice.flatOffset),s.setInputMatrixTexture(h.texData.texture.texture,p,u)}}const c=e.outShapeLocation;if(c)switch(n.shape.length){case 1:s.gl.uniform1iv(c,new Int32Array(n.shape));break;case 2:s.gl.uniform2iv(c,new Int32Array(n.shape));break;case 3:s.gl.uniform3iv(c,new Int32Array(n.shape));break;case 4:s.gl.uniform4iv(c,new Int32Array(n.shape));break}if(e.outShapeStridesLocation){const u=ut(n.shape);switch(n.shape.length){case 2:s.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:s.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:s.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}if(e.outTexShapeLocation&&s.gl.uniform2i(e.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),e.program.customUniforms&&a)for(let u=0;u<e.program.customUniforms.length;++u){const h=e.program.customUniforms[u],p=e.customUniformLocations[u],f=a[u];if(h.type==="float")s.gl.uniform1fv(p,f);else if(h.type==="vec2")s.gl.uniform2fv(p,f);else if(h.type==="vec3")s.gl.uniform3fv(p,f);else if(h.type==="vec4")s.gl.uniform4fv(p,f);else if(h.type==="int")s.gl.uniform1iv(p,f);else if(h.type==="ivec2")s.gl.uniform2iv(p,f);else if(h.type==="ivec3")s.gl.uniform3iv(p,f);else if(h.type==="ivec4")s.gl.uniform4iv(p,f);else throw Error("uniform type ".concat(h.type," is not supported yet."))}s.executeProgram()}function lne(s,e,t){let n="";e.concat(t).forEach(i=>{const c=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(s.enableShapeUniforms&&!i.isUniform){const u=i.texData.texShape,{useSqueezeShape:h,uniformShape:p,keptDims:f}=Mw(s.packedInputs,i.shape,u);let g="",b="",y="";if(p.length===1&&s.packedInputs){const $=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];g="".concat($[0]>1,"_").concat($[1]>1)}else if(p.length===2&&!s.packedInputs)b="".concat(p[0]>1,"_").concat(p[1]>1);else if(p.length>2&&!s.packedInputs){const $=ut(p);y="".concat($[0]===u[1],"_").concat($[$.length-1]===u[1])}const v=i.shape.length,w=p.length===2&&Mt(i.shape,u),N=Ae(i.shape)===1,C=vu(i.shape,t.shape),I=!s.packedInputs&&v===t.shape.length&&Mt(u,t.texData.texShape),T=s.packedInputs||p.length>2?"":"".concat(u[0]>1,"_").concat(u[1]>1);n+="".concat(v,"_").concat(I,"_").concat(h?f:"","_").concat(p.length,"_").concat(N,"_").concat(C,"_").concat(w,"_").concat(g,"_").concat(b,"_").concat(y,"_").concat(T,"_").concat(c)}else{const u=i.isUniform?"uniform":i.texData.texShape;n+="".concat(i.shape,"_").concat(u,"_").concat(c)}});const a=s.userCode;let o=s.constructor.name;return o+="_"+n+"_"+a+"".concat(Se().getNumber("WEBGL_VERSION")),o}function Dn(s){return Se().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&s<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cne{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Nh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Wn();this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Zx(["r","c","d"],e):oc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class une{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Nh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Wn();this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Zx(["r","c","d"],e):oc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dne{constructor(e){this.variableNames=["A"],this.outTexUsage=_a.DOWNLOAD;const t=Wn();this.outputShape=e,this.userCode="\n      ".concat(JE,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=_a.DOWNLOAD;const t=Wn();this.outputShape=e,this.userCode="\n      ".concat(JE,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pne={R:0,G:1,B:2,A:3};class YC{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=Wn();this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length);let o="result";t&&(o="floor(result * 255. + 0.5)");let i="";for(let c=0;c<n.length;c++){const u=n[c];i+="\n          if(offset == ".concat(c,") {\n            result = values[").concat(pne[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?Lw():Fw(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(a.output," = vec4(").concat(o,", 0., 0., 0.);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fne{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Wn();this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length);let a="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let c=0;c<=1;c++){const u=i*2+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(c," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(c,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?Lw():Fw(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(o,";\n        }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(s){const e=Wn(),t="".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }");return Qte(s,t)}function gne(s){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return nse(s,e)}function xne(s){const e=new Uint16Array([0,1,2,2,1,3]);return ase(s,e)}function Wp(s,e,t,n,a,o){ose(e,t);const i=rse(s),c=s.TEXTURE_2D;return Ye(s,()=>s.bindTexture(c,i)),Ye(s,()=>s.texParameteri(c,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE)),Ye(s,()=>s.texParameteri(c,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE)),Ye(s,()=>s.texParameteri(c,s.TEXTURE_MIN_FILTER,s.NEAREST)),Ye(s,()=>s.texParameteri(c,s.TEXTURE_MAG_FILTER,s.NEAREST)),Se().getNumber("WEBGL_VERSION")===1?Ye(s,()=>s.texImage2D(c,0,n,e,t,0,a,o,null)):Ye(s,()=>s.texStorage2D(c,1,n,e,t)),Ye(s,()=>s.bindTexture(s.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function aD(s){return s.internalFormatFloat}function bne(s,e,t,n){const[a,o]=Up(e,t);return Wp(s,a,o,aD(n),n.textureFormatFloat,s.FLOAT)}function rD(s){return s.internalFormatHalfFloat}function yne(s,e,t,n){const[a,o]=Up(e,t);return Wp(s,a,o,rD(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function oD(s){return s.downloadTextureFormat}function vne(s,e,t,n){const[a,o]=Up(e,t);return Wp(s,a,o,oD(n),s.RGBA,s.UNSIGNED_BYTE)}function iD(s){return s.internalFormatPackedFloat}function wne(s,e,t,n){const[a,o]=Pu(e,t);return Wp(s,a,o,iD(n),s.RGBA,s.FLOAT)}function lD(s){return s.internalFormatPackedHalfFloat}function Nne(s,e,t,n){const[a,o]=Pu(e,t);return Wp(s,a,o,lD(n),s.RGBA,n.textureTypeHalfFloat)}function Sne(s,e,t){return Ye(s,()=>s.bindBuffer(s.ARRAY_BUFFER,t)),HC(s,e,"clipSpacePos",t,3,20,0)&&HC(s,e,"uv",t,2,20,12)}function Cne(s,e,t,n,a,o){Ye(s,()=>s.bindTexture(s.TEXTURE_2D,e));let i,c,u;a instanceof Uint8Array?(i=new Uint8Array(t*n*4),c=s.UNSIGNED_BYTE,u=s.RGBA):(i=new Float32Array(t*n*4),c=s.FLOAT,u=o.internalFormatPackedFloat),i.set(a),Se().getNumber("WEBGL_VERSION")===2?Ye(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,t,n,s.RGBA,c,i)):Ye(s,()=>s.texImage2D(s.TEXTURE_2D,0,u,t,n,0,s.RGBA,c,i)),Ye(s,()=>s.bindTexture(s.TEXTURE_2D,null))}function kne(s,e,t){Ye(s,()=>s.bindTexture(s.TEXTURE_2D,e)),t.data instanceof Uint8Array?Se().getNumber("WEBGL_VERSION")===2?Ye(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.width,t.height,s.RGBA,s.UNSIGNED_BYTE,t.data)):Ye(s,()=>s.texImage2D(s.TEXTURE_2D,0,s.RGBA,t.width,t.height,0,s.RGBA,s.UNSIGNED_BYTE,t.data)):Se().getNumber("WEBGL_VERSION")===2?Ye(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,t)):Ye(s,()=>s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t)),Ye(s,()=>s.bindTexture(s.TEXTURE_2D,null))}function jne(s,e,t,n){const a=s.createBuffer();Ye(s,()=>s.bindBuffer(s.PIXEL_PACK_BUFFER,a));const c=4*4*e*t;return Ye(s,()=>s.bufferData(s.PIXEL_PACK_BUFFER,c,s.STREAM_READ)),Ye(s,()=>s.readPixels(0,0,t,e,s.RGBA,s.FLOAT,0)),Ye(s,()=>s.bindBuffer(s.PIXEL_PACK_BUFFER,null)),a}function Tne(s,e,t){const n=s,a=new Float32Array(t);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function Ine(s,e,t,n){const[a,o]=Up(e,t),i=4,c=new Uint8Array(Wte(e*t,i));return Ye(s,()=>s.readPixels(0,0,a,o,n.downloadTextureFormat,s.UNSIGNED_BYTE,c)),new Float32Array(c.buffer)}function $ne(s,e,t,n,a,o,i,c){const u=s,h=new Float32Array(Hte(o,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,h),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),h}function Ane(s,e,t){const n=new Float32Array(e*t*4);return Ye(s,()=>s.readPixels(0,0,t,e,s.RGBA,s.FLOAT,n)),n}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Se().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Vte(t,e)):this.gl=$r(t),e=this.gl,Se().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>Ye(o,()=>o.createVertexArray()),this.bindVertexArray=i=>Ye(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>Ye(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>Ye(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ye(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>Ye(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Ye(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>Ye(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Se().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=pm(this.gl,o),rr(this.gl,i))this.textureHalfFloatExtension=pm(this.gl,i);else if(Se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),rr(this.gl,a))this.colorBufferHalfFloatExtension=pm(this.gl,a);else if(Se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",rr(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(rr(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=gne(this.gl),this.indexBuffer=xne(this.gl),this.framebuffer=ise(this.gl),this.textureConfig=Ow(this.gl,this.textureHalfFloatExtension)}get debug(){return Se().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ye(e,()=>e.finish()),Ye(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ye(e,()=>e.deleteFramebuffer(this.framebuffer)),Ye(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ye(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ye(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),bne(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),yne(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),vne(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),kne(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),Cne(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Nne(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),wne(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(qC(this.gl,this.framebuffer),this.outputTexture=null),Ye(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>Ine(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,o,i){return $ne(this.gl,e,t,n,a,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Tne(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const a=jne(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Se().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const i=a.clientWaitSync(o,0,0);return i===a.ALREADY_SIGNALED||i===a.CONDITION_SATISFIED},t=o}else Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>Ane(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=mne(t));const n=tse(t);Ye(t,()=>t.attachShader(n,this.vertexShader)),Ye(t,()=>t.attachShader(n,e)),sse(t,n);const a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&j1(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ye(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Sne(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ye(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&j1(this.gl,this.program),Ye(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?cse(this.gl,e,t):use(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ye(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),dse(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[a,o]=Pu(t,n);this.setOutputMatrixTextureDriver(e,a,o)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&j1(this.gl,this.program),fm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ye(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ye(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=pm(this.gl,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=n.createQuery();return n.beginQuery(a.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await C4(()=>this.disposed||this.isQueryAvailable(e,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{const n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const n=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const n=this.getQueryTimerExtensionWebGL1(),a=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Ene(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Se().platform&&(n=Se().platform.setTimeoutCustom.bind(Se().platform)),C4(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),T1(this.gl,e,this.framebuffer),this.debug&&fm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(T1(this.gl,this.outputTexture,this.framebuffer),this.debug&&fm(this.gl)):qC(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const a=this.gl;T1(a,e,this.framebuffer),this.debug&&fm(a),this.outputTexture=e,Ye(a,()=>a.viewport(0,0,t,n)),Ye(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),Ye(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Ene(s){let e=0;for(;e<s.length&&s[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Dne,bincountImpl:cD,bincountReduceImpl:Rne,bitwiseAndImpl:_ne,castImpl:One,ceilImpl:Fne,concatImpl:Lne,equalImpl:Mne,expImpl:zne,expm1Impl:Pne,floorImpl:Bne,gatherNdImpl:Vne,gatherV2Impl:Une,greaterImpl:Gne,greaterEqualImpl:Wne,lessImpl:Hne,lessEqualImpl:qne,linSpaceImpl:Kne,logImpl:Xne,maxImpl:Yne,maximumImpl:Zne,minimumImpl:Qne,multiplyImpl:Jne,negImpl:eae,notEqualImpl:tae,prodImpl:sae,raggedGatherImpl:nae,raggedRangeImpl:aae,raggedTensorToTensorImpl:rae,rangeImpl:oae,rsqrtImpl:iae,scatterImpl:lae,sigmoidImpl:cae,simpleAbsImpl:uD,sliceImpl:uae,sparseFillEmptyRowsImpl:dae,sparseReshapeImpl:hae,sparseSegmentReductionImpl:dD,sqrtImpl:pae,staticRegexReplaceImpl:fae,stridedSliceImpl:mae,stringNGramsImpl:gae,stringSplitImpl:xae,stringToHashBucketFastImpl:bae,subImpl:yae,tileImpl:vae,topKImpl:wae,transposeImpl:zw,uniqueImpl:Nae}=kY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(s,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>"".concat(s,".").concat(t))}function Pn(s,e){return e===1?[s]:hD(s,e)}function Sae(s,e){if(s===1)return"rc";let t="";for(let n=0;n<s;n++)t+=e[n],n<s-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Dn(this.outputShape.length),this.rank===0)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=Pn("rc",this.rank),n=ss(this.rank),a=this.getOutOfBoundsCondition(t),o=this.getSetup(t),i=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(n," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(i,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let o="".concat(n===0?"r":"rp1",", ").concat(a===0?"c":"cp1");for(let i=2;i<this.rank;i++)o="".concat(e[e.length-1-i],",")+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(this.rank===1){const n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pD{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length);let n="";for(let a=0;a<4;a++){let o="thisRC = rc;";a%2===1&&(o+="thisRC.z += 1;"),a>1&&(o+="thisRC.y += 1;"),n+="\n        ".concat(o,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(kae(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?Lw():Fw(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}function kae(s,e){const t=e?Sse(["r","c","d"],"inputShape"):oc(["r","c","d"],s);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jae{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const a=QC(t,n),o=JC(e,a,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=ZC(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const u=this.freeTextures[o].pop();return this.usedTextures[o].push(u),u}let c;return a===yn.PACKED_2X2_FLOAT32?c=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===yn.PACKED_2X2_FLOAT16?c=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===yn.UNPACKED_FLOAT32?c=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===yn.UNPACKED_FLOAT16?c=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===yn.PACKED_4X1_UNSIGNED_BYTE&&(c=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(c),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),c}releaseTexture(e,t,n,a){if(this.freeTextures==null)return;const o=QC(n,a),i=JC(t,o,a);i in this.freeTextures||(this.freeTextures[i]=[]);const c=ZC(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,a),u=Se().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=c):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=c),this.numUsedTextures--;const h=this.usedTextures[i],p=h&&h.indexOf(e);if(p==null||p<0)throw new Error("Cannot release a texture that was never provided by this texture manager");h[p]=h[h.length-1],h.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Tae(s,e){const t=s;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===s.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}function ZC(s,e,t,n,a){const o=Iae(e,n);let i;if(a){const[u,h]=Pu(s[0],s[1]);i=u*h}else{const[u,h]=Up(s[0],s[1]);i=u*h}const c=Tae(t,o);return i*c}function Iae(s,e){switch(s){case yn.PACKED_2X2_FLOAT32:return iD(e);case yn.PACKED_2X2_FLOAT16:return lD(e);case yn.UNPACKED_FLOAT32:return aD(e);case yn.UNPACKED_FLOAT16:return rD(e);case yn.PACKED_4X1_UNSIGNED_BYTE:return oD(e);default:throw new Error("Unknown physical texture type ".concat(s))}}function $ae(s){return Se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?s?yn.PACKED_2X2_FLOAT32:yn.UNPACKED_FLOAT32:s?yn.PACKED_2X2_FLOAT16:yn.UNPACKED_FLOAT16}function QC(s,e){if(s===_a.UPLOAD)return yn.PACKED_2X2_FLOAT32;if(s===_a.RENDER||s==null)return $ae(e);if(s===_a.DOWNLOAD||s===_a.PIXELS)return yn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(s))}function JC(s,e,t){return"".concat(s[0],"_").concat(s[1],"_").concat(e,"_").concat(t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yr{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const pr="if (isnan(x)) return x;",Aae="return x;",ek="return abs(x);",Eae="return (x >= 0.0) ? x : (exp(x) - 1.0);",Dae=pr+"\n  return (x < 0.0) ? 0.0 : x;\n",Rae=pr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",ki="return x;",_ae="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oae="return x;",Fae="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Lae="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Mae="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",zae="return 1.0 / (1.0 + exp(-1.0 * x));";class Ii{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length);const t=e.length,n=Pn("rc",t),a=ss(t),o=Sae(t,n),i=n.slice(-2),c=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(o,");\n\n        setOutput(getChannel(packedInput, ").concat(c,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae=Nv,Vae=1e-7,Uae=1e-4,xm={};function Gae(s){return s in xm||(xm[s]={}),xm[s]}const Wae=Se().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Hae=600;function qae(){return Se().global.screen==null?1024:Se().global.screen.height*Se().global.screen.width*window.devicePixelRatio*Hae/1024/1024}class Qx extends Oy{nextDataId(){return Qx.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Se().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof A1)t=e;else{const n=$r(Se().getNumber("WEBGL_VERSION"),e);t=new A1(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const n=$r(Se().getNumber("WEBGL_VERSION"));t=new A1(n),this.binaryCache=Gae(Se().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new jae(this.gpgpu),this.numMBBeforeWarning=qae(),this.texData=new Ok(this,Wr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,o,i){const c=this.makeTensorInfo(t,n),u=this.texData.get(c.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[a,o]},u.texShape=[a,o];const h=mm(t),p=new YC(h,!1,i),f=this.runWebGLProgram(p,[c],n,[[a,o]]);return f.shape=t,u.texture=null,this.disposeIntermediateTensorInfo(c),f.dataId}write(e,t,n){if((Se().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Se().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:_a.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,n,a,o){if(Se().getBool("DEBUG")&&this.checkNumericalProblems(t),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:_a.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:a,complexTensorInfos:o,slice:i,shape:c,isPacked:u}=t;if(i!=null){let g;u?g=new Ii(c,ki):g=new Yr(c,ki);const b=this.runWebGLProgram(g,[{dataId:e,shape:c,dtype:a}],a),y=this.readSync(b.dataId);return this.disposeIntermediateTensorInfo(b),y}if(n!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return n;const h=this.activeTimers!=null;let p;h&&(p=Qn());let f;if(a==="complex64"){const g=this.readSync(o.real.dataId),b=this.readSync(o.imag.dataId);f=Lo(g,b)}else f=this.getValuesFromTexture(e);return h&&(this.downloadWaitMs+=Qn()-p),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(v=>y.push(v))}const t=this.texData.get(e),{values:n,shape:a,slice:o,dtype:i,complexTensorInfos:c,isPacked:u}=t;if(o!=null){let y;u?y=new Ii(a,ki):y=new Yr(a,ki);const v=this.runWebGLProgram(y,[{dataId:e,shape:a,dtype:i}],i),w=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),w}if(n!=null)return this.convertAndCacheOnCPU(e);if(Se().getBool("DEBUG")&&!Se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Se().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let h=null,p;if(i!=="complex64"&&Se().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(e);const y=this.texData.get(p.dataId);h=this.gpgpu.createBufferFromTexture(y.texture.texture,...hm(a))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(i==="complex64"){const y=await Promise.all([this.read(c.real.dataId),this.read(c.imag.dataId)]),v=y[0],w=y[1];f=Lo(v,w)}else if(h==null)f=this.getValuesFromTexture(e);else{const y=Ae(a);f=this.gpgpu.downloadFloat32MatrixFromBuffer(h,y)}if(p!=null&&this.disposeIntermediateTensorInfo(p),h!=null){const y=this.gpgpu.gl;Ye(y,()=>y.deleteBuffer(h))}const g=this.convertAndCacheOnCPU(e,f),b=this.pendingRead.get(e);return this.pendingRead.delete(e),b.forEach(y=>y(g)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Wr().removeDataId(e,this),this.pendingDeletes--),g}readToGPU(e,t={}){const n=this.texData.get(e),{values:a,shape:o,slice:i,dtype:c,isPacked:u,texture:h}=n;if(c==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let b;u?b=new Ii(o,ki):b=new Yr(o,ki);const y=this.runWebGLProgram(b,[{dataId:e,shape:o,dtype:c}],c),v=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),v}if(h==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const p=this.decode(e,t.customTexShape),f=Wr().makeTensorFromTensorInfo(p),g=this.texData.get(p.dataId);return Object.assign({tensorRef:f},g.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(a=>Ri(a));return $t(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return $t(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const n=e[t];if(!Yte(n))throw Se().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value ".concat(n," cannot be represented on this device."))}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:a}=this.texData.get(e),o=Ae(t);if(Se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const g=this.decode(e),b=this.texData.get(g.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(b.texture.texture,...hm(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(g),y}const i=Se().getBool("WEBGL_PACK")&&a===!0,c=i?mm(t):t,u=i?new hne(c):new dne(c),h=this.runWebGLProgram(u,[{shape:c,dtype:n,dataId:e}],"float32"),p=this.texData.get(h.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(h),f}timerAvailable(){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();const o=Bl(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=Bl(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=t,a&&(this.programTimersStack=null);const c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(o);c.kernelMs=B8(u),c.getExtraProfileInfo=()=>u.map((h,p)=>({name:i[p],ms:h})).map(h=>"".concat(h.name,": ").concat(h.ms)).join(", ")}else c.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,c})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Qn(),endMs:null}}endTimer(e){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Qn(),e)}async getQueryTime(e){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:a,usage:o,isPacked:i,slice:c}=this.texData.get(e),u=c&&c.origDataId||e,h=this.dataRefCount.get(u);h>1?this.dataRefCount.set(u,h-1):(this.dataRefCount.delete(u),t!=null&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,o,i)));const p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Wae){return Se().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&Ae(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Da("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Bae(e.shape,t)}packedUnaryOp(e,t,n){const a=new Ii(e.shape,t),o=this.compileAndRun(a,[e],n);return Wr().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=uD(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(Se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ek,e.dtype);const t=new Yr(e.shape,ek),n=this.compileAndRun(t,[e]);return Wr().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if(t==="string"&&n!=null&&n.length>0&&Th(n[0])){const o=n.map(i=>Ai(i));a=this.write(o,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return Wr().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Pae(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Cae(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[Tu(e.shape),...Iu(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},o=[Tu(t),...Iu(t)],i=new pD(o,n),c=!0,u=[n],h=this.runWebGLProgram(i,[a],e.dtype,u,c);return{dataId:h.dataId,shape:t,dtype:h.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:a,shape:o,dtype:i}=n;if(t!=null){const g=Ae(o),b=t[0]*t[1]*4;V(g<=b,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const c=mm(o);let u;a?u=new une(c):u=new cne(c);const h=!0,p=[t!=null?t:hm(c)],f=this.runWebGLProgram(u,[{shape:c,dtype:i,dataId:e}],i,p,h,t);return{dtype:i,shape:o,dataId:f.dataId}}runWebGLProgram(e,t,n,a,o=!1,i){const c=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(c.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Nh.DENSE){const N=i!=null?i:hm(e.outputShape);u.texShape=N.map(C=>C*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),Ae(c.shape)===0)return u.values=vn(c.dtype,0),c;const h=[],p=t.map(N=>{if(N.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(N.dataId);if(C.texture==null){if(!e.packedInputs&&Ae(N.shape)<=Se().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:N.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=N.shape)}if(this.uploadToGPU(N.dataId),!!C.isPacked!=!!e.packedInputs)N=C.isPacked?this.unpackTensor(N):this.packTensor(N),h.push(N),C=this.texData.get(N.dataId);else if(C.isPacked&&!sg(C.shape,N.shape)){const I=N,T=N.shape;N.shape=C.shape,N=this.packedReshape(N,T),h.push(N),C=this.texData.get(N.dataId),I.shape=T}return{shape:N.shape,texData:C,isUniform:!1}});this.uploadToGPU(c.dataId);const f={shape:c.shape,texData:u,isUniform:!1},g=lne(e,p,f),b=this.getAndSaveBinary(g,()=>one(this.gpgpu,e,p,f)),y=this.activeTimers!=null;let v;y&&(v=this.startTimer()),Se().get("ENGINE_COMPILE_ONLY")||ine(this.gpgpu,b,p,f,a),h.forEach(N=>this.disposeIntermediateTensorInfo(N)),y&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const w=Se().getNumber("WEBGL_FLUSH_THRESHOLD");if(w>0){const N=Qn();N-this.lastGlFlushTime>w&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=N)}if(!Se().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){const N=this.unpackTensor(c);return this.disposeIntermediateTensorInfo(c),N}return c}compileAndRun(e,t,n,a,o=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,a,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Se().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=me(()=>{if(!Se().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Se().getBool("DEBUG");Se().set("DEBUG",!1);const t=this.abs(ht(1e-8)).dataSync()[0];if(Se().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Vae:Uae}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:a,values:o,texture:i,usage:c,isPacked:u}=t;if(i!=null)return;const h=this.activeTimers!=null;let p;h&&(p=Qn());let f=t.texShape;if(f==null&&(f=fse(n,u),t.texShape=f),o!=null){const g=mm(n);let b,y=f[1],v=f[0];const w=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(u||!w)&&([y,v]=Pu(f[0],f[1])),u?b=new fne(g,w):b=new YC(g,w);const N=w?[v,y]:f,C=this.makeTensorInfo(N,a),I=this.texData.get(C.dataId);w?I.usage=_a.PIXELS:I.usage=_a.UPLOAD,I.texShape=N,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),y,v,o);const T=[[v,y]],E=this.runWebGLProgram(b,[C],a,T,!0),_=this.texData.get(E.dataId);t.texShape=_.texShape,t.isPacked=_.isPacked,t.usage=_.usage,Se().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(t.texture=_.texture,t.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(C),h&&(this.uploadWaitMs+=Qn()-p)}else{const g=this.acquireTexture(f,c,a,u);t.texture=g}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:a}=n;return t!=null&&(n.values=Kae(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(o," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*Am(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(a=>{try{this.checkCompletion_(t),a(!0)}catch(o){throw o}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await KT(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(QE(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:c,outTexShapeLocation:u}=nD(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:a,height:o,width:i,channels:c}=e,u=Wr().backend;if(!u.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const h=u.writeTexture(a,t,n,o,i,c);return Wr().makeTensorFromDataId(h,t,n,u)}}Qx.nextDataId=0;function Kae(s,e){if(e==="float32"||e==="complex64")return s;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(s.length):new Uint8Array(s.length);for(let n=0;n<t.length;++n)t[n]=Math.round(s[n]);return t}else throw new Error("Unknown dtype ".concat(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sj()&&rj("webgl",()=>new Qx,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pw="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Jl{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=kt(t,n),this.enableShapeUniforms=Dn(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lc="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Wu{constructor(e,t,n,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=kt(t,n);const o=this.outputShape.length;this.enableShapeUniforms=Dn(o);let i="";if(a)if(o===0||Ae(this.outputShape)===1)i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const c=ss(o);if(i="\n          ".concat(c," coords = getOutputCoords();\n        "),o===1)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const u=Pn("coords",o);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= outShape[").concat(o," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= outShape[").concat(o," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(s){const{inputs:e,backend:t}=s,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const Xae={kernelName:Kh,backendName:"webgl",kernelFunc:Na};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(s){const{inputs:e,backend:t}=s,{real:n,imag:a}=e,o=t.makeTensorInfo(n.shape,"complex64"),i=t.texData.get(o.dataId),c=Na({inputs:{x:n},backend:t}),u=Na({inputs:{x:a},backend:t});return i.complexTensorInfos={real:c,imag:u},o}const Yae={kernelName:Wy,backendName:"webgl",kernelFunc:tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fD="return (a < 0.) ? b * a : a;",mD="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function Zae(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{alpha:o}=n,i=t.makeTensorInfo([],"float32",Wi(o,"float32")),c=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(mD,a.shape,i.shape):new Jl(fD,a.shape,i.shape),u=t.runWebGLProgram(c,[a,i],"float32");return t.disposeIntermediateTensorInfo(i),u}const Qae={kernelName:Eg,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gD="return (a < 0.) ? b * a : a;",xD="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function Jae(s){const{inputs:e,backend:t}=s,{x:n,alpha:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(xD,n.shape,a.shape):new Jl(gD,n.shape,a.shape);return t.runWebGLProgram(o,[n,a],"float32")}const ere={kernelName:Yg,backendName:"webgl",kernelFunc:Jae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hu="if (isnan(x)) return x;";function Gt({opSnippet:s,packedOpSnippet:e,cpuKernelImpl:t,dtype:n}){return({inputs:a,backend:o})=>{const{x:i}=a,c=o,u=n||i.dtype;if(c.shouldExecuteOnCPU([i])&&t!=null){const f=c.texData.get(i.dataId),g=t(f.values,u);return c.makeTensorInfo(i.shape,u,g)}const h=Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let p;return h?p=new Ii(i.shape,e):p=new Yr(i.shape,s),c.runWebGLProgram(p,[i],u)}}function kn({opSnippet:s,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:n=!1,cpuKernelImpl:a,dtype:o}){return({inputs:i,backend:c})=>{const{a:u,b:h}=i,p=c;if(n&&u.dtype==="complex64"){const y=p.texData.get(u.dataId),v=p.texData.get(h.dataId),[w,N]=[[y.complexTensorInfos.real,v.complexTensorInfos.real],[y.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(I=>{const[T,$]=I,E={dataId:T.dataId,dtype:T.dtype,shape:u.shape},_={dataId:$.dataId,dtype:$.dtype,shape:h.shape},L=new Jl(s,u.shape,h.shape);return p.runWebGLProgram(L,[E,_],ya(T.dtype,$.dtype))}),C=tl({inputs:{real:w,imag:N},backend:p});return p.disposeIntermediateTensorInfo(w),p.disposeIntermediateTensorInfo(N),C}const f=o||ya(u.dtype,h.dtype);if((u.dtype==="string"||h.dtype==="string"||p.shouldExecuteOnCPU([u,h]))&&a!=null){const y=p.texData.get(u.dataId).values,v=p.texData.get(h.dataId).values,w=u.dtype==="string"?Mo(y):y,N=u.dtype==="string"?Mo(v):v,[C,I]=a(u.shape,h.shape,w,N,f),T=p.makeTensorInfo(I,f),$=p.texData.get(T.dataId);return $.values=C,T}const g=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let b;return g?b=new Wu(e,u.shape,h.shape,t):b=new Jl(s,u.shape,h.shape),p.runWebGLProgram(b,[u,h],f)}}function Sh(s,e=!1){if(s==="linear")return e?Oae:Aae;if(s==="relu")return e?Lae:Dae;if(s==="elu")return e?Fae:Eae;if(s==="relu6")return e?Mae:Rae;if(s==="prelu")return e?xD:gD;if(s==="leakyrelu")return e?mD:fD;if(s==="sigmoid")return e?zae:_ae;throw new Error("Activation ".concat(s," has not been implemented for the WebGL backend."))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bD{constructor(e,t,n,a=!1,o=!1,i=!1,c=null,u=!1,h=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Dn(this.outputShape.length);const p=a?e[1]:e[2],f=Math.ceil(p/2),g=a?"i * 2, rc.y":"rc.y, i * 2",b=o?"rc.z, i * 2":"i * 2, rc.z",y=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let w="",N="";c&&(u?w="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(c,"\n        }"):h?w="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(c,"\n        }"):w="vec4 activation(vec4 x) {\n          ".concat(c,"\n        }"),N="result = activation(result);");const C=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha");let I="rc.x",T="rc.x";e[0]<t[0]?I="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(T="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(w,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(I,";\n        int batchB = ").concat(T,";\n        for (int i = 0; i < ").concat(f,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(g,");\n          vec4 b = getMatrixB(batchB, ").concat(b,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(y[0]," * ").concat(v[0],");\n          result += (").concat(y[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(C,"\n\n        ").concat(N,"\n\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tk={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class sk{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=kt(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nk="return a * b;";function Bw(s){const{inputs:e,backend:t}=s,{a:n,b:a}=e,o=ya(n.dtype,a.dtype);if(n.dtype==="complex64"){const c=t.texData.get(n.dataId),u=t.texData.get(a.dataId),h=new sk(tk.REAL,n.shape,a.shape),p=new sk(tk.IMAG,n.shape,a.shape),f=[{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:n.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape}],g=t.runWebGLProgram(h,f,"float32"),b=t.runWebGLProgram(p,f,"float32"),y=tl({inputs:{real:g,imag:b},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),y}if(t.shouldExecuteOnCPU([n,a])){const c=t.texData.get(n.dataId),u=t.texData.get(a.dataId),[h,p]=Jne(n.shape,a.shape,c.values,u.values,o),f=t.makeTensorInfo(p,o),g=t.texData.get(f.dataId);return g.values=h,f}let i;return Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Wu(nk,n.shape,a.shape):i=new Jl(nk,n.shape,a.shape),t.runWebGLProgram(i,[n,a],o)}const tre={kernelName:np,backendName:"webgl",kernelFunc:Bw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(s,e,t){const n=[Tu(s.shape),...Iu(s.shape)],a={dtype:s.dtype,shape:n,dataId:s.dataId},o=[Tu(e),...Iu(e)],i=new pD(o,n),c=!0,u=[n],h=t.runWebGLProgram(i,[a],s.dtype,u,c);return{dataId:h.dataId,shape:e,dtype:h.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ke(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{shape:o}=n,i=t,c=Ae(a.shape),u=Fk(o,c),h=Ae(u);V(c===h,()=>"The new shape (".concat(u,") has ").concat(h," elements and the old ")+"shape (".concat(a.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements.");const p=i.texData.get(a.dataId);return p.isPacked&&!sg(a.shape,u)&&!(p.texture!==null&&sg(p.shape,u))?sre(a,u,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype})}const nre={kernelName:Qg,backendName:"webgl",kernelFunc:Ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ak{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:o,outSize:i}=e;this.outputShape=[a,i];const c=Math.floor(n/4)*4,u=n%4;let h="sumValue += dot(values, ones);";if(t!=null){const f=1/t;h="sumValue += dot(values * ".concat(xu(f)?f.toPrecision(2):f,", ones);")}let p="";o%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(u===1,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(h,"\n        } else if (").concat(u===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(h,"\n        } else if (").concat(u===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(h,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class are{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:o,outSize:i}=e;this.outputShape=[a,i];let c="0.0",u="";t==="prod"?c="1.0":t==="min"?(c="1.0 / 1e-20",u="min"):t==="max"&&(c="-1.0 / 1e-20",u="max");let h="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?h="sumValue":t==="prod"?h="prodValue":t==="all"?h="allValue":t==="any"&&(h="anyValue");const p=Math.floor(n/4)*4,f=n%4;let g="\n      if (".concat(t==="sum",") {\n        sumValue += dot(values, ones);\n      } else if (").concat(t==="prod",") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat(t==="min"," || ").concat(t==="max",") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),b="vec4";t==="all"?(c="1.0",g="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",b="bvec4"):t==="any"&&(c="0.0",g="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",b="bvec4");let y="";o%n>0&&(y="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(c,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(y,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(c,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(p,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(g,"\n        }\n\n        int inIdx = inOffset + ").concat(p,";\n        if (").concat(f===1,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===2,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===3,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(g,"\n        }\n        setOutput(").concat(h,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(s){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:s[1],n=Fx(t);e.push({inSize:t,windowSize:n,outSize:Math.ceil(t/n)})}return e}function cc(s,e,t,n){const a=rre(s.shape);let o=s;for(let i=0;i<a.length;i++){const{inSize:c,windowSize:u,outSize:h}=a[i];let p,f;t==="mean"?p=i===0?new ak({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h},c):new ak({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h}):p=new are({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h},t),f=o,o=n.runWebGLProgram(p,[o],e),f.dataId!==s.dataId&&n.disposeIntermediateTensorInfo(f)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ore{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;const a=ss(this.rank),o=ire(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}}function ire(s){const e=s.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(e);for(let a=0;a<s.length;a++)n[s[a]]=t[a];return n.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lre{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let p=0;p<n.length;p++)n[p]=e[t[p]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const a=ss(this.rank),o=hD("rc",this.rank),i=new Array(this.rank);for(let p=0;p<t.length;p++)i[t[p]]=o[p];const c="vec2(".concat(i.slice(-2).join(),")"),u="++".concat(o[this.rank-1]," < ").concat(n[this.rank-1]),h="getChannel(getA(".concat(i.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(u,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(u,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(s,e,t){const n=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lre(s.shape,e):new ore(s.shape,e);return t.runWebGLProgram(n,[s],s.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(s,e,t,n){const a=e,o=s.shape.length,i=At(a,s.shape);let c=i;const u=ws(c,o),h=u!=null;let p=s;h&&(p=Jx(s,u,n),c=_s(c.length,o)),Sn("sum",c,o);const[f,g]=pn(p.shape,c);let b=f;t&&(b=Rs(f,i));const y=Ae(g),w=Ae(s.shape)/y,N=Ke({inputs:{x:p},attrs:{shape:[w,y]},backend:n}),C=U2(s.dtype),I=cc(N,C,"sum",n),T=Ke({inputs:{x:I},attrs:{shape:b},backend:n});return n.disposeIntermediateTensorInfo(N),n.disposeIntermediateTensorInfo(I),h&&n.disposeIntermediateTensorInfo(p),T}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;return cre(a,o,i,t)}const ure={kernelName:ax,backendName:"webgl",kernelFunc:e0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vn(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{perm:o}=n,i=t,c=a.shape.length,u=new Array(c);for(let p=0;p<u.length;p++)u[p]=a.shape[o[p]];let h;if(i.shouldExecuteOnCPU([a])){const f=i.texData.get(a.dataId).values,g=zw(f,a.shape,a.dtype,o,u);h=i.makeTensorInfo(u,a.dtype);const b=i.texData.get(h.dataId);b.values=g}else h=Jx(a,o,i);return h}const dre={kernelName:du,backendName:"webgl",kernelFunc:Vn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yD=1e3;function ng({a:s,b:e,transposeA:t,transposeB:n,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:c=0,activation:u=null}){const h=s.shape.length,p=e.shape.length,f=t?s.shape[h-2]:s.shape[h-1],g=n?e.shape[p-1]:e.shape[p-2],b=t?s.shape[h-1]:s.shape[h-2],y=n?e.shape[p-2]:e.shape[p-1],v=s.shape.slice(0,-2),w=e.shape.slice(0,-2),N=Ae(v),C=Ae(w),T=kt(s.shape.slice(0,-2),e.shape.slice(0,-2)).concat([b,y]);V(f===g,()=>"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(g,") of Tensors with shapes ").concat(s.shape," and ")+"".concat(e.shape," and transposeA=").concat(t)+" and transposeB=".concat(n," must match."));const $=t?[N,f,b]:[N,b,f],E=n?[C,y,g]:[C,g,y],_=Ke({inputs:{x:s},backend:a,attrs:{shape:$}}),L=Ke({inputs:{x:e},backend:a,attrs:{shape:E}}),O=[_,L],z=Math.max(N,C),A=t?_.shape[1]:_.shape[2],U=o!=null,X=i!=null,Z=u==="leakyrelu",q=u!=null?Sh(u,!0):null,B=U||X||Z||q!=null;let K;if((b===1||y===1)&&A>yD&&B===!1){let Q=_,ae=L;t&&(Q=Vn({inputs:{x:_},backend:a,attrs:{perm:[0,2,1]}}),O.push(Q)),n&&(ae=Vn({inputs:{x:L},backend:a,attrs:{perm:[0,2,1]}}),O.push(ae));const we=y!==1,Ce=y===1;let ve=Q;we&&(ve=Ke({inputs:{x:Q},backend:a,attrs:{shape:[z,A,1]}}),O.push(ve));const pe=y===1?2:1;let xe=ae;Ce&&(xe=Ke({inputs:{x:ae},backend:a,attrs:{shape:[z,1,A]}}),O.push(xe));const ue=Bw({inputs:{a:ve,b:xe},backend:a});K=e0({inputs:{x:ue},backend:a,attrs:{axis:pe,keepDims:!0}}),O.push(ue)}else{const Q=ya(s.dtype,e.dtype),ae=new bD($,E,[z,b,y],t,n,U,q,X,Z),we=[_,L];if(o!=null&&we.push(o),X&&we.push(i),Z){const Ce=a.makeTensorInfo([],"float32",Wi(c,"float32"));we.push(Ce),O.push(Ce)}K=a.runWebGLProgram(ae,we,Q)}const J=Ke({inputs:{x:K},backend:a,attrs:{shape:T}});O.push(K);for(const Q of O)a.disposeIntermediateTensorInfo(Q);return J}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o,bias:i,preluActivationWeights:c}=e,{transposeA:u,transposeB:h,activation:p,leakyreluAlpha:f}=n;return ng({a,b:o,transposeA:u,transposeB:h,backend:t,bias:i,preluActivationWeights:c,leakyreluAlpha:f,activation:p})}const pre={kernelName:Em,backendName:"webgl",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rk="return abs(x);";function fre(s){const{inputs:e,backend:t}=s,{x:n}=e;if(t.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){const o=t.texData.get(n.dataId),i=uD(o.values);return t.makeTensorInfo(n.shape,n.dtype,i)}let a;return Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ii(n.shape,rk):a=new Yr(n.shape,rk),t.runWebGLProgram(a,[n],n.dtype)}const mre={kernelName:cg,backendName:"webgl",kernelFunc:fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gre=pr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",xre=Gt({opSnippet:gre}),bre={kernelName:Ih,backendName:"webgl",kernelFunc:xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre=pr+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",vre=Gt({opSnippet:yre}),wre={kernelName:$h,backendName:"webgl",kernelFunc:vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ok="return a + b;",Nre=kn({opSnippet:ok,packedOpSnippet:ok,supportsComplex:!0,cpuKernelImpl:Dne}),Sre={kernelName:Ru,backendName:"webgl",kernelFunc:Nre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cre{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,i)=>"T".concat(i));const n=[];this.variableNames.forEach(o=>{n.push("float v".concat(o," = get").concat(o,"AtOutCoords();"))});const a=this.variableNames.map(o=>"v".concat(o)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kre{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,i)=>"T".concat(i));const n=[];this.variableNames.forEach(o=>{n.push("vec4 v".concat(o," = get").concat(o,"AtOutCoords();"))});const a=this.variableNames.map(o=>"v".concat(o)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $m(s){const{inputs:e,backend:t}=s,n=e;if(n.length===1)return Na({inputs:{x:n[0]},backend:t});if(n.length>Se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(n.length/2),h=$m({inputs:n.slice(0,u),backend:t}),p=$m({inputs:n.slice(u),backend:t});return $m({inputs:[h,p],backend:t})}const a=n.map(u=>u.dtype).reduce((u,h)=>ya(u,h)),o=n.map(u=>u.shape),c=Se().getBool("WEBGL_PACK")?new kre(n[0].shape,o):new Cre(n[0].shape,o);return t.runWebGLProgram(c,n,a)}const jre={kernelName:ug,backendName:"webgl",kernelFunc:$m};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=At(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Vn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=_s(h.length,c)),Sn("all",h,c);const[g,b]=pn(f.shape,h),y=Ae(b),v=Ke({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),w=cc(v,v.dtype,"all",t);let N;if(i){const C=Rs(g,u);N=Ke({inputs:{x:w},backend:t,attrs:{shape:C}})}else N=Ke({inputs:{x:w},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),p!=null&&t.disposeIntermediateTensorInfo(f),N}const Ire={kernelName:zy,backendName:"webgl",kernelFunc:Tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=At(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Vn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=_s(h.length,c)),Sn("any",h,c);const[g,b]=pn(f.shape,h),y=Ae(b),v=Ke({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),w=cc(v,v.dtype,"any",t);let N;if(i){const C=Rs(g,u);N=Ke({inputs:{x:w},backend:t,attrs:{shape:C}})}else N=Ke({inputs:{x:w},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),p!=null&&t.disposeIntermediateTensorInfo(f),N}const Are={kernelName:Py,backendName:"webgl",kernelFunc:$re};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ere{constructor(e,t,n){this.variableNames=["A"];const{windowSize:a,batchSize:o,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const c=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(c," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dre{constructor(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,V(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");const c=this.outputShape,u=c.length,h=ss(u),p=Pn("coords",u);let f,g;if(i===1){g=u+1;const L=ss(g);f="\n        ".concat(L," sourceLocR = ").concat(L,"(").concat(p.join(),", 0);\n        ++").concat(p[u-1],";\n        ").concat(L," sourceLocG = ").concat(L,"(").concat(p.join(),", 0);\n        ++").concat(p[u-2],";\n        ").concat(L," sourceLocA = ").concat(L,"(").concat(p.join(),", 0);\n        --").concat(p[u-1],";\n        ").concat(L," sourceLocB = ").concat(L,"(").concat(p.join(),", 0);\n        --").concat(p[u-2],";")}else g=u,f="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(p[u-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(p[u-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(p[u-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(p[u-2],";");const b=["x","y","z","w","u","v"].slice(0,g),y="."+b[g-1],v=b.map(L=>"int "+L),w=Pn("sourceLocR",g-1).concat("inIdx.r"),N=Pn("sourceLocG",g-1).concat("inIdx.g"),C=Pn("sourceLocB",g-1).concat("inIdx.b"),I=Pn("sourceLocA",g-1).concat("inIdx.a"),T=n==="max"?"greaterThan":"lessThan",$=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(w.join(),"),\n                             getBestIndicesAChannel(").concat(N.join(),"),\n                             getBestIndicesAChannel(").concat(C.join(),"),\n                             getBestIndicesAChannel(").concat(I.join(),")));"),E="vec4(\n            getAChannel(".concat(w.join(),"),\n            hasNextCol ? getAChannel(").concat(N.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(C.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(I.join(),") : 0.)"),_=a?"":"\n      float getBestIndicesAChannel(".concat(v.join(),") {\n        return getChannel(getBestIndicesA(").concat(b.join(),"),\n                                          vec2(").concat(b.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(v.join(),") {\n        return getChannel(getA(").concat(b.join(),"),\n                               vec2(").concat(b.slice(-2).join(),"));\n      }\n      ").concat(_,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[u-1]," < ").concat(c[u-1]-1,";\n        bool hasNextRow = ").concat(p[u-2]," < ").concat(c[u-2]-1,";\n        ").concat(f,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(y,", sourceLocG").concat(y,",\n          sourceLocB").concat(y,", sourceLocA").concat(y,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(E,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat($,"\n          vec4 candidate = ").concat(E,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(T,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vD(s,e,t,n=null){let a=e.shape[0],o=e.shape[1];n!=null&&(a=n.shape[0],o=n.shape[1]);const i=Fx(o),c={windowSize:i,inSize:o,batchSize:a,outSize:Math.ceil(o/i)},u=new Ere(c,t,n==null),h=[e];n!=null&&h.push(n);const p=s.runWebGLProgram(u,h,"int32");if(p.shape[1]===1)return p;const f=vD(s,e,t,p);return s.disposeIntermediateTensorInfo(p),f}function wD(s,e,t,n=null){const a=n!=null?n.shape:e.shape,o=a[a.length-1],i=Fx(o),c=new Dre(a,i,t,n==null),u=n==null?[e]:[e,n],h=s.runWebGLProgram(c,u,"int32");if(h.shape.length===e.shape.length){const p=wD(s,e,t,h);return s.disposeIntermediateTensorInfo(h),p}return h}function ND(s,e,t,n){const a=[t];if(Sn("arg"+n.charAt(0).toUpperCase()+n.slice(1),a,e.shape.length),!Se().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=s.texData.get(e.dataId),c=i!==null&&i.isPacked;let u=e;c&&(u=s.unpackTensor(e),o.push(u));const[h,p]=pn(u.shape,a),f=Ae(p),g=Ke({inputs:{x:u},backend:s,attrs:{shape:[-1,f]}});o.push(g);const b=vD(s,g,n);o.push(b);const y=Ke({inputs:{x:b},backend:s,attrs:{shape:h}});return o.forEach(v=>s.disposeIntermediateTensorInfo(v)),y}return wD(s,e,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;let i=At(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=Vn({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=_s(i.length,u.shape.length)),Sn("argMax",[i[0]],u.shape.length);const p=ND(t,u,i[0],"max");return h.forEach(f=>t.disposeIntermediateTensorInfo(f)),p}const _re={kernelName:dg,backendName:"webgl",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;let i=At(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=Vn({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=_s(i.length,u.shape.length)),Sn("argMin",[i[0]],u.shape.length);const p=ND(t,u,i[0],"min");return h.forEach(f=>t.disposeIntermediateTensorInfo(f)),p}const Fre={kernelName:hg,backendName:"webgl",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lre=pr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",Mre=Gt({opSnippet:Lre}),zre={kernelName:Ah,backendName:"webgl",kernelFunc:Mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pre=pr+"return log(x + sqrt(x * x + 1.0));",Bre=Gt({opSnippet:Pre}),Vre={kernelName:Eh,backendName:"webgl",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure=pr+"\n  return atan(x);\n",Gre=Gt({opSnippet:Ure}),Wre={kernelName:Dh,backendName:"webgl",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre=Pw+"\n  return atan(a, b);\n",qre="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",Kre=kn({opSnippet:Hre,packedOpSnippet:qre}),Xre={kernelName:_h,backendName:"webgl",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre=pr+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",Zre=Gt({opSnippet:Yre}),Qre={kernelName:Rh,backendName:"webgl",kernelFunc:Zre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ch{constructor(e,t,n,a=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,c=e.strideHeight,u=e.strideWidth,h=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,b=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v=t==="avg",w="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),N="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let C="0.0";if(v||(C="-1.0 / 1e-20"),n){const L=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(b,", ").concat(y,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(g,";\n                wC += ").concat(p,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(L," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?o?w:N:"wR * ".concat(g," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}const I="max";let T="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(T="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,E=i%4,_="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(I,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(b,", ").concat(y,");\n      const float initializationValue = ").concat(C,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(C,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(h,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat($,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              getValue(batch, xR, xC + 2 * ").concat(p,", d),\n              getValue(batch, xR, xC + 3 * ").concat(p,", d)\n            );\n\n            ").concat(_,"\n          }\n\n          int xC = xCCorner + ").concat($,";\n          if (").concat(E===1,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(_,"\n          } else if (").concat(E===2,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(_,"\n          } else if (").concat(E===3,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              getValue(batch, xR, xC + 2 * ").concat(p,", d),\n              initializationValue\n            );\n\n            ").concat(_,"\n          }\n        }\n        setOutput(").concat(T,");\n      }\n    ")}}class Vw{constructor(e,t,n,a=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,c=e.strideDepth,u=e.strideHeight,h=e.strideWidth,p=e.dilationDepth,f=e.dilationHeight,g=e.dilationWidth,b=e.effectiveFilterDepth,y=e.effectiveFilterHeight,v=e.effectiveFilterWidth,w=e.padInfo.front,N=e.padInfo.top,C=e.padInfo.left;this.outputShape=e.outShape;const I=t==="avg";let T="0.0";if(I||(T="-1.0 / 1e-20"),n){const z=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(c,", ").concat(u,", ").concat(h,");\n        const ivec3 pads = ivec3(").concat(w,", ").concat(N,", ").concat(C,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(b,";\n              wD += ").concat(p,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(y,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(g,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(z," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?o?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(y," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}const $="max";let E="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(E="avgValue / max(count, 1.0)");const _=Math.floor(i/4)*4,L=i%4,O="\n      if (".concat(I,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat($,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(c,", ").concat(u,", ").concat(h,");\n      const ivec3 pads = ivec3(").concat(w,", ").concat(N,", ").concat(C,");\n      const float initializationValue = ").concat(T,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(T,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(b,";\n            wD += ").concat(p,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(y,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(_,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(g,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(g,", ch)\n              );\n\n              ").concat(O,"\n            }\n\n            int xC = xCCorner + ").concat(_,";\n            if (").concat(L===1,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(O,"\n            } else if (").concat(L===2,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(O,"\n            } else if (").concat(L===3,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(g,", ch),\n                initializationValue\n              );\n\n              ").concat(O,"\n            }\n          }\n        }\n        setOutput(").concat(E,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;Gp(a,"avgPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(Nn(i,h),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=dr(a.shape,o,i,h,c,u);if(p.filterWidth===1&&p.filterHeight===1&&Mt(p.inShape,p.outShape))return Na({inputs:{x:a},backend:t});const f=new Ch(p,"avg",!1);return t.runWebGLProgram(f,[a],"float32")}const eoe={kernelName:pg,backendName:"webgl",kernelFunc:Jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n,p=[1,1,1],f=Uo(a.shape,o,i,p,c,u,h),g=new Vw(f,"avg",!1);return t.runWebGLProgram(g,[a],"float32")}const soe={kernelName:fg,backendName:"webgl",kernelFunc:toe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class noe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.top,f=h-1-e.padInfo.left,g=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(p,", ").concat(f,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(h,";\n            wC+= ").concat(c,") {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class aoe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,g=e.effectiveFilterHeight,b=e.effectiveFilterWidth,y=f-1-e.padInfo.front,v=g-1-e.padInfo.top,w=b-1-e.padInfo.left,N=1/(t*n*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(y,", ").concat(v,", ").concat(w,");\n      const float avgMultiplier = float(").concat(N,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(o,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(g,";\n              wR += ").concat(h,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(b,";\n                wC += ").concat(p,") {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o,{filterSize:c,strides:u,pad:h,dimRoundingMode:p}=n,f=[1,1,1],g=Uo(i.shape,c,u,f,h,p),b=new aoe(g);return t.runWebGLProgram(b,[a],i.dtype)}const ooe={kernelName:Vy,backendName:"webgl",kernelFunc:roe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o;Gp([a,o],"avgPoolGrad");const{filterSize:c,strides:u,pad:h}=n,p=dr(i.shape,c,u,1,h),f=new noe(p);return t.runWebGLProgram(f,[a],i.dtype)}const loe={kernelName:By,backendName:"webgl",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o}=e,{transposeA:i,transposeB:c}=n;return ng({a,b:o,transposeA:i,transposeB:c,backend:t})}const uoe={kernelName:mg,backendName:"webgl",kernelFunc:coe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class doe{constructor(e,t,n,a,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],kt(e,t),kt(e,n);let c="0.0";a!=null&&(kt(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");let u="1.0";o!=null&&(kt(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(c,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hoe{constructor(e,t,n,a,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],kt(e,t),kt(e,n);let c="vec4(0.0)";a!=null&&(kt(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");let u="vec4(1.0)";o!=null&&(kt(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(c,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const poe=({inputs:s,backend:e,attrs:t})=>{const{x:n,mean:a,variance:o,offset:i,scale:c}=s;V(a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(c==null||a.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=t;u==null&&(u=.001);const h=[n,a,o];let p=null;i!=null&&(p=i.shape,h.push(i));let f=null;c!=null&&(f=c.shape,h.push(c));const g=Se().getBool("WEBGL_PACK_NORMALIZATION")?new hoe(n.shape,a.shape,o.shape,p,f,u):new doe(n.shape,a.shape,o.shape,p,f,u);return e.runWebGLProgram(g,h,h[0].dtype)},foe={kernelName:Ig,backendName:"webgl",kernelFunc:poe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class moe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=ss(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=goe(this.rank);let a;const o=e.map((i,c)=>"sourceLoc.".concat(Iy[c]," = start[").concat(c,"] + coords.").concat(Iy[c],";"));a="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(a,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const Iy=["x","y","z","w","u","v"];function goe(s){if(s===1)return"sourceLoc";if(s<=6)return Iy.slice(0,s).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(s," is not yet supported"))}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xoe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=ss(this.rank),n=Pn("coords",this.rank),a=Pn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(o,")"),c="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=this.rank===1?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),h=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((p,f)=>"start[".concat(f,"]")).join(),");"):e.map((p,f)=>"".concat(a[f]," = ").concat(n[f]," + start[").concat(f,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(h,"\n        vec4 result = vec4(0.);\n        ").concat(c,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(s,e,t,n){const a=n.texData.get(s.dataId),o=n.makeTensorInfo(t,s.dtype),i=n.texData.get(o.dataId);Object.assign(i,a),i.refCount=1,i.shape=t,i.dtype=s.dtype;let c=Fv(e,ut(s.shape));a.slice&&(c+=a.slice.flatOffset),i.slice={flatOffset:c,origDataId:a.slice&&a.slice.origDataId||s.dataId};const u=n.dataRefCount.get(i.slice.origDataId)||1;return n.dataRefCount.set(i.slice.origDataId,u+1),o}function qu(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,size:i}=n,[c,u]=Ox(a,o,i);if(Rv(a,c,u),Ae(u)===0)return t.makeTensorInfo(u,a.dtype,[]);if(t.shouldExecuteOnCPU([a])||a.dtype==="string"){const f=t.texData.get(a.dataId),g=uae(f.values,c,u,a.shape,a.dtype);return t.makeTensorInfo(u,a.dtype,g)}const{isPacked:h}=t.texData.get(a.dataId),p=Ov(a.shape,c,u);if(h||!p){const f=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xoe(u):new moe(u),g=[c];return t.runWebGLProgram(f,[a],a.dtype,g)}return t.uploadToGPU(a.dataId),boe(a,c,u,t)}const yoe={kernelName:nx,backendName:"webgl",kernelFunc:qu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,crops:i}=n;V(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const c=o.reduce((C,I)=>C*I),u=Ep(a.shape,o,c),h=Dp(u.length,o.length),p=Rp(a.shape,o,c),f=Bv(i,o.length),g=Vv(p,i,o.length),b=[],y=Ke({inputs:{x:a},backend:t,attrs:{shape:u}}),v=Vn({inputs:{x:y},backend:t,attrs:{perm:h}}),w=Ke({inputs:{x:v},backend:t,attrs:{shape:p}}),N=qu({inputs:{x:w},backend:t,attrs:{begin:f,size:g}});return b.push(y),b.push(v),b.push(w),b.forEach(C=>t.disposeIntermediateTensorInfo(C)),N},woe={kernelName:gg,backendName:"webgl",kernelFunc:voe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i}=n,c=t.readSync(a.dataId),u=t.readSync(o.dataId),h=cD(c,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}const Soe={kernelName:Uy,backendName:"webgl",kernelFunc:Noe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe="\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",koe="\n  return float(int(a.r) & int(b.r));\n";function joe(s){const{inputs:e,backend:t}=s,{a:n,b:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=Se().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([n,a])||i===1){const u=t.texData.get(n.dataId).values,h=t.texData.get(a.dataId).values,[p,f]=_ne(n.shape,a.shape,u,h,n.dtype),g=t.makeTensorInfo(f,n.dtype),b=t.texData.get(g.dataId);return b.values=p,g}let c;return o?c=new Wu(Coe,n.shape,a.shape,!1):c=new Jl(koe,n.shape,a.shape),t.runWebGLProgram(c,[n,a],n.dtype)}const Toe={kernelName:xg,backendName:"webgl",kernelFunc:joe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ioe(s){const{inputs:e,backend:t}=s,{s0:n,s1:a}=e,o=t.readSync(n.dataId),i=t.readSync(a.dataId),c=kt(Array.from(o),Array.from(i));return t.makeTensorInfo([c.length],"int32",Int32Array.from(c))}const $oe={kernelName:Gy,backendName:"webgl",kernelFunc:Ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aoe="return float(a != b);",SD=kn({opSnippet:Aoe,cpuKernelImpl:tae,dtype:"bool"}),Eoe={kernelName:Wg,backendName:"webgl",kernelFunc:SD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.texData.get(n.dataId);return Na({inputs:{x:a.complexTensorInfos.real},backend:t})}const Doe={kernelName:S2,backendName:"webgl",kernelFunc:Hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Roe="return float(int(x));";function _oe(s,e){const t=new Yr(s.shape,Roe),n=e.runWebGLProgram(t,[s],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $y(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dtype:o}=n;if(o==="complex64"){if(a.dtype==="complex64")return Na({inputs:{x:a},backend:t});const i=Ks(a.shape),c=$y({inputs:{x:a},backend:t,attrs:{dtype:"float32"}}),u=tl({inputs:{real:c,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(c),u}if(a.dtype==="complex64"){const i=Hp({inputs:{input:a},backend:t}),c=$y({inputs:{x:i},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(i),c}if(!Lk(a.dtype,o)){const i=Na({inputs:{x:a},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(t.shouldExecuteOnCPU([a])){const i=t.texData.get(a.dataId).values,[c,u,h]=One(i,a.shape,a.dtype,o);return t.makeTensorInfo(c,u,h)}if(o==="int32")return _oe(a,t);if(o==="bool"){const i=t.makeTensorInfo([],"bool",vn("bool",1)),u=SD({inputs:{a,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),u}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(o))}const Ooe={kernelName:Oh,backendName:"webgl",kernelFunc:$y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ik="return ceil(x);",Foe=Gt({opSnippet:ik,packedOpSnippet:ik,cpuKernelImpl:Fne}),Loe={kernelName:Fh,backendName:"webgl",kernelFunc:Foe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Moe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zoe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{clipValueMin:o,clipValueMax:i}=n;let c;Se().getBool("WEBGL_PACK_CLIP")?c=new zoe(a.shape):c=new Moe(a.shape);const u=[[o],[i]];return t.runWebGLProgram(c,[a],a.dtype,u)}const Boe={kernelName:Lh,backendName:"webgl",kernelFunc:Poe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(s,e){return{dataId:e.dataId,dtype:e.dtype,shape:s.shape}}function Uoe(s){const{inputs:e,backend:t}=s,{x:n}=e,a=t.texData.get(n.dataId),o=new Voe(n.shape),i=[lk(n,a.complexTensorInfos.real),lk(n,a.complexTensorInfos.imag)];return t.runWebGLProgram(o,i,i[0].dtype)}const Goe={kernelName:bg,backendName:"webgl",kernelFunc:Uoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Woe{constructor(e){this.outputShape=[],this.outputShape=Qr(e,1),this.variableNames=e.map((i,c)=>"T".concat(c));const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){const c=t[i-1];n.push("else if (yC < ".concat(t[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(c,"));"))}const a=t.length,o=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(o,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hoe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Qr(e,t);const n=this.outputShape,a=n.length,o=ss(a),i=Pn("coords",a),c=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((v,w)=>"T".concat(w));const u=new Array(e.length-1);u[0]=e[0][t];for(let v=1;v<u.length;v++)u[v]=u[v-1]+e[v][t];const h=c[t],p=c.slice(-2),f=c.join();let g="if (".concat(h," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(f,"), vec2(").concat(p.join(),"));\n        }");for(let v=1;v<u.length;v++){const w=u[v-1];g+="\n        if (".concat(h," < ").concat(u[v],"  && ").concat(h," >= ").concat(u[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(bm(c,h,w),"),\n            vec2(").concat(bm(p,h,w),"));\n        }")}const b=u.length,y=u[u.length-1];g+="\n        return getChannel(\n          getT".concat(b,"(").concat(bm(c,h,y),"),\n          vec2(").concat(bm(p,h,y),"));"),this.userCode="\n      float getValue(".concat(c.map(v=>"int "+v),") {\n        ").concat(g,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2]," &&\n            ").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function bm(s,e,t){const n=s.indexOf(e);return s.map((o,i)=>i===n?"".concat(o," - ").concat(t):o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.texData.get(n.dataId);return Na({inputs:{x:a.complexTensorInfos.imag},backend:t})}const qoe={kernelName:c2,backendName:"webgl",kernelFunc:t0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ch(s,e,t){const n=s[0].dtype;if(n==="complex64"){const b=s.map(C=>Hp({inputs:{input:C},backend:t})),y=s.map(C=>t0({inputs:{input:C},backend:t})),v=ch(b,e,t),w=ch(y,e,t),N=tl({inputs:{real:v,imag:w},backend:t});return b.forEach(C=>t.disposeIntermediateTensorInfo(C)),y.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),N}let a=t.shouldExecuteOnCPU(s);if(n==="string"&&(a=!0),a){const b=s.map(T=>{const E=[-1,Ae(T.shape.slice(e))];return Ke({inputs:{x:T},backend:t,attrs:{shape:E}})}),y=b.map(T=>({vals:t.readSync(T.dataId),shape:T.shape})),v=Qr(b.map(T=>T.shape),1),w=b[0].shape[0]===1,N=Lne(y,v,n,w),C=Qr(s.map(T=>T.shape),e),I=t.makeTensorInfo(C,n,N);return b.forEach(T=>t.disposeIntermediateTensorInfo(T)),I}const o=s.filter(b=>Ae(b.shape)>0),i=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const b=i?new Yr(s[0].shape,ki):new Ii(s[0].shape,ki);return t.runWebGLProgram(b,s,n)}const c=Se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>c){const b=[];for(let v=0;v<o.length;v+=c){const w=o.slice(v,v+c);b.push(ch(w,e,t))}const y=ch(b,e,t);for(const v of b)t.disposeIntermediateTensorInfo(v);return y}if(i){const b=new Hoe(o.map(y=>y.shape),e);return t.runWebGLProgram(b,o,n)}const{tensors2D:u,outShape:h}=Koe(o,e,t),p=new Woe(u.map(b=>b.shape)),f=t.runWebGLProgram(p,u,n);u.forEach(b=>t.disposeIntermediateTensorInfo(b));const g=Ke({inputs:{x:f},attrs:{shape:h},backend:t});return t.disposeIntermediateTensorInfo(f),g}function Koe(s,e,t){const n=Qr(s.map(o=>o.shape),e);return{tensors2D:s.map(o=>Ke({inputs:{x:o},attrs:{shape:[-1,Ae(o.shape.slice(e))]},backend:t})),outShape:n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n,o=At(a,e[0].shape)[0],i=e.map(h=>h.shape);Mv(i,o);const c=Qr(e.map(h=>h.shape),o);if(Ae(c)===0)return t.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter(h=>Ae(h.shape)>0);return u.length===1?Na({inputs:{x:u[0]},backend:t}):ch(u,o,t)}const Xoe={kernelName:yg,backendName:"webgl",kernelFunc:CD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,c=e.padInfo.left,u=e.strideHeight,h=e.strideWidth,p=e.dilationHeight,f=e.dilationWidth,g=e.filterHeight,b=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,w=e.dataFormat==="channelsLast",N=w?1:2,C=w?2:3,I=w?3:1;let T="",$="";n&&(a?T="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?T="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):T="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),$="result = activation(result);");const E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(T,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(I,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(N,"], coords[").concat(C,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(g,"; wR++) {\n          int xR = xRCorner + wR * ").concat(p,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(y,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(w,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(v===1,") {\n\n              if (").concat(w,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(y,") *\n                    getW(wR, wC, ").concat(y,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(y,", xR, xC) *\n                    getW(wR, wC, ").concat(y,", d2);\n              }\n\n            } else if (").concat(v===2,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(y,", d2),\n                getW(wR, wC, ").concat(y," + 1, d2)\n              );\n\n              if (").concat(w,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(y,"),\n                  getX(batch, xR, xC, ").concat(y," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(y,", xR, xC),\n                  getX(batch, ").concat(y," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(v===3,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(y,", d2),\n                getW(wR, wC, ").concat(y," + 1, d2),\n                getW(wR, wC, ").concat(y," + 2, d2)\n              );\n\n              if (").concat(w,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(y,"),\n                  getX(batch, xR, xC, ").concat(y," + 1),\n                  getX(batch, xR, xC, ").concat(y," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(y,", xR, xC),\n                  getX(batch, ").concat(y," + 1, xR, xC),\n                  getX(batch, ").concat(y," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(E,"\n        ").concat($,"\n        setOutput(result);\n      }\n    ")}}class Yoe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,p=e.dilationWidth,f=e.filterDepth,g=e.filterHeight,b=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(o,", ").concat(i,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(g,"; wR++) {\n            int xR = xRCorner + wR * ").concat(h,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(b,"; wC++) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(y,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(v===1,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(y,") *\n                  getW(wF, wR, wC, ").concat(y,", d2);\n              } else if (").concat(v===2,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(y,"),\n                  getX(batch, xF, xR, xC, ").concat(y," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(y,", d2),\n                  getW(wF, wR, wC, ").concat(y," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(v===3,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(y,"),\n                  getX(batch, xF, xR, xC, ").concat(y," + 1),\n                  getX(batch, xF, xR, xC, ").concat(y," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(y,", d2),\n                  getW(wF, wR, wC, ").concat(y," + 1, d2),\n                  getW(wF, wR, wC, ").concat(y," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Dn(this.outputShape.length);const i=e.padInfo.left,c=e.strideWidth,u=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=p;let g="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let w=0;w<p;w++)g+="\n           vec4 xTexelC".concat(w*2,";\n           int xTexelC").concat(w*2,"Ready;\n           vec4 xTexelC").concat(w*2+1,";\n           int xTexelC").concat(w*2+1,"Ready;\n           vec4 xC").concat(w,";");g+="\n     for (int r = 0; r < ".concat(h,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let w=0;w<p;w++)g+="\n           xTexelC".concat(w*2," = vec4(0.0);\n           xTexelC").concat(w*2,"Ready = 0;\n           xTexelC").concat(w*2+1," = vec4(0.0);\n           xTexelC").concat(w*2+1,"Ready = 0;\n           xC").concat(w," = vec4(0.0);");g+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let w=0;w<(f+1)/2;w++){const N=w*2;if(g+="\n           xC = xCCorner + ".concat(N*u,";\n           "),c===1){if(N<p&&(i%2===1?(g+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n               "),u===1&&N>0?g+="\n                 xC".concat(N," = vec4(xTexelC").concat(N-2,".zw, xTexelC").concat(N,".xy);\n                 "):g+="\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(N," = vec4(previous.zw, xTexelC").concat(N,".xy);\n                   } else {\n                     xC").concat(N," = vec4(0.0, 0.0, xTexelC").concat(N,".xy);\n                   }\n                   ")):g+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 xC").concat(N," = xTexelC").concat(N,";\n                 "),N+1<p)){const C=i%2===0?Fy(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(g+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(C,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                     xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(N+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(N+1,"Ready = 1;\n                   }\n                   "),u>1?g+="\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(N+1," = vec4(previous.zw, xTexelC").concat(N+1,".xy);\n                     } else {\n                      xC").concat(N+1," = vec4(0.0, 0.0, xTexelC").concat(N+1,".xy);\n                     }\n                     "):g+="\n                     xC".concat(N+1," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".xy);\n                     ")):C===1?g+="\n                     xC".concat(N+1," = xTexelC").concat(N,";\n                     "):g+="\n                     xCOffset = xC + ".concat(C,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                       xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(N+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(N+1,"Ready = 1;\n                     }\n\n                     xC").concat(N+1," = xTexelC").concat(N+1,";\n                     ")}}else N<p&&(i%2===1?(g+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                   xTexelC").concat(N+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(N+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N+1,"Ready = 1;\n                 }\n\n                 xC").concat(N," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".zw);\n               "),N+1<p&&(g+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(N+1," = vec4(xTexelC").concat(N+1,".xy, final.xy);\n                 "))):(g+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                   xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(N+1,"Ready = 1;\n                 }\n\n                 xC").concat(N," = vec4(\n                   xTexelC").concat(N,".xy, xTexelC").concat(N+1,".xy);\n               "),N+1<p&&(g+="\n                   xC".concat(N+1," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".zw);\n                 "))));N<p&&(g+="\n             wTexel = getW(r, ".concat(N,", d1, d2);\n             dotProd += xC").concat(N,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(N,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),N+1<p&&(g+="\n               wTexel = getW(r, ".concat(N+1,", d1, d2);\n               dotProd += xC").concat(N+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(N+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}g+="\n     }\n   ",g+="\n     }\n   ",g+="\n     }\n   ";let b="",y="";n&&(a?b="vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):o?b="vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):b="vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),y="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(b,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(g,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(v,"\n         ").concat(y,"\n         setOutput(result);\n       }\n     ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zoe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Dn(this.outputShape.length);const{dataFormat:n}=t,a=Wn(),o=n==="channelsLast",i=o?1:2,c=o?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let h="";for(let p=0;p<=1;p++)for(let f=0;f<=1;f++)h+="\n          blockIndex = rc.z + ".concat(f,";\n          pos = rc.y + ").concat(p,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(c,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(o,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(p*2+f,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(p*2+f,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(h,"\n\n        ").concat(a.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ag(s,e){const t=s.length;return t>=3?e?[...s.slice(0,-3),s[t-3]*s[t-2],s[t-1]]:[...s.slice(0,-3),s[t-3],s[t-2]*s[t-1]]:!e&&t===1&&s[0]>1?[s[0],1]:null}function TD({x:s,filter:e,convInfo:t,backend:n,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:c=null}){const u=s.shape,h=n.texData.get(s.dataId),p=t.inChannels,f=u[0]*u[1]*u[2],g=t.outChannels,b=t.dataFormat==="channelsLast",y=!1,v=!1;let w;const N=[];if(o!=null){const T=ag(o.shape,b);T!=null&&(o=Ke({inputs:{x:o},backend:n,attrs:{shape:T}}),N.push(o))}if(a!=null){const T=ag(a.shape,b);T!=null&&(a=Ke({inputs:{x:a},backend:n,attrs:{shape:T}}),N.push(a))}if(!((f===1||g===1)&&p>yD)&&h.isPacked&&b&&h.texture!=null&&u[2]%2!==0&&Mt(h.shape.slice(-3),u.slice(-3))){const T=u[0]*u[1]*(u[2]+1),$={dataId:s.dataId,shape:[1,T,t.inChannels],dtype:s.dtype},E=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,V(sg(h.shape,$.shape),()=>"packed reshape ".concat(h.shape," to ").concat($.shape," isn't free"));const _=Ke({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}});N.push(_);const L=ng({a:$,b:_,backend:n,transposeA:y,transposeB:v,bias:a,activation:c,preluActivationWeights:o,leakyreluAlpha:i}),O=n.texData.get(L.dataId);V(O.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=E,O.shape=t.outShape,w=Na({inputs:{x:L},backend:n}),w.shape=t.outShape,N.push(L)}else{const T=t.outHeight*t.outWidth,$=Ke({inputs:{x:s},backend:n,attrs:{shape:b?[t.batchSize,T,t.inChannels]:[t.batchSize,t.inChannels,T]}}),E=Ke({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}}),_=ng({a:b?$:E,b:b?E:$,transposeA:!b,transposeB:v,backend:n,bias:a,activation:c,preluActivationWeights:o,leakyreluAlpha:i});w=Ke({inputs:{x:_},backend:n,attrs:{shape:t.outShape}}),N.push($),N.push(E),N.push(_)}for(const T of N)n.disposeIntermediateTensorInfo(T);return w}function ID({x:s,filter:e,convInfo:t,backend:n,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:c=null}){const{filterWidth:u,filterHeight:h,inChannels:p,outWidth:f,outHeight:g,dataFormat:b}=t,y=b==="channelsLast",v=u*h*p,w=g*f,N=[t.batchSize,v,w],C=!0,I=!1,T=[];if(o!=null){const J=ag(o.shape,y);J!=null&&(o=Ke({inputs:{x:o},backend:n,attrs:{shape:J}}),T.push(o))}if(a!=null){const J=ag(a.shape,y);J!=null&&(a=Ke({inputs:{x:a},backend:n,attrs:{shape:J}}),T.push(a))}const $=Ke({inputs:{x:e},backend:n,attrs:{shape:[1,v,Ae(e.shape)/v]}});T.push($);const E=new Zoe(N,t),_=[s.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],L=n.runWebGLProgram(E,[s],"float32",_),O=Ke({inputs:{x:L},backend:n,attrs:{shape:N}});T.push(L),T.push(O);const z=a!=null,A=o!=null,U=c==="leakyrelu",X=c?Sh(c,!0):null,Z=new bD(y?O.shape:$.shape,y?$.shape:O.shape,y?[t.batchSize,w,t.outChannels]:[t.batchSize,t.outChannels,w],C,I,z,X,A,U),q=y?[O,$]:[$,O];if(a&&q.push(a),A&&q.push(o),U){const J=n.makeTensorInfo([],"float32",Wi(i,"float32"));q.push(J),T.push(J)}const B=n.runWebGLProgram(Z,q,"float32"),K=Ke({inputs:{x:B},backend:n,attrs:{shape:t.outShape}});T.push(B);for(const J of T)n.disposeIntermediateTensorInfo(J);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}=n,f=Go(u),g=hn(a.shape,o.shape,i,h,c,p,!1,f);let b;if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))b=TD({x:a,filter:o,convInfo:g,backend:t});else if(g.strideWidth<=2&&f==="channelsLast"&&Se().getBool("WEBGL_EXP_CONV")){const v=new jD(g),w=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]];b=t.runWebGLProgram(v,[a,o],"float32",w)}else if(Se().getBool("WEBGL_CONV_IM2COL"))b=ID({x:a,filter:o,convInfo:g,backend:t});else{const v=new kD(g);b=t.runWebGLProgram(v,[a,o],"float32")}const y=Ke({inputs:{x:b},backend:t,attrs:{shape:g.outShape}});return t.disposeIntermediateTensorInfo(b),y}const Joe={kernelName:vg,backendName:"webgl",kernelFunc:Qoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class tie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",c=t-1-e.padInfo.top,u=n-1-e.padInfo.left,h=i?1:2,p=i?2:3,f=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(h,"], coords[").concat(p,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class sie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,c=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(o,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(c,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class nie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=t-1-e.padInfo.front,h=n-1-e.padInfo.top,p=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(o,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,dataFormat:u,dimRoundingMode:h,filterShape:p}=n,f=Go(u),g=hn(a.shape,p,i,1,c,h,!1,f),b=new eie(g);return t.runWebGLProgram(b,[a,o],"float32")}const rie={kernelName:Hy,backendName:"webgl",kernelFunc:aie};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oie{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Dn(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{inputShape:i,strides:c,pad:u,dataFormat:h,dimRoundingMode:p}=n,f=Go(h),g=hn(i,o.shape,c,1,u,p,!1,f);if(Se().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const b=[[g.strideHeight,g.strideWidth]],y=new oie(g);return t.runWebGLProgram(y,[a,o],"float32",b)}else{const b=new tie(g);return t.runWebGLProgram(b,[a,o],"float32")}}const lie={kernelName:wg,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n,h=Ki(a.shape,o.shape,i,u,c),p=new Yoe(h);return t.runWebGLProgram(p,[a,o],"float32")}const uie={kernelName:Ng,backendName:"webgl",kernelFunc:cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,filterShape:u}=n,h=Ki(a.shape,u,i,1,c),p=new sie(h);return t.runWebGLProgram(p,[a,o],"float32")}const hie={kernelName:qy,backendName:"webgl",kernelFunc:die};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{pad:i,strides:c,inputShape:u}=n,h=Ki(u,o.shape,c,1,i),p=new nie(h);return t.runWebGLProgram(p,[a,o],"float32")}const fie={kernelName:Ky,backendName:"webgl",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mie=Hu+"\n  return cos(x);\n",gie="\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(lc,"\n  return result;\n"),xie=Gt({opSnippet:mie,packedOpSnippet:gie}),bie={kernelName:Mh,backendName:"webgl",kernelFunc:xie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yie="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",vie=Gt({opSnippet:yie}),wie={kernelName:zh,backendName:"webgl",kernelFunc:vie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nie{constructor(e,t,n,a,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,c,u,h]=e,[p]=t,[f,g]=n;this.outputShape=[p,f,g,h];const b=a==="bilinear"?1:0,[y,v]=["".concat(c-1,".0"),"".concat(u-1,".0")],[w,N,C]=f>1?["".concat((c-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(y," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(y)],[I,T,$]=g>1?["".concat((u-1)/(g-1)),"(x2-x1) * width_ratio","x1*".concat(v," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(v)];this.userCode="\n      const float height_ratio = float(".concat(w,");\n      const float width_ratio = float(").concat(I,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(N,";\n        float width_scale = ").concat(T,";\n\n        float in_y = ").concat(C,";\n        if( in_y < 0.0 || in_y > ").concat(y," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat($,";\n        if( in_x < 0.0 || in_x > ").concat(v," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(b," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sie=s=>{const{inputs:e,backend:t,attrs:n}=s,{image:a,boxes:o,boxInd:i}=e,{cropSize:c,method:u,extrapolationValue:h}=n,p=new Nie(a.shape,o.shape,c,u,h);return t.runWebGLProgram(p,[a,o,i],"float32")},Cie={kernelName:Yy,backendName:"webgl",kernelFunc:Sie};var kh;(function(s){s.Prod="*",s.Sum="+"})(kh||(kh={}));class ck{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===kh.Prod?"1.0":"0.0",c=n?i:"getX(".concat(uk(o,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1];let h="",p="";n?(h=a?"end != ".concat(u-1):"end != 0",p=a?"end + 1":"end - 1"):(h=a?"end + pow2 < ".concat(u):"end >= pow2",p=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(ss(o)," coords = getOutputCoords();\n        int end = ").concat(dk(o,"coords",this.op),";\n        float val = ").concat(c,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(h,") {\n          int idx = ").concat(p,";\n          ").concat(dk(o,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(uk(o,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function uk(s,e,t){if(s===1)return"".concat(e);if(s===2)return"".concat(e,".x, ").concat(e,".y");if(s===3)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(s===4)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(t," for rank ").concat(s," is not yet supported"))}function dk(s,e,t){if(s===1)return"".concat(e);if(s===2)return"".concat(e,".y");if(s===3)return"".concat(e,".z");if(s===4)return"".concat(e,".w");throw new Error("Cumulative ".concat(t," for rank ").concat(s," is not yet supported"))}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $D(s,e,t,n,a,o){const i=e.shape.length,c=ws([n],i);let u=e;c!=null&&(u=Vn({inputs:{x:e},backend:t,attrs:{perm:c}}));const h=_s(1,i)[0];if(h!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(n));const p=u.shape[h];let f=Na({inputs:{x:u},backend:t});for(let g=0;g<=Math.ceil(Math.log2(p))-1;g++){const b=new ck(s,u.shape,!1,o),y=[[g]],v=f;f=t.runWebGLProgram(b,[f],f.dtype,y),t.disposeIntermediateTensorInfo(v)}if(a){const g=new ck(s,u.shape,a,o),b=f;f=t.runWebGLProgram(g,[f],f.dtype),t.disposeIntermediateTensorInfo(b)}if(c!=null){const g=Xi(c),b=Vn({inputs:{x:f},backend:t,attrs:{perm:g}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(u),b}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;return $D(kh.Prod,a,t,o,i,c)}const jie={kernelName:Xy,backendName:"webgl",kernelFunc:kie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;return $D(kh.Sum,a,t,o,i,c)}const Iie={kernelName:Sg,backendName:"webgl",kernelFunc:Tie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i,binaryOutput:c}=n;if(a.shape.length===1){const u=t.readSync(a.dataId),h=t.readSync(o.dataId),p=cD(u,h,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,p)}else if(a.shape.length===2){const u=t.bufferSync(a),h=t.bufferSync(o),p=Rne(u,h,i,c);return t.makeTensorInfo(p.shape,o.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}const Aie={kernelName:Zy,backendName:"webgl",kernelFunc:$ie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eie{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockSize:o,dataFormat:i}=n,c=a.shape[0],u=i==="NHWC"?a.shape[1]:a.shape[2],h=i==="NHWC"?a.shape[2]:a.shape[3],p=i==="NHWC"?a.shape[3]:a.shape[1],f=u*o,g=h*o,b=p/(o*o),y=i==="NHWC"?[c,f,g,b]:[c,b,f,g],v=new Eie(y,o,i);return t.runWebGLProgram(v,[a],a.dtype)}const Rie={kernelName:Qy,backendName:"webgl",kernelFunc:Die};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Dn(this.outputShape.length);const i=e.filterHeight,c=e.filterWidth,u=e.outChannels/e.inChannels;let h="",p="";n&&(a?h="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?h="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):h="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(h,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(c,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(f,"\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ED{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Dn(this.outputShape.length);const i=e.outChannels/e.inChannels,c=e.padInfo.left,u=e.strideWidth,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=f;let b="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let N=0;N<f;N++)b+="\n          vec4 xTexelC".concat(N*2,";\n          int xTexelC").concat(N*2,"Ready;\n          vec4 xTexelC").concat(N*2+1,";\n          int xTexelC").concat(N*2+1,"Ready;\n          vec4 xC").concat(N,";");b+="\n    for (int r = 0; r < ".concat(p,"; r++) {\n      ");for(let N=0;N<f;N++)b+="\n          xTexelC".concat(N*2," = vec4(0.0);\n          xTexelC").concat(N*2,"Ready = 0;\n          xTexelC").concat(N*2+1," = vec4(0.0);\n          xTexelC").concat(N*2+1,"Ready = 0;\n          xC").concat(N," = vec4(0.0);");b+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let N=0;N<(g+1)/2;N++){const C=N*2;if(b+="\n          xC = xCCorner + ".concat(C*h,";\n          "),u===1){if(C<f&&(c%2===1?(b+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n              "),h===1&&C>0?b+="\n                xC".concat(C," = vec4(xTexelC").concat(C-2,".zw, xTexelC").concat(C,".xy);\n                "):b+="\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(C," = vec4(previous.zw, xTexelC").concat(C,".xy);\n                  } else {\n                    xC").concat(C," = vec4(0.0, 0.0, xTexelC").concat(C,".xy);\n                  }\n                  ")):b+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                xC").concat(C," = xTexelC").concat(C,";\n                "),C+1<f)){const I=c%2===0?Fy(h):h;h%2===0&&c%2===1||h%2!==0&&c%2!==1?(b+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(I,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                    xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(C+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(C+1,"Ready = 1;\n                  }\n                  "),h>1?b+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(C+1," = vec4(previous.zw, xTexelC").concat(C+1,".xy);\n                    } else {\n                     xC").concat(C+1," = vec4(0.0, 0.0, xTexelC").concat(C+1,".xy);\n                    }\n                    "):b+="\n                    xC".concat(C+1," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".xy);\n                    ")):I===1?b+="\n                    xC".concat(C+1," = xTexelC").concat(C,";\n                    "):b+="\n                    xCOffset = xC + ".concat(I,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                      xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(C+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(C+1,"Ready = 1;\n                    }\n\n                    xC").concat(C+1," = xTexelC").concat(C+1,";\n                    ")}}else C<f&&(c%2===1?(b+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                  xTexelC").concat(C+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(C+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C+1,"Ready = 1;\n                }\n\n                xC").concat(C," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".zw);\n              "),C+1<f&&(b+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(C+1," = vec4(xTexelC").concat(C+1,".xy, final.xy);\n                "))):(b+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                  xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(C+1,"Ready = 1;\n                }\n\n                xC").concat(C," = vec4(\n                  xTexelC").concat(C,".xy, xTexelC").concat(C+1,".xy);\n              "),C+1<f&&(b+="\n                  xC".concat(C+1," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".zw);\n                "))));C<f&&(b+="\n            wTexel = getW(r, ".concat(C,", d1, q);\n            dotProd += xC").concat(C," * vec4(wTexel.xz, wTexel.xz);\n          "),C+1<f&&(b+="\n              wTexel = getW(r, ".concat(C+1,", d1, q);\n              dotProd += xC").concat(C+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}b+="\n    }\n  ",b+="\n      }\n    ";let y="",v="";n&&(a?y="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?y="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):y="vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),v="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(y,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(b,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(w,"\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u,dimRoundingMode:h}=n;let p=u;p==null&&(p=[1,1]),V(Nn(i,p),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(p,"'"));const f=hn(a.shape,o.shape,i,p,c,h,!0);let g;Se().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?g=new ED(f):g=new AD(f);const b=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(g,[a,o],"float32",b)}const Oie={kernelName:Cg,backendName:"webgl",kernelFunc:_ie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Lie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,c=n-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,filterShape:p}=n,f=hn(a.shape,p,i,c,u,h,!0),g=new Fie(f);return t.runWebGLProgram(g,[a,o],"float32")}const zie={kernelName:Jy,backendName:"webgl",kernelFunc:Mie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,inputShape:p}=n,f=hn(p,o.shape,i,c,u,h,!0),g=new Lie(f);return t.runWebGLProgram(g,[a,o],"float32")}const Bie={kernelName:e2,backendName:"webgl",kernelFunc:Pie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vie{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(s){const{inputs:e,backend:t}=s,{x:n}=e,a=[...n.shape,...n.shape],o=Ae(n.shape),i=Ke({inputs:{x:n},backend:t,attrs:{shape:[o]}}),c=new Vie(o),u=t.runWebGLProgram(c,[i],i.dtype),h=Ke({inputs:{x:u},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),h}const Gie={kernelName:t2,backendName:"webgl",kernelFunc:Uie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:a,strideHeight:o,strideWidth:i,filterHeight:c,filterWidth:u,dilationHeight:h,dilationWidth:p}=e,{top:f,left:g}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(g,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(c,"; h++) {\n          int hIn = hBeg + h * ").concat(h,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(p,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n,h=Cp(a.shape,o.shape,i,c,"NHWC",u);let p;const f=new Wie(h);p=t.runWebGLProgram(f,[a,o],"float32");const g=Ke({inputs:{x:p},backend:t,attrs:{shape:h.outShape}});return t.disposeIntermediateTensorInfo(p),g}const qie={kernelName:kg,backendName:"webgl",kernelFunc:Hie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(s){const{inputs:e,backend:t,attrs:n}=s,{equation:a}=n,o=e,{allDims:i,summedDims:c,idDims:u}=Yv(a,o.length);Qv(i.length,u,o);const{path:h,steps:p}=Jv(c,u),f=p.length;let g=null,b=i.length;const y=[];for(let v=0;v<f;++v){for(const w of p[v]){const{permutationIndices:N,expandDims:C}=Zv(b,u[w]);let I;ew(N)?I=o[w]:(I=Vn({inputs:{x:o[w]},backend:t,attrs:{perm:N}}),y.push(I));const T=I.shape.slice();for(let $=0;$<C.length;++$)T.splice(C[$],0,1);Mt(I.shape,T)||(I=Ke({inputs:{x:I},backend:t,attrs:{shape:T}}),y.push(I)),g===null?g=I:(g=Bw({inputs:{a:I,b:g},backend:t}),y.push(g))}v<f-1&&(h[v]>=0&&(g=e0({inputs:{x:g},backend:t,attrs:{axis:h[v]-(i.length-b),keepDims:!1}}),y.push(g)),b--)}for(const v of y)v!==g&&t.disposeIntermediateTensorInfo(v);return g}const Xie={kernelName:s2,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yie="return (x >= 0.0) ? x : (exp(x) - 1.0);",Zie="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Qie=Gt({opSnippet:Yie,packedOpSnippet:Zie}),Jie={kernelName:Bh,backendName:"webgl",kernelFunc:Qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele="return (b >= 0.0) ? a : a * (b + 1.0);",tle="\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",sle=s=>{const{inputs:e,backend:t}=s,{dy:n,y:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(tle,n.shape,a.shape):new Jl(ele,n.shape,a.shape);return t.runWebGLProgram(o,[n,a],n.dtype)},nle={kernelName:n2,backendName:"webgl",kernelFunc:sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale="\n  return vec4(equal(a, b));\n",rle="return float(a == b);",ole=kn({opSnippet:rle,packedOpSnippet:ale,dtype:"bool",cpuKernelImpl:Mne}),ile={kernelName:jg,backendName:"webgl",kernelFunc:ole};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Uv,";\n  float a1 = ").concat(Gv,";\n  float a2 = ").concat(Wv,";\n  float a3 = ").concat(Hv,";\n  float a4 = ").concat(qv,";\n  float a5 = ").concat(Kv,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),cle=Gt({opSnippet:lle}),ule={kernelName:Vh,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle=Hu+"\n  return exp(x);\n",hle="\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",DD=Gt({opSnippet:dle,packedOpSnippet:hle,cpuKernelImpl:zne,dtype:"float32"}),ple={kernelName:Uh,backendName:"webgl",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(s){const{inputs:e,attrs:t,backend:n}=s,{dim:a}=t,{input:o}=e,i=o.shape.length,c=o.shape.slice();let u=a;return a<0&&(V(-(i+1)<=a,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),u=i+a+1),c.splice(u,0,1),Ke({inputs:{x:o},backend:n,attrs:{shape:c}})}const fle={kernelName:Tg,backendName:"webgl",kernelFunc:Ay};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hk="return exp(x) - 1.0;",mle=Gt({opSnippet:hk,packedOpSnippet:hk,cpuKernelImpl:Pne}),gle={kernelName:Gh,backendName:"webgl",kernelFunc:mle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pk{constructor(e,t,n){this.variableNames=["real","imag"];const a=t[1];this.outputShape=t;const o=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(a,".0"):"1.0";let c;if(e==="real")c="return real * expR - imag * expI;";else if(e==="imag")c="return real * expI + imag * expR;";else throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(c,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RD(s,e,t){const n=t.texData.get(s.dataId),a=Ae(s.shape),o=s.shape[s.shape.length-1],i=a/o,c=Ke({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),u=c.shape,h=new pk("real",u,e),p=new pk("imag",u,e),f=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:u},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:u}],g=t.runWebGLProgram(h,f,"float32"),b=t.runWebGLProgram(p,f,"float32"),y=tl({inputs:{real:g,imag:b},backend:t});t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b);const v=Ke({inputs:{x:y},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(y),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(s){const{inputs:e,backend:t}=s,{input:n}=e;return RD(n,!1,t)}const ble={kernelName:a2,backendName:"webgl",kernelFunc:xle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yle{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(s){const{backend:e,attrs:t}=s,{shape:n,value:a}=t;let{dtype:o}=t;if(o=o||Eu(a),o==="string"){const i=Ds(o,Ae(n));return i.fill(a),e.makeTensorInfo(n,o,i)}else{const i=new yle(n,a),c=[[a]];return e.runWebGLProgram(i,[],o,c)}}const vle={kernelName:r2,backendName:"webgl",kernelFunc:qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wle{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle={kernelName:o2,backendName:"webgl",kernelFunc:({inputs:s,backend:e})=>{const{image:t}=s,n=e,a=new wle(t.shape);return n.runWebGLProgram(a,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fk="return floor(x);",Sle=Gt({opSnippet:fk,packedOpSnippet:fk,cpuKernelImpl:Bne}),Cle={kernelName:Wh,backendName:"webgl",kernelFunc:Sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle="\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",jle="\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",Tle=kn({opSnippet:kle,packedOpSnippet:jle,dtype:"int32"}),Ile={kernelName:Hh,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $le{constructor(e){this.variableNames=["A"];const t=Wn(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ale{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Wn(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele={kernelName:z1,backendName:"webgl",kernelFunc:Dle};let ru,E1=Se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Dle(s){const{inputs:e,backend:t,attrs:n}=s;let{pixels:a}=e;const{numChannels:o}=n,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,c=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[u,h]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],p=[h,u],f=[h,u,o];if(c||i){const v=Se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ru==null||v!==E1)&&(E1=v,ru=document.createElement("canvas").getContext("2d",{willReadFrequently:E1})),ru.canvas.width=u,ru.canvas.height=h,ru.drawImage(a,0,0,u,h),a=ru.canvas}const g=t.makeTensorInfo(p,"int32");t.texData.get(g.dataId).usage=_a.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(g.dataId),a);const b=Se().getBool("WEBGL_PACK")?new Ale(f):new $le(f),y=t.runWebGLProgram(b,[g],"int32");return t.disposeData(g.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n,v=Go(p),w=hn(a.shape,o.shape,u,f,h,g,!1,v);let N;const C=[],I=i!=null,T=c!=null,$=b==="leakyrelu",E=()=>{const L=[a,o],O=(z,A)=>{if(A==="NCHW"&&z.shape.length===1&&z.shape[0]!==1){const U=Ke({inputs:{x:z},backend:t,attrs:{shape:[z.shape[0],1,1]}});return C.push(U),U}return z};if(I&&L.push(O(i,p)),T&&L.push(O(c,p)),$){const z=t.makeTensorInfo([],"float32",Wi(y,"float32"));L.push(z),C.push(z)}return L};if(w.filterHeight===1&&w.filterWidth===1&&w.dilationHeight===1&&w.dilationWidth===1&&w.strideHeight===1&&w.strideWidth===1&&(w.padInfo.type==="SAME"||w.padInfo.type==="VALID"))N=TD({x:a,filter:o,convInfo:w,backend:t,bias:i,activation:b,preluActivationWeights:c,leakyreluAlpha:y});else if(w.strideWidth<=2&&v==="channelsLast"&&Se().getBool("WEBGL_EXP_CONV")){const L=b?Sh(b,!0):null,O=new jD(w,I,L,T,$),z=[[w.padInfo.top,w.padInfo.left],[w.strideHeight,w.strideWidth],[w.dilationHeight,w.dilationWidth],[w.inHeight,w.inWidth]],A=E();N=t.runWebGLProgram(O,A,"float32",z)}else if(Se().getBool("WEBGL_CONV_IM2COL"))N=ID({x:a,filter:o,convInfo:w,backend:t,bias:i,activation:b,preluActivationWeights:c,leakyreluAlpha:y});else{const L=b?Sh(b,!1):null,O=new kD(w,I,L,T,$),z=E();N=t.runWebGLProgram(O,z,"float32")}const _=Ke({inputs:{x:N},backend:t,attrs:{shape:w.outShape}});return C.push(N),C.forEach(L=>t.disposeIntermediateTensorInfo(L)),_}const _le={kernelName:Dm,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dilations:p,dimRoundingMode:f,activation:g,leakyreluAlpha:b}=n,y=[];let v=p;v==null&&(v=[1,1]),V(Nn(u,v),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'"));const w=hn(a.shape,o.shape,u,v,h,f,!0),N=Se().getBool("WEBGL_PACK_DEPTHWISECONV")&&w.strideWidth<=2&&w.outChannels/w.inChannels===1,C=g?Sh(g,N):null,I=[a,o],T=i!=null,$=c!=null,E=g==="leakyrelu";if(T&&I.push(i),$&&I.push(c),E){const z=t.makeTensorInfo([],"float32",Wi(b,"float32"));I.push(z),y.push(z)}let _;N?_=new ED(w,T,C,$,E):_=new AD(w,T,C,$,E);const L=[[w.padInfo.top,w.padInfo.left],[w.strideHeight,w.strideWidth],[w.dilationHeight,w.dilationWidth],[w.inHeight,w.inWidth]],O=t.runWebGLProgram(_,I,"float32",L);return y.forEach(z=>t.disposeIntermediateTensorInfo(z)),O}const Fle={kernelName:Rm,backendName:"webgl",kernelFunc:Ole};class Lle{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;const o=ss(n.length);let i="\n    int index;";for(let c=0;c<this.sliceDim;c++)i+="\n          index = round(getIndices(coords[0], ".concat(c,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[c],";\n          flattenIndex += index * ").concat(this.strides[c],";");this.userCode="\n         void main() {\n          ".concat(o," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(s){const{inputs:e,backend:t}=s,{params:n,indices:a}=e,o=a.shape,i=o[o.length-1],c=Ae(n.shape),[u,h,p,f]=Dv(n,a),g=Ke({inputs:{x:a},backend:t,attrs:{shape:[h,i]}}),b=Ke({inputs:{x:n},backend:t,attrs:{shape:[Ae(n.shape)/p,p]}});if(t.shouldExecuteOnCPU([n,a])||n.dtype==="string"){const N=t.readSync(a.dataId),C=t.bufferSync(n),I=Vne(N,C,n.dtype,h,i,p,f,n.shape,c);return t.makeTensorInfo(u,n.dtype,I.values)}const y=new Lle(i,f,[h,p],n.shape),v=t.runWebGLProgram(y,[b,g],b.dtype),w=Ke({inputs:{x:v},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),w}const zle={kernelName:i2,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ple{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=ss(this.rank),a=Ble(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}}function Ble(s,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<s.length;a++)a===2?n.push("index"):n.push("".concat(t[a]));return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _D(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,indices:o}=e,{axis:i,batchDims:c}=n,u=At(i,a.shape)[0];if(Se().get("DEBUG")){const C=t.readSync(o.dataId),I=a.shape[u];for(let T=0;T<C.length;++T){const $=C[T];V($<=I-1&&$>=0,()=>"GatherV2: the index value ".concat($," is not in [0, ").concat(I-1,"]"))}}const h=sw(a,o,u,c),p=Ae(o.shape),f=[],g=Ke({inputs:{x:a},backend:t,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),b=Ke({inputs:{x:o},backend:t,attrs:{shape:[h.batchSize,p/h.batchSize]}});f.push(g),f.push(b);const y=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize];if(t.shouldExecuteOnCPU([a,o])||a.dtype==="string"){const C=t.bufferSync(b),I=t.bufferSync(g),T=Une(I,C,y);return f.forEach($=>t.disposeIntermediateTensorInfo($)),t.makeTensorInfo(h.outputShape,T.dtype,T.values)}const v=new Ple(g.shape,y),w=t.runWebGLProgram(v,[g,b],g.dtype);f.push(w);const N=Ke({inputs:{x:w},backend:t,attrs:{shape:h.outputShape}});return f.forEach(C=>t.disposeIntermediateTensorInfo(C)),N}const Vle={kernelName:$g,backendName:"webgl",kernelFunc:_D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule="return float(a > b);",Gle="\n  return vec4(greaterThan(a, b));\n",Wle=kn({opSnippet:Ule,packedOpSnippet:Gle,cpuKernelImpl:Gne,dtype:"bool"}),Hle={kernelName:Ag,backendName:"webgl",kernelFunc:Wle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle="return float(a >= b);",Kle="\n  return vec4(greaterThanEqual(a, b));\n",Xle=kn({opSnippet:qle,packedOpSnippet:Kle,dtype:"bool",cpuKernelImpl:Wne}),Yle={kernelName:qh,backendName:"webgl",kernelFunc:Xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(s){const{inputs:e,backend:t}=s,{input:n}=e;return RD(n,!0,t)}const Qle={kernelName:l2,backendName:"webgl",kernelFunc:Zle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle="return float(!isnan(x) && !isinf(x));",ece=Gt({opSnippet:Jle,dtype:"bool"}),tce={kernelName:Xh,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sce="return float(isinf(x));",nce=Gt({opSnippet:sce,dtype:"bool"}),ace={kernelName:Yh,backendName:"webgl",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce="return float(isnan(x));",oce=Gt({opSnippet:rce,dtype:"bool"}),ice={kernelName:Zh,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce="return float(a < b);",cce="\n  return vec4(lessThan(a, b));\n",uce=kn({opSnippet:lce,packedOpSnippet:cce,cpuKernelImpl:Hne,dtype:"bool"}),dce={kernelName:Dg,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce="return float(a <= b);",pce="\n  return vec4(lessThanEqual(a, b));\n",fce=kn({opSnippet:hce,packedOpSnippet:pce,cpuKernelImpl:qne,dtype:"bool"}),mce={kernelName:Rg,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(s){const{backend:e,attrs:t}=s,{start:n,stop:a,num:o}=t,i=Kne(n,a,o);return e.makeTensorInfo([i.length],"float32",i)}const xce={kernelName:u2,backendName:"webgl",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bce=Hu+"\n  return x < 0.0 ? 0./0. : log(x);\n",yce="\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",vce=Gt({opSnippet:bce,packedOpSnippet:yce,cpuKernelImpl:Xne}),wce={kernelName:Qh,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nce=Hu+"\n  return log(1.0 + x);\n",Sce=Gt({opSnippet:Nce}),Cce={kernelName:Jh,backendName:"webgl",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce="return float(a >= 1.0 && b >= 1.0);",jce="\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",Tce=kn({opSnippet:kce,packedOpSnippet:jce,dtype:"bool"}),Ice={kernelName:_g,backendName:"webgl",kernelFunc:Tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ce="return float(!(x >= 1.0));",Ace=Gt({opSnippet:$ce}),Ece={kernelName:Og,backendName:"webgl",kernelFunc:Ace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce="return float(a >= 1.0 || b >= 1.0);",Rce="\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",_ce=kn({opSnippet:Dce,packedOpSnippet:Rce,dtype:"bool"}),Oce={kernelName:Fg,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fce{constructor(e,t,n,a,o){this.variableNames=["x"],this.outputShape=[];const i=t,c=e[3]-1;this.outputShape=e;let u;const h="float(".concat(n,") + float(").concat(a,") * sum");o===.5?u="inversesqrt(".concat(h,")"):o===1?u="1.0/(".concat(h,")"):u="exp(log(".concat(h,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(u,";\n        setOutput(val);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lce{constructor(e,t,n,a,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,c=e[3]-1;this.outputShape=e;let u;const h="float(".concat(n,") + float(").concat(a,") * sum");o===.5?u="inversesqrt(".concat(h,")"):o===1?u="1.0/(".concat(h,")"):u="exp(log(".concat(h,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(u,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{depthRadius:o,bias:i,alpha:c,beta:u}=n,h=Se().getBool("WEBGL_PACK_NORMALIZATION")?new Lce(a.shape,o,i,c,u):new Fce(a.shape,o,i,c,u);return t.runWebGLProgram(h,[a],a.dtype)},zce={kernelName:Lg,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pce{constructor(e,t,n,a,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(o,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(o,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a,y:o,dy:i}=e,{depthRadius:c,bias:u,alpha:h,beta:p}=n,f=new Pce(a.shape,c,u,h,p);return t.runWebGLProgram(f,[a,o,i],a.dtype)},Vce={kernelName:d2,backendName:"webgl",kernelFunc:Bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(s,e,t,n){const a=Ae(e),i=Ae(s.shape)/a,c=Ke({inputs:{x:s},attrs:{shape:[i,a]},backend:n}),u=cc(c,s.dtype,"max",n),h=Ke({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OD(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reductionIndices:o,keepDims:i}=n,c=a.shape.length,u=At(o,a.shape);let h=u;const p=ws(h,c),f=p!=null,g=t.shouldExecuteOnCPU([a]);let b=a;if(f){if(g){const I=t.texData.get(b.dataId).values,T=new Array(c);for(let _=0;_<T.length;_++)T[_]=a.shape[p[_]];const $=zw(I,a.shape,a.dtype,p,T);b=t.makeTensorInfo(T,a.dtype);const E=t.texData.get(b.dataId);E.values=$}else b=Jx(a,p,t);h=_s(h.length,c)}Sn("max",h,c);const[y,v]=pn(b.shape,h);let w=y;i&&(w=Rs(y,u));let N;if(g){const I=t.texData.get(b.dataId).values,T=Yne(I,Ae(v),w,a.dtype);N=t.makeTensorInfo(w,a.dtype);const $=t.texData.get(N.dataId);$.values=T}else N=Uce(b,v,w,t);return f&&t.disposeIntermediateTensorInfo(b),N}const Gce={kernelName:Mg,backendName:"webgl",kernelFunc:OD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wce=Pw+"\n  return max(a, b);\n",Hce="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",qce=kn({opSnippet:Wce,packedOpSnippet:Hce,cpuKernelImpl:Zne}),Kce={kernelName:ep,backendName:"webgl",kernelFunc:qce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;Gp(a,"maxPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(Nn(i,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=dr(a.shape,o,i,h,c,u);if(p.filterWidth===1&&p.filterHeight===1&&Mt(p.inShape,p.outShape))return Na({inputs:{x:a},backend:t});const f=new Ch(p,"max",!1);return t.runWebGLProgram(f,[a],a.dtype)}const Yce={kernelName:zg,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dataFormat:u,dimRoundingMode:h}=n,p=[1,1,1],f=Uo(a.shape,o,i,p,c,h,u),g=new Vw(f,"max",!1);return t.runWebGLProgram(g,[a],a.dtype)}const Qce={kernelName:Pg,backendName:"webgl",kernelFunc:Zce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jce{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=i-1-e.padInfo.left,h=o*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(h," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class eue{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=u-1-e.padInfo.front,g=h-1-e.padInfo.top,b=p-1-e.padInfo.left,y=u*h*p-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(g,", ").concat(b,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(y," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(h," * ").concat(p," +\n                  wR * ").concat(p," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o,{filterSize:c,strides:u,pad:h,dimRoundingMode:p}=n,f=[1,1,1],g=Uo(i.shape,c,u,f,h,p),b=new Vw(g,"max",!0),y=t.runWebGLProgram(b,[i],i.dtype),v=new eue(g),w=t.runWebGLProgram(v,[a,y],i.dtype);return t.disposeIntermediateTensorInfo(y),w}const sue={kernelName:p2,backendName:"webgl",kernelFunc:tue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o,output:i}=e,c=o;Gp([o,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:p,dimRoundingMode:f}=n,g=dr(c.shape,u,h,1,p,f),b=!0,y=new Ch(g,"max",b),v=t.runWebGLProgram(y,[c],c.dtype),w=new Jce(g),N=t.runWebGLProgram(w,[a,v],c.dtype);return t.disposeIntermediateTensorInfo(v),N}const aue={kernelName:h2,backendName:"webgl",kernelFunc:nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(s,e,t,n){let a=new Ch(t,"max",!1);const o=n.runWebGLProgram(a,[s],"float32");a=new Ch(t,"max",!0,!0,e);const i=n.runWebGLProgram(a,[s],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue={kernelName:f2,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{filterSize:a,strides:o,pad:i,includeBatchInIndex:c}=e,u=t;V(n.shape.length===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(n.shape.length,"."));const h=[1,1];V(Nn(o,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(h,"'"));const p=dr(n.shape,a,o,h,i),[f,g]=rue(n,c,p,u);return[f,g]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(s,e,t,n){const a=Ae(e),i=Ae(s.shape)/a,c=Ke({inputs:{x:s},attrs:{shape:[i,a]},backend:n}),u=cc(c,"float32","mean",n),h=Ke({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue={kernelName:Bg,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{keepDims:a,axis:o}=e,i=t,c=n.shape.length,u=At(o,n.shape);let h=u;const p=ws(h,c),f=p!=null,g=i.shouldExecuteOnCPU([n]),b=[];let y=n;if(f){if(g){const T=i.texData.get(y.dataId).values,$=new Array(c);for(let L=0;L<$.length;L++)$[L]=n.shape[p[L]];const E=zw(T,n.shape,n.dtype,p,$);y=i.makeTensorInfo($,n.dtype);const _=i.texData.get(y.dataId);_.values=E}else y=Jx(n,p,i);b.push(y),h=_s(h.length,c)}Sn("sum",h,c);const[v,w]=pn(y.shape,h);let N=v;a&&(N=Rs(v,u));const C=iue(y,w,N,i);for(const I of b)i.disposeIntermediateTensorInfo(I);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=At(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Vn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=_s(h.length,a.shape.length)),Sn("min",h,c);const[g,b]=pn(f.shape,h),y=Ae(b),v=Ke({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),w=cc(v,v.dtype,"min",t);let N;if(i){const C=Rs(g,u);N=Ke({inputs:{x:w},backend:t,attrs:{shape:C}})}else N=Ke({inputs:{x:w},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),p!=null&&t.disposeIntermediateTensorInfo(f),N}const uue={kernelName:Vg,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const due=Pw+"\n  return min(a, b);\n",hue="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",pue=kn({opSnippet:due,packedOpSnippet:hue,cpuKernelImpl:Qne}),fue={kernelName:tp,backendName:"webgl",kernelFunc:pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mue{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((p,f)=>p[0]+e[f]+p[1]);const a=e.length,o=ss(a),i=t.map(p=>p[0]).join(","),c=t.map((p,f)=>p[0]+e[f]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),h=n==="reflect"?0:1;if(a===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(h,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(h,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ");return}this.userCode="\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(h,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(h,";\n          }\n        }\n        ").concat(o," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gue{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,v)=>y[0]+e[v]+y[1]);const a=e.length,o=ss(a),i=t.map(y=>y[0]).join(","),c=t.map((y,v)=>y[0]+e[v]).join(","),u=Pn("rc",a),h=Pn("source",a),p="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=a===1?"source":"vec2(".concat(h.slice(-2).join(),")"),g=n==="reflect"?0:1;let b="";if(a===1){const y="\n        ".concat(o," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(g,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(g,";\n        }\n        source -= start;\n      ");b="\n        ".concat(o," rc = outputLoc;\n        ").concat(y,"\n        result[0] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(p,") {\n          ").concat(y,"\n          result[1] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n      ")}else{const y="\n        ".concat(o," source = rc;\n        ").concat(o," lt = ").concat(o,"(lessThan(source, start));\n        ").concat(o," gte = ").concat(o,"(greaterThanEqual(source, end));\n        ").concat(o," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(g,") +\n                gte * ((end - 1) * 2 - source + ").concat(g,");\n        source -= start;\n      ");b="\n        ".concat(o," rc = outputLoc;\n        ").concat(y,"\n        result[0] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(p,") {\n          ").concat(y,"\n          result[1] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(y,"\n          result[2] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(p,") {\n            ").concat(y,"\n            result[3] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue=({inputs:s,backend:e,attrs:t})=>{const{x:n}=s,{paddings:a,mode:o}=t,i=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gue(n.shape,a,o):new mue(n.shape,a,o);return e.runWebGLProgram(i,[n],n.dtype)},bue={kernelName:Ug,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue="if (b == 0.0) return NAN;\n  return mod(a, b);",vue="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+lc+"\n  return result;\n",wue=kn({opSnippet:yue,packedOpSnippet:vue}),Nue={kernelName:sp,backendName:"webgl",kernelFunc:wue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sue{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",kue="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",FD=kn({opSnippet:Cue,packedOpSnippet:kue,checkOutOfBounds:!0}),jue={kernelName:Ph,backendName:"webgl",kernelFunc:FD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mk="return a - b;",LD=kn({opSnippet:mk,packedOpSnippet:mk,supportsComplex:!0,cpuKernelImpl:yae}),Tue={kernelName:bp,backendName:"webgl",kernelFunc:LD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MD(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{dim:o}=n,i=At([o],a.shape),c=OD({inputs:{x:a},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),u=Rs(c.shape,i),h=Ke({inputs:{x:c},backend:t,attrs:{shape:u}}),p=LD({inputs:{a,b:h},backend:t}),f=DD({inputs:{x:p},backend:t}),g=e0({inputs:{x:f},backend:t,attrs:{axis:i,keepDims:!1}}),b=Ke({inputs:{x:g},backend:t,attrs:{shape:u}}),y=FD({inputs:{a:f,b},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),y}const Iue={kernelName:ix,backendName:"webgl",kernelFunc:MD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{numSamples:o,seed:i,normalized:c}=n,u=c?a:MD({inputs:{logits:a},backend:t,attrs:{dim:a.shape.length-1}}),h=u.shape[0],p=u.shape[1],f=new Sue(h,p,o),g=[[i]],b=t.runWebGLProgram(f,[u],"int32",g);return c||t.disposeIntermediateTensorInfo(u),b}const Aue={kernelName:m2,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue=pr+"\n  return -x;\n",Due="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";function Rue(s){const{inputs:e,backend:t}=s,{x:n}=e;if(t.shouldExecuteOnCPU([n])){const o=t.texData.get(n.dataId),[i,c]=eae(o.values,n.shape,n.dtype);return t.makeTensorInfo(c,n.dtype,i)}let a;return Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ii(n.shape,Due):a=new Yr(n.shape,Eue),t.runWebGLProgram(a,[n],n.dtype)}const _ue={kernelName:Gg,backendName:"webgl",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue=kv;function Fue(s){Da("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u}=n,h=t.readSync(a.dataId),p=t.readSync(o.dataId),{selectedIndices:f}=Oue(h,p,i,c,u);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Lue={kernelName:g2,backendName:"webgl",kernelFunc:Fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue=jv;function zue(s){Da("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,padToMaxOutputSize:h}=n,p=t.readSync(a.dataId),f=t.readSync(o.dataId),{selectedIndices:g,validOutputs:b}=Mue(p,f,i,c,u,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([],"int32",new Int32Array([b]))]}const Pue={kernelName:x2,backendName:"webgl",kernelFunc:zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue=Tv;function Vue(s){Da("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,softNmsSigma:h}=n,p=t.readSync(a.dataId),f=t.readSync(o.dataId),g=i,b=c,y=u,v=h,{selectedIndices:w,selectedScores:N}=Bue(p,f,g,b,y,v);return[t.makeTensorInfo([w.length],"int32",new Int32Array(w)),t.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const Uue={kernelName:b2,backendName:"webgl",kernelFunc:Vue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gue{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wue=s=>{const{inputs:e,backend:t,attrs:n}=s,{indices:a}=e,{dtype:o,depth:i,onValue:c,offValue:u}=n,h=Ae(a.shape),p=new Gue(h,i,c,u),f=Ke({inputs:{x:a},backend:t,attrs:{shape:[h]}}),g=t.runWebGLProgram(p,[f],o);t.disposeIntermediateTensorInfo(f);const b=[...a.shape,i],y=Ke({inputs:{x:g},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(g),y},Hue={kernelName:qg,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="complex64"){const a=Hp({inputs:{input:n},backend:t}),o=rg({inputs:{x:a},backend:t}),i=t0({inputs:{input:n},backend:t}),c=rg({inputs:{x:i},backend:t}),u=tl({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return qp({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:t})}const que={kernelName:dx,backendName:"webgl",kernelFunc:rg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zD(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){const a=Hp({inputs:{input:n},backend:t}),o=zD({inputs:{x:a},backend:t}),i=t0({inputs:{input:n},backend:t}),c=rg({inputs:{x:i},backend:t}),u=tl({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return qp({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:t})}const Kue={kernelName:Hg,backendName:"webgl",kernelFunc:zD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n;if(e.length===1)return Ay({inputs:{input:e[0]},backend:t,attrs:{dim:a}});const o=e[0].shape,i=e[0].dtype;e.forEach(p=>{Sa(o,p.shape,"All tensors passed to stack must have matching shapes"),V(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});const c=[],u=e.map(p=>{const f=Ay({inputs:{input:p},backend:t,attrs:{dim:a}});return c.push(f),f}),h=CD({inputs:u,backend:t,attrs:{axis:a}});return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const Yue={kernelName:Kg,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zue{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((h,p)=>h[0]+e[p]+h[1]);const a=e.length,o=ss(a),i=t.map(h=>h[0]).join(","),c=t.map((h,p)=>h[0]+e[p]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ");return}this.userCode="\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(o," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Que{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((v,w)=>v[0]+e[w]+v[1]);const a=e.length,o=ss(a),i=t.map(v=>v[0]).join(","),c=t.map((v,w)=>v[0]+e[w]).join(","),u=Pn("rc",a),h=Pn("source",a),p="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=a===1?"source":"vec2(".concat(h.slice(-2).join(),")"),g=["".concat(o," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(p,") {\n      "),a===1?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),a===1?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(p,") {")],b=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let v=0,w=a===1?2:4;v<w;v++)y+="\n        ".concat(g[v],"\n        if (").concat(b,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n      ");y+=a===1?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PD=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,constantValue:i}=n;if(Ae(a.shape)===0){const h=o.map((p,f)=>p[0]+a.shape[f]+p[1]);return qp({backend:t,attrs:{shape:h,value:i,dtype:a.dtype}})}const c=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Que(a.shape,o,i):new Zue(a.shape,o,i),u=[[i]];return t.runWebGLProgram(c,[a],a.dtype,u)},Jue={kernelName:Xg,backendName:"webgl",kernelFunc:PD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede="\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",tde="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+lc+"\n  return result;\n",sde=kn({opSnippet:ede,packedOpSnippet:tde}),nde={kernelName:ap,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=[],h=At(o,a.shape);let p=h;const f=ws(p,c);let g=a;f!=null&&(g=Vn({inputs:{x:a},backend:t,attrs:{perm:f}}),p=_s(p.length,c),u.push(g)),Sn("prod",p,c);let b;if(t.shouldExecuteOnCPU([g])){const y=t.texData.get(g.dataId).values,{outVals:v,outShape:w,outDtype:N}=sae(g.shape,g.dtype,y,p);b=t.makeTensorInfo(w,N,v)}else{const[y,v]=pn(g.shape,p),w=Ae(v),N=Ke({inputs:{x:g},backend:t,attrs:{shape:[-1,w]}}),C=U2(a.dtype),I=cc(N,C,"prod",t);b=Ke({inputs:{x:I},backend:t,attrs:{shape:y}}),u.push(N),u.push(I)}if(i){u.push(b);const y=Rs(b.shape,h);b=Ke({inputs:{x:b},backend:t,attrs:{shape:y}})}return u.forEach(y=>t.disposeIntermediateTensorInfo(y)),b}const rde={kernelName:Zg,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(s){const{inputs:e,backend:t,attrs:n}=s,{paramsNestedSplits:a,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:c}=n,u=a.map(N=>t.readSync(N.dataId)),h=a.map(N=>N.shape),p=t.readSync(o.dataId),f=t.readSync(i.dataId),[g,b,y]=nae(u,h,p,o.shape,o.dtype,f,i.shape,c),v=g.map(N=>t.makeTensorInfo([N.length],"int32",N)),w=t.makeTensorInfo(y,o.dtype,b);return v.concat([w])}const ide={kernelName:y2,backendName:"webgl",kernelFunc:ode};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(s){const{inputs:e,backend:t}=s,{starts:n,limits:a,deltas:o}=e,i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=aae(i,n.shape,n.dtype,c,a.shape,u,o.shape),f=t.makeTensorInfo([h.length],"int32",h),g=t.makeTensorInfo([p.length],n.dtype,p);return[f,g]}const cde={kernelName:v2,backendName:"webgl",kernelFunc:lde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(s){const{inputs:e,backend:t,attrs:n}=s,{shape:a,values:o,defaultValue:i,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=n,h=t.readSync(a.dataId),p=t.readSync(o.dataId),f=t.readSync(i.dataId),g=c.map(w=>t.readSync(w.dataId)),b=c.map(w=>w.shape),[y,v]=rae(h,a.shape,p,o.shape,o.dtype,f,i.shape,g,b,u);return t.makeTensorInfo(y,o.dtype,v)}const dde={kernelName:w2,backendName:"webgl",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BD=s=>{const{backend:e,attrs:t}=s,{start:n,stop:a,step:o,dtype:i}=t,c=oae(n,a,o,i);return e.makeTensorInfo([c.length],i,c)},hde={kernelName:N2,backendName:"webgl",kernelFunc:BD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde="return 1.0 / x;",fde=Gt({opSnippet:pde}),mde={kernelName:rp,backendName:"webgl",kernelFunc:fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde=pr+"\n  return (x < 0.0) ? 0.0 : x;\n",xde="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",bde=Gt({opSnippet:gde,packedOpSnippet:xde}),yde={kernelName:op,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vde=pr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",wde="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Nde=Gt({opSnippet:vde,packedOpSnippet:wde}),Sde={kernelName:ip,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cde{constructor(e,t,n,a,o){this.variableNames=["A"],this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n];let g;o?g="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(g,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kde{constructor(e,t,n,a,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n];let g;o?g="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(g,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n,[u,h]=c,p=Se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kde(a.shape,u,h,o,i):new Cde(a.shape,u,h,o,i);return t.runWebGLProgram(p,[a],"float32")}const Tde={kernelName:ex,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ide{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,o]=t,[,i,c]=e,u=[n&&i>1?a-1:a,n&&c>1?o-1:o],h=[n&&i>1?i-1:i,n&&c>1?c-1:c],p=u[0]/h[0],f=u[1]/h[1],g=1/p,b=1/f,y=Math.ceil(g)*2+2,v=Math.ceil(b)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(b,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(v,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n,c=new Ide(o.shape,a.shape,i);return t.runWebGLProgram(c,[o],o.dtype)}const Ade={kernelName:k2,backendName:"webgl",kernelFunc:$de};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ede{constructor(e,t,n,a,o){this.variableNames=["A"],this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n],g=a?"0.5":"0.0";let b;o?b="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":b="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(b,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dde{constructor(e,t,n,a,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n],g=a?"0.5":"0.0";let b;o?b="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":b="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(b,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n,[u,h]=c,p=Se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Dde(a.shape,u,h,o,i):new Ede(a.shape,u,h,o,i);return t.runWebGLProgram(p,[a],a.dtype)}const _de={kernelName:Jg,backendName:"webgl",kernelFunc:Rde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ode{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,o]=t,[,i,c]=e,u=[n&&i>1?a-1:a,n&&c>1?o-1:o],h=[n&&i>1?i-1:i,n&&c>1?c-1:c],p=u[0]/h[0],f=u[1]/h[1],g=1/p,b=1/f,y=Math.ceil(g)*2+2,v=Math.ceil(b)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(b,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(v,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(u[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(u[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n,c=new Ode(o.shape,a.shape,i);return t.runWebGLProgram(c,[o],o.dtype)}const Lde={kernelName:C2,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mde{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,n===1){this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ");return}const a=c=>t.indexOf(c)!==-1&&e[c]!==1?"".concat(e[c]," - coords[").concat(c,"] - 1"):"coords[".concat(c,"]"),o=e.map((c,u)=>a(u)).join(","),i=ss(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zde{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const a=Pn("rc",n),o="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),c=ss(n);n===1?this.userCode="\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):this.userCode="\n        void main() {\n          ".concat(c," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(u(a.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(h(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(p(a.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(f(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ");function u(y){return g(y)}function h(y){return y[n-1]="("+y[n-1]+" + 1)",g(y)}function p(y){return y[n-2]="("+y[n-2]+" + 1)",g(y)}function f(y){return y[n-1]="("+y[n-1]+" + 1)",y[n-2]="("+y[n-2]+" + 1)",g(y)}function g(y){const v=e.map((C,I)=>b(I,y)),w=v.join(","),N=v.slice(-2).join(",");return"getChannel(getX(".concat(w,"), vec2(").concat(N,"))")}function b(y,v){return t.indexOf(y)!==-1&&e[y]!==1?"".concat(e[y]," - ").concat(v[y]," - 1"):"".concat(v[y])}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dims:o}=n,i=a.shape.length,c=At(o,a.shape);if(i===0)return Na({inputs:{x:a},backend:t});const u=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zde(a.shape,c):new Mde(a.shape,c);return t.runWebGLProgram(u,[a],a.dtype)}const Bde={kernelName:tx,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vde{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],a=e[2];this.outputShape=e;let o="";typeof t=="number"?o="float outputValue = ".concat(t.toFixed(2),";"):o="\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(o,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude={kernelName:V2,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,{radians:a,fillValue:o,center:i}=e,c=t,u=new Vde(n.shape,o),[h,p]=Pv(i,n.shape[1],n.shape[2]),f=[[h,p,Math.sin(a),Math.cos(a)]];return c.runWebGLProgram(u,[n],n.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gde="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",Wde=Gt({opSnippet:Gde}),Hde={kernelName:lp,backendName:"webgl",kernelFunc:Wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde="return inversesqrt(x);",Kde=Gt({opSnippet:qde,cpuKernelImpl:iae}),Xde={kernelName:cp,backendName:"webgl",kernelFunc:Kde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uw{constructor(e,t,n,a,o,i,c=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const h=ss(o.length),p=ss(i.length);let f="";n===1?f="i":n===2&&(f="i, j");const g="getIndices(".concat(f,")");let b="";a===1?b="i":a===2&&(b="i, coords[1]");const y="getUpdates(".concat(b,")");let v="";u&&(v="coords[0], coords[1]");const w="getDefaultValue(".concat(v,")"),N=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(h," strides = ").concat(h,"(").concat(o,");\n\n        void main() {\n          ").concat(p," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(g,");\n              flattenedIndex += index * ").concat(N,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(y,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(w,", sum, float(found)));\n        }\n      ")}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yde{constructor(e,t,n,a,o,i,c=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const h=ss(o.length),p=ss(i.length);let f="";n===1?f="i":n===2&&(f="i, j");const g="getIndices(".concat(f,")");let b="";a===1?b="i":a===2&&(b="i, coords[1]");const y="getUpdates(".concat(b,")");let v="";u&&(v="coords[0], coords[1]");const w="getDefaultValue(".concat(v,")"),N=t>1?"strides[j]":"strides",C=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(h," strides = ").concat(h,"(").concat(o,");\n\n        void main() {\n          ").concat(p," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(g,");\n              flattenedIndex += index.xz * ").concat(N,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(C,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(y,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(w,", sum, found));\n        }\n      ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a,updates:o}=e,{shape:i}=n,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(o,a,i),g=[f/h,h];if(f===0)return t.makeTensorInfo(i,a.dtype);const b=Ke({inputs:{x:a},backend:t,attrs:{shape:[u,c]}}),y=Ke({inputs:{x:o},backend:t,attrs:{shape:[u,h]}}),v=t.makeTensorInfo([],"float32",new Float32Array([0]));let w;Se().getBool("WEBGL_PACK")?w=new Yde(u,c,b.shape.length,y.shape.length,p,g):w=new Uw(u,c,b.shape.length,y.shape.length,p,g);const N=t.runWebGLProgram(w,[y,b,v],y.dtype),C=Ke({inputs:{x:N},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(v),C}const Qde={kernelName:j2,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const o="while (left < right) {",i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),c=Se().getNumber("WEBGL_VERSION")===2?o:i,u=a==="left"?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(c,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(u," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(s){const{inputs:e,backend:t,attrs:n}=s,{sortedSequence:a,values:o}=e,{side:i}=n,c=new Jde(a.shape[0],a.shape[1],o.shape[1],i),u=[[a.shape[1]]];return t.runWebGLProgram(c,[a,o],"int32",u)}const the={kernelName:I2,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class she{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let a,o;if(n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(n===1)o="resRC",a="resRC";else{const c=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],h=[];for(let p=0;p<t.length;p++)h.push("".concat(c[p])),p<e&&u.push("".concat(c[p]));a=u.join(),o=h.join()}const i=ss(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(o,"));\n        } else {\n          setOutput(getB(").concat(o,"));\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(s){const{inputs:e,backend:t}=s,{condition:n,t:a,e:o}=e,i=new she(n.shape.length,a.shape,a.shape.length);return t.runWebGLProgram(i,[n,a,o],ya(a.dtype,o.dtype))}const ahe={kernelName:sx,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rhe="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Lx,";\n  float scale = ").concat(Mx,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),ohe=Gt({opSnippet:rhe}),ihe={kernelName:up,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=Hu+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",che="\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",uhe=Gt({opSnippet:lhe,packedOpSnippet:che,cpuKernelImpl:cae}),dhe={kernelName:fp,backendName:"webgl",kernelFunc:uhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hhe="\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n",phe=Gt({opSnippet:hhe}),fhe={kernelName:pp,backendName:"webgl",kernelFunc:phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe=Hu+"\n  return sin(x);\n",ghe="\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(lc,"\n  return result;\n"),xhe=Gt({opSnippet:mhe,packedOpSnippet:ghe}),bhe={kernelName:dp,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",vhe=Gt({opSnippet:yhe}),whe={kernelName:hp,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",She=Gt({opSnippet:Nhe}),Che={kernelName:mp,backendName:"webgl",kernelFunc:She};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,paddings:i}=n;V(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const c=o.reduce((N,C)=>N*C),u=[[0,0]];u.push(...i);for(let N=1+o.length;N<a.shape.length;++N)u.push([0,0]);const h=[],p=PD({inputs:{x:a},backend:t,attrs:{paddings:u,constantValue:0}}),f=Ep(p.shape,o,c,!1),g=Dp(f.length,o.length,!1),b=Rp(p.shape,o,c,!1),y=Ke({inputs:{x:p},backend:t,attrs:{shape:f}}),v=Vn({inputs:{x:y},backend:t,attrs:{perm:g}}),w=Ke({inputs:{x:v},backend:t,attrs:{shape:b}});return h.push(p),h.push(y),h.push(v),h.forEach(N=>t.disposeIntermediateTensorInfo(N)),w},jhe={kernelName:rx,backendName:"webgl",kernelFunc:khe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(s){const{inputs:e,backend:t}=s,{indices:n,values:a,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(n.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n         ".concat(n.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(i.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const c=t.readSync(n.dataId),u=t.readSync(a.dataId),h=t.readSync(o.dataId),p=t.readSync(i.dataId)[0],[f,g,b,y,v]=dae(c,n.shape,n.dtype,u,a.dtype,h,p);return[t.makeTensorInfo(g,n.dtype,f),t.makeTensorInfo([g[0]],a.dtype,b),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(w=>Number(w)))),t.makeTensorInfo([v.length],n.dtype,new Int32Array(v))]}const Ihe={kernelName:$2,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(s){const{inputs:e,backend:t}=s,{inputIndices:n,inputShape:a,newShape:o}=e;if(n.shape.length!==2)throw new Error("Input indices should be a matrix but received shape ".concat(n.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(o.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const i=Array.from(t.readSync(a.dataId)),c=t.readSync(n.dataId),u=Array.from(t.readSync(o.dataId)),[h,p,f]=hae(c,n.shape,n.dtype,i,u);return[t.makeTensorInfo(p,n.dtype,h),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const Ahe={kernelName:A2,backendName:"webgl",kernelFunc:$he};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ehe(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));const i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=dD(i,n.shape,n.dtype,c,u,!0);return t.makeTensorInfo(p,n.dtype,h)}const Dhe={kernelName:E2,backendName:"webgl",kernelFunc:Ehe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));const i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=dD(i,n.shape,n.dtype,c,u);return t.makeTensorInfo(p,n.dtype,h)}const _he={kernelName:D2,backendName:"webgl",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(s){const{inputs:e,backend:t,attrs:n}=s,{sparseIndices:a,sparseValues:o,defaultValue:i}=e,{outputShape:c}=n,{sliceRank:u,numUpdates:h,sliceSize:p,strides:f,outputSize:g}=nc(o,a,c),b=!1;if(o.dtype==="string"){const N=t.bufferSync(a),C=t.bufferSync(o),I=Ri(t.readSync(i.dataId)[0]),T=lae(N,C,c,g,p,h,u,f,I,b);return t.makeTensorInfo(c,T.dtype,T.values)}const y=new Uw(h,u,a.shape.length,o.shape.length,f,[g,1],b),v=t.runWebGLProgram(y,[o,a,i],o.dtype),w=Ke({inputs:{x:v},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(v),w}const Fhe={kernelName:R2,backendName:"webgl",kernelFunc:Ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{numOrSizeSplits:o,axis:i}=n,c=At(i,a.shape)[0],u=tw(a,o,c),h=a.shape.length,p=new Array(h).fill(0),f=a.shape.slice();return u.map(g=>{const b=[...f];b[c]=g;const y=qu({inputs:{x:a},backend:t,attrs:{begin:p,size:b}});return p[c]+=g,y})}const Mhe={kernelName:ox,backendName:"webgl",kernelFunc:Lhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gk="return sqrt(x);",zhe=Gt({opSnippet:gk,packedOpSnippet:gk,cpuKernelImpl:pae}),Phe={kernelName:gp,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe="return x * x;",Vhe=Gt({opSnippet:Bhe}),Uhe={kernelName:_2,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xk="return (a - b) * (a - b);",Ghe=kn({opSnippet:xk,packedOpSnippet:xk}),Whe={kernelName:xp,backendName:"webgl",kernelFunc:Ghe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const o=t.readSync(a.dataId),i=Mo(o),c=fae(i,"string",n);return t.makeTensorInfo(a.shape,"string",c)}const qhe={kernelName:lx,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe({inputs:s,attrs:e,backend:t}){const{x:n}=s,a=pr+"\n    return x > 0.0 ? 1.0 : float(".concat(e.alpha,");\n  "),o=new Yr(n.shape,a);return t.runWebGLProgram(o,[n],n.dtype)}const Xhe={kernelName:Np,backendName:"webgl",kernelFunc:Khe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yhe{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const a=n.length,o=ss(n.length),i=ss(n.length);let c="";if(a===1)c="coords * strides + begin";else{let u=0;c=n.map((h,p)=>(u++,n.length===1?"coords * strides[".concat(p,"] + begin[").concat(p,"]"):"coords[".concat(u-1,"] * strides[").concat(p,"] + begin[").concat(p,"]"))).join(",")}this.userCode="\n      ".concat(o," begin = ").concat(o,"(").concat(e,");\n      ").concat(o," strides = ").concat(o,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(c,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,end:i,strides:c,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:g}=n,{finalShapeSparse:b,finalShape:y,isIdentity:v,sliceDim0:w,isSimpleSlice:N,begin:C,end:I,strides:T}=Lv(a.shape,o,i,c,u,h,p,f,g);let $;if(v)$=Ke({inputs:{x:a},backend:t,attrs:{shape:y}});else if(w||N){V(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const _=_v(C,I,T),L=qu({inputs:{x:a},backend:t,attrs:{begin:C,size:_}});$=Ke({inputs:{x:L},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(L)}else if(t.shouldExecuteOnCPU([a])){const L=t.readSync(a.dataId),O=$t(a.shape,a.dtype,L),z=mae(b,O,T,C);$=t.makeTensorInfo(y,a.dtype,z.values)}else{const L=new Yhe(C,T,b);$=t.runWebGLProgram(L,[a],a.dtype)}const E=Ke({inputs:{x:$},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo($),E}const Qhe={kernelName:O2,backendName:"webgl",kernelFunc:Zhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(s){const{inputs:e,backend:t,attrs:n}=s,{separator:a,nGramWidths:o,leftPad:i,rightPad:c,padWidth:u,preserveShortSequences:h}=n,{data:p,dataSplits:f}=e,g=t.readSync(p.dataId),b=t.readSync(f.dataId),[y,v]=gae(g,b,a,o,i,c,u,h);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",v)]}const epe={kernelName:F2,backendName:"webgl",kernelFunc:Jhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(s){const{inputs:e,backend:t,attrs:n}=s,{skipEmpty:a}=n,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(i.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const c=t.readSync(o.dataId),u=t.readSync(i.dataId)[0],[h,p,f]=xae(c,u,a),g=p.length;return[t.makeTensorInfo([g,2],"int32",h),t.makeTensorInfo([g],"string",p),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const spe={kernelName:L2,backendName:"webgl",kernelFunc:tpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe(s){const{inputs:e,backend:t,attrs:n}=s,{numBuckets:a}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(o.dataId),c=bae(i,a);return t.makeTensorInfo(o.shape,"int32",c)}const ape={kernelName:M2,backendName:"webgl",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe="return tan(x);",ope=Gt({opSnippet:rpe}),ipe={kernelName:yp,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",cpe=Gt({opSnippet:lpe}),upe={kernelName:vp,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(s){const{inputs:e,backend:t,attrs:n}=s,{tensor:a,indices:o,updates:i}=e,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(i,o,a.shape),g=[f/h,h];if(f===0)return t.makeTensorInfo(a.shape,o.dtype);const b=Ke({inputs:{x:o},backend:t,attrs:{shape:[u,c]}}),y=Ke({inputs:{x:i},backend:t,attrs:{shape:[u,h]}}),v=Ke({inputs:{x:a},backend:t,attrs:{shape:g}}),w=new Uw(u,c,b.shape.length,y.shape.length,p,g,!1,!0),N=t.runWebGLProgram(w,[y,b,v],v.dtype),C=Ke({inputs:{x:N},backend:t,attrs:{shape:a.shape}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(N),C}const hpe={kernelName:T2,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ppe{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;const a=ss(this.rank),o=fpe(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}}function fpe(s){const e=s.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(e===1)return"imod(resRC, ".concat(s[0],")");const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let a=0;a<s.length;a++)n.push("imod(".concat(t[a],", ").concat(s[a],")"));return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VD(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reps:o}=n;if(a.dtype==="string"||a.shape.length>5){const u=t.readSync(a.dataId),h=a.dtype==="string"?u.map(g=>Ri(g)):u,p=$t(a.shape,a.dtype,h),f=vae(p,o);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const i=new ppe(a.shape,o);return t.runWebGLProgram(i,[a],a.dtype)}const mpe={kernelName:wp,backendName:"webgl",kernelFunc:VD};class gpe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class xpe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(s,e){e!==null&&s.disposeIntermediateTensorInfo(e)}function bk(s){let e=1;for(;e<s;)e*=2;return e}function bpe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{k:o,sorted:i}=n,c=Se().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=Se().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),h=a.shape,p=h[h.length-1];if(t.shouldExecuteOnCPU([a])||p<c||o>u){const z=t.readSync(a.dataId),[A,U]=wae(z,h,a.dtype,o,i);return[t.makeTensorInfo(A.shape,A.dtype,A.values),t.makeTensorInfo(U.shape,U.dtype,U.values)]}if(o===0)return h[h.length-1]=0,[t.makeTensorInfo(h,a.dtype,[]),t.makeTensorInfo(h,"int32",[])];if(p===1)return[a,qp({attrs:{shape:h,dtype:"int32",value:0},backend:t})];const f=t.texData.get(a.dataId),g=f!==null&&f.isPacked,b=g?t.unpackTensor(a):a,v=Ae(h)/p,w=Ke({inputs:{x:b},attrs:{shape:[v,p]},backend:t});g&&Tl(t,b);const N=bk(o),C=bk(p);let I=null;const T=()=>I===null?[w,w]:[w,I],$=(z,A,U)=>{const X=T(),Z=new gpe(U),B=[[p],[I===null?1:0],[Number.NEGATIVE_INFINITY],[z],[A]],K=I;I=t.runWebGLProgram(Z,X,"int32",B),Tl(t,K)};for(let z=1;z<N;z*=2){const A=z*2;for(let U=z;U>=1;U/=2)$(A,U,[v,C])}for(let z=C;z>N;z/=2){const A=T(),U=new xpe([v,z/2]),Z=[[p],[I===null?1:0],[N]],q=I;I=t.runWebGLProgram(U,A,"int32",Z),Tl(t,q);const B=N/2,K=B*2;for(let J=B;J>=1;J/=2)$(K,J,I.shape)}let E=I;I=qu({inputs:{x:I},backend:t,attrs:{begin:0,size:[v,o]}}),Tl(t,E);let _=_D({inputs:{x:w,indices:I},backend:t,attrs:{axis:1,batchDims:1}});Tl(t,w);const L=h.slice(0,-1);L.push(o),E=I,I=Ke({inputs:{x:I},attrs:{shape:L},backend:t}),Tl(t,E);const O=_;return _=Ke({inputs:{x:_},attrs:{shape:L},backend:t}),Tl(t,O),[_,I]}const ype={kernelName:z2,backendName:"webgl",kernelFunc:bpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vpe{constructor(e,t,n,a,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const c=n==="nearest"?1:2;let u;switch(a){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(u," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(o,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(o,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(c," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wpe(s){const{inputs:e,backend:t,attrs:n}=s,{image:a,transforms:o}=e,{interpolation:i,fillMode:c,fillValue:u,outputShape:h}=n,[p,f,g,b]=a.shape,[y,v]=h!=null?h:[f,g],w=[p,y,v,b],N=new vpe(f,g,i,c,u,w);return t.runWebGLProgram(N,[a,o],"float32")}const Npe={kernelName:P2,backendName:"webgl",kernelFunc:wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(s){const{inputs:e,attrs:t,backend:n}=s,{axis:a}=t,{x:o}=e;Gp(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=n.readSync(o.dataId),{outputValues:c,outputShape:u,indices:h}=Nae(i,a,o.shape,o.dtype);return[n.makeTensorInfo(u,o.dtype,c),n.makeTensorInfo([h.length],"int32",h)]}const Cpe={kernelName:B2,backendName:"webgl",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(s){const{inputs:e,backend:t,attrs:n}=s,{value:a}=e;let{axis:o}=n;o<0&&(o+=a.shape.length);const i=a,c=i.shape.length,u=a.shape[o],h=new Array(c-1);let p=0;for(let v=0;v<c;v++)v!==o&&(h[p++]=i.shape[v]);const f=[],g=new Array(c).fill(0),b=i.shape.slice();b[o]=1;const y=new Array(u);for(let v=0;v<y.length;v++){g[o]=v;const w=qu({inputs:{x:i},backend:t,attrs:{begin:g,size:b}}),N=Ke({inputs:{x:w},backend:t,attrs:{shape:h}});y[v]=N,f.push(w)}return f.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const jpe={kernelName:cx,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tpe{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,a=e.batchSize,o=e.inSize,i=e.numSegments,c=i*Math.ceil(o/n);this.outputShape=[a,c];const u="0.0",h="sumValue",p=Math.floor(n/4)*4,f=n%4,g="\n        sumValue += dot(values, segFilter);\n    ";let b="";o%n>0&&(b="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      "));let y="";o%n>0&&(y="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(b,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(y,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(p,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(g,"\n        }\n\n        int inIdx = inOffset + ").concat(p,";\n        if (").concat(f===1,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(g,"\n        }\n        setOutput(").concat(h,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,segmentIds:o}=e,{numSegments:i}=n,c=a.shape.length,u=[];let h=0;const p=ws([h],c);let f=a;p!=null&&(f=Vn({inputs:{x:a},backend:t,attrs:{perm:p}}),u.push(f),h=_s(1,c)[0]);const g=xI(f.shape,h,i),b=Ae([f.shape[h]]),y=Ke({inputs:{x:f},backend:t,attrs:{shape:[-1,b]}});u.push(y);const v=U2(a.dtype),w=(T,$,E,_,L)=>{const O=T.shape[0],z=T.shape[1],A=gI(z,L),U={windowSize:A,inSize:z,batchSize:O,numSegments:L},X=new Tpe(U,$),Z=t.compileAndRun(X,[T,E],_);if(u.push(Z),Z.shape[1]===L)return Z;const q=BD({backend:t,attrs:{start:0,stop:L,step:1,dtype:"float32"}}),B=VD({inputs:{x:q},backend:t,attrs:{reps:[z/A]}});return u.push(q),u.push(B),w(Z,$,B,_,L)},N=w(y,"unsortedSegmentSum",o,v,i),C=Ke({inputs:{x:N},backend:t,attrs:{shape:g}});let I=C;if(p!=null){u.push(C);const T=Xi(p);I=Vn({inputs:{x:I},backend:t,attrs:{perm:T}})}return u.forEach(T=>t.disposeIntermediateTensorInfo(T)),I}const $pe={kernelName:ux,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape=[pre,mre,bre,wre,Sre,jre,Ire,Are,_re,Fre,zre,Vre,Wre,Xre,Qre,eoe,soe,ooe,loe,uoe,foe,woe,Soe,Toe,$oe,Ooe,Loe,Boe,Yae,Goe,Xoe,Joe,rie,lie,uie,hie,fie,bie,wie,Cie,jie,Iie,Aie,Rie,Oie,zie,Bie,Gie,qie,Xie,Jie,nle,ile,ule,ple,fle,gle,ble,vle,Nle,Cle,Ile,Ele,_le,Fle,zle,Vle,Hle,Yle,Xae,Qle,qoe,tce,ace,ice,Qae,dce,mce,xce,wce,Cce,Ice,Ece,Oce,zce,Vce,Gce,Kce,Yce,Qce,sue,aue,oue,lue,uue,fue,bue,Nue,Aue,tre,_ue,Lue,Pue,Uue,Eoe,Hue,Kue,Yue,Jue,nde,ere,rde,ide,cde,dde,hde,Doe,jue,mde,yde,Sde,nre,Tde,Ade,_de,Lde,Bde,Ude,Hde,Xde,Qde,the,ahe,ihe,dhe,fhe,bhe,whe,yoe,Iue,Che,jhe,Ihe,Ahe,Dhe,_he,Fhe,Mhe,Phe,Uhe,Whe,qhe,Xhe,Qhe,epe,spe,ape,Tue,ure,ipe,upe,hpe,mpe,ype,Npe,dre,Cpe,jpe,$pe,que];for(const s of Ape)Vk(s);const Epe=()=>{const s=F.useRef(null),e=F.useRef(null),t=xs(),[n,a]=F.useState(!1),[o,i]=F.useState("Please Wait..."),[c,u]=F.useState("loading"),[h,p]=F.useState("loading"),[f,g]=F.useState("loading");F.useEffect(()=>{const y=async()=>{try{const I=await navigator.mediaDevices.getUserMedia({video:!0});s.current.srcObject=I,await new Promise(T=>{s.current.onloadedmetadata=()=>{s.current.play(),T()}})}catch(I){console.error("Camera access error:",I),alert("Camera access denied. Please allow permissions.")}},v=async()=>{const I=await fW(Bm.MediaPipeFaceDetector,{runtime:"tfjs",modelType:"short"});return console.log("Face detection model loaded.."),I},w=()=>{console.log("inside checkLightingAndShadow");const I=e.current,T=I.getContext("2d");I.width=s.current.videoWidth,I.height=s.current.videoHeight,T.drawImage(s.current,0,0,I.width,I.height);const $=T.getImageData(0,0,I.width,I.height);let E=0;const _=[];for(let X=0;X<$.data.length;X+=4){const Z=$.data[X],q=$.data[X+1],B=$.data[X+2],K=.299*Z+.587*q+.114*B;E+=K,_.push(K)}const L=E/($.data.length/4),O=_.reduce((X,Z)=>X+Math.pow(Z-L,2),0)/_.length,z=Math.sqrt(O);console.log("Avg Brightness:",L,"Shadow:",z);let A="fail";return L>=40&&L<=200&&(A="pass"),{lightingStatus:A,shadowStatus:A==="pass"?"pass":"fail"}},N=async I=>{if(!s.current||!s.current.videoWidth||!s.current.videoHeight)return requestAnimationFrame(()=>N(I));const{lightingStatus:T,shadowStatus:$}=w();if(u(T),p($),(await I.estimateFaces(s.current,{flipHorizontal:!1})).length===0)return g("fail"),i(T==="fail"?" No face + Poor lighting/shadow.":" No face detected. Look at the camera."),a(!1),requestAnimationFrame(()=>N(I));g("pass"),T==="pass"?(a(!0),i(" All checks passed. Ready to continue!")):(a(!1),i(" Please adjust lighting.")),requestAnimationFrame(()=>N(I))};(async()=>{await A7("webgl"),await E7(),await y();const I=await v();N(I)})()},[]);const b=y=>y==="pass"?"":y==="fail"?"":r.jsx("span",{className:"loader"});return r.jsxs("div",{className:"face-validation-container",children:[r.jsx("div",{className:"video-wrapper",children:r.jsx("video",{ref:s,autoPlay:!0,muted:!0,playsInline:!0})}),r.jsxs("div",{className:"status-section",children:[r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(c),children:b(c)}),r.jsx("p",{children:"Lighting"})]}),r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(h),children:b(h)}),r.jsx("p",{children:"Shadows"})]}),r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(f),children:b(f)}),r.jsx("p",{children:"Face"})]})]}),r.jsx("p",{className:"status-message",children:o}),r.jsx("button",{className:"continue-button",onClick:()=>{t("/games")},disabled:!n,children:"Continue"}),r.jsx("canvas",{ref:e,style:{display:"none"}})]})};function Dpe(){const s=jh(),e=xs(),t=()=>{s(Ry()),sessionStorage.clear(),e("/login")},n=a=>window.location.pathname===a;return r.jsxs("div",{className:"min-h-screen bg-white shadow-md w-64 px-4 py-6",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-[rgb(197,27,28)] mb-2",children:"SuperAdmin Panel"}),r.jsx("p",{className:"text-sm text-gray-600",children:"System Overview"})]}),r.jsxs("nav",{className:"space-y-2",children:[r.jsx(nt,{to:"/superadmin/dashboard",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/dashboard")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Dashboard"})}),r.jsx(nt,{to:"/superadmin/users",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/users")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Users"})}),r.jsx(nt,{to:"/superadmin/children",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/children")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Children"})}),r.jsx(nt,{to:"/superadmin/appointments",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/appointments")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Appointments"})}),r.jsx(nt,{to:"/superadmin/centres",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/centres")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Centres"})}),r.jsx(nt,{to:"/superadmin/doctor-registration",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/doctor-registration")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Doctor Registration"})}),r.jsx(nt,{to:"/superadmin/slot-management",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/slot-management")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Slot Management"})}),r.jsx(nt,{to:"/superadmin/system-health",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/system-health")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"System Health"})}),r.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[r.jsx(nt,{to:"/profile",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/profile")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Profile"})}),r.jsx("button",{onClick:t,className:"w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:r.jsx("span",{children:"Logout"})})]})]})]})}function Rpe(){var c,u;const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null),i=xs();return F.useEffect(()=>{(async()=>{try{const p=await Le.get("/api/superadmin/analytics",{headers:{Authorization:sessionStorage.getItem("token")}});e(p.data),n(!1)}catch(p){o("Failed to fetch analytics data"),n(!1)}})()},[]),t?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen text-red-500",children:a}):r.jsx("div",{className:"min-h-screen bg-gray-100",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-8",children:"Super Admin Dashboard"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Users"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalUsers)||0}),r.jsx("div",{className:"mt-4",children:(c=s==null?void 0:s.usersByRole)==null?void 0:c.map(h=>r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{className:"capitalize",children:h._id}),r.jsx("span",{children:h.count})]},h._id))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Children"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalChildren)||0})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total IEPs"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalIEPs)||0})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Appointments"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalAppointments)||0}),r.jsx("div",{className:"mt-4",children:(u=s==null?void 0:s.appointmentsByStatus)==null?void 0:u.map(h=>r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{className:"capitalize",children:h._id}),r.jsx("span",{children:h.count})]},h._id))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Centres"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalCentres)||0})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("button",{onClick:()=>i("/superadmin/users"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Users"})}),r.jsx("button",{onClick:()=>i("/superadmin/children"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Children"})}),r.jsx("button",{onClick:()=>i("/superadmin/ieps"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View IEPs"})}),r.jsx("button",{onClick:()=>i("/superadmin/appointments"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Appointments"})})]})]})})}const _pe=({user:s,onClose:e})=>{var t;return s?r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6 relative",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition duration-150","aria-label":"Close",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsxs("h3",{className:"text-xl font-bold text-[rgb(197,27,28)] mb-4 border-b pb-2",children:[s.name,"'s Details"]}),r.jsxs("div",{className:"space-y-3 text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Role:"}),r.jsx("span",{className:"capitalize",children:s.role})]}),r.jsx("p",{}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Phone:"}),s.mobilenumber||"N/A"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Centre:"}),((t=s.centreId)==null?void 0:t.name)||"-"]})]})]})}):null},Ope=({user:s,onBack:e,onSubmit:t})=>{const[n,a]=F.useState(""),[o,i]=F.useState(!1),c=u=>{u.preventDefault(),!(o||!n.trim())&&(i(!0),t(n).catch(()=>{}).finally(()=>{i(!1)}))};return r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-xl",children:[r.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["Users > ",s.name," > Write Feedback"]}),r.jsxs("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-4",children:["Write Feedback for ",s.name]}),r.jsxs("form",{onSubmit:c,className:"space-y-4",children:[r.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[rgb(197,27,28)] focus:border-transparent min-h-[200px]",placeholder:"Enter your feedback for ".concat(s.name," here..."),value:n,onChange:u=>a(u.target.value),required:!0}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,disabled:o,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition disabled:opacity-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-[rgb(197,27,28)] text-white font-semibold rounded-lg hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center",children:o?r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Submit Feedback"})]})]})]})};function Fpe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(""),[u,h]=F.useState("all"),[p,f]=F.useState(1),[g]=F.useState(10),[b,y]=F.useState(null),[v,w]=F.useState(null),N=async()=>{try{const _=await Le.get("/api/superadmin/users",{headers:{Authorization:sessionStorage.getItem("token")}});return e(_.data),n(!1),_.data}catch(_){throw o("Failed to fetch users data"),n(!1),_}};F.useEffect(()=>{N()},[]);const C=_=>{y(_)},I=_=>{w(_)},T=async(_,L)=>{var O;try{console.log("Submitting feedback for user:",_._id),await Le.post("/api/superadmin/therapists/".concat(_._id,"/feedback"),{content:L},{headers:{Authorization:sessionStorage.getItem("token")}}),alert("Feedback for ".concat(_.name," saved successfully!")),w(null)}catch(z){throw console.error("Error saving feedback:",((O=z.response)==null?void 0:O.data)||z.message),alert("Failed to save feedback. Please check the console for error details."),z}},$=()=>{w(null)},E=s.filter(_=>{const L=_.name.toLowerCase().includes(i.toLowerCase()),O=u==="all"||_.role===u;return L&&O});return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):v?r.jsx(Ope,{user:v,onBack:$,onSubmit:_=>T(v,_)}):r.jsxs("div",{className:"p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Users"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search users...",className:"px-4 py-2 border rounded-lg",value:i,onChange:_=>c(_.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:u,onChange:_=>h(_.target.value),children:[r.jsx("option",{value:"all",children:"All Roles"}),r.jsx("option",{value:"parent",children:"Parent"}),r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"therapist",children:"Therapist"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"superadmin",children:"Super Admin"})]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Role"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:E.slice((p-1)*g,p*g).map(_=>{var L;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("button",{onClick:()=>C(_),className:"flex items-center gap-1 text-[rgb(197,27,28)] hover:text-red-700 font-medium cursor-pointer transition duration-150 group",children:[r.jsx("span",{children:_.name}),r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-hover:text-red-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-label":"View Details",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),r.jsx("td",{className:"px-6 py-4 capitalize",children:_.role}),r.jsx("td",{className:"px-6 py-4",children:((L=_.centreId)==null?void 0:L.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:_.role==="therapist"&&r.jsx("button",{onClick:()=>I(_),className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full hover:bg-red-700 transition duration-150",children:"Write Feedback"})})]},_._id)})})]})}),E.length>g&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>f(_=>Math.max(_-1,1)),disabled:p===1,className:"px-4 py-2 rounded ".concat(p===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",p," of ",Math.ceil(E.length/g)]}),r.jsx("button",{onClick:()=>f(_=>Math.min(_+1,Math.ceil(E.length/g))),disabled:p>=Math.ceil(E.length/g),className:"px-4 py-2 rounded ".concat(p>=Math.ceil(E.length/g)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]}),r.jsx(_pe,{user:b,onClose:()=>y(null)})]})}function Lpe(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(null),[c,u]=F.useState(""),[h,p]=F.useState("all"),[f,g]=F.useState(1),[b]=F.useState(10);F.useEffect(()=>{(async()=>{try{const N=await Le.get("/api/superadmin/children",{headers:{Authorization:sessionStorage.getItem("token")}});t(N.data),a(!1)}catch(N){i("Failed to fetch children data"),a(!1)}})()},[]);const y=[...new Set(e.map(w=>{var N;return((N=w.centreId)==null?void 0:N.name)||"Unassigned"}))],v=e.filter(w=>{var I;const N=w.name.toLowerCase().includes(c.toLowerCase()),C=h==="all"||((I=w.centreId)==null?void 0:I.name)===h;return N&&C});return n?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):o?r.jsx("div",{className:"text-red-500 text-center py-8",children:o}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Children"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search by name...",className:"px-4 py-2 border rounded-lg",value:c,onChange:w=>u(w.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:h,onChange:w=>p(w.target.value),children:[r.jsx("option",{value:"all",children:"All Centres"}),y.map(w=>r.jsx("option",{value:w,children:w},w))]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Age"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Parent"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:v.slice((f-1)*b,f*b).map(w=>{var N,C;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:w.name}),r.jsx("td",{className:"px-6 py-4",children:Math.floor((new Date-new Date(w.dob))/(365.25*24*60*60*1e3))}),r.jsx("td",{className:"px-6 py-4",children:((N=w.parentId)==null?void 0:N.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((C=w.centreId)==null?void 0:C.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("button",{onClick:()=>s("/superadmin/children/".concat(w._id)),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded-lg hover:bg-[rgb(150,20,20)] transition-colors",children:"View Details"})})]},w._id)})})]})}),v.length>b&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>g(w=>Math.max(w-1,1)),disabled:f===1,className:"px-4 py-2 rounded ".concat(f===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",f," of ",Math.ceil(v.length/b)]}),r.jsx("button",{onClick:()=>g(w=>Math.min(w+1,Math.ceil(v.length/b))),disabled:f>=Math.ceil(v.length/b),className:"px-4 py-2 rounded ".concat(f>=Math.ceil(v.length/b)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function Mpe(){var g,b,y;const{childId:s}=Vo(),e=xs(),[t,n]=F.useState(null),[a,o]=F.useState(!0),[i,c]=F.useState(null),[u,h]=F.useState([]),[p,f]=F.useState([]);return F.useEffect(()=>{(async()=>{try{const[w,N,C]=await Promise.all([Le.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Le.get("/api/superadmin/children/".concat(s,"/ieps"),{headers:{Authorization:sessionStorage.getItem("token")}}),Le.get("/api/superadmin/children/".concat(s,"/appointments"),{headers:{Authorization:sessionStorage.getItem("token")}})]);n(w.data),h(N.data),f(C.data),o(!1)}catch(w){c("Failed to fetch child data"),o(!1)}})()},[s]),a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):i?r.jsx("div",{className:"text-red-500 text-center py-8",children:i}):r.jsxs("div",{className:"p-6",children:[r.jsxs(nt,{to:"/superadmin/children",className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Children List"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-4",children:t.name}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Age"}),r.jsxs("p",{className:"text-lg",children:[Math.floor((new Date-new Date(t.dob))/(365.25*24*60*60*1e3))," years"]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Date of Birth"}),r.jsx("p",{className:"text-lg",children:new Date(t.dob).toLocaleDateString()})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Gender"}),r.jsx("p",{className:"text-lg",children:t.gender})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Centre"}),r.jsx("p",{className:"text-lg",children:((g=t.centreId)==null?void 0:g.name)||"Not Assigned"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Parent Name"}),r.jsx("p",{className:"text-lg",children:((b=t.parentId)==null?void 0:b.name)||"Not Available"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Parent Contact"}),r.jsx("p",{className:"text-lg",children:((y=t.parentId)==null?void 0:y.mobilenumber)||"Not Available"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-[rgb(197,27,28)]",children:"IEPs"}),r.jsxs("span",{className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full",children:[u.length," Total"]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-gray-600",children:["Latest IEP: ",u[0]?"".concat(u[0].startingMonth,"/").concat(u[0].startingYear):"None"]})}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("button",{onClick:()=>e("/superadmin/children/".concat(s,"/ieps")),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"View All IEPs"}),u.length>0&&r.jsx("button",{onClick:()=>$u(u[0]),className:"border border-[rgb(197,27,28)] text-[rgb(197,27,28)] px-4 py-2 rounded hover:bg-red-50 transition-colors",children:"View Latest IEP"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-[rgb(197,27,28)]",children:"Appointments"}),r.jsxs("span",{className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full",children:[p.length," Total"]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-gray-600",children:["Next Appointment: ",p.find(v=>new Date(v.datetime)>new Date)?new Date(p.find(v=>new Date(v.datetime)>new Date).datetime).toLocaleDateString():"None Scheduled"]})}),r.jsx("button",{onClick:()=>e("/superadmin/children/".concat(s,"/appointments")),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"View All Appointments"})]})]})]})}function zpe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(""),[u,h]=F.useState("all"),[p,f]=F.useState("all"),[g,b]=F.useState(1),[y]=F.useState(10),[v,w]=F.useState(null);F.useEffect(()=>{(async()=>{try{const E=await Le.get("/api/superadmin/appointments",{headers:{Authorization:sessionStorage.getItem("token")}});e(E.data),n(!1)}catch(E){o("Failed to fetch appointments data"),n(!1),console.error("Error fetching appointments:",E)}})()},[]);const N=[...new Set(s.map($=>{var E;return((E=$.centreId)==null?void 0:E.name)||"Unassigned"}))],C=[...new Set(s.map($=>$.status))],I=async($,E)=>{w($);try{await Le.put("/api/admins/manageAppointment/".concat($),{status:E},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),e(s.map(_=>_._id===$?{..._,status:E}:_)),Be.success("Appointment ".concat(E," successfully!"))}catch(_){console.error("Error updating appointment status:",_),Be.error("Failed to update appointment status")}finally{w(null)}},T=s.filter($=>{var O,z,A,U;const E=((O=$.childId)==null?void 0:O.name.toLowerCase().includes(i.toLowerCase()))||((z=$.doctorId)==null?void 0:z.name.toLowerCase().includes(i.toLowerCase()))||((A=$.therapistId)==null?void 0:A.name.toLowerCase().includes(i.toLowerCase())),_=u==="all"||$.status===u,L=p==="all"||((U=$.centreId)==null?void 0:U.name)===p;return E&&_&&L});return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Appointments"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search by name...",className:"px-4 py-2 border rounded-lg",value:i,onChange:$=>c($.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:u,onChange:$=>h($.target.value),children:[r.jsx("option",{value:"all",children:"All Statuses"}),C.map($=>r.jsx("option",{value:$,children:$},$))]}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:p,onChange:$=>f($.target.value),children:[r.jsx("option",{value:"all",children:"All Centres"}),N.map($=>r.jsx("option",{value:$,children:$},$))]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Date & Time"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Child"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Consultation Type"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:T.slice((g-1)*y,g*y).map($=>{var E,_,L;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4",children:[$.appointmentDate.split("T")[0]||"-"," ",$.appointmentTime||"-"]}),r.jsx("td",{className:"px-6 py-4",children:((E=$.childId)==null?void 0:E.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((_=$.doctorId)==null?void 0:_.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((L=$.centreId)==null?void 0:L.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:$.consultationType||"Not specified"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat($.status==="approved"?"bg-green-100 text-green-800":$.status==="pending"?"bg-yellow-100 text-yellow-800":$.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:$.status})}),r.jsx("td",{className:"px-6 py-4",children:$.status==="pending"?r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>I($._id,"approved"),disabled:v===$._id,className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm font-medium disabled:opacity-50",title:"Approve",children:v===$._id?"...":"Approve"}),r.jsx("button",{onClick:()=>I($._id,"rejected"),disabled:v===$._id,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium disabled:opacity-50",title:"Reject",children:v===$._id?"...":"Reject"})]}):r.jsx("span",{className:"text-gray-500 text-sm",children:"No actions available"})})]},$._id)})})]})}),T.length>y&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>b($=>Math.max($-1,1)),disabled:g===1,className:"px-4 py-2 rounded ".concat(g===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",g," of ",Math.ceil(T.length/y)]}),r.jsx("button",{onClick:()=>b($=>Math.min($+1,Math.ceil(T.length/y))),disabled:g>=Math.ceil(T.length/y),className:"px-4 py-2 rounded ".concat(g>=Math.ceil(T.length/y)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function Ppe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState("");F.useEffect(()=>{(async()=>{try{const p=await Le.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});e(p.data),n(!1)}catch(p){o("Failed to fetch centres data"),n(!1)}})()},[]);const u=s.filter(h=>h.name.toLowerCase().includes(i.toLowerCase()));return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Centres"}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search centres...",className:"px-4 py-2 border rounded-lg w-full md:w-1/3",value:i,onChange:h=>c(h.target.value)})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(h=>r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:h.name}),r.jsxs("div",{className:"text-gray-600",children:[r.jsxs("p",{className:"mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Address: "}),h.address]}),r.jsxs("p",{className:"mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Phone:"})," ",h.contactNumber]})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Staff Details"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Doctors"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.doctorCount||0})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Therapists"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.therapistCount||0})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Admins"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.adminCount||0})]})]})]}),r.jsx("div",{className:"flex flex-col justify-center",children:r.jsxs("div",{className:"text-center bg-gray-50 p-4 rounded",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Children"}),r.jsx("p",{className:"text-2xl font-bold text-[rgb(197,27,28)]",children:h.childrenCount||0})]})})]})})]})},h._id))})]})}function Bpe(){var u,h;const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null);if(F.useEffect(()=>{const p=async()=>{try{const g=await Le.get("/api/superadmin/system-health",{headers:{Authorization:sessionStorage.getItem("token")}});e(g.data),n(!1)}catch(g){o("Failed to fetch system health data"),n(!1)}};p();const f=setInterval(p,3e4);return()=>clearInterval(f)},[]),t)return r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})});if(a)return r.jsx("div",{className:"text-red-500 text-center py-8",children:a});const i=p=>{if(p===0)return"0 Bytes";const f=1024,g=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(p)/Math.log(f));return parseFloat((p/Math.pow(f,b)).toFixed(2))+" "+g[b]},c=p=>{const f=Math.floor(p/86400),g=Math.floor(p%(3600*24)/3600),b=Math.floor(p%3600/60);return"".concat(f,"d ").concat(g,"h ").concat(b,"m")};return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"System Health"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"System Status"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full ".concat((s==null?void 0:s.status)==="operational"?"bg-green-500":"bg-red-500")}),r.jsx("span",{className:"capitalize",children:s==null?void 0:s.status})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Database Status"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full ".concat((s==null?void 0:s.dbStatus)==="connected"?"bg-green-500":"bg-red-500")}),r.jsx("span",{className:"capitalize",children:s==null?void 0:s.dbStatus})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Uptime"}),r.jsx("p",{className:"text-2xl font-bold text-[rgb(197,27,28)]",children:c((u=s==null?void 0:s.metrics)==null?void 0:u.uptime)})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Memory Usage"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(((h=s==null?void 0:s.metrics)==null?void 0:h.memoryUsage)||{}).map(([p,f])=>r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 capitalize",children:p.replace("Memory","")}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:i(f)})]},p))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"API Endpoints Status"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s==null?void 0:s.endpoints.map(p=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:p.path}),r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(p.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:p.status})]},p.path))})]})]})}const yk=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,vk=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]};function Vpe(){const[s,e]=F.useState([]),[t,n]=F.useState(""),[a,o]=F.useState([]),[i,c]=F.useState(""),[u,h]=F.useState(""),[p,f]=F.useState(null),[g,b]=F.useState(!1),[y,v]=F.useState(""),[w,N]=F.useState(""),[C,I]=F.useState("AM"),[T,$]=F.useState(!1),[E,_]=F.useState(!1),[L,O]=F.useState(!1),[z,A]=F.useState(!1),[U,X]=F.useState(""),[Z,q]=F.useState(""),[B,K]=F.useState(!0),[J,Q]=F.useState(""),[ae,we]=F.useState(!1),[Ce,ve]=F.useState(""),[pe,xe]=F.useState(!1),[ue,ye]=F.useState([]),[Y,ce]=F.useState(""),[re,ke]=F.useState([]),[Me,Ue]=F.useState([]),[He,We]=F.useState([]),[je,Xe]=F.useState(""),[st,St]=F.useState(!1),[pt,Ve]=F.useState(""),[Je,mt]=F.useState(null),[yt,Vt]=F.useState(!1),[Dt,zt]=F.useState("block"),Kt=()=>Dt==="block"?Me:He,jt=Re=>{Dt==="block"?Ue(Re):We(Re)},Ls=Bo();F.useEffect(()=>{Hn(),aa();const Re=new URLSearchParams(Ls.search),Qe=Re.get("centreId"),Rn=Re.get("doctorId"),an=Re.get("date");if(Qe&&(n(Qe),Dr(Qe)),Rn&&c(Rn),an){const Cs=new Date(an).toISOString().split("T")[0];h(Cs)}},[Ls.search]),F.useEffect(()=>{t?(Dr(t),c("")):(o([]),c(""))},[t]),F.useEffect(()=>{pe&&Y&&je?sn():mt(null)},[Y,je,pe]),F.useEffect(()=>{we(!1),ve(""),f(null)},[t,i,u]);const Hn=async()=>{try{const Re=await Le.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});e(Re.data||[])}catch(Re){console.error("Error fetching centers:",Re),e([])}},Dr=async Re=>{try{const Qe=await Le.get("/api/superadmin/center-doctors/".concat(Re),{headers:{Authorization:sessionStorage.getItem("token")}});o(Qe.data.doctors||[])}catch(Qe){console.error("Error fetching center doctors:",Qe),o([])}},aa=async()=>{try{const Re=await Le.get("/api/superadmin/doctors",{headers:{Authorization:sessionStorage.getItem("token")}});ye(Re.data||[])}catch(Re){console.error("Error fetching all doctors:",Re),ye([])}},ra=async Re=>{try{const Qe=ue.find(Rn=>Rn._id===Re);Qe&&Qe.centreIds?ke(Qe.centreIds):ke([])}catch(Qe){console.error("Error fetching doctor centers:",Qe),ke([])}},sn=F.useCallback(async()=>{if(!Y||!je){mt(null);return}try{const Re=await Le.get("/api/superadmin/doctor-centers-status/".concat(Y,"/").concat(je),{headers:{Authorization:sessionStorage.getItem("token")}});mt(Re.data)}catch(Re){console.error("Error fetching center statuses:",Re),mt(null)}},[Y,je]),Rr=async()=>{if(!Y||Me.length===0||!je){Be.error("Please select doctor, centers, and date");return}try{await Le.post("/api/superadmin/bulk-block-slots",{doctorId:Y,centreIds:Me,date:je,blockReason:pt||"Bulk block operation"},{headers:{Authorization:sessionStorage.getItem("token")}}),Be.success("Successfully blocked all slots for selected centers on ".concat(je)),St(!1),Ve(""),Ue([]),await sn()}catch(Re){console.error("Error bulk blocking slots:",Re),Be.error("Failed to bulk block slots")}},_r=async()=>{if(!Y||He.length===0||!je){Be.error("Please select doctor, centers, and date");return}try{await Le.post("/api/superadmin/bulk-unblock-slots",{doctorId:Y,centreIds:He,date:je},{headers:{Authorization:sessionStorage.getItem("token")}}),Be.success("Successfully unblocked all slots for selected centers on ".concat(je)),Vt(!1),We([]),await sn()}catch(Re){console.error("Error bulk unblocking slots:",Re),Be.error("Failed to bulk unblock slots")}},oa=async()=>{if(!t||!i||!u){Be.error("Please select center, doctor and date");return}try{b(!0);const Qe=(await Le.get("/api/superadmin/slot-config/".concat(t,"/").concat(i,"?date=").concat(u),{headers:{Authorization:sessionStorage.getItem("token")}})).data[0];Qe&&Qe.isHoliday?(we(!0),ve(Qe.holidayName),f(null)):(we(!1),ve(""),f(Qe))}catch(Re){console.error("Error fetching slot configuration:",Re),Be.error("Failed to fetch slot configuration")}finally{b(!1)}},sl=async()=>{if(!y||!w){Be.error("Please enter hour and minute");return}const Re="".concat(y,":").concat(w.padStart(2,"0")," ").concat(C);try{await Le.post("/api/superadmin/add-slot",{doctorId:i,centreId:t,date:u,slotTime:Re},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa(),v(""),N(""),I("AM"),$(!1)}catch(Qe){console.error("Error adding slot:",Qe),Be.error("Failed to add slot")}},nl=async Re=>{try{await Le.post("/api/superadmin/remove-slot",{doctorId:i,centreId:t,date:u,slotTime:Re},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa()}catch(Qe){console.error("Error removing slot:",Qe),Be.error("Failed to remove slot")}},Ko=async()=>{if(!U){Be.error("Please select a slot to block");return}try{await Le.post("/api/superadmin/block-slot",{doctorId:i,centreId:t,date:u,slotTime:U,blockReason:Z||"Blocked by admin",blockAllCenters:!1},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa(),O(!1),q(""),X("")}catch(Re){console.error("Error blocking slot:",Re),Be.error("Failed to block slot")}},nn=async Re=>{try{await Le.post("/api/superadmin/unblock-slot",{doctorId:i,centreId:t,date:u,slotTime:Re},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa()}catch(Qe){console.error("Error unblocking slot:",Qe),Be.error("Failed to unblock slot")}},Ns=async()=>{var Re;if(!t||!i||!u){Be.error("Please select center, doctor and date");return}if(window.confirm("Are you sure you want to block ALL slots for this doctor in ".concat((Re=s.find(Qe=>Qe._id===t))==null?void 0:Re.name," on ").concat(u,"?")))try{await Le.post("/api/superadmin/block-all-slots",{doctorId:i,centreId:t,date:u,blockReason:"All slots blocked for the day"},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa()}catch(Qe){console.error("Error blocking all slots:",Qe),Be.error("Failed to block all slots")}},al=async()=>{try{await Le.post("/api/superadmin/set-operational-status",{doctorId:i,centreId:t,date:u,isOperational:B,reason:J||void 0},{headers:{Authorization:sessionStorage.getItem("token")}}),await oa(),_(!1),Q("")}catch(Re){console.error("Error updating operational status:",Re),Be.error("Failed to update operational status")}},qn=Re=>Re.isActive?Re.isBlocked?"bg-red-100 text-red-700 border-red-300":"bg-green-100 text-green-700 border-green-300":"bg-gray-100 text-gray-500 border-gray-300",Or=Re=>Re.isActive?Re.isBlocked?"Blocked":"Available":"Inactive";return r.jsx("div",{className:"flex",children:r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-2",children:"Slot Management"})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 mb-6",children:r.jsxs("div",{className:"flex border-b border-red-200",children:[r.jsx("button",{onClick:()=>xe(!1),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(pe?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-[#ab1c1c] text-[#ab1c1c] bg-red-50"),children:"Individual Center Management"}),r.jsx("button",{onClick:()=>xe(!0),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(pe?"border-[#ab1c1c] text-[#ab1c1c] bg-red-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Bulk Operations"})]})}),pe&&!ae&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:"Bulk Slot Operations"}),r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>{zt("block")},className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(Dt==="block"?"bg-red-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Block Slots"}),r.jsx("button",{onClick:()=>{zt("unblock")},className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(Dt==="unblock"?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Unblock Slots"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor *"}),r.jsxs("select",{value:Y,onChange:Re=>{ce(Re.target.value),Re.target.value?ra(Re.target.value):(ke([]),Ue([]),We([]))},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select Doctor"}),ue.map(Re=>r.jsx("option",{value:Re._id,children:Re.name},Re._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),r.jsx("input",{type:"date",value:je,onChange:Re=>{const Qe=Re.target.value;if(yk(Qe)){Be.error("Slots cannot be created on Sundays. Please select another date.");return}Xe(Qe)},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",min:vk()})]})]}),re.length>0&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Select Centers for ",Dt==="block"?"Blocking":"Unblocking"," *"]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[Je&&r.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-1"}),"Blocked (",Je.summary.fullyBlocked,")"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-1"}),"Partial (",Je.summary.partiallyBlocked,")"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-1"}),"Available (",Je.summary.available,")"]})]}),re.length>0&&r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{type:"button",onClick:()=>{jt(re.map(Re=>Re._id))},className:"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>{jt([])},className:"text-xs bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600",children:"Unselect All"})]})]})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 p-4 border border-gray-200 rounded-lg",children:re.map(Re=>{var za;const Qe=(za=Je==null?void 0:Je.allCenters)==null?void 0:za.find(io=>io.centreId===Re._id),Rn=(Qe==null?void 0:Qe.status)==="fully_blocked",an=(Qe==null?void 0:Qe.status)==="partially_blocked",Ss=(Qe==null?void 0:Qe.status)==="available",Cs=Kt();return r.jsxs("label",{className:"flex items-start p-3 rounded-lg border cursor-pointer hover:shadow-sm transition-shadow ".concat(Rn?"border-red-300 bg-red-50":an?"border-yellow-300 bg-yellow-50":Ss?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50"),children:[r.jsx("input",{type:"checkbox",checked:Cs.includes(Re._id),onChange:io=>{io.target.checked?jt([...Cs,Re._id]):jt(Cs.filter(Ku=>Ku!==Re._id))},className:"mr-3 mt-1 h-4 w-4 text-[#ab1c1c] focus:ring-[#ab1c1c]"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:Re.name}),Qe&&r.jsxs("div",{className:"text-xs mt-1 font-medium ".concat(Rn?"text-red-600":an?"text-yellow-600":"text-green-600"),children:[Rn&&"Blocked (".concat(Qe.blockedSlotsCount,"/").concat(Qe.totalSlotsCount," slots)"),an&&"Partial (".concat(Qe.blockedSlotsCount,"/").concat(Qe.totalSlotsCount," slots)"),Ss&&"Available"]})]})]},Re._id)})}),r.jsxs("div",{className:"flex items-center justify-between mt-6",children:[r.jsx("div",{className:"text-sm text-gray-600",children:Kt().length>0?r.jsxs("span",{className:"font-medium",children:[Kt().length," center(s) selected for ",Dt,"ing"]}):r.jsxs("span",{children:["Select centers to ",Dt]})}),r.jsxs("button",{onClick:()=>{Dt==="block"?St(!0):Vt(!0)},disabled:!Y||Kt().length===0||!je,className:"px-6 py-3 text-white rounded-lg font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed ".concat(Dt==="block"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:[Dt==="block"?"Block":"Unblock"," Selected Centers"]})]})]}),Dt==="block"&&Kt().length>0&&r.jsxs("div",{className:"mt-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("label",{className:"block text-sm font-medium text-red-800 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:pt,onChange:Re=>Ve(Re.target.value),placeholder:"e.g., Doctor on leave, Holiday, etc.",className:"w-full border border-red-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"})]})]}),pe&&ae&&r.jsx("div",{className:"bg-orange-50 border border-orange-200 p-6 rounded-lg shadow-sm mb-6",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-4xl mb-3",children:""}),r.jsx("h3",{className:"text-lg font-semibold text-orange-800 mb-2",children:"Bulk Operations Unavailable on Holiday"}),r.jsx("p",{className:"text-orange-700",children:"Bulk slot operations are disabled during holidays. Please select a different date."})]})}),!pe&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200 mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:"Select Configuration"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Center *"}),r.jsxs("select",{value:t,onChange:Re=>{const Qe=Re.target.value;n(Qe),Qe?Dr(Qe):(o([]),c(""))},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select Center"}),s.map(Re=>r.jsx("option",{value:Re._id,children:Re.name},Re._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor *"}),r.jsxs("select",{value:i,onChange:Re=>c(Re.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",disabled:!t||a.length===0,children:[r.jsx("option",{value:"",children:t?a.length===0?"No doctors available":"Select Doctor":"Select Center First"}),a.map(Re=>r.jsx("option",{value:Re._id,children:Re.name},Re._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsx("input",{type:"date",value:u,onChange:Re=>{const Qe=Re.target.value;if(yk(Qe)){Be.error("Slots cannot be managed on Sundays. Please select another date.");return}h(Qe)},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",min:vk()})]})]}),r.jsx("button",{onClick:oa,disabled:!t||!i||!u||g,className:"bg-[#ab1c1c] text-white px-6 py-2 rounded-lg hover:bg-[#8a1717] disabled:bg-gray-300 disabled:cursor-not-allowed",children:g?"Loading...":"Load Slots"})]}),ae&&r.jsx("div",{className:"bg-gradient-to-r from-orange-100 to-red-100 p-8 rounded-lg shadow-sm border-2 border-orange-300",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsxs("h2",{className:"text-2xl font-bold text-orange-800 mb-2",children:["Holiday - ",Ce]}),r.jsx("p",{className:"text-lg text-orange-700 mb-4",children:u?new Date(u).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"No date selected"}),r.jsxs("div",{className:"bg-white bg-opacity-70 rounded-lg p-4 inline-block",children:[r.jsx("p",{className:"text-orange-800 font-medium",children:" No slots are available on this holiday"}),r.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"All appointments and slot management are disabled"})]})]})}),!ae&&p&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:["Slot Configuration - ",u?new Date(u).toLocaleDateString():"No date selected"]}),r.jsxs("div",{className:"flex items-center mt-2",children:[r.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Status:"}),r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((p==null?void 0:p.isOperational)!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:(p==null?void 0:p.isOperational)!==!1?"Operational":"Non-Operational"})]})]}),r.jsxs("div",{className:"space-x-2",children:[r.jsx("button",{onClick:()=>$(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Add Slot"}),r.jsx("button",{onClick:()=>Ns(),className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Block All Slots"}),r.jsx("button",{onClick:()=>{var Re;K((Re=p==null?void 0:p.isOperational)!=null?Re:!0),_(!0)},className:"px-4 py-2 rounded-lg ".concat((p==null?void 0:p.isOperational)!==!1?"bg-orange-600 hover:bg-orange-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:(p==null?void 0:p.isOperational)!==!1?"Set Non-Operational":"Set Operational"})]})]}),p&&p.availableSlots&&Array.isArray(p.availableSlots)&&p.availableSlots.length>0?r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:p.availableSlots.map((Re,Qe)=>r.jsxs("div",{className:"p-3 rounded-lg border-2 ".concat(qn(Re)),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-medium",children:Re.time}),r.jsx("div",{className:"text-xs mt-1",children:Or(Re)}),Re.isBlocked&&Re.blockReason&&r.jsx("div",{className:"text-xs mt-1 text-red-600",children:Re.blockReason})]}),r.jsxs("div",{className:"flex justify-center mt-2 space-x-1",children:[Re.isBlocked?r.jsx("button",{onClick:()=>nn(Re.time),className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",children:"Unblock"}):r.jsx("button",{onClick:()=>{X(Re.time),O(!0)},className:"text-xs bg-orange-500 text-white px-2 py-1 rounded hover:bg-orange-600",children:"Block"}),r.jsx("button",{onClick:()=>{X(Re.time),A(!0)},className:"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"Remove"})]})]},Qe))}):r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No slots configured for this combination. Add some slots to get started."})]}),T&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:"Add New Slot"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Slot"}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Hour"}),r.jsxs("select",{value:y,onChange:Re=>v(Re.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select"}),[...Array(12)].map((Re,Qe)=>r.jsx("option",{value:Qe+1,children:Qe+1},Qe+1))]})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Minute (00 to 59)"}),r.jsx("input",{type:"number",value:w,onChange:Re=>{const Qe=parseInt(Re.target.value);(Re.target.value===""||Qe>=0&&Qe<=59)&&N(Re.target.value)},min:"0",max:"59",placeholder:"Enter minutes",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Period"}),r.jsxs("select",{value:C,onChange:Re=>I(Re.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"AM",children:"AM"}),r.jsx("option",{value:"PM",children:"PM"})]})]})]}),y&&w&&r.jsxs("p",{className:"text-xs text-green-600 mt-2",children:["Preview: ",y,":",w.padStart(2,"0")," ",C]})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{$(!1),v(""),N(""),I("AM")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:sl,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Add Slot"})]})]})}),L&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-orange-600",children:"Block Slot"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to block the ",r.jsx("strong",{children:U})," slot?"]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:Z,onChange:Re=>q(Re.target.value),placeholder:"e.g., Doctor unavailable",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{O(!1),X(""),q("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Ko,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Yes, Block Slot"})]})]})}),z&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-red-600",children:"Confirm Remove Slot"}),r.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to ",r.jsx("strong",{children:"permanently remove"})," the ",r.jsx("strong",{children:U})," slot?"]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{A(!1),X("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>{nl(U),A(!1),X("")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Yes, Remove Permanently"})]})]})}),E&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:B?"Set Operational":"Set Non-Operational"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operational Status"}),r.jsxs("select",{value:B,onChange:Re=>K(Re.target.value==="true"),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:!0,children:"Operational"}),r.jsx("option",{value:!1,children:"Non-Operational"})]})]}),!B&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason (Optional)"}),r.jsx("input",{type:"text",value:J,onChange:Re=>Q(Re.target.value),placeholder:"e.g., Doctor on leave",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{_(!1),Q("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:al,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Update Status"})]})]})})]}),st&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-red-600",children:"Bulk Block All Slots"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to block ALL slots for the selected doctor across"," ",r.jsxs("strong",{children:[Me.length," center(s)"]})," on"," ",r.jsx("strong",{children:je}),"?"]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:pt,onChange:Re=>Ve(Re.target.value),placeholder:"e.g., Doctor on leave",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{St(!1),Ve("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Rr,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Yes, Block All Slots"})]})]})}),yt&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-600",children:"Confirm Bulk Unblock"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to unblock ALL slots for the selected doctor across"," ",r.jsxs("strong",{children:[He.length," center(s)"]})," on"," ",r.jsx("strong",{children:je}),"?"]}),Je&&He.length>0&&r.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Centers to unblock:"}),r.jsx("div",{className:"space-y-1",children:He.map(Re=>{var Rn;const Qe=(Rn=Je.allCenters)==null?void 0:Rn.find(an=>an.centreId===Re);return Qe?r.jsxs("div",{className:"text-sm text-blue-700",children:[" ",Qe.centreName," (",Qe.blockedSlotsCount,"/",Qe.totalSlotsCount," slots blocked)"]},Re):null})})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>{Vt(!1)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>{_r(),We([])},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Unblock All Slots"})]})]})}),g&&r.jsx(Vs,{})]})})})}function Upe(){const[s,e]=F.useState({name:"",mobilenumber:"",password:"",confirmPassword:"",designation:"",qualification:"",centreIds:[]}),[t,n]=F.useState([]),[a,o]=F.useState([]),[i,c]=F.useState({}),[u]=F.useState(!1),[h,p]=F.useState(!1),[f,g]=F.useState(!1),[b,y]=F.useState(!1),[v,w]=F.useState(!1),[N,C]=F.useState(!1);F.useEffect(()=>{I(),T()},[]);const I=async()=>{try{const A=await Le.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});n(A.data||[])}catch(A){console.error("Error fetching centers:",A),Be.error("Failed to fetch centers")}},T=async()=>{try{const A=await Le.get("/api/superadmin/doctors-list",{headers:{Authorization:sessionStorage.getItem("token")}});o(A.data||[])}catch(A){console.error("Error fetching doctors:",A),Be.error("Failed to fetch doctors")}},$=A=>{const{name:U,value:X}=A.target;e({...s,[U]:X}),i[U]&&c({...i,[U]:""})},E=(A,U)=>{let X=[...s.centreIds];U?X.includes(A)||X.push(A):X=X.filter(Z=>Z!==A),e({...s,centreIds:X}),C(X.length===t.length)},_=()=>{N?(e({...s,centreIds:[]}),C(!1)):(e({...s,centreIds:t.map(A=>A._id)}),C(!0))},L=()=>{const A={};return s.name.trim()||(A.name="Name is required"),s.mobilenumber?/^\d{10}$/.test(s.mobilenumber)||(A.mobilenumber="Mobile number must be 10 digits"):A.mobilenumber="Mobile number is required",s.password?s.password.length<6&&(A.password="Password must be at least 6 characters"):A.password="Password is required",s.password!==s.confirmPassword&&(A.confirmPassword="Passwords do not match"),s.centreIds.length===0&&(A.centreIds="At least one center must be selected"),A},O=async A=>{var U,X,Z,q;A.preventDefault(),g(!0);try{const B=L();if(Object.keys(B).length>0){c(B),Be.error("Please fix the validation errors before submitting");return}await Le.post("/api/superadmin/register-doctor",{name:s.name,mobilenumber:s.mobilenumber,password:s.password,centreIds:s.centreIds,designation:s.designation,qualification:s.qualification},{headers:{Authorization:sessionStorage.getItem("token")}}),Be.success("Doctor registered successfully!"),p(!0),await T()}catch(B){console.error("Registration error:",B),Be.error(((X=(U=B.response)==null?void 0:U.data)==null?void 0:X.error)||((q=(Z=B.response)==null?void 0:Z.data)==null?void 0:q.message)||"Registration failed")}finally{g(!1)}},z=()=>{e({name:"",mobilenumber:"",password:"",confirmPassword:"",designation:"",qualification:"",centreIds:[]}),c({}),p(!1),C(!1)};return h?r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-xl overflow-hidden border border-green-200",children:r.jsxs("div",{className:"px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"mt-3 text-xl font-medium text-gray-900",children:"Doctor Registration Successful!"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Doctor account has been created successfully and assigned to selected centers."}),r.jsx("div",{className:"mt-6 space-y-3",children:r.jsx("button",{onClick:z,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Register Another Doctor"})})]})})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-2",children:"Doctor Registration"}),r.jsx("p",{className:"text-gray-600",children:"Register new doctors and assign them to centers"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 mb-8",children:r.jsxs("div",{className:"px-6 py-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-6",children:"Register New Doctor"}),r.jsxs("form",{onSubmit:O,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),r.jsx("input",{type:"text",name:"name",value:s.name,onChange:$,className:"w-full p-3 border ".concat(i.name?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Doctor's full name"}),i.name&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number *"}),r.jsx("input",{type:"number",name:"mobilenumber",value:s.mobilenumber,onChange:$,className:"w-full p-3 border ".concat(i.mobilenumber?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"10-digit mobile number",maxLength:"10"}),i.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.mobilenumber})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),r.jsx("input",{type:"text",name:"designation",value:s.designation,onChange:$,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"e.g., Senior Consultant, Specialist"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Qualification"}),r.jsx("input",{type:"text",name:"qualification",value:s.qualification,onChange:$,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"e.g., MBBS, MD, MS"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:b?"text":"password",name:"password",value:s.password,onChange:$,className:"w-full p-3 border ".concat(i.password?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>y(!b),children:b?r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),i.password&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.password})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:v?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:$,className:"w-full p-3 border ".concat(i.confirmPassword?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Confirm Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>w(!v),children:v?r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),i.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.confirmPassword})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assign Centers *"}),r.jsx("button",{type:"button",onClick:_,className:"text-sm text-[#ab1c1c] hover:text-[#8e1818] font-medium",children:N?"Deselect All":"Select All"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 p-4 border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:t.map(A=>r.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 hover:border-[#ab1c1c] hover:bg-red-50 cursor-pointer transition-colors",children:[r.jsx("input",{type:"checkbox",checked:s.centreIds.includes(A._id),onChange:U=>E(A._id,U.target.checked),className:"mr-3 h-4 w-4 text-[#ab1c1c] focus:ring-[#ab1c1c] border-gray-300 rounded"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),A.location&&r.jsx("div",{className:"text-xs text-gray-500",children:A.location})]})]},A._id))}),s.centreIds.length>0&&r.jsx("div",{className:"mt-3 p-3 bg-green-50 rounded-lg border border-green-200",children:r.jsxs("div",{className:"text-sm text-green-800",children:[r.jsx("strong",{children:s.centreIds.length})," center(s) selected"]})}),i.centreIds&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:i.centreIds})]}),r.jsx("div",{className:"pt-4",children:r.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white ".concat(f?"bg-gray-400 cursor-not-allowed":"bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]"),children:f?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Registering Doctor..."]}):"Register Doctor"})})]})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-red-200",children:[r.jsx("div",{className:"px-6 py-4 border-b border-red-200",children:r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:"Registered Doctors"})}),r.jsx("div",{className:"p-6",children:u?r.jsx(Vs,{}):a.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No doctors registered yet."}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned Centers"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patients"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(A=>{var U,X;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),A.designation&&r.jsx("div",{className:"text-sm text-gray-500",children:A.designation}),A.qualification&&r.jsx("div",{className:"text-xs text-gray-400",children:A.qualification})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:A.mobilenumber})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:(U=A.centreIds)==null?void 0:U.map(Z=>r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:Z.name},Z._id))})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[((X=A.patients)==null?void 0:X.length)||0," patients"]})]},A._id)})})]})})})]}),u&&r.jsx(Vs,{})]})}function Gpe(){return r.jsx("div",{className:"min-h-screen bg-gray-100",children:r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(Dpe,{}),r.jsx("div",{className:"flex-1 p-6",children:r.jsxs(og,{children:[r.jsx(tt,{path:"/dashboard",element:r.jsx(Rpe,{})}),r.jsx(tt,{path:"/users",element:r.jsx(Fpe,{})}),r.jsx(tt,{path:"/children",element:r.jsx(Lpe,{})}),r.jsx(tt,{path:"/children/:childId",element:r.jsx(Mpe,{})}),r.jsx(tt,{path:"/children/:childId/ieps",element:r.jsx(i8,{})}),r.jsx(tt,{path:"/children/:childId/appointments",element:r.jsx(l8,{})}),r.jsx(tt,{path:"/appointments",element:r.jsx(zpe,{})}),r.jsx(tt,{path:"/centres",element:r.jsx(Ppe,{})}),r.jsx(tt,{path:"/doctor-registration",element:r.jsx(Upe,{})}),r.jsx(tt,{path:"/slot-management",element:r.jsx(Vpe,{})}),r.jsx(tt,{path:"/system-health",element:r.jsx(Bpe,{})})]})})]})})}const Wpe=()=>{const s=Ml(t=>t.auth.isAuthenticated),e=sessionStorage.getItem("role");if(s)switch(console.log(s,e),e){case"admin":return r.jsx(Eo,{to:"/admindashboard",replace:!0});case"parent":return r.jsx(Eo,{to:"/parentdashboard",replace:!0});case"doctor":return r.jsx(Eo,{to:"/doctordashboard",replace:!0});case"therapist":return r.jsx(Eo,{to:"/therapistdashboard",replace:!0});case"superadmin":return r.jsx(Eo,{to:"/superadmin/dashboard",replace:!0})}return r.jsx(LF,{})},Hpe=()=>r.jsxs(r.Fragment,{children:[r.jsx(P5,{}),r.jsx("div",{className:"min-h-screen",children:r.jsxs(og,{children:[r.jsx(tt,{path:"/",element:r.jsx(S5,{})}),r.jsx(tt,{path:"/aboutus/whoarewe",element:r.jsx(H5,{})}),r.jsx(tt,{path:"/aboutus/whyus",element:r.jsx(J5,{})}),r.jsx(tt,{path:"/aboutus/foundermessages",element:r.jsx(l_,{})}),r.jsx(tt,{path:"/aboutus/goals",element:r.jsx(d_,{})}),r.jsx(tt,{path:"/aboutus/research",element:r.jsx(g_,{})}),r.jsx(tt,{path:"/services",element:r.jsx(q_,{})}),r.jsx(tt,{path:"/services/speech-therapy",element:r.jsx(n_,{})}),r.jsx(tt,{path:"/services/assessment-evaluation",element:r.jsx(r_,{})}),r.jsx(tt,{path:"/services/behaviour-modification",element:r.jsx(b_,{})}),r.jsx(tt,{path:"/services/occupational-therapy",element:r.jsx(iO,{})}),r.jsx(tt,{path:"/services/remedial-therapy",element:r.jsx(v_,{})}),r.jsx(tt,{path:"/services/behaviour-therapy",element:r.jsx(F_,{})}),r.jsx(tt,{path:"/contact",element:r.jsx(X5,{})}),r.jsx(tt,{path:"/ourbranches",element:r.jsx(C_,{})}),r.jsx(tt,{path:"/training",element:r.jsx(M_,{})}),r.jsx(tt,{path:"/faq",element:r.jsx(Y_,{})}),r.jsx(tt,{path:"/terms-and-conditions",element:r.jsx(nO,{})}),r.jsx(tt,{path:"/media/photos",element:r.jsx(DF,{})}),r.jsx(tt,{path:"/media/videos",element:r.jsx(OF,{})}),r.jsx(tt,{path:"/login",element:r.jsx(Wpe,{})}),r.jsx(tt,{path:"/register",element:r.jsx(c8,{})}),r.jsx(tt,{path:"/facedetection",element:r.jsx(Zn,{requiredRole:["therapist"],children:r.jsx(Epe,{})})}),r.jsx(tt,{path:"/doctordashboard",element:r.jsx(Zn,{requiredRole:["doctor"],children:r.jsx(YF,{})})}),r.jsx(tt,{path:"/doctordashboard/iepdoctor",element:r.jsx(Zn,{requiredRole:["doctor"],children:r.jsx(QF,{})})}),r.jsx(tt,{path:"/doctordashboard/viewappointment",element:r.jsx(Zn,{requiredRole:["doctor"],children:r.jsx(t8,{})})}),r.jsx(tt,{path:"/admindashboard/*",element:r.jsx(Zn,{requiredRole:["admin"],children:r.jsx(O8,{})})}),r.jsx(tt,{path:"/admindashboard/child/:childId/edit",element:r.jsx(KF,{})}),r.jsx(tt,{path:"/parentwrapper",element:r.jsx(N4,{})}),r.jsx(tt,{path:"/therapistdashboard",element:r.jsx(Zn,{requiredRole:["therapist"],children:r.jsx(XF,{})})}),r.jsx(tt,{path:"/therapistdashboard/iep",element:r.jsx(Zn,{requiredRole:["therapist"],children:r.jsx(JF,{})})}),r.jsx(tt,{path:"/games",element:r.jsx(d8,{})}),r.jsx(tt,{path:"/parentdashboard/*",element:r.jsx(Zn,{requiredRole:["parent"],children:r.jsx(N4,{})})}),r.jsx(tt,{path:"/reports",element:r.jsx(Zn,{requiredRole:["admin","doctor","therapist"],children:r.jsx(Dk,{})})}),r.jsx(tt,{path:"/iepreports/:childId",element:r.jsx(Zn,{requiredRole:["parent"],children:r.jsx(Rk,{})})}),r.jsx(tt,{path:"/profile",element:r.jsx(Zn,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(y8,{})})}),r.jsx(tt,{path:"/calendar",element:r.jsx(Zn,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(C8,{})})}),r.jsx(tt,{path:"/codeofconduct",element:r.jsx(Zn,{requiredRole:["therapist"],children:r.jsx(e8,{})})}),r.jsx(tt,{path:"/announcements",element:r.jsx(Zn,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(j8,{})})}),r.jsx(tt,{path:"/superadmin/*",element:r.jsx(Zn,{requiredRole:["superadmin"],children:r.jsx(Gpe,{})})}),r.jsx(tt,{path:"*",element:r.jsx(MF,{})})]})}),r.jsx(G5,{})]});function qpe(){const s=jh();return F.useEffect(()=>{const e=sessionStorage.getItem("token");if(e){const t=Nr(e),n=t.role;s(Ak({token:e,role:n,details:t.user}))}},[]),r.jsx("div",{className:"min-h-screen flex flex-col",children:r.jsxs($6,{children:[r.jsx(lg,{}),r.jsx(Hpe,{})]})})}const Kpe={centreChildren:[],centreDoctors:[],centreTherapists:[],selectedCentreChild:null,selectedCentreDoctor:null,selectedCentreTherapist:null,appointmentDate:null,appointmentTime:null,loading:!1,error:null},UD=wk({name:"centre",initialState:Kpe,reducers:{setCentreChildren:(s,e)=>{s.centreChildren=e.payload},setCentreDoctors:(s,e)=>{s.centreDoctors=e.payload},setCentreTherapists:(s,e)=>{s.centreTherapists=e.payload},setSelectedCentreChild:(s,e)=>{s.selectedCentreChild=e.payload},setSelectedCentreDoctor:(s,e)=>{s.selectedCentreDoctor=e.payload},setSelectedCentreTherapist:(s,e)=>{s.selectedCentreTherapist=e.payload},setCentreAppointmentDate:(s,e)=>{s.appointmentDate=e.payload},setCentreAppointmentTime:(s,e)=>{s.appointmentTime=e.payload}}}),{setCentreChildren:dfe,setCentreDoctors:hfe,setCentreTherapists:pfe,setSelectedCentreChild:ffe,setSelectedCentreDoctor:mfe,setSelectedCentreTherapist:gfe,setAppointmentDate:xfe,setAppointmentTime:bfe}=UD.actions,Xpe=UD.reducer,Ype=j6({reducer:{auth:L5,admin:Xpe}});Le.defaults.baseURL="\r\nhttps://testingtotalapi.joywithlearning.com";B6.createRoot(document.getElementById("root")).render(r.jsx(T6,{store:Ype,children:r.jsx(qpe,{})}));export{Zpe as __vite_legacy_guard};
