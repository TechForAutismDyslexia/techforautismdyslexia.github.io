import{r as C6,a as j6,c as l4,g as k6,b as T6}from"./react-DoC2WAmd.js";import{r as F,a as Sj,u as Th,b as Ml,d as I6,P as $6}from"./redux-DhCfbEIO.js";import{H as Dy}from"./helmet-g7oBtJdQ.js";import{L as ot,u as xs,a as Bo,N as Eo,b as Vo,c as A6,R as ig,d as st,B as E6}from"./router-BTCeqOFl.js";import{G as qn,U as Cj,C as Hr,a as jj,b as D6,c as kj,M as Tj,H as R6,d as O6,e as _6}from"./ui-D2osSqbx.js";import{a as Pe,j as Cr,E as Ry,b as R1,_ as fa,f as Ij,p as c4}from"./utils-B5cH8NR2.js";import{L as ao,y as Ve}from"./toast-CnDYsJwX.js";import"./modal-Chjiymov.js";function efe(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function F6(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(s,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var e1={exports:{}},Qd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u4;function L6(){if(u4)return Qd;u4=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,o){var i=null;if(o!==void 0&&(i=""+o),a.key!==void 0&&(i=""+a.key),"key"in a){o={};for(var c in a)c!=="key"&&(o[c]=a[c])}else o=a;return a=o.ref,{$$typeof:s,type:n,key:i,ref:a!==void 0?a:null,props:o}}return Qd.Fragment=e,Qd.jsx=t,Qd.jsxs=t,Qd}var d4;function M6(){return d4||(d4=1,e1.exports=L6()),e1.exports}var r=M6(),t1={exports:{}},Jd={},s1={exports:{}},n1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h4;function P6(){return h4||(h4=1,function(s){function e(B,G){var Y=B.length;B.push(G);e:for(;0<Y;){var Z=Y-1>>>1,J=B[Z];if(0<a(J,G))B[Z]=G,B[Y]=J,Y=Z;else break e}}function t(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var G=B[0],Y=B.pop();if(Y!==G){B[0]=Y;e:for(var Z=0,J=B.length,xe=J>>>1;Z<xe;){var ye=2*(Z+1)-1,ve=B[ye],Re=ye+1,Ce=B[Re];if(0>a(ve,Y))Re<J&&0>a(Ce,ve)?(B[Z]=Ce,B[Re]=Y,Z=Re):(B[Z]=ve,B[ye]=Y,Z=ye);else if(Re<J&&0>a(Ce,Y))B[Z]=Ce,B[Re]=Y,Z=Re;else break e}}return G}function a(B,G){var Y=B.sortIndex-G.sortIndex;return Y!==0?Y:B.id-G.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var i=Date,c=i.now();s.unstable_now=function(){return i.now()-c}}var u=[],h=[],p=1,f=null,g=3,b=!1,y=!1,w=!1,v=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function I(B){for(var G=t(h);G!==null;){if(G.callback===null)n(h);else if(G.startTime<=B)n(h),G.sortIndex=G.expirationTime,e(u,G);else break;G=t(h)}}function $(B){if(w=!1,I(B),!y)if(t(u)!==null)y=!0,R||(R=!0,U());else{var G=t(h);G!==null&&X($,G.startTime-B)}}var R=!1,O=-1,P=5,_=-1;function M(){return v?!0:!(s.unstable_now()-_<P)}function A(){if(v=!1,R){var B=s.unstable_now();_=B;var G=!0;try{e:{y=!1,w&&(w=!1,C(O),O=-1),b=!0;var Y=g;try{t:{for(I(B),f=t(u);f!==null&&!(f.expirationTime>B&&M());){var Z=f.callback;if(typeof Z=="function"){f.callback=null,g=f.priorityLevel;var J=Z(f.expirationTime<=B);if(B=s.unstable_now(),typeof J=="function"){f.callback=J,I(B),G=!0;break t}f===t(u)&&n(u),I(B)}else n(u);f=t(u)}if(f!==null)G=!0;else{var xe=t(h);xe!==null&&X($,xe.startTime-B),G=!1}}break e}finally{f=null,g=Y,b=!1}G=void 0}}finally{G?U():R=!1}}}var U;if(typeof T=="function")U=function(){T(A)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=A,U=function(){Q.postMessage(null)}}else U=function(){N(A,0)};function X(B,G){O=N(function(){B(s.unstable_now())},G)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(B){B.callback=null},s.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<B?Math.floor(1e3/B):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_next=function(B){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var Y=g;g=G;try{return B()}finally{g=Y}},s.unstable_requestPaint=function(){v=!0},s.unstable_runWithPriority=function(B,G){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Y=g;g=B;try{return G()}finally{g=Y}},s.unstable_scheduleCallback=function(B,G,Y){var Z=s.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?Z+Y:Z):Y=Z,B){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Y+J,B={id:p++,callback:G,priorityLevel:B,startTime:Y,expirationTime:J,sortIndex:-1},Y>Z?(B.sortIndex=Y,e(h,B),t(u)===null&&B===t(h)&&(w?(C(O),O=-1):w=!0,X($,Y-Z))):(B.sortIndex=J,e(u,B),y||b||(y=!0,R||(R=!0,U()))),B},s.unstable_shouldYield=M,s.unstable_wrapCallback=function(B){var G=g;return function(){var Y=g;g=G;try{return B.apply(this,arguments)}finally{g=Y}}}}(n1)),n1}var p4;function z6(){return p4||(p4=1,s1.exports=P6()),s1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f4;function B6(){if(f4)return Jd;f4=1;var s=z6(),e=C6(),t=j6();function n(l){var d="https://react.dev/errors/"+l;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function o(l){var d=l,m=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(m=d.return),l=d.return;while(l)}return d.tag===3?m:null}function i(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function c(l){if(o(l)!==l)throw Error(n(188))}function u(l){var d=l.alternate;if(!d){if(d=o(l),d===null)throw Error(n(188));return d!==l?null:l}for(var m=l,x=d;;){var S=m.return;if(S===null)break;var k=S.alternate;if(k===null){if(x=S.return,x!==null){m=x;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===m)return c(S),l;if(k===x)return c(S),d;k=k.sibling}throw Error(n(188))}if(m.return!==x.return)m=S,x=k;else{for(var L=!1,W=S.child;W;){if(W===m){L=!0,m=S,x=k;break}if(W===x){L=!0,x=S,m=k;break}W=W.sibling}if(!L){for(W=k.child;W;){if(W===m){L=!0,m=k,x=S;break}if(W===x){L=!0,x=k,m=S;break}W=W.sibling}if(!L)throw Error(n(189))}}if(m.alternate!==x)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:d}function h(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l;for(l=l.child;l!==null;){if(d=h(l),d!==null)return d;l=l.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function U(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}var K=Symbol.for("react.client.reference");function Q(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===K?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case v:return"Profiler";case w:return"StrictMode";case $:return"Suspense";case R:return"SuspenseList";case _:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case b:return"Portal";case T:return(l.displayName||"Context")+".Provider";case C:return(l._context.displayName||"Context")+".Consumer";case I:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case O:return d=l.displayName||null,d!==null?d:Q(l.type)||"Memo";case P:d=l._payload,l=l._init;try{return Q(l(d))}catch(m){}}return null}var X=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},Z=[],J=-1;function xe(l){return{current:l}}function ye(l){0>J||(l.current=Z[J],Z[J]=null,J--)}function ve(l,d){J++,Z[J]=l.current,l.current=d}var Re=xe(null),Ce=xe(null),pe=xe(null),Te=xe(null);function ee(l,d){switch(ve(pe,d),ve(Ce,l),ve(Re,null),d.nodeType){case 9:case 11:l=(l=d.documentElement)&&(l=l.namespaceURI)?F3(l):0;break;default:if(l=d.tagName,d=d.namespaceURI)d=F3(d),l=L3(d,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}ye(Re),ve(Re,l)}function he(){ye(Re),ye(Ce),ye(pe)}function oe(l){l.memoizedState!==null&&ve(Te,l);var d=Re.current,m=L3(d,l.type);d!==m&&(ve(Ce,l),ve(Re,m))}function Ie(l){Ce.current===l&&(ye(Re),ye(Ce)),Te.current===l&&(ye(Te),qd._currentValue=Y)}var Be=Object.prototype.hasOwnProperty,We=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,be=s.unstable_shouldYield,ue=s.unstable_requestPaint,Fe=s.unstable_now,He=s.unstable_getCurrentPriorityLevel,rt=s.unstable_ImmediatePriority,Je=s.unstable_UserBlockingPriority,Wt=s.unstable_NormalPriority,At=s.unstable_LowPriority,wt=s.unstable_IdlePriority,Ge=s.log,nt=s.unstable_setDisableYieldValue,at=null,pt=null;function jt(l){if(typeof Ge=="function"&&nt(l),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(at,l)}catch(d){}}var It=Math.clz32?Math.clz32:rn,an=Math.log,$s=Math.LN2;function rn(l){return l>>>=0,l===0?32:31-(an(l)/$s|0)|0}var Fn=256,Yn=4194304;function As(l){var d=l&42;if(d!==0)return d;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Ps(l,d,m){var x=l.pendingLanes;if(x===0)return 0;var S=0,k=l.suspendedLanes,L=l.pingedLanes;l=l.warmLanes;var W=x&134217727;return W!==0?(x=W&~k,x!==0?S=As(x):(L&=W,L!==0?S=As(L):m||(m=W&~l,m!==0&&(S=As(m))))):(W=x&~k,W!==0?S=As(W):L!==0?S=As(L):m||(m=x&~l,m!==0&&(S=As(m)))),S===0?0:d!==0&&d!==S&&(d&k)===0&&(k=S&-S,m=d&-d,k>=m||k===32&&(m&4194048)!==0)?d:S}function Or(l,d){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&d)===0}function la(l,d){switch(l){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sl(){var l=Fn;return Fn<<=1,(Fn&4194048)===0&&(Fn=256),l}function nl(){var l=Yn;return Yn<<=1,(Yn&62914560)===0&&(Yn=4194304),l}function Ko(l){for(var d=[],m=0;31>m;m++)d.push(l);return d}function on(l,d){l.pendingLanes|=d,d!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Ns(l,d,m,x,S,k){var L=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var W=l.entanglements,te=l.expirationTimes,Ne=l.hiddenUpdates;for(m=L&~m;0<m;){var _e=31-It(m),ze=1<<_e;W[_e]=0,te[_e]=-1;var je=Ne[_e];if(je!==null)for(Ne[_e]=null,_e=0;_e<je.length;_e++){var $e=je[_e];$e!==null&&($e.lane&=-536870913)}m&=~ze}x!==0&&al(l,x,0),k!==0&&S===0&&l.tag!==0&&(l.suspendedLanes|=k&~(L&~d))}function al(l,d,m){l.pendingLanes|=d,l.suspendedLanes&=~d;var x=31-It(d);l.entangledLanes|=d,l.entanglements[x]=l.entanglements[x]|1073741824|m&4194090}function Zn(l,d){var m=l.entangledLanes|=d;for(l=l.entanglements;m;){var x=31-It(m),S=1<<x;S&d|l[x]&d&&(l[x]|=d),m&=~S}}function _r(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Oe(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function et(){var l=G.p;return l!==0?l:(l=window.event,l===void 0?32:s4(l.type))}function Ln(l,d){var m=G.p;try{return G.p=l,d()}finally{G.p=m}}var ln=Math.random().toString(36).slice(2),Ss="__reactFiber$"+ln,Cs="__reactProps$"+ln,Ba="__reactContainer$"+ln,io="__reactEvents$"+ln,Ku="__reactListeners$"+ln,uc="__reactHandles$"+ln,Xu="__reactResources$"+ln,Fr="__reactMarker$"+ln;function dc(l){delete l[Ss],delete l[Cs],delete l[io],delete l[Ku],delete l[uc]}function lo(l){var d=l[Ss];if(d)return d;for(var m=l.parentNode;m;){if(d=m[Ba]||m[Ss]){if(m=d.alternate,d.child!==null||m!==null&&m.child!==null)for(l=B3(l);l!==null;){if(m=l[Ss])return m;l=B3(l)}return d}l=m,m=l.parentNode}return null}function gr(l){if(l=l[Ss]||l[Ba]){var d=l.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return l}return null}function Xo(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l.stateNode;throw Error(n(33))}function co(l){var d=l[Xu];return d||(d=l[Xu]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function Ws(l){l[Fr]=!0}var Xp=new Set,Yu={};function Va(l,d){uo(l,d),uo(l+"Capture",d)}function uo(l,d){for(Yu[l]=d,l=0;l<d.length;l++)Xp.add(d[l])}var Yp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zu={},Zp={};function n0(l){return Be.call(Zp,l)?!0:Be.call(Zu,l)?!1:Yp.test(l)?Zp[l]=!0:(Zu[l]=!0,!1)}function hc(l,d,m){if(n0(d))if(m===null)l.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(d);return;case"boolean":var x=d.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(d);return}}l.setAttribute(d,""+m)}}function pc(l,d,m){if(m===null)l.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttribute(d,""+m)}}function Ua(l,d,m,x){if(x===null)l.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(d,m,""+x)}}var fc,Qp;function Yo(l){if(fc===void 0)try{throw Error()}catch(m){var d=m.stack.trim().match(/\n( *(at )?)/);fc=d&&d[1]||"",Qp=-1<m.stack.indexOf("\n    at")?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+fc+l+Qp}var Qu=!1;function Ju(l,d){if(!l||Qu)return"";Qu=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(d){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch($e){var je=$e}Reflect.construct(l,[],ze)}else{try{ze.call()}catch($e){je=$e}l.call(ze.prototype)}}else{try{throw Error()}catch($e){je=$e}(ze=l())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch($e){if($e&&je&&typeof $e.stack=="string")return[$e.stack,je.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=x.DetermineComponentFrameRoot(),L=k[0],W=k[1];if(L&&W){var te=L.split("\n"),Ne=W.split("\n");for(S=x=0;x<te.length&&!te[x].includes("DetermineComponentFrameRoot");)x++;for(;S<Ne.length&&!Ne[S].includes("DetermineComponentFrameRoot");)S++;if(x===te.length||S===Ne.length)for(x=te.length-1,S=Ne.length-1;1<=x&&0<=S&&te[x]!==Ne[S];)S--;for(;1<=x&&0<=S;x--,S--)if(te[x]!==Ne[S]){if(x!==1||S!==1)do if(x--,S--,0>S||te[x]!==Ne[S]){var _e="\n"+te[x].replace(" at new "," at ");return l.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",l.displayName)),_e}while(1<=x&&0<=S);break}}}finally{Qu=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?Yo(m):""}function Jp(l){switch(l.tag){case 26:case 27:case 5:return Yo(l.type);case 16:return Yo("Lazy");case 13:return Yo("Suspense");case 19:return Yo("SuspenseList");case 0:case 15:return Ju(l.type,!1);case 11:return Ju(l.type.render,!1);case 1:return Ju(l.type,!0);case 31:return Yo("Activity");default:return""}}function ed(l){try{var d="";do d+=Jp(l),l=l.return;while(l);return d}catch(m){return"\nError generating stack: "+m.message+"\n"+m.stack}}function Mn(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function td(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function sd(l){var d=td(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),x=""+l[d];if(!l.hasOwnProperty(d)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,k=m.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return S.call(this)},set:function(L){x=""+L,k.call(this,L)}}),Object.defineProperty(l,d,{enumerable:m.enumerable}),{getValue:function(){return x},setValue:function(L){x=""+L},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Lr(l){l._valueTracker||(l._valueTracker=sd(l))}function ca(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var m=d.getValue(),x="";return l&&(x=td(l)?l.checked?"true":"false":l.value),l=x,l!==m?(d.setValue(l),!0):!1}function mc(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch(d){return l.body}}var a0=/[\n"\\]/g;function Qn(l){return l.replace(a0,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function gc(l,d,m,x,S,k,L,W){l.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?l.type=L:l.removeAttribute("type"),d!=null?L==="number"?(d===0&&l.value===""||l.value!=d)&&(l.value=""+Mn(d)):l.value!==""+Mn(d)&&(l.value=""+Mn(d)):L!=="submit"&&L!=="reset"||l.removeAttribute("value"),d!=null?xc(l,L,Mn(d)):m!=null?xc(l,L,Mn(m)):x!=null&&l.removeAttribute("value"),S==null&&k!=null&&(l.defaultChecked=!!k),S!=null&&(l.checked=S&&typeof S!="function"&&typeof S!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?l.name=""+Mn(W):l.removeAttribute("name")}function Jn(l,d,m,x,S,k,L,W){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(l.type=k),d!=null||m!=null){if(!(k!=="submit"&&k!=="reset"||d!=null))return;m=m!=null?""+Mn(m):"",d=d!=null?""+Mn(d):m,W||d===l.value||(l.value=d),l.defaultValue=d}x=x!=null?x:S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=W?l.checked:!!x,l.defaultChecked=!!x,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(l.name=L)}function xc(l,d,m){d==="number"&&mc(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function Ga(l,d,m,x){if(l=l.options,d){d={};for(var S=0;S<m.length;S++)d["$"+m[S]]=!0;for(m=0;m<l.length;m++)S=d.hasOwnProperty("$"+l[m].value),l[m].selected!==S&&(l[m].selected=S),S&&x&&(l[m].defaultSelected=!0)}else{for(m=""+Mn(m),d=null,S=0;S<l.length;S++){if(l[S].value===m){l[S].selected=!0,x&&(l[S].defaultSelected=!0);return}d!==null||l[S].disabled||(d=l[S])}d!==null&&(d.selected=!0)}}function nd(l,d,m){if(d!=null&&(d=""+Mn(d),d!==l.value&&(l.value=d),m==null)){l.defaultValue!==d&&(l.defaultValue=d);return}l.defaultValue=m!=null?""+Mn(m):""}function bc(l,d,m,x){if(d==null){if(x!=null){if(m!=null)throw Error(n(92));if(X(x)){if(1<x.length)throw Error(n(93));x=x[0]}m=x}m==null&&(m=""),d=m}m=Mn(d),l.defaultValue=m,x=l.textContent,x===m&&x!==""&&x!==null&&(l.value=x)}function Zo(l,d){if(d){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=d;return}}l.textContent=d}var r0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rl(l,d,m){var x=d.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?l.setProperty(d,""):d==="float"?l.cssFloat="":l[d]="":x?l.setProperty(d,m):typeof m!="number"||m===0||r0.has(d)?d==="float"?l.cssFloat=m:l[d]=(""+m).trim():l[d]=m+"px"}function ad(l,d,m){if(d!=null&&typeof d!="object")throw Error(n(62));if(l=l.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||d!=null&&d.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var S in d)x=d[S],d.hasOwnProperty(S)&&m[S]!==x&&rl(l,S,x)}else for(var k in d)d.hasOwnProperty(k)&&rl(l,k,d[k])}function yc(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),i0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qo(l){return i0.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var vc=null;function wc(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ho=null,po=null;function rd(l){var d=gr(l);if(d&&(l=d.stateNode)){var m=l[Cs]||null;e:switch(l=d.stateNode,d.type){case"input":if(gc(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),d=m.name,m.type==="radio"&&d!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Qn(""+d)+'"][type="radio"]'),d=0;d<m.length;d++){var x=m[d];if(x!==l&&x.form===l.form){var S=x[Cs]||null;if(!S)throw Error(n(90));gc(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(d=0;d<m.length;d++)x=m[d],x.form===l.form&&ca(x)}break e;case"textarea":nd(l,m.value,m.defaultValue);break e;case"select":d=m.value,d!=null&&Ga(l,!!m.multiple,d,!1)}}}var Nc=!1;function od(l,d,m){if(Nc)return l(d,m);Nc=!0;try{var x=l(d);return x}finally{if(Nc=!1,(ho!==null||po!==null)&&(Lf(),ho&&(d=ho,l=po,po=ho=null,rd(d),l)))for(d=0;d<l.length;d++)rd(l[d])}}function ol(l,d){var m=l.stateNode;if(m===null)return null;var x=m[Cs]||null;if(x===null)return null;m=x[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,d,typeof m));return m}var Wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),id=!1;if(Wa)try{var il={};Object.defineProperty(il,"passive",{get:function(){id=!0}}),window.addEventListener("test",il,il),window.removeEventListener("test",il,il)}catch(l){id=!1}var Ha=null,Sc=null,Cc=null;function ef(){if(Cc)return Cc;var l,d=Sc,m=d.length,x,S="value"in Ha?Ha.value:Ha.textContent,k=S.length;for(l=0;l<m&&d[l]===S[l];l++);var L=m-l;for(x=1;x<=L&&d[m-x]===S[k-x];x++);return Cc=S.slice(l,1<x?1-x:void 0)}function jc(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function kc(){return!0}function ld(){return!1}function Pn(l){function d(m,x,S,k,L){this._reactName=m,this._targetInst=S,this.type=x,this.nativeEvent=k,this.target=L,this.currentTarget=null;for(var W in l)l.hasOwnProperty(W)&&(m=l[W],this[W]=m?m(k):k[W]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?kc:ld,this.isPropagationStopped=ld,this}return p(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),d}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jo=Pn(fo),ll=p({},fo,{view:0,detail:0}),l0=Pn(ll),cd,ei,cl,Tc=p({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ht,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==cl&&(cl&&l.type==="mousemove"?(cd=l.screenX-cl.screenX,ei=l.screenY-cl.screenY):ei=cd=0,cl=l),cd)},movementY:function(l){return"movementY"in l?l.movementY:ei}}),tf=Pn(Tc),sf=p({},Tc,{dataTransfer:0}),j=Pn(sf),D=p({},ll,{relatedTarget:0}),z=Pn(D),q=p({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),ne=Pn(q),fe=p({},fo,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),ie=Pn(fe),ke=p({},fo,{data:0}),De=Pn(ke),qe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ct={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function St(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=Nt[l])?!!d[l]:!1}function ht(){return St}var $t=p({},ll,{key:function(l){if(l.key){var d=qe[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=jc(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?ct[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ht,charCode:function(l){return l.type==="keypress"?jc(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?jc(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Ut=Pn($t),cs=p({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jt=Pn(cs),cn=p({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ht}),ua=Pn(cn),zn=p({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ht=Pn(zn),zs=p({},Tc,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=Pn(zs),HD=p({},fo,{newState:0,oldState:0}),qD=Pn(HD),KD=[9,13,27,32],c0=Wa&&"CompositionEvent"in window,ud=null;Wa&&"documentMode"in document&&(ud=document.documentMode);var XD=Wa&&"TextEvent"in window&&!ud,Ww=Wa&&(!c0||ud&&8<ud&&11>=ud),Hw=" ",qw=!1;function Kw(l,d){switch(l){case"keyup":return KD.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xw(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Ic=!1;function YD(l,d){switch(l){case"compositionend":return Xw(d);case"keypress":return d.which!==32?null:(qw=!0,Hw);case"textInput":return l=d.data,l===Hw&&qw?null:l;default:return null}}function ZD(l,d){if(Ic)return l==="compositionend"||!c0&&Kw(l,d)?(l=ef(),Cc=Sc=Ha=null,Ic=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Ww&&d.locale!=="ko"?null:d.data;default:return null}}var QD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yw(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!QD[l.type]:d==="textarea"}function Zw(l,d,m,x){ho?po?po.push(x):po=[x]:ho=x,d=Uf(d,"onChange"),0<d.length&&(m=new Jo("onChange","change",null,m,x),l.push({event:m,listeners:d}))}var dd=null,hd=null;function JD(l){E3(l,0)}function nf(l){var d=Xo(l);if(ca(d))return l}function Qw(l,d){if(l==="change")return d}var Jw=!1;if(Wa){var u0;if(Wa){var d0="oninput"in document;if(!d0){var eN=document.createElement("div");eN.setAttribute("oninput","return;"),d0=typeof eN.oninput=="function"}u0=d0}else u0=!1;Jw=u0&&(!document.documentMode||9<document.documentMode)}function tN(){dd&&(dd.detachEvent("onpropertychange",sN),hd=dd=null)}function sN(l){if(l.propertyName==="value"&&nf(hd)){var d=[];Zw(d,hd,l,wc(l)),od(JD,d)}}function eR(l,d,m){l==="focusin"?(tN(),dd=d,hd=m,dd.attachEvent("onpropertychange",sN)):l==="focusout"&&tN()}function tR(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return nf(hd)}function sR(l,d){if(l==="click")return nf(d)}function nR(l,d){if(l==="input"||l==="change")return nf(d)}function aR(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var Ta=typeof Object.is=="function"?Object.is:aR;function pd(l,d){if(Ta(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var m=Object.keys(l),x=Object.keys(d);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var S=m[x];if(!Be.call(d,S)||!Ta(l[S],d[S]))return!1}return!0}function nN(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function aN(l,d){var m=nN(l);l=0;for(var x;m;){if(m.nodeType===3){if(x=l+m.textContent.length,l<=d&&x>=d)return{node:m,offset:d-l};l=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=nN(m)}}function rN(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?rN(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function oN(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var d=mc(l.document);d instanceof l.HTMLIFrameElement;){try{var m=typeof d.contentWindow.location.href=="string"}catch(x){m=!1}if(m)l=d.contentWindow;else break;d=mc(l.document)}return d}function h0(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}var rR=Wa&&"documentMode"in document&&11>=document.documentMode,$c=null,p0=null,fd=null,f0=!1;function iN(l,d,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;f0||$c==null||$c!==mc(x)||(x=$c,"selectionStart"in x&&h0(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),fd&&pd(fd,x)||(fd=x,x=Uf(p0,"onSelect"),0<x.length&&(d=new Jo("onSelect","select",null,d,m),l.push({event:d,listeners:x}),d.target=$c)))}function ul(l,d){var m={};return m[l.toLowerCase()]=d.toLowerCase(),m["Webkit"+l]="webkit"+d,m["Moz"+l]="moz"+d,m}var Ac={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionrun:ul("Transition","TransitionRun"),transitionstart:ul("Transition","TransitionStart"),transitioncancel:ul("Transition","TransitionCancel"),transitionend:ul("Transition","TransitionEnd")},m0={},lN={};Wa&&(lN=document.createElement("div").style,"AnimationEvent"in window||(delete Ac.animationend.animation,delete Ac.animationiteration.animation,delete Ac.animationstart.animation),"TransitionEvent"in window||delete Ac.transitionend.transition);function dl(l){if(m0[l])return m0[l];if(!Ac[l])return l;var d=Ac[l],m;for(m in d)if(d.hasOwnProperty(m)&&m in lN)return m0[l]=d[m];return l}var cN=dl("animationend"),uN=dl("animationiteration"),dN=dl("animationstart"),oR=dl("transitionrun"),iR=dl("transitionstart"),lR=dl("transitioncancel"),hN=dl("transitionend"),pN=new Map,g0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");g0.push("scrollEnd");function xr(l,d){pN.set(l,d),Va(d,[l])}var fN=new WeakMap;function qa(l,d){if(typeof l=="object"&&l!==null){var m=fN.get(l);return m!==void 0?m:(d={value:l,source:d,stack:ed(d)},fN.set(l,d),d)}return{value:l,source:d,stack:ed(d)}}var Ka=[],Ec=0,x0=0;function af(){for(var l=Ec,d=x0=Ec=0;d<l;){var m=Ka[d];Ka[d++]=null;var x=Ka[d];Ka[d++]=null;var S=Ka[d];Ka[d++]=null;var k=Ka[d];if(Ka[d++]=null,x!==null&&S!==null){var L=x.pending;L===null?S.next=S:(S.next=L.next,L.next=S),x.pending=S}k!==0&&mN(m,S,k)}}function rf(l,d,m,x){Ka[Ec++]=l,Ka[Ec++]=d,Ka[Ec++]=m,Ka[Ec++]=x,x0|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function b0(l,d,m,x){return rf(l,d,m,x),of(l)}function Dc(l,d){return rf(l,null,null,d),of(l)}function mN(l,d,m){l.lanes|=m;var x=l.alternate;x!==null&&(x.lanes|=m);for(var S=!1,k=l.return;k!==null;)k.childLanes|=m,x=k.alternate,x!==null&&(x.childLanes|=m),k.tag===22&&(l=k.stateNode,l===null||l._visibility&1||(S=!0)),l=k,k=k.return;return l.tag===3?(k=l.stateNode,S&&d!==null&&(S=31-It(m),l=k.hiddenUpdates,x=l[S],x===null?l[S]=[d]:x.push(d),d.lane=m|536870912),k):null}function of(l){if(50<Pd)throw Pd=0,Cb=null,Error(n(185));for(var d=l.return;d!==null;)l=d,d=l.return;return l.tag===3?l.stateNode:null}var Rc={};function cR(l,d,m,x){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(l,d,m,x){return new cR(l,d,m,x)}function y0(l){return l=l.prototype,!(!l||!l.isReactComponent)}function mo(l,d){var m=l.alternate;return m===null?(m=Ia(l.tag,d,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=d,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,d=l.dependencies,m.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function gN(l,d){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=d,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,d=m.dependencies,l.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),l}function lf(l,d,m,x,S,k){var L=0;if(x=l,typeof l=="function")y0(l)&&(L=1);else if(typeof l=="string")L=d6(l,m,Re.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case _:return l=Ia(31,m,d,S),l.elementType=_,l.lanes=k,l;case y:return hl(m.children,S,k,d);case w:L=8,S|=24;break;case v:return l=Ia(12,m,d,S|2),l.elementType=v,l.lanes=k,l;case $:return l=Ia(13,m,d,S),l.elementType=$,l.lanes=k,l;case R:return l=Ia(19,m,d,S),l.elementType=R,l.lanes=k,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case N:case T:L=10;break e;case C:L=9;break e;case I:L=11;break e;case O:L=14;break e;case P:L=16,x=null;break e}L=29,m=Error(n(130,l===null?"null":typeof l,"")),x=null}return d=Ia(L,m,d,S),d.elementType=l,d.type=x,d.lanes=k,d}function hl(l,d,m,x){return l=Ia(7,l,x,d),l.lanes=m,l}function v0(l,d,m){return l=Ia(6,l,null,d),l.lanes=m,l}function w0(l,d,m){return d=Ia(4,l.children!==null?l.children:[],l.key,d),d.lanes=m,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}var Oc=[],_c=0,cf=null,uf=0,Xa=[],Ya=0,pl=null,go=1,xo="";function fl(l,d){Oc[_c++]=uf,Oc[_c++]=cf,cf=l,uf=d}function xN(l,d,m){Xa[Ya++]=go,Xa[Ya++]=xo,Xa[Ya++]=pl,pl=l;var x=go;l=xo;var S=32-It(x)-1;x&=~(1<<S),m+=1;var k=32-It(d)+S;if(30<k){var L=S-S%5;k=(x&(1<<L)-1).toString(32),x>>=L,S-=L,go=1<<32-It(d)+S|m<<S|x,xo=k+l}else go=1<<k|m<<S|x,xo=l}function N0(l){l.return!==null&&(fl(l,1),xN(l,1,0))}function S0(l){for(;l===cf;)cf=Oc[--_c],Oc[_c]=null,uf=Oc[--_c],Oc[_c]=null;for(;l===pl;)pl=Xa[--Ya],Xa[Ya]=null,xo=Xa[--Ya],Xa[Ya]=null,go=Xa[--Ya],Xa[Ya]=null}var ea=null,Es=null,Yt=!1,ml=null,Pr=!1,C0=Error(n(519));function gl(l){var d=Error(n(418,""));throw xd(qa(d,l)),C0}function bN(l){var d=l.stateNode,m=l.type,x=l.memoizedProps;switch(d[Ss]=l,d[Cs]=x,m){case"dialog":Pt("cancel",d),Pt("close",d);break;case"iframe":case"object":case"embed":Pt("load",d);break;case"video":case"audio":for(m=0;m<Bd.length;m++)Pt(Bd[m],d);break;case"source":Pt("error",d);break;case"img":case"image":case"link":Pt("error",d),Pt("load",d);break;case"details":Pt("toggle",d);break;case"input":Pt("invalid",d),Jn(d,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Lr(d);break;case"select":Pt("invalid",d);break;case"textarea":Pt("invalid",d),bc(d,x.value,x.defaultValue,x.children),Lr(d)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||d.textContent===""+m||x.suppressHydrationWarning===!0||_3(d.textContent,m)?(x.popover!=null&&(Pt("beforetoggle",d),Pt("toggle",d)),x.onScroll!=null&&Pt("scroll",d),x.onScrollEnd!=null&&Pt("scrollend",d),x.onClick!=null&&(d.onclick=Gf),d=!0):d=!1,d||gl(l)}function yN(l){for(ea=l.return;ea;)switch(ea.tag){case 5:case 13:Pr=!1;return;case 27:case 3:Pr=!0;return;default:ea=ea.return}}function md(l){if(l!==ea)return!1;if(!Yt)return yN(l),Yt=!0,!1;var d=l.tag,m;if((m=d!==3&&d!==27)&&((m=d===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||zb(l.type,l.memoizedProps)),m=!m),m&&Es&&gl(l),yN(l),d===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8)if(m=l.data,m==="/$"){if(d===0){Es=yr(l.nextSibling);break e}d--}else m!=="$"&&m!=="$!"&&m!=="$?"||d++;l=l.nextSibling}Es=null}}else d===27?(d=Es,gi(l.type)?(l=Gb,Gb=null,Es=l):Es=d):Es=ea?yr(l.stateNode.nextSibling):null;return!0}function gd(){Es=ea=null,Yt=!1}function vN(){var l=ml;return l!==null&&(pa===null?pa=l:pa.push.apply(pa,l),ml=null),l}function xd(l){ml===null?ml=[l]:ml.push(l)}var j0=xe(null),xl=null,bo=null;function ti(l,d,m){ve(j0,d._currentValue),d._currentValue=m}function yo(l){l._currentValue=j0.current,ye(j0)}function k0(l,d,m){for(;l!==null;){var x=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,x!==null&&(x.childLanes|=d)):x!==null&&(x.childLanes&d)!==d&&(x.childLanes|=d),l===m)break;l=l.return}}function T0(l,d,m,x){var S=l.child;for(S!==null&&(S.return=l);S!==null;){var k=S.dependencies;if(k!==null){var L=S.child;k=k.firstContext;e:for(;k!==null;){var W=k;k=S;for(var te=0;te<d.length;te++)if(W.context===d[te]){k.lanes|=m,W=k.alternate,W!==null&&(W.lanes|=m),k0(k.return,m,l),x||(L=null);break e}k=W.next}}else if(S.tag===18){if(L=S.return,L===null)throw Error(n(341));L.lanes|=m,k=L.alternate,k!==null&&(k.lanes|=m),k0(L,m,l),L=null}else L=S.child;if(L!==null)L.return=S;else for(L=S;L!==null;){if(L===l){L=null;break}if(S=L.sibling,S!==null){S.return=L.return,L=S;break}L=L.return}S=L}}function bd(l,d,m,x){l=null;for(var S=d,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var L=S.alternate;if(L===null)throw Error(n(387));if(L=L.memoizedProps,L!==null){var W=S.type;Ta(S.pendingProps.value,L.value)||(l!==null?l.push(W):l=[W])}}else if(S===Te.current){if(L=S.alternate,L===null)throw Error(n(387));L.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(l!==null?l.push(qd):l=[qd])}S=S.return}l!==null&&T0(d,l,m,x),d.flags|=262144}function df(l){for(l=l.firstContext;l!==null;){if(!Ta(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function bl(l){xl=l,bo=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Bn(l){return wN(xl,l)}function hf(l,d){return xl===null&&bl(l),wN(l,d)}function wN(l,d){var m=d._currentValue;if(d={context:d,memoizedValue:m,next:null},bo===null){if(l===null)throw Error(n(308));bo=d,l.dependencies={lanes:0,firstContext:d},l.flags|=524288}else bo=bo.next=d;return m}var uR=typeof AbortController<"u"?AbortController:function(){var l=[],d=this.signal={aborted:!1,addEventListener:function(m,x){l.push(x)}};this.abort=function(){d.aborted=!0,l.forEach(function(m){return m()})}},dR=s.unstable_scheduleCallback,hR=s.unstable_NormalPriority,un={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function I0(){return{controller:new uR,data:new Map,refCount:0}}function yd(l){l.refCount--,l.refCount===0&&dR(hR,function(){l.controller.abort()})}var vd=null,$0=0,Fc=0,Lc=null;function pR(l,d){if(vd===null){var m=vd=[];$0=0,Fc=Eb(),Lc={status:"pending",value:void 0,then:function(x){m.push(x)}}}return $0++,d.then(NN,NN),d}function NN(){if(--$0===0&&vd!==null){Lc!==null&&(Lc.status="fulfilled");var l=vd;vd=null,Fc=0,Lc=null;for(var d=0;d<l.length;d++)(0,l[d])()}}function fR(l,d){var m=[],x={status:"pending",value:null,reason:null,then:function(S){m.push(S)}};return l.then(function(){x.status="fulfilled",x.value=d;for(var S=0;S<m.length;S++)(0,m[S])(d)},function(S){for(x.status="rejected",x.reason=S,S=0;S<m.length;S++)(0,m[S])(void 0)}),x}var SN=B.S;B.S=function(l,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&pR(l,d),SN!==null&&SN(l,d)};var yl=xe(null);function A0(){var l=yl.current;return l!==null?l:ps.pooledCache}function pf(l,d){d===null?ve(yl,yl.current):ve(yl,d.pool)}function CN(){var l=A0();return l===null?null:{parent:un._currentValue,pool:l}}var wd=Error(n(460)),jN=Error(n(474)),ff=Error(n(542)),E0={then:function(){}};function kN(l){return l=l.status,l==="fulfilled"||l==="rejected"}function mf(){}function TN(l,d,m){switch(m=l[m],m===void 0?l.push(d):m!==d&&(d.then(mf,mf),d=m),d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,$N(l),l;default:if(typeof d.status=="string")d.then(mf,mf);else{if(l=ps,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=d,l.status="pending",l.then(function(x){if(d.status==="pending"){var S=d;S.status="fulfilled",S.value=x}},function(x){if(d.status==="pending"){var S=d;S.status="rejected",S.reason=x}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,$N(l),l}throw Nd=d,wd}}var Nd=null;function IN(){if(Nd===null)throw Error(n(459));var l=Nd;return Nd=null,l}function $N(l){if(l===wd||l===ff)throw Error(n(483))}var si=!1;function D0(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function R0(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function ni(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function ai(l,d,m){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(es&2)!==0){var S=x.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),x.pending=d,d=of(l),mN(l,null,m),d}return rf(l,x,d,m),of(l)}function Sd(l,d,m){if(d=d.updateQueue,d!==null&&(d=d.shared,(m&4194048)!==0)){var x=d.lanes;x&=l.pendingLanes,m|=x,d.lanes=m,Zn(l,m)}}function O0(l,d){var m=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var S=null,k=null;if(m=m.firstBaseUpdate,m!==null){do{var L={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};k===null?S=k=L:k=k.next=L,m=m.next}while(m!==null);k===null?S=k=d:k=k.next=d}else S=k=d;m={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:x.shared,callbacks:x.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=d:l.next=d,m.lastBaseUpdate=d}var _0=!1;function Cd(){if(_0){var l=Lc;if(l!==null)throw l}}function jd(l,d,m,x){_0=!1;var S=l.updateQueue;si=!1;var k=S.firstBaseUpdate,L=S.lastBaseUpdate,W=S.shared.pending;if(W!==null){S.shared.pending=null;var te=W,Ne=te.next;te.next=null,L===null?k=Ne:L.next=Ne,L=te;var _e=l.alternate;_e!==null&&(_e=_e.updateQueue,W=_e.lastBaseUpdate,W!==L&&(W===null?_e.firstBaseUpdate=Ne:W.next=Ne,_e.lastBaseUpdate=te))}if(k!==null){var ze=S.baseState;L=0,_e=Ne=te=null,W=k;do{var je=W.lane&-536870913,$e=je!==W.lane;if($e?(qt&je)===je:(x&je)===je){je!==0&&je===Fc&&(_0=!0),_e!==null&&(_e=_e.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});e:{var Ct=l,xt=W;je=d;var rs=m;switch(xt.tag){case 1:if(Ct=xt.payload,typeof Ct=="function"){ze=Ct.call(rs,ze,je);break e}ze=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=xt.payload,je=typeof Ct=="function"?Ct.call(rs,ze,je):Ct,je==null)break e;ze=p({},ze,je);break e;case 2:si=!0}}je=W.callback,je!==null&&(l.flags|=64,$e&&(l.flags|=8192),$e=S.callbacks,$e===null?S.callbacks=[je]:$e.push(je))}else $e={lane:je,tag:W.tag,payload:W.payload,callback:W.callback,next:null},_e===null?(Ne=_e=$e,te=ze):_e=_e.next=$e,L|=je;if(W=W.next,W===null){if(W=S.shared.pending,W===null)break;$e=W,W=$e.next,$e.next=null,S.lastBaseUpdate=$e,S.shared.pending=null}}while(!0);_e===null&&(te=ze),S.baseState=te,S.firstBaseUpdate=Ne,S.lastBaseUpdate=_e,k===null&&(S.shared.lanes=0),hi|=L,l.lanes=L,l.memoizedState=ze}}function AN(l,d){if(typeof l!="function")throw Error(n(191,l));l.call(d)}function EN(l,d){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)AN(m[l],d)}var Mc=xe(null),gf=xe(0);function DN(l,d){l=ko,ve(gf,l),ve(Mc,d),ko=l|d.baseLanes}function F0(){ve(gf,ko),ve(Mc,Mc.current)}function L0(){ko=gf.current,ye(Mc),ye(gf)}var ri=0,_t=null,ns=null,Hs=null,xf=!1,Pc=!1,vl=!1,bf=0,kd=0,zc=null,mR=0;function Bs(){throw Error(n(321))}function M0(l,d){if(d===null)return!1;for(var m=0;m<d.length&&m<l.length;m++)if(!Ta(l[m],d[m]))return!1;return!0}function P0(l,d,m,x,S,k){return ri=k,_t=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,B.H=l===null||l.memoizedState===null?mS:gS,vl=!1,k=m(x,S),vl=!1,Pc&&(k=ON(d,m,x,S)),RN(l),k}function RN(l){B.H=Cf;var d=ns!==null&&ns.next!==null;if(ri=0,Hs=ns=_t=null,xf=!1,kd=0,zc=null,d)throw Error(n(300));l===null||xn||(l=l.dependencies,l!==null&&df(l)&&(xn=!0))}function ON(l,d,m,x){_t=l;var S=0;do{if(Pc&&(zc=null),kd=0,Pc=!1,25<=S)throw Error(n(301));if(S+=1,Hs=ns=null,l.updateQueue!=null){var k=l.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}B.H=NR,k=d(m,x)}while(Pc);return k}function gR(){var l=B.H,d=l.useState()[0];return d=typeof d.then=="function"?Td(d):d,l=l.useState()[0],(ns!==null?ns.memoizedState:null)!==l&&(_t.flags|=1024),d}function z0(){var l=bf!==0;return bf=0,l}function B0(l,d,m){d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~m}function V0(l){if(xf){for(l=l.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}xf=!1}ri=0,Hs=ns=_t=null,Pc=!1,kd=bf=0,zc=null}function da(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hs===null?_t.memoizedState=Hs=l:Hs=Hs.next=l,Hs}function qs(){if(ns===null){var l=_t.alternate;l=l!==null?l.memoizedState:null}else l=ns.next;var d=Hs===null?_t.memoizedState:Hs.next;if(d!==null)Hs=d,ns=l;else{if(l===null)throw _t.alternate===null?Error(n(467)):Error(n(310));ns=l,l={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},Hs===null?_t.memoizedState=Hs=l:Hs=Hs.next=l}return Hs}function U0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Td(l){var d=kd;return kd+=1,zc===null&&(zc=[]),l=TN(zc,l,d),d=_t,(Hs===null?d.memoizedState:Hs.next)===null&&(d=d.alternate,B.H=d===null||d.memoizedState===null?mS:gS),l}function yf(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Td(l);if(l.$$typeof===T)return Bn(l)}throw Error(n(438,String(l)))}function G0(l){var d=null,m=_t.updateQueue;if(m!==null&&(d=m.memoCache),d==null){var x=_t.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(d={data:x.data.map(function(S){return S.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),m===null&&(m=U0(),_t.updateQueue=m),m.memoCache=d,m=d.data[d.index],m===void 0)for(m=d.data[d.index]=Array(l),x=0;x<l;x++)m[x]=M;return d.index++,m}function vo(l,d){return typeof d=="function"?d(l):d}function vf(l){var d=qs();return W0(d,ns,l)}function W0(l,d,m){var x=l.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=m;var S=l.baseQueue,k=x.pending;if(k!==null){if(S!==null){var L=S.next;S.next=k.next,k.next=L}d.baseQueue=S=k,x.pending=null}if(k=l.baseState,S===null)l.memoizedState=k;else{d=S.next;var W=L=null,te=null,Ne=d,_e=!1;do{var ze=Ne.lane&-536870913;if(ze!==Ne.lane?(qt&ze)===ze:(ri&ze)===ze){var je=Ne.revertLane;if(je===0)te!==null&&(te=te.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),ze===Fc&&(_e=!0);else if((ri&je)===je){Ne=Ne.next,je===Fc&&(_e=!0);continue}else ze={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},te===null?(W=te=ze,L=k):te=te.next=ze,_t.lanes|=je,hi|=je;ze=Ne.action,vl&&m(k,ze),k=Ne.hasEagerState?Ne.eagerState:m(k,ze)}else je={lane:ze,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},te===null?(W=te=je,L=k):te=te.next=je,_t.lanes|=ze,hi|=ze;Ne=Ne.next}while(Ne!==null&&Ne!==d);if(te===null?L=k:te.next=W,!Ta(k,l.memoizedState)&&(xn=!0,_e&&(m=Lc,m!==null)))throw m;l.memoizedState=k,l.baseState=L,l.baseQueue=te,x.lastRenderedState=k}return S===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function H0(l){var d=qs(),m=d.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var x=m.dispatch,S=m.pending,k=d.memoizedState;if(S!==null){m.pending=null;var L=S=S.next;do k=l(k,L.action),L=L.next;while(L!==S);Ta(k,d.memoizedState)||(xn=!0),d.memoizedState=k,d.baseQueue===null&&(d.baseState=k),m.lastRenderedState=k}return[k,x]}function _N(l,d,m){var x=_t,S=qs(),k=Yt;if(k){if(m===void 0)throw Error(n(407));m=m()}else m=d();var L=!Ta((ns||S).memoizedState,m);L&&(S.memoizedState=m,xn=!0),S=S.queue;var W=MN.bind(null,x,S,l);if(Id(2048,8,W,[l]),S.getSnapshot!==d||L||Hs!==null&&Hs.memoizedState.tag&1){if(x.flags|=2048,Bc(9,wf(),LN.bind(null,x,S,m,d),null),ps===null)throw Error(n(349));k||(ri&124)!==0||FN(x,d,m)}return m}function FN(l,d,m){l.flags|=16384,l={getSnapshot:d,value:m},d=_t.updateQueue,d===null?(d=U0(),_t.updateQueue=d,d.stores=[l]):(m=d.stores,m===null?d.stores=[l]:m.push(l))}function LN(l,d,m,x){d.value=m,d.getSnapshot=x,PN(d)&&zN(l)}function MN(l,d,m){return m(function(){PN(d)&&zN(l)})}function PN(l){var d=l.getSnapshot;l=l.value;try{var m=d();return!Ta(l,m)}catch(x){return!0}}function zN(l){var d=Dc(l,2);d!==null&&Ra(d,l,2)}function q0(l){var d=da();if(typeof l=="function"){var m=l;if(l=m(),vl){jt(!0);try{m()}finally{jt(!1)}}}return d.memoizedState=d.baseState=l,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:l},d}function BN(l,d,m,x){return l.baseState=m,W0(l,ns,typeof x=="function"?x:vo)}function xR(l,d,m,x,S){if(Sf(l))throw Error(n(485));if(l=d.action,l!==null){var k={payload:S,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){k.listeners.push(L)}};B.T!==null?m(!0):k.isTransition=!1,x(k),m=d.pending,m===null?(k.next=d.pending=k,VN(d,k)):(k.next=m.next,d.pending=m.next=k)}}function VN(l,d){var m=d.action,x=d.payload,S=l.state;if(d.isTransition){var k=B.T,L={};B.T=L;try{var W=m(S,x),te=B.S;te!==null&&te(L,W),UN(l,d,W)}catch(Ne){K0(l,d,Ne)}finally{B.T=k}}else try{k=m(S,x),UN(l,d,k)}catch(Ne){K0(l,d,Ne)}}function UN(l,d,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){GN(l,d,x)},function(x){return K0(l,d,x)}):GN(l,d,m)}function GN(l,d,m){d.status="fulfilled",d.value=m,WN(d),l.state=m,d=l.pending,d!==null&&(m=d.next,m===d?l.pending=null:(m=m.next,d.next=m,VN(l,m)))}function K0(l,d,m){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do d.status="rejected",d.reason=m,WN(d),d=d.next;while(d!==x)}l.action=null}function WN(l){l=l.listeners;for(var d=0;d<l.length;d++)(0,l[d])()}function HN(l,d){return d}function qN(l,d){if(Yt){var m=ps.formState;if(m!==null){e:{var x=_t;if(Yt){if(Es){t:{for(var S=Es,k=Pr;S.nodeType!==8;){if(!k){S=null;break t}if(S=yr(S.nextSibling),S===null){S=null;break t}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){Es=yr(S.nextSibling),x=S.data==="F!";break e}}gl(x)}x=!1}x&&(d=m[0])}}return m=da(),m.memoizedState=m.baseState=d,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:HN,lastRenderedState:d},m.queue=x,m=hS.bind(null,_t,x),x.dispatch=m,x=q0(!1),k=J0.bind(null,_t,!1,x.queue),x=da(),S={state:d,dispatch:null,action:l,pending:null},x.queue=S,m=xR.bind(null,_t,S,k,m),S.dispatch=m,x.memoizedState=l,[d,m,!1]}function KN(l){var d=qs();return XN(d,ns,l)}function XN(l,d,m){if(d=W0(l,d,HN)[0],l=vf(vo)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var x=Td(d)}catch(L){throw L===wd?ff:L}else x=d;d=qs();var S=d.queue,k=S.dispatch;return m!==d.memoizedState&&(_t.flags|=2048,Bc(9,wf(),bR.bind(null,S,m),null)),[x,k,l]}function bR(l,d){l.action=d}function YN(l){var d=qs(),m=ns;if(m!==null)return XN(d,m,l);qs(),d=d.memoizedState,m=qs();var x=m.queue.dispatch;return m.memoizedState=l,[d,x,!1]}function Bc(l,d,m,x){return l={tag:l,create:m,deps:x,inst:d,next:null},d=_t.updateQueue,d===null&&(d=U0(),_t.updateQueue=d),m=d.lastEffect,m===null?d.lastEffect=l.next=l:(x=m.next,m.next=l,l.next=x,d.lastEffect=l),l}function wf(){return{destroy:void 0,resource:void 0}}function ZN(){return qs().memoizedState}function Nf(l,d,m,x){var S=da();x=x===void 0?null:x,_t.flags|=l,S.memoizedState=Bc(1|d,wf(),m,x)}function Id(l,d,m,x){var S=qs();x=x===void 0?null:x;var k=S.memoizedState.inst;ns!==null&&x!==null&&M0(x,ns.memoizedState.deps)?S.memoizedState=Bc(d,k,m,x):(_t.flags|=l,S.memoizedState=Bc(1|d,k,m,x))}function QN(l,d){Nf(8390656,8,l,d)}function JN(l,d){Id(2048,8,l,d)}function eS(l,d){return Id(4,2,l,d)}function tS(l,d){return Id(4,4,l,d)}function sS(l,d){if(typeof d=="function"){l=l();var m=d(l);return function(){typeof m=="function"?m():d(null)}}if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function nS(l,d,m){m=m!=null?m.concat([l]):null,Id(4,4,sS.bind(null,d,l),m)}function X0(){}function aS(l,d){var m=qs();d=d===void 0?null:d;var x=m.memoizedState;return d!==null&&M0(d,x[1])?x[0]:(m.memoizedState=[l,d],l)}function rS(l,d){var m=qs();d=d===void 0?null:d;var x=m.memoizedState;if(d!==null&&M0(d,x[1]))return x[0];if(x=l(),vl){jt(!0);try{l()}finally{jt(!1)}}return m.memoizedState=[x,d],x}function Y0(l,d,m){return m===void 0||(ri&1073741824)!==0?l.memoizedState=d:(l.memoizedState=m,l=l3(),_t.lanes|=l,hi|=l,m)}function oS(l,d,m,x){return Ta(m,d)?m:Mc.current!==null?(l=Y0(l,m,x),Ta(l,d)||(xn=!0),l):(ri&42)===0?(xn=!0,l.memoizedState=m):(l=l3(),_t.lanes|=l,hi|=l,d)}function iS(l,d,m,x,S){var k=G.p;G.p=k!==0&&8>k?k:8;var L=B.T,W={};B.T=W,J0(l,!1,d,m);try{var te=S(),Ne=B.S;if(Ne!==null&&Ne(W,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var _e=fR(te,x);$d(l,d,_e,Da(l))}else $d(l,d,x,Da(l))}catch(ze){$d(l,d,{then:function(){},status:"rejected",reason:ze},Da())}finally{G.p=k,B.T=L}}function yR(){}function Z0(l,d,m,x){if(l.tag!==5)throw Error(n(476));var S=lS(l).queue;iS(l,S,d,Y,m===null?yR:function(){return cS(l),m(x)})}function lS(l){var d=l.memoizedState;if(d!==null)return d;d={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:Y},next:null};var m={};return d.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:m},next:null},l.memoizedState=d,l=l.alternate,l!==null&&(l.memoizedState=d),d}function cS(l){var d=lS(l).next.queue;$d(l,d,{},Da())}function Q0(){return Bn(qd)}function uS(){return qs().memoizedState}function dS(){return qs().memoizedState}function vR(l){for(var d=l.return;d!==null;){switch(d.tag){case 24:case 3:var m=Da();l=ni(m);var x=ai(d,l,m);x!==null&&(Ra(x,d,m),Sd(x,d,m)),d={cache:I0()},l.payload=d;return}d=d.return}}function wR(l,d,m){var x=Da();m={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},Sf(l)?pS(d,m):(m=b0(l,d,m,x),m!==null&&(Ra(m,l,x),fS(m,d,x)))}function hS(l,d,m){var x=Da();$d(l,d,m,x)}function $d(l,d,m,x){var S={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(Sf(l))pS(d,S);else{var k=l.alternate;if(l.lanes===0&&(k===null||k.lanes===0)&&(k=d.lastRenderedReducer,k!==null))try{var L=d.lastRenderedState,W=k(L,m);if(S.hasEagerState=!0,S.eagerState=W,Ta(W,L))return rf(l,d,S,0),ps===null&&af(),!1}catch(te){}finally{}if(m=b0(l,d,S,x),m!==null)return Ra(m,l,x),fS(m,d,x),!0}return!1}function J0(l,d,m,x){if(x={lane:2,revertLane:Eb(),action:x,hasEagerState:!1,eagerState:null,next:null},Sf(l)){if(d)throw Error(n(479))}else d=b0(l,m,x,2),d!==null&&Ra(d,l,2)}function Sf(l){var d=l.alternate;return l===_t||d!==null&&d===_t}function pS(l,d){Pc=xf=!0;var m=l.pending;m===null?d.next=d:(d.next=m.next,m.next=d),l.pending=d}function fS(l,d,m){if((m&4194048)!==0){var x=d.lanes;x&=l.pendingLanes,m|=x,d.lanes=m,Zn(l,m)}}var Cf={readContext:Bn,use:yf,useCallback:Bs,useContext:Bs,useEffect:Bs,useImperativeHandle:Bs,useLayoutEffect:Bs,useInsertionEffect:Bs,useMemo:Bs,useReducer:Bs,useRef:Bs,useState:Bs,useDebugValue:Bs,useDeferredValue:Bs,useTransition:Bs,useSyncExternalStore:Bs,useId:Bs,useHostTransitionStatus:Bs,useFormState:Bs,useActionState:Bs,useOptimistic:Bs,useMemoCache:Bs,useCacheRefresh:Bs},mS={readContext:Bn,use:yf,useCallback:function(l,d){return da().memoizedState=[l,d===void 0?null:d],l},useContext:Bn,useEffect:QN,useImperativeHandle:function(l,d,m){m=m!=null?m.concat([l]):null,Nf(4194308,4,sS.bind(null,d,l),m)},useLayoutEffect:function(l,d){return Nf(4194308,4,l,d)},useInsertionEffect:function(l,d){Nf(4,2,l,d)},useMemo:function(l,d){var m=da();d=d===void 0?null:d;var x=l();if(vl){jt(!0);try{l()}finally{jt(!1)}}return m.memoizedState=[x,d],x},useReducer:function(l,d,m){var x=da();if(m!==void 0){var S=m(d);if(vl){jt(!0);try{m(d)}finally{jt(!1)}}}else S=d;return x.memoizedState=x.baseState=S,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:S},x.queue=l,l=l.dispatch=wR.bind(null,_t,l),[x.memoizedState,l]},useRef:function(l){var d=da();return l={current:l},d.memoizedState=l},useState:function(l){l=q0(l);var d=l.queue,m=hS.bind(null,_t,d);return d.dispatch=m,[l.memoizedState,m]},useDebugValue:X0,useDeferredValue:function(l,d){var m=da();return Y0(m,l,d)},useTransition:function(){var l=q0(!1);return l=iS.bind(null,_t,l.queue,!0,!1),da().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,d,m){var x=_t,S=da();if(Yt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=d(),ps===null)throw Error(n(349));(qt&124)!==0||FN(x,d,m)}S.memoizedState=m;var k={value:m,getSnapshot:d};return S.queue=k,QN(MN.bind(null,x,k,l),[l]),x.flags|=2048,Bc(9,wf(),LN.bind(null,x,k,m,d),null),m},useId:function(){var l=da(),d=ps.identifierPrefix;if(Yt){var m=xo,x=go;m=(x&~(1<<32-It(x)-1)).toString(32)+m,d=""+d+"R"+m,m=bf++,0<m&&(d+="H"+m.toString(32)),d+=""}else m=mR++,d=""+d+"r"+m.toString(32)+"";return l.memoizedState=d},useHostTransitionStatus:Q0,useFormState:qN,useActionState:qN,useOptimistic:function(l){var d=da();d.memoizedState=d.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=m,d=J0.bind(null,_t,!0,m),m.dispatch=d,[l,d]},useMemoCache:G0,useCacheRefresh:function(){return da().memoizedState=vR.bind(null,_t)}},gS={readContext:Bn,use:yf,useCallback:aS,useContext:Bn,useEffect:JN,useImperativeHandle:nS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:rS,useReducer:vf,useRef:ZN,useState:function(){return vf(vo)},useDebugValue:X0,useDeferredValue:function(l,d){var m=qs();return oS(m,ns.memoizedState,l,d)},useTransition:function(){var l=vf(vo)[0],d=qs().memoizedState;return[typeof l=="boolean"?l:Td(l),d]},useSyncExternalStore:_N,useId:uS,useHostTransitionStatus:Q0,useFormState:KN,useActionState:KN,useOptimistic:function(l,d){var m=qs();return BN(m,ns,l,d)},useMemoCache:G0,useCacheRefresh:dS},NR={readContext:Bn,use:yf,useCallback:aS,useContext:Bn,useEffect:JN,useImperativeHandle:nS,useInsertionEffect:eS,useLayoutEffect:tS,useMemo:rS,useReducer:H0,useRef:ZN,useState:function(){return H0(vo)},useDebugValue:X0,useDeferredValue:function(l,d){var m=qs();return ns===null?Y0(m,l,d):oS(m,ns.memoizedState,l,d)},useTransition:function(){var l=H0(vo)[0],d=qs().memoizedState;return[typeof l=="boolean"?l:Td(l),d]},useSyncExternalStore:_N,useId:uS,useHostTransitionStatus:Q0,useFormState:YN,useActionState:YN,useOptimistic:function(l,d){var m=qs();return ns!==null?BN(m,ns,l,d):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:G0,useCacheRefresh:dS},Vc=null,Ad=0;function jf(l){var d=Ad;return Ad+=1,Vc===null&&(Vc=[]),TN(Vc,l,d)}function Ed(l,d){d=d.props.ref,l.ref=d!==void 0?d:null}function kf(l,d){throw d.$$typeof===f?Error(n(525)):(l=Object.prototype.toString.call(d),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l)))}function xS(l){var d=l._init;return d(l._payload)}function bS(l){function d(ge,de){if(l){var we=ge.deletions;we===null?(ge.deletions=[de],ge.flags|=16):we.push(de)}}function m(ge,de){if(!l)return null;for(;de!==null;)d(ge,de),de=de.sibling;return null}function x(ge){for(var de=new Map;ge!==null;)ge.key!==null?de.set(ge.key,ge):de.set(ge.index,ge),ge=ge.sibling;return de}function S(ge,de){return ge=mo(ge,de),ge.index=0,ge.sibling=null,ge}function k(ge,de,we){return ge.index=we,l?(we=ge.alternate,we!==null?(we=we.index,we<de?(ge.flags|=67108866,de):we):(ge.flags|=67108866,de)):(ge.flags|=1048576,de)}function L(ge){return l&&ge.alternate===null&&(ge.flags|=67108866),ge}function W(ge,de,we,Le){return de===null||de.tag!==6?(de=v0(we,ge.mode,Le),de.return=ge,de):(de=S(de,we),de.return=ge,de)}function te(ge,de,we,Le){var ut=we.type;return ut===y?_e(ge,de,we.props.children,Le,we.key):de!==null&&(de.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===P&&xS(ut)===de.type)?(de=S(de,we.props),Ed(de,we),de.return=ge,de):(de=lf(we.type,we.key,we.props,null,ge.mode,Le),Ed(de,we),de.return=ge,de)}function Ne(ge,de,we,Le){return de===null||de.tag!==4||de.stateNode.containerInfo!==we.containerInfo||de.stateNode.implementation!==we.implementation?(de=w0(we,ge.mode,Le),de.return=ge,de):(de=S(de,we.children||[]),de.return=ge,de)}function _e(ge,de,we,Le,ut){return de===null||de.tag!==7?(de=hl(we,ge.mode,Le,ut),de.return=ge,de):(de=S(de,we),de.return=ge,de)}function ze(ge,de,we){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return de=v0(""+de,ge.mode,we),de.return=ge,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case g:return we=lf(de.type,de.key,de.props,null,ge.mode,we),Ed(we,de),we.return=ge,we;case b:return de=w0(de,ge.mode,we),de.return=ge,de;case P:var Le=de._init;return de=Le(de._payload),ze(ge,de,we)}if(X(de)||U(de))return de=hl(de,ge.mode,we,null),de.return=ge,de;if(typeof de.then=="function")return ze(ge,jf(de),we);if(de.$$typeof===T)return ze(ge,hf(ge,de),we);kf(ge,de)}return null}function je(ge,de,we,Le){var ut=de!==null?de.key:null;if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return ut!==null?null:W(ge,de,""+we,Le);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case g:return we.key===ut?te(ge,de,we,Le):null;case b:return we.key===ut?Ne(ge,de,we,Le):null;case P:return ut=we._init,we=ut(we._payload),je(ge,de,we,Le)}if(X(we)||U(we))return ut!==null?null:_e(ge,de,we,Le,null);if(typeof we.then=="function")return je(ge,de,jf(we),Le);if(we.$$typeof===T)return je(ge,de,hf(ge,we),Le);kf(ge,we)}return null}function $e(ge,de,we,Le,ut){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return ge=ge.get(we)||null,W(de,ge,""+Le,ut);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case g:return ge=ge.get(Le.key===null?we:Le.key)||null,te(de,ge,Le,ut);case b:return ge=ge.get(Le.key===null?we:Le.key)||null,Ne(de,ge,Le,ut);case P:var Lt=Le._init;return Le=Lt(Le._payload),$e(ge,de,we,Le,ut)}if(X(Le)||U(Le))return ge=ge.get(we)||null,_e(de,ge,Le,ut,null);if(typeof Le.then=="function")return $e(ge,de,we,jf(Le),ut);if(Le.$$typeof===T)return $e(ge,de,we,hf(de,Le),ut);kf(de,Le)}return null}function Ct(ge,de,we,Le){for(var ut=null,Lt=null,mt=de,bt=de=0,yn=null;mt!==null&&bt<we.length;bt++){mt.index>bt?(yn=mt,mt=null):yn=mt.sibling;var Xt=je(ge,mt,we[bt],Le);if(Xt===null){mt===null&&(mt=yn);break}l&&mt&&Xt.alternate===null&&d(ge,mt),de=k(Xt,de,bt),Lt===null?ut=Xt:Lt.sibling=Xt,Lt=Xt,mt=yn}if(bt===we.length)return m(ge,mt),Yt&&fl(ge,bt),ut;if(mt===null){for(;bt<we.length;bt++)mt=ze(ge,we[bt],Le),mt!==null&&(de=k(mt,de,bt),Lt===null?ut=mt:Lt.sibling=mt,Lt=mt);return Yt&&fl(ge,bt),ut}for(mt=x(mt);bt<we.length;bt++)yn=$e(mt,ge,bt,we[bt],Le),yn!==null&&(l&&yn.alternate!==null&&mt.delete(yn.key===null?bt:yn.key),de=k(yn,de,bt),Lt===null?ut=yn:Lt.sibling=yn,Lt=yn);return l&&mt.forEach(function(wi){return d(ge,wi)}),Yt&&fl(ge,bt),ut}function xt(ge,de,we,Le){if(we==null)throw Error(n(151));for(var ut=null,Lt=null,mt=de,bt=de=0,yn=null,Xt=we.next();mt!==null&&!Xt.done;bt++,Xt=we.next()){mt.index>bt?(yn=mt,mt=null):yn=mt.sibling;var wi=je(ge,mt,Xt.value,Le);if(wi===null){mt===null&&(mt=yn);break}l&&mt&&wi.alternate===null&&d(ge,mt),de=k(wi,de,bt),Lt===null?ut=wi:Lt.sibling=wi,Lt=wi,mt=yn}if(Xt.done)return m(ge,mt),Yt&&fl(ge,bt),ut;if(mt===null){for(;!Xt.done;bt++,Xt=we.next())Xt=ze(ge,Xt.value,Le),Xt!==null&&(de=k(Xt,de,bt),Lt===null?ut=Xt:Lt.sibling=Xt,Lt=Xt);return Yt&&fl(ge,bt),ut}for(mt=x(mt);!Xt.done;bt++,Xt=we.next())Xt=$e(mt,ge,bt,Xt.value,Le),Xt!==null&&(l&&Xt.alternate!==null&&mt.delete(Xt.key===null?bt:Xt.key),de=k(Xt,de,bt),Lt===null?ut=Xt:Lt.sibling=Xt,Lt=Xt);return l&&mt.forEach(function(S6){return d(ge,S6)}),Yt&&fl(ge,bt),ut}function rs(ge,de,we,Le){if(typeof we=="object"&&we!==null&&we.type===y&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case g:e:{for(var ut=we.key;de!==null;){if(de.key===ut){if(ut=we.type,ut===y){if(de.tag===7){m(ge,de.sibling),Le=S(de,we.props.children),Le.return=ge,ge=Le;break e}}else if(de.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===P&&xS(ut)===de.type){m(ge,de.sibling),Le=S(de,we.props),Ed(Le,we),Le.return=ge,ge=Le;break e}m(ge,de);break}else d(ge,de);de=de.sibling}we.type===y?(Le=hl(we.props.children,ge.mode,Le,we.key),Le.return=ge,ge=Le):(Le=lf(we.type,we.key,we.props,null,ge.mode,Le),Ed(Le,we),Le.return=ge,ge=Le)}return L(ge);case b:e:{for(ut=we.key;de!==null;){if(de.key===ut)if(de.tag===4&&de.stateNode.containerInfo===we.containerInfo&&de.stateNode.implementation===we.implementation){m(ge,de.sibling),Le=S(de,we.children||[]),Le.return=ge,ge=Le;break e}else{m(ge,de);break}else d(ge,de);de=de.sibling}Le=w0(we,ge.mode,Le),Le.return=ge,ge=Le}return L(ge);case P:return ut=we._init,we=ut(we._payload),rs(ge,de,we,Le)}if(X(we))return Ct(ge,de,we,Le);if(U(we)){if(ut=U(we),typeof ut!="function")throw Error(n(150));return we=ut.call(we),xt(ge,de,we,Le)}if(typeof we.then=="function")return rs(ge,de,jf(we),Le);if(we.$$typeof===T)return rs(ge,de,hf(ge,we),Le);kf(ge,we)}return typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint"?(we=""+we,de!==null&&de.tag===6?(m(ge,de.sibling),Le=S(de,we),Le.return=ge,ge=Le):(m(ge,de),Le=v0(we,ge.mode,Le),Le.return=ge,ge=Le),L(ge)):m(ge,de)}return function(ge,de,we,Le){try{Ad=0;var ut=rs(ge,de,we,Le);return Vc=null,ut}catch(mt){if(mt===wd||mt===ff)throw mt;var Lt=Ia(29,mt,null,ge.mode);return Lt.lanes=Le,Lt.return=ge,Lt}finally{}}}var Uc=bS(!0),yS=bS(!1),Za=xe(null),zr=null;function oi(l){var d=l.alternate;ve(dn,dn.current&1),ve(Za,l),zr===null&&(d===null||Mc.current!==null||d.memoizedState!==null)&&(zr=l)}function vS(l){if(l.tag===22){if(ve(dn,dn.current),ve(Za,l),zr===null){var d=l.alternate;d!==null&&d.memoizedState!==null&&(zr=l)}}else ii()}function ii(){ve(dn,dn.current),ve(Za,Za.current)}function wo(l){ye(Za),zr===l&&(zr=null),ye(dn)}var dn=xe(0);function Tf(l){for(var d=l;d!==null;){if(d.tag===13){var m=d.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||Ub(m)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function eb(l,d,m,x){d=l.memoizedState,m=m(x,d),m=m==null?d:p({},d,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var tb={enqueueSetState:function(l,d,m){l=l._reactInternals;var x=Da(),S=ni(x);S.payload=d,m!=null&&(S.callback=m),d=ai(l,S,x),d!==null&&(Ra(d,l,x),Sd(d,l,x))},enqueueReplaceState:function(l,d,m){l=l._reactInternals;var x=Da(),S=ni(x);S.tag=1,S.payload=d,m!=null&&(S.callback=m),d=ai(l,S,x),d!==null&&(Ra(d,l,x),Sd(d,l,x))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var m=Da(),x=ni(m);x.tag=2,d!=null&&(x.callback=d),d=ai(l,x,m),d!==null&&(Ra(d,l,m),Sd(d,l,m))}};function wS(l,d,m,x,S,k,L){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,k,L):d.prototype&&d.prototype.isPureReactComponent?!pd(m,x)||!pd(S,k):!0}function NS(l,d,m,x){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(m,x),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(m,x),d.state!==l&&tb.enqueueReplaceState(d,d.state,null)}function wl(l,d){var m=d;if("ref"in d){m={};for(var x in d)x!=="ref"&&(m[x]=d[x])}if(l=l.defaultProps){m===d&&(m=p({},m));for(var S in l)m[S]===void 0&&(m[S]=l[S])}return m}var If=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function SS(l){If(l)}function CS(l){console.error(l)}function jS(l){If(l)}function $f(l,d){try{var m=l.onUncaughtError;m(d.value,{componentStack:d.stack})}catch(x){setTimeout(function(){throw x})}}function kS(l,d,m){try{var x=l.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function sb(l,d,m){return m=ni(m),m.tag=3,m.payload={element:null},m.callback=function(){$f(l,d)},m}function TS(l){return l=ni(l),l.tag=3,l}function IS(l,d,m,x){var S=m.type.getDerivedStateFromError;if(typeof S=="function"){var k=x.value;l.payload=function(){return S(k)},l.callback=function(){kS(d,m,x)}}var L=m.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(l.callback=function(){kS(d,m,x),typeof S!="function"&&(pi===null?pi=new Set([this]):pi.add(this));var W=x.stack;this.componentDidCatch(x.value,{componentStack:W!==null?W:""})})}function SR(l,d,m,x,S){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(d=m.alternate,d!==null&&bd(d,m,S,!0),m=Za.current,m!==null){switch(m.tag){case 13:return zr===null?kb():m.alternate===null&&Ds===0&&(Ds=3),m.flags&=-257,m.flags|=65536,m.lanes=S,x===E0?m.flags|=16384:(d=m.updateQueue,d===null?m.updateQueue=new Set([x]):d.add(x),Ib(l,x,S)),!1;case 22:return m.flags|=65536,x===E0?m.flags|=16384:(d=m.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=d):(m=d.retryQueue,m===null?d.retryQueue=new Set([x]):m.add(x)),Ib(l,x,S)),!1}throw Error(n(435,m.tag))}return Ib(l,x,S),kb(),!1}if(Yt)return d=Za.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=S,x!==C0&&(l=Error(n(422),{cause:x}),xd(qa(l,m)))):(x!==C0&&(d=Error(n(423),{cause:x}),xd(qa(d,m))),l=l.current.alternate,l.flags|=65536,S&=-S,l.lanes|=S,x=qa(x,m),S=sb(l.stateNode,x,S),O0(l,S),Ds!==4&&(Ds=2)),!1;var k=Error(n(520),{cause:x});if(k=qa(k,m),Md===null?Md=[k]:Md.push(k),Ds!==4&&(Ds=2),d===null)return!0;x=qa(x,m),m=d;do{switch(m.tag){case 3:return m.flags|=65536,l=S&-S,m.lanes|=l,l=sb(m.stateNode,x,l),O0(m,l),!1;case 1:if(d=m.type,k=m.stateNode,(m.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(pi===null||!pi.has(k))))return m.flags|=65536,S&=-S,m.lanes|=S,S=TS(S),IS(S,l,m,x),O0(m,S),!1}m=m.return}while(m!==null);return!1}var $S=Error(n(461)),xn=!1;function $n(l,d,m,x){d.child=l===null?yS(d,null,m,x):Uc(d,l.child,m,x)}function AS(l,d,m,x,S){m=m.render;var k=d.ref;if("ref"in x){var L={};for(var W in x)W!=="ref"&&(L[W]=x[W])}else L=x;return bl(d),x=P0(l,d,m,L,k,S),W=z0(),l!==null&&!xn?(B0(l,d,S),No(l,d,S)):(Yt&&W&&N0(d),d.flags|=1,$n(l,d,x,S),d.child)}function ES(l,d,m,x,S){if(l===null){var k=m.type;return typeof k=="function"&&!y0(k)&&k.defaultProps===void 0&&m.compare===null?(d.tag=15,d.type=k,DS(l,d,k,x,S)):(l=lf(m.type,null,x,d,d.mode,S),l.ref=d.ref,l.return=d,d.child=l)}if(k=l.child,!ub(l,S)){var L=k.memoizedProps;if(m=m.compare,m=m!==null?m:pd,m(L,x)&&l.ref===d.ref)return No(l,d,S)}return d.flags|=1,l=mo(k,x),l.ref=d.ref,l.return=d,d.child=l}function DS(l,d,m,x,S){if(l!==null){var k=l.memoizedProps;if(pd(k,x)&&l.ref===d.ref)if(xn=!1,d.pendingProps=x=k,ub(l,S))(l.flags&131072)!==0&&(xn=!0);else return d.lanes=l.lanes,No(l,d,S)}return nb(l,d,m,x,S)}function RS(l,d,m){var x=d.pendingProps,S=x.children,k=l!==null?l.memoizedState:null;if(x.mode==="hidden"){if((d.flags&128)!==0){if(x=k!==null?k.baseLanes|m:m,l!==null){for(S=d.child=l.child,k=0;S!==null;)k=k|S.lanes|S.childLanes,S=S.sibling;d.childLanes=k&~x}else d.childLanes=0,d.child=null;return OS(l,d,x,m)}if((m&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},l!==null&&pf(d,k!==null?k.cachePool:null),k!==null?DN(d,k):F0(),vS(d);else return d.lanes=d.childLanes=536870912,OS(l,d,k!==null?k.baseLanes|m:m,m)}else k!==null?(pf(d,k.cachePool),DN(d,k),ii(),d.memoizedState=null):(l!==null&&pf(d,null),F0(),ii());return $n(l,d,S,m),d.child}function OS(l,d,m,x){var S=A0();return S=S===null?null:{parent:un._currentValue,pool:S},d.memoizedState={baseLanes:m,cachePool:S},l!==null&&pf(d,null),F0(),vS(d),l!==null&&bd(l,d,x,!0),null}function Af(l,d){var m=d.ref;if(m===null)l!==null&&l.ref!==null&&(d.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(l===null||l.ref!==m)&&(d.flags|=4194816)}}function nb(l,d,m,x,S){return bl(d),m=P0(l,d,m,x,void 0,S),x=z0(),l!==null&&!xn?(B0(l,d,S),No(l,d,S)):(Yt&&x&&N0(d),d.flags|=1,$n(l,d,m,S),d.child)}function _S(l,d,m,x,S,k){return bl(d),d.updateQueue=null,m=ON(d,x,m,S),RN(l),x=z0(),l!==null&&!xn?(B0(l,d,k),No(l,d,k)):(Yt&&x&&N0(d),d.flags|=1,$n(l,d,m,k),d.child)}function FS(l,d,m,x,S){if(bl(d),d.stateNode===null){var k=Rc,L=m.contextType;typeof L=="object"&&L!==null&&(k=Bn(L)),k=new m(x,k),d.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=tb,d.stateNode=k,k._reactInternals=d,k=d.stateNode,k.props=x,k.state=d.memoizedState,k.refs={},D0(d),L=m.contextType,k.context=typeof L=="object"&&L!==null?Bn(L):Rc,k.state=d.memoizedState,L=m.getDerivedStateFromProps,typeof L=="function"&&(eb(d,m,L,x),k.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(L=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),L!==k.state&&tb.enqueueReplaceState(k,k.state,null),jd(d,x,k,S),Cd(),k.state=d.memoizedState),typeof k.componentDidMount=="function"&&(d.flags|=4194308),x=!0}else if(l===null){k=d.stateNode;var W=d.memoizedProps,te=wl(m,W);k.props=te;var Ne=k.context,_e=m.contextType;L=Rc,typeof _e=="object"&&_e!==null&&(L=Bn(_e));var ze=m.getDerivedStateFromProps;_e=typeof ze=="function"||typeof k.getSnapshotBeforeUpdate=="function",W=d.pendingProps!==W,_e||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(W||Ne!==L)&&NS(d,k,x,L),si=!1;var je=d.memoizedState;k.state=je,jd(d,x,k,S),Cd(),Ne=d.memoizedState,W||je!==Ne||si?(typeof ze=="function"&&(eb(d,m,ze,x),Ne=d.memoizedState),(te=si||wS(d,m,te,x,je,Ne,L))?(_e||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(d.flags|=4194308)):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=x,d.memoizedState=Ne),k.props=x,k.state=Ne,k.context=L,x=te):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),x=!1)}else{k=d.stateNode,R0(l,d),L=d.memoizedProps,_e=wl(m,L),k.props=_e,ze=d.pendingProps,je=k.context,Ne=m.contextType,te=Rc,typeof Ne=="object"&&Ne!==null&&(te=Bn(Ne)),W=m.getDerivedStateFromProps,(Ne=typeof W=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(L!==ze||je!==te)&&NS(d,k,x,te),si=!1,je=d.memoizedState,k.state=je,jd(d,x,k,S),Cd();var $e=d.memoizedState;L!==ze||je!==$e||si||l!==null&&l.dependencies!==null&&df(l.dependencies)?(typeof W=="function"&&(eb(d,m,W,x),$e=d.memoizedState),(_e=si||wS(d,m,_e,x,je,$e,te)||l!==null&&l.dependencies!==null&&df(l.dependencies))?(Ne||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(x,$e,te),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(x,$e,te)),typeof k.componentDidUpdate=="function"&&(d.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof k.componentDidUpdate!="function"||L===l.memoizedProps&&je===l.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||L===l.memoizedProps&&je===l.memoizedState||(d.flags|=1024),d.memoizedProps=x,d.memoizedState=$e),k.props=x,k.state=$e,k.context=te,x=_e):(typeof k.componentDidUpdate!="function"||L===l.memoizedProps&&je===l.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||L===l.memoizedProps&&je===l.memoizedState||(d.flags|=1024),x=!1)}return k=x,Af(l,d),x=(d.flags&128)!==0,k||x?(k=d.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:k.render(),d.flags|=1,l!==null&&x?(d.child=Uc(d,l.child,null,S),d.child=Uc(d,null,m,S)):$n(l,d,m,S),d.memoizedState=k.state,l=d.child):l=No(l,d,S),l}function LS(l,d,m,x){return gd(),d.flags|=256,$n(l,d,m,x),d.child}var ab={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function rb(l){return{baseLanes:l,cachePool:CN()}}function ob(l,d,m){return l=l!==null?l.childLanes&~m:0,d&&(l|=Qa),l}function MS(l,d,m){var x=d.pendingProps,S=!1,k=(d.flags&128)!==0,L;if((L=k)||(L=l!==null&&l.memoizedState===null?!1:(dn.current&2)!==0),L&&(S=!0,d.flags&=-129),L=(d.flags&32)!==0,d.flags&=-33,l===null){if(Yt){if(S?oi(d):ii(),Yt){var W=Es,te;if(te=W){e:{for(te=W,W=Pr;te.nodeType!==8;){if(!W){W=null;break e}if(te=yr(te.nextSibling),te===null){W=null;break e}}W=te}W!==null?(d.memoizedState={dehydrated:W,treeContext:pl!==null?{id:go,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},te=Ia(18,null,null,0),te.stateNode=W,te.return=d,d.child=te,ea=d,Es=null,te=!0):te=!1}te||gl(d)}if(W=d.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return Ub(W)?d.lanes=32:d.lanes=536870912,null;wo(d)}return W=x.children,x=x.fallback,S?(ii(),S=d.mode,W=Ef({mode:"hidden",children:W},S),x=hl(x,S,m,null),W.return=d,x.return=d,W.sibling=x,d.child=W,S=d.child,S.memoizedState=rb(m),S.childLanes=ob(l,L,m),d.memoizedState=ab,x):(oi(d),ib(d,W))}if(te=l.memoizedState,te!==null&&(W=te.dehydrated,W!==null)){if(k)d.flags&256?(oi(d),d.flags&=-257,d=lb(l,d,m)):d.memoizedState!==null?(ii(),d.child=l.child,d.flags|=128,d=null):(ii(),S=x.fallback,W=d.mode,x=Ef({mode:"visible",children:x.children},W),S=hl(S,W,m,null),S.flags|=2,x.return=d,S.return=d,x.sibling=S,d.child=x,Uc(d,l.child,null,m),x=d.child,x.memoizedState=rb(m),x.childLanes=ob(l,L,m),d.memoizedState=ab,d=S);else if(oi(d),Ub(W)){if(L=W.nextSibling&&W.nextSibling.dataset,L)var Ne=L.dgst;L=Ne,x=Error(n(419)),x.stack="",x.digest=L,xd({value:x,source:null,stack:null}),d=lb(l,d,m)}else if(xn||bd(l,d,m,!1),L=(m&l.childLanes)!==0,xn||L){if(L=ps,L!==null&&(x=m&-m,x=(x&42)!==0?1:_r(x),x=(x&(L.suspendedLanes|m))!==0?0:x,x!==0&&x!==te.retryLane))throw te.retryLane=x,Dc(l,x),Ra(L,l,x),$S;W.data==="$?"||kb(),d=lb(l,d,m)}else W.data==="$?"?(d.flags|=192,d.child=l.child,d=null):(l=te.treeContext,Es=yr(W.nextSibling),ea=d,Yt=!0,ml=null,Pr=!1,l!==null&&(Xa[Ya++]=go,Xa[Ya++]=xo,Xa[Ya++]=pl,go=l.id,xo=l.overflow,pl=d),d=ib(d,x.children),d.flags|=4096);return d}return S?(ii(),S=x.fallback,W=d.mode,te=l.child,Ne=te.sibling,x=mo(te,{mode:"hidden",children:x.children}),x.subtreeFlags=te.subtreeFlags&65011712,Ne!==null?S=mo(Ne,S):(S=hl(S,W,m,null),S.flags|=2),S.return=d,x.return=d,x.sibling=S,d.child=x,x=S,S=d.child,W=l.child.memoizedState,W===null?W=rb(m):(te=W.cachePool,te!==null?(Ne=un._currentValue,te=te.parent!==Ne?{parent:Ne,pool:Ne}:te):te=CN(),W={baseLanes:W.baseLanes|m,cachePool:te}),S.memoizedState=W,S.childLanes=ob(l,L,m),d.memoizedState=ab,x):(oi(d),m=l.child,l=m.sibling,m=mo(m,{mode:"visible",children:x.children}),m.return=d,m.sibling=null,l!==null&&(L=d.deletions,L===null?(d.deletions=[l],d.flags|=16):L.push(l)),d.child=m,d.memoizedState=null,m)}function ib(l,d){return d=Ef({mode:"visible",children:d},l.mode),d.return=l,l.child=d}function Ef(l,d){return l=Ia(22,l,null,d),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function lb(l,d,m){return Uc(d,l.child,null,m),l=ib(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function PS(l,d,m){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d),k0(l.return,d,m)}function cb(l,d,m,x,S){var k=l.memoizedState;k===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:S}:(k.isBackwards=d,k.rendering=null,k.renderingStartTime=0,k.last=x,k.tail=m,k.tailMode=S)}function zS(l,d,m){var x=d.pendingProps,S=x.revealOrder,k=x.tail;if($n(l,d,x.children,m),x=dn.current,(x&2)!==0)x=x&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&PS(l,m,d);else if(l.tag===19)PS(l,m,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}switch(ve(dn,x),S){case"forwards":for(m=d.child,S=null;m!==null;)l=m.alternate,l!==null&&Tf(l)===null&&(S=m),m=m.sibling;m=S,m===null?(S=d.child,d.child=null):(S=m.sibling,m.sibling=null),cb(d,!1,S,m,k);break;case"backwards":for(m=null,S=d.child,d.child=null;S!==null;){if(l=S.alternate,l!==null&&Tf(l)===null){d.child=S;break}l=S.sibling,S.sibling=m,m=S,S=l}cb(d,!0,m,null,k);break;case"together":cb(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function No(l,d,m){if(l!==null&&(d.dependencies=l.dependencies),hi|=d.lanes,(m&d.childLanes)===0)if(l!==null){if(bd(l,d,m,!1),(m&d.childLanes)===0)return null}else return null;if(l!==null&&d.child!==l.child)throw Error(n(153));if(d.child!==null){for(l=d.child,m=mo(l,l.pendingProps),d.child=m,m.return=d;l.sibling!==null;)l=l.sibling,m=m.sibling=mo(l,l.pendingProps),m.return=d;m.sibling=null}return d.child}function ub(l,d){return(l.lanes&d)!==0?!0:(l=l.dependencies,!!(l!==null&&df(l)))}function CR(l,d,m){switch(d.tag){case 3:ee(d,d.stateNode.containerInfo),ti(d,un,l.memoizedState.cache),gd();break;case 27:case 5:oe(d);break;case 4:ee(d,d.stateNode.containerInfo);break;case 10:ti(d,d.type,d.memoizedProps.value);break;case 13:var x=d.memoizedState;if(x!==null)return x.dehydrated!==null?(oi(d),d.flags|=128,null):(m&d.child.childLanes)!==0?MS(l,d,m):(oi(d),l=No(l,d,m),l!==null?l.sibling:null);oi(d);break;case 19:var S=(l.flags&128)!==0;if(x=(m&d.childLanes)!==0,x||(bd(l,d,m,!1),x=(m&d.childLanes)!==0),S){if(x)return zS(l,d,m);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),ve(dn,dn.current),x)break;return null;case 22:case 23:return d.lanes=0,RS(l,d,m);case 24:ti(d,un,l.memoizedState.cache)}return No(l,d,m)}function BS(l,d,m){if(l!==null)if(l.memoizedProps!==d.pendingProps)xn=!0;else{if(!ub(l,m)&&(d.flags&128)===0)return xn=!1,CR(l,d,m);xn=(l.flags&131072)!==0}else xn=!1,Yt&&(d.flags&1048576)!==0&&xN(d,uf,d.index);switch(d.lanes=0,d.tag){case 16:e:{l=d.pendingProps;var x=d.elementType,S=x._init;if(x=S(x._payload),d.type=x,typeof x=="function")y0(x)?(l=wl(x,l),d.tag=1,d=FS(null,d,x,l,m)):(d.tag=0,d=nb(null,d,x,l,m));else{if(x!=null){if(S=x.$$typeof,S===I){d.tag=11,d=AS(null,d,x,l,m);break e}else if(S===O){d.tag=14,d=ES(null,d,x,l,m);break e}}throw d=Q(x)||x,Error(n(306,d,""))}}return d;case 0:return nb(l,d,d.type,d.pendingProps,m);case 1:return x=d.type,S=wl(x,d.pendingProps),FS(l,d,x,S,m);case 3:e:{if(ee(d,d.stateNode.containerInfo),l===null)throw Error(n(387));x=d.pendingProps;var k=d.memoizedState;S=k.element,R0(l,d),jd(d,x,null,m);var L=d.memoizedState;if(x=L.cache,ti(d,un,x),x!==k.cache&&T0(d,[un],m,!0),Cd(),x=L.element,k.isDehydrated)if(k={element:x,isDehydrated:!1,cache:L.cache},d.updateQueue.baseState=k,d.memoizedState=k,d.flags&256){d=LS(l,d,x,m);break e}else if(x!==S){S=qa(Error(n(424)),d),xd(S),d=LS(l,d,x,m);break e}else{switch(l=d.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(Es=yr(l.firstChild),ea=d,Yt=!0,ml=null,Pr=!0,m=yS(d,null,x,m),d.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(gd(),x===S){d=No(l,d,m);break e}$n(l,d,x,m)}d=d.child}return d;case 26:return Af(l,d),l===null?(m=W3(d.type,null,d.pendingProps,null))?d.memoizedState=m:Yt||(m=d.type,l=d.pendingProps,x=Wf(pe.current).createElement(m),x[Ss]=d,x[Cs]=l,En(x,m,l),Ws(x),d.stateNode=x):d.memoizedState=W3(d.type,l.memoizedProps,d.pendingProps,l.memoizedState),null;case 27:return oe(d),l===null&&Yt&&(x=d.stateNode=V3(d.type,d.pendingProps,pe.current),ea=d,Pr=!0,S=Es,gi(d.type)?(Gb=S,Es=yr(x.firstChild)):Es=S),$n(l,d,d.pendingProps.children,m),Af(l,d),l===null&&(d.flags|=4194304),d.child;case 5:return l===null&&Yt&&((S=x=Es)&&(x=QR(x,d.type,d.pendingProps,Pr),x!==null?(d.stateNode=x,ea=d,Es=yr(x.firstChild),Pr=!1,S=!0):S=!1),S||gl(d)),oe(d),S=d.type,k=d.pendingProps,L=l!==null?l.memoizedProps:null,x=k.children,zb(S,k)?x=null:L!==null&&zb(S,L)&&(d.flags|=32),d.memoizedState!==null&&(S=P0(l,d,gR,null,null,m),qd._currentValue=S),Af(l,d),$n(l,d,x,m),d.child;case 6:return l===null&&Yt&&((l=m=Es)&&(m=JR(m,d.pendingProps,Pr),m!==null?(d.stateNode=m,ea=d,Es=null,l=!0):l=!1),l||gl(d)),null;case 13:return MS(l,d,m);case 4:return ee(d,d.stateNode.containerInfo),x=d.pendingProps,l===null?d.child=Uc(d,null,x,m):$n(l,d,x,m),d.child;case 11:return AS(l,d,d.type,d.pendingProps,m);case 7:return $n(l,d,d.pendingProps,m),d.child;case 8:return $n(l,d,d.pendingProps.children,m),d.child;case 12:return $n(l,d,d.pendingProps.children,m),d.child;case 10:return x=d.pendingProps,ti(d,d.type,x.value),$n(l,d,x.children,m),d.child;case 9:return S=d.type._context,x=d.pendingProps.children,bl(d),S=Bn(S),x=x(S),d.flags|=1,$n(l,d,x,m),d.child;case 14:return ES(l,d,d.type,d.pendingProps,m);case 15:return DS(l,d,d.type,d.pendingProps,m);case 19:return zS(l,d,m);case 31:return x=d.pendingProps,m=d.mode,x={mode:x.mode,children:x.children},l===null?(m=Ef(x,m),m.ref=d.ref,d.child=m,m.return=d,d=m):(m=mo(l.child,x),m.ref=d.ref,d.child=m,m.return=d,d=m),d;case 22:return RS(l,d,m);case 24:return bl(d),x=Bn(un),l===null?(S=A0(),S===null&&(S=ps,k=I0(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=m),S=k),d.memoizedState={parent:x,cache:S},D0(d),ti(d,un,S)):((l.lanes&m)!==0&&(R0(l,d),jd(d,null,null,m),Cd()),S=l.memoizedState,k=d.memoizedState,S.parent!==x?(S={parent:x,cache:x},d.memoizedState=S,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=S),ti(d,un,x)):(x=k.cache,ti(d,un,x),x!==S.cache&&T0(d,[un],m,!0))),$n(l,d,d.pendingProps.children,m),d.child;case 29:throw d.pendingProps}throw Error(n(156,d.tag))}function So(l){l.flags|=4}function VS(l,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!Y3(d)){if(d=Za.current,d!==null&&((qt&4194048)===qt?zr!==null:(qt&62914560)!==qt&&(qt&536870912)===0||d!==zr))throw Nd=E0,jN;l.flags|=8192}}function Df(l,d){d!==null&&(l.flags|=4),l.flags&16384&&(d=l.tag!==22?nl():536870912,l.lanes|=d,qc|=d)}function Dd(l,d){if(!Yt)switch(l.tailMode){case"hidden":d=l.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function js(l){var d=l.alternate!==null&&l.alternate.child===l.child,m=0,x=0;if(d)for(var S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=x,l.childLanes=m,d}function jR(l,d,m){var x=d.pendingProps;switch(S0(d),d.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(d),null;case 1:return js(d),null;case 3:return m=d.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),d.memoizedState.cache!==x&&(d.flags|=2048),yo(un),he(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(md(d)?So(d):l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,vN())),js(d),null;case 26:return m=d.memoizedState,l===null?(So(d),m!==null?(js(d),VS(d,m)):(js(d),d.flags&=-16777217)):m?m!==l.memoizedState?(So(d),js(d),VS(d,m)):(js(d),d.flags&=-16777217):(l.memoizedProps!==x&&So(d),js(d),d.flags&=-16777217),null;case 27:Ie(d),m=pe.current;var S=d.type;if(l!==null&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(!x){if(d.stateNode===null)throw Error(n(166));return js(d),null}l=Re.current,md(d)?bN(d):(l=V3(S,x,m),d.stateNode=l,So(d))}return js(d),null;case 5:if(Ie(d),m=d.type,l!==null&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(!x){if(d.stateNode===null)throw Error(n(166));return js(d),null}if(l=Re.current,md(d))bN(d);else{switch(S=Wf(pe.current),l){case 1:l=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:l=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":l=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":l=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":l=S.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof x.is=="string"?S.createElement("select",{is:x.is}):S.createElement("select"),x.multiple?l.multiple=!0:x.size&&(l.size=x.size);break;default:l=typeof x.is=="string"?S.createElement(m,{is:x.is}):S.createElement(m)}}l[Ss]=d,l[Cs]=x;e:for(S=d.child;S!==null;){if(S.tag===5||S.tag===6)l.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===d)break e;for(;S.sibling===null;){if(S.return===null||S.return===d)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}d.stateNode=l;e:switch(En(l,m,x),m){case"button":case"input":case"select":case"textarea":l=!!x.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&So(d)}}return js(d),d.flags&=-16777217,null;case 6:if(l&&d.stateNode!=null)l.memoizedProps!==x&&So(d);else{if(typeof x!="string"&&d.stateNode===null)throw Error(n(166));if(l=pe.current,md(d)){if(l=d.stateNode,m=d.memoizedProps,x=null,S=ea,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}l[Ss]=d,l=!!(l.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||_3(l.nodeValue,m)),l||gl(d)}else l=Wf(l).createTextNode(x),l[Ss]=d,d.stateNode=l}return js(d),null;case 13:if(x=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(S=md(d),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=d.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Ss]=d}else gd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;js(d),S=!1}else S=vN(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=S),S=!0;if(!S)return d.flags&256?(wo(d),d):(wo(d),null)}if(wo(d),(d.flags&128)!==0)return d.lanes=m,d;if(m=x!==null,l=l!==null&&l.memoizedState!==null,m){x=d.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool);var k=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(k=x.memoizedState.cachePool.pool),k!==S&&(x.flags|=2048)}return m!==l&&m&&(d.child.flags|=8192),Df(d,d.updateQueue),js(d),null;case 4:return he(),l===null&&_b(d.stateNode.containerInfo),js(d),null;case 10:return yo(d.type),js(d),null;case 19:if(ye(dn),S=d.memoizedState,S===null)return js(d),null;if(x=(d.flags&128)!==0,k=S.rendering,k===null)if(x)Dd(S,!1);else{if(Ds!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(k=Tf(l),k!==null){for(d.flags|=128,Dd(S,!1),l=k.updateQueue,d.updateQueue=l,Df(d,l),d.subtreeFlags=0,l=m,m=d.child;m!==null;)gN(m,l),m=m.sibling;return ve(dn,dn.current&1|2),d.child}l=l.sibling}S.tail!==null&&Fe()>_f&&(d.flags|=128,x=!0,Dd(S,!1),d.lanes=4194304)}else{if(!x)if(l=Tf(k),l!==null){if(d.flags|=128,x=!0,l=l.updateQueue,d.updateQueue=l,Df(d,l),Dd(S,!0),S.tail===null&&S.tailMode==="hidden"&&!k.alternate&&!Yt)return js(d),null}else 2*Fe()-S.renderingStartTime>_f&&m!==536870912&&(d.flags|=128,x=!0,Dd(S,!1),d.lanes=4194304);S.isBackwards?(k.sibling=d.child,d.child=k):(l=S.last,l!==null?l.sibling=k:d.child=k,S.last=k)}return S.tail!==null?(d=S.tail,S.rendering=d,S.tail=d.sibling,S.renderingStartTime=Fe(),d.sibling=null,l=dn.current,ve(dn,x?l&1|2:l&1),d):(js(d),null);case 22:case 23:return wo(d),L0(),x=d.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(d.flags|=8192):x&&(d.flags|=8192),x?(m&536870912)!==0&&(d.flags&128)===0&&(js(d),d.subtreeFlags&6&&(d.flags|=8192)):js(d),m=d.updateQueue,m!==null&&Df(d,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==m&&(d.flags|=2048),l!==null&&ye(yl),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),d.memoizedState.cache!==m&&(d.flags|=2048),yo(un),js(d),null;case 25:return null;case 30:return null}throw Error(n(156,d.tag))}function kR(l,d){switch(S0(d),d.tag){case 1:return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return yo(un),he(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 26:case 27:case 5:return Ie(d),null;case 13:if(wo(d),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(n(340));gd()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return ye(dn),null;case 4:return he(),null;case 10:return yo(d.type),null;case 22:case 23:return wo(d),L0(),l!==null&&ye(yl),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 24:return yo(un),null;case 25:return null;default:return null}}function US(l,d){switch(S0(d),d.tag){case 3:yo(un),he();break;case 26:case 27:case 5:Ie(d);break;case 4:he();break;case 13:wo(d);break;case 19:ye(dn);break;case 10:yo(d.type);break;case 22:case 23:wo(d),L0(),l!==null&&ye(yl);break;case 24:yo(un)}}function Rd(l,d){try{var m=d.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var S=x.next;m=S;do{if((m.tag&l)===l){x=void 0;var k=m.create,L=m.inst;x=k(),L.destroy=x}m=m.next}while(m!==S)}}catch(W){us(d,d.return,W)}}function li(l,d,m){try{var x=d.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var k=S.next;x=k;do{if((x.tag&l)===l){var L=x.inst,W=L.destroy;if(W!==void 0){L.destroy=void 0,S=d;var te=m,Ne=W;try{Ne()}catch(_e){us(S,te,_e)}}}x=x.next}while(x!==k)}}catch(_e){us(d,d.return,_e)}}function GS(l){var d=l.updateQueue;if(d!==null){var m=l.stateNode;try{EN(d,m)}catch(x){us(l,l.return,x)}}}function WS(l,d,m){m.props=wl(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(x){us(l,d,x)}}function Od(l,d){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof m=="function"?l.refCleanup=m(x):m.current=x}}catch(S){us(l,d,S)}}function Br(l,d){var m=l.ref,x=l.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(S){us(l,d,S)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(S){us(l,d,S)}else m.current=null}function HS(l){var d=l.type,m=l.memoizedProps,x=l.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break e;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(S){us(l,l.return,S)}}function db(l,d,m){try{var x=l.stateNode;qR(x,l.type,m,d),x[Cs]=d}catch(S){us(l,l.return,S)}}function qS(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&gi(l.type)||l.tag===4}function hb(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||qS(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&gi(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function pb(l,d,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,d):(d=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,d.appendChild(l),m=m._reactRootContainer,m!=null||d.onclick!==null||(d.onclick=Gf));else if(x!==4&&(x===27&&gi(l.type)&&(m=l.stateNode,d=null),l=l.child,l!==null))for(pb(l,d,m),l=l.sibling;l!==null;)pb(l,d,m),l=l.sibling}function Rf(l,d,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?m.insertBefore(l,d):m.appendChild(l);else if(x!==4&&(x===27&&gi(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(Rf(l,d,m),l=l.sibling;l!==null;)Rf(l,d,m),l=l.sibling}function KS(l){var d=l.stateNode,m=l.memoizedProps;try{for(var x=l.type,S=d.attributes;S.length;)d.removeAttributeNode(S[0]);En(d,x,m),d[Ss]=l,d[Cs]=m}catch(k){us(l,l.return,k)}}var Co=!1,Vs=!1,fb=!1,XS=typeof WeakSet=="function"?WeakSet:Set,bn=null;function TR(l,d){if(l=l.containerInfo,Mb=Zf,l=oN(l),h0(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var S=x.anchorOffset,k=x.focusNode;x=x.focusOffset;try{m.nodeType,k.nodeType}catch(xt){m=null;break e}var L=0,W=-1,te=-1,Ne=0,_e=0,ze=l,je=null;t:for(;;){for(var $e;ze!==m||S!==0&&ze.nodeType!==3||(W=L+S),ze!==k||x!==0&&ze.nodeType!==3||(te=L+x),ze.nodeType===3&&(L+=ze.nodeValue.length),($e=ze.firstChild)!==null;)je=ze,ze=$e;for(;;){if(ze===l)break t;if(je===m&&++Ne===S&&(W=L),je===k&&++_e===x&&(te=L),($e=ze.nextSibling)!==null)break;ze=je,je=ze.parentNode}ze=$e}m=W===-1||te===-1?null:{start:W,end:te}}else m=null}m=m||{start:0,end:0}}else m=null;for(Pb={focusedElem:l,selectionRange:m},Zf=!1,bn=d;bn!==null;)if(d=bn,l=d.child,(d.subtreeFlags&1024)!==0&&l!==null)l.return=d,bn=l;else for(;bn!==null;){switch(d=bn,k=d.alternate,l=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&k!==null){l=void 0,m=d,S=k.memoizedProps,k=k.memoizedState,x=m.stateNode;try{var Ct=wl(m.type,S,m.elementType===m.type);l=x.getSnapshotBeforeUpdate(Ct,k),x.__reactInternalSnapshotBeforeUpdate=l}catch(xt){us(m,m.return,xt)}}break;case 3:if((l&1024)!==0){if(l=d.stateNode.containerInfo,m=l.nodeType,m===9)Vb(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Vb(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=d.sibling,l!==null){l.return=d.return,bn=l;break}bn=d.return}}function YS(l,d,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:ci(l,m),x&4&&Rd(5,m);break;case 1:if(ci(l,m),x&4)if(l=m.stateNode,d===null)try{l.componentDidMount()}catch(L){us(m,m.return,L)}else{var S=wl(m.type,d.memoizedProps);d=d.memoizedState;try{l.componentDidUpdate(S,d,l.__reactInternalSnapshotBeforeUpdate)}catch(L){us(m,m.return,L)}}x&64&&GS(m),x&512&&Od(m,m.return);break;case 3:if(ci(l,m),x&64&&(l=m.updateQueue,l!==null)){if(d=null,m.child!==null)switch(m.child.tag){case 27:case 5:d=m.child.stateNode;break;case 1:d=m.child.stateNode}try{EN(l,d)}catch(L){us(m,m.return,L)}}break;case 27:d===null&&x&4&&KS(m);case 26:case 5:ci(l,m),d===null&&x&4&&HS(m),x&512&&Od(m,m.return);break;case 12:ci(l,m);break;case 13:ci(l,m),x&4&&JS(l,m),x&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=FR.bind(null,m),e6(l,m))));break;case 22:if(x=m.memoizedState!==null||Co,!x){d=d!==null&&d.memoizedState!==null||Vs,S=Co;var k=Vs;Co=x,(Vs=d)&&!k?ui(l,m,(m.subtreeFlags&8772)!==0):ci(l,m),Co=S,Vs=k}break;case 30:break;default:ci(l,m)}}function ZS(l){var d=l.alternate;d!==null&&(l.alternate=null,ZS(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&dc(d)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var bs=null,ha=!1;function jo(l,d,m){for(m=m.child;m!==null;)QS(l,d,m),m=m.sibling}function QS(l,d,m){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(at,m)}catch(k){}switch(m.tag){case 26:Vs||Br(m,d),jo(l,d,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Vs||Br(m,d);var x=bs,S=ha;gi(m.type)&&(bs=m.stateNode,ha=!1),jo(l,d,m),Ud(m.stateNode),bs=x,ha=S;break;case 5:Vs||Br(m,d);case 6:if(x=bs,S=ha,bs=null,jo(l,d,m),bs=x,ha=S,bs!==null)if(ha)try{(bs.nodeType===9?bs.body:bs.nodeName==="HTML"?bs.ownerDocument.body:bs).removeChild(m.stateNode)}catch(k){us(m,d,k)}else try{bs.removeChild(m.stateNode)}catch(k){us(m,d,k)}break;case 18:bs!==null&&(ha?(l=bs,z3(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),Zd(l)):z3(bs,m.stateNode));break;case 4:x=bs,S=ha,bs=m.stateNode.containerInfo,ha=!0,jo(l,d,m),bs=x,ha=S;break;case 0:case 11:case 14:case 15:Vs||li(2,m,d),Vs||li(4,m,d),jo(l,d,m);break;case 1:Vs||(Br(m,d),x=m.stateNode,typeof x.componentWillUnmount=="function"&&WS(m,d,x)),jo(l,d,m);break;case 21:jo(l,d,m);break;case 22:Vs=(x=Vs)||m.memoizedState!==null,jo(l,d,m),Vs=x;break;default:jo(l,d,m)}}function JS(l,d){if(d.memoizedState===null&&(l=d.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Zd(l)}catch(m){us(d,d.return,m)}}function IR(l){switch(l.tag){case 13:case 19:var d=l.stateNode;return d===null&&(d=l.stateNode=new XS),d;case 22:return l=l.stateNode,d=l._retryCache,d===null&&(d=l._retryCache=new XS),d;default:throw Error(n(435,l.tag))}}function mb(l,d){var m=IR(l);d.forEach(function(x){var S=LR.bind(null,l,x);m.has(x)||(m.add(x),x.then(S,S))})}function $a(l,d){var m=d.deletions;if(m!==null)for(var x=0;x<m.length;x++){var S=m[x],k=l,L=d,W=L;e:for(;W!==null;){switch(W.tag){case 27:if(gi(W.type)){bs=W.stateNode,ha=!1;break e}break;case 5:bs=W.stateNode,ha=!1;break e;case 3:case 4:bs=W.stateNode.containerInfo,ha=!0;break e}W=W.return}if(bs===null)throw Error(n(160));QS(k,L,S),bs=null,ha=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)e3(d,l),d=d.sibling}var br=null;function e3(l,d){var m=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:$a(d,l),Aa(l),x&4&&(li(3,l,l.return),Rd(3,l),li(5,l,l.return));break;case 1:$a(d,l),Aa(l),x&512&&(Vs||m===null||Br(m,m.return)),x&64&&Co&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var S=br;if($a(d,l),Aa(l),x&512&&(Vs||m===null||Br(m,m.return)),x&4){var k=m!==null?m.memoizedState:null;if(x=l.memoizedState,m===null)if(x===null)if(l.stateNode===null){e:{x=l.type,m=l.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":k=S.getElementsByTagName("title")[0],(!k||k[Fr]||k[Ss]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(x),S.head.insertBefore(k,S.querySelector("head > title"))),En(k,x,m),k[Ss]=l,Ws(k),x=k;break e;case"link":var L=K3("link","href",S).get(x+(m.href||""));if(L){for(var W=0;W<L.length;W++)if(k=L[W],k.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&k.getAttribute("rel")===(m.rel==null?null:m.rel)&&k.getAttribute("title")===(m.title==null?null:m.title)&&k.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){L.splice(W,1);break t}}k=S.createElement(x),En(k,x,m),S.head.appendChild(k);break;case"meta":if(L=K3("meta","content",S).get(x+(m.content||""))){for(W=0;W<L.length;W++)if(k=L[W],k.getAttribute("content")===(m.content==null?null:""+m.content)&&k.getAttribute("name")===(m.name==null?null:m.name)&&k.getAttribute("property")===(m.property==null?null:m.property)&&k.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&k.getAttribute("charset")===(m.charSet==null?null:m.charSet)){L.splice(W,1);break t}}k=S.createElement(x),En(k,x,m),S.head.appendChild(k);break;default:throw Error(n(468,x))}k[Ss]=l,Ws(k),x=k}l.stateNode=x}else X3(S,l.type,l.stateNode);else l.stateNode=q3(S,x,l.memoizedProps);else k!==x?(k===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):k.count--,x===null?X3(S,l.type,l.stateNode):q3(S,x,l.memoizedProps)):x===null&&l.stateNode!==null&&db(l,l.memoizedProps,m.memoizedProps)}break;case 27:$a(d,l),Aa(l),x&512&&(Vs||m===null||Br(m,m.return)),m!==null&&x&4&&db(l,l.memoizedProps,m.memoizedProps);break;case 5:if($a(d,l),Aa(l),x&512&&(Vs||m===null||Br(m,m.return)),l.flags&32){S=l.stateNode;try{Zo(S,"")}catch($e){us(l,l.return,$e)}}x&4&&l.stateNode!=null&&(S=l.memoizedProps,db(l,S,m!==null?m.memoizedProps:S)),x&1024&&(fb=!0);break;case 6:if($a(d,l),Aa(l),x&4){if(l.stateNode===null)throw Error(n(162));x=l.memoizedProps,m=l.stateNode;try{m.nodeValue=x}catch($e){us(l,l.return,$e)}}break;case 3:if(Kf=null,S=br,br=Hf(d.containerInfo),$a(d,l),br=S,Aa(l),x&4&&m!==null&&m.memoizedState.isDehydrated)try{Zd(d.containerInfo)}catch($e){us(l,l.return,$e)}fb&&(fb=!1,t3(l));break;case 4:x=br,br=Hf(l.stateNode.containerInfo),$a(d,l),Aa(l),br=x;break;case 12:$a(d,l),Aa(l);break;case 13:$a(d,l),Aa(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(wb=Fe()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,mb(l,x)));break;case 22:S=l.memoizedState!==null;var te=m!==null&&m.memoizedState!==null,Ne=Co,_e=Vs;if(Co=Ne||S,Vs=_e||te,$a(d,l),Vs=_e,Co=Ne,Aa(l),x&8192)e:for(d=l.stateNode,d._visibility=S?d._visibility&-2:d._visibility|1,S&&(m===null||te||Co||Vs||Nl(l)),m=null,d=l;;){if(d.tag===5||d.tag===26){if(m===null){te=m=d;try{if(k=te.stateNode,S)L=k.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{W=te.stateNode;var ze=te.memoizedProps.style,je=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;W.style.display=je==null||typeof je=="boolean"?"":(""+je).trim()}}catch($e){us(te,te.return,$e)}}}else if(d.tag===6){if(m===null){te=d;try{te.stateNode.nodeValue=S?"":te.memoizedProps}catch($e){us(te,te.return,$e)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===l)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break e;for(;d.sibling===null;){if(d.return===null||d.return===l)break e;m===d&&(m=null),d=d.return}m===d&&(m=null),d.sibling.return=d.return,d=d.sibling}x&4&&(x=l.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,mb(l,m))));break;case 19:$a(d,l),Aa(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,mb(l,x)));break;case 30:break;case 21:break;default:$a(d,l),Aa(l)}}function Aa(l){var d=l.flags;if(d&2){try{for(var m,x=l.return;x!==null;){if(qS(x)){m=x;break}x=x.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var S=m.stateNode,k=hb(l);Rf(l,k,S);break;case 5:var L=m.stateNode;m.flags&32&&(Zo(L,""),m.flags&=-33);var W=hb(l);Rf(l,W,L);break;case 3:case 4:var te=m.stateNode.containerInfo,Ne=hb(l);pb(l,Ne,te);break;default:throw Error(n(161))}}catch(_e){us(l,l.return,_e)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function t3(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var d=l;t3(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),l=l.sibling}}function ci(l,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)YS(l,d.alternate,d),d=d.sibling}function Nl(l){for(l=l.child;l!==null;){var d=l;switch(d.tag){case 0:case 11:case 14:case 15:li(4,d,d.return),Nl(d);break;case 1:Br(d,d.return);var m=d.stateNode;typeof m.componentWillUnmount=="function"&&WS(d,d.return,m),Nl(d);break;case 27:Ud(d.stateNode);case 26:case 5:Br(d,d.return),Nl(d);break;case 22:d.memoizedState===null&&Nl(d);break;case 30:Nl(d);break;default:Nl(d)}l=l.sibling}}function ui(l,d,m){for(m=m&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var x=d.alternate,S=l,k=d,L=k.flags;switch(k.tag){case 0:case 11:case 15:ui(S,k,m),Rd(4,k);break;case 1:if(ui(S,k,m),x=k,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ne){us(x,x.return,Ne)}if(x=k,S=x.updateQueue,S!==null){var W=x.stateNode;try{var te=S.shared.hiddenCallbacks;if(te!==null)for(S.shared.hiddenCallbacks=null,S=0;S<te.length;S++)AN(te[S],W)}catch(Ne){us(x,x.return,Ne)}}m&&L&64&&GS(k),Od(k,k.return);break;case 27:KS(k);case 26:case 5:ui(S,k,m),m&&x===null&&L&4&&HS(k),Od(k,k.return);break;case 12:ui(S,k,m);break;case 13:ui(S,k,m),m&&L&4&&JS(S,k);break;case 22:k.memoizedState===null&&ui(S,k,m),Od(k,k.return);break;case 30:break;default:ui(S,k,m)}d=d.sibling}}function gb(l,d){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(l=d.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&yd(m))}function xb(l,d){l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&yd(l))}function Vr(l,d,m,x){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)s3(l,d,m,x),d=d.sibling}function s3(l,d,m,x){var S=d.flags;switch(d.tag){case 0:case 11:case 15:Vr(l,d,m,x),S&2048&&Rd(9,d);break;case 1:Vr(l,d,m,x);break;case 3:Vr(l,d,m,x),S&2048&&(l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&yd(l)));break;case 12:if(S&2048){Vr(l,d,m,x),l=d.stateNode;try{var k=d.memoizedProps,L=k.id,W=k.onPostCommit;typeof W=="function"&&W(L,d.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(te){us(d,d.return,te)}}else Vr(l,d,m,x);break;case 13:Vr(l,d,m,x);break;case 23:break;case 22:k=d.stateNode,L=d.alternate,d.memoizedState!==null?k._visibility&2?Vr(l,d,m,x):_d(l,d):k._visibility&2?Vr(l,d,m,x):(k._visibility|=2,Gc(l,d,m,x,(d.subtreeFlags&10256)!==0)),S&2048&&gb(L,d);break;case 24:Vr(l,d,m,x),S&2048&&xb(d.alternate,d);break;default:Vr(l,d,m,x)}}function Gc(l,d,m,x,S){for(S=S&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var k=l,L=d,W=m,te=x,Ne=L.flags;switch(L.tag){case 0:case 11:case 15:Gc(k,L,W,te,S),Rd(8,L);break;case 23:break;case 22:var _e=L.stateNode;L.memoizedState!==null?_e._visibility&2?Gc(k,L,W,te,S):_d(k,L):(_e._visibility|=2,Gc(k,L,W,te,S)),S&&Ne&2048&&gb(L.alternate,L);break;case 24:Gc(k,L,W,te,S),S&&Ne&2048&&xb(L.alternate,L);break;default:Gc(k,L,W,te,S)}d=d.sibling}}function _d(l,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var m=l,x=d,S=x.flags;switch(x.tag){case 22:_d(m,x),S&2048&&gb(x.alternate,x);break;case 24:_d(m,x),S&2048&&xb(x.alternate,x);break;default:_d(m,x)}d=d.sibling}}var Fd=8192;function Wc(l){if(l.subtreeFlags&Fd)for(l=l.child;l!==null;)n3(l),l=l.sibling}function n3(l){switch(l.tag){case 26:Wc(l),l.flags&Fd&&l.memoizedState!==null&&p6(br,l.memoizedState,l.memoizedProps);break;case 5:Wc(l);break;case 3:case 4:var d=br;br=Hf(l.stateNode.containerInfo),Wc(l),br=d;break;case 22:l.memoizedState===null&&(d=l.alternate,d!==null&&d.memoizedState!==null?(d=Fd,Fd=16777216,Wc(l),Fd=d):Wc(l));break;default:Wc(l)}}function a3(l){var d=l.alternate;if(d!==null&&(l=d.child,l!==null)){d.child=null;do d=l.sibling,l.sibling=null,l=d;while(l!==null)}}function Ld(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var m=0;m<d.length;m++){var x=d[m];bn=x,o3(x,l)}a3(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)r3(l),l=l.sibling}function r3(l){switch(l.tag){case 0:case 11:case 15:Ld(l),l.flags&2048&&li(9,l,l.return);break;case 3:Ld(l);break;case 12:Ld(l);break;case 22:var d=l.stateNode;l.memoizedState!==null&&d._visibility&2&&(l.return===null||l.return.tag!==13)?(d._visibility&=-3,Of(l)):Ld(l);break;default:Ld(l)}}function Of(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var m=0;m<d.length;m++){var x=d[m];bn=x,o3(x,l)}a3(l)}for(l=l.child;l!==null;){switch(d=l,d.tag){case 0:case 11:case 15:li(8,d,d.return),Of(d);break;case 22:m=d.stateNode,m._visibility&2&&(m._visibility&=-3,Of(d));break;default:Of(d)}l=l.sibling}}function o3(l,d){for(;bn!==null;){var m=bn;switch(m.tag){case 0:case 11:case 15:li(8,m,d);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:yd(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,bn=x;else e:for(m=l;bn!==null;){x=bn;var S=x.sibling,k=x.return;if(ZS(x),x===m){bn=null;break e}if(S!==null){S.return=k,bn=S;break e}bn=k}}}var $R={getCacheForType:function(l){var d=Bn(un),m=d.data.get(l);return m===void 0&&(m=l(),d.data.set(l,m)),m}},AR=typeof WeakMap=="function"?WeakMap:Map,es=0,ps=null,Mt=null,qt=0,ts=0,Ea=null,di=!1,Hc=!1,bb=!1,ko=0,Ds=0,hi=0,Sl=0,yb=0,Qa=0,qc=0,Md=null,pa=null,vb=!1,wb=0,_f=1/0,Ff=null,pi=null,An=0,fi=null,Kc=null,Xc=0,Nb=0,Sb=null,i3=null,Pd=0,Cb=null;function Da(){if((es&2)!==0&&qt!==0)return qt&-qt;if(B.T!==null){var l=Fc;return l!==0?l:Eb()}return et()}function l3(){Qa===0&&(Qa=(qt&536870912)===0||Yt?sl():536870912);var l=Za.current;return l!==null&&(l.flags|=32),Qa}function Ra(l,d,m){(l===ps&&(ts===2||ts===9)||l.cancelPendingCommit!==null)&&(Yc(l,0),mi(l,qt,Qa,!1)),on(l,m),((es&2)===0||l!==ps)&&(l===ps&&((es&2)===0&&(Sl|=m),Ds===4&&mi(l,qt,Qa,!1)),Ur(l))}function c3(l,d,m){if((es&6)!==0)throw Error(n(327));var x=!m&&(d&124)===0&&(d&l.expiredLanes)===0||Or(l,d),S=x?RR(l,d):Tb(l,d,!0),k=x;do{if(S===0){Hc&&!x&&mi(l,d,0,!1);break}else{if(m=l.current.alternate,k&&!ER(m)){S=Tb(l,d,!1),k=!1;continue}if(S===2){if(k=d,l.errorRecoveryDisabledLanes&k)var L=0;else L=l.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){d=L;e:{var W=l;S=Md;var te=W.current.memoizedState.isDehydrated;if(te&&(Yc(W,L).flags|=256),L=Tb(W,L,!1),L!==2){if(bb&&!te){W.errorRecoveryDisabledLanes|=k,Sl|=k,S=4;break e}k=pa,pa=S,k!==null&&(pa===null?pa=k:pa.push.apply(pa,k))}S=L}if(k=!1,S!==2)continue}}if(S===1){Yc(l,0),mi(l,d,0,!0);break}e:{switch(x=l,k=S,k){case 0:case 1:throw Error(n(345));case 4:if((d&4194048)!==d)break;case 6:mi(x,d,Qa,!di);break e;case 2:pa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((d&62914560)===d&&(S=wb+300-Fe(),10<S)){if(mi(x,d,Qa,!di),Ps(x,0,!0)!==0)break e;x.timeoutHandle=M3(u3.bind(null,x,m,pa,Ff,vb,d,Qa,Sl,qc,di,k,2,-0,0),S);break e}u3(x,m,pa,Ff,vb,d,Qa,Sl,qc,di,k,0,-0,0)}}break}while(!0);Ur(l)}function u3(l,d,m,x,S,k,L,W,te,Ne,_e,ze,je,$e){if(l.timeoutHandle=-1,ze=d.subtreeFlags,(ze&8192||(ze&16785408)===16785408)&&(Hd={stylesheets:null,count:0,unsuspend:h6},n3(d),ze=f6(),ze!==null)){l.cancelPendingCommit=ze(x3.bind(null,l,d,k,m,x,S,L,W,te,_e,1,je,$e)),mi(l,k,L,!Ne);return}x3(l,d,k,m,x,S,L,W,te)}function ER(l){for(var d=l;;){var m=d.tag;if((m===0||m===11||m===15)&&d.flags&16384&&(m=d.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var S=m[x],k=S.getSnapshot;S=S.value;try{if(!Ta(k(),S))return!1}catch(L){return!1}}if(m=d.child,d.subtreeFlags&16384&&m!==null)m.return=d,d=m;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function mi(l,d,m,x){d&=~yb,d&=~Sl,l.suspendedLanes|=d,l.pingedLanes&=~d,x&&(l.warmLanes|=d),x=l.expirationTimes;for(var S=d;0<S;){var k=31-It(S),L=1<<k;x[k]=-1,S&=~L}m!==0&&al(l,m,d)}function Lf(){return(es&6)===0?(zd(0),!1):!0}function jb(){if(Mt!==null){if(ts===0)var l=Mt.return;else l=Mt,bo=xl=null,V0(l),Vc=null,Ad=0,l=Mt;for(;l!==null;)US(l.alternate,l),l=l.return;Mt=null}}function Yc(l,d){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,XR(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),jb(),ps=l,Mt=m=mo(l.current,null),qt=d,ts=0,Ea=null,di=!1,Hc=Or(l,d),bb=!1,qc=Qa=yb=Sl=hi=Ds=0,pa=Md=null,vb=!1,(d&8)!==0&&(d|=d&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=d;0<x;){var S=31-It(x),k=1<<S;d|=l[S],x&=~k}return ko=d,af(),m}function d3(l,d){_t=null,B.H=Cf,d===wd||d===ff?(d=IN(),ts=3):d===jN?(d=IN(),ts=4):ts=d===$S?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,Ea=d,Mt===null&&(Ds=1,$f(l,qa(d,l.current)))}function h3(){var l=B.H;return B.H=Cf,l===null?Cf:l}function p3(){var l=B.A;return B.A=$R,l}function kb(){Ds=4,di||(qt&4194048)!==qt&&Za.current!==null||(Hc=!0),(hi&134217727)===0&&(Sl&134217727)===0||ps===null||mi(ps,qt,Qa,!1)}function Tb(l,d,m){var x=es;es|=2;var S=h3(),k=p3();(ps!==l||qt!==d)&&(Ff=null,Yc(l,d)),d=!1;var L=Ds;e:do try{if(ts!==0&&Mt!==null){var W=Mt,te=Ea;switch(ts){case 8:jb(),L=6;break e;case 3:case 2:case 9:case 6:Za.current===null&&(d=!0);var Ne=ts;if(ts=0,Ea=null,Zc(l,W,te,Ne),m&&Hc){L=0;break e}break;default:Ne=ts,ts=0,Ea=null,Zc(l,W,te,Ne)}}DR(),L=Ds;break}catch(_e){d3(l,_e)}while(!0);return d&&l.shellSuspendCounter++,bo=xl=null,es=x,B.H=S,B.A=k,Mt===null&&(ps=null,qt=0,af()),L}function DR(){for(;Mt!==null;)f3(Mt)}function RR(l,d){var m=es;es|=2;var x=h3(),S=p3();ps!==l||qt!==d?(Ff=null,_f=Fe()+500,Yc(l,d)):Hc=Or(l,d);e:do try{if(ts!==0&&Mt!==null){d=Mt;var k=Ea;t:switch(ts){case 1:ts=0,Ea=null,Zc(l,d,k,1);break;case 2:case 9:if(kN(k)){ts=0,Ea=null,m3(d);break}d=function(){ts!==2&&ts!==9||ps!==l||(ts=7),Ur(l)},k.then(d,d);break e;case 3:ts=7;break e;case 4:ts=5;break e;case 7:kN(k)?(ts=0,Ea=null,m3(d)):(ts=0,Ea=null,Zc(l,d,k,7));break;case 5:var L=null;switch(Mt.tag){case 26:L=Mt.memoizedState;case 5:case 27:var W=Mt;if(!L||Y3(L)){ts=0,Ea=null;var te=W.sibling;if(te!==null)Mt=te;else{var Ne=W.return;Ne!==null?(Mt=Ne,Mf(Ne)):Mt=null}break t}}ts=0,Ea=null,Zc(l,d,k,5);break;case 6:ts=0,Ea=null,Zc(l,d,k,6);break;case 8:jb(),Ds=6;break e;default:throw Error(n(462))}}OR();break}catch(_e){d3(l,_e)}while(!0);return bo=xl=null,B.H=x,B.A=S,es=m,Mt!==null?0:(ps=null,qt=0,af(),Ds)}function OR(){for(;Mt!==null&&!be();)f3(Mt)}function f3(l){var d=BS(l.alternate,l,ko);l.memoizedProps=l.pendingProps,d===null?Mf(l):Mt=d}function m3(l){var d=l,m=d.alternate;switch(d.tag){case 15:case 0:d=_S(m,d,d.pendingProps,d.type,void 0,qt);break;case 11:d=_S(m,d,d.pendingProps,d.type.render,d.ref,qt);break;case 5:V0(d);default:US(m,d),d=Mt=gN(d,ko),d=BS(m,d,ko)}l.memoizedProps=l.pendingProps,d===null?Mf(l):Mt=d}function Zc(l,d,m,x){bo=xl=null,V0(d),Vc=null,Ad=0;var S=d.return;try{if(SR(l,S,d,m,qt)){Ds=1,$f(l,qa(m,l.current)),Mt=null;return}}catch(k){if(S!==null)throw Mt=S,k;Ds=1,$f(l,qa(m,l.current)),Mt=null;return}d.flags&32768?(Yt||x===1?l=!0:Hc||(qt&536870912)!==0?l=!1:(di=l=!0,(x===2||x===9||x===3||x===6)&&(x=Za.current,x!==null&&x.tag===13&&(x.flags|=16384))),g3(d,l)):Mf(d)}function Mf(l){var d=l;do{if((d.flags&32768)!==0){g3(d,di);return}l=d.return;var m=jR(d.alternate,d,ko);if(m!==null){Mt=m;return}if(d=d.sibling,d!==null){Mt=d;return}Mt=d=l}while(d!==null);Ds===0&&(Ds=5)}function g3(l,d){do{var m=kR(l.alternate,l);if(m!==null){m.flags&=32767,Mt=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!d&&(l=l.sibling,l!==null)){Mt=l;return}Mt=l=m}while(l!==null);Ds=6,Mt=null}function x3(l,d,m,x,S,k,L,W,te){l.cancelPendingCommit=null;do Pf();while(An!==0);if((es&6)!==0)throw Error(n(327));if(d!==null){if(d===l.current)throw Error(n(177));if(k=d.lanes|d.childLanes,k|=x0,Ns(l,m,k,L,W,te),l===ps&&(Mt=ps=null,qt=0),Kc=d,fi=l,Xc=m,Nb=k,Sb=S,i3=x,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,MR(Wt,function(){return N3(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||x){x=B.T,B.T=null,S=G.p,G.p=2,L=es,es|=4;try{TR(l,d,m)}finally{es=L,G.p=S,B.T=x}}An=1,b3(),y3(),v3()}}function b3(){if(An===1){An=0;var l=fi,d=Kc,m=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||m){m=B.T,B.T=null;var x=G.p;G.p=2;var S=es;es|=4;try{e3(d,l);var k=Pb,L=oN(l.containerInfo),W=k.focusedElem,te=k.selectionRange;if(L!==W&&W&&W.ownerDocument&&rN(W.ownerDocument.documentElement,W)){if(te!==null&&h0(W)){var Ne=te.start,_e=te.end;if(_e===void 0&&(_e=Ne),"selectionStart"in W)W.selectionStart=Ne,W.selectionEnd=Math.min(_e,W.value.length);else{var ze=W.ownerDocument||document,je=ze&&ze.defaultView||window;if(je.getSelection){var $e=je.getSelection(),Ct=W.textContent.length,xt=Math.min(te.start,Ct),rs=te.end===void 0?xt:Math.min(te.end,Ct);!$e.extend&&xt>rs&&(L=rs,rs=xt,xt=L);var ge=aN(W,xt),de=aN(W,rs);if(ge&&de&&($e.rangeCount!==1||$e.anchorNode!==ge.node||$e.anchorOffset!==ge.offset||$e.focusNode!==de.node||$e.focusOffset!==de.offset)){var we=ze.createRange();we.setStart(ge.node,ge.offset),$e.removeAllRanges(),xt>rs?($e.addRange(we),$e.extend(de.node,de.offset)):(we.setEnd(de.node,de.offset),$e.addRange(we))}}}}for(ze=[],$e=W;$e=$e.parentNode;)$e.nodeType===1&&ze.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<ze.length;W++){var Le=ze[W];Le.element.scrollLeft=Le.left,Le.element.scrollTop=Le.top}}Zf=!!Mb,Pb=Mb=null}finally{es=S,G.p=x,B.T=m}}l.current=d,An=2}}function y3(){if(An===2){An=0;var l=fi,d=Kc,m=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||m){m=B.T,B.T=null;var x=G.p;G.p=2;var S=es;es|=4;try{YS(l,d.alternate,d)}finally{es=S,G.p=x,B.T=m}}An=3}}function v3(){if(An===4||An===3){An=0,ue();var l=fi,d=Kc,m=Xc,x=i3;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?An=5:(An=0,Kc=fi=null,w3(l,l.pendingLanes));var S=l.pendingLanes;if(S===0&&(pi=null),Oe(m),d=d.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(at,d,void 0,(d.current.flags&128)===128)}catch(te){}if(x!==null){d=B.T,S=G.p,G.p=2,B.T=null;try{for(var k=l.onRecoverableError,L=0;L<x.length;L++){var W=x[L];k(W.value,{componentStack:W.stack})}}finally{B.T=d,G.p=S}}(Xc&3)!==0&&Pf(),Ur(l),S=l.pendingLanes,(m&4194090)!==0&&(S&42)!==0?l===Cb?Pd++:(Pd=0,Cb=l):Pd=0,zd(0)}}function w3(l,d){(l.pooledCacheLanes&=d)===0&&(d=l.pooledCache,d!=null&&(l.pooledCache=null,yd(d)))}function Pf(l){return b3(),y3(),v3(),N3()}function N3(){if(An!==5)return!1;var l=fi,d=Nb;Nb=0;var m=Oe(Xc),x=B.T,S=G.p;try{G.p=32>m?32:m,B.T=null,m=Sb,Sb=null;var k=fi,L=Xc;if(An=0,Kc=fi=null,Xc=0,(es&6)!==0)throw Error(n(331));var W=es;if(es|=4,r3(k.current),s3(k,k.current,L,m),es=W,zd(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(at,k)}catch(te){}return!0}finally{G.p=S,B.T=x,w3(l,d)}}function S3(l,d,m){d=qa(m,d),d=sb(l.stateNode,d,2),l=ai(l,d,2),l!==null&&(on(l,2),Ur(l))}function us(l,d,m){if(l.tag===3)S3(l,l,m);else for(;d!==null;){if(d.tag===3){S3(d,l,m);break}else if(d.tag===1){var x=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(pi===null||!pi.has(x))){l=qa(m,l),m=TS(2),x=ai(d,m,2),x!==null&&(IS(m,x,d,l),on(x,2),Ur(x));break}}d=d.return}}function Ib(l,d,m){var x=l.pingCache;if(x===null){x=l.pingCache=new AR;var S=new Set;x.set(d,S)}else S=x.get(d),S===void 0&&(S=new Set,x.set(d,S));S.has(m)||(bb=!0,S.add(m),l=_R.bind(null,l,d,m),d.then(l,l))}function _R(l,d,m){var x=l.pingCache;x!==null&&x.delete(d),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,ps===l&&(qt&m)===m&&(Ds===4||Ds===3&&(qt&62914560)===qt&&300>Fe()-wb?(es&2)===0&&Yc(l,0):yb|=m,qc===qt&&(qc=0)),Ur(l)}function C3(l,d){d===0&&(d=nl()),l=Dc(l,d),l!==null&&(on(l,d),Ur(l))}function FR(l){var d=l.memoizedState,m=0;d!==null&&(m=d.retryLane),C3(l,m)}function LR(l,d){var m=0;switch(l.tag){case 13:var x=l.stateNode,S=l.memoizedState;S!==null&&(m=S.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(d),C3(l,m)}function MR(l,d){return We(l,d)}var zf=null,Qc=null,$b=!1,Bf=!1,Ab=!1,Cl=0;function Ur(l){l!==Qc&&l.next===null&&(Qc===null?zf=Qc=l:Qc=Qc.next=l),Bf=!0,$b||($b=!0,zR())}function zd(l,d){if(!Ab&&Bf){Ab=!0;do for(var m=!1,x=zf;x!==null;){if(l!==0){var S=x.pendingLanes;if(S===0)var k=0;else{var L=x.suspendedLanes,W=x.pingedLanes;k=(1<<31-It(42|l)+1)-1,k&=S&~(L&~W),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(m=!0,I3(x,k))}else k=qt,k=Ps(x,x===ps?k:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(k&3)===0||Or(x,k)||(m=!0,I3(x,k));x=x.next}while(m);Ab=!1}}function PR(){j3()}function j3(){Bf=$b=!1;var l=0;Cl!==0&&(KR()&&(l=Cl),Cl=0);for(var d=Fe(),m=null,x=zf;x!==null;){var S=x.next,k=k3(x,d);k===0?(x.next=null,m===null?zf=S:m.next=S,S===null&&(Qc=m)):(m=x,(l!==0||(k&3)!==0)&&(Bf=!0)),x=S}zd(l)}function k3(l,d){for(var m=l.suspendedLanes,x=l.pingedLanes,S=l.expirationTimes,k=l.pendingLanes&-62914561;0<k;){var L=31-It(k),W=1<<L,te=S[L];te===-1?((W&m)===0||(W&x)!==0)&&(S[L]=la(W,d)):te<=d&&(l.expiredLanes|=W),k&=~W}if(d=ps,m=qt,m=Ps(l,l===d?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,m===0||l===d&&(ts===2||ts===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&Ke(x),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||Or(l,m)){if(d=m&-m,d===l.callbackPriority)return d;switch(x!==null&&Ke(x),Oe(m)){case 2:case 8:m=Je;break;case 32:m=Wt;break;case 268435456:m=wt;break;default:m=Wt}return x=T3.bind(null,l),m=We(m,x),l.callbackPriority=d,l.callbackNode=m,d}return x!==null&&x!==null&&Ke(x),l.callbackPriority=2,l.callbackNode=null,2}function T3(l,d){if(An!==0&&An!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(Pf()&&l.callbackNode!==m)return null;var x=qt;return x=Ps(l,l===ps?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(c3(l,x,d),k3(l,Fe()),l.callbackNode!=null&&l.callbackNode===m?T3.bind(null,l):null)}function I3(l,d){if(Pf())return null;c3(l,d,!0)}function zR(){YR(function(){(es&6)!==0?We(rt,PR):j3()})}function Eb(){return Cl===0&&(Cl=sl()),Cl}function $3(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Qo(""+l)}function A3(l,d){var m=d.ownerDocument.createElement("input");return m.name=d.name,m.value=d.value,l.id&&m.setAttribute("form",l.id),d.parentNode.insertBefore(m,d),l=new FormData(l),m.parentNode.removeChild(m),l}function BR(l,d,m,x,S){if(d==="submit"&&m&&m.stateNode===S){var k=$3((S[Cs]||null).action),L=x.submitter;L&&(d=(d=L[Cs]||null)?$3(d.formAction):L.getAttribute("formAction"),d!==null&&(k=d,L=null));var W=new Jo("action","action",null,x,S);l.push({event:W,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Cl!==0){var te=L?A3(S,L):new FormData(S);Z0(m,{pending:!0,data:te,method:S.method,action:k},null,te)}}else typeof k=="function"&&(W.preventDefault(),te=L?A3(S,L):new FormData(S),Z0(m,{pending:!0,data:te,method:S.method,action:k},k,te))},currentTarget:S}]})}}for(var Db=0;Db<g0.length;Db++){var Rb=g0[Db],VR=Rb.toLowerCase(),UR=Rb[0].toUpperCase()+Rb.slice(1);xr(VR,"on"+UR)}xr(cN,"onAnimationEnd"),xr(uN,"onAnimationIteration"),xr(dN,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr(oR,"onTransitionRun"),xr(iR,"onTransitionStart"),xr(lR,"onTransitionCancel"),xr(hN,"onTransitionEnd"),uo("onMouseEnter",["mouseout","mouseover"]),uo("onMouseLeave",["mouseout","mouseover"]),uo("onPointerEnter",["pointerout","pointerover"]),uo("onPointerLeave",["pointerout","pointerover"]),Va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Va("onBeforeInput",["compositionend","keypress","textInput","paste"]),Va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bd));function E3(l,d){d=(d&4)!==0;for(var m=0;m<l.length;m++){var x=l[m],S=x.event;x=x.listeners;e:{var k=void 0;if(d)for(var L=x.length-1;0<=L;L--){var W=x[L],te=W.instance,Ne=W.currentTarget;if(W=W.listener,te!==k&&S.isPropagationStopped())break e;k=W,S.currentTarget=Ne;try{k(S)}catch(_e){If(_e)}S.currentTarget=null,k=te}else for(L=0;L<x.length;L++){if(W=x[L],te=W.instance,Ne=W.currentTarget,W=W.listener,te!==k&&S.isPropagationStopped())break e;k=W,S.currentTarget=Ne;try{k(S)}catch(_e){If(_e)}S.currentTarget=null,k=te}}}}function Pt(l,d){var m=d[io];m===void 0&&(m=d[io]=new Set);var x=l+"__bubble";m.has(x)||(D3(d,l,2,!1),m.add(x))}function Ob(l,d,m){var x=0;d&&(x|=4),D3(m,l,x,d)}var Vf="_reactListening"+Math.random().toString(36).slice(2);function _b(l){if(!l[Vf]){l[Vf]=!0,Xp.forEach(function(m){m!=="selectionchange"&&(GR.has(m)||Ob(m,!1,l),Ob(m,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[Vf]||(d[Vf]=!0,Ob("selectionchange",!1,d))}}function D3(l,d,m,x){switch(s4(d)){case 2:var S=x6;break;case 8:S=b6;break;default:S=Xb}m=S.bind(null,d,m,l),S=void 0,!id||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),x?S!==void 0?l.addEventListener(d,m,{capture:!0,passive:S}):l.addEventListener(d,m,!0):S!==void 0?l.addEventListener(d,m,{passive:S}):l.addEventListener(d,m,!1)}function Fb(l,d,m,x,S){var k=x;if((d&1)===0&&(d&2)===0&&x!==null)e:for(;;){if(x===null)return;var L=x.tag;if(L===3||L===4){var W=x.stateNode.containerInfo;if(W===S)break;if(L===4)for(L=x.return;L!==null;){var te=L.tag;if((te===3||te===4)&&L.stateNode.containerInfo===S)return;L=L.return}for(;W!==null;){if(L=lo(W),L===null)return;if(te=L.tag,te===5||te===6||te===26||te===27){x=k=L;continue e}W=W.parentNode}}x=x.return}od(function(){var Ne=k,_e=wc(m),ze=[];e:{var je=pN.get(l);if(je!==void 0){var $e=Jo,Ct=l;switch(l){case"keypress":if(jc(m)===0)break e;case"keydown":case"keyup":$e=Ut;break;case"focusin":Ct="focus",$e=z;break;case"focusout":Ct="blur",$e=z;break;case"beforeblur":case"afterblur":$e=z;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=tf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=j;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=ua;break;case cN:case uN:case dN:$e=ne;break;case hN:$e=Ht;break;case"scroll":case"scrollend":$e=l0;break;case"wheel":$e=Mr;break;case"copy":case"cut":case"paste":$e=ie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=Jt;break;case"toggle":case"beforetoggle":$e=qD}var xt=(d&4)!==0,rs=!xt&&(l==="scroll"||l==="scrollend"),ge=xt?je!==null?je+"Capture":null:je;xt=[];for(var de=Ne,we;de!==null;){var Le=de;if(we=Le.stateNode,Le=Le.tag,Le!==5&&Le!==26&&Le!==27||we===null||ge===null||(Le=ol(de,ge),Le!=null&&xt.push(Vd(de,Le,we))),rs)break;de=de.return}0<xt.length&&(je=new $e(je,Ct,null,m,_e),ze.push({event:je,listeners:xt}))}}if((d&7)===0){e:{if(je=l==="mouseover"||l==="pointerover",$e=l==="mouseout"||l==="pointerout",je&&m!==vc&&(Ct=m.relatedTarget||m.fromElement)&&(lo(Ct)||Ct[Ba]))break e;if(($e||je)&&(je=_e.window===_e?_e:(je=_e.ownerDocument)?je.defaultView||je.parentWindow:window,$e?(Ct=m.relatedTarget||m.toElement,$e=Ne,Ct=Ct?lo(Ct):null,Ct!==null&&(rs=o(Ct),xt=Ct.tag,Ct!==rs||xt!==5&&xt!==27&&xt!==6)&&(Ct=null)):($e=null,Ct=Ne),$e!==Ct)){if(xt=tf,Le="onMouseLeave",ge="onMouseEnter",de="mouse",(l==="pointerout"||l==="pointerover")&&(xt=Jt,Le="onPointerLeave",ge="onPointerEnter",de="pointer"),rs=$e==null?je:Xo($e),we=Ct==null?je:Xo(Ct),je=new xt(Le,de+"leave",$e,m,_e),je.target=rs,je.relatedTarget=we,Le=null,lo(_e)===Ne&&(xt=new xt(ge,de+"enter",Ct,m,_e),xt.target=we,xt.relatedTarget=rs,Le=xt),rs=Le,$e&&Ct)t:{for(xt=$e,ge=Ct,de=0,we=xt;we;we=Jc(we))de++;for(we=0,Le=ge;Le;Le=Jc(Le))we++;for(;0<de-we;)xt=Jc(xt),de--;for(;0<we-de;)ge=Jc(ge),we--;for(;de--;){if(xt===ge||ge!==null&&xt===ge.alternate)break t;xt=Jc(xt),ge=Jc(ge)}xt=null}else xt=null;$e!==null&&R3(ze,je,$e,xt,!1),Ct!==null&&rs!==null&&R3(ze,rs,Ct,xt,!0)}}e:{if(je=Ne?Xo(Ne):window,$e=je.nodeName&&je.nodeName.toLowerCase(),$e==="select"||$e==="input"&&je.type==="file")var ut=Qw;else if(Yw(je))if(Jw)ut=nR;else{ut=tR;var Lt=eR}else $e=je.nodeName,!$e||$e.toLowerCase()!=="input"||je.type!=="checkbox"&&je.type!=="radio"?Ne&&yc(Ne.elementType)&&(ut=Qw):ut=sR;if(ut&&(ut=ut(l,Ne))){Zw(ze,ut,m,_e);break e}Lt&&Lt(l,je,Ne),l==="focusout"&&Ne&&je.type==="number"&&Ne.memoizedProps.value!=null&&xc(je,"number",je.value)}switch(Lt=Ne?Xo(Ne):window,l){case"focusin":(Yw(Lt)||Lt.contentEditable==="true")&&($c=Lt,p0=Ne,fd=null);break;case"focusout":fd=p0=$c=null;break;case"mousedown":f0=!0;break;case"contextmenu":case"mouseup":case"dragend":f0=!1,iN(ze,m,_e);break;case"selectionchange":if(rR)break;case"keydown":case"keyup":iN(ze,m,_e)}var mt;if(c0)e:{switch(l){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else Ic?Kw(l,m)&&(bt="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(bt="onCompositionStart");bt&&(Ww&&m.locale!=="ko"&&(Ic||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&Ic&&(mt=ef()):(Ha=_e,Sc="value"in Ha?Ha.value:Ha.textContent,Ic=!0)),Lt=Uf(Ne,bt),0<Lt.length&&(bt=new De(bt,l,null,m,_e),ze.push({event:bt,listeners:Lt}),mt?bt.data=mt:(mt=Xw(m),mt!==null&&(bt.data=mt)))),(mt=XD?YD(l,m):ZD(l,m))&&(bt=Uf(Ne,"onBeforeInput"),0<bt.length&&(Lt=new De("onBeforeInput","beforeinput",null,m,_e),ze.push({event:Lt,listeners:bt}),Lt.data=mt)),BR(ze,l,Ne,m,_e)}E3(ze,d)})}function Vd(l,d,m){return{instance:l,listener:d,currentTarget:m}}function Uf(l,d){for(var m=d+"Capture",x=[];l!==null;){var S=l,k=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=ol(l,m),S!=null&&x.unshift(Vd(l,S,k)),S=ol(l,d),S!=null&&x.push(Vd(l,S,k))),l.tag===3)return x;l=l.return}return[]}function Jc(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function R3(l,d,m,x,S){for(var k=d._reactName,L=[];m!==null&&m!==x;){var W=m,te=W.alternate,Ne=W.stateNode;if(W=W.tag,te!==null&&te===x)break;W!==5&&W!==26&&W!==27||Ne===null||(te=Ne,S?(Ne=ol(m,k),Ne!=null&&L.unshift(Vd(m,Ne,te))):S||(Ne=ol(m,k),Ne!=null&&L.push(Vd(m,Ne,te)))),m=m.return}L.length!==0&&l.push({event:d,listeners:L})}var WR=/\r\n?/g,HR=/\u0000|\uFFFD/g;function O3(l){return(typeof l=="string"?l:""+l).replace(WR,"\n").replace(HR,"")}function _3(l,d){return d=O3(d),O3(l)===d}function Gf(){}function as(l,d,m,x,S,k){switch(m){case"children":typeof x=="string"?d==="body"||d==="textarea"&&x===""||Zo(l,x):(typeof x=="number"||typeof x=="bigint")&&d!=="body"&&Zo(l,""+x);break;case"className":pc(l,"class",x);break;case"tabIndex":pc(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":pc(l,m,x);break;case"style":ad(l,x,k);break;case"data":if(d!=="object"){pc(l,"data",x);break}case"src":case"href":if(x===""&&(d!=="a"||m!=="href")){l.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Qo(""+x),l.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(m==="formAction"?(d!=="input"&&as(l,d,"name",S.name,S,null),as(l,d,"formEncType",S.formEncType,S,null),as(l,d,"formMethod",S.formMethod,S,null),as(l,d,"formTarget",S.formTarget,S,null)):(as(l,d,"encType",S.encType,S,null),as(l,d,"method",S.method,S,null),as(l,d,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Qo(""+x),l.setAttribute(m,x);break;case"onClick":x!=null&&(l.onclick=Gf);break;case"onScroll":x!=null&&Pt("scroll",l);break;case"onScrollEnd":x!=null&&Pt("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}m=Qo(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""+x):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":x===!0?l.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,x):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(m,x):l.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(m):l.setAttribute(m,x);break;case"popover":Pt("beforetoggle",l),Pt("toggle",l),hc(l,"popover",x);break;case"xlinkActuate":Ua(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ua(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ua(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ua(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ua(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ua(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ua(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ua(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ua(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":hc(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=o0.get(m)||m,hc(l,m,x))}}function Lb(l,d,m,x,S,k){switch(m){case"style":ad(l,x,k);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"children":typeof x=="string"?Zo(l,x):(typeof x=="number"||typeof x=="bigint")&&Zo(l,""+x);break;case"onScroll":x!=null&&Pt("scroll",l);break;case"onScrollEnd":x!=null&&Pt("scrollend",l);break;case"onClick":x!=null&&(l.onclick=Gf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yu.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(S=m.endsWith("Capture"),d=m.slice(2,S?m.length-7:void 0),k=l[Cs]||null,k=k!=null?k[m]:null,typeof k=="function"&&l.removeEventListener(d,k,S),typeof x=="function")){typeof k!="function"&&k!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(d,x,S);break e}m in l?l[m]=x:x===!0?l.setAttribute(m,""):hc(l,m,x)}}}function En(l,d,m){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pt("error",l),Pt("load",l);var x=!1,S=!1,k;for(k in m)if(m.hasOwnProperty(k)){var L=m[k];if(L!=null)switch(k){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:as(l,d,k,L,m,null)}}S&&as(l,d,"srcSet",m.srcSet,m,null),x&&as(l,d,"src",m.src,m,null);return;case"input":Pt("invalid",l);var W=k=L=S=null,te=null,Ne=null;for(x in m)if(m.hasOwnProperty(x)){var _e=m[x];if(_e!=null)switch(x){case"name":S=_e;break;case"type":L=_e;break;case"checked":te=_e;break;case"defaultChecked":Ne=_e;break;case"value":k=_e;break;case"defaultValue":W=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,d));break;default:as(l,d,x,_e,m,null)}}Jn(l,k,W,te,Ne,L,S,!1),Lr(l);return;case"select":Pt("invalid",l),x=L=k=null;for(S in m)if(m.hasOwnProperty(S)&&(W=m[S],W!=null))switch(S){case"value":k=W;break;case"defaultValue":L=W;break;case"multiple":x=W;default:as(l,d,S,W,m,null)}d=k,m=L,l.multiple=!!x,d!=null?Ga(l,!!x,d,!1):m!=null&&Ga(l,!!x,m,!0);return;case"textarea":Pt("invalid",l),k=S=x=null;for(L in m)if(m.hasOwnProperty(L)&&(W=m[L],W!=null))switch(L){case"value":x=W;break;case"defaultValue":S=W;break;case"children":k=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(91));break;default:as(l,d,L,W,m,null)}bc(l,x,S,k),Lr(l);return;case"option":for(te in m)if(m.hasOwnProperty(te)&&(x=m[te],x!=null))switch(te){case"selected":l.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:as(l,d,te,x,m,null)}return;case"dialog":Pt("beforetoggle",l),Pt("toggle",l),Pt("cancel",l),Pt("close",l);break;case"iframe":case"object":Pt("load",l);break;case"video":case"audio":for(x=0;x<Bd.length;x++)Pt(Bd[x],l);break;case"image":Pt("error",l),Pt("load",l);break;case"details":Pt("toggle",l);break;case"embed":case"source":case"link":Pt("error",l),Pt("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in m)if(m.hasOwnProperty(Ne)&&(x=m[Ne],x!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:as(l,d,Ne,x,m,null)}return;default:if(yc(d)){for(_e in m)m.hasOwnProperty(_e)&&(x=m[_e],x!==void 0&&Lb(l,d,_e,x,m,void 0));return}}for(W in m)m.hasOwnProperty(W)&&(x=m[W],x!=null&&as(l,d,W,x,m,null))}function qR(l,d,m,x){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,L=null,W=null,te=null,Ne=null,_e=null;for($e in m){var ze=m[$e];if(m.hasOwnProperty($e)&&ze!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":te=ze;default:x.hasOwnProperty($e)||as(l,d,$e,null,x,ze)}}for(var je in x){var $e=x[je];if(ze=m[je],x.hasOwnProperty(je)&&($e!=null||ze!=null))switch(je){case"type":k=$e;break;case"name":S=$e;break;case"checked":Ne=$e;break;case"defaultChecked":_e=$e;break;case"value":L=$e;break;case"defaultValue":W=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(n(137,d));break;default:$e!==ze&&as(l,d,je,$e,x,ze)}}gc(l,L,W,te,Ne,_e,k,S);return;case"select":$e=L=W=je=null;for(k in m)if(te=m[k],m.hasOwnProperty(k)&&te!=null)switch(k){case"value":break;case"multiple":$e=te;default:x.hasOwnProperty(k)||as(l,d,k,null,x,te)}for(S in x)if(k=x[S],te=m[S],x.hasOwnProperty(S)&&(k!=null||te!=null))switch(S){case"value":je=k;break;case"defaultValue":W=k;break;case"multiple":L=k;default:k!==te&&as(l,d,S,k,x,te)}d=W,m=L,x=$e,je!=null?Ga(l,!!m,je,!1):!!x!=!!m&&(d!=null?Ga(l,!!m,d,!0):Ga(l,!!m,m?[]:"",!1));return;case"textarea":$e=je=null;for(W in m)if(S=m[W],m.hasOwnProperty(W)&&S!=null&&!x.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:as(l,d,W,null,x,S)}for(L in x)if(S=x[L],k=m[L],x.hasOwnProperty(L)&&(S!=null||k!=null))switch(L){case"value":je=S;break;case"defaultValue":$e=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==k&&as(l,d,L,S,x,k)}nd(l,je,$e);return;case"option":for(var Ct in m)if(je=m[Ct],m.hasOwnProperty(Ct)&&je!=null&&!x.hasOwnProperty(Ct))switch(Ct){case"selected":l.selected=!1;break;default:as(l,d,Ct,null,x,je)}for(te in x)if(je=x[te],$e=m[te],x.hasOwnProperty(te)&&je!==$e&&(je!=null||$e!=null))switch(te){case"selected":l.selected=je&&typeof je!="function"&&typeof je!="symbol";break;default:as(l,d,te,je,x,$e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in m)je=m[xt],m.hasOwnProperty(xt)&&je!=null&&!x.hasOwnProperty(xt)&&as(l,d,xt,null,x,je);for(Ne in x)if(je=x[Ne],$e=m[Ne],x.hasOwnProperty(Ne)&&je!==$e&&(je!=null||$e!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(n(137,d));break;default:as(l,d,Ne,je,x,$e)}return;default:if(yc(d)){for(var rs in m)je=m[rs],m.hasOwnProperty(rs)&&je!==void 0&&!x.hasOwnProperty(rs)&&Lb(l,d,rs,void 0,x,je);for(_e in x)je=x[_e],$e=m[_e],!x.hasOwnProperty(_e)||je===$e||je===void 0&&$e===void 0||Lb(l,d,_e,je,x,$e);return}}for(var ge in m)je=m[ge],m.hasOwnProperty(ge)&&je!=null&&!x.hasOwnProperty(ge)&&as(l,d,ge,null,x,je);for(ze in x)je=x[ze],$e=m[ze],!x.hasOwnProperty(ze)||je===$e||je==null&&$e==null||as(l,d,ze,je,x,$e)}var Mb=null,Pb=null;function Wf(l){return l.nodeType===9?l:l.ownerDocument}function F3(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function L3(l,d){if(l===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&d==="foreignObject"?0:l}function zb(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Bb=null;function KR(){var l=window.event;return l&&l.type==="popstate"?l===Bb?!1:(Bb=l,!0):(Bb=null,!1)}var M3=typeof setTimeout=="function"?setTimeout:void 0,XR=typeof clearTimeout=="function"?clearTimeout:void 0,P3=typeof Promise=="function"?Promise:void 0,YR=typeof queueMicrotask=="function"?queueMicrotask:typeof P3<"u"?function(l){return P3.resolve(null).then(l).catch(ZR)}:M3;function ZR(l){setTimeout(function(){throw l})}function gi(l){return l==="head"}function z3(l,d){var m=d,x=0,S=0;do{var k=m.nextSibling;if(l.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(0<x&&8>x){m=x;var L=l.ownerDocument;if(m&1&&Ud(L.documentElement),m&2&&Ud(L.body),m&4)for(m=L.head,Ud(m),L=m.firstChild;L;){var W=L.nextSibling,te=L.nodeName;L[Fr]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&L.rel.toLowerCase()==="stylesheet"||m.removeChild(L),L=W}}if(S===0){l.removeChild(k),Zd(d);return}S--}else m==="$"||m==="$?"||m==="$!"?S++:x=m.charCodeAt(0)-48;else x=0;m=k}while(m);Zd(d)}function Vb(l){var d=l.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var m=d;switch(d=d.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Vb(m),dc(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function QR(l,d,m,x){for(;l.nodeType===1;){var S=m;if(l.nodeName.toLowerCase()!==d.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[Fr])switch(d){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(k=l.getAttribute("rel"),k==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(k!==S.rel||l.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||l.getAttribute("title")!==(S.title==null?null:S.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(k=l.getAttribute("src"),(k!==(S.src==null?null:S.src)||l.getAttribute("type")!==(S.type==null?null:S.type)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(d==="input"&&l.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&l.getAttribute("name")===k)return l}else return l;if(l=yr(l.nextSibling),l===null)break}return null}function JR(l,d,m){if(d==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=yr(l.nextSibling),l===null))return null;return l}function Ub(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function e6(l,d){var m=l.ownerDocument;if(l.data!=="$?"||m.readyState==="complete")d();else{var x=function(){d(),m.removeEventListener("DOMContentLoaded",x)};m.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function yr(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return l}var Gb=null;function B3(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(d===0)return l;d--}else m==="/$"&&d++}l=l.previousSibling}return null}function V3(l,d,m){switch(d=Wf(m),l){case"html":if(l=d.documentElement,!l)throw Error(n(452));return l;case"head":if(l=d.head,!l)throw Error(n(453));return l;case"body":if(l=d.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function Ud(l){for(var d=l.attributes;d.length;)l.removeAttributeNode(d[0]);dc(l)}var Ja=new Map,U3=new Set;function Hf(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var To=G.d;G.d={f:t6,r:s6,D:n6,C:a6,L:r6,m:o6,X:l6,S:i6,M:c6};function t6(){var l=To.f(),d=Lf();return l||d}function s6(l){var d=gr(l);d!==null&&d.tag===5&&d.type==="form"?cS(d):To.r(l)}var eu=typeof document>"u"?null:document;function G3(l,d,m){var x=eu;if(x&&typeof d=="string"&&d){var S=Qn(d);S='link[rel="'+l+'"][href="'+S+'"]',typeof m=="string"&&(S+='[crossorigin="'+m+'"]'),U3.has(S)||(U3.add(S),l={rel:l,crossOrigin:m,href:d},x.querySelector(S)===null&&(d=x.createElement("link"),En(d,"link",l),Ws(d),x.head.appendChild(d)))}}function n6(l){To.D(l),G3("dns-prefetch",l,null)}function a6(l,d){To.C(l,d),G3("preconnect",l,d)}function r6(l,d,m){To.L(l,d,m);var x=eu;if(x&&l&&d){var S='link[rel="preload"][as="'+Qn(d)+'"]';d==="image"&&m&&m.imageSrcSet?(S+='[imagesrcset="'+Qn(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(S+='[imagesizes="'+Qn(m.imageSizes)+'"]')):S+='[href="'+Qn(l)+'"]';var k=S;switch(d){case"style":k=tu(l);break;case"script":k=su(l)}Ja.has(k)||(l=p({rel:"preload",href:d==="image"&&m&&m.imageSrcSet?void 0:l,as:d},m),Ja.set(k,l),x.querySelector(S)!==null||d==="style"&&x.querySelector(Gd(k))||d==="script"&&x.querySelector(Wd(k))||(d=x.createElement("link"),En(d,"link",l),Ws(d),x.head.appendChild(d)))}}function o6(l,d){To.m(l,d);var m=eu;if(m&&l){var x=d&&typeof d.as=="string"?d.as:"script",S='link[rel="modulepreload"][as="'+Qn(x)+'"][href="'+Qn(l)+'"]',k=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=su(l)}if(!Ja.has(k)&&(l=p({rel:"modulepreload",href:l},d),Ja.set(k,l),m.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(Wd(k)))return}x=m.createElement("link"),En(x,"link",l),Ws(x),m.head.appendChild(x)}}}function i6(l,d,m){To.S(l,d,m);var x=eu;if(x&&l){var S=co(x).hoistableStyles,k=tu(l);d=d||"default";var L=S.get(k);if(!L){var W={loading:0,preload:null};if(L=x.querySelector(Gd(k)))W.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":d},m),(m=Ja.get(k))&&Wb(l,m);var te=L=x.createElement("link");Ws(te),En(te,"link",l),te._p=new Promise(function(Ne,_e){te.onload=Ne,te.onerror=_e}),te.addEventListener("load",function(){W.loading|=1}),te.addEventListener("error",function(){W.loading|=2}),W.loading|=4,qf(L,d,x)}L={type:"stylesheet",instance:L,count:1,state:W},S.set(k,L)}}}function l6(l,d){To.X(l,d);var m=eu;if(m&&l){var x=co(m).hoistableScripts,S=su(l),k=x.get(S);k||(k=m.querySelector(Wd(S)),k||(l=p({src:l,async:!0},d),(d=Ja.get(S))&&Hb(l,d),k=m.createElement("script"),Ws(k),En(k,"link",l),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},x.set(S,k))}}function c6(l,d){To.M(l,d);var m=eu;if(m&&l){var x=co(m).hoistableScripts,S=su(l),k=x.get(S);k||(k=m.querySelector(Wd(S)),k||(l=p({src:l,async:!0,type:"module"},d),(d=Ja.get(S))&&Hb(l,d),k=m.createElement("script"),Ws(k),En(k,"link",l),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},x.set(S,k))}}function W3(l,d,m,x){var S=(S=pe.current)?Hf(S):null;if(!S)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(d=tu(m.href),m=co(S).hoistableStyles,x=m.get(d),x||(x={type:"style",instance:null,count:0,state:null},m.set(d,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=tu(m.href);var k=co(S).hoistableStyles,L=k.get(l);if(L||(S=S.ownerDocument||S,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(l,L),(k=S.querySelector(Gd(l)))&&!k._p&&(L.instance=k,L.state.loading=5),Ja.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Ja.set(l,m),k||u6(S,l,m,L.state))),d&&x===null)throw Error(n(528,""));return L}if(d&&x!==null)throw Error(n(529,""));return null;case"script":return d=m.async,m=m.src,typeof m=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=su(m),m=co(S).hoistableScripts,x=m.get(d),x||(x={type:"script",instance:null,count:0,state:null},m.set(d,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function tu(l){return'href="'+Qn(l)+'"'}function Gd(l){return'link[rel="stylesheet"]['+l+"]"}function H3(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function u6(l,d,m,x){l.querySelector('link[rel="preload"][as="style"]['+d+"]")?x.loading=1:(d=l.createElement("link"),x.preload=d,d.addEventListener("load",function(){return x.loading|=1}),d.addEventListener("error",function(){return x.loading|=2}),En(d,"link",m),Ws(d),l.head.appendChild(d))}function su(l){return'[src="'+Qn(l)+'"]'}function Wd(l){return"script[async]"+l}function q3(l,d,m){if(d.count++,d.instance===null)switch(d.type){case"style":var x=l.querySelector('style[data-href~="'+Qn(m.href)+'"]');if(x)return d.instance=x,Ws(x),x;var S=p({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),Ws(x),En(x,"style",S),qf(x,m.precedence,l),d.instance=x;case"stylesheet":S=tu(m.href);var k=l.querySelector(Gd(S));if(k)return d.state.loading|=4,d.instance=k,Ws(k),k;x=H3(m),(S=Ja.get(S))&&Wb(x,S),k=(l.ownerDocument||l).createElement("link"),Ws(k);var L=k;return L._p=new Promise(function(W,te){L.onload=W,L.onerror=te}),En(k,"link",x),d.state.loading|=4,qf(k,m.precedence,l),d.instance=k;case"script":return k=su(m.src),(S=l.querySelector(Wd(k)))?(d.instance=S,Ws(S),S):(x=m,(S=Ja.get(k))&&(x=p({},m),Hb(x,S)),l=l.ownerDocument||l,S=l.createElement("script"),Ws(S),En(S,"link",x),l.head.appendChild(S),d.instance=S);case"void":return null;default:throw Error(n(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(x=d.instance,d.state.loading|=4,qf(x,m.precedence,l));return d.instance}function qf(l,d,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,k=S,L=0;L<x.length;L++){var W=x[L];if(W.dataset.precedence===d)k=W;else if(k!==S)break}k?k.parentNode.insertBefore(l,k.nextSibling):(d=m.nodeType===9?m.head:m,d.insertBefore(l,d.firstChild))}function Wb(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.title==null&&(l.title=d.title)}function Hb(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.integrity==null&&(l.integrity=d.integrity)}var Kf=null;function K3(l,d,m){if(Kf===null){var x=new Map,S=Kf=new Map;S.set(m,x)}else S=Kf,x=S.get(m),x||(x=new Map,S.set(m,x));if(x.has(l))return x;for(x.set(l,null),m=m.getElementsByTagName(l),S=0;S<m.length;S++){var k=m[S];if(!(k[Fr]||k[Ss]||l==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var L=k.getAttribute(d)||"";L=l+L;var W=x.get(L);W?W.push(k):x.set(L,[k])}}return x}function X3(l,d,m){l=l.ownerDocument||l,l.head.insertBefore(m,d==="title"?l.querySelector("head > title"):null)}function d6(l,d,m){if(m===1||d.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return l=d.disabled,typeof d.precedence=="string"&&l==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function Y3(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var Hd=null;function h6(){}function p6(l,d,m){if(Hd===null)throw Error(n(475));var x=Hd;if(d.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var S=tu(m.href),k=l.querySelector(Gd(S));if(k){l=k._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(x.count++,x=Xf.bind(x),l.then(x,x)),d.state.loading|=4,d.instance=k,Ws(k);return}k=l.ownerDocument||l,m=H3(m),(S=Ja.get(S))&&Wb(m,S),k=k.createElement("link"),Ws(k);var L=k;L._p=new Promise(function(W,te){L.onload=W,L.onerror=te}),En(k,"link",m),d.instance=k}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(x.count++,d=Xf.bind(x),l.addEventListener("load",d),l.addEventListener("error",d))}}function f6(){if(Hd===null)throw Error(n(475));var l=Hd;return l.stylesheets&&l.count===0&&qb(l,l.stylesheets),0<l.count?function(d){var m=setTimeout(function(){if(l.stylesheets&&qb(l,l.stylesheets),l.unsuspend){var x=l.unsuspend;l.unsuspend=null,x()}},6e4);return l.unsuspend=d,function(){l.unsuspend=null,clearTimeout(m)}}:null}function Xf(){if(this.count--,this.count===0){if(this.stylesheets)qb(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Yf=null;function qb(l,d){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Yf=new Map,d.forEach(m6,l),Yf=null,Xf.call(l))}function m6(l,d){if(!(d.state.loading&4)){var m=Yf.get(l);if(m)var x=m.get(null);else{m=new Map,Yf.set(l,m);for(var S=l.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var L=S[k];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(m.set(L.dataset.precedence,L),x=L)}x&&m.set(null,x)}S=d.instance,L=S.getAttribute("data-precedence"),k=m.get(L)||x,k===x&&m.set(null,S),m.set(L,S),this.count++,x=Xf.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),k?k.parentNode.insertBefore(S,k.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(S,l.firstChild)),d.state.loading|=4}}var qd={$$typeof:T,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function g6(l,d,m,x,S,k,L,W){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ko(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ko(0),this.hiddenUpdates=Ko(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Z3(l,d,m,x,S,k,L,W,te,Ne,_e,ze){return l=new g6(l,d,m,L,W,te,Ne,ze),d=1,k===!0&&(d|=24),k=Ia(3,null,null,d),l.current=k,k.stateNode=l,d=I0(),d.refCount++,l.pooledCache=d,d.refCount++,k.memoizedState={element:x,isDehydrated:m,cache:d},D0(k),l}function Q3(l){return l?(l=Rc,l):Rc}function J3(l,d,m,x,S,k){S=Q3(S),x.context===null?x.context=S:x.pendingContext=S,x=ni(d),x.payload={element:m},k=k===void 0?null:k,k!==null&&(x.callback=k),m=ai(l,x,d),m!==null&&(Ra(m,l,d),Sd(m,l,d))}function e4(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<d?m:d}}function Kb(l,d){e4(l,d),(l=l.alternate)&&e4(l,d)}function t4(l){if(l.tag===13){var d=Dc(l,67108864);d!==null&&Ra(d,l,67108864),Kb(l,67108864)}}var Zf=!0;function x6(l,d,m,x){var S=B.T;B.T=null;var k=G.p;try{G.p=2,Xb(l,d,m,x)}finally{G.p=k,B.T=S}}function b6(l,d,m,x){var S=B.T;B.T=null;var k=G.p;try{G.p=8,Xb(l,d,m,x)}finally{G.p=k,B.T=S}}function Xb(l,d,m,x){if(Zf){var S=Yb(x);if(S===null)Fb(l,d,x,Qf,m),n4(l,x);else if(v6(S,l,d,m,x))x.stopPropagation();else if(n4(l,x),d&4&&-1<y6.indexOf(l)){for(;S!==null;){var k=gr(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var L=As(k.pendingLanes);if(L!==0){var W=k;for(W.pendingLanes|=2,W.entangledLanes|=2;L;){var te=1<<31-It(L);W.entanglements[1]|=te,L&=~te}Ur(k),(es&6)===0&&(_f=Fe()+500,zd(0))}}break;case 13:W=Dc(k,2),W!==null&&Ra(W,k,2),Lf(),Kb(k,2)}if(k=Yb(x),k===null&&Fb(l,d,x,Qf,m),k===S)break;S=k}S!==null&&x.stopPropagation()}else Fb(l,d,x,null,m)}}function Yb(l){return l=wc(l),Zb(l)}var Qf=null;function Zb(l){if(Qf=null,l=lo(l),l!==null){var d=o(l);if(d===null)l=null;else{var m=d.tag;if(m===13){if(l=i(d),l!==null)return l;l=null}else if(m===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null)}}return Qf=l,null}function s4(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case rt:return 2;case Je:return 8;case Wt:case At:return 32;case wt:return 268435456;default:return 32}default:return 32}}var Qb=!1,xi=null,bi=null,yi=null,Kd=new Map,Xd=new Map,vi=[],y6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function n4(l,d){switch(l){case"focusin":case"focusout":xi=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Kd.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xd.delete(d.pointerId)}}function Yd(l,d,m,x,S,k){return l===null||l.nativeEvent!==k?(l={blockedOn:d,domEventName:m,eventSystemFlags:x,nativeEvent:k,targetContainers:[S]},d!==null&&(d=gr(d),d!==null&&t4(d)),l):(l.eventSystemFlags|=x,d=l.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),l)}function v6(l,d,m,x,S){switch(d){case"focusin":return xi=Yd(xi,l,d,m,x,S),!0;case"dragenter":return bi=Yd(bi,l,d,m,x,S),!0;case"mouseover":return yi=Yd(yi,l,d,m,x,S),!0;case"pointerover":var k=S.pointerId;return Kd.set(k,Yd(Kd.get(k)||null,l,d,m,x,S)),!0;case"gotpointercapture":return k=S.pointerId,Xd.set(k,Yd(Xd.get(k)||null,l,d,m,x,S)),!0}return!1}function a4(l){var d=lo(l.target);if(d!==null){var m=o(d);if(m!==null){if(d=m.tag,d===13){if(d=i(m),d!==null){l.blockedOn=d,Ln(l.priority,function(){if(m.tag===13){var x=Da();x=_r(x);var S=Dc(m,x);S!==null&&Ra(S,m,x),Kb(m,x)}});return}}else if(d===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Jf(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var m=Yb(l.nativeEvent);if(m===null){m=l.nativeEvent;var x=new m.constructor(m.type,m);vc=x,m.target.dispatchEvent(x),vc=null}else return d=gr(m),d!==null&&t4(d),l.blockedOn=m,!1;d.shift()}return!0}function r4(l,d,m){Jf(l)&&m.delete(d)}function w6(){Qb=!1,xi!==null&&Jf(xi)&&(xi=null),bi!==null&&Jf(bi)&&(bi=null),yi!==null&&Jf(yi)&&(yi=null),Kd.forEach(r4),Xd.forEach(r4)}function em(l,d){l.blockedOn===d&&(l.blockedOn=null,Qb||(Qb=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,w6)))}var tm=null;function o4(l){tm!==l&&(tm=l,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){tm===l&&(tm=null);for(var d=0;d<l.length;d+=3){var m=l[d],x=l[d+1],S=l[d+2];if(typeof x!="function"){if(Zb(x||m)===null)continue;break}var k=gr(m);k!==null&&(l.splice(d,3),d-=3,Z0(k,{pending:!0,data:S,method:m.method,action:x},x,S))}}))}function Zd(l){function d(te){return em(te,l)}xi!==null&&em(xi,l),bi!==null&&em(bi,l),yi!==null&&em(yi,l),Kd.forEach(d),Xd.forEach(d);for(var m=0;m<vi.length;m++){var x=vi[m];x.blockedOn===l&&(x.blockedOn=null)}for(;0<vi.length&&(m=vi[0],m.blockedOn===null);)a4(m),m.blockedOn===null&&vi.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var S=m[x],k=m[x+1],L=S[Cs]||null;if(typeof k=="function")L||o4(m);else if(L){var W=null;if(k&&k.hasAttribute("formAction")){if(S=k,L=k[Cs]||null)W=L.formAction;else if(Zb(S)!==null)continue}else W=L.action;typeof W=="function"?m[x+1]=W:(m.splice(x,3),x-=3),o4(m)}}}function Jb(l){this._internalRoot=l}sm.prototype.render=Jb.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(n(409));var m=d.current,x=Da();J3(m,x,l,d,null,null)},sm.prototype.unmount=Jb.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;J3(l.current,2,null,l,null,null),Lf(),d[Ba]=null}};function sm(l){this._internalRoot=l}sm.prototype.unstable_scheduleHydration=function(l){if(l){var d=et();l={blockedOn:null,target:l,priority:d};for(var m=0;m<vi.length&&d!==0&&d<vi[m].priority;m++);vi.splice(m,0,l),m===0&&a4(l)}};var i4=e.version;if(i4!=="19.1.0")throw Error(n(527,i4,"19.1.0"));G.findDOMNode=function(l){var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=u(d),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var N6={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nm.isDisabled&&nm.supportsFiber)try{at=nm.inject(N6),pt=nm}catch(l){}}return Jd.createRoot=function(l,d){if(!a(l))throw Error(n(299));var m=!1,x="",S=SS,k=CS,L=jS,W=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(S=d.onUncaughtError),d.onCaughtError!==void 0&&(k=d.onCaughtError),d.onRecoverableError!==void 0&&(L=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(W=d.unstable_transitionCallbacks)),d=Z3(l,1,!1,null,null,m,x,S,k,L,W,null),l[Ba]=d.current,_b(l),new Jb(d)},Jd.hydrateRoot=function(l,d,m){if(!a(l))throw Error(n(299));var x=!1,S="",k=SS,L=CS,W=jS,te=null,Ne=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(S=m.identifierPrefix),m.onUncaughtError!==void 0&&(k=m.onUncaughtError),m.onCaughtError!==void 0&&(L=m.onCaughtError),m.onRecoverableError!==void 0&&(W=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(te=m.unstable_transitionCallbacks),m.formState!==void 0&&(Ne=m.formState)),d=Z3(l,1,!0,d,m!=null?m:null,x,S,k,L,W,te,Ne),d.context=Q3(null),m=d.current,x=Da(),x=_r(x),S=ni(x),S.callback=null,ai(m,S,x),m=x,d.current.lanes=m,on(d,m),Ur(d),l[Ba]=d.current,_b(l),new sm(d)},Jd.version="19.1.0",Jd}var m4;function V6(){if(m4)return t1.exports;m4=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),t1.exports=B6(),t1.exports}var U6=V6();const G6="/assets/home_main-DRHPcj5p.webp",W6="/assets/1-DPRo4wFK.webp",H6="/assets/01-BbHcUcs_.webp",q6="/assets/3-KJkxwrpE.webp",K6="/assets/4-C2gApwXz.webp",X6="/assets/rt-g7O3rNtP.webp",Y6="/assets/1-BZ5CiQTk.webp",Z6="/assets/2-DHaWy7VR.webp",Q6="/assets/3-sGUhpjh7.webp",J6="/assets/4-B_Ks_Ass.webp",e5="/assets/5-Zwpwl2zO.webp",t5="/assets/6-CpCwxMKU.webp",s5="/assets/1-BtDeZQgS.webp",g4="/assets/2-fVtxl_Xa.webp",n5="/assets/3-B-tCmESF.webp",a5="/assets/4-DsXMmwIY.webp",r5="/assets/5-CAmuOKu0.webp",o5="/assets/6-D4WIwbRx.webp",i5="/assets/7-Copt7q84.webp",l5="/assets/8-qe6FMvW6.webp",c5="/assets/9-CLDY04tP.webp",u5="/assets/1-BFB0Wtqm.webp",d5="/assets/2-BbOEF5Ga.webp",h5="/assets/3-CtIKDcst.webp",p5="/assets/4-DSRfeNda.webp",f5="/assets/5-DsqII3x1.webp",m5="/assets/6-BooEANJA.webp",g5="/assets/7-DzV2O-VW.webp",x5="/assets/8-eZFu9_Tx.webp",b5="/assets/9-Bw6rQKm4.webp",y5="/assets/10-DqLecErO.webp",v5="/assets/11-DUoj5H9T.webp",w5="/assets/12-SVTMo18I.webp",N5="/assets/13-eCfY0g4f.webp",lg="/assets/totalsolutions-DyWg9idw.webp",S5=[{image:s5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Bowenpally",phone:"+91 88865 78697  ",color:"bg-cyan-500",imageAlt:"Total Solution Rehabilitation Society Bowenpally"},{image:g4,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Barkatpura",phone:"+91 88864 78697 ",color:"bg-red-500",imageAlt:"Total Solution Rehabilitation Society Barkatpura"},{image:n5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Kukatpally",phone:"+91 90632 08697 ",color:"bg-lime-500",imageAlt:"Total Solution Rehabilitation Society Kukatpally"},{image:a5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Suchitra",phone:"+91 99594 18697 ",color:"bg-yellow-400",imageAlt:"Total Solution Rehabilitation Society Suchitra"},{image:r5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Banjara Hills",phone:"+91 87905 88697",color:"bg-fuchsia-500",imageAlt:"Total Solution Rehabilitation Society Banjara Hills"},{image:o5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Manikonda",phone:"+91 89786 88697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Manikonda"},{image:i5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Nacharam",phone:"+91 90003 28697 ",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Nacharam"},{image:l5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Neredmet",phone:"+91 90003 48697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Neredmet"},{image:c5,name:"TOTAL SOLUTION REHABILITATION SOCIETY",location:"Champapet",phone:"+91 99493 08697",color:"bg-orange-400",imageAlt:"Total Solution Rehabilitation Society Champapet"},{image:g4,name:"SPECIAL EDUCATION CENTER",location:"Barkatpura",phone:"+91 70754 88697",color:"bg-orange-400",imageAlt:"Total Solution Special Education Center Barkatpura"}],C5=[{name:"Assessment & Evaluation",image:Y6,path:"/services/assessment-evaluation"},{name:"Occupational Therapy",image:Z6,path:"/services/occupational-therapy"},{name:"Behaviour Therapy",image:Q6,path:"/services/behaviour-therapy"},{name:"Remedial Therapy",image:J6,path:"/services/remedial-therapy"},{name:"Behaviour Modification",image:e5,path:"/services/behaviour-modification"},{name:"Speech Therapy",image:t5,path:"/services/speech-therapy"}],a1=[{src:G6,alt:"Total Solution Rehabilitation Center - Image 1"},{src:W6,alt:"Total Solution Rehabilitation Center - Image 2"},{src:H6,alt:"Total Solution Rehabilitation Center - Image 3"},{src:q6,alt:"Total Solution Rehabilitation Center - Image 4"},{src:K6,alt:"Total Solution Rehabilitation Center - Image 5"},{src:X6,alt:"Total Solution Rehabilitation Center - Image 6"}],r1=[u5,d5,h5,p5,f5,m5,g5,x5,b5,y5,v5,w5,N5];function j5(){var h;const s=F.useRef(null),[e,t]=F.useState(0),[n,a]=F.useState(0),o=3,i=p=>{const f=a1.length;let g=p==="next"?(e+1)%f:(e-1+f)%f;t(g),s.current&&(s.current.style.transform="translateX(-".concat(g*100,"%)"))},c=()=>{n<r1.length-o&&a(n+1)},u=()=>{n>0&&a(n-1)};return r.jsxs("div",{children:[r.jsxs(Dy,{children:[r.jsx("title",{children:"Total Solution for Learning | Rehabilitation, Therapy & Support"}),r.jsx("meta",{name:"description",content:"Total Solution for Learning provides comprehensive rehabilitation services and learning support for children with autism, ADHD, learning difficulties & developmental disorders in Hyderabad."}),r.jsx("meta",{name:"keywords",content:"total solution, total solution for learning, total solution rehabilitation society, totalsolution4learning, development disorders, emotional difficulties, rehabilitation center Hyderabad, autism therapy, ADHD treatment, learning difficulties, special education, speech therapy, occupational therapy"}),r.jsx("meta",{name:"author",content:"Total Solution"}),r.jsx("meta",{property:"og:title",content:"Total Solution Rehabilitation society"}),r.jsx("meta",{property:"og:description",content:"Helping children with learning and developmental difficulties through expert therapy and professional care."}),r.jsx("meta",{property:"og:image",content:lg,alt:"Total Solution for Learning"}),r.jsx("meta",{property:"og:url",content:"https://totalsolutionforlearning.org"}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org"}),r.jsx("link",{rel:"preload",as:"image",fetchPriority:"high",href:(h=a1[0])==null?void 0:h.src,type:"image/webp"}),r.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"MedicalClinic",name:"Total Solution for Learning",url:"https://totalsolutionforlearning.org",description:"Total Solution for Learning is a leading therapy and rehabilitation center in Hyderabad, specializing in autism, ADHD, dyslexia, and other developmental disorders.",address:{"@type":"PostalAddress",addressLocality:"Hyderabad",addressCountry:"IN"},medicalSpecialty:["AssessmentEvaluation","BehaviourModification","BehaviourTherapy","SpeechTherapy","OccupationalTherapy","RemedialTherapy"]})}}),r.jsx("meta",{name:"robots",content:"index, follow"})]}),r.jsxs("div",{className:"relative w-full  overflow-hidden mx-auto",children:[r.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",ref:s,children:a1.map((p,f)=>r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.src,type:"image/webp"}),r.jsx("img",{src:p.src,alt:p.alt,width:1200,height:800,loading:f===0?"eager":"lazy",fetchPriority:f===0?"high":"auto",decoding:"async",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})]})},f))}),r.jsxs("div",{className:"absolute top-1/2 left-0 right-0 flex justify-between transform -translate-y-1/2 px-6",children:[r.jsx("button",{onClick:()=>i("prev"),className:"bg-white/80 hover:bg-white text-black font-semibold py-2 px-4 rounded-full shadow",children:"Previous"}),r.jsx("button",{onClick:()=>i("next"),className:"bg-white/80 hover:bg-white text-black font-semibold py-2 px-4 rounded-full shadow",children:"Next"})]})]}),r.jsx("div",{className:"py-10 bg-white",children:r.jsx("div",{className:"container mx-auto px-4",children:r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6 px-4",children:C5.map((p,f)=>r.jsxs("div",{className:"relative w-full aspect-square max-w-[180px] mx-auto",children:[r.jsx(ot,{to:p.path,className:"absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-300 hover:opacity-100 z-10 bg-[#ab1c1c] rounded-full",children:r.jsx("span",{className:"text-white text-sm md:text-base font-semibold text-center px-2",children:p.name})}),r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.image,type:"image/webp"}),r.jsx("img",{src:p.image,alt:"".concat(p.name," therapy"),width:180,height:180,loading:"lazy",decoding:"async",className:"relative w-full h-full flex items-center justify-center bg-[#ab1c1c] rounded-full transition-opacity duration-300 hover:opacity-0"})]})]},f))})})}),r.jsxs("section",{className:"bg-white px-4 md:px-16 py-12 text-gray-800",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-center text-blue-900",children:"Welcome to Total Solution Rehabilitation Society"}),r.jsx("div",{className:"w-24 h-1 bg-red-600 mx-auto mt-2 mb-8"}),r.jsx("p",{className:"max-w-6xl mx-auto text-lg text-justify",children:"We are a provider of rehabilitation services for children with Developmental Disorders, Learning Difficulties and Emotional Difficulties. With over 15 years of experience in providing a flexible and varied range of services, including life skills training, packages for out of station clients, home based programs, and school based rehabilitation. The people we support may have a range of needs that require intensive support, including:"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 mt-6 max-w-6xl mx-auto",children:["Autism Spectrum Disorder (ASD).","Sensory processing difficulties.","Epilepsy.","Learning Disorders (SLD).","Attention Deficit Disorder (ADD).","Attention Deficit Hyperactive Disorder (ADHD).","Children with Behavioural challenges and emotional difficulties.","School Rejection","Phobia"].map((p,f)=>r.jsxs("div",{className:"flex items-start space-x-2",children:[r.jsx("span",{className:"text-blue-600",children:""}),r.jsx("p",{children:p})]},f))}),r.jsxs("div",{className:"max-w-6xl mx-auto mt-8 space-y-6 text-lg text-justify",children:[r.jsx("p",{children:"We have succeeded in supporting children to live independently with their own assured tenancies when previously they were in secure accommodation. We aim to support each individual to integrate fully into their local community and live the life of their choice. This is based on a culture of person centered planning and, where appropriate, the use of assistive technology to help people become more independent."}),r.jsx("p",{children:"Total solution Rehabilitation Society has policies in place to ensure all children have equal opportunity to achieve their educational goals. The primary aim of Total solution Rehabilitation Society is to provide confidential support for children identified with Learning Difficulties in, Attention Deficit Hyperactivity Disorder (ADHD) or Autism Spectrum Disorder (ASD), in order to facilitate their academic, personal and career goals."}),r.jsx("p",{children:"Special Education Centre (SEC) is an initiative by Total Solution Rehabilitation Society (TSRS) for rehabilitation of children with special needs in 2018. It was started at Barkatpura as a need to give special education services to children who were not able to gain admission or adjust in a regular school. As on day, the SEC has 25 children with autism spectrum disorder, cerebral palsy, cognitive impairment, downs syndrome, visual impairment and multiple disabilitiestoo."})]})]}),r.jsxs("section",{className:"bg-gray-200 py-12 px-4 text-center",children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-blue-900",children:"Our Branches and Services"}),r.jsx("div",{className:"w-20 h-1 bg-red-600 mx-auto my-2"}),r.jsx("div",{className:"max-w-6xl mx-auto px-4 mt-10",children:r.jsx("div",{className:" grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-10",children:S5.map((p,f)=>r.jsxs("div",{className:"rounded shadow-lg overflow-hidden bg-white",children:[r.jsx("div",{className:"".concat(p.color," p-1"),children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.image,type:"image/webp"}),r.jsx("img",{src:p.image,alt:"".concat(p.name," location in ").concat(p.location),width:400,height:300,loading:"lazy",decoding:"async",className:"w-full h-full object-cover"})]})}),r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:p.name}),r.jsx("p",{className:"text-gray-600 mb-2 text-xl",children:p.location}),r.jsxs("p",{className:"text-red-700 text-sm font-medium",children:["Contact Number : ",p.contact]}),r.jsx("p",{className:"text-gray-800 font-semibold",children:p.phone})]})]},f))})})]}),r.jsxs("section",{className:"bg-white py-10",children:[r.jsx("h2",{className:"text-2xl font-bold text-center text-blue-900",children:"Treatment"}),r.jsx("div",{className:"w-20 h-1 bg-red-600 mx-auto my-2"}),r.jsxs("div",{className:"relative max-w-6xl mx-auto px-4",children:[r.jsx("div",{className:"overflow-hidden",children:r.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:"translateX(-".concat(n*(100/o),"%)")},children:r1.map((p,f)=>r.jsxs("picture",{children:[r.jsx("source",{srcSet:p,type:"image/webp"}),r.jsx("img",{src:p,alt:"Treatment method ".concat(f+1),width:400,height:300,loading:"lazy",decoding:"async",className:"w-full sm:w-1/2 md:w-1/3 flex-shrink-0 object-cover p-2"})]},f))})}),r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2",children:r.jsx("button",{onClick:u,className:"bg-white border rounded-full p-2 shadow hover:bg-gray-100",disabled:n===0,children:""})}),r.jsx("div",{className:"absolute top-1/2 right-0 transform -translate-y-1/2",children:r.jsx("button",{onClick:c,className:"bg-white border rounded-full p-2 shadow hover:bg-gray-100",disabled:n>=r1.length-o,children:""})})]})]})]})}function k5(s){return qn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"},child:[]}]})(s)}function T5(s){return qn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(s)}function I5(s){return qn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(s)}function $5(s){return qn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"},child:[]}]})(s)}function A5(s){return qn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(s)}function x4(s){return qn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M576 240c0-23.63-12.95-44.04-32-55.12V32.01C544 23.26 537.02 0 512 0c-7.12 0-14.19 2.38-19.98 7.02l-85.03 68.03C364.28 109.19 310.66 128 256 128H64c-35.35 0-64 28.65-64 64v96c0 35.35 28.65 64 64 64h33.7c-1.39 10.48-2.18 21.14-2.18 32 0 39.77 9.26 77.35 25.56 110.94 5.19 10.69 16.52 17.06 28.4 17.06h74.28c26.05 0 41.69-29.84 25.9-50.56-16.4-21.52-26.15-48.36-26.15-77.44 0-11.11 1.62-21.79 4.41-32H256c54.66 0 108.28 18.81 150.98 52.95l85.03 68.03a32.023 32.023 0 0 0 19.98 7.02c24.92 0 32-22.78 32-32V295.13C563.05 284.04 576 263.63 576 240zm-96 141.42l-33.05-26.44C392.95 311.78 325.12 288 256 288v-96c69.12 0 136.95-23.78 190.95-66.98L480 98.58v282.84z"},child:[]}]})(s)}function b4(s){return qn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(s)}function o1(s){return qn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(s)}function i1(s){return qn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(s)}function $j(s){return qn({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(s)}function E5(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(s)}function D5(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(s)}function R5(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(s)}function O5(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(s)}function Aj(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(s)}function _5(s){return qn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(s)}function F5({isOpen:s,onClose:e}){const t=xs();if(!s)return null;const n=a=>{a.target===a.currentTarget&&e(),a.target.name==="register"?t("/register"):a.target.name==="login"&&t("/login")};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto p-8",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsx("button",{to:"/register",name:"register",className:"bg-red-700 hover:bg-red-800 text-white font-medium py-2 px-6 rounded-full transition-colors duration-300 shadow-md",onClick:n,children:"Register"}),r.jsx("button",{to:"/login",name:"login",className:"bg-red-700 hover:bg-red-800 text-white font-medium py-2 px-6 rounded-full transition-colors duration-300 shadow-md",onClick:n,children:"Login"}),r.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx($j,{className:"text-2xl"})})]}),r.jsxs("div",{className:"p-2 mb-3",children:[r.jsx("h1",{className:"text-red-600 text-3xl font-bold text-center mb-5",children:"Make an Appointment"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Bowenpally",phone:"+91 88865 78697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Barkatpura",phone:"+91 88864 78697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Kukatpally",phone:"+91 90632 08697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Suchitra",phone:"+91 99594 18697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Banjara Hills",phone:"+91 87905 88697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Manikonda",phone:"+91 89786 88697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Nacharam",phone:"+91 90003 28697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Neredmet",phone:"+91 90003 48697"}),r.jsx(Gr,{name:"Total Solution Rehabilitation Society",location:"Champapet",phone:"+91 99493 08697"}),r.jsx(Gr,{name:"Special Education Center",location:"Barkatpura",phone:"+91 70754 88697"})]})]})]})})}function Gr({name:s,location:e,phone:t}){return r.jsxs("div",{className:"border border-red-800 rounded p-4 h-full flex flex-col",children:[r.jsxs("h2",{className:"text-xl font-medium text-center flex-grow",children:[s,",",r.jsx("br",{}),e]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("a",{href:"tel:".concat(t),className:"border border-red-600 text-red-600 rounded-full px-6 py-2 inline-block hover:bg-red-50 transition-colors",children:t})})]})}const L5={user:null,isAuthenticated:!1},Ej=Sj({name:"auth",initialState:L5,reducers:{login:(s,e)=>{s.user=e.payload,s.isAuthenticated=!0},logout:s=>{s.user=null,s.isAuthenticated=!1},addPropery:(s,e)=>{s.user.details[e.payload.key]=e.payload.value}}}),{login:Dj,logout:Oy,addPropery:M5}=Ej.actions,P5=Ej.reducer;function z5({menuRef:s}){var h;const e=Th(),t=xs(),n=Ml(p=>p.auth.user),a=(h=n==null?void 0:n.details)==null?void 0:h.name,[o,i]=F.useState(!1),c=F.useRef(null);F.useEffect(()=>{function p(f){(s!=null&&s.current&&!s.current.contains(f.target)||c.current&&!c.current.contains(f.target))&&i(!1)}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[s]);const u=()=>{const p=sessionStorage.getItem("role");sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem("".concat(p,"Id")),e(Oy()),t("/login"),i(!1)};return r.jsxs("div",{className:"relative",ref:c,children:[r.jsxs("button",{onClick:()=>i(!o),className:"flex items-center space-x-2 py-2 border-b-2 border-transparent hover:border-[#ab1c1c] focus:border-[#ab1c1c] cursor-pointer","aria-label":"User profile",children:[r.jsx(Aj,{className:"text-[#ab1c1c] text-2xl"}),r.jsx("span",{className:"text-[#ab1c1c] text-base lg:text-lg",children:a||"User"})]}),o&&r.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-black/90 text-white rounded-lg shadow-lg z-50",children:r.jsxs("ul",{className:"py-2",children:[r.jsx("li",{children:r.jsx(ot,{to:"/profile",className:"block px-4 py-2 hover:bg-red-900 transition-colors",onClick:()=>i(!1),children:"Profile"})}),r.jsx("li",{children:r.jsx("button",{onClick:u,className:"block w-full text-left px-4 py-2 hover:bg-red-900 transition-colors",children:"Logout"})})]})})]})}function y4({setIsMenuOpen:s}){return r.jsxs(r.Fragment,{children:[r.jsxs("ul",{className:"items-stretch hidden font-bold  space-x-3 lg:flex",children:[r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Dashboard"})}),r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard/register",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Register"})}),r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard/existingusers",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Import"})}),r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard/viewappointment",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"View Appointments"})}),r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard/manageappointment",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"Manage Appointments"})}),r.jsx("li",{className:"flex",children:r.jsx(ot,{to:"/admindashboard/jwlenquiries",className:"flex items-center px-4 border-b-2 border-transparent hover:border-red-600 focus:border-red-600 focus:font-bold transition-colors duration-200",children:"JWL Enquiries"})})]}),r.jsxs("ul",{className:"lg:hidden w-full divide-y divide-gray-200",children:[r.jsx("li",{children:r.jsx(ot,{to:"/admindashboard/register",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Register"})}),r.jsx("li",{children:r.jsx(ot,{to:"/admindashboard/existingusers",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Import"})}),r.jsx("li",{children:r.jsx(ot,{to:"/admindashboard/viewappointment",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"View Appointments"})}),r.jsx("li",{children:r.jsx(ot,{to:"/admindashboard/manageappointment",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"Manage Appointments"})}),r.jsx("li",{children:r.jsx(ot,{to:"/admindashboard/jwlenquiries",className:"block py-3 text-lg font-semibold text-[#ab1c1c] hover:bg-red-50 transition-colors duration-200 ",onClick:()=>s(!1),children:"JWL Enquiries"})})]})]})}function v4({isMobileMenuOpen:s}){const e=Ml(n=>n.auth.isAuthenticated),t=sessionStorage.getItem("role");return r.jsx("div",{children:e&&t==="No-service-role"&&r.jsxs("div",{className:"container lg:mx-auto lg:mt-1 lg:p-2",children:[r.jsx("div",{className:"hidden lg:flex justify-between ",children:t==="admin"&&r.jsx(y4,{})}),s&&r.jsx("div",{className:"lg:hidden ",children:t==="admin"&&r.jsx(y4,{})})]})})}const B5=({userRole:s})=>{const[e,t]=F.useState([]),n=xs(),a=o=>{o&&(o.startsWith("http://")||o.startsWith("https://")?window.open(o,"_blank","noopener,noreferrer"):n(o))};return F.useEffect(()=>{(async()=>{var i,c;try{const u=sessionStorage.getItem("token"),h=u?{Authorization:"".concat(u)}:{},p=await Pe.get("/api/superadmin/announcements",{headers:h}),f=Array.isArray(p.data)?p.data:Array.isArray(p.data.data)?p.data.data:[];if(!Array.isArray(f)){console.error("Announcements response is not an array:",p.data),t([]);return}const g=new Date,b=f.filter(y=>{var N;if(!y.displayInScroller)return!1;const w=new Date(y.createdAt);return(g-w)/(1e3*60*60)>24?!1:s==="superadmin"||s==="public"&&y.targetType==="public"||y.targetType==="all"||!y.targetType?!0:y.targetType==="specific"&&s&&s!=="public"?(N=y.targetRoles)==null?void 0:N.includes(s):!1});t(b)}catch(u){console.error("Error fetching announcements:",u),(((i=u.response)==null?void 0:i.status)===401||((c=u.response)==null?void 0:c.status)===403)&&console.log("No authentication token for public user - this is expected"),t([])}})()},[s]),e.length===0?null:r.jsxs("div",{className:"bg-[#fde8e8] text-[#ab1c1c] py-2 overflow-hidden shadow-sm border-b border-[#fca5a5]",children:[r.jsx("div",{className:"animate-marquee whitespace-nowrap",children:e.map((o,i)=>o.link?r.jsxs("span",{className:"mx-10 font-medium cursor-pointer hover:underline hover:text-[#8b1515] transition-colors",onClick:()=>a(o.link),title:"Click to visit: ".concat(o.link),children:[" ",o.message]},o._id||i):r.jsxs("span",{className:"mx-10 font-medium",children:[" ",o.message]},o._id||i))}),r.jsx("style",{children:"\n        @keyframes marquee {\n          0% { transform: translateX(100%); }\n          100% { transform: translateX(-100%); }\n        }\n        .animate-marquee {\n          display: inline-block;\n          animation: marquee 25s linear infinite;\n        }\n      "})]})};function V5(){var I;const[s,e]=F.useState(!1),[t,n]=F.useState(null),[a,o]=F.useState(!1),i=F.useRef(null),c=F.useRef(null),u=F.useRef(null),h=Ml($=>$.auth.isAuthenticated),p=sessionStorage.getItem("role"),f=Ml($=>$.auth.user),g=(I=f==null?void 0:f.details)==null?void 0:I.name,b=[{label:"Who we are?",path:"/aboutus/whoarewe"},{label:"Why Us?",path:"/aboutus/whyus"},{label:"Founder Messages",path:"/aboutus/foundermessages"},{label:"Goals of Total Solution",path:"/aboutus/goals"},{label:"Research Department",path:"/aboutus/research"}],y=[{label:"Assessment & Evaluation",path:"/services/assessment-evaluation"},{label:"Occupational Therapy",path:"/services/occupational-therapy"},{label:"Behaviour Therapy",path:"/services/behaviour-therapy"},{label:"Remedial Therapy",path:"/services/remedial-therapy"},{label:"Behaviour Modification",path:"/services/behaviour-modification"},{label:"Speech Therapy",path:"/services/speech-therapy"}],w=[{label:"Photo Gallery",path:"/media/photos"},{label:"Video Gallery",path:"/media/videos"}],v=F.useCallback($=>{n(R=>R===$?null:$)},[]),N=F.useCallback($=>{clearTimeout(i.current),n($)},[]),C=F.useCallback(()=>{i.current=setTimeout(()=>{n(null)},300)},[]);F.useEffect(()=>{const $=R=>{var O,P;!((O=c.current)!=null&&O.contains(R.target))&&!((P=u.current)!=null&&P.contains(R.target))&&e(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[]),F.useEffect(()=>{const $=()=>{window.innerWidth>=768&&(e(!1),n(null))};return window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]),F.useEffect(()=>()=>clearTimeout(i.current),[]);const T=()=>{const $=sessionStorage.getItem("role");sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem("".concat($,"Id")),e(!1)};return r.jsxs(r.Fragment,{children:[r.jsxs("nav",{className:"w-full shadow-md bg-white px-4 sm:px-6 py-3 flex items-center justify-between relative z-50",children:[r.jsxs("div",{className:"flex items-center justify-between w-full md:w-auto",children:[r.jsx(ot,{to:"/",className:"flex items-center gap-3",children:r.jsx("img",{src:lg,alt:"Total Solution Logo",width:"200",height:"50",className:"h-10 md:h-12 w-auto"})}),r.jsx("button",{ref:u,className:"md:hidden text-[#ab1c1c] text-2xl",onClick:()=>e(!s),"aria-label":s?"Close menu":"Open menu",children:s?r.jsx($j,{}):r.jsx(A5,{})})]}),h?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden md:flex gap-4 items-center",children:[r.jsxs(ot,{to:"/announcements",className:"group relative flex items-center justify-center w-10 h-10 rounded-full bg-[#ab1c1c] hover:bg-[#8d1717] transition-all duration-300 shadow-md",children:[r.jsx(x4,{className:"text-white text-xl"}),r.jsx("span",{className:"absolute top-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded-md px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 mt-2",children:"Announcements"})]}),r.jsxs(ot,{to:p==="superadmin"?"/superadmin/dashboard":"/".concat(p,"dashboard"),className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:[p.charAt(0).toUpperCase()+p.substring(1)," Dashboard"]}),r.jsx(ot,{to:"/calendar",className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",children:"Calendar"}),p==="therapist"&&r.jsx(r.Fragment,{children:r.jsx(ot,{to:"/codeofconduct",className:"text-base lg:text-lg font-medium text-[#ab1c1c] border-b-2 py-2 border-transparent hover:border-[#ab1c1c] transition-colors",children:"Code of Conduct"})}),r.jsx(z5,{menuRef:c})]}),s&&r.jsxs("div",{ref:c,className:"md:hidden absolute top-full left-0 right-0 bg-white shadow-lg z-50 px-4 py-2 animate-fadeIn max-h-[calc(100vh-80px)] overflow-y-auto",children:[r.jsxs(ot,{to:p==="superadmin"?"/superadmin/dashboard":"/".concat(p,"dashboard"),className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:[p.charAt(0).toUpperCase()+p.substring(1)," Dashboard"]}),r.jsx(ot,{to:"/calendar",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Calendar"}),p==="therapist"&&r.jsx(r.Fragment,{children:r.jsx(ot,{to:"/code-of-conduct",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Code of Conduct"})}),r.jsxs(ot,{to:"/announcements",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:[r.jsx(x4,{className:"inline mr-2"}),"Announcements"]}),r.jsx(v4,{isMobileMenuOpen:s,setIsMenuOpen:e}),r.jsxs("div",{className:"border-b py-3 flex items-center gap-2",children:[r.jsx(Aj,{className:"text-[#ab1c1c] text-xl"}),r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:g||"User"})]}),r.jsx(ot,{to:"/profile",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Profile"}),r.jsx(ot,{to:"/login",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:T,children:"Logout"})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"hidden md:flex gap-4 lg:gap-6 items-center relative",children:[r.jsx(ot,{to:"/",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Home"}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("about"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="about"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"About Us"}),r.jsx("div",{className:"absolute ".concat(t==="about"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:b.map(($,R)=>r.jsx(ot,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},R))})]}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("services"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="services"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"Services"}),r.jsx("div",{className:"absolute ".concat(t==="services"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:y.map(($,R)=>r.jsx(ot,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},R))})]}),r.jsx(ot,{to:"/training",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Training"}),r.jsx(ot,{to:"/ourbranches",className:"text-base lg:text-lg font-medium text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c] px-2 py-1 rounded transition-colors",children:"Our Branches"}),r.jsxs("div",{className:"relative",onMouseEnter:()=>N("media"),onMouseLeave:C,children:[r.jsx("button",{className:"text-base lg:text-lg font-medium transition-colors px-2 py-1 rounded ".concat(t==="media"?"text-white bg-[#ab1c1c]":"text-[#ab1c1c] hover:text-white hover:bg-[#ab1c1c]"),children:"Media"}),r.jsx("div",{className:"absolute ".concat(t==="media"?"block":"hidden"," bg-white mt-2 rounded shadow-lg w-48 z-10 border border-gray-200"),children:w.map(($,R)=>r.jsx(ot,{to:$.path,className:"block px-4 py-2 text-[#ab1c1c] hover:bg-red-50 border-b last:border-none transition-colors",children:$.label},R))})]}),r.jsxs("div",{className:"group flex items-center gap-2 hover:bg-[#ab1c1c] rounded transition-colors px-2 py-1",children:[r.jsx(ot,{to:"/contact",className:"text-base lg:text-lg font-medium text-[#ab1c1c] group-hover:text-white",children:"Contact Us"}),r.jsx(b4,{className:"text-[#ab1c1c] text-xl group-hover:text-white"})]}),r.jsx("button",{className:"border border-[#ab1c1c] text-[#ab1c1c] font-semibold px-3 lg:px-4 py-1 rounded-full hover:bg-[#ab1c1c] hover:text-white transition-all text-sm lg:text-base",onClick:()=>o(!0),children:"Appointment"})]}),s&&r.jsxs("div",{ref:c,className:"md:hidden absolute top-full left-0 right-0 bg-white shadow-lg z-50 px-4 py-2 animate-fadeIn max-h-[calc(100vh-80px)] overflow-y-auto",children:[r.jsx(ot,{to:"/",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Home"}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>v("about"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"About Us"}),t==="about"?r.jsx(o1,{}):r.jsx(i1,{})]}),t==="about"&&r.jsx("div",{className:"pb-2 pl-4",children:b.map(($,R)=>r.jsx(ot,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},R))})]}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>v("services"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"Services"}),t==="services"?r.jsx(o1,{}):r.jsx(i1,{})]}),t==="services"&&r.jsx("div",{className:"pb-2 pl-4",children:y.map(($,R)=>r.jsx(ot,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},R))})]}),r.jsx(ot,{to:"/training",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Training"}),r.jsx(ot,{to:"/ourbranches",className:"block py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:"Our Branches"}),r.jsxs("div",{className:"border-b",children:[r.jsxs("div",{className:"flex justify-between items-center py-3 cursor-pointer",onClick:()=>v("media"),children:[r.jsx("span",{className:"text-lg font-medium text-[#ab1c1c]",children:"Media"}),t==="media"?r.jsx(o1,{}):r.jsx(i1,{})]}),t==="media"&&r.jsx("div",{className:"pb-2 pl-4",children:w.map(($,R)=>r.jsx(ot,{to:$.path,className:"block py-2 text-gray-700 hover:text-[#ab1c1c] transition-colors",onClick:()=>e(!1),children:$.label},R))})]}),r.jsxs(ot,{to:"/contact",className:"flex items-center gap-2 py-3 text-lg font-medium text-[#ab1c1c] border-b",onClick:()=>e(!1),children:["Contact Us"," ",r.jsx(b4,{className:"text-[#ab1c1c] text-xl"})]}),r.jsx("button",{className:"w-full border border-[#ab1c1c] text-[#ab1c1c] font-semibold px-4 py-2 rounded-full my-3 hover:bg-[#ab1c1c] hover:text-white transition-colors",onClick:()=>{o(!0),e(!1)},children:"Appointment"})]})]}),r.jsx(F5,{isOpen:a,onClose:()=>o(!1)})]}),r.jsx(B5,{userRole:h?p:"public"}),h&&r.jsx("div",{className:"z-40 bg-red-100 shadow-sm border-b-2 border-red-800",children:r.jsx(v4,{isMobileMenuOpen:s,setIsMenuOpen:e})})]})}const U5=[{label:"Who we are?",path:"/aboutus/whoarewe"},{label:"Why Us",path:"/whyus"},{label:"FAQ",path:"/faq"},{label:"Founder Messages",path:"/aboutus/foundermessages"},{label:"Our Goals",path:"/goals"},{label:"Research Department",path:"/research"},{label:"Terms & Conditions",path:"/terms-and-conditions"}],G5=[{label:"Services",path:"/services"},{label:"Assessment & Evaluation",path:"/services/assessment-evaluation"},{label:"Occupational Therapy",path:"/services/occupational-therapy"},{label:"Behaviour Therapy",path:"/services/behaviour-therapy"},{label:"Remedial Therapy",path:"/services/remedial-therapy"},{label:"Behaviour Modification",path:"/services/behaviour-modification"},{label:"Speech Therapy",path:"/services/speech-therapy"}],W5=[{label:"Facebook",path:"https://www.facebook.com/TotalSolution4Learning",icon:r.jsx(k5,{})},{label:"Instagram",path:"https://www.instagram.com/totalsolutionrehabsociety/",icon:r.jsx(T5,{})},{label:"YouTube",path:"https://www.youtube.com/@Totalsolutionrehabsociety",icon:r.jsx($5,{})},{label:"WhatsApp",path:"https://wa.me/918886008697",icon:r.jsx(I5,{})}];function H5(){return r.jsxs("footer",{className:"bg-[#1c0c0c] text-white pt-10 pb-4",children:[r.jsxs("div",{className:"max-w-7xl mx-auto px-2 grid md:grid-cols-4 gap-8 text-sm",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Contact Details"}),r.jsxs("p",{className:"mb-2",children:[" ",r.jsxs("a",{href:"https://maps.app.goo.gl/WFpmGMazooskNKZY8",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:underline",children:["3-4-495/B, 1st Floor, YMCA, Near More Supermarket,",r.jsx("br",{})," Barkatpura, Hyderabad - 500027"]})]}),r.jsx("p",{className:"mb-2",children:" +91 88860 08697"}),r.jsxs("p",{className:"mb-4",children:[" ",r.jsx("a",{href:"mailto:info@totalsolutionforlearning.com",className:"text-blue-400 hover:underline",children:"info@totalsolutionforlearning.com"})]}),r.jsxs(ot,{to:"/contact",className:"text-white hover:text-blue-400",children:[r.jsx("span",{className:"text-blue-400",children:" "}),"Contact Us"]}),r.jsx("div",{className:"flex flex-wrap gap-4 mt-4",children:W5.map((s,e)=>r.jsx("a",{href:s.path,"aria-label":s.label,className:"text-white hover:text-blue-400 text-lg",target:"_blank",rel:"noopener noreferrer",children:s.icon},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Quick Links  "}),r.jsx("ul",{className:"space-y-2",children:U5.map((s,e)=>r.jsxs("li",{className:"flex items-center gap-2 border-dotted border-b border-white/30 pb-1",children:[r.jsx("span",{className:"text-blue-400",children:""})," ",r.jsx(ot,{to:s.path,className:"hover:underline",children:s.label})]},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Useful Links"}),r.jsx("ul",{className:"space-y-2",children:G5.map((s,e)=>r.jsxs("li",{className:"flex items-center gap-2 border-dotted border-b border-white/30 pb-1",children:[r.jsx("span",{className:"text-blue-400",children:""})," ",r.jsx(ot,{to:s.path,className:"hover:underline",children:s.label})]},e))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-yellow-400 text-lg font-bold mb-4",children:"Careers"}),r.jsx("div",{className:"space-y-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"font-medium",children:"Send your resume to:"}),r.jsxs("a",{href:"mailto:humanresource@tsrs.in?subject=Career Opportunity - Resume Submission&body=Dear HR Team,%0D%0A%0D%0AI am interested in career opportunities at Total Solution Rehabilitation Society. Please find my resume attached.%0D%0A%0D%0AThank you for your consideration.%0D%0A%0D%0ABest regards,",className:"text-blue-400 hover:underline block",children:[r.jsx("span",{className:"text-blue-400",children:""})," humanresource@tsrs.in"]})]})})]})]}),r.jsx("div",{className:"text-center text-sm mt-10 border-t border-white/10 pt-4",children:r.jsxs("p",{children:["Copyright 2023 All rights reserved | Maintained by ",r.jsx("span",{className:"text-blue-400 hover:underline",children:"Total Solution Rehabilitation Society"})]})})]})}const Rj="/assets/who_we_are-CRmxMSkv.webp",q5="/assets/corevalues-Ko0ZIR04.webp",K5=()=>r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Rj,alt:"Who We Are",className:"object-cover w-full h-full"})}),r.jsxs("section",{className:"text-center py-12 px-4 md:px-16 bg-white",children:[r.jsx("h2",{className:"text-2xl font-semibold text-blue-900 mb-4",children:"Who we are?"}),r.jsx("p",{className:"text-gray-700 max-w-3xl mx-auto",children:"A team of passionate and dedicated professionals who aims at providing holistic rehabilitation to a developing child and strengthening the family in the same process."})]}),r.jsx("section",{className:"bg-gray-200 py-12 px-4 md:px-16",children:r.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-10",children:[r.jsxs("div",{className:"bg-white border border-red-400 shadow p-6 w-full md:w-1/2",children:[r.jsx("h3",{className:"text-center text-lg font-bold text-blue-900 mb-4",children:"Mission"}),r.jsx("p",{className:"text-sm text-gray-700",children:"Total Solution is an inclusive community of different professionals dedicated to innovations and excellence in rehabilitation services, research activities and training. Total solution supports all children with developmental difficulties and learning difficulties to achieve their maximum potential."})]}),r.jsxs("div",{className:"bg-white border border-red-400 shadow p-6 w-full md:w-1/2",children:[r.jsx("h3",{className:"text-center text-lg font-bold text-blue-900 mb-4",children:"Vision"}),r.jsx("p",{className:"text-sm text-gray-700",children:"Total Solution aspires to be one of the most distinguished learning centers with scientific research based rehabilitation services, excellent teaching and training institute aiming at a productive inclusive society."})]})]})}),r.jsx("section",{className:"bg-white py-12 px-4 md:px-16",children:r.jsx("div",{className:"text-center",children:r.jsx("img",{src:q5,alt:"Core Values",className:"mx-auto w-full max-w-4xl object-contain"})})})]}),X5="/assets/contactus1-Dt9z8oqx.webp",Y5=({title:s,location:e,address:t,phone:n})=>{const a="https://maps.google.com/?q=".concat(encodeURIComponent(t));return r.jsxs("div",{className:"border border-red-900 p-6 flex flex-col items-center text-center h-full",children:[r.jsx("h2",{className:"text-red-700 text-xl font-medium mb-4",children:s}),r.jsx("p",{className:"text-gray-800 mb-6 flex-grow",children:r.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-600 hover:underline",children:t})}),r.jsx("a",{href:"tel:".concat(n),className:"text-red-600 border border-red-600 rounded-full px-6 py-2 inline-block hover:bg-red-50",children:n})]})};function Z5(){const[s,e]=F.useState({name:"",phone:"",message:""}),t=[{title:"Total Solution Rehabilitation Society, Bowenpally",location:"Bowenpally",address:"Plot 9 SBI Colony, Manovikas Nagar, Old Bowenpally, Secunderabad 500009.",phone:"+91 88865 78697"},{title:"Total Solution Rehabilitation Society, Nacharam",location:"Nacharam",address:"7-38, Road no 1, Bapuji Nagar, Lane opposite to HDFC bank, Nacharam Road.",phone:"+91 90003 28697"},{title:"Total Solution Rehabilitation Society, Barkatpura",location:"Barkatpura",address:"3-4-495 / B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 27.",phone:"+91 88864 78697"},{title:"Total Solution Rehabilitation Society, Neredmet",location:"Neredmet",address:"Plot no - A-16 H. No 37-72/6 J.J.Nagar, behind Sunflower hospital Neredmet X road.",phone:"+91 9866 983 096"},{title:"Total Solution Rehabilitation Society, Kukatpally",location:"Kukatpally",address:"Srinivasan Apts, Flat no. 502, Addagutta Society,Pragathi Nagar Road, Beside Narayana Junior College, Oppo. Road to JNTU, Hyderabad 500029",phone:"+91 90632 08697"},{title:"Total Solution Rehabilitation Society, Champapet",location:"Champapet",address:"H. No. 17-01-382/B/25, Bhanu Nagar, Road no 2, Beside lane Focus Hospital, Champapet, Hyderabad 500079.",phone:"+91 99493 08697"},{title:"Total Solution Rehabilitation Society, Suchitra",location:"Suchitra",address:"Plot No. 105, Block 'A' , Survey no. 91,92,93 Jeedimetla Vill, Lane beside Chennai Shopping Mall, Suchitra, Hyderabad .",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society, Banjara Hills",location:"Banjara Hills",address:"8-2-629, Road no.1, Near Pension Office, Mithila Nagar, Banjara Hills, Hyderabad 500034.",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society, Manikonda",location:"Manikonda",address:"Ground Floor, Phani Plaza, Secretariat Colony, Puppalaguda, Rajendranagar, Hyderabad 500089.",phone:"+91 89786 88697"},{title:"Special Education Center, Barkatpura",location:"Barkatpura",address:"3-4-495/B, 1st Floor, Near More Super market, Barkatpura, Hyderabad 500027.",phone:"+91 70754 88697"}],n=[];for(let c=0;c<t.length;c+=3)n.push(t.slice(c,c+3));const a=c=>{const{name:u,value:h}=c.target;e(p=>({...p,[u]:h}))},o=c=>{c.preventDefault(),console.log("Form submitted:",s)},i="https://maps.google.com/?q="+encodeURIComponent("3-4-495/B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 500027");return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:X5,alt:"Contact Us",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsxs("section",{className:"py-6 dark:text-gray-900",children:[r.jsx("h1",{className:"hidden text-4xl font-bold text-gray-900 md:block text-center mb-10",children:"Contact Us"}),r.jsxs("div",{className:"grid max-w-6xl grid-cols-1 px-6 mx-auto lg:px-8 md:grid-cols-2 md:divide-x",children:[r.jsxs("div",{className:"py-6 md:py-0 md:px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Get in touch"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"flex items-center pt-5",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:r.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),r.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-600 hover:underline",children:"3-4-495/B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad - 500027"})]}),r.jsxs("p",{className:"flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:r.jsx("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})}),r.jsx("a",{href:"tel:+918886478697",className:"hover:text-red-600 hover:underline",children:"+91 88864 78697"})]}),r.jsxs("p",{className:"flex items-center",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6 text-red-600",children:[r.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),r.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),r.jsx("a",{href:"mailto:info@totalsolutionforlearning.com",className:"hover:text-red-600 hover:underline",children:"info@totalsolutionforlearning.com"})]})]})]}),r.jsx("div",{className:"flex flex-col py-6 space-y-6 md:py-0 md:px-6",children:r.jsxs("form",{onSubmit:o,children:[r.jsxs("div",{className:"relative mb-6",children:[r.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:a,placeholder:" ",className:"block w-full px-3 pt-5 pb-2 rounded-md shadow-sm bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer",required:!0}),r.jsx("label",{htmlFor:"name",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Full name"})]}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:a,placeholder:" ",className:"block w-full px-3 pt-5 pb-2 rounded-md shadow-sm bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer",required:!0}),r.jsx("label",{htmlFor:"phone",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Contact Number"})]}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("textarea",{id:"message",name:"message",value:s.message,onChange:a,placeholder:" ",rows:"3",className:"block w-full px-3 pt-5 pb-2 rounded-md bg-white border border-gray-300 appearance-none focus:outline-none focus:ring-1 focus:ring-red-600 peer resize-none",required:!0}),r.jsx("label",{htmlFor:"message",className:"absolute text-gray-500 duration-300 transform -translate-y-3 scale-75 top-4 z-10 origin-[0] left-3 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3",children:"Message"})]}),r.jsx("button",{type:"submit",className:"self-center px-8 py-3 text-lg rounded bg-red-600 text-white hover:bg-red-700 focus:ring focus:ring-opacity-75 focus:ring-red-600 transition-colors",children:"Submit"})]})})]})]}),r.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900 text-center mb-10",children:"Our Centers"}),n.map((c,u)=>r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:c.map((h,p)=>r.jsx("div",{className:"px-2",children:r.jsx(Y5,{title:h.title,location:h.location,address:h.address,phone:h.phone})},p))},u))]})]})}const Q5="/assets/whyus-BpbmKTT8.webp",J5="/assets/10-Db3uzpvB.webp",eO=[{color:"#fb190f",text:"An organization is led by certified Rehabilitation psychologists."},{color:"#e059ef",text:"Most of the staff is Rehabilitation Council of India (RCI) certified and trained from renowned institutes."},{color:"#ff9900",text:"Largest number of trained occupational therapists in twin cities."},{color:"#045a72",text:"One among three and largest service provider of Tomatis Talks up (listening program) in India with Tomatis talks-up and Forebrain equipment."},{color:"#607333",text:"Total solution also provides PASS Based Reading Enhancement Program (PREP). Cognitive Enhancement Training (COGENT), Math Module by Dr J. P Das, Instrumental Enrichment (A cognitive training program conceived by Professor Reuven Feuerstein), Oral Placement Therapy (level 1 and 2) and Audiblox."},{color:"#f34907",text:"Yearly continuing education programs (CEP) for the staff to update their knowledge."},{color:"#e059e5",text:"Self-contained training institute for Management of Specific Learning Disorders, ADHD, ADD, Slow Learning, learning problems, Autism Spectrum Disorder, pediatric anxiety disorders, school phobia, school refusal."},{color:"#ff9900",text:"Institutes which conduct meticulous baseline assessment program by visiting home, school as well as natural play area of the child, as per requirement."},{color:"#fb190f",text:"Intervention programs are planned in holistic manner by focusing upon, life skills, language processing skills, play behavior and then educational and learning needs."},{color:"#045a72",text:"Focuses upon multidisciplinary approach by involving occupational, behavior, and speech therapists and monitored by rehabilitation psychologist."},{color:"#607333",text:"CCTV monitoring of all ongoing therapies by the center heads of the institute."},{color:"#f34907",text:"Monthly review of goals as per individual therapy plan by the center heads."},{color:"#e059e5",text:"Quarterly review and meeting by multidisciplinary team along with parents and phone based review with school professionals."},{color:"#ff9900",text:"Direct training of parents by involving them in all therapy sessions and making them conduct a part of the session under professional supervision."},{color:"#FF0000",text:"30% clientele receives both discounted and free therapies based on their financial income."},{color:"#004E66",text:"Regular school visits to support teachers for better management of the client in school system."},{color:"#556B2F",text:"Intermittent shadow support to the client in school for better transfer of learning from center to school situation."},{color:"#FF4500",text:"More than 600 free workshops in last 10 years in for creating awareness among teachers and parents about learning difficulties among school going children. 280 workshops for parenting to strengthen them for managing behavioral difficulties among children."},{color:"#DA70D6",text:"Regular free programs for parents attending intervention programs at different branches of total solution, for creating better knowledge about conditions and interventions."},{color:"#FFA500",text:"Supporting more than 350 children in 8 centers across the city, through scientific research-based practices of Remedial therapy, Cognitive behavior therapy, Applied Behavior Therapy, Behavior modification therapy, occupational therapy, speech therapy."},{color:"#004E66",text:"All programs of Autism Spectrum Disorder are supervised by Board Certified Assistant Behavior Analyst (BCABA), Mrs. Sophia Pirani."},{color:"#556B2F",text:"Institute to provide best management for Social Communication Disorder by providing group and individual sessions on Theory of Mind, Social Stories, Teach Me Language Module."},{color:"#FF4500",text:"High Success rate of management of Learning Disorders, School refusal cases, behavior management of children with ADHD, ADD and development of social skills."},{color:"#DA70D6",text:"Collaborative and referral practices with medical, paramedical, therapy and educational centers."},{color:"#FFA500",text:"Friendly environment for therapists so that they can provide best of their potential to children coming for therapies."},{color:"#004E66",text:"The organization takes staff for two picnics / leisure trips at 50% sponsorship."}],tO=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Q5,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsx("div",{className:"timeline-container",children:eO.map((s,e)=>r.jsxs("div",{className:"timeline-item",style:{backgroundColor:s.color,animationDelay:"".concat(e*.2,"s")},children:[r.jsx("div",{className:"timeline-icon",children:r.jsx("img",{src:J5,alt:"icon"})}),r.jsx("div",{className:"timeline-text",children:s.text})]},e))})]}),sO="/assets/speech-jOiGDkmv.webp",nO="/assets/receptive_language-C7tgFhol.webp",aO="data:image/webp;base64,UklGRgYHAABXRUJQVlA4TPoGAAAvu8AuEH/BoG0kR8cfcfVe/6dAIGnz/pm33UzbNuMPd7nnEQhC9P8sFhCbJDhHf4z/y5NLeXKrPLmUr93dg7RZ2vQHhATwAAJIAAE8gAQQjoK0DZjVv+09CRExAfIAHyvLtpW6lrqASojxRRfof/duThIBHVV/Ef2fAEgCwESNwuJalJznpKWWOi78/31YlYTeI/o/AfJvsbecCTHBw4CIOZc2tmbUjBHmIuXGG9IyBtCaqIyNGNcB6uNZt6CfCawehdc2rgi2qa6rHuBgOMeKOEfw8mirGQSuxrKSQeBuLKsYBC7HsgI+we1Y3bsCeI7DtZbA+5Pd4hMWGKtTLcIaD3aIT1hmaO70BCs9nblgsWk4wgTLDdWNkWDF2YkWYM3EHhRYdmJ7GRYeuzWCpYdui2DxoVsiWH7odgg2MHQrBFsYug2CTQzdwgnbGLq+AhsZWVuFrUysq4e9AFLFEXYza0LYz6Ynw4aGoaXBliYlHPYEso4DdrVpuMBqb4yxeYs8bwQTfa3hUBSNzRec8xAMGg3nyz5b0GZV0G8LuCzqbMVJHPR1Eu7UNlOQ55ygvhNwr7KZgjFjgPpOwN0qV8cM1Kfg/ipT0L5roL6GlCZT+B2q6yGpyhSUrxqor9LAI1PxK9QnEhWZgvJNA/UPSJ2r+A3qq5OZTEH9ooF+nazOFX5B+wT93QCDIlmZLXqXLcDPAn4VLehkdb6uNxW2Kr45TNTJTL6gP2Mw+UhmbxlfPn47ZvSs2ECRqMDr42cLJ/8nTuHZYaRM1F4al3B1m/hAfcJgtE8j8aoPd65PNvSkWMEqyePCsIabJy7xCZmxMkGB5597uH1iAv1BMIOduE3Zc8MWEk5M8q8Ohjtxk7J4fg1JXzzwV7aEnbhFWTzvQ9p9YAG/0BT2+oYKL44h9cyj/QDrD3lBd3h1SRZGFvmum0M0pfyiqh4vjyH9zALvLgcQ0ZoYb/0QCAOHcEc+pNwovDhAv0HnxkBxZlFvwPkXiYVF/tPNWdPUWmsBAErrsn50FzyJwAL/NFP2UUq4UzfdD0h/siFTQkJZ97mDP6eZVkLqss/cEBE0YiQQ1JlrZmwJJA/eJDYeRUTAYqeApogciX8e2UgngGqPiEji/UM6AWQf0T+Fkcch0vRZAXTLaCKwIk80oYGwiHBLN/2OFki30ZRsw59hBS0d4ZrK/Y4WiJvouaeZkWs0oKipCKck68AG9PVAvo5wSrAO+DtaetBFON22DvhDKgbSRuj2ez4DMo76NANQNsJhvmFzyBqXAMpGiOO8n1snZL4IUP0BIr4+yx6t/+8R2a8CxONLXlGEV1A0fZYOEXFPNhYznf3QuqobYwxeNabDfP9JutQNumqMRaJP9/b+syzL7L1/uYFbERHUZCScl2XbIdXne17D9X3xjlMTEdJjCzhdtD2SdfMWEv5PA5cuIlmNEXCyeCDdwW8h9T6PPEREqpYWvsvGIt3B74Hk4hjEP11JCV9li5TfeyA7D+Twj+ho4Vi0SHlcA+X9RS3fJA0dHJcWKb/2QPxDrNyQBn3UIukp0F8GUv3mUmDgsEXSU+C4DpTktikoD2okPQWe/4TwThSoSCLpZ+Dq6Zw/cB7EFalhYxMcmfojK6lJ+cB3JcM/2jwRFZSGnVGYiCT5PU9H0BHygfNG5HxwTGsOlKWzsQpPGu3BNc2KCJSl8gy8PySCPBzTsD4A1RHxzFYS9ETSNFQHIBoaC7NAoj665ll1ACANhY2bIxDk8ZiHVh0BqDZd4L76MRk9E5yHVn8BEFWftxB2l6q+KAoQ628AoJouwTMDYR/SRHnJQQP2+gQAyPJh7/mELE5pzjdCKhCNPhPLsjH2yivk0acZr7oSRFOcO5S6qo359s9tXdZ0KO9RC2Jfyyvf5cHCY1kW79/ODYjo09UPqh5E7Cp5C5yZ5+X7em5bvv/7+OWcG/FquihfRk2I2DeFSOGQc7rySVEWd02pflCUb6O+Q9PWWv2U/FExcmyNqevfEPgjiZbOZq/I12WHonyfNqhMaPuDMvPYnjZlhM0hmZv3JvAkSRswOufceE+R2X0DEqLMz+Ym770fsxSGAknWMl5EYw+bcojOsieRlQhtSRetnDbkEr09bAeJ5robiVXJtReBRTntROiinjaiiX5O21DEIqdNKGKT0xYUscppA/7ELqflFbHMaXFFjNPKQhXztK7QxcGyqjTExRaWdLA4OdKCsvjJtJrQxNUSloIszo60kCwO51WkLi53XEIWt6/gHg5xnMm3WMX5jn6FzOJ/i04RyxpLdIiGrLOgL4GGrLWRHzGzrHfk6AIWWXUlazEPWTmXw048u6yfK0UD6eqyjf06gqJ0VpbdHDVjmJboarKv3EomxHcRMefW5X8x";function rO(){return r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:sO,alt:"Speech Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-12",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] relative inline-block",children:["Speech Therapy Services",r.jsx("span",{className:"block w-20 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6 mt-10 px-4 pb-16",children:[r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-red-100 via-pink-100 to-white shadow-md p-6 w-full md:w-96 rounded-md",children:[r.jsx("img",{src:nO,alt:"Speech and Language Evaluation",className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:"Speech and Language Evaluation"})]}),r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-blue-100 via-purple-100 to-white shadow-md p-6 w-full md:w-96 rounded-md",children:[r.jsx("img",{src:aO,alt:"Receptive Language Evaluation",className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:"Receptive Language Evaluation"})]})]})]})}const oO="/assets/assesment-CrWlA-Is.webp",iO=()=>r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:oO,alt:"Psychological Testing Services",className:"w-full h-auto object-cover"})}),r.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-8 text-center",children:"Testing and Evaluation Services"}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl ",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Psychological Assessments & IQ Testing"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Brain Based Intelligence Test (BBIT)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Malin's Intelligence Scale for Indian Children (MISIC)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Binet Kamat Test of Intelligence (BKT)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsxs("div",{children:[r.jsx("p",{children:"Wechsler's Intelligence Scale for Children (WISC-IV)"}),r.jsx("p",{className:"text-sm text-gray-600 ml-4",children:"Indian and UK norms are available"})]})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Cognitive Assessment System (CAS)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Raven's Standard Progressive Matrices (SPM)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Raven's Color Progressive Matrices (CPM)"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Developmental Assessments"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Bayley Scale of Infant and Toddler Development"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Developmental Screening Test (DST)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Vineland Social Maturity Scale (VSMS)"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Psycho-Educational Assessments"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Wechsler's Individual Achievement Test (WIAT-II)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Dyslexia Screening Test- Junior"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Dyslexia Screening Test-Senior"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"NIMHANS SLD Index"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Brigance Learning Skills Evaluation"})]})]})]}),r.jsxs("div",{className:"mb-12 bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-10 rounded-xl",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Diagnostic Evaluation for:"}),r.jsxs("ul",{className:"space-y-3",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Specific Learning Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Attention Deficit Hyperactivity Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Autism Spectrum Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Sensory Processing Disorder"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:"Slow Learner"})]})]})]})]})]}),lO="/assets/Raghesh_Pooja-cU6G_R1E.webp",cO="/assets/founder_message-CRrEKR1y.webp",uO=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:cO,alt:"Founder Message",className:"object-cover w-full h-full"})}),r.jsxs("section",{className:"flex flex-col items-center py-16 px-8 bg-white text-gray-800",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-3xl text-[#002b5b] font-semibold",children:"Founder Messages"}),r.jsx("div",{className:"w-16 h-1 bg-[#c9202d] mx-auto mt-2 rounded-sm"})]}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-8 max-w-[1100px] w-full",children:[r.jsxs("div",{className:"text-center max-w-[400px] transition-transform duration-300",children:[r.jsx("img",{src:lO,alt:"Founders",className:"w-full border-[6px] border-white shadow-lg rounded-xl scale-[0.97] transition-transform duration-400 hover:scale-[1.02]"}),r.jsx("p",{className:"mt-4 font-bold text-[#002b5b]",children:"Dr. Raghesh G Nair & Dr. Pooja Jha Nair"})]}),r.jsxs("div",{className:"flex-1 min-w-[280px] max-w-[600px] text-base leading-relaxed",children:[r.jsx("p",{className:"mb-4",children:"Welcome to the world of passionate and professional approach to manage learning issues of children with developmental disorders. Total Solution is group of committed people who are chasing the dream of providing learning opportunity to all children of our society. Come and join our journey, as we all together can contribute to build our nation by making each child a productive citizen of our country."}),r.jsx("p",{className:"mb-4",children:"We are providing holistic services at nine different locations in Hyderabad  Bowenpally, Barkatpura, Kukatpally, Suchitra, Banjara Hills, Manikonda, Nacharam, Neredmet and Champapet, with a total of 9 branches and 1 special education center. A model of intervention programs has been implemented at each premise to maintain the quality of services."}),r.jsxs("div",{className:"mt-6 text-gray-600",children:[r.jsx("p",{children:"Dr. Pooja Jha Nair & Dr. Raghesh G Nair"}),r.jsx("p",{children:"Founder partners"}),r.jsx("p",{children:"Total Solution"})]})]})]})]})]}),dO="/assets/goals-CJYqMSVT.webp",hO=[{text:"Arrange for reasonable academic accommodations for registered students.",color:"#f79568"},{text:"Encourage registered students to develop independence by familiarizing them with policies, procedures and available resources.",color:"#ffde7d"},{text:"Create awareness among parents and children about diagnosis, intervention and correct intervention procedures for children with developmental disorders.",color:"#d5f573"},{text:"Give proper guidelines for the kids to school.",color:"#6de3e4"},{text:"Train teachers as well as the parents so that child is in safe hands.",color:"#a78bfa"},{text:"Establish a unit which will assist in formation of resource rooms at school & design and make teaching learning materials for each child.",color:"#f9a8d4"},{text:"Initiate & support multidisciplinary therapy centers and parent groups of children with learning disturbances.",color:"#86efac"},{text:"Take up research projects on various assessment & intervention methods and their efficacy.",color:"#fca5a5"},{text:"Initiate various short & long term training modules on behavior management, classroom management etc. of children with learning problems.",color:"#93c5fd"},{text:"Collaborate with different private, government and non-government agencies to spread similar models of practice in schools.",color:"#d8b4fe"},{text:"Develop modules of management/intervention on cognitive, behavioral and emotional issues of children with learning problems.",color:"#fecaca"},{text:"Initiate aptitude & talent based vocational centers for adults with learning disturbances.",color:"#bbf7d0"},{text:"Support organizations on initiation of self-necessary for persons with learning disturbances.",color:"#bfdbfe"}],pO=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:dO,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"goals-section",children:[r.jsxs("div",{className:"goals-title",children:[r.jsx("h2",{children:"Goals of Total Solution"}),r.jsx("div",{className:"underline"})]}),r.jsx("div",{className:"goals-list",children:hO.map((s,e)=>r.jsxs("div",{className:"goal-card ".concat(e%2===0?"slide-in-left":"slide-in-right"),style:{backgroundColor:s.color},children:[r.jsx("span",{className:"goal-arrow",children:""}),r.jsx("p",{children:s.text})]},e))})]})]}),fO="/assets/gayathri-3TQKWDI4.webp",mO="/assets/mridulajha-CBWq_s3E.webp",gO="/assets/raichal-NWLXGemt.webp",xO=[{name:"Mrs. GVN Gayathri",title:"Research Head",image:fO},{name:"Ms. Khersingh Komal",title:"Research Assistant",image:mO},{name:"Mrs. Ashwathy R",title:"Research Assistant",image:gO}],bO=()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:Rj,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"py-8 px-4 sm:px-6 text-center bg-white text-gray-800 font-sans",children:[r.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-[#0e2b5c] mb-4 relative",children:["Research Department",r.jsx("div",{className:"h-1 w-20 bg-[#0e2b5c] mx-auto mt-2"})]}),r.jsxs("div",{className:"max-w-4xl mx-auto mb-8 text-left leading-relaxed",children:[r.jsx("p",{className:"mb-4",children:"Total solution is committed to practice scientific research-based practices. In order to scientifically test our own developed strategies and to statistically validate our own findings, we have a research wing. At present, the following research projects are in progress:"}),r.jsxs("ol",{className:"list-decimal pl-6 space-y-2",children:[r.jsx("li",{children:"1. Cognitive profile of children with Specific Learning Disorder"}),r.jsx("li",{children:"2. Impact of Math Module on curriculum-based math performance"}),r.jsx("li",{children:"3. Impact of parental involvement in behaviour therapy on overall development of children with ASD."})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-6 sm:gap-8",children:xO.map((s,e)=>r.jsxs("div",{className:"w-48 sm:w-56 text-center bg-gray-50 rounded-lg p-4 shadow-md",children:[r.jsx("img",{src:s.image,alt:s.name,className:"w-full h-auto rounded-lg"}),r.jsx("h3",{className:"text-lg sm:text-xl font-medium mt-2 mb-1",children:s.name}),r.jsxs("p",{className:"text-sm sm:text-base text-[#800000]",children:["(",s.title,")"]})]},e))})]})]}),yO="/assets/Web_SubBanner_BM-CcBklMcg.webp";function vO(){return r.jsxs("div",{className:"font-sans",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:yO,alt:"Behaviour Modification Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Behaviour Modification Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"flex justify-center mt-8 px-4 pb-12",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:[r.jsxs("p",{children:[r.jsx("span",{className:"inline-block mr-2 text-blue-500",children:""}),"Behaviour Modification is provided to manage undesirable behaviours and to improve the frequency of desirable behaviour. In this therapy a triad is maintained among parents-child and therapist. Behaviour contract with mutual consent of child and parent is developed and it is monitored through regular phone calls. Parents are counselled about usage of techniques like application of consequences, reward based techniques and using consistent parenting skills."]}),r.jsxs("p",{children:[r.jsx("span",{className:"inline-block mr-2 text-blue-500",children:""}),"Total solution Rehabilitation Society has expertise to implement behaviour modification therapy and success rate is commendable."]})]})})]})}const wO="/assets/remedial-B7Jw_Yqt.webp";function NO(){return r.jsxs("div",{className:"font-sans text-[#001F3F]",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:r.jsx("div",{className:"w-full",children:r.jsx("img",{src:wO,alt:"Remedial Therapy",className:"w-full object-cover"})})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Remedial Therapy Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"flex justify-center mt-8 px-4",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md space-y-4 text-lg leading-relaxed border",children:[r.jsx("p",{className:"font-semibold",children:"In remedial/education therapy we provide a threefold support to the child in following ways:"}),r.jsxs("ul",{className:"space-y-2 pl-4 list-none",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Teaching and reinforcing of cognitive skills. Visual perception / Auditory perception / Working memory / Attention enhancement skills / Reasoning / planning ability / Language processing skills"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Comprehension skills Strengthening the learning of academic based skills (English language / Math / Hindi / study skills)"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Behavior Modification"]})]})]})}),r.jsx("div",{className:"flex justify-center mt-6 px-4 pb-12",children:r.jsxs("div",{className:"bg-gradient-to-r from-red-200 via-red-100 to-red-50 p-6 md:p-8 rounded-md max-w-4xl shadow-md space-y-4 text-lg leading-relaxed border",children:[r.jsx("p",{className:"font-semibold",children:"The other components of Remedial Therapy that we provide are:"}),r.jsxs("ul",{className:"space-y-2 pl-4 list-none",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Educational intervention to enhance study skills"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Reading skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Writing skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Spelling skills intervention"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-600 mr-2",children:""}),"Math basic skills training"]})]})]})})]})}const SO="/assets/Branches-DR2dlVgk.webp",CO=({title:s,location:e,address:t,contactPerson:n,phone:a,isLeftAligned:o,isAlternate:i})=>r.jsx("div",{className:"w-full py-12 ".concat(i?"bg-gray-100":"bg-white"),children:r.jsx("div",{className:"max-w-6xl mx-auto px-6",children:r.jsxs("div",{className:"flex flex-col ".concat(o?"items-start text-left":"items-end text-right"),children:[r.jsxs("h2",{className:"text-red-700 text-2xl font-bold mb-4",children:[s," ",r.jsxs("span",{className:"text-gray-600",children:["(",e,")"]})]}),r.jsx("p",{className:"text-gray-700 mb-3 max-w-2xl",children:t}),r.jsx("a",{href:"tel:".concat(a),className:"text-red-600 border border-red-600 rounded-full px-8 py-2 inline-block hover:bg-red-50 transition-colors",children:a})]})})}),jO=[{title:"Total Solution Rehabilitation Society",location:"Bowenpally",address:"Plot 9 SBI Colony, Manovikas Nagar, Old Bowenpally, Secunderabad 500009.",phone:"+91 88865 78697"},{title:"Total Solution Rehabilitation Society",location:"Barkatpura",address:"3-4-495 / B, 1st Floor, YMCA, Near More Supermarket, Barkatpura, Hyderabad 500027.",phone:"+91 88864 78697"},{title:"Total Solution Rehabilitation Society",location:"Kukatpally",address:"Srinivasan Apts, Flat no. 502, Addagutta Society, Pragathi Nagar Road, Beside Narayana Junior College, Oppo. Road to JNTU, Hyderabad 500072.",phone:"+91 90632 08697"},{title:"Total Solution Rehabilitation Society",location:"Suchitra",address:"Plot No. 105, Block 'A' , Survey no. 91,92,93 Jeedimetla Vill, Lane beside Chennai Shopping Mall, Suchitra, Hyderabad.",phone:"+91 99594 18697"},{title:"Total Solution Rehabilitation Society",location:"Banjara Hills",address:"8-2-629, Road no.1, Near Pension Office, Mithila Nagar, Banjara Hills, Hyderabad 500034.",phone:"+91 87905 88697"},{title:"Total Solution Rehabilitation Society",location:"Manikonda",address:"Ground Floor, Phani Plaza, Secretariat Colony,Puppalaguda, Rajendranagar, Hyderabad 500089.",phone:"+91 89786 88697"},{title:"Total Solution Rehabilitation Society",location:"Nacharam",address:"7-38, Road no 1, Bapuji Nagar, Lane opposite to HDFC bank, Nacharam Road, Secunderabad 500076.",phone:"+91 90003 28697"},{title:"Total Solution Rehabilitation Society",location:"Neredmet",address:"35-67/1, GK Colony, Beside Delhi Mithaiwala Sainikpuri, Neredmet, Secunderabad 500094",phone:"+91 90003 48697"},{title:"Total Solutiion Rehabilitation Society",location:"Champapet",address:"H. No. 17-01-382/B/25, Bhanu Nagar, Road no 2, Beside lane Focus Hospital, Champapet, Hyderabad 500079.",phone:"+91 99493 08697"},{title:"Special Education Center",location:"Barkatpura",address:"3-4-495/B, 1st Floor, Near More Super market Barkatpura, Hyderabad 500027.",phone:"+91 70754 88697"}];function kO(){return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:SO,alt:"Image",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsx("div",{className:"w-full",children:jO.map((s,e)=>r.jsx(CO,{title:s.title,location:s.location,address:s.address,contactPerson:s.contactPerson,phone:s.phone,isLeftAligned:e%2!==0,isAlternate:e%2!==0},e))})]})}const TO="/assets/Behaviour-DkU7Cq4F.webp",IO="/assets/social-BHZdGott.webp",$O="/assets/lifeskills-Cdz4sjde.webp",AO="/assets/selfhelp-CPfcU3dX.webp",EO="/assets/conceptslearning-DeyCKx19.webp",DO="/assets/socialstory-8rviR9Ro.webp",RO="/assets/mindskill-DYA4HHFJ.webp",OO="/assets/grouptherapyl-CSmNRZog.webp",_O="/assets/parentaltraining-STAVNvpQ.webp",FO="/assets/BT-BqCRWvbP.webp",LO=[{image:IO,text:"Social Skills Training"},{image:$O,text:"Life training skills"},{image:AO,text:"Self Help Skill training"},{image:EO,text:"Concepts learning through behaviour approach"},{image:DO,text:"Social stories methods to develop experiences for children with special needs"},{image:RO,text:"Theory of Mind skills training"},{image:OO,text:"Group therapy for better generalization"},{image:_O,text:"Parental training during therapy sessions."}];function MO(){return r.jsxs("div",{className:"font-sans text-[#001F3F]",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:TO,alt:"Behaviour Therapy",className:"w-full object-cover"})}),r.jsx("div",{className:"text-center mt-10",children:r.jsxs("h3",{className:"text-2xl font-bold text-[#001F3F] inline-block relative",children:["Behaviour Therapy Services",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-10 px-4 max-w-4xl mx-auto pb-16",children:LO.map((s,e)=>r.jsxs("div",{className:"flex items-center bg-gradient-to-br from-red-200 via-red-100 to-red-50 shadow-md p-6 rounded-md",children:[r.jsx("img",{src:s.image,alt:s.text,className:"w-10 h-10 mr-4"}),r.jsx("span",{className:"text-md text-[#001F3F] font-semibold",children:s.text})]},e))}),r.jsx("section",{className:"flex justify-center mt-4 px-4 pb-12",children:r.jsx("div",{className:" p-6 md:p-8 rounded-md max-w-5xl text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:r.jsx("p",{children:"We provide behavior therapy on principals of A-B-C (Antecedent-Behavior-Consequence) analysis. We incorporate different approaches and focus on systematic intervention style. Following is our plan of action for ASD:"})})}),r.jsx("section",{className:"flex justify-center mt-4 px-4 pb-12",children:r.jsx("div",{className:"p-6 md:p-8 rounded-md max-w-6xl text-[#001F3F] text-justify space-y-4 text-lg leading-relaxed",children:r.jsx("img",{src:FO,alt:"Behaviour Therapy",className:"w-full object-cover mt-4"})})})]})}const PO="/assets/training-DJgvaKIg.webp";function zO(){return r.jsxs("div",{children:[r.jsx("div",{className:"relative w-full overflow-hidden mx-auto",children:r.jsx("div",{className:"flex h-full",children:r.jsx("div",{className:"min-w-full h-full flex items-center justify-center bg-black",children:r.jsx("img",{src:PO,alt:"Image",className:"w-full h-[80%] object-cover rounded-lg shadow-md"})})})}),r.jsxs("div",{className:"w-full max-w-4xl mx-auto p-6",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-800 border-b-2 border-gray-300 pb-2 text-center",children:"Training Information"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b-2 border-gray-300",children:[r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Row"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Training Programs"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Duration"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Frequency"}),r.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Course Coordinator"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"1"}),r.jsx("td",{className:"px-4 py-3",children:"Pedagogy (Short term)"}),r.jsx("td",{className:"px-4 py-3",children:"3 Month"}),r.jsx("td",{className:"px-4 py-3",children:"Twice in a year (May batch and Oct Batch)"}),r.jsx("td",{className:"px-4 py-3",children:"Ms. Khersingh Komal (8121884021)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"2"}),r.jsx("td",{className:"px-4 py-3",children:"Behavioural therapy"}),r.jsx("td",{className:"px-4 py-3",children:"1 Month"}),r.jsx("td",{className:"px-4 py-3",children:"In house Training for staff"}),r.jsx("td",{className:"px-4 py-3",children:"Mrs. Ashwathy R (9603281782)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"3"}),r.jsx("td",{className:"px-4 py-3",children:"PREP, COGENT & Math Module"}),r.jsx("td",{className:"px-4 py-3",children:"3 Month"}),r.jsx("td",{className:"px-4 py-3",children:"Quarterly"}),r.jsx("td",{className:"px-4 py-3",children:"Mr. Sridhar (7702222209)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"4"}),r.jsx("td",{className:"px-4 py-3",children:"Parent Training Program for Behaviour Therapy Skills"}),r.jsx("td",{className:"px-4 py-3",children:"1 Month"}),r.jsx("td",{className:"px-4 py-3",children:"On demand of parents (group of minimum 10 parents)"}),r.jsx("td",{className:"px-4 py-3",children:"Ms. Khersingh Komal (9849053404)"})]}),r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:"5"}),r.jsxs("td",{className:"px-4 py-3 space-y-2",children:[r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training in improving handwriting skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training to teach reading skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training to teach spelling skills (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Behaviour Modification Strategies (Short term)"}),r.jsx("div",{className:"pl-4 relative before:content-[''] before:absolute before:left-0 before:top-0",children:"Training in attention enhancement (Short term)"})]}),r.jsx("td",{className:"px-4 py-3",children:"As per demand"}),r.jsx("td",{className:"px-4 py-3",children:"As per demand"}),r.jsx("td",{className:"px-4 py-3",children:"Mrs. Gomathi Sharma (9866983096)"})]})]})]})})]})]})}const BO="/assets/servicesmain-CwaFdCCR.webp",VO="/assets/assessment-B2frtg3m.webp",UO="/assets/occupational-BMizKsZD.webp",GO="/assets/behaviour-DiK9likm.webp",WO="/assets/remedial-CUjWK615.webp",HO="/assets/modification-Cjy5WYTQ.webp",qO="/assets/speech-tokNFPWm.webp",KO=[{name:"Assessment & Evaluation",image:VO,color:"#00b2e1"},{name:"Occupational Therapy",image:UO,color:"#ed1c24"},{name:"Behaviour Therapy",image:GO,color:"#8bc53f"},{name:"Remedial Therapy",image:WO,color:"#fcee21"},{name:"Behaviour Modification",image:HO,color:"#92278f"},{name:"Speech Therapy",image:qO,color:"#f7931e"}],XO=()=>r.jsxs(r.Fragment,{children:[r.jsxs(Dy,{children:[r.jsx("title",{children:"Our Services | Total Solution for Learning"}),r.jsx("meta",{name:"description",content:"Explore therapy and rehabilitation services at Total Solution Rehabilitation Society for Learning in Hyderabad  including speech therapy, occupational therapy, remedial education, and behavioral support."}),r.jsx("meta",{name:"keywords",content:"therapy services Hyderabad, speech therapy, occupational therapy, remedial education, autism support, ADHD therapy, developmental disorders"}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org/services"}),r.jsx("script",{type:"application/ld+json",children:'\n    {\n      "@context": "https://schema.org",\n      "@type": "Service",\n      "serviceType": "Therapy and Rehabilitation",\n      "provider": {\n        "@type": "MedicalClinic",\n        "name": "Total Solution for Learning",\n        "url": "https://totalsolutionforlearning.org"\n      },\n      "areaServed": {\n        "@type": "Place",\n        "address": {\n          "@type": "PostalAddress",\n          "addressLocality": "Hyderabad",\n          "addressCountry": "IN"\n        }\n      },\n      "url": "https://totalsolutionforlearning.org/services",\n      "description": "Therapy and rehabilitation services including speech, occupational, remedial education, and behavior therapy for children with developmental needs."\n    }\n    '})]}),r.jsx("div",{className:"font-sans",children:r.jsx("div",{className:"relative w-full h-96 overflow-hidden",children:r.jsx("img",{src:BO,alt:"Header ADHD Mindmap",className:"object-cover w-full h-full"})})}),r.jsxs("section",{className:"py-8 px-4 sm:px-6 bg-white text-gray-800 font-sans text-center",children:[r.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-[#0e2b5c] mb-4",children:["Services",r.jsx("div",{className:"h-1 w-16 bg-[#0e2b5c] mx-auto mt-2"})]}),r.jsx("p",{className:"max-w-4xl mx-auto mb-8 text-justify leading-relaxed text-base",children:"The organization was providing service to children and schools and certain NGOs in an informal way. By the end of 2008, we started promoting the organization as a brand with integrated services, training, therapeutics and advocacy as the main theme. Total Solution Rehabilitation Society currently provides solutions through its associate centers across Hyderabad, as given below."}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 my-8 px-2 sm:px-4",children:KO.map((s,e)=>r.jsxs("div",{className:"rounded-lg text-white shadow-md overflow-hidden text-center",style:{backgroundColor:s.color},children:[r.jsx("img",{src:s.image,alt:s.name,className:"w-full h-auto block"}),r.jsx("h3",{className:"p-3 m-0 text-lg font-medium",children:s.name})]},e))}),r.jsxs("p",{className:"max-w-4xl mx-auto text-justify leading-relaxed text-base",children:["Apart from these divisions, Total Solution Rehabilitation Society provides consultations, assessments and evaluations and home based therapy programs. In order to keep up with the changing times, we conduct 'Continuing Learning Education' programs to update already trained personnel.",r.jsx("br",{}),r.jsx("br",{}),"As the saying goes, 'A journey of thousand miles starts with a single step'. We have started the first step and we realize that there are miles to go. We are a learning organization and believe in catering to the emerging needs of the field from time to time."]})]})]}),YO="/assets/Branches-DR2dlVgk.webp",ZO=[{question:"What kind of therapies we provide?",answer:"Link of therapies."},{question:"Do you handle Slow learners?",answer:"Yes."},{question:"Do you deal with handwriting?",answer:"We provide handwriting program to improve formation of letters, legibility of writing, speech of writing and organization of handwriting on paper."},{question:"Do we handle behavior issues?",answer:"Yes."},{question:"Do you handle Intellectually disability?",answer:"Only mild Intellectual disability to manage their learning problems and to improve their cognition."},{question:"How to identify child has some issue?",answer:"Observe for gaps between childs age and his existing behaviors or learning skills. if more than 3 signs of large gaps visible across different situations, take professional help to diagnose and intervene. Example age inappropriate development, poor learning when compared to peer group, difficulty to pay attention to given academic tasks specifically in group, poor recall of academic content, poor relationships with peer group etc."},{question:"Do I have to take appointment before visiting the clinic?",answer:"Yes, Appointment is needed."},{question:"What is the follow up consultation fee and follow up duration?",answer:"The Consultation fees is .rs for follow up and the duration for the follow up depends on the Treatment."},{question:"Is clinic accessible by wheelchair?",answer:"No, the clinic is on first floor."},{question:"Who do we need to meet if we want to take consultations?",answer:r.jsxs("div",{className:"space-y-2 text-sm md:text-base",children:[r.jsx("p",{children:"Dr. Pooja Jha Nair or Mr. Raghesh G Nair (For appointment Mr. Sridhar 8886008697), in absence of Dr. Pooja or Mr. Raghesh consult Center Heads:"}),r.jsxs("ul",{className:"list-none space-y-1 pl-2",children:[r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Bowenpally"}),"  Mrs. Suma Singh  9346 422 873"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Kukatpally"}),"  Mrs. PadmaSri  8886 778 697"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Banjara Hills"}),"  Mrs. Sophia Pirani  9849 053 404"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Nacharam"}),"  Mrs. Gomati  9866 983 096"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"A S Rao Nagar"}),"  Mrs. Gomati  9866 983 096"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Barakatpura"}),"  Ms. Sirisha  9652 483 265"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Manikonda"}),"  Mrs. Sophia Pirani  9849 053 404"]}),r.jsxs("li",{children:[r.jsx("span",{className:"text-blue-500",children:""})," ",r.jsx("strong",{children:"Champapet"}),"  Mr. Akram  9949 477 055"]})]})]})}];function QO(){const[s,e]=F.useState(null),t=n=>{e(s===n?null:n)};return r.jsxs("div",{className:"px-4 py-10  mx-auto font-sans",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:YO,alt:"Branches",className:"w-full object-cover"})}),r.jsxs("h2",{className:"text-center text-2xl font-bold text-[#001F3F] mb-8 mt-4",children:["Frequently Asked Questions",r.jsx("div",{className:"w-24 h-1 bg-red-500 mx-auto mt-2"})]}),r.jsx("div",{className:"space-y-4 max-w-4xl justify-center mx-auto",children:ZO.map((n,a)=>r.jsxs("div",{className:"border rounded bg-white shadow-sm",children:[r.jsxs("button",{onClick:()=>t(a),className:"w-full text-left px-4 py-3 flex justify-between items-center text-[#001F3F] font-medium",children:[r.jsx("span",{children:n.question}),r.jsx("span",{className:"text-xl",children:s===a?"":"+"})]}),s===a&&r.jsx("div",{className:"px-4 pb-4 text-gray-700",children:n.answer})]},a))})]})}const JO=["Patient/Caregiver/Doctor/Health Care Professional Name,","Birth date/age,","Gender","Address (including country and pin/postal code),","Phone number/mobile number,","Email address,","Physical, physiological and mental health condition, provided by You and/or your Health Care Professional,","Personal medical records and history,","Valid financial information at time of purchase of product/service and/or online payment,","Login ID and password,","User details as provided at the time of registration or thereafter,","Records of interaction with TSRS representatives,","Your usage details such as time, frequency, duration and pattern of use, features used and the amount of storage used,","Master and transaction data and other data stored in Your user account,","Any other information that is willingly shared by You (collectively referred to as Personal Information).","Biometrics data","Genetic Data","Transgender Status","Intersex Status","Caste or Tribe","Religious or political belief or affiliation","Sexual orientation"],e_=["When You fill the patient registration form,","When You provide details to a TSRS Professional or TSRS representative,","When You register on Our Website,","When You provide Your Personal Information to Us during course of receiving services,","When You use the features on Our Website,","When you provide access to any other website."],t_=["To provide effective Services","To operate and improve the Website and/or our Services;,","To perform studies, research and analysis for improving Our information, analysis, services and technologies; and ensuring that the content displayed are customized to Your interests and preferences;","To contact You via phone, SMS, WhatsApp or email for appointments, technical issues, payment reminders, deals and offers and other announcements;","To send promotional mailings from Us or any of Our channel partners via SMS, WhatsApp, email;","To advertise products and services of TSRS;","To transfer information about You if we are acquired by or merged with another company;","To share with our business partners for provision of specific services you have ordered so as to enable them to provide effective services to You;","To administer or otherwise carry out Our obligations in relation to any agreement You have with us;","To build your profile on the Website;","To respond to subpoenas, court orders, or legal process, or to establish or exercise Our legal rights or defend against legal claims;","To investigate, prevent, or take action regarding illegal activities, suspected fraud, violations of our Terms of Use, breach of Our agreement with you or as otherwise required by law,","To aggregate Personal Information for research, statistical analysis and business intelligence purposes, and to sell or otherwise transfer such research, statistical or intelligence data in an aggregated or non-personally identifiable form to third parties and affiliates, (referred to as Purpose(s))"],s_=[" Once you have freely consented to share your Personal Information with us, You authorize us to exchange, transfer, share, part with all or any of Your Personal Information, across borders and from Your country to any other countries across the world with the Cloud Service Provider and Our affiliates / agents / third party service providers / partners / banks and financial institutions or any other persons, for the Purposes specified under this Policy or as may be required by applicable law.","You acknowledge that some countries where we may transfer Your Personal Information may not have data protection laws that are as stringent as the laws of Your own country. You acknowledge that it is adequate that when TSRS transfers Your Personal Information to any other entity within or outside Your country of residence, TSRS will place contractual obligations on the transferee which will oblige the transferee to adhere to the provisions of this Privacy Policy."],n_=["The security of your Personal Information is important to us. We have adopted reasonable security practices and procedures including role-based access and need to know basis, password protection, encryption etc. to ensure that the Personal Information collected is secure. We restrict access to your Personal Information to Our and Our affiliates employees, agents, third party service providers, partners, and agencies on a need to know basis and in relation to the Purposes as specified above in this Policy.","While We will endeavour to take all reasonable and appropriate steps to keep secure any information which We hold about You and prevent unauthorized access, you acknowledge that the internet is not 100% secure and that We cannot provide any absolute assurance regarding the security of Your Personal Information. We will not be liable in any way in relation to any breach of security or unintended loss or disclosure of information caused by Us in relation to your Personal Information."],a_=["During Your interactions with Us, it may happen that We provide/include reference to third parties or fiduciaries, and/or links and hyperlinks of third party websites. It may also happen that you include links and hyperlinks of third party websites. The reference of such third parties or listing of such third party external sites (by You or by Us) does not imply endorsement of such party or site by TSRS. Such third parties and third party sites are governed by their own terms and conditions. We do not make any representations regarding the availability and performance of any of the third parties or third party sites. We are not responsible for the content, terms of use, privacy policies and practices of such third party websites.","Do-not-track requests There is no standard for how online service should respond to Do Not Track signals or other mechanisms that may allow you to opt out of the collection of information across networks of websites and online services. Therefore, we do not honour Do Not Track signals. As standards develop, we will revisit this issue and update this notice if our practices change."];function r_(){return r.jsxs("div",{className:"max-w-4xl mx-auto p-6 font-sans text-[#001F3F]",children:[r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["I. TERMS & CONDITIONS",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:"Please read and accept this privacy policy carefully before accessing or using the website. By accessing or using the website, you agree to be bound by the terms & conditions mentioned as well as all terms incorporated by reference."}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:'This document ("Terms") constitutes an electronic record as determined by the Information Technology Act, 2000 and the rules that administer it, as well as the amended provisions in several statutes pertaining to electronic records, as amended from time to time by the Information Technology Act, 2000.'}),r.jsxs("ol",{className:"list-decimal pl-6 space-y-2 text-sm md:text-base",children:[r.jsx("li",{children:'The following privacy statement ("Privacy Statement") applies to website XXX, operated by Total Solution Rehabilitation Society, a firm registered under the Telangana Societies Registration Act 2001... (truncated for brevity).'}),r.jsx("li",{children:"The Website is a digital platform for the services of consultations and assessments provided by registered body-Total Solution Rehabilitation Society."}),r.jsx("li",{children:"Individuals or entities that have agreed to become users of the Website in accordance with the procedure... may access the Services, the term shall also include visitors..."}),r.jsx("li",{children:"As much as we do our best to provide security... the inherent insecurities of the Internet mean that we cannot guarantee or warrant the complete security of your personal information."})]}),r.jsxs("ul",{className:"list-disc pl-6 mt-4 text-sm md:text-base space-y-1",children:[r.jsx("li",{children:"Our Liability"}),r.jsx("li",{children:"Company Information"})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["II. PRIVACY POLICY",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:"Total solutions Rehabilitation society. (TSRS) is committed to respecting the privacy of every person who shares information or data with TSRS. Your privacy protection is important to us and we strive to take due care and protection of the information we receive from you, the User."}),r.jsx("p",{className:"text-sm md:text-base mb-4",children:'This document ("Terms") constitutes an electronic record as determined by the Information Technology Act, 2000...'}),r.jsxs("ul",{className:"list-disc pl-6 text-sm md:text-base space-y-1",children:[r.jsx("li",{children:"The Information Technology Act, 2000  Section 43A."}),r.jsx("li",{children:"The Information Technology (Reasonable Security Practices and Procedures and Sensitive Personal Information) Rules, 2011."})]}),r.jsx("p",{className:"text-sm md:text-base mt-4",children:'This Privacy Policy ("Privacy Policy") applies to the collection, storage, processing, disclosure and transfer of your Personal Information...'}),r.jsx("p",{className:"text-sm md:text-base mt-2",children:"The terms 'You' or 'Your' refer to you as the User (registered or unregistered) of the Website..."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600",children:"1. ACCESS"}),r.jsx("p",{className:"text-sm md:text-base",children:"We collect Your Personal Information directly from You, through Our Website. This Personal Information, for instance, would relate to the type of device You are using, the time that You have logged on to Our Website, Your IP address and other Personal Information as listed in Clause 5 below. You may access the Personal Information shared by You with Us, in the manner given below. You can further choose to share additional Personal Information with Us and you can modify your personal data, through website itself or by writing to Us on tsrsofficial@tsrs.in We keep in mind that the Personal Information shared by You is accessible to You. You can write to Us at the email id specified in Clause 15."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"2. CONSENT"}),r.jsx("p",{className:"text-sm md:text-base",children:"By choosing the Opt-In option on the Website and thereafter, by providing Us Your personal information or availing services of TSRS or by making use of the facilities provided by the Website, it is agreed by You that You have, freely consented to the collection, storage, processing, disclosure and transfer of Your Personal Information in accordance with the provisions of this Privacy Policy and any amendments thereof. You acknowledge that You have provided Your Personal Information out of your free will and after understanding how it will be used. You also consent that the collection, storage, processing, disclosure and transfer of any Personal and privacy Information shall not cause any wrongful loss to You, if it is done in accordance with the provisions of this Privacy Policy. However, we shall not be liable for any loss that may happen to you owing to the provision of wrongful Personal Information by You. We will share personal information outside of TSRS only when we have your consent. We will ask for your explicit consent to share any sensitive personal information."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"3. CONTROL OVER YOUR PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"You have the right to withdraw Your consent at any point, provided such withdrawal of the consent is intimated to us in writing through an email at tsrsofficial@tsrs.in requesting the same. If You wish to rectify the Personal Information that we may have collected to offer You personalized services and offers, as per Clause 12 of this Policy, you may write to Us, as mentioned under Clause 15.1 of this Policy, citing the reason for such rectification of Personal Information. Once You withdraw Your Consent to share the Personal Information collected by Us, We shall have the option not to fulfil the purposes for which the said Personal Information was sought and We may restrict you from using our Services or the Website."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"4. CHANGES TO THE PRIVACY POLICY"}),r.jsx("p",{className:"text-sm md:text-base",children:"We reserve the right to change this Privacy Policy from time to time. We will not reduce your rights under this Privacy Policy without your explicit consent. We always indicate the date when the last changes were published. If changes are significant, well provide a more prominent notice (including, for certain services, email notification of Privacy Policy changes)."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"5. PERSONAL INFORMATION COLLECTED"}),r.jsxs("p",{className:"text-sm md:text-base",children:["The kinds of information that We collect about You include but are not limited to the following:",JO.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"6. HOW WE COLLECT PERSONAL INFORMATION"}),r.jsxs("p",{className:"text-sm md:text-base",children:["The methods by which we collect your Personal Information include but are not limited to the following:",e_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"7. USE OF PERSONAL INFORMATION"}),r.jsxs("p",{className:"text-sm md:text-base",children:["Your Personal Information may be used or processed for various purposes including but not limited to the following:",t_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))]}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"8. SHARING AND TRANSFERRING OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:s_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"9. SECURITY"}),r.jsx("p",{className:"text-sm md:text-base",children:n_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"10. THIRD PARTY REFERENCES AND LINKS"}),r.jsx("p",{className:"text-sm md:text-base",children:a_.map((s,e)=>r.jsx("li",{className:"list-disc pl-6 mt-2",children:s},e))}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"11. RECTIFICATION/CORRECTION OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"If You need to update or correct your Personal Information, you may update/edit the same directly on the website and also send corrections to us at tsrsofficial@tsrs.inwe will take all reasonable efforts to incorporate the changes within a reasonable period."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"12. COMPLIANCE WITH LAWS"}),r.jsx("p",{className:"text-sm md:text-base",children:"You are not allowed to use the services of the Website if any of the terms of this Privacy Policy are not in accordance with the applicable laws of your country."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"13. TERM OF STORAGE OF PERSONAL INFORMATION"}),r.jsx("p",{className:"text-sm md:text-base",children:"TSRS shall store Your Personal Information at least for a period of three years from the last date of use of the Services or Website or for such period as may be required by law.."}),r.jsx("h2",{className:"text-xl md:text-2xl font-bold text-left mb-2 text-orange-600 mt-2",children:"14. GRIEVANCE OFFICER"}),r.jsx("p",{className:"text-sm md:text-base",children:"We have appointed a Grievance Officer to address any concerns or grievances that You may have regarding the processing of Your Personal Information. If you have any such grievances, please write to our Grievance Officer at XXXXX and Our officer will attempt to resolve Your issues in a timely manner."})]}),r.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-10 font-sans text-[#001F3F]",children:[r.jsxs("section",{className:"mb-12",children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["III. REFUND/CANCELLATION POLICY",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsxs("div",{className:"text-sm md:text-base",children:[r.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"For online payments-"}),r.jsxs("ol",{className:"list-decimal pl-5 space-y-1 mb-4",children:[r.jsx("li",{children:"If the cancellation is done on the same day - Full refund will be made."}),r.jsx("li",{children:"For cancellation 3 days before a refund of 50% will be made."}),r.jsx("li",{children:"For cancellation of 0-3 days no refund will be made."})]}),r.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[r.jsx("li",{children:"A charge of 200 rs will be collected for all kinds of appointment which is non-refundable for consultations and 500rs non-refundable for assessments."}),r.jsx("li",{children:"If a cancellation occurs from TSRS or the appointed doctor, complete amount will be refunded back to the source."})]})]})]}),r.jsxs("section",{children:[r.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-center mb-4",children:["IV. PRICING & SERVICE INFORMATION",r.jsx("span",{className:"block w-24 h-1 bg-red-500 mx-auto mt-1"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full border border-gray-300 text-sm md:text-base",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-600 text-white",children:[r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Price"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Approx time"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Approx time"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Provisions"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"bg-white",children:[r.jsx("td",{className:"border px-4 py-2",children:"Consultations"}),r.jsx("td",{className:"border px-4 py-2",children:"500.00"}),r.jsx("td",{className:"border px-4 py-2",children:"30mins"}),r.jsx("td",{className:"border px-4 py-2"}),r.jsx("td",{className:"border px-4 py-2",children:"Prescription and clinical suggestions"})]}),r.jsx("tr",{className:"bg-gray-100 font-semibold",children:r.jsx("td",{colSpan:"5",className:"px-4 py-2",children:"IQ Assessments"})}),[{service:"MISIC",price:"5,000.00",time:"60-120 mins"},{service:"BKT",price:"3,000.00",time:"60-90 mins"},{service:"BBIT",price:"7,500.00",time:"90-120 mins"},{service:"WISC&WIAT",price:"12,000.00",time:"240 mins"},{service:"Home Visit- DST/VSMS/CARS",price:"5,000.00",time:"60 mins",note:"Professional will visit the clients home to observe the child in his/her natural habitat"},{service:"BELE",price:"",time:""}].map((s,e)=>r.jsxs("tr",{className:"bg-white",children:[r.jsx("td",{className:"border px-4 py-2",children:s.service}),r.jsx("td",{className:"border px-4 py-2",children:s.price}),r.jsx("td",{className:"border px-4 py-2",children:s.time}),r.jsx("td",{className:"border px-4 py-2",children:s.note||""}),r.jsx("td",{className:"border px-4 py-2",children:"Detailed report"})]},e))]})]})})]})]})]})}const o_="/assets/heroImage3-GVtHZq5Q.webp";function i_({title:s,titleId:e,...t},n){return F.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),s?F.createElement("title",{id:e},s):null,F.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const Ni=F.forwardRef(i_);function l_({title:s,titleId:e,...t},n){return F.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),s?F.createElement("title",{id:e},s):null,F.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const Si=F.forwardRef(l_),c_=()=>{const[s,e]=F.useState({sensoryIntegration:!1,neuroDevelopmental:!1,teachingLearning:!1}),t=n=>{e(a=>({...a,[n]:!a[n]}))};return r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("div",{className:"w-full",children:r.jsx("img",{src:o_,alt:"Occupational Therapy Services",className:"w-full h-auto object-cover"})}),r.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-6",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-12 text-center",children:"Occupational Therapy"}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("sensoryIntegration"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Sensory Integration"}),s.sensoryIntegration?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.sensoryIntegration&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("p",{className:"text-gray-700",children:"Sensory information provides an important foundation for learning and behavior. Sensory integration is a developmental process. Successful integration and organization of sensory information results in and is further developed by adaptive responses. The 'just right challenge' provides the milieu for sensory integration to occur. Children have an innate drive to seek meaningful experiences from their environment. Sensory integration promotes neuroplasticity. Sensory integration is a foundation for participation."})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Setting goals for intervention","Considerations for intervention","The physical environment of intervention","Therapeutic interventions related to modulation","Therapeutic interventions related to sensory discrimination","Therapeutic interventions related to bilateral integration and sequencing","Therapeutic interventions related to promoting praxis"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Key sensory integrative abilities (Sensory modulation)"}),r.jsx("ul",{className:"space-y-2",children:["Sensory discrimination","Postural-ocular control","Praxis","Bilateral integration and sequencing"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Outcomes of adequate sensory integration"}),r.jsx("ul",{className:"space-y-2",children:["Sensory discrimination","Postural-ocular control","Praxis","Bilateral integration and sequencing","Modulation, discrimination, and integration of sensory information","Self-Regulation","Postural control and bilateral motor coordination","Praxis","Organize behavior needed for developmentally appropriate tasks and activities","Self-esteem","Participation in self-care, leisure, and academic and social activities"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))}),r.jsxs("div",{className:"mt-3",children:[r.jsx("h4",{className:"font-medium text-gray-800",children:"Populations for whom this frame of reference is used"}),r.jsx("p",{className:"text-gray-700",children:"Children with sensory processing disorders, autism spectrum disorder, and other developmental conditions."})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Record review","Identifying patterns of dysfunction","Communication with parents, care providers, and teachers"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Sensory modulation abilities","Sensory discrimination","Dyspraxia","Bilateral integration and sequencing dysfunction","Modulation, discrimination, and integration of sensory information","Poor visual perception and visual motor integration (visuodyspraxia)"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("neuroDevelopmental"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Neuro-Developmental Treatment"}),s.neuroDevelopmental?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.neuroDevelopmental&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Development of reach and grasp","Kinesiological and biomechanical concepts","Movement dysfunction"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Range of movement and dissociation of movement","Alignment and patterns of weight bearing","Muscle tone","Postural tone","Balance and postural control","Coordination"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Overall assessment of functional skills","Evaluation of posture and movement","Handling techniques","Qualities of touch","Preparation, facilitation, and inhibition","Learning the process of therapeutic handling","Integration of neuro-developmental treatment into activity","Positioning and adaptive equipment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("teachingLearning"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Teaching - Learning"}),s.teachingLearning?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.teachingLearning&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["The four-quadrant model of facilitated learning","Task specification","Decision making","Key points","Autonomy"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Does the child know what to do and how to do it?","Is the child making astute decisions about their performance?","Is the child aware of errors?","Is the child recalling the steps of the task and other key features of performance?","Are there any signs of self-prompting?"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Mental imagery to complete a task","Self-instruction to complete a task","Successfully uses self-monitoring to complete a task","Successfully uses self-instruction to complete a task","Successfully problem solves to complete a task","Successfully uses automaticity to complete a task"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Task"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("childhoodOccupations"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Childhood Occupations"}),s.childhoodOccupations?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.childhoodOccupations&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Synthesis of child, occupational, performance, and environment - in time"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["The childenvironmentoccupation fit","Work and productivity","Play and leisure","Activities of daily living","Rest and sleep","Occupational patterns"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Work and productivity","Play and leisure","Activities of daily living and self-care","Rest and sleep"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Evaluating occupational performance in time","Evaluating the environment","Evaluation synthesis"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("socialParticipation"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference to Enhance Social Participation"}),s.socialParticipation?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.socialParticipation&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Interaction between caregivers and children","Interaction between caregivers and children with disabilities","Developing habits and routines","Developing habits and routines for children with disabilities","Social participation with peers","Children with disabilities: social participation with peers"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Temperament","Habits and routines","Environment","Peer Interaction"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Assessing caregivers' needs for support in increasing children's social participation","Assessment of children's social participation"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Consulting with caregivers","Role modeling","Activity-based intervention when parents are ill","Promoting social participation in classroom settings","Promoting effortful control in inclusive settings","Occupation-based groups to increase children's social participation with peers","Structuring an activity group","Choosing activities","Dealing with activity group process","Grading the amount of frustration","Aggressive behavior","Group resistance","Culture, beliefs, and values","Termination"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("visualPerception"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Visual Perception"}),s.visualPerception?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.visualPerception&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Visual perception is a developmental process","Visual perceptual processing is learned and increases with development, experience, and practice, and through stimulation from the environment","Children can learn by interacting with and observing adults and other children","Learning does not necessarily follow a developmental sequence. A deficit in one area does not predict a deficit or problem in another area","Difficulty with visual perception can interfere with daily occupations including the development of reading and writing skills"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Visual reception skills","Visual attention","Visual memory","Visual discrimination","Visual spatial","Visual motor integration"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Visual spatial assessment","Visual motor integration assessments"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Input: environmental adaptations","Processing: remediation of visual reception","Processing: remediation of visual cognition","Processing: visual reception strategies","Processing: visual cognition: strategies","Processing: environmental adaptations for visual reception","Visual cognition: environmental adaptations","Output: remediation of performance skills","Output: strategies for performance","Output: strategies for occupation"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("motorSkillAcquisition"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Motor Skill Acquisition"}),s.motorSkillAcquisition?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.motorSkillAcquisition&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Motor control, motor learning, and motor development","Dynamic systems","Learning","Concepts","Child-task-environment match"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Motor task","Child's environment","Task requirements","Child-task-environment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Child","Task","Environment"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Occupational therapy evaluation","Observation of task performance","Art project","Goals and objectives","Intervention","Physical education"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]}),r.jsxs("div",{className:"mb-8 p-4 border border-black rounded-lg",children:[r.jsxs("div",{className:"p-4 rounded-lg cursor-pointer flex justify-between items-center",onClick:()=>t("handwritingSkills"),children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"A Frame of Reference for Development of Handwriting Skills"}),s.handwritingSkills?r.jsx(Ni,{className:"h-6 w-6 text-gray-700"}):r.jsx(Si,{className:"h-6 w-6 text-gray-700"})]}),s.handwritingSkills&&r.jsxs("div",{className:"mt-4 space-y-6 pl-4",children:[r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Theoretical Base"}),r.jsx("ul",{className:"space-y-2",children:["Multiple intelligences","Discrete motor skill learning","Optimal challenge point","Teaching writing"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Function - Dysfunction"}),r.jsx("ul",{className:"space-y-2",children:["Writing posture","Components","Use of writing tools","Grasp","Writing legibility"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Guide to evaluation"}),r.jsx("ul",{className:"space-y-2",children:["Handwriting legibility","Speed","Tool use","Functional visual skills","Sensory processing","Attentional issues","Learning issues"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-200 via-red-100 to-red-50 p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-3",children:"Application to practice"}),r.jsx("ul",{className:"space-y-2",children:["Peer Support","Working in a first-grade classroom"].map((n,a)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-blue-600 mr-2 mt-1",children:""}),r.jsx("span",{children:n})]},a))})]})]})]})]})]})};function cg(){const{pathname:s}=Bo();return F.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[s]),null}const u_="/assets/1-BnObsZdc.jpg",d_="/assets/1-Dk8_KL0H.webp",h_="/assets/10-BORUD9dj.jpg",p_="/assets/10-COYl8Mhq.webp",f_="/assets/11-CCckIIW-.jpg",m_="/assets/2-BbOEF5Ga.webp",g_="/assets/12-34CelbTB.jpg",x_="/assets/4-DSRfeNda.webp",b_="/assets/13-BaeuX0ch.jpg",y_="/assets/13-so1HyMkM.webp",v_="/assets/14-DPj1jJV-.jpg",w_="/assets/14-BfYDixVq.webp",N_="/assets/15-DHawZezg.jpg",S_="/assets/3-CtIKDcst.webp",C_="/assets/16-Co49rxoY.jpg",j_="/assets/5-DsqII3x1.webp",k_="/assets/17-Cfi-Xb7L.jpg",T_="/assets/17-DlehBD01.webp",I_="/assets/18-DyDzeeDR.jpg",$_="/assets/18-B89a2rbx.webp",A_="/assets/19-B4Q31Kas.jpg",E_="/assets/19-QZMTzkj0.webp",D_="/assets/2-Dj2uXSjN.jpg",R_="/assets/2-CIFyAhB1.webp",O_="/assets/20-C5UuCsBs.jpg",__="/assets/20-0cznj--u.webp",F_="/assets/21-AbRnxVWf.jpg",L_="/assets/21-BWcHhFZi.webp",M_="/assets/22-Dta48Zjp.jpg",P_="/assets/22-DGuwWV2R.webp",z_="/assets/23-DhdRUjg5.jpg",B_="/assets/6-BooEANJA.webp",V_="/assets/24-DvzlpkLl.jpg",U_="/assets/8-eZFu9_Tx.webp",G_="/assets/25-Duv5HZch.jpg",W_="/assets/25-0RkCRcmP.webp",H_="/assets/27-DJnoPXI3.jpg",q_="/assets/10-DqLecErO.webp",K_="/assets/28-Dk36ViFM.jpg",X_="/assets/28-GPewWCEI.webp",Y_="/assets/29-BDsaM0LA.jpg",Z_="/assets/29-CkTdcWtX.webp",Q_="/assets/3-DeKO4UAy.jpg",J_="/assets/3-uLQFB36t.webp",eF="/assets/30-CM9sH4X5.jpg",tF="/assets/12-SVTMo18I.webp",sF="/assets/31-MFIVDfAp.jpg",nF="/assets/31-fHD-OeFU.webp",aF="/assets/33-DLRk4PLZ.jpg",rF="/assets/13-eCfY0g4f.webp",oF="/assets/34-CHOAIYCO.jpg",iF="/assets/34-B6rH58y9.webp",lF="/assets/35-DJbHNH3R.jpg",cF="/assets/35-v3A2ZKOc.webp",uF="/assets/36-D8pmJiOf.jpg",dF="/assets/36-ByC1vep0.webp",hF="/assets/37-DHeEwHkZ.jpg",pF="/assets/37-C7h4_WDA.webp",fF="/assets/38-BF3mBDg-.jpg",mF="/assets/38-DrzRUi2s.webp",gF="/assets/39-BBR4r84O.jpg",xF="/assets/39-Duz9rRN3.webp",bF="/assets/4-xFHRrwbz.jpg",yF="/assets/4-yWczx5hH.webp",vF="/assets/40-76X0Y0Cr.jpg",wF="/assets/40-BG3nv_OJ.webp",NF="/assets/41-DSSwvMdL.jpg",SF="/assets/41-ixrKDlZc.webp",CF="/assets/5-BDlkQ2IY.jpg",jF="/assets/5-BSBTyMKF.webp",kF="/assets/6-DKaCt2LG.jpg",TF="/assets/1-BFB0Wtqm.webp",IF="/assets/7-BzYobvqI.jpg",$F="/assets/7-UUdBpdJc.webp",AF="/assets/8-B3mE6iWv.jpg",EF="/assets/8-BNP8_4fl.webp",DF="/assets/9-BlBmzaoO.jpg",RF="/assets/9-B_0LmLov.webp",OF=()=>{const e=Object.entries(Object.assign({"/src/assets/Media/PhotoGallery/1.jpg":u_,"/src/assets/Media/PhotoGallery/1.webp":d_,"/src/assets/Media/PhotoGallery/10.jpg":h_,"/src/assets/Media/PhotoGallery/10.webp":p_,"/src/assets/Media/PhotoGallery/11.jpg":f_,"/src/assets/Media/PhotoGallery/11.webp":m_,"/src/assets/Media/PhotoGallery/12.jpg":g_,"/src/assets/Media/PhotoGallery/12.webp":x_,"/src/assets/Media/PhotoGallery/13.jpg":b_,"/src/assets/Media/PhotoGallery/13.webp":y_,"/src/assets/Media/PhotoGallery/14.jpg":v_,"/src/assets/Media/PhotoGallery/14.webp":w_,"/src/assets/Media/PhotoGallery/15.jpg":N_,"/src/assets/Media/PhotoGallery/15.webp":S_,"/src/assets/Media/PhotoGallery/16.jpg":C_,"/src/assets/Media/PhotoGallery/16.webp":j_,"/src/assets/Media/PhotoGallery/17.jpg":k_,"/src/assets/Media/PhotoGallery/17.webp":T_,"/src/assets/Media/PhotoGallery/18.jpg":I_,"/src/assets/Media/PhotoGallery/18.webp":$_,"/src/assets/Media/PhotoGallery/19.jpg":A_,"/src/assets/Media/PhotoGallery/19.webp":E_,"/src/assets/Media/PhotoGallery/2.jpg":D_,"/src/assets/Media/PhotoGallery/2.webp":R_,"/src/assets/Media/PhotoGallery/20.jpg":O_,"/src/assets/Media/PhotoGallery/20.webp":__,"/src/assets/Media/PhotoGallery/21.jpg":F_,"/src/assets/Media/PhotoGallery/21.webp":L_,"/src/assets/Media/PhotoGallery/22.jpg":M_,"/src/assets/Media/PhotoGallery/22.webp":P_,"/src/assets/Media/PhotoGallery/23.jpg":z_,"/src/assets/Media/PhotoGallery/23.webp":B_,"/src/assets/Media/PhotoGallery/24.jpg":V_,"/src/assets/Media/PhotoGallery/24.webp":U_,"/src/assets/Media/PhotoGallery/25.jpg":G_,"/src/assets/Media/PhotoGallery/25.webp":W_,"/src/assets/Media/PhotoGallery/27.jpg":H_,"/src/assets/Media/PhotoGallery/27.webp":q_,"/src/assets/Media/PhotoGallery/28.jpg":K_,"/src/assets/Media/PhotoGallery/28.webp":X_,"/src/assets/Media/PhotoGallery/29.jpg":Y_,"/src/assets/Media/PhotoGallery/29.webp":Z_,"/src/assets/Media/PhotoGallery/3.jpg":Q_,"/src/assets/Media/PhotoGallery/3.webp":J_,"/src/assets/Media/PhotoGallery/30.jpg":eF,"/src/assets/Media/PhotoGallery/30.webp":tF,"/src/assets/Media/PhotoGallery/31.jpg":sF,"/src/assets/Media/PhotoGallery/31.webp":nF,"/src/assets/Media/PhotoGallery/33.jpg":aF,"/src/assets/Media/PhotoGallery/33.webp":rF,"/src/assets/Media/PhotoGallery/34.jpg":oF,"/src/assets/Media/PhotoGallery/34.webp":iF,"/src/assets/Media/PhotoGallery/35.jpg":lF,"/src/assets/Media/PhotoGallery/35.webp":cF,"/src/assets/Media/PhotoGallery/36.jpg":uF,"/src/assets/Media/PhotoGallery/36.webp":dF,"/src/assets/Media/PhotoGallery/37.jpg":hF,"/src/assets/Media/PhotoGallery/37.webp":pF,"/src/assets/Media/PhotoGallery/38.jpg":fF,"/src/assets/Media/PhotoGallery/38.webp":mF,"/src/assets/Media/PhotoGallery/39.jpg":gF,"/src/assets/Media/PhotoGallery/39.webp":xF,"/src/assets/Media/PhotoGallery/4.jpg":bF,"/src/assets/Media/PhotoGallery/4.webp":yF,"/src/assets/Media/PhotoGallery/40.jpg":vF,"/src/assets/Media/PhotoGallery/40.webp":wF,"/src/assets/Media/PhotoGallery/41.jpg":NF,"/src/assets/Media/PhotoGallery/41.webp":SF,"/src/assets/Media/PhotoGallery/5.jpg":CF,"/src/assets/Media/PhotoGallery/5.webp":jF,"/src/assets/Media/PhotoGallery/6.jpg":kF,"/src/assets/Media/PhotoGallery/6.webp":TF,"/src/assets/Media/PhotoGallery/7.jpg":IF,"/src/assets/Media/PhotoGallery/7.webp":$F,"/src/assets/Media/PhotoGallery/8.jpg":AF,"/src/assets/Media/PhotoGallery/8.webp":EF,"/src/assets/Media/PhotoGallery/9.jpg":DF,"/src/assets/Media/PhotoGallery/9.webp":RF})).map(([p,f],g)=>({id:g+1,src:f,alt:"Gallery Image ".concat(g+1," at Total Solution Rehabilitation Center")})),[t,n]=F.useState(!1),[a,o]=F.useState(0),i=p=>{o(p),n(!0),document.body.style.overflow="hidden"},c=()=>{n(!1),document.body.style.overflow="auto"},u=()=>{o(p=>p===0?e.length-1:p-1)},h=()=>{o(p=>p===e.length-1?0:p+1)};return r.jsxs("div",{className:"bg-gray-50",children:[r.jsxs("picture",{children:[r.jsx("source",{srcSet:"/src/assets/Media/gallery.webp",type:"image/webp"}),r.jsx("img",{src:"/src/assets/Media/gallery.webp",alt:"Photo Gallery at Total Solution Rehabilitation Center",width:1920,height:1080,loading:"eager",decoding:"sync",className:"w-full h-auto object-cover"})]}),r.jsx("section",{className:"py-16 px-4",children:r.jsxs("div",{className:"container mx-auto",children:[r.jsx("div",{className:"text-center mb-12",children:r.jsx("h3",{className:"text-4xl font-semibold text-gray-800",children:"Photo Gallery"})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map((p,f)=>r.jsx("div",{className:"overflow-hidden rounded-sm shadow-md hover:shadow-lg transition-shadow cursor-pointer group",onClick:()=>i(f),children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:p.src,type:"image/webp"}),r.jsx("img",{src:p.src,alt:p.alt,width:400,height:300,loading:"lazy",decoding:"async",className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"})]})},p.id))})]})}),t&&r.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:[r.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-white text-2xl hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition-colors","aria-label":"Close lightbox",children:r.jsx(_5,{size:28})}),r.jsx("button",{onClick:u,className:"absolute left-4 text-white text-2xl p-2 bg-black bg-opacity-50 rounded-full hover:bg-opacity-70 transition-colors","aria-label":"Previous image",children:r.jsx(D5,{size:28})}),r.jsx("div",{className:"max-w-4xl w-full max-h-screen overflow-auto",children:r.jsxs("picture",{children:[r.jsx("source",{srcSet:e[a].src,type:"image/webp"}),r.jsx("img",{src:e[a].src,alt:e[a].alt,width:1200,height:800,loading:"eager",decoding:"sync",className:"w-full h-auto object-contain"})]})}),r.jsx("button",{onClick:h,className:"absolute right-4 text-white text-2xl p-2 bg-black bg-opacity-50 rounded-full hover:bg-opacity-70 transition-colors","aria-label":"Next image",children:r.jsx(R5,{size:28})})]})]})},_F="/assets/gallery-5IfLcuL0.webp",FF=[{id:"GrkeZkOjs-4",title:"Video 1"},{id:"Ne8oS3u34cY",title:"Video 2"},{id:"Hl8z80_BEQg",title:"Video 3"},{id:"Q8k4hzBiQ4w",title:"Video 4"},{id:"d--p09oAb5A",title:"Video 5"},{id:"zKEbq4bqR4M",title:"Video 6"},{id:"Ao3RXWVAV0c",title:"Video 7"},{id:"xzJP-e2m3Rc",title:"Video 8"},{id:"HfOHGoqIhWg",title:"Video 9"},{id:"uhgrlzrbb10",title:"Video 10"},{id:"FOClRNk6-x4",title:"Video 11"},{id:"P5ohKGszqVI",title:"Video 12"},{id:"RO2UzZmopyI",title:"Video 13"},{id:"Hkffa2ve9i4",title:"Video 14"}],LF=()=>{const[s,e]=F.useState(null);return r.jsxs("div",{className:"bg-gray-50",children:[r.jsx("img",{src:_F,alt:"Video Gallery",className:"w-full object-cover"}),r.jsx("section",{className:"py-16 px-4",children:r.jsxs("div",{className:"container mx-auto",children:[r.jsx("div",{className:"text-center mb-12",children:r.jsx("h3",{className:"text-4xl font-semibold text-gray-800",children:"Videos Gallery"})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:FF.map((t,n)=>r.jsx("div",{className:"relative overflow-hidden rounded-sm shadow-md hover:shadow-lg transition-transform hover:scale-[1.02] cursor-pointer",onClick:()=>e(n),children:r.jsx("div",{className:"relative aspect-video bg-black",children:s===n?r.jsx("iframe",{src:"https://www.youtube.com/embed/".concat(t.id,"?autoplay=1"),title:t.title,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:"https://img.youtube.com/vi/".concat(t.id,"/hqdefault.jpg"),alt:t.title,className:"w-full h-full object-cover",loading:"lazy"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("div",{className:"bg-white bg-opacity-80 rounded-full p-4",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-600",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})})]})})},t.id))})]})})]})},MF=()=>{const s=Ml(e=>e.auth.isAuthenticated);return r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-red-50 flex items-center justify-center px-4",children:r.jsxs("div",{className:"max-w-3xl w-full text-center",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("div",{className:"relative inline-block",children:[r.jsx("span",{className:"text-9xl font-extrabold text-[#ab1c1c] opacity-20",children:"403"}),r.jsx("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-32 w-32 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m0 0v3m0-3h2m-2 0H9m3-3V8m0 0L9 4m6 4l-3-4m-3 4h6"})})]})}),r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Access Forbidden"}),r.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Sorry, you don't have permission to access this page or resource."}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-3",children:"This could be because:"}),r.jsxs("ul",{className:"space-y-2 text-left max-w-md mx-auto",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("span",{className:"text-gray-700",children:"You need to log in to access this content"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})})}),r.jsx("span",{className:"text-gray-700",children:"Your account doesn't have the required permissions"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}),r.jsx("span",{className:"text-gray-700",children:"The content is restricted for security reasons"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-gray-700",children:"There may be an issue with your account status"})]})]})]})}),r.jsx("div",{className:"mt-8 flex flex-wrap justify-center gap-4",children:r.jsxs(ot,{to:s?"/".concat(sessionStorage.getItem("role"),"dashboard"):"/",className:"bg-[#ab1c1c] text-white px-6 py-3 rounded-md font-medium hover:bg-[#8e1818] transition duration-300 inline-flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Return to ",s?"Dashboard":"Homepage"]})})]})})},ta=({children:s,requiredRole:e})=>{const t=sessionStorage.getItem("token");if(!t)return r.jsx(Eo,{to:"/login",replace:!0});try{const a=Cr(t).user.role;if(e&&!e.includes(a))return r.jsx(MF,{})}catch(n){return console.error("Invalid token:",n),r.jsx(Eo,{to:"/login",replace:!0})}return s},Gs=()=>r.jsx("div",{className:"flex justify-center items-center",children:r.jsx("div",{className:"w-12 h-12 mt-6 border-4 border-red-800 border-dotted rounded-full animate-spin"})});function PF(){const s=Th(),[e,t]=F.useState({mobilenumber:"",password:""}),[n,a]=F.useState(!1),[o,i]=F.useState(!1),c=xs(),u=p=>{const{name:f,value:g}=p.target;t({...e,[f]:g})},h=async p=>{p.preventDefault(),a(!0);try{const f=await Pe.post("/api/users/login",e);f.data.success?(sessionStorage.setItem("token",f.data.token),sessionStorage.setItem("role",f.data.role),sessionStorage.setItem("".concat(f.data.role,"Id"),Cr(f.data.token).user._id),s(Dj({token:f.data.token,role:f.data.role,details:Cr(f.data.token).user})),Ve.success("Login Successful",{autoClose:2e3}),c("/".concat(f.data.role,"dashboard"))):(a(!1),Ve.error("Could not find account with this mobile number",{autoClose:2e3}))}catch(f){a(!1),Ve.error("Invalid Credentials",{autoClose:2e3})}};return r.jsxs("div",{className:"px-4 min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[r.jsxs(Dy,{children:[r.jsx("title",{children:"Login | Total Solution for Learning"}),r.jsx("meta",{name:"robots",content:"noindex, nofollow"}),r.jsx("meta",{name:"description",content:"Login to access your personalized therapy and learning dashboard at Total Solution for Learning."}),r.jsx("link",{rel:"canonical",href:"https://totalsolutionforlearning.org/login"}),r.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"WebPage",name:"Login",url:"https://totalsolutionforlearning.org/login"})}})]}),r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx(ao,{}),r.jsxs("div",{className:"w-full max-w-lg p-8 space-y-6 bg-white rounded-xl shadow-lg border border-gray-200",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c]",children:"Welcome Back"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Sign in to your account"})]}),r.jsxs("form",{className:"space-y-6",onSubmit:h,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"mobilenumber",className:"block text-base font-medium text-gray-700",children:"Mobile Number"}),r.jsx("input",{id:"mobilenumber",name:"mobilenumber",type:"number",required:!0,className:"relative block w-full px-4 py-2 mt-1 text-base text-gray-900 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition-all duration-200",placeholder:"Enter your mobile number",value:e.mobilenumber,onChange:u,pattern:"[0-9]{10}",title:"Please enter a valid 10-digit mobile number",maxLength:"10"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-base font-medium text-gray-700",children:"Password"}),r.jsxs("div",{className:"relative mt-1",children:[r.jsx("input",{id:"password",name:"password",type:o?"text":"password",required:!0,className:"block w-full px-4 py-2 text-base text-gray-900 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition-all duration-200",placeholder:"Enter your password",value:e.password,onChange:u}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4",children:r.jsx("button",{type:"button",className:"text-gray-500 hover:text-[#ab1c1c] focus:outline-none transition-colors duration-200",onClick:()=>i(!o),children:o?"Hide":"Show"})})]})]})]}),r.jsx("div",{children:n?r.jsx(Gs,{}):r.jsx("button",{type:"submit",className:"relative flex justify-center w-full px-4 py-3 text-base font-medium text-white bg-[#ab1c1c] border border-transparent rounded-lg group hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c] transition-all duration-200 shadow-md hover:shadow-lg",children:"Sign in"})}),r.jsxs("div",{className:"text-center font-medium text-gray-600",children:["Don't have an account?"," ",r.jsx(ot,{to:"/register",className:"text-[#ab1c1c] hover:text-[#8e1818] hover:underline transition-colors duration-200",children:"Sign up"})]})]})]})]})]})}const zF=()=>{const s=Ml(e=>e.auth.isAuthenticated);return r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-red-50 flex items-center justify-center px-4",children:r.jsxs("div",{className:"max-w-3xl w-full text-center",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("div",{className:"relative inline-block",children:[r.jsx("span",{className:"text-9xl font-extrabold text-[#ab1c1c] opacity-20",children:"404"}),r.jsx("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-32 w-32 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Page Not Found"}),r.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"We're sorry, the page you're looking for doesn't exist or has been moved."}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-3",children:"You might want to:"}),r.jsxs("ul",{className:"space-y-2 text-left max-w-md mx-auto",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Double check the URL for typos"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Go back to the previous page"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"h-6 w-6 rounded-full bg-red-100 text-[#ab1c1c] flex items-center justify-center mr-2 flex-shrink-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:"text-gray-700",children:"Visit our homepage to start fresh"})]})]})]})}),r.jsx("div",{className:"mt-8",children:r.jsxs(ot,{to:s?"/".concat(sessionStorage.getItem("role"),"dashboard"):"/",className:"bg-[#ab1c1c] text-white px-6 py-3 rounded-md font-medium hover:bg-[#8e1818] transition duration-300 inline-flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Return to ",s?"Dashboard":"Homepage"]})})]})})};function BF(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState([]),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(""),[f,g]=F.useState("all"),[b,y]=F.useState(1),[w,v]=F.useState(10),N={"administrative-not-joined-after-registration":"Not joined after registration","administrative-services-on-hold":"Services on hold","administrative-timing-not-suitable":"Timing not suitable","academic-school-schedule-conflict":"School schedule conflict","academic-exam-period":"Exam period","health-medical-reasons":"Medical reasons","health-therapy-paused":"Therapy paused","health-weaning-off":"Weaning-off phase","health-under-observation":"Under observation",other:"Other"};F.useEffect(()=>{(async()=>{try{i(!0);const G=sessionStorage.getItem("token");if(!G)throw new Error("Authentication token not found");const Y=Cr(G);sessionStorage.setItem("centreId",Y.user.centreId);const J=(await Pe.get("/api/data/allChildren/".concat(Y.user.centreId),{headers:{Authorization:G}})).data.map(xe=>{const ye=Array.isArray(xe.therapies)&&xe.therapies.length>0;return xe});t(J),a(J),i(!1)}catch(G){const Y=G.response?"Error: ".concat(G.response.status," - ").concat(G.response.statusText):G.message;u(Y),i(!1)}})()},[]),F.useEffect(()=>{C(),y(1)},[h,f,e]);const C=()=>{let B=[...e];if(f!=="all"&&(B=B.filter(G=>G.admitStatus===f||G.admitStatus.startsWith(f))),h){const G=h.toLowerCase();B=B.filter(Y=>Y.name.toLowerCase().includes(G)||Y.parentName&&Y.parentName.toLowerCase().includes(G)||Y.schoolName&&Y.schoolName.toLowerCase().includes(G))}a(B)},T=b*w,I=T-w,$=n.slice(I,T),R=B=>y(B),O=[];for(let B=1;B<=Math.ceil(n.length/w);B++)O.push(B);const P=B=>{s("/admindashboard/child/".concat(B._id),{state:{childData:B}})},_=B=>{p(B.target.value)},M=B=>{g(B.target.value)},A=B=>{v(Number(B.target.value)),y(1)},U=({status:B})=>{const G=()=>B?B==="active"?{label:"Active",styles:"bg-green-100 text-green-800 border-green-200"}:B==="pending"?{label:"Pending",styles:"bg-yellow-100 text-yellow-800 border-yellow-200"}:B==="inactive"||B.startsWith("inactive-")?{label:"Inactive",styles:"bg-red-100 text-red-800 border-red-200"}:{label:"Unknown",styles:"bg-gray-100 text-gray-800 border-gray-200"}:{label:"Pending",styles:"bg-yellow-100 text-yellow-800 border-yellow-200"},{label:Y,styles:Z}=G();return r.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(Z),children:Y})},K=B=>{const G=new Date,Y=new Date(B);let Z=G.getFullYear()-Y.getFullYear();const J=G.getMonth()-Y.getMonth();return(J<0||J===0&&G.getDate()<Y.getDate())&&Z--,Z},Q=B=>new Date(B).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),X=(B,G)=>{B.stopPropagation(),s("/admindashboard/iepreports/".concat(G._id))};return o?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):c?r.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:[r.jsx("p",{children:c}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-[#ab1c1c] text-white rounded hover:bg-[#8e1818]",onClick:()=>window.location.reload(),children:"Retry"})]}):r.jsxs("div",{className:"p-6 mb-16  min-h-screen",children:[r.jsx("div",{className:"justify-between items-center mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] ps-3",children:"Children"})}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 mb-6 border border-gray-200",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),r.jsx("input",{type:"text",id:"search",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",placeholder:"Search by name, parent name, or school...",value:h,onChange:_})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"statusFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Filter"}),r.jsxs("select",{id:"statusFilter",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",value:f,onChange:M,children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"}),r.jsx("option",{value:"pending",children:"Pending"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"itemsPerPage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Items per Page"}),r.jsxs("select",{id:"itemsPerPage",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",value:w,onChange:A,children:[r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"}),r.jsx("option",{value:100,children:"100"})]})]})]}),r.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Showing ",n.length===0?0:I+1,"-",Math.min(T,n.length)," of"," ",n.length," records"]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border border-gray-200",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c]",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Age/Gender"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"School Info"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Added On"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$&&$.length>0?$.map(B=>r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>P(B),children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"\n                            text-sm \n                            font-medium \n                            text-gray-900\n                            inline-block\n                          ",children:B.name})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[K(B.dob)," years"]}),r.jsx("div",{className:"text-sm text-gray-500",children:B.gender})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:B.schoolName||"Not enrolled"}),r.jsx("div",{className:"text-sm text-gray-500",children:B.schoolBoard||"N/A"})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx(U,{status:B.admitStatus}),B.admitStatus==="inactive"&&B.inactiveReason&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N[B.inactiveReason]||"Inactive"})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:Q(B.createdAt)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600 transition-colors",onClick:G=>X(G,B),children:"View IEP Reports"})})]},B._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No matching records found"})})})]})}),O.length>0&&r.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",b," of ",O.length]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>R(b-1),disabled:b===1,className:"px-4 py-2 border rounded-md bg-white text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),O.map(B=>r.jsx("button",{onClick:()=>R(B),className:"px-4 py-2 border rounded-md ".concat(b===B?"bg-[#ab1c1c] text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:B},B)),r.jsx("button",{onClick:()=>R(b+1),disabled:b===O.length,className:"px-4 py-2 border rounded-md bg-white text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})}const VF=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]},UF=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,GF=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+14),e.toISOString().split("T")[0]};function WF(){const s=xs(),e=Bo(),n=F.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("childId"),[a,o]=F.useState(!1),[i,c]=F.useState({childName:"",childAge:"",parentName:"",parentId:null,email:"",dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),[u,h]=F.useState([]),[p,f]=F.useState([]),[g,b]=F.useState([]),[y,w]=F.useState([]),[v,N]=F.useState([]),[C,T]=F.useState(null),[I,$]=F.useState(!1),[R,O]=F.useState(null),[P,_]=F.useState(!1),[M,A]=F.useState(10),[U,K]=F.useState("morning"),[Q,X]=F.useState(""),[B,G]=F.useState(!1),[Y,Z]=F.useState("");F.useEffect(()=>{if(P){const oe=setInterval(()=>{A(Ie=>Ie<=1?(clearInterval(oe),s(-1),0):Ie-1)},1e3);return()=>clearInterval(oe)}},[P,s]);const J=(oe,Ie)=>{c(Be=>({...Be,[oe]:Ie}))},xe=async()=>{try{const oe=await Pe.get("/api/data/alldoctors",{headers:{Authorization:sessionStorage.getItem("token")}});h(oe.data)}catch(oe){Ve.error("Error fetching doctors"),console.error("Error fetching doctors:",oe)}};F.useEffect(()=>{(async()=>{if(n){$(!0);try{const Be=(await Pe.get("/api/data/parent/".concat(n),{headers:{Authorization:sessionStorage.getItem("token")}})).data;let We="";if(Be.dob){const Ke=new Date(Be.dob),be=new Date;We=be.getFullYear()-Ke.getFullYear();const ue=be.getMonth()-Ke.getMonth();(ue<0||ue===0&&be.getDate()<Ke.getDate())&&We--}if(c(Ke=>({...Ke,childName:Be.name||"",childAge:We.toString(),dob:Be.dob?new Date(Be.dob).toISOString().split("T")[0]:"",gender:Be.gender||"",schoolName:Be.schoolName||"",classGrade:Be.classGrade||"",schoolBoard:Be.schoolBoard||"",parentId:Be.parentId||null})),Be.parentId){const be=(await Pe.get("/api/data/allUsers/".concat(Be.parentId),{headers:{Authorization:sessionStorage.getItem("token")}})).data;c(ue=>({...ue,parentName:be.name||"",parentPhoneNo:be.mobilenumber||"",address:be.address||"",alternativeNumber:be.mobilenumber||""}))}}catch(Ie){Ve.error("Failed to fetch child or parent details")}finally{$(!1)}}})()},[n]),F.useEffect(()=>{const oe=async()=>{try{const We=sessionStorage.getItem("centreId"),Ke=await Pe.get("/api/data/alldoctors/".concat(We),{headers:{Authorization:sessionStorage.getItem("token")}});f(Ke.data.doctors)}catch(We){console.error("Error fetching centres:",We),Ve.error("Error fetching centres")}};xe(),oe();const Ie=new Date;Ie.setDate(Ie.getDate()+1);const Be=Ie.toISOString().split("T")[0];J("appointmentDate",Be)},[]),F.useEffect(()=>{if(i.doctorId&&i.doctorId.trim()!==""){const oe=u.find(Ie=>Ie._id===i.doctorId);oe&&oe.centreIds?b(oe.centreIds):b([])}else b([])},[i.doctorId,u]),F.useEffect(()=>{(async()=>{if(i.doctorId&&i.appointmentDate&&i.consultationType&&i.branch)try{const Ie=await Pe.get("/api/admins/getAvailableSlots/".concat(i.branch,"/").concat(i.doctorId,"/").concat(i.appointmentDate,"/").concat(i.consultationType),{headers:{Authorization:sessionStorage.getItem("token")}}),Be=Ie.data.availableSlots||[];if(Ie.data.isHoliday){G(!0),Z(Ie.data.holidayName),X(""),w([]),N([]);return}if(Ie.data.message){G(!1),Z(""),X(Ie.data.message),w([]),N([]);return}G(!1),Z("");const We=Be.map(Ke=>{const be=parseInt(Ke.split(":")[0]),ue=Ke.includes("AM")&&be<12?"morning":"afternoon";return{time:Ke,period:ue}});w(We),N([]),X("")}catch(Ie){console.error("Error fetching slots:",Ie),Ve.error("Error fetching available slots"),X(""),w([{time:"10:30 AM",period:"morning"},{time:"11:30 AM",period:"morning"},{time:"12:30 PM",period:"afternoon"},{time:"2:00 PM",period:"afternoon"},{time:"3:00 PM",period:"afternoon"},{time:"3:30 PM",period:"afternoon"},{time:"4:30 PM",period:"afternoon"},{time:"5:30 PM",period:"afternoon"}])}else w([]),N([]),X("")})()},[i.doctorId,i.appointmentDate,i.consultationType,i.branch]);const ye=async oe=>{var Ie,Be,We;oe.preventDefault(),o(!0);try{const Ke=new FormData;Object.entries(i).forEach(([He,rt])=>Ke.append(He,rt)),C&&Ke.append("pdf",C),Ke.append("centreId",sessionStorage.getItem("centreId")),i.parentId&&Ke.append("parentId",i.parentId),await Pe.post("/api/admins/bookAppointment",Ke,{headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"multipart/form-data"}});const be=new Ry;be.setFontSize(18),be.text("Appointment Details",10,10),be.setFontSize(12),be.text("Child Name: ".concat(i.childName),10,20),be.text("Child Age: ".concat(i.childAge),10,30),be.text("Parent Name: ".concat(i.parentName),10,40),be.text("Parent Phone Number: ".concat(i.parentPhoneNo),10,60),be.text("Appointment Date: ".concat(i.appointmentDate),10,70),be.text("Time: ".concat(i.time),10,80),be.text("Doctor: ".concat(((Ie=p.find(He=>He._id===i.doctorId))==null?void 0:Ie.name)||"N/A"),10,90),be.text("Branch: ".concat(((Be=g.find(He=>He._id===i.branch))==null?void 0:Be.name)||"N/A"),10,100),be.text("Consultation Type: ".concat(i.consultationType),10,110),be.text("Child Concerns: ".concat(i.childConcerns),10,120),be.text("Address: ".concat(i.address),10,130),be.text("School Name: ".concat(i.schoolName),10,140),be.text("Class/Grade: ".concat(i.classGrade),10,150),be.text("School Board: ".concat(i.schoolBoard),10,160),be.text("Referred By: ".concat(i.referredBy),10,170);const ue=be.output("blob"),Fe=URL.createObjectURL(ue);O(Fe),Ve.success("Appointment booked successfully!"),o(!1),_(!0),A(10)}catch(Ke){Ve.error(((We=Ke.response)==null?void 0:We.data)||"Failed to book appointment. Please try again."),o(!1)}},ve=oe=>{v.includes(oe)||J("time",oe)},Re=()=>["childName","childAge","parentName","parentPhoneNo","appointmentDate","time","doctorId"].every(Ie=>i[Ie]),Ce=oe=>{const Ie=new Date,Be=new Date(oe);return Be.getDate()===Ie.getDate()&&Be.getMonth()===Ie.getMonth()&&Be.getFullYear()===Ie.getFullYear()},pe=oe=>{if(!Ce(i.appointmentDate))return!1;const Ie=new Date,Be=Ie.getHours(),We=Ie.getMinutes(),[Ke,be]=oe.split(" ");let[ue,Fe]=Ke.split(":").map(Number);return be==="PM"&&ue<12&&(ue+=12),be==="AM"&&ue===12&&(ue=0),ue<Be||ue===Be&&Fe<=We},Te=()=>y.filter(oe=>oe.period===U).filter(oe=>!v.includes(oe.time)).filter(oe=>!pe(oe.time)).map(oe=>oe.time),ee=()=>{_(!1),O(null),c({childName:"",childAge:"",parentName:"",parentId:null,email:"",dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),T(null)},he=()=>{s(-1)};return r.jsxs("div",{className:"max-width mx-auto mt-4 mb-10 py-12 px-4",children:[r.jsx(ao,{}),I?r.jsx(Gs,{}):P?r.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden w-full max-w-lg text-center p-8",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Appointment Booked Successfully!"}),r.jsxs("p",{className:"text-gray-600 mb-2",children:["You will be redirected back in ",M," seconds..."]}),r.jsx("p",{className:"text-gray-600 mb-8",children:"You can download the appointment details below."}),R&&r.jsx("div",{className:"mb-8",children:r.jsx("a",{href:R,download:"appointment_details.pdf",className:"inline-block px-6 py-3 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 w-full",children:"Download Appointment Details"})}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("button",{onClick:ee,className:"px-6 py-3 border border-red-700 text-red-700 font-medium rounded-md hover:bg-red-50 flex-1",children:"Book Another Appointment"}),r.jsx("button",{onClick:he,className:"px-6 py-3 bg-red-700 text-white font-medium rounded-md hover:bg-red-800 flex-1",children:"Back to Dashboard"})]})]})}):r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"w-full md:w-11/12 lg:w-5/6",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden",children:[r.jsx("div",{className:"bg-red-700 border-b py-4 text-center",children:r.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Book Appointment"})}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:ye,children:[r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800 pb-1",children:"Child Information"})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Child Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.childName,onChange:oe=>J("childName",oe.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.dob,onChange:oe=>{const Ie=oe.target.value;if(J("dob",Ie),Ie){const Be=new Date(Ie),We=new Date;let Ke=We.getFullYear()-Be.getFullYear();const be=We.getMonth()-Be.getMonth();(be<0||be===0&&We.getDate()<Be.getDate())&&Ke--,J("childAge",Ke.toString())}else J("childAge","")},max:new Date().toISOString().split("T")[0],required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gender",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.gender,onChange:oe=>J("gender",oe.target.value),required:!0,children:[r.jsx("option",{value:"",children:"-- Select Gender --"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Other"})]})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"Parent Information"})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Name",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.parentName,onChange:oe=>J("parentName",oe.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Phone Number",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.parentPhoneNo,onChange:oe=>J("parentPhoneNo",oe.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alternate Number"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.alternativeNumber,onChange:oe=>J("alternativeNumber",oe.target.value)})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Concerns",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",rows:"3",value:i.childConcerns,onChange:oe=>J("childConcerns",oe.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",rows:"3",value:i.address,onChange:oe=>J("address",oe.target.value)})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"School Information"})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.schoolName,onChange:oe=>J("schoolName",oe.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class/Grade"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.classGrade,onChange:oe=>J("classGrade",oe.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.schoolBoard,onChange:oe=>J("schoolBoard",oe.target.value),children:[r.jsx("option",{value:"",children:"Select School Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Camebridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referred By"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.referredBy,onChange:oe=>J("referredBy",oe.target.value)})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b border-red-800  pb-1",children:"Appointment Details"})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Appointment Date",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.appointmentDate,onChange:oe=>{const Ie=oe.target.value;if(UF(Ie)){Ve.error("Appointments cannot be scheduled on Sundays. Please select another date.");return}J("appointmentDate",Ie),J("time","")},min:VF(),max:GF(),required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Doctor",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.doctorId,onChange:oe=>{J("doctorId",oe.target.value),J("branch",""),J("time","")},required:!0,children:[r.jsx("option",{value:"",children:"-- Select a Doctor --"}),u.map(oe=>r.jsx("option",{value:oe._id,children:oe.name},oe._id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Branch",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.branch,onChange:oe=>{J("branch",oe.target.value),J("time","")},required:!0,disabled:!i.doctorId,children:[r.jsx("option",{value:"",children:"Select Branch"}),g.map(oe=>r.jsx("option",{value:oe._id,children:oe.name},oe._id))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Consultation type",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-700",value:i.consultationType,onChange:oe=>J("consultationType",oe.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select Consultation Type"}),r.jsx("option",{value:"New Consultation",children:"New Consultation Rs.700/-"}),r.jsx("option",{value:"Assessment(IQ)",children:"Assessment (IQ) Rs.6000/-"}),r.jsx("option",{value:"For IB board Assessment(IQ)",children:"For IB board Assessment (IQ) Rs.12000/-"})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Time Period"}),r.jsxs("div",{className:"flex items-center space-x-4 my-2",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-red-700",name:"timePeriod",value:"morning",checked:U==="morning",onChange:()=>{K("morning"),J("time","")}}),r.jsx("span",{className:"ml-2",children:"Morning (10:30 AM - 11:30 AM)"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-red-700",name:"timePeriod",value:"afternoon",checked:U==="afternoon",onChange:()=>{K("afternoon"),J("time","")}}),r.jsx("span",{className:"ml-2",children:"Afternoon/Evening (12:30 PM - 5:30 PM)"})]})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Available Time Slots",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:B?r.jsx("div",{className:"w-full p-6 bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-300 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-orange-800 font-bold text-lg mb-2",children:["Holiday - ",Y]}),r.jsx("p",{className:"text-orange-700",children:"No appointments can be booked on this holiday. Please select a different date."})]})}):Q?r.jsx("div",{className:"w-full p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-6 h-6 text-red-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-red-800 font-medium",children:"Center Not Operational"}),r.jsx("p",{className:"text-red-700 text-sm mt-1",children:"The selected center is not operational on this date. Please choose a different date or contact the center for more information."})]})]})}):Te().length>0?Te().map(oe=>r.jsx("button",{type:"button",className:"px-4 py-2 rounded-md ".concat(i.time===oe?"bg-red-700 text-white":"border border-red-700 text-red-800 hover:bg-red-50"),onClick:()=>ve(oe),children:oe},oe)):r.jsx("p",{className:"text-orange-600 italic",children:!i.doctorId||!i.appointmentDate?"Please select a doctor and date to see available time slots":"No time slots available for the selected period. Please try another date or time period."})}),i.appointmentDate&&Ce(i.appointmentDate)&&r.jsx("p",{className:"mt-2 text-sm text-gray-500 italic",children:"Note: Time slots for today that have already passed are not shown."})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsxs("div",{className:"font-[sans-serif] max-w-md",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload previous reports (if any)"}),r.jsx("input",{type:"file",className:"w-full text-gray-400 font-semibold text-sm bg-white border file:cursor-pointer cursor-pointer file:border-0 file:py-3 file:px-4 file:mr-4 file:bg-gray-100 file:hover:bg-gray-200 file:text-gray-500 rounded",onChange:oe=>T(oe.target.files[0]),accept:".pdf"}),r.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Only PDFs are Allowed."})]})})]}),a?r.jsx(Gs,{}):r.jsx("div",{className:"mt-6",children:r.jsx("button",{type:"submit",className:"w-full md:w-auto px-6 py-3 text-white font-medium rounded-md ".concat(Re()?"bg-red-700 hover:bg-red-800":"bg-gray-400 cursor-not-allowed"),disabled:!Re(),children:"Book Appointment"})})]})})]})})})]})}function HF(){const[s,e]=F.useState({password:"",confirmPassword:"",role:"",name:"",mobilenumber:"",profilePhoto:"",address:"",designation:"",qualification:"",rciNumber:"",childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),[t,n]=F.useState({}),[a,o]=F.useState(!1),[i,c]=F.useState(!1),[u,h]=F.useState(!1),[p,f]=F.useState(!1),[g,b]=F.useState(!1),y=T=>{const{name:I,value:$}=T.target;e({...s,[I]:$}),t[I]&&n({...t,[I]:""})},w=T=>{const I=T.target.files[0];if(I){if(I.size>5*1024*1024){Ve.error("File size should not exceed 5MB");return}e({...s,profilePhoto:I}),Ve.success("Profile photo selected successfully")}},v=()=>{const T={};return s.name.trim()||(T.name="Name is required"),s.mobilenumber?/^\d{10}$/.test(s.mobilenumber)||(T.mobilenumber="Mobile number must be 10 digits"):T.mobilenumber="Mobile number is required",s.password?s.password.length<6&&(T.password="Password must be at least 6 characters"):T.password="Password is required",s.password!==s.confirmPassword&&(T.confirmPassword="Passwords do not match"),s.role||(T.role="Role is required"),s.role==="parent"&&!s.address&&(T.address="Address is required"),s.role==="parent"&&g&&(s.childName||(T.childName="Child name is required"),s.childDob||(T.childDob="Date of birth is required"),s.childGender||(T.childGender="Gender is required")),T},N=async T=>{var I,$,R;T.preventDefault(),h(!0);try{const O=v();if(Object.keys(O).length>0){n(O),h(!1),Ve.error("Please fix the validation errors before submitting");return}const P=sessionStorage.getItem("centreId");if(!P){Ve.error("Centre ID not found in session storage"),h(!1);return}const _=new FormData;if(_.append("password",s.password),_.append("role",s.role),_.append("name",s.name),_.append("mobilenumber",s.mobilenumber),_.append("centreId",P),s.profilePhoto&&_.append("profilePhoto",s.profilePhoto),s.role==="parent"?(_.append("address",s.address),g&&_.append("childData",JSON.stringify({name:s.childName,dob:s.childDob,gender:s.childGender,schoolName:s.childSchoolName||"",schoolBoard:s.childSchoolBoard||"",centreId:P}))):s.role==="therapist"&&(_.append("designation",s.designation),_.append("qualification",s.qualification||""),_.append("rciNumber",s.rciNumber||"")),(I=(await Pe.post("/api/admins/register",_,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}})).data)!=null&&I.isExisting){Ve.warning("User already exists");return}Ve.success("Registration successful!"),f(!0)}catch(O){console.error("Registration error:",O),Ve.error(((R=($=O.response)==null?void 0:$.data)==null?void 0:R.message)||"Registration failed")}finally{h(!1)}},C=()=>s.role==="therapist"?r.jsxs("div",{className:"space-y-4 md:space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation"}),r.jsx("input",{type:"text",name:"designation",value:s.designation,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your designation (optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Qualification"}),r.jsx("input",{type:"text",name:"qualification",value:s.qualification,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your qualification (optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RCI Number"}),r.jsx("input",{type:"text",name:"rciNumber",value:s.rciNumber,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Your RCI number (optional)"})]})]}):s.role==="parent"?r.jsxs("div",{className:"space-y-4 md:space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{name:"address",value:s.address,onChange:y,className:"w-full p-2 border ".concat(t.address?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Full address",rows:"3"}),t.address&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.address})]}),r.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c]",children:"Child Information"}),r.jsx("button",{type:"button",onClick:()=>b(T=>!T),className:"text-sm text-[#ab1c1c] hover:text-[#8e1818] flex items-center",children:g?"Skip for now":"Add child"})]}),g&&r.jsxs("div",{children:[r.jsxs("div",{className:"grid grid-cols-1  md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Child's Name *"}),r.jsx("input",{type:"text",name:"childName",value:s.childName,onChange:y,className:"w-full p-2 border ".concat(t.childName?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Child's Full Name"}),t.childName&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",name:"childDob",value:s.childDob,onChange:y,className:"w-full p-2 border ".concat(t.childDob?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]")}),t.childDob&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childDob})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{name:"childGender",value:s.childGender,onChange:y,className:"w-full p-2 border ".concat(t.childGender?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white"),children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Others"})]}),t.childGender&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.childGender})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",name:"childSchoolName",value:s.childSchoolName,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"School Name (Optional)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{name:"childSchoolBoard",value:s.childSchoolBoard,onChange:y,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white",children:[r.jsx("option",{value:"",children:"Select Board (Optional)"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Cambridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})]})]})]})]})]}):null;return p?r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(cg,{}),r.jsx("div",{className:"max-w-md w-full bg-white rounded-xl shadow-xl overflow-hidden border border-red-100",children:r.jsxs("div",{className:"px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"mt-3 text-xl font-medium text-gray-900",children:"Registration Successful!"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Your account has been created successfully."}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:()=>{f(!1),e({password:"",confirmPassword:"",role:"",name:"",mobilenumber:"",address:"",childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),b(!1)},className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Register Another Account"})}),r.jsx("div",{className:"mt-3",children:r.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Go to Login"})})]})})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),r.jsxs("div",{className:"max-w-4xl w-full bg-white rounded-xl shadow-xl overflow-hidden mb-20 border-2 border-red-800",children:[r.jsxs("div",{className:"px-6 py-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-3xl font-extrabold text-[#ab1c1c] mb-2",children:"Create account for a User"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Fill in the details to register"})]}),r.jsxs("form",{className:"space-y-6",onSubmit:N,children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),r.jsx("input",{type:"number",name:"mobilenumber",value:s.mobilenumber,onChange:y,className:"w-full p-2 border ".concat(t.mobilenumber?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:"10"}),t.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.mobilenumber})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),r.jsx("input",{type:"text",name:"name",value:s.name,onChange:y,className:"w-full p-2 border ".concat(t.name?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Full Name"}),t.name&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.name})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Photo (optional)"}),r.jsx("input",{type:"file",accept:"image/*",name:"profilePhoto",onChange:w,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsxs("select",{name:"role",value:s.role,onChange:y,className:"w-full p-2 border ".concat(t.role?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-white"),children:[r.jsx("option",{value:"",children:"Select Role"}),r.jsx("option",{value:"parent",children:"Parent"}),r.jsx("option",{value:"therapist",children:"Therapist"})]}),t.role&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.role})]})]}),s.role&&C(),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:a?"text":"password",name:"password",value:s.password,onChange:y,className:"w-full p-2 border ".concat(t.password?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>o(!a),children:a?r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),t.password&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.password})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:i?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:y,className:"w-full p-2 border ".concat(t.confirmPassword?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Confirm Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>c(!i),children:i?r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),t.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.confirmPassword})]})]}),t.submit&&r.jsx("div",{className:"bg-red-50 border border-red-500 text-red-700 px-4 py-3 rounded relative",role:"alert",children:r.jsx("span",{className:"block sm:inline",children:t.submit})}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:u,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ".concat(u?"bg-[#8e1818] cursor-not-allowed":"bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]"),children:u?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Register"})})]})]}),(s.password||s.confirmPassword)&&r.jsx("div",{className:"mt-4 max-w-md w-full bg-white rounded-xl shadow-md overflow-hidden border border-red-100",children:r.jsxs("div",{className:"px-6 py-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Password Requirements:"}),r.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 list-disc list-inside",children:[r.jsx("li",{className:s.password.length>=6?"text-green-600":"",children:"At least 6 characters long"}),r.jsx("li",{className:/[A-Z]/.test(s.password)?"text-green-600":"",children:"At least one uppercase letter"}),r.jsx("li",{className:/[a-z]/.test(s.password)?"text-green-600":"",children:"At least one lowercase letter"}),r.jsx("li",{className:/[0-9]/.test(s.password)?"text-green-600":"",children:"At least one number"}),r.jsx("li",{className:/[^A-Za-z0-9]/.test(s.password)?"text-green-600":"",children:"At least one special character"}),r.jsx("li",{className:s.password===s.confirmPassword&&s.password?"text-green-600":"",children:"Passwords match"})]})]})})]})]})}const qF=s=>new Promise((e,t)=>{const n=new Image;n.onload=()=>{const a=document.createElement("canvas");a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0),e(a.toDataURL("image/jpeg"))},n.onerror=t,n.src=s}),_y=async s=>{try{const e=new Ry;if(!s||!s.childName){console.log(s),console.log(s.childName),e.setFontSize(14),e.text("No appointment data available",e.internal.pageSize.width/2,20,{align:"center"}),e.output("dataurlnewwindow");return}try{const N=await qF(lg);e.addImage(N,"PNG",15,10,40,20)}catch(N){console.log("Failed to add logo:",N),e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Hospital Logo",15,20)}e.setFontSize(12),e.setFont("helvetica","normal"),e.text(["Total Solution - Barkatpura","3-4-495/B, 1st Floor, YMCA Near More Super Market, Hyderabad, Telangana 500027, IN","Phone: +91 88860 08697"],15,35),e.setFillColor(197,27,28),e.rect(2,50,e.internal.pageSize.width-4,25,"F"),e.setFontSize(18),e.setTextColor(255,255,255),e.setFont("helvetica","bold"),e.text("Appointment Details",e.internal.pageSize.width/2,65,{align:"center"}),e.setTextColor(0,0,0);const t=85,n=175;e.setFillColor(255,220,222),e.roundedRect(10,t,e.internal.pageSize.width-20,n,3,3,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Patient Information",15,t+12);const a=t+18;e.setDrawColor(255,255,255),e.setLineWidth(.5),e.line(15,a,e.internal.pageSize.width-15,a),e.setFontSize(11);const o=25,i=80,c=12;let u=t+30;const h=(N,C)=>{e.setFont("helvetica","bold"),e.text(N,o,u),e.setFont("helvetica","normal");const T=C?typeof C=="string"?C:C.toString():"N/A";e.text(T,i,u),u+=c},p=N=>N?typeof N=="string"?N:N instanceof Date?N.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}):N.toString():"N/A",f=N=>N?typeof N=="string"?N:N instanceof Date?N.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):N.toString():"N/A";h("Patient Name:",s.childName),h("Parent Name:",s.parentName),h("Doctor:",s.doctorName),h("Centre:",s.centreName),h("Date:",p(s.appointmentDate)),h("Time:",f(s.appointmentTime)),h("Consultation Type:",s.consultationType||"Regular"),h("Status:",s.status),e.setFont("helvetica","bold"),e.text("Child Concerns:",o,u),e.setFont("helvetica","normal");const g=s.childConcerns||"N/A",b=e.splitTextToSize(g,e.internal.pageSize.width-i-15);if(e.text(b,i,u),u+=Math.max(b.length*5+5,c),s.prescription&&s.prescription.trim()){const N=t+n+15;e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Prescription",15,N),e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(15,N+5,80,N+5);const C=e.splitTextToSize(s.prescription,e.internal.pageSize.width-40);R1(e,{startY:N+10,head:[],body:[[C]],theme:"plain",styles:{fontSize:11,cellPadding:5,lineColor:[197,28,27],valign:"middle"},columnStyles:{0:{cellWidth:180}},tableLineColor:[197,27,28],tableLineWidth:.3,margin:{top:5}})}if(s.previousMedicalReports&&s.previousMedicalReports.length>0){const N=s.prescription&&s.prescription.trim()?e.previousAutoTable.finalY+15:t+n+15;e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Previous Medical Reports",15,N),e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(15,N+5,120,N+5);const C=s.previousMedicalReports.map((T,I)=>["".concat(I+1),T]);R1(e,{startY:N+10,head:[["No.","Report Details"]],body:C,styles:{fontSize:11,cellPadding:5,lineColor:[197,28,27],valign:"middle"},headStyles:{fillColor:[197,27,28],textColor:[255,255,255],fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,193,195]},columnStyles:{0:{cellWidth:20,halign:"center"},1:{cellWidth:160}},margin:{top:5}})}const y=e.internal.pageSize.height-20;e.setDrawColor(197,27,28),e.setLineWidth(.5),e.line(10,y,e.internal.pageSize.width-10,y),e.setFontSize(10),e.setFont("helvetica","italic"),e.text("Generated on: ".concat(new Date().toLocaleDateString()),e.internal.pageSize.width-15,e.internal.pageSize.height-10,{align:"right"}),e.text("Confidential Medical Document",15,e.internal.pageSize.height-10);const w=e.output("blob"),v=URL.createObjectURL(w);window.open(v,"_blank")}catch(e){console.log("Error generating appointment PDF:",e),alert("Failed to generate appointment PDF")}},w4=["10:30 AM","11:30 AM","12:30 PM","2:00 PM","3:00 PM","3:30 PM","4:30 PM","5:30 PM"];function KF(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(1),[i]=F.useState(5),[c,u]=F.useState({doctorName:"",status:"",date:""}),[h,p]=F.useState([]),[f,g]=F.useState(!1),[b,y]=F.useState(null),[w,v]=F.useState(""),[N,C]=F.useState(""),[T,I]=F.useState([]),[$,R]=F.useState(!1),[O,P]=F.useState(1),[_,M]=F.useState(!1),[A,U]=F.useState(!1),[K,Q]=F.useState(null),X=F.useRef(null),[B,G]=F.useState([]);F.useEffect(()=>{(async()=>{const Fe=sessionStorage.getItem("centreId");try{n(!0);const He=await Pe.get("/api/admins/getAppointments/".concat(Fe),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});G(He.data),console.log(He.data);const rt=He.data.map(Je=>{var nt,at,pt,jt,It,an,$s;const Wt=(nt=Je.childId)!=null&&nt.dob?new Date(Je.childId.dob):null,wt=Wt?Math.floor((new Date-Wt)/(365.25*24*60*60*1e3)):"N/A",Ge=Je.appointmentDate?new Date(Je.appointmentDate):new Date;return{id:Je._id,childName:((at=Je.childId)==null?void 0:at.name)||"Unknown",age:wt,appointmentDate:Ge,appointmentDateFormatted:Ge.toLocaleDateString(),appointmentDateValue:Ge.toISOString().split("T")[0],appointmentTime:Je.appointmentTime||"Not specified",consultationType:Je.consultationType||"Not specified",doctorName:((pt=Je.doctorId)==null?void 0:pt.name)||"Not assigned",doctorId:((jt=Je.doctorId)==null?void 0:jt._id)||null,status:Je.status||"pending",centreName:((It=Je.centreId)==null?void 0:It.name)||"Not specified",parentName:(($s=(an=Je.childId)==null?void 0:an.parentId)==null?void 0:$s.name)||"Not specified",prescription:Je.prescription||null}});e(rt),p(rt)}catch(He){console.error("Error fetching appointments:",He),Ve.error("Failed to load appointments")}finally{n(!1)}})()},[]),F.useEffect(()=>{let ue=[...s];if(c.doctorName&&(ue=ue.filter(Fe=>Fe.doctorName.toLowerCase().includes(c.doctorName.toLowerCase()))),c.status&&(ue=ue.filter(Fe=>Fe.status===c.status)),c.date){const Fe=new Date(c.date);ue=ue.filter(He=>He.appointmentDate.getFullYear()===Fe.getFullYear()&&He.appointmentDate.getMonth()===Fe.getMonth()&&He.appointmentDate.getDate()===Fe.getDate())}p(ue),o(1)},[c,s]);const Y=[...new Set(s.filter(ue=>ue.doctorName!=="Not assigned").map(ue=>ue.doctorName))],Z=ue=>{const{name:Fe,value:He}=ue.target;u(rt=>({...rt,[Fe]:He}))},J=()=>{u({doctorName:"",status:"",date:""})},xe=ue=>{switch(ue){case"pending":return"bg-amber-100 text-amber-800 border-amber-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";case"approved":return"bg-emerald-100 text-emerald-800 border-emerald-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},ye=ue=>{const Fe="px-3 py-1 text-xs font-medium rounded-md";switch(ue){case"New Consultation":return"".concat(Fe," bg-blue-100 text-blue-800");case"Assessment(IQ)":return"".concat(Fe," bg-purple-100 text-purple-800");default:return"".concat(Fe," bg-gray-100 text-gray-800")}},ve=ue=>{y(ue),v(""),C(""),I([]),P(1),g(!0)},Re=()=>{g(!1),y(null),v(""),C(""),I([]),P(1)},Ce=async()=>{if(!(!w||!(b!=null&&b.doctorId)))try{R(!0);const[ue,Fe]=await Promise.all([Pe.get("/api/superadmin/slot-config/".concat(b.doctorId,"?date=").concat(w),{headers:{Authorization:sessionStorage.getItem("token")}}),Pe.get("/api/admins/getBookedSlots/".concat(b.doctorId,"/").concat(w),{headers:{Authorization:sessionStorage.getItem("token")}})]),He=ue.data[0],rt=Fe.data;if(He&&He.isHoliday){I([]),C(""),P(2),Ve.info("Cannot reschedule - ".concat(He.holidayName," is a holiday"));return}let Je=[];He&&He.availableSlots&&He.availableSlots.length>0?Je=He.availableSlots.filter(wt=>wt.isActive&&!wt.isBlocked).map(wt=>wt.time):Je=w4;const Wt=rt.unavailableSlots||[],At=Je.filter(wt=>!Wt.includes(wt));I(At),At.includes(b.appointmentTime)?C(b.appointmentTime):C(At[0]||""),P(2)}catch(ue){console.error("Error fetching slots:",ue),Ve.error("Failed to fetch available time slots"),I(w4),C(b.appointmentTime),P(2)}finally{R(!1)}},pe=async()=>{if(!(!b||!w||!N))try{if(R(!0),(await Pe.put("/api/admins/updateAppointment/".concat(b.id),{appointmentDate:w,appointmentTime:N},{headers:{Authorization:sessionStorage.getItem("token")}})).data.success!==!1){Ve.success("Appointment rescheduled successfully"),Re();const Fe=sessionStorage.getItem("centreId"),He=await Pe.get("/api/admins/getAppointments/".concat(Fe),{headers:{Authorization:sessionStorage.getItem("token")}});G(He.data)}else Ve.error("Failed to reschedule appointment")}catch(ue){console.error("Error rescheduling appointment:",ue),Ve.error("Failed to reschedule appointment")}finally{R(!1)}},Te=ue=>{y(ue),Q(null),M(!0),X.current&&(X.current.value="")},ee=()=>{M(!1),y(null),Q(null)},he=ue=>{ue.target.files.length>0&&Q(ue.target.files[0])},oe=async()=>{if(!(!b||!K))try{U(!0);const ue=new FormData;ue.append("prescription",K),ue.append("appointmentId",b.id);const Fe=await Pe.post("/api/admins/uploadPrescription",ue,{headers:{Authorization:"".concat(sessionStorage.getItem("token")),"Content-Type":"multipart/form-data"}});Ve.success("Prescription uploaded successfully");const He=s.map(rt=>rt.id===b.id?{...rt,prescription:Fe.data.appointment.prescription}:rt);e(He),ee()}catch(ue){console.error("Error uploading prescription:",ue),Ve.error("Failed to upload prescription")}finally{U(!1)}},Ie=a*i,Be=Ie-i,We=h.slice(Be,Ie);console.log(h),console.log(We);const Ke=Math.ceil(h.length/i),be=ue=>o(ue);return t?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(Gs,{})}):r.jsxs("div",{className:"w-full bg-gray-50 p-6 rounded-xl",children:[f&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:[O===1&&"Select New Date",O===2&&"Select Time Slot",O===3&&"Confirm Changes"]}),O===1&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"editDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Date"}),r.jsx("input",{type:"date",id:"editDate",value:w,onChange:ue=>v(ue.target.value),min:new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:Re,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),r.jsx("button",{onClick:Ce,disabled:!w,className:"px-4 py-2 rounded-lg ".concat(w?"bg-[#ab1c1c] text-white hover:bg-[#8a1717]":"bg-gray-300 cursor-not-allowed"),children:"Next"})]})]}),O===2&&r.jsx("div",{children:$?r.jsx("div",{className:"flex justify-center items-center h-32",children:r.jsx(Gs,{})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Available Time Slots for ",new Date(w).toLocaleDateString()]}),r.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto p-2",children:T.length>0?T.map(ue=>r.jsx("button",{onClick:()=>C(ue),className:"p-2 rounded-md border ".concat(N===ue?"bg-[#ab1c1c] text-white":"bg-white hover:bg-gray-100"),children:ue},ue)):r.jsx("div",{className:"col-span-2 text-center py-4 text-gray-500",children:"No available slots for this date"})})]}),r.jsxs("div",{className:"flex justify-between space-x-3 mt-6",children:[r.jsx("button",{onClick:()=>P(1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back"}),r.jsx("button",{onClick:()=>P(3),disabled:!N,className:"px-4 py-2 rounded-lg ".concat(N?"bg-[#ab1c1c] text-white hover:bg-[#8a1717]":"bg-gray-300 cursor-not-allowed"),children:"Next"})]})]})}),O===3&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Child Name"}),r.jsx("p",{className:"text-lg",children:b.childName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Doctor"}),r.jsx("p",{className:"text-lg",children:b.doctorName})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Current Date"}),r.jsx("p",{className:"text-lg",children:b.appointmentDateFormatted})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"New Date"}),r.jsx("p",{className:"text-lg",children:new Date(w).toLocaleDateString()})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Current Time"}),r.jsx("p",{className:"text-lg",children:b.appointmentTime})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"New Time"}),r.jsx("p",{className:"text-lg",children:N})]})]})]}),r.jsxs("div",{className:"flex justify-between space-x-3 mt-6",children:[r.jsx("button",{onClick:()=>P(2),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back"}),r.jsx("button",{onClick:handleUpdateAppointment,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Confirm Changes"})]})]})]})})}),_&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:"Upload Prescription"}),r.jsxs("div",{className:"mb-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Child Name"}),r.jsx("p",{className:"text-lg",children:b.childName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Doctor"}),r.jsx("p",{className:"text-lg",children:b.doctorName})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Appointment Date"}),r.jsx("p",{className:"text-lg",children:b.appointmentDateFormatted})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Appointment Time"}),r.jsx("p",{className:"text-lg",children:b.appointmentTime})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{htmlFor:"prescriptionFile",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Prescription File"}),r.jsx("input",{type:"file",id:"prescriptionFile",ref:X,onChange:he,accept:".pdf,.jpg,.jpeg,.png",className:"w-full text-sm text-gray-500\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-lg file:border-0\n                      file:text-sm file:font-medium\n                      file:bg-red-50 file:text-[#ab1c1c]\n                      hover:file:bg-red-100"}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Accepted formats: PDF, JPG, JPEG, PNG"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:ee,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:A,children:"Cancel"}),r.jsxs("button",{onClick:oe,disabled:!K||A,className:"px-4 py-2 rounded-lg flex items-center ".concat(!K||A?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:[A&&r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),A?"Uploading...":"Upload Prescription"]})]})]})})}),r.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold text-[#ab1c1c]",children:"Appointments"}),r.jsx("p",{className:"text-gray-600 mt-1",children:r.jsxs("span",{children:[h.length," appointments found"]})})]}),r.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-red-200",children:[r.jsx("p",{className:"text-sm font-medium text-[#ab1c1c]",children:"Today's Date"}),r.jsx("p",{className:"text-lg font-bold text-gray-800",children:new Date().toLocaleDateString("en-GB")})]})]}),r.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg shadow border border-red-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-[#ab1c1c] mb-3",children:"Filters"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"doctorName",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Doctor"}),r.jsxs("select",{id:"doctorName",name:"doctorName",value:c.doctorName,onChange:Z,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"All Doctors"}),Y.map(ue=>r.jsx("option",{value:ue,children:ue},ue))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:Z,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-[#ab1c1c] mb-1",children:"Date"}),r.jsx("input",{type:"date",id:"date",name:"date",value:c.date,onChange:Z,className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:J,className:"bg-red-100 hover:bg-red-200 text-[#ab1c1c] px-4 py-2 rounded-lg transition-colors duration-150 border border-red-300",children:"Reset Filters"})})]})]}),r.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg border border-red-200",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-red-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Consultation Type"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"py-4 px-6 text-left text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:We.length>0?We.map((ue,Fe)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors duration-150 ".concat(Fe%2===0?"bg-white":"bg-red-50"),children:[r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center",children:r.jsx("div",{className:"ml-4",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:ue.childName})})})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center text-sm text-gray-900",children:ue.appointmentDateFormatted})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center text-sm text-gray-900",children:ue.appointmentTime})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("span",{className:ye(ue.consultationType),children:ue.consultationType})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("div",{className:"flex items-center",children:r.jsx("div",{className:"text-sm text-gray-900",children:ue.doctorName!=="Not assigned"?ue.doctorName:r.jsx("span",{className:"text-gray-500 italic",children:"Not assigned"})})})}),r.jsx("td",{className:"py-4 px-6",children:r.jsx("span",{className:"text-xs font-medium px-3 py-1 rounded-full ".concat(xe(ue.status)),children:ue.status.charAt(0).toUpperCase()+ue.status.slice(1)})}),r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>ve(ue),className:"text-xs px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition font-medium",children:"Reschedule"}),ue.status==="approved"&&r.jsx(r.Fragment,{children:ue.prescription?r.jsx("a",{className:"text-xs px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition font-medium",href:"https://totalapi.joywithlearning.com/api/admins/get-prescription/".concat(ue.id),target:"_blank",rel:"noopener noreferrer",children:"View Prescription"}):r.jsx("button",{onClick:()=>Te(ue),className:"text-xs px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition font-medium",children:"Upload Prescription"})}),r.jsx("button",{onClick:()=>_y(ue),className:"text-xs px-3 py-1 bg-gray-100 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200 transition",title:"Download Appointment PDF",children:"Download"})]})})]},ue.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"8",className:"py-8 px-6 text-center text-gray-500",children:"No appointments found with the selected filters."})})})]})}),h.length>i&&r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-red-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",r.jsx("span",{className:"font-medium",children:Be+1})," to"," ",r.jsx("span",{className:"font-medium",children:Ie>h.length?h.length:Ie})," ","of ",r.jsx("span",{className:"font-medium",children:h.length})," results"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>be(a>1?a-1:1),disabled:a===1,className:"px-4 py-2 text-sm rounded-md ".concat(a===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:"Previous"}),Array.from({length:Ke},(ue,Fe)=>Fe+1).map(ue=>r.jsx("button",{onClick:()=>be(ue),className:"px-4 py-2 text-sm rounded-md ".concat(a===ue?"bg-[#ab1c1c] text-white":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:ue},ue)),r.jsx("button",{onClick:()=>be(a<Ke?a+1:Ke),disabled:a===Ke,className:"px-4 py-2 text-sm rounded-md ".concat(a===Ke?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white text-[#ab1c1c] hover:bg-red-50 border border-red-300"),children:"Next"})]})]})}),s.length===0&&r.jsxs("div",{className:"py-12 px-6 text-center",children:[r.jsx("svg",{className:"mx-auto h-16 w-16 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No appointments found"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"There are no appointments in the system yet."})]})]}),f&&b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4 shadow-2xl",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c]",children:"Reschedule Appointment"}),r.jsx("button",{onClick:Re,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),O===1&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[r.jsx("strong",{children:"Current appointment:"})," ",b.appointmentDateFormatted," at ",b.appointmentTime]}),r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[r.jsx("strong",{children:"Child:"})," ",b.childName]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{htmlFor:"editDate",className:"block text-sm font-medium text-[#ab1c1c] mb-2",children:"Select New Date"}),r.jsx("input",{type:"date",id:"editDate",value:w,onChange:ue=>v(ue.target.value),min:new Date().toISOString().split("T")[0],className:"w-full border border-red-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:Re,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Ce,disabled:!w||$,className:"px-4 py-2 rounded-lg font-medium ".concat(!w||$?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:$?"Loading...":"Next"})]})]}),O===2&&r.jsxs("div",{children:[r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[r.jsx("strong",{children:"Selected Date:"})," ",new Date(w).toLocaleDateString("en-GB")]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-[#ab1c1c] mb-2",children:"Select Available Time Slot"}),T.length>0?r.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:T.map(ue=>r.jsx("button",{onClick:()=>C(ue),className:"p-2 text-sm border rounded-lg ".concat(N===ue?"bg-[#ab1c1c] text-white border-[#ab1c1c]":"bg-white text-gray-700 border-gray-300 hover:bg-red-50"),children:ue},ue))}):r.jsx("p",{className:"text-sm text-gray-500 p-4 text-center border rounded-lg",children:"No available time slots for this date"})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>P(1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Back"}),r.jsx("button",{onClick:pe,disabled:!N||$,className:"px-4 py-2 rounded-lg font-medium ".concat(!N||$?"bg-gray-300 cursor-not-allowed":"bg-[#ab1c1c] text-white hover:bg-[#8a1717]"),children:$?"Rescheduling...":"Reschedule Appointment"})]})]})]})})]})}const N4="\r\nhttps://testingtotalapi.joywithlearning.com",XF=["Case History","Prescription","IEP","IQ Report","OT Report","Speech Report","Admission Form","Parent Feed Back","Child Observatory Sheets","IEP OT","IEP BT","IEP ST","IEP RT","Other"],YF=["Occupational Therapy","Behavioural Therapy","Remedial Therapy","Speech Therapy"];function ZF(){var Ke;const s=xs(),{childId:e}=Vo(),t=Bo(),[n,a]=F.useState([]),[o,i]=F.useState([]),[c,u]=F.useState(""),[h,p]=F.useState([{therapyType:"",therapistId:""}]),[f,g]=F.useState(null),[b,y]=F.useState(null),[w,v]=F.useState(!1),[N,C]=F.useState(""),[T,I]=F.useState(null),[$,R]=F.useState({name:"",dob:"",gender:"",admitStatus:"active",schoolName:"",schoolBoard:"",caseId:"",registrationId:"",parentName:"",parentMobile:"",parentEmail:"",parentAddress:"",dateOfJoining:"",inactiveReason:""}),[O,P]=F.useState([]),[_,M]=F.useState([]),[A,U]=F.useState([]),[K,Q]=F.useState(!0),[X,B]=F.useState(!1),[G,Y]=F.useState(null);F.useEffect(()=>{ve()},[e]);const Z=()=>{p(be=>[...be,{therapyType:"",therapistId:""}])},J=be=>{p(ue=>ue.length===1?[{therapyType:"",therapistId:""}]:ue.filter((Fe,He)=>He!==be))},xe=(be,ue,Fe)=>{p(He=>He.map((rt,Je)=>Je===be?{...rt,[ue]:Fe}:rt))},ye=be=>{var Fe,He,rt,Je;let ue=be.admitStatus||"active";R({name:be.name||"",dob:be.dob?be.dob.split("T")[0]:"",gender:be.gender||"",admitStatus:ue,inactiveReason:be.inactiveReason||"",schoolName:be.schoolName||"",schoolBoard:be.schoolBoard||"",caseId:be.caseId||"",registrationId:be.registrationId||"",parentName:((Fe=be.parentId)==null?void 0:Fe.name)||"",parentMobile:((He=be.parentId)==null?void 0:He.mobilenumber)||"",parentEmail:((rt=be.parentId)==null?void 0:rt.email)||"",parentAddress:((Je=be.parentId)==null?void 0:Je.address)||"",profilePicture:be.profilePicture||"",dateOfJoining:be.dateOfJoining?be.dateOfJoining.split("T")[0]:""}),u(be.doctorId||""),v(!1),p(be.therapies&&be.therapies.length>0?be.therapies.map(Wt=>{var At;return{therapyType:Wt.therapyType,therapistId:((At=Wt.therapistId)==null?void 0:At._id)||Wt.therapistId}}):[{therapyType:"",therapistId:""}]),P(be.reports||[]),Q(!1),Re(),I(be)},ve=async()=>{try{Q(!0);const be=sessionStorage.getItem("token"),ue=await Pe.get("/api/data/child/".concat(e),{headers:{Authorization:be}});ye(ue.data)}catch(be){Y("Failed to load child data."),Q(!1)}},Re=async()=>{var be,ue;try{const Fe=sessionStorage.getItem("token"),He=((ue=(be=t.state)==null?void 0:be.childData)==null?void 0:ue.centreId)||$.centreId;if(!He)return;const[rt,Je]=await Promise.all([Pe.get("/api/data/allDoctors/".concat(He||""),{headers:{Authorization:Fe}}),Pe.get("/api/data/allTherapists/".concat(He||""),{headers:{Authorization:Fe}})]);a(rt.data.doctors||[]),i(Je.data.therapists||[])}catch(Fe){console.error("Failed to fetch staff",Fe)}},Ce=be=>{const{name:ue,value:Fe}=be.target;R(He=>({...He,[ue]:Fe,...ue==="admitStatus"&&Fe!=="inactive"?{inactiveReason:""}:{}}))},pe=()=>{M(be=>[...be,{id:Date.now(),type:"",file:null}])},Te=(be,ue)=>{M(Fe=>Fe.map(He=>He.id===ue?{...He,type:be.target.value}:He))},ee=(be,ue)=>{const Fe=be.target.files[0];if(Fe&&Fe.size>50*1024*1024){alert("File size should not exceed 50MB");return}M(He=>He.map(rt=>rt.id===ue?{...rt,file:Fe}:rt))},he=be=>{M(ue=>ue.filter(Fe=>Fe.id!==be))},oe=be=>{const ue=be.target.files[0];if(ue){if(ue.size>5*1024*1024){alert("Profile picture size should not exceed 5MB"),g(null),y(null),v(!1);return}g(ue),y(URL.createObjectURL(ue)),v(!1)}else g(null),y(null),v(!0)},Ie=be=>{window.confirm("Remove this existing report? It will be deleted when you save.")&&(U([...A,be]),P(O.filter(ue=>ue._id!==be)))},Be=()=>{var Fe;if(!T)return!1;const be=$.admitStatus!==T.admitStatus||$.inactiveReason!==(T.inactiveReason||"")||c!==(((Fe=T.doctorId)==null?void 0:Fe._id)||"")||JSON.stringify(h)!==JSON.stringify(T.therapies||[]),ue=_.length>0||A.length>0||f!==null||w===!0;return be||ue},We=async be=>{var Fe,He;if(be.preventDefault(),!!window.confirm("Are you sure you want to save all changes?"))try{B(!0);const rt=sessionStorage.getItem("token"),Je=new FormData,Wt=h.filter(wt=>wt.therapyType&&wt.therapistId);Je.set("admitStatus",$.admitStatus),$.admitStatus==="inactive"&&Je.append("inactiveReason",$.inactiveReason),Object.keys($).forEach(wt=>{wt!=="profilePicture"&&wt!=="admitStatus"&&wt!=="inactiveReason"&&Je.append(wt,$[wt])}),f?Je.append("profilePicture",f):w&&$.profilePicture?Je.append("clearProfilePicture","true"):$.profilePicture&&Je.append("existingProfilePicturePath",$.profilePicture),Je.append("doctorId",c),Je.append("therapies",JSON.stringify(Wt)),A.length>0&&Je.append("reportsToDelete",JSON.stringify(A)),_.forEach(wt=>{wt.file&&wt.type&&(Je.append("newReports",wt.file),Je.append("reportTypes",wt.type))});const At=(N||"").trim();if(!At){window.alert("Please provide a valid reason for the changes.");return}Je.append("reason",At),await Pe.put("/api/admins/edit-child/".concat(e),Je,{headers:{Authorization:rt,"Content-Type":"multipart/form-data"}}),s("/admindashboard"),I({...T,...$}),alert("Updated successfully!")}catch(rt){alert("Update failed: ".concat(((He=(Fe=rt.response)==null?void 0:Fe.data)==null?void 0:He.message)||rt.message))}finally{B(!1)}};return K?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):r.jsxs("div",{className:"p-4 sm:p-6 mt-16 max-w-7xl mx-auto pb-20",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8 gap-4 border-b pb-4",children:[r.jsx("div",{children:r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Child Profile"})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{type:"button",onClick:()=>s(-1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md",children:"Cancel"}),r.jsx("button",{onClick:We,disabled:X||!N.trim()||!Be(),className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md shadow-md disabled:bg-red-300",children:X?"Processing Request...":"Save All Changes"})]})]}),r.jsxs("form",{onSubmit:We,className:"space-y-8",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Personal Information"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2 flex flex-col items-center gap-4 mb-4",children:[r.jsx("img",{src:b||($.profilePicture?"".concat(N4).concat($.profilePicture):"https://via.placeholder.com/150?text=No+Image"),alt:"Child Profile",className:"w-32 h-32 rounded-full object-cover border-2 border-[#ab1c1c]"}),r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mt-2",children:"Upload New Profile Picture"}),r.jsx("input",{type:"file",accept:"image/*",onChange:oe,className:"mt-1 w-full p-1.5 border border-gray-300 rounded text-sm bg-white"})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Full Name"}),r.jsx("input",{type:"text",name:"name",value:$.name,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-red-800 outline-none",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"dob",value:$.dob,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Gender"}),r.jsxs("select",{name:"gender",value:$.gender,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Staff"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Assigned Doctor"}),r.jsxs("select",{value:c,onChange:be=>u(be.target.value),className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select Doctor"}),n.map(be=>r.jsx("option",{value:be._id,children:be.name},be._id))]})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-2",children:"Therapist Details"}),h.map((be,ue)=>r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[r.jsx("input",{list:"therapy-types",value:be.therapyType,onChange:Fe=>xe(ue,"therapyType",Fe.target.value),placeholder:"Type or select therapy",className:"p-2 border border-gray-300 rounded"}),r.jsx("datalist",{id:"therapy-types",children:YF.map(Fe=>r.jsx("option",{value:Fe},Fe))}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:be.therapistId,onChange:Fe=>xe(ue,"therapistId",Fe.target.value),className:"flex-1 p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select Therapist"}),o.map(Fe=>r.jsx("option",{value:Fe._id,children:Fe.name},Fe._id))]}),r.jsx("button",{type:"button",onClick:()=>J(ue),className:"px-3 bg-red-100 text-red-600 rounded",children:""})]})]},ue)),r.jsx("button",{type:"button",onClick:Z,className:"mt-2 px-3 py-1 bg-gray-100 rounded text-sm",children:"+ Add Therapy"})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Other Information"})}),r.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"School Name"}),r.jsx("input",{type:"text",name:"schoolName",value:$.schoolName,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Case ID"}),r.jsx("input",{type:"text",name:"caseId",value:$.caseId,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Registration ID"}),r.jsx("input",{type:"text",name:"registrationId",value:$.registrationId,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Admit Status"}),r.jsxs("select",{name:"admitStatus",value:$.admitStatus,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]}),$.admitStatus==="inactive"&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:["Reason for Inactive ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{name:"inactiveReason",value:$.inactiveReason||"",onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded",required:!0,children:[r.jsx("option",{value:"",children:"Select reason"}),r.jsx("option",{value:"administrative-not-joined-after-registration",children:"Not joined after registration"}),r.jsx("option",{value:"administrative-services-on-hold",children:"Services on hold"}),r.jsx("option",{value:"administrative-timing-not-suitable",children:"Timing not suitable"}),r.jsx("option",{value:"academic-school-schedule-conflict",children:"School schedule conflict"}),r.jsx("option",{value:"academic-exam-period",children:"Exam period"}),r.jsx("option",{value:"health-medical-reasons",children:"Medical reasons"}),r.jsx("option",{value:"health-therapy-paused",children:"Therapy paused"}),r.jsx("option",{value:"health-weaning-off",children:"Weaning off"}),r.jsx("option",{value:"health-under-observation",children:"Under observation"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Date of Joining"}),r.jsx("input",{type:"date",name:"dateOfJoining",value:$.dateOfJoining,onChange:Ce,className:"mt-1 w-full p-2 border border-gray-300 rounded",required:!0})]})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden border-l-4 border-[#ab1c1c]",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Manage Reports & Documents"})}),r.jsxs("div",{className:"p-4 space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Currently Stored Files:"}),O.length>0?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:O.map(be=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded bg-gray-50",children:[r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:be.type}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(be.uploadedAt).toLocaleDateString()})]}),r.jsxs("div",{className:"flex gap-2 shrink-0",children:[r.jsx("button",{type:"button",onClick:()=>window.open("".concat(N4).concat(be.filePath),"_blank"),className:"text-blue-600 text-sm font-medium",children:"View"}),r.jsx("button",{type:"button",onClick:()=>Ie(be._id),className:"text-red-600 text-sm font-medium",children:"Remove"})]})]},be._id))}):r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No reports attached."})]}),r.jsx("hr",{}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Upload New Files:"}),r.jsx("div",{className:"space-y-3",children:_.map(be=>r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-end bg-gray-50 p-3 rounded-md border border-dashed border-gray-300",children:[r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Report Type"}),r.jsxs("select",{value:be.type,onChange:ue=>Te(ue,be.id),className:"mt-1 w-full p-2 border rounded text-sm bg-white",required:!0,children:[r.jsx("option",{value:"",children:"Select Type"}),XF.map(ue=>r.jsx("option",{value:ue,children:ue},ue))]})]}),r.jsxs("div",{className:"w-full sm:flex-1",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Select File"}),r.jsx("input",{type:"file",onChange:ue=>ee(ue,be.id),className:"mt-1 w-full p-1.5 border rounded text-sm bg-white",required:!0})]}),r.jsx("button",{type:"button",onClick:()=>he(be.id),className:"text-red-600 hover:bg-red-50 p-2 rounded transition",children:""})]},be.id))}),r.jsx("button",{type:"button",onClick:pe,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-sm font-medium",children:"+ Add File"})]})]})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg border-l-4 border-[#ab1c1c] p-4 mt-6",children:[r.jsxs("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-1",children:["Reason for Change ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("textarea",{value:N,onChange:be=>C(be.target.value),rows:3,placeholder:"Explain why these changes are being made...",className:"w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-red-800",required:!0})]}),r.jsx("div",{className:"flex justify-center pt-6",children:r.jsx("button",{type:"submit",disabled:X||!N.trim()||!Be(),className:"w-full sm:w-auto px-12 py-3 bg-[#ab1c1c] text-white font-bold rounded-lg hover:bg-[#8e1818] shadow-lg disabled:bg-red-300 uppercase",children:X?"Processing Request...":"Save All Changes"})}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg border-l-4 border-[#ab1c1c] p-4 mt-10",children:[r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c] mb-3",children:"Change History"}),(Ke=T==null?void 0:T.changeHistory)!=null&&Ke.length?r.jsx("div",{className:"space-y-3",children:[...T.changeHistory].reverse().map((be,ue)=>{var Fe;return r.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[r.jsx("ul",{className:"ml-4 list-disc text-sm",children:be.changes.map((He,rt)=>r.jsxs("li",{children:["changed ",r.jsx("b",{children:He.field})]},rt))}),r.jsx("p",{className:"text-sm text-gray-700",children:be.reason}),r.jsxs("p",{className:"text-xs text-gray-500",children:[((Fe=be.changedBy)==null?void 0:Fe.name)||be.changedByRole," "," ",new Date(be.changedAt).toLocaleString()]})]},ue)})}):r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No changes recorded yet."})]})]})]})}function QF(){const[s,e]=F.useState([]),[t,n]=F.useState(null),[a,o]=F.useState(!1),[i,c]=F.useState(""),[u,h]=F.useState(!1),[p,f]=F.useState(null),[g,b]=F.useState(""),[y,w]=F.useState(1),[v,N]=F.useState([]),C=5,T=xs();F.useEffect(()=>{(async()=>{h(!0);try{const B=sessionStorage.getItem("token"),G=sessionStorage.getItem("therapistId");if(!B){c("Authentication token missing. Please log in again."),h(!1);return}const Y=await Pe.get("/api/therapists/assigned",{headers:{Authorization:"".concat(B)}});if(!Y.data){c("No data received from server"),h(!1);return}if(Y.data.length===0){c("No Children Assigned"),h(!1);return}c(""),e(Y.data),N(Y.data)}catch(B){console.error("API Error:",B),f(B.message||"Failed to fetch data"),c("Error loading data. Please try again later.")}finally{h(!1)}})()},[]),F.useEffect(()=>{const X=s.filter(B=>{var G;return(G=B.name)==null?void 0:G.toLowerCase().includes(g.toLowerCase())});N(X),w(1)},[g,s]);const I=X=>{if(!X)return"Unknown";const B=new Date(X),G=new Date;let Y=G.getFullYear()-B.getFullYear();const Z=G.getMonth()-B.getMonth();return(Z<0||Z===0&&G.getDate()<B.getDate())&&Y--,Y},$=X=>{if(!X)return"Not specified";const B={day:"numeric",month:"short",year:"numeric"};return new Date(X).toLocaleDateString("en-GB",B)},R=X=>{try{if(!X||!X._id){console.error("Invalid child data:",X);return}o(!0),n(X),console.log("child details : ",X)}catch(B){console.error("Error in handleRowClick:",B)}},O=()=>{o(!1),n(null),sessionStorage.removeItem("childId")},P=()=>{console.log(t),t&&t._id&&(sessionStorage.setItem("childId",t._id),T("/reports?childId=".concat(t._id)))},_=()=>{t&&t._id&&(sessionStorage.setItem("childId",t._id),T("/therapistdashboard/iep?childId=".concat(t._id)))},M=y*C,A=M-C,U=v.slice(A,M),K=X=>w(X),Q=()=>{var X;return t?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-2xl font-bold text-[#ab1c1c]",children:[t.name||"Child","'s Details"]}),r.jsx("button",{onClick:O,className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Personal Information"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",t.name||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Age:"})," ",I(t.dob)," years"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Date of Birth:"})," ",$(t.dob)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Gender:"})," ",t.gender||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Status:"})," ",r.jsx("span",{className:"px-2 py-1 rounded text-xs ".concat(t.admitStatus==="active"?"bg-green-100 text-green-800":t.admitStatus==="inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:t.admitStatus?t.admitStatus.charAt(0).toUpperCase()+t.admitStatus.slice(1):"Pending"})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Education Information"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Name:"})," ",t.schoolName||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Board:"})," ",t.schoolBoard||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Centre Number:"})," ",t.centreId.name||"Not specified"]})]})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Associated Professionals"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Doctor :"})," ",t.doctorId.name||"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Therapists :"})," ",(X=t.therapies)!=null&&X.length?t.therapies.map(B=>B.therapistId.name).join(", "):"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Parent :"})," ",t.parentId.name||"Not specified"]})]})]})}),r.jsx("div",{className:"grid grid-cols-1 gap-4 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-2",children:"Records"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IEPs:"})," ",t.IEPs&&t.IEPs.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Prescription Reports:"})," ",t.prescriptionReports&&t.prescriptionReports.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Appointments:"})," ",t.appointments&&t.appointments.length||0," ","records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Game Reports:"})," ",t.gameReports&&t.gameReports.length||0," ","records"]})]})]})}),r.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[r.jsx("button",{onClick:_,className:"bg-[#ab1c1c] text-white px-4 py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"IEP"}),r.jsx("button",{onClick:B=>{B.stopPropagation(),localStorage.setItem("childId",t._id),t.therapistId&&localStorage.setItem("therapistId",t.therapistId),T("/games")},className:"bg-green-600 text-white px-4 py-2 rounded-md shadow hover:bg-green-700 transition",children:"Play Games"}),r.jsx("button",{onClick:P,className:"bg-[#8e1818] text-white px-4 py-2 rounded-md shadow hover:bg-red-700 transition",children:"Reports"})]})]})})}):null};return r.jsxs("div",{className:"container mx-auto mt-20 px-4",children:[r.jsx("div",{className:"flex justify-center items-center mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] flex-grow-1 text-center",children:"Therapist Dashboard"})}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by name...",value:g,onChange:X=>b(X.target.value),className:"w-full p-2 sm:p-3 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),u?r.jsx("div",{className:"flex justify-center items-center",children:r.jsx(Gs,{})}):i?r.jsx("h3",{className:"text-center text-gray-500 text-xl",children:i}):null,p&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[r.jsx("p",{className:"font-bold",children:"Error"}),r.jsx("p",{children:p})]}),s&&s.length>0&&!u&&!i&&r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-x-auto mb-6",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Name"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Date of Birth"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Age"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Gender"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"IEP"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Games"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Reports"})]})}),r.jsx("tbody",{className:"divide-y divide-red-200",children:U.map((X,B)=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200 cursor-pointer",onClick:()=>R(X),children:[r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:X.name||"Unnamed Child"}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$(X.dob)}),r.jsxs("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:[I(X.dob)," years"]}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:X.gender||"Not specified"}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"text-[#ab1c1c] hover:underline",onClick:G=>{G.stopPropagation(),sessionStorage.setItem("childId",X._id),sessionStorage.setItem("childName",X.name),T("/therapistdashboard/iep?childId=".concat(X._id))},children:"View"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition duration-200",onClick:G=>{G.stopPropagation(),localStorage.setItem("childId",X._id),T("/facedetection")},children:"Play"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"text-[#8e1818] hover:underline",onClick:G=>{G.stopPropagation(),sessionStorage.setItem("childId",X._id),T("/reports?childId=".concat(X._id))},children:"View"})})]},X._id||"item-".concat(B)))})]})}),v.length>C&&!u&&!i&&r.jsx("div",{className:"flex justify-center mt-4 sm:mt-6",children:Array.from({length:Math.ceil(v.length/C)},(X,B)=>r.jsx("button",{onClick:()=>K(B+1),className:"mx-1 px-3 py-1 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base ".concat(y===B+1?"bg-[#ab1c1c] text-white":"bg-red-200 text-[#ab1c1c] hover:bg-red-300"),children:B+1},B+1))}),a&&t&&Q()]})}function JF(){const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState(""),[i,c]=F.useState(1),[u,h]=F.useState(""),[p,f]=F.useState(!1),g=5,b=xs();F.useEffect(()=>{(async()=>{var R;try{const O=await Pe.get("/api/doctors/assigned",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});O.data.length===0&&h("No children assigned"),e(O.data),n(O.data)}catch(O){console.error(((R=O.response)==null?void 0:R.data)||O.message),Ve.error("Error fetching children")}})()},[]);const y=()=>{b("/doctordashboard/viewappointment")};F.useEffect(()=>{const $=s.filter(R=>R.name.toLowerCase().includes(a.toLowerCase()));n($),c(1)},[a,s]);const w=i*g,v=w-g,N=t.slice(v,w),C=$=>c($),T=async($,R,O,P)=>{if(!R||R===null||R==="null"){f(!0);return}sessionStorage.setItem("childId",$),sessionStorage.setItem("therapistName",R),sessionStorage.setItem("childName",O),sessionStorage.setItem("centreName",P),b("/doctordashboard/iepdoctor")},I=()=>{f(!1)};return r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto \n                sm:mt-6 md:mt-8 lg:mt-10 xl:mt-12\n            ",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6 sm:mb-8",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:"Doctor Dashboard"}),r.jsx("button",{className:"bg-[#ab1c1c] text-white px-2 py-2 rounded-lg hover:bg-[#8e1818]",onClick:y,children:"Appointments"})]}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by name...",value:a,onChange:$=>o($.target.value),className:"w-full p-2 sm:p-3 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Name"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Date of Birth"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Gender"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Centre"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"IEP"}),r.jsx("th",{className:"py-2 px-4 sm:py-3 sm:px-6 text-left",children:"Game Reports"})]})}),u?r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-4",children:"No children assigned"})})}):r.jsx("tbody",{className:"divide-y divide-red-200",children:N.map(($,R)=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.name}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:new Date($.dob).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.gender}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:$.centreId.name}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded-lg hover:bg-blue-600",onClick:()=>T($._id,$.therapistId?$.therapistId.name:null,$.name,$.centreId.name),children:"Assign/View"})}),r.jsx("td",{className:"py-2 px-4 sm:py-4 sm:px-6",children:r.jsx("button",{className:"bg-green-600 text-white px-2 py-1 rounded-lg hover:bg-green-700",onClick:()=>b("/reports?childId=".concat($._id)),children:"View"})})]},R))})]})}),r.jsx("div",{className:"flex justify-center mt-4 sm:mt-6",children:Array.from({length:Math.ceil(t.length/g)},($,R)=>r.jsx("button",{onClick:()=>C(R+1),className:"mx-1 px-3 py-1 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base ".concat(i===R+1?"bg-[#ab1c1c] text-white":"bg-red-200 text-[#ab1c1c] hover:bg-red-300"),children:R+1},R+1))}),p&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-yellow-100 rounded-full mb-4",children:r.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 text-center mb-2",children:"No Therapist Assigned"}),r.jsx("p",{className:"text-gray-600 text-center mb-6",children:"This child does not have a therapist assigned. Please contact the administrator to assign a therapist before proceeding with IEP management."}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:I,className:"bg-[#ab1c1c] text-white px-6 py-2 rounded-lg hover:bg-[#8e1818] transition duration-200",children:"OK"})})]})})})]})]})}const e8=s=>new Promise((e,t)=>{const n=new Image;n.onload=()=>{const a=document.createElement("canvas");a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0),e(a.toDataURL("image/jpeg"))},n.onerror=t,n.src=s}),$u=async s=>{var e,t,n,a,o,i,c;try{const u=new Ry;let h=15;if(!s||!s.monthlyGoals){u.setFontSize(14),u.text("No IEP data available",u.internal.pageSize.width/2,20,{align:"center"}),u.output("dataurlnewwindow");return}const p=B=>{const G=new Date(B),Y=new Date;let Z=Y.getFullYear()-G.getFullYear();const J=Y.getMonth()-G.getMonth();return(J<0||J===0&&Y.getDate()<G.getDate())&&Z--,Z},f=(s==null?void 0:s.therapy)||"N/A",g=(s==null?void 0:s.therapistName)||"N/A",b=s!=null&&s.startingMonth&&(s!=null&&s.startingYear)?"".concat(s.startingMonth," ").concat(s.startingYear):"N/A",y=((e=s==null?void 0:s.doctorId)==null?void 0:e.name)||"N/A",w=((t=s==null?void 0:s.childId)==null?void 0:t.name)||"N/A";let v=((n=s==null?void 0:s.childId)==null?void 0:n.gender)||"N/A";const N=((a=s==null?void 0:s.childId)==null?void 0:a.dob.split("T")[0])||"N/A",C=p((o=s==null?void 0:s.childId)==null?void 0:o.dob)||"N/A";v=v.charAt(0).toUpperCase()+v.slice(1);const T=((c=(i=s==null?void 0:s.childId)==null?void 0:i.centreId)==null?void 0:c.name)||"N/A";try{const B=await e8(lg);u.addImage(B,"PNG",15,10,40,20)}catch(B){console.log("Failed to add logo:",B),u.setFontSize(12),u.setFont("helvetica","bold"),u.text("Hospital Logo",15,20)}u.setFontSize(12),u.setFont("helvetica","normal"),u.text(["Total Solution - Barkatpura","3-4-495/B, 1st Floor, YMCA Near More Super Market, Hyderabad, Telangana 500027, IN","Phone: +91 88860 08697"],15,35),u.setFillColor(197,27,28),u.rect(2,50,u.internal.pageSize.width-4,25,"F"),u.setFontSize(18),u.setTextColor(255,255,255),u.setFont("helvetica","bold"),u.text("Individualized Education Program (IEP)",u.internal.pageSize.width/2,65,{align:"center"}),u.setTextColor(0,0,0);const I=85,$=75;u.setFillColor(255,193,195),u.roundedRect(10,I,u.internal.pageSize.width-20,$,3,3,"F"),u.setFontSize(14),u.setFont("helvetica","bold"),u.text("Child: ".concat(w),15,I+12);const R=(u.internal.pageSize.width-40)/2,O=20,P=O+R+10,_=25,M=I+18;u.setDrawColor(255,255,255),u.setLineWidth(.2),u.line(15,M,u.internal.pageSize.width-15,M);let A=I+28;u.setFont("helvetica","bold"),u.text("Therapist:",O,A),u.setFont("helvetica","normal"),u.text(g,O+_,A),u.setFont("helvetica","bold"),u.text("Starting:",P,A),u.setFont("helvetica","normal"),u.text(b,P+_,A),A+=12,u.setFont("helvetica","bold"),u.text("Doctor:",O,A),u.setFont("helvetica","normal"),u.text(y,O+_,A),u.setFont("helvetica","bold"),u.text("DOB:",P,A),u.setFont("helvetica","normal"),u.text("".concat(N," (").concat(C," years)"),P+_,A),A+=12,u.setFont("helvetica","bold"),u.text("Therapy:",O,A),u.setFont("helvetica","normal"),u.text(f,O+_,A),u.setFont("helvetica","bold"),u.text("Gender:",P,A),u.setFont("helvetica","normal"),u.text("".concat(v),P+_,A),A+=12,u.setFont("helvetica","bold"),u.text("Centre:",O,A),u.setFont("helvetica","normal"),u.text(T,O+_,A);const U=[];Array.isArray(s.monthlyGoals)&&s.monthlyGoals.length>0&&s.monthlyGoals.forEach(B=>{const G=B.latest,Y=Array.isArray(G.goals)?G.goals.map((J,xe)=>"".concat(xe+1,") ").concat(J)).join("\n\n"):"N/A",Z=Array.isArray(G.performance)?G.performance.map((J,xe)=>"".concat(xe+1,") ").concat(J)).join("\n\n"):"N/A";U.push([G.month||"N/A",G.target||"N/A",Y,Z,G.therapistFeedback||"N/A",G.doctorFeedback||"N/A"])}),R1(u,{head:[["Month","Long-Term Goals","Short-Term Goals","Performance","Therapist Feedback","Doctor Feedback"]],body:U,startY:I+$+10,styles:{fontSize:10,cellPadding:3,lineColor:[197,28,27],valign:"middle"},headStyles:{fillColor:[197,28,27],textColor:[255,255,255],fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,193,195]},columnStyles:{0:{cellWidth:20,halign:"center"},1:{cellWidth:30,halign:"left"},2:{cellWidth:35,halign:"left"},3:{cellWidth:35,halign:"left"},4:{cellWidth:35,halign:"left"},5:{cellWidth:35,halign:"left"}},margin:{top:10}});const Q=new Date().toLocaleDateString(),X=u.internal.pageSize.height-20;u.setDrawColor(197,27,28),u.setLineWidth(.5),u.line(10,X,u.internal.pageSize.width-10,X),u.setFontSize(10),u.setFont("helvetica","italic"),u.text("Generated on: ".concat(Q),u.internal.pageSize.width-15,u.internal.pageSize.height-10,{align:"right"}),u.text("Confidential Medical Document",15,u.internal.pageSize.height-10),u.output("dataurlnewwindow")}catch(u){console.log("Error generating PDF:",u),alert("Failed to generate PDF")}};function t8(){var Re,Ce;const[s,e]=F.useState([]),[t,n]=F.useState(!1),[a,o]=F.useState(null),[i,c]=F.useState(!1),[u,h]=F.useState(""),p=sessionStorage.getItem("therapistName"),[f,g]=F.useState(!1),[b,y]=F.useState(null),w=new Date().getFullYear(),v=new Date().getMonth()+1,[N,C]=F.useState(!1),[T,I]=F.useState(null),[$,R]=F.useState(""),[O,P]=F.useState(!1),[_,M]=F.useState(""),[A,U]=F.useState(null);F.useEffect(()=>{(async()=>{c(!0);try{const Te=await Pe.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(Te.data)}catch(Te){console.error("Error fetching data: "+Te)}finally{c(!1)}})()},[]);const K=(pe,Te,ee,he)=>{const{name:oe,value:Ie}=pe.target;o(Be=>{const We={...Be};if(he==="goals"&&Te!==void 0&&ee!==void 0)We.monthlyGoals[Te].latest.goals[ee]=Ie;else if(he==="target"&&Te!==void 0)We.monthlyGoals[Te].latest.target=Ie;else if(oe==="therapy")We.therapy=Ie;else if(oe==="startingMonth"){const Ke=parseInt(Ie),be=new Date(0,Ke-1).toLocaleString("default",{month:"long"}),ue=[Ke,Ke%12+1,(Ke+1)%12+1],Fe=ue.map(He=>new Date(0,He-1).toLocaleString("default",{month:"long"}));We.startingMonth=be,We.selectedMonths=ue,We.selectedMonthsNames=Fe,We.monthlyGoals=Fe.map(He=>({latest:{month:He,target:"",goals:[""],performance:[],therapistFeedback:"",doctorFeedback:"",childVideo:"",updatedAt:new Date},history:[]}))}else oe==="year"?(We.startingYear=Ie,Ie===w.toString()&&(We.startingMonth=Math.max(parseInt(We.startingMonth),v))):oe==="feedback"&&(We.feedback=Ie);return We})},Q=(pe,Te)=>{const ee=pe.monthlyGoals[Te],he={month:ee.latest.month,performance:ee.latest.performance,target:ee.latest.target,goals:ee.latest.goals,therapistFeedback:ee.latest.therapistFeedback,childVideo:ee.latest.childVideo};M(pe._id),R(ee.latest.doctorFeedback||""),I(he),console.log(he),C(!0)},X=(pe,Te)=>{const ee=!!pe;if(g(ee),h(ee?"Update Progress":"Assign"),ee){y(Te);const he=JSON.parse(JSON.stringify(pe));he.iepId=pe._id,o(he)}else{const he=v,oe=[he,he%12+1,(he+1)%12+1],Ie=oe.map(Be=>new Date(0,Be-1).toLocaleString("default",{month:"long"}));o({iepId:"",doctorId:sessionStorage.getItem("doctorId"),therapy:"",therapistName:p,feedback:"",monthlyGoals:Ie.map(Be=>({latest:{month:Be,target:"",goals:[""],performance:[],therapistFeedback:"",doctorFeedback:"",childVideo:"",updatedAt:new Date},history:[]})),startingYear:w,startingMonth:new Date(0,v-1).toLocaleString("default",{month:"long"}),selectedMonths:oe,selectedMonthsNames:Ie})}n(!0)},B=()=>{o(null),n(!1),g(!1),y(null)},G=async pe=>{if(pe.preventDefault(),P(!0),!f&&!Z()){P(!1);return}const Te=parseInt(a.startingYear,10),ee=a.selectedMonths[0];if(Te<w||Te===w&&ee<v){Ve.error("Starting month and year cannot be in the past.",{autoClose:2e3}),P(!1);return}try{if(f){const oe={...a.monthlyGoals[b]};oe.history.push({...oe.latest}),oe.latest={...oe.latest,updatedAt:new Date};const Ie=await Pe.put("/api/doctors/updateIEP/".concat(sessionStorage.getItem("childId")),{iepId:a.iepId,monthlyGoals:oe,monthIndex:b,feedback:a.feedback},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});Ve.success("IEP updated successfully!",{autoClose:2e3})}else{const oe=await Pe.post("/api/doctors/assignIEP/".concat(sessionStorage.getItem("childId")),{doctorId:a.doctorId,therapy:a.therapy,therapistName:a.therapistName,feedback:a.feedback,monthlyGoals:a.monthlyGoals,startingMonth:a.startingMonth,startingYear:a.startingYear,selectedMonths:a.selectedMonths,selectedMonthsNames:a.selectedMonthsNames},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});Ve.success("New IEP created successfully!",{autoClose:2e3})}const he=await Pe.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(he.data),n(!1)}catch(he){Ve.error("Error submitting form: "+he.message,{autoClose:2e3}),console.error("Error submitting form:",he)}finally{P(!1)}},Y=pe=>{f&&pe!==b||o(Te=>{const ee=[...Te.monthlyGoals];return ee[pe].latest.goals.push(""),{...Te,monthlyGoals:ee}})},Z=()=>{if(!a.therapy)return Ve.error("Therapy type is required",{autoClose:2e3}),!1;if(!a.startingYear)return Ve.error("Year is required",{autoClose:2e3}),!1;if(!a.startingMonth)return Ve.error("Starting month is required",{autoClose:2e3}),!1;if(a.monthlyGoals.length!==3)return Ve.error("Goals for all three months must be provided",{autoClose:2e3}),!1;for(const[pe,Te]of a.monthlyGoals.entries()){if(!Te.latest.target)return Ve.error("Long-term goal is required for Month ".concat(pe+1),{autoClose:2e3}),!1;if(Te.latest.goals.length===0)return Ve.error("At least one short-term goal is required for Month ".concat(pe+1),{autoClose:2e3}),!1;if(Te.latest.goals.some(ee=>!ee.trim()))return Ve.error("All short-term goals must be filled for Month ".concat(pe+1),{autoClose:2e3}),!1}return!0},J=(pe,Te)=>{f&&pe!==b||o(ee=>{const he=[...ee.monthlyGoals];return he[pe].latest.goals=he[pe].latest.goals.filter((oe,Ie)=>Ie!==Te),{...ee,monthlyGoals:he}})},xe=pe=>{R(pe.target.value)},ye=async()=>{try{await Pe.put("/api/doctors/IEPfeedback/".concat(sessionStorage.getItem("childId")),{iepId:_,month:T.month,doctorFeedback:$},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),Ve.success("Feedback submitted successfully!",{autoClose:2e3}),C(!1);const pe=await Pe.get("/api/doctors/childIEP/".concat(sessionStorage.getItem("childId")),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(pe.data)}catch(pe){Ve.error("Error submitting feedback",{autoClose:2e3}),console.error("Error submitting feedback:",pe)}},ve=()=>a.monthlyGoals.map((pe,Te)=>{const ee=pe.latest;return r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[r.jsxs("h5",{className:"text-lg font-semibold mb-3",children:[ee.month," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("h6",{className:"text-[#ab1c1c] font-medium mb-2",children:["Long-Term Goal ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("div",{className:"mb-3",children:r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Long-Term Goal",value:ee.target,onChange:he=>K(he,Te,null,"target"),required:!f})}),r.jsxs("h6",{className:"text-[#ab1c1c] font-medium mb-2",children:["Short-Term Goals ",r.jsx("span",{className:"text-red-500",children:"*"})]}),ee.goals.map((he,oe)=>r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"Short-Term Goal ".concat(oe+1),value:he,onChange:Ie=>K(Ie,Te,oe,"goals"),required:!f}),r.jsx("button",{type:"button",className:"ml-2 p-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818]",onClick:()=>J(Te,oe),children:""})]},oe)),r.jsx("button",{type:"button",className:"w-full p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",onClick:()=>Y(Te),children:"Add Goal"})]},Te)});return F.useEffect(()=>{var pe;if((pe=T==null?void 0:T.childVideo)!=null&&pe.videoUrl)return(async()=>{try{const ee=encodeURIComponent(T.childVideo.videoUrl),he=await Pe.get("/api/doctors/getIEPVideo/".concat(ee),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),oe=new Blob([he.data],{type:he.headers["content-type"]}),Ie=URL.createObjectURL(oe);U(Ie)}catch(ee){console.error("Error fetching video:",ee),U(null)}})(),()=>{A&&URL.revokeObjectURL(A)}},[(Re=T==null?void 0:T.childVideo)==null?void 0:Re.videoUrl]),r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-16 md:mt-16 lg:mt-20 xl:mt-20 2xl:mt-28",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:["Individual Education Plan (IEP) ",">"," ",sessionStorage.getItem("childName")," "]}),r.jsx("div",{className:"flex space-x-4",children:r.jsx("button",{className:"bg-purple-700 hover:bg-purple-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>X(null),children:"Assign IEP"})})]}),i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):s.length===0?r.jsx("h3",{className:"text-center text-gray-600",children:"No IEPs assigned"}):r.jsx("div",{className:"overflow-x-auto rounded-lg border-2 border-red-800  shadow-md",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"S.No"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 1"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 2"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 3"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:s.sort((pe,Te)=>new Date(Te.createdAt)-new Date(pe.createdAt)).map((pe,Te)=>r.jsxs("tr",{className:"border-b border-red-200 hover:bg-red-50",children:[r.jsx("td",{className:"p-4 text-gray-700",children:Te+1}),r.jsx("td",{className:"p-4 text-gray-700",children:pe.therapy}),pe.selectedMonthsNames.map((ee,he)=>r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col space-y-2",children:[r.jsx("span",{className:"text-[#ab1c1c] font-semibold",children:ee}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>X(pe,he),children:"Edit"}),r.jsx("button",{className:"bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>Q(pe,he),children:"View Performance"})]})]})},he)),r.jsx("td",{className:"p-4",children:r.jsx("button",{className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>$u(pe),children:"IEP Report"})})]},Te))})]})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsx("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:f?"Edit IEP Progress":"Assign New IEP"}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:B,children:""})]}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:G,children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Therapy Type ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"therapy",value:a.therapy,onChange:K,placeholder:"Enter therapy type",required:!f})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Therapist Name"}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-gray-200 cursor-not-allowed",name:"therapistName",value:p,disabled:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"year",value:a.startingYear,onChange:K,disabled:f,required:!f,children:[r.jsx("option",{value:"",children:"Select year"}),r.jsx("option",{value:w,children:w}),r.jsx("option",{value:w+1,children:w+1})]})]}),!f&&r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Select Starting Month ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"startingMonth",value:a.startingMonth,onChange:pe=>K(pe,null,null,"startingMonth"),children:[r.jsx("option",{value:"",children:"Select month"}),[...Array(12).keys()].map(pe=>{const Te=pe+1,ee=a.startingYear===w.toString()&&Te<v;return r.jsx("option",{value:Te,disabled:ee,children:new Date(0,pe).toLocaleString("default",{month:"long"})},pe)})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Long-Term and Short-Term Goals ",r.jsx("span",{className:"text-red-500",children:"*"})]}),ve()]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Feedback"}),r.jsx("textarea",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",name:"feedback",value:a.feedback,onChange:K,placeholder:"Feedback for the month"})]}),O?r.jsx("div",{className:"flex justify-center items-center",children:r.jsx(Gs,{})}):r.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",children:u})]})})]})}),N&&T&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Performance for ",T.month]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:()=>C(!1),children:""})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl mb-2",children:"Long-Term Goal"}),r.jsx("p",{className:"text-gray-700",children:T.target})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl mb-2",children:"Short-Term Goals and Performances"}),T.goals&&T.performance&&T.goals.length>0?r.jsx("div",{className:"space-y-2",children:T.goals.map((pe,Te)=>r.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[r.jsxs("p",{className:"text-gray-700 text-lg",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-medium",children:[Te+1,"."," "]})," ",pe]}),r.jsxs("p",{className:"text-gray-600 mt-2",children:["Performance:"," ",T.performance[Te]?r.jsxs("span",{className:"bg-purple-500 text-white px-2 py-1 rounded-full",children:[T.performance[Te],"%"]}):r.jsx("span",{className:"text-gray-500",children:"Performance not given"})]})]},Te))}):r.jsx("p",{className:"text-gray-500 italic",children:"No goals or performance data available."})]}),((Ce=T==null?void 0:T.childVideo)==null?void 0:Ce.videoUrl)&&r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[r.jsx("h6",{className:"text-blue-600 font-medium text-xl mb-3",children:"Session Video"}),r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex flex-col space-y-4",children:[A?r.jsx("video",{controls:!0,className:"w-full h-auto rounded-lg border border-gray-300",src:A,onError:pe=>{console.error("Video playback error:",pe.target.error),URL.revokeObjectURL(A),U(null)},children:"Your browser does not support the video tag."}):r.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading video..."}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Uploaded on: "}),new Date(T.childVideo.videoUploadDate).toLocaleDateString()]}),T.childVideo.videoDescription&&r.jsxs("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Description: "}),T.childVideo.videoDescription]})]})]})})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Therapist Feedback"}),r.jsx("p",{className:"text-gray-700",children:T.therapistFeedback||"No feedback available"})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-4",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Feedback"}),r.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:$,onChange:xe,placeholder:"Enter feedback based on the child performance",required:!0})]})]}),r.jsxs("div",{className:"p-6 border-t border-red-200",children:[r.jsx("button",{type:"button",className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:ye,children:"Submit Feedback"}),r.jsx("button",{type:"button",className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ml-2",onClick:()=>C(!1),children:"Close"})]})]})})]})]})}function s8(){const e=new URLSearchParams(Bo().search).get("childId");xs();const[t,n]=F.useState([]),[a,o]=F.useState(!1),[i,c]=F.useState(null),[u,h]=F.useState(!1),[p,f]=F.useState([]),[g,b]=F.useState(""),[y,w]=F.useState(""),[v,N]=F.useState(""),[C,T]=F.useState(""),[I,$]=F.useState(null),[R,O]=F.useState(null),[P,_]=F.useState(""),[M,A]=F.useState(!1),[U,K]=F.useState(null),[Q,X]=F.useState(null),[B,G]=F.useState(!1);F.useEffect(()=>{(async()=>{h(!0);try{const pe=await Pe.get("/api/doctors/childIEP/".concat(e),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});n(pe.data)}catch(pe){console.error("Error fetching data:",pe)}finally{h(!1)}})()},[e]);const Y=async(Ce,pe,Te,ee)=>{const he=Ce.latest;if(c({...he,responseIndex:pe,monthIndex:Te}),b(he.month),f(he.performance&&he.performance.length?[...he.performance]:he.goals.map(()=>"")),N(he.therapistFeedback||""),w(he.doctorFeedback||""),T(ee),o(!0),$(null),O(null),_(""),K(null),X(null),G(!1),he.childVideo&&he.childVideo.videoUrl){G(!0),K(he.childVideo.videoUrl);try{const oe=encodeURIComponent(he.childVideo.videoUrl),Ie=await Pe.get("/api/doctors/getIEPVideo/".concat(oe),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),Be=new Blob([Ie.data],{type:Ie.headers["content-type"]}),We=URL.createObjectURL(Be);X(We)}catch(oe){console.error("Error fetching video:",oe),Ve.error("Error fetching video",{autoClose:2e3})}finally{G(!1)}}},Z=Ce=>{const pe=Ce.target.files[0];if(!pe)return;if(!pe.type.startsWith("video/")){Ve.warning("Please upload a video file");return}if(pe.size>50*1024*1024){Ve.warning("Video size should be less than 50MB");return}K(null),X(null);const Te=document.createElement("video");Te.preload="metadata",Te.onloadedmetadata=()=>{const ee=document.createElement("canvas");ee.width=Te.videoWidth,ee.height=Te.videoHeight,ee.getContext("2d").drawImage(Te,0,0,ee.width,ee.height),O({url:URL.createObjectURL(pe),thumbnail:ee.toDataURL("image/jpeg"),name:pe.name,type:pe.type,size:pe.size}),$(pe)},Te.src=URL.createObjectURL(pe)},J=()=>{R&&URL.revokeObjectURL(R.url),$(null),O(null),_("")},xe=async()=>{try{let Ce=null;const pe=new FormData;pe.append("video",I),pe.append("videoDescription",P),pe.append("month",g),pe.append("iepId",C),pe.append("videoUploadDate",new Date().toISOString()),pe.append("therapistFeedback",v),pe.append("performance",JSON.stringify(p)),await Pe.put("/api/therapists/updateIEPperformance/".concat(e),pe,{headers:{Authorization:"".concat(sessionStorage.getItem("token")),"Content-Type":"multipart/form-data"}}),n(Te=>{const ee=[...Te],{responseIndex:he,monthIndex:oe}=i;return ee[he].monthlyGoals[oe].latest.performance=[...p],ee[he].monthlyGoals[oe].latest.therapistFeedback=v,ee}),Ve.success("All data saved successfully!"),ve()}catch(Ce){console.error("Error saving data:",Ce),Ve.error("Error saving data. Please try again.")}},ye=Ce=>{if(Ce===0)return"0 Bytes";const pe=1024,Te=["Bytes","KB","MB","GB"],ee=Math.floor(Math.log(Ce)/Math.log(pe));return parseFloat((Ce/Math.pow(pe,ee)).toFixed(2))+" "+Te[ee]},ve=()=>{o(!1),c(null),f([]),R&&URL.revokeObjectURL(R.url),$(null),O(null),_("")},Re=(Ce,pe)=>{f(Te=>{const ee=[...Te];return ee[Ce]=pe,ee})};return r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsx(ao,{}),r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-16 md:mt-20 lg:mt-24 xl:mt-28",children:[r.jsx("div",{className:"flex justify-between items-center mb-8",children:r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-[#ab1c1c]",children:["Individual Education Plan (IEP) ",">"," ",sessionStorage.getItem("childName")]})}),u?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ab1c1c]"})}):t.length===0?r.jsx("h3",{className:"text-center text-gray-600",children:"No IEPs assigned"}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"S.No"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 1"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 2"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Month 3"}),r.jsx("th",{className:"p-4 text-left text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:t.sort((Ce,pe)=>new Date(pe.createdAt)-new Date(Ce.createdAt)).map((Ce,pe)=>r.jsxs("tr",{className:"border-b border-red-200 hover:bg-red-50",children:[r.jsx("td",{className:"p-4 text-gray-700 font-bold",children:pe+1}),r.jsx("td",{className:"p-4 text-gray-700 font-bold",children:Ce.therapy}),Ce.monthlyGoals.map((Te,ee)=>r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col space-y-2",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-semibold text-lg",children:[Te.latest.month," "]}),r.jsx("div",{className:"flex space-x-2",children:r.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-lg shadow-md transition duration-300",onClick:()=>Y(Te,pe,ee,Ce._id),children:"View/Update"})})]})},ee)),r.jsx("td",{className:"p-4",children:r.jsx("button",{className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2  px-4 rounded-lg shadow-md transition duration-300",onClick:()=>$u(Ce),children:"IEP Report"})})]},pe))})]})}),a&&i&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Edit Performance - ",i.month]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-[#ab1c1c]",onClick:ve,children:""})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Long-Term Goal"}),r.jsx("p",{className:"text-gray-700 text-lg",children:i.target})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Short-Term Goals"}),i.goals.map((Ce,pe)=>r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-gray-700 mb-2 mt-2 text-lg",children:[r.jsxs("span",{className:"text-[#ab1c1c] font-medium",children:[pe+1,"."," "]}),Ce]}),r.jsx("input",{type:"number",className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:p[pe]||"",onChange:Te=>Re(pe,Te.target.value),placeholder:"Enter performance (0-100 %)",min:"0",max:"100",onWheel:Te=>{Te.target.blur()}})]},pe))]}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx("div",{className:"flex justify-between items-center mb-4",children:r.jsx("h6",{className:"text-[#ab1c1c] font-medium text-xl",children:"Session Video"})}),U?r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"flex-shrink-0 relative w-full max-w-md mx-auto",children:B?r.jsx("div",{className:"flex justify-center items-center h-32",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[#ab1c1c]"})}):r.jsxs("video",{controls:!0,className:"w-full h-auto rounded object-cover border",children:[r.jsx("source",{src:Q,type:"video/mp4"}),"Your browser does not support the video tag."]})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[r.jsxs("p",{className:"text-sm  text-gray-900",children:[r.jsx("span",{className:"font-semibold",children:"Uploaded on: "}),new Date(i.childVideo.videoUploadDate).toLocaleDateString()]}),r.jsx("div",{className:"text-sm text-gray-900",children:r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Video Description: "}),i.childVideo.videoDescription||"No description provided"]})})]})]})}),r.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-yellow-700",children:"Uploading a new video will replace the existing one."})})]})}),r.jsx("div",{className:"flex items-center justify-center w-full",children:r.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[r.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:r.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),r.jsx("p",{className:"mb-2 text-sm text-gray-500",children:r.jsx("span",{className:"font-semibold",children:"Click to upload new video"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"MP4, MOV, AVI (MAX. 50MB)"})]}),r.jsx("input",{id:"video-upload",type:"file",className:"hidden",accept:"video/*",onChange:Z})]})})]}):R?r.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-white",children:r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsxs("div",{className:"flex-shrink-0 relative",children:[r.jsx("img",{src:R.thumbnail,alt:"Video thumbnail",className:"h-20 w-32 rounded object-cover border"}),r.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-70 text-white text-xs px-1 rounded",children:ye(R.size)})]}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:R.name}),r.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-lg text-sm",value:P,onChange:Ce=>_(Ce.target.value),placeholder:"Enter video description"})]}),r.jsx("button",{onClick:J,className:"text-red-500 hover:text-red-700 p-1",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})}):r.jsx("div",{className:"flex items-center justify-center w-full",children:r.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[r.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:r.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),r.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[r.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"MP4, MOV, AVI (MAX. 50MB)"})]}),r.jsx("input",{id:"video-upload",type:"file",className:"hidden",accept:"video/*",onChange:Z})]})})]}),r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Therapist Feedback"}),r.jsx("textarea",{className:"w-full p-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:v,onChange:Ce=>N(Ce.target.value),placeholder:"Enter feedback based on the child performance",rows:"3"})]}),y&&r.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h6",{className:"text-[#ab1c1c] font-medium mb-2 text-xl",children:"Doctor's Feedback"}),r.jsx("p",{className:"text-gray-700 text-lg",children:y})]}),r.jsxs("div",{className:"p-6 border-t border-red-200",children:[r.jsx("button",{type:"button",className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:xe,disabled:M,children:M?"Saving...":"Save Changes"}),r.jsx("button",{type:"button",className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ml-2",onClick:ve,disabled:M,children:"Cancel"})]})]})]})})]})]})}function n8(){const[s,e]=F.useState([]);return F.useEffect(()=>{Pe.get("api/therapists/codeofconduct").then(t=>e(t.data)).catch(t=>console.error("Error fetching data:",t))},[]),r.jsxs("div",{className:"container mx-auto mt-20 px-4",children:[r.jsx("div",{className:"flex justify-center items-center mb-8",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] text-center",children:"Therapist Code of Conduct"})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-4xl mx-auto border-t-4 border-[#ab1c1c]",children:[r.jsx("p",{className:"text-lg text-gray-700 mb-6 text-center",children:"Our commitment to ethical practice and professional excellence."}),r.jsx("div",{className:"space-y-6",children:s.length>0?s.map(t=>r.jsxs("div",{className:"flex items-start p-3 bg-red-50 rounded-md border-l-4 border-[#ab1c1c] transition duration-150 ease-in-out hover:shadow-md",children:[r.jsx("svg",{className:"w-5 h-5 text-[#ab1c1c] mt-1 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("circle",{cx:"10",cy:"10",r:"4"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold text-[#ab1c1c] mb-1",children:t.title}),r.jsx("p",{className:"text-gray-600 text-base",children:t.description})]})]},t._id)):r.jsx("p",{className:"text-center text-gray-500",children:"No code of conduct available at this time."})}),r.jsx("div",{className:"mt-8 pt-4 border-t border-red-200 text-center",children:r.jsx("p",{className:"text-sm text-gray-500 italic",children:"Questions regarding this Code of Conduct should be directed to the Ethics Review Board."})})]})]})}const a8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null);F.useEffect(()=>{(async()=>{const u=sessionStorage.getItem("doctorId");if(!u){o("Doctor ID not found"),n(!1);return}try{const h=await Pe.get("/api/doctors/getAppointments/".concat(u),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(h.data),n(!1)}catch(h){o("Failed to fetch appointments"),n(!1),console.error(h)}})()},[]);const i=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return t?r.jsx("div",{className:"flex justify-center items-center min-h-screen",children:r.jsx(Gs,{})}):a?r.jsx("div",{className:"text-center text-red-600",children:a}):r.jsx("div",{className:" p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] text-center mb-8",children:"Completed Appointments"}),s.length===0?r.jsx("div",{className:"text-center text-gray-600",children:"No completed appointments found."}):r.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:r.jsxs("table",{className:"min-w-full leading-normal",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#ab1c1c] text-white",children:[r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Consultation Type"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Centre"})]})}),r.jsx("tbody",{children:s.map(c=>{var u,h;return r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:i(c.appointmentDate)})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:c.appointmentTime})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:c.consultationType})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:((u=c.childId)==null?void 0:u.name)||"N/A"})}),r.jsx("td",{className:"px-5 py-5 border-b border-red-200 text-sm",children:r.jsx("p",{className:"text-[#ab1c1c] whitespace-nowrap",children:((h=c.centreId)==null?void 0:h.name)||"N/A"})})]},c._id)})})]})})]})})};function r8(){const[s,e]=F.useState([]),[t,n]=F.useState(!1),a=xs();F.useEffect(()=>{(async()=>{try{n(!0);const u=await Pe.get("/api/parents/children",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(u.data),n(!1)}catch(u){n(!1),console.log("Error fetching children:",u)}})()},[]);const o=c=>{localStorage.setItem("centreId",c.centreId),a("/parentdashboard/child/".concat(c._id))},i=c=>{const u=new Date(c),h=new Date;let p=h.getFullYear()-u.getFullYear();const f=h.getMonth()-u.getMonth();return(f<0||f===0&&h.getDate()<u.getDate())&&p--,p};return r.jsxs("div",{className:"container mx-auto px-4 py-6 min-h-screen bg-gray-50",children:[r.jsx("h1",{className:"text-center text-3xl font-bold text-[#ab1c1c] mt-6 mb-6",children:"Parent Dashboard"}),r.jsx("div",{className:"mt-4",children:r.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t&&r.jsx(Gs,{}),!t&&s.length===0&&r.jsx("div",{className:"col-span-full flex justify-center",children:r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Child Registration Required"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Please schedule an appointment to complete your child's registration process."}),r.jsx("button",{onClick:()=>a("/parentdashboard/bookappointment"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Book Appointment"})]})}),!t&&s.map((c,u)=>r.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 m-2 cursor-pointer hover:shadow-lg transition duration-200 border border-gray-200",onClick:()=>o(c),children:[r.jsx("h3",{className:"text-lg font-bold text-[#ab1c1c]",children:c.name}),r.jsxs("p",{className:"text-gray-600",children:[r.jsx("strong",{children:"Age:"})," ",i(c.dob)," years"]}),r.jsxs("p",{className:"text-gray-600",children:[r.jsx("strong",{children:"School:"})," ",c.schoolName||"Not specified"]}),r.jsx("div",{className:"mt-2 text-right",children:r.jsx("span",{className:"text-xs font-bold text-[#ab1c1c]",children:"Click for details"})})]},u))]})})]})}const am=({title:s,children:e})=>r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2 border-b pb-1",children:s}),e]}),Ks=({label:s,required:e,children:t})=>r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s,e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),t]}),o8=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]},i8=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,l8=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+14),e.toISOString().split("T")[0]};function c8(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState([]),o=Bo(),i=F.useMemo(()=>new URLSearchParams(o.search),[o.search]),[c,u]=F.useState(!1),[h,p]=F.useState({childId:"",childName:"",childAge:"",parentName:"",parentId:null,dob:"",parentPhoneNo:"",appointmentDate:"",time:"",doctorId:"",schoolName:"",classGrade:"",schoolBoard:"",childConcerns:"",branch:"",gender:"",alternativeNumber:"",address:"",consultationType:"",referredBy:""}),[f,g]=F.useState([]),[b,y]=F.useState([]),[w,v]=F.useState([]),[N,C]=F.useState(null),[T,I]=F.useState(null),[$,R]=F.useState(!1),[O,P]=F.useState("morning"),[_,M]=F.useState(""),[A,U]=F.useState(""),[K,Q]=F.useState(!1),[X,B]=F.useState(""),G=(ee,he)=>{p(oe=>({...oe,[ee]:he}))},Y=ee=>{if(!ee)return"";const he=new Date(ee),oe=new Date;let Ie=oe.getFullYear()-he.getFullYear();return(oe.getMonth()<he.getMonth()||oe.getMonth()===he.getMonth()&&oe.getDate()<he.getDate())&&Ie--,Ie.toString()},Z=async()=>{try{const ee=await Pe.get("/api/data/alldoctors",{headers:{Authorization:sessionStorage.getItem("token")}});g(ee.data)}catch(ee){Ve.error("Error fetching doctors"),console.error("Error fetching doctors:",ee)}},J=()=>{const ee=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&ee)try{const oe=Cr(ee).user._id;G("parentId",oe)}catch(he){console.error("Error decoding token:",he),G("parentId",null)}else G("parentId",null)},xe=async()=>{const ee=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&ee)try{const oe=await Pe.get("/api/parents/children",{headers:{Authorization:ee}});oe.data&&Array.isArray(oe.data)&&t(oe.data)}catch(oe){console.error("Error fetching children:",oe),Ve.error("Could not retrieve your children's information")}};F.useEffect(()=>{if(T&&sessionStorage.getItem("role")==="parent"){const ee=()=>{const oe=sessionStorage.getItem("token");if(oe)try{return Cr(oe).user._id}catch(Ie){return console.error("Error decoding token:",Ie),null}return null},he=T._id||ee();p(oe=>({...oe,parentId:he,parentName:T.name||"",parentPhoneNo:T.mobilenumber||"",address:T.address||"",alternativeNumber:T.mobilenumber||""})),Ve.success("Your details have been automatically filled")}},[T]),F.useEffect(()=>{const ee=async()=>{const Ie=sessionStorage.getItem("token");if(sessionStorage.getItem("role")==="parent"&&Ie){R(!0);try{const Ke=Cr(Ie).user._id,be=await Pe.get("/api/data/allUsers/".concat(Ke),{headers:{Authorization:Ie}});be.data&&I(be.data),await xe()}catch(We){console.error("Error fetching parent details:",We)}finally{R(!1)}}};Z(),ee(),J();const he=new Date;he.setDate(he.getDate()+1);const oe=he.toISOString().split("T")[0];G("appointmentDate",oe)},[]);const ye=ee=>{if(ee==="new"){p(oe=>({...oe,childId:"new",childName:"",childAge:"",dob:"",gender:"",schoolName:"",classGrade:"",schoolBoard:""}));const he=new URL(window.location);he.searchParams.set("childId","new"),window.history.pushState({},"",he)}else{const he=e.find(oe=>oe._id===ee);if(he){p(Ie=>({...Ie,childId:ee,childName:he.name||"",childAge:Y(he.dob),dob:he.dob?new Date(he.dob).toISOString().split("T")[0]:"",gender:he.gender||"",schoolName:he.schoolName||"",classGrade:he.classGrade||"",schoolBoard:he.schoolBoard||""}));const oe=new URL(window.location);oe.searchParams.set("childId",ee),window.history.pushState({},"",oe)}}};F.useEffect(()=>{if(h.doctorId&&h.doctorId.trim()!==""){const ee=f.find(he=>he._id===h.doctorId);ee&&ee.centreIds?a(ee.centreIds):a([])}else a([])},[h.doctorId,f]),F.useEffect(()=>{(async()=>{if(h.doctorId&&h.appointmentDate&&h.consultationType&&h.branch)try{const he=await Pe.get("/api/admins/getAvailableSlots/".concat(h.branch,"/").concat(h.doctorId,"/").concat(h.appointmentDate,"/").concat(h.consultationType),{headers:{Authorization:sessionStorage.getItem("token")}}),oe=he.data.availableSlots||[];if(he.data.isHoliday){Q(!0),B(he.data.holidayName),U(""),y([]),v([]);return}if(he.data.message){Q(!1),B(""),U(he.data.message),y([]),v([]);return}Q(!1),B("");const Ie=oe.map(Be=>{const We=parseInt(Be.split(":")[0]),Ke=Be.includes("AM")&&We<12?"morning":"afternoon";return{time:Be,period:Ke}});y(Ie),v([]),U("")}catch(he){Ve.error("Error fetching slots"),console.error("Error fetching slots:",he),U(""),y([{time:"10:30 AM",period:"morning"},{time:"11:30 AM",period:"morning"},{time:"12:30 PM",period:"afternoon"},{time:"2:00 PM",period:"afternoon"},{time:"3:00 PM",period:"afternoon"},{time:"3:30 PM",period:"afternoon"},{time:"4:30 PM",period:"afternoon"},{time:"5:30 PM",period:"afternoon"}])}else y([]),v([]),U("")})()},[h.doctorId,h.appointmentDate,h.consultationType,h.branch]),F.useEffect(()=>{const ee=i.get("childId");if(ee&&e.length>0){const he=e.find(oe=>oe._id===ee);he&&p(oe=>({...oe,childId:ee,childName:he.name||"",childAge:Y(he.dob),dob:he.dob?new Date(he.dob).toISOString().split("T")[0]:"",gender:he.gender||"",schoolName:he.schoolName||"",classGrade:he.classGrade||"",schoolBoard:he.schoolBoard||""}))}},[e,i]),F.useEffect(()=>{(async()=>{if(h.appointmentDate&&h.parentId)try{const he=await Pe.get("/api/parents/getappointments/".concat(h.parentId),{headers:{Authorization:sessionStorage.getItem("token")}}),oe=new Date(h.appointmentDate),Ie=he.data.appointments.find(Be=>new Date(Be.appointmentDate).toDateString()===oe.toDateString()&&(Be.status==="pending"||Be.status==="approved"));M(Ie?"You already have an appointment scheduled for ".concat(Ie.childId.name," on this date. Only one appointment per day is allowed."):"")}catch(he){console.error("Error checking appointment conflicts:",he),M("")}else M("")})()},[h.appointmentDate,h.parentId]);const ve=async ee=>{var he;ee.preventDefault(),u(!0),J();try{const oe=new FormData;Object.entries(h).forEach(([Ie,Be])=>{Ie!=="childId"&&oe.append(Ie,Be)}),N&&oe.append("pdf",N),oe.append("centreId",h.branch),await Pe.post("/api/admins/bookAppointment",oe,{headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"multipart/form-data"}}),Ve.success("Appointment booked successfully!"),u(!1),setTimeout(()=>s(-1),1500)}catch(oe){const Ie=((he=oe.response)==null?void 0:he.data)||"Failed to book appointment. Please try again.";Ve.error(Ie),console.error("Error booking appointment:",oe),u(!1)}},Re=ee=>{w.includes(ee)||G("time",ee)},Ce=ee=>{if(h.appointmentDate===new Date().toISOString().split("T")[0]){const[he,oe]=ee.replace(/(AM|PM)/,"").trim().split(":"),Be=ee.includes("PM")&&he!=="12"?parseInt(he)+12:parseInt(he),We=parseInt(oe),Ke=new Date;return Ke.setHours(Be,We,0),Ke<=new Date}return!1},pe=()=>b.filter(ee=>ee.period===O).filter(ee=>!w.includes(ee.time)).filter(ee=>!Ce(ee.time)).map(ee=>ee.time),Te=()=>["childName","childAge","parentName","parentPhoneNo","appointmentDate","time","doctorId"].every(Ie=>h[Ie])&&!_;return r.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4",children:[r.jsx(ao,{}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"w-full md:w-4/5 lg:w-2/3",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden border border-gray-200",children:[r.jsx("div",{className:"bg-[#ab1c1c] border-b py-4 text-center",children:r.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Book Appointment"})}),sessionStorage.getItem("role")==="parent"&&$&&r.jsx("div",{className:"bg-red-50 px-6 py-3 flex justify-center items-center",children:r.jsx("div",{className:"flex items-center",children:r.jsx("p",{className:"text-[#ab1c1c] ml-2",children:"Loading your details..."})})}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:ve,children:[r.jsx(am,{title:"Child Information"}),sessionStorage.getItem("role")==="parent"&&e.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a Child"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onChange:ee=>ye(ee.target.value),value:h.childId||"",children:[r.jsx("option",{value:"",children:"-- Select a Child --"}),e.map(ee=>r.jsx("option",{value:ee._id,children:ee.name||"Unnamed Child"},ee._id)),r.jsx("option",{value:"new",children:"+ Add a New Child"})]}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select an existing child or enter details for a new child below"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(Ks,{label:"Child Name",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.childName,onChange:ee=>G("childName",ee.target.value),required:!0})}),r.jsx(Ks,{label:"Child Age",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] bg-gray-50",value:h.childAge,readOnly:!0,disabled:!0,tabIndex:"-1",placeholder:"Age will be calculated from Date of Birth"})}),r.jsx(Ks,{label:"Date of Birth",required:!0,children:r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.dob,onChange:ee=>{const he=ee.target.value;if(G("dob",he),he){const oe=Y(he);G("childAge",oe)}else G("childAge","")},max:new Date().toISOString().split("T")[0],required:!0})}),r.jsx(Ks,{label:"Gender",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.gender,onChange:ee=>G("gender",ee.target.value),required:!0,children:[r.jsx("option",{value:"",children:"-- Select Gender --"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"}),r.jsx("option",{value:"Others",children:"Other"})]})}),r.jsx(am,{title:"Parent Information"}),r.jsx(Ks,{label:"Parent Name",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.parentName,onChange:ee=>G("parentName",ee.target.value),required:!0})}),r.jsx(Ks,{label:"Parent Phone Number",required:!0,children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.parentPhoneNo,onChange:ee=>G("parentPhoneNo",ee.target.value),required:!0})}),r.jsx(Ks,{label:"Alternate Number",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.alternativeNumber,onChange:ee=>G("alternativeNumber",ee.target.value)})}),r.jsx(Ks,{label:"Concerns",required:!0,children:r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",rows:"3",value:h.childConcerns,onChange:ee=>G("childConcerns",ee.target.value),required:!0})}),r.jsx(Ks,{label:"Address",children:r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",rows:"3",value:h.address,onChange:ee=>G("address",ee.target.value)})}),r.jsx(am,{title:"School Information"}),r.jsx(Ks,{label:"School Name",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.schoolName,onChange:ee=>G("schoolName",ee.target.value)})}),r.jsx(Ks,{label:"Class/Grade",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.classGrade,onChange:ee=>G("classGrade",ee.target.value)})}),r.jsx(Ks,{label:"School Board",children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.schoolBoard,onChange:ee=>G("schoolBoard",ee.target.value),children:[r.jsx("option",{value:"",children:"Select School Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"SSC",children:"SSC"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"Camebridge (IB)",children:"Cambridge (IB)"}),r.jsx("option",{value:"NIOS",children:"NIOS"}),r.jsx("option",{value:"Others",children:"Others"})]})}),r.jsx(Ks,{label:"Referred By",children:r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.referredBy,onChange:ee=>G("referredBy",ee.target.value)})}),r.jsx(am,{title:"Appointment Details"}),r.jsx(Ks,{label:"Appointment Date",required:!0,children:r.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.appointmentDate,onChange:ee=>{const he=ee.target.value;if(i8(he)){alert("Appointments cannot be scheduled on Sundays. Please select another date.");return}G("appointmentDate",he),G("time","")},min:o8(),max:l8(),required:!0})}),_&&r.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),r.jsx("span",{className:"font-medium",children:"Warning:"})]}),r.jsx("p",{className:"mt-1 text-sm",children:_})]}),r.jsx(Ks,{label:"Select Doctor",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.doctorId,onChange:ee=>{G("doctorId",ee.target.value),G("branch",""),G("time","")},required:!0,children:[r.jsx("option",{value:"",children:"-- Select a Doctor --"}),f.map(ee=>r.jsx("option",{value:ee._id,children:ee.name},ee._id))]})}),r.jsx(Ks,{label:"Select Branch",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.branch,onChange:ee=>{G("branch",ee.target.value),G("time","")},required:!0,disabled:!h.doctorId,children:[r.jsx("option",{value:"",children:"-- Select a Branch --"}),n.map(ee=>r.jsx("option",{value:ee._id,children:ee.name},ee._id))]})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Ks,{label:"Select Consultation type",required:!0,children:r.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:h.consultationType,onChange:ee=>G("consultationType",ee.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select Consultation Type"}),r.jsx("option",{value:"New Consultation",children:"New Consultation Rs.700/-"}),r.jsx("option",{value:"Assessment(IQ)",children:"Assessment (IQ) Rs.6000/-"}),r.jsx("option",{value:"For IB board Assessment(IQ)",children:"For IB board Assessment (IQ) Rs.12000/-"})]})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Ks,{label:"Select Time Period",children:r.jsxs("div",{className:"flex items-center space-x-4 my-2",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-[#ab1c1c]",name:"timePeriod",value:"morning",checked:O==="morning",onChange:()=>{P("morning"),G("time","")}}),r.jsx("span",{className:"ml-2",children:"Morning (10:30 AM - 11:30 AM)"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",className:"form-radio text-[#ab1c1c]",name:"timePeriod",value:"afternoon",checked:O==="afternoon",onChange:()=>{P("afternoon"),G("time","")}}),r.jsx("span",{className:"ml-2",children:"Afternoon/Evening (12:30 PM - 5:30 PM)"})]})]})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(Ks,{label:"Available Time Slots",required:!0,children:r.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:K?r.jsx("div",{className:"w-full p-6 bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-300 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-orange-800 font-bold text-lg mb-2",children:["Holiday - ",X]}),r.jsx("p",{className:"text-orange-700",children:"No appointments can be booked on this holiday. Please select a different date."})]})}):A?r.jsx("div",{className:"w-full p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-6 h-6 text-red-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-red-800 font-medium",children:"Center Not Operational"}),r.jsx("p",{className:"text-red-700 text-sm mt-1",children:"The selected center is not operational on this date. Please choose a different date or contact the center for more information."})]})]})}):pe().length>0?pe().map(ee=>r.jsx("button",{type:"button",className:"px-4 py-2 rounded-md ".concat(h.time===ee?"bg-[#ab1c1c] text-white":"border border-[#ab1c1c] text-[#ab1c1c] hover:bg-red-50"),onClick:()=>Re(ee),children:ee},ee)):r.jsx("p",{className:"text-orange-600 italic",children:!h.doctorId||!h.appointmentDate?"Please select a doctor and date to see available time slots":"No time slots available for the selected period. Please try another date or time period."})})})}),r.jsx("div",{className:"md:col-span-2",children:r.jsxs(Ks,{label:"Upload Previous Reports (Optional)",children:[r.jsx("input",{type:"file",accept:".pdf,.doc,.docx",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onChange:ee=>C(ee.target.files[0])}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload previous medical reports or assessments (PDF, DOC, DOCX)"})]})})]}),r.jsxs("div",{className:"mt-8 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[r.jsx("button",{type:"button",className:"w-full md:w-auto px-6 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",onClick:()=>s(-1),children:"Cancel"}),r.jsx("button",{type:"submit",className:"w-full md:w-auto px-6 py-2 rounded-md text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] ".concat(!Te()||c?"opacity-50 cursor-not-allowed":""),disabled:!Te()||c,children:c?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(Gs,{size:5}),r.jsx("span",{className:"ml-2",children:"Booking..."})]}):"Book Appointment"})]})]})})]})})})]})}function u8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(null),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(1),[f]=F.useState(10);return F.useEffect(()=>{(async()=>{try{const[b,y]=await Promise.all([Pe.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Pe.get("/api/superadmin/children/".concat(s,"/ieps"),{headers:{Authorization:sessionStorage.getItem("token")}})]);a(b.data),t(y.data),i(!1)}catch(b){u("Failed to fetch data"),i(!1)}})()},[s]),o?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):c?r.jsx("div",{className:"text-red-500 text-center py-8",children:c}):r.jsxs("div",{className:"p-6",children:[r.jsxs(ot,{to:"/superadmin/children/".concat(s),className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Child Details"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-2",children:["IEPs for ",n.name]}),r.jsxs("p",{className:"text-gray-600",children:["Total IEPs: ",e.length]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50",children:[r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Starting Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapist"}),r.jsx("th",{className:"px-6 py-3 text-center text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:e.slice((h-1)*f,h*f).map(g=>{var b;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4",children:[g.startingMonth,"/",g.startingYear]}),r.jsx("td",{className:"px-6 py-4",children:g.therapy}),r.jsx("td",{className:"px-6 py-4",children:((b=g.doctorId)==null?void 0:b.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:g.therapistName||"-"}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx("button",{onClick:()=>$u(g),className:"text-[rgb(197,27,28)] hover:text-red-700",children:"View PDF"})})]},g._id)})})]})}),e.length>f&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>p(g=>Math.max(g-1,1)),disabled:h===1,className:"px-4 py-2 rounded ".concat(h===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",h," of ",Math.ceil(e.length/f)]}),r.jsx("button",{onClick:()=>p(g=>Math.min(g+1,Math.ceil(e.length/f))),disabled:h>=Math.ceil(e.length/f),className:"px-4 py-2 rounded ".concat(h>=Math.ceil(e.length/f)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function d8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(null),[o,i]=F.useState(!0),[c,u]=F.useState(null),[h,p]=F.useState(1),[f]=F.useState(10);return F.useEffect(()=>{(async()=>{try{console.log("Fetching appointment data...");const[b,y]=await Promise.all([Pe.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Pe.get("/api/superadmin/children/".concat(s,"/appointments"),{headers:{Authorization:sessionStorage.getItem("token")}})]);a(b.data),console.log("Appointment response data:",y.data),t(y.data),i(!1)}catch(b){u("Failed to fetch data"),i(!1)}})()},[s]),o?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):c?r.jsx("div",{className:"text-red-500 text-center py-8",children:c}):r.jsxs("div",{className:"p-6",children:[r.jsxs(ot,{to:"/superadmin/children/".concat(s),className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Child Details"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-2",children:["Appointments for ",n.name]}),r.jsxs("p",{className:"text-gray-600",children:["Total Appointments: ",e.length]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50",children:[r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Therapist"}),r.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:e.slice((h-1)*f,h*f).map(g=>{var b,y;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:g.appointmentDate.split("T")[0]||"-"}),r.jsx("td",{className:"px-6 py-4",children:g.appointmentTime||"-"}),r.jsx("td",{className:"px-6 py-4",children:((b=g.doctorId)==null?void 0:b.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((y=g.therapistId)==null?void 0:y.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs ".concat(g.status==="completed"?"bg-green-100 text-green-800":g.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:g.status})}),r.jsx("td",{className:"px-6 py-4 text-center",children:r.jsx("button",{onClick:()=>{var w,v,N;_y({...g,childName:n.name,parentName:(w=n.parentId)==null?void 0:w.name,centreName:(v=n.centreId)==null?void 0:v.name,doctorName:(N=g.doctorId)==null?void 0:N.name,appointmentDate:g.appointmentDate.split("T")[0]||"-",appointmentTime:g.appointmentTime||"-",consultationType:g.type})},className:"text-[rgb(197,27,28)] hover:text-red-700",children:"View PDF"})})]},g._id)})})]})}),e.length>f&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>p(g=>Math.max(g-1,1)),disabled:h===1,className:"px-4 py-2 rounded ".concat(h===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",h," of ",Math.ceil(e.length/f)]}),r.jsx("button",{onClick:()=>p(g=>Math.min(g+1,Math.ceil(e.length/f))),disabled:h>=Math.ceil(e.length/f),className:"px-4 py-2 rounded ".concat(h>=Math.ceil(e.length/f)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}const h8=()=>{const s=xs(),[e,t]=F.useState({parentName:"",mobilenumber:"",password:"",confirmPassword:"",address:"",otp:""}),[n,a]=F.useState(!1),[o,i]=F.useState(!1),[c,u]=F.useState([]),[h,p]=F.useState(!1),[f,g]=F.useState({}),[b,y]=F.useState(!1),[w,v]=F.useState(!1),[N,C]=F.useState(!1),T=()=>{t({parentName:"",mobilenumber:"",password:"",confirmPassword:"",address:"",otp:""}),g({}),y(!1),v(!1),C(!1)};F.useEffect(()=>{(async()=>{p(!0);try{const M=await Pe.get("/api/users/allusers");if(M.data.success){const A=M.data.users.map(U=>U.mobilenumber);u(A)}}catch(M){console.error("Error fetching existing data:",M)}finally{p(!1)}})()},[]);const I=_=>{const{name:M,value:A}=_.target;t({...e,[M]:A}),f[M]&&g({...f,[M]:""})},$=()=>{const _={};e.parentName.trim()||(_.parentName="Parent name is required");const M=/^\d{10}$/;return e.mobilenumber.toString().trim()?M.test(e.mobilenumber.toString())?c.includes(e.mobilenumber)&&(_.mobilenumber="This mobile number is already registered"):_.mobilenumber="Please enter a valid 10-digit mobile number":_.mobilenumber="Mobile number is required",e.password?e.password.length<8?_.password="Password must be at least 8 characters":/[A-Z]/.test(e.password)?/[a-z]/.test(e.password)?/[0-9]/.test(e.password)?/[@$]/.test(e.password)||(_.password="Password must contain at least one special character (@ or $)"):_.password="Password must contain at least one number":_.password="Password must contain at least one lowercase letter":_.password="Password must contain at least one uppercase letter":_.password="Password is required",e.confirmPassword?e.password!==e.confirmPassword&&(_.confirmPassword="Passwords do not match"):_.confirmPassword="Please confirm your password",e.address.trim()||(_.address="Address is required"),_},R=async()=>{const _=$();if(g(_),Object.keys(_).length===0){p(!0);try{const M=await Pe.post("/api/users/send-otp",{mobileNumber:e.mobilenumber});M.data.success?(Ve.success("OTP sent to your mobile number!",{autoClose:2e3}),v(!0)):Ve.error(M.data.message,{autoClose:2e3})}catch(M){Ve.error("Error sending OTP. Please try again.",{autoClose:2e3})}finally{p(!1)}}else Ve.error("Please fill the form correctly.",{autoClose:2e3})},O=async()=>{if(!e.otp.trim()){Ve.error("Please enter the OTP.",{autoClose:2e3});return}p(!0);try{const _=await Pe.post("/api/users/verify-otp",{mobileNumber:e.mobilenumber,otp:e.otp});_.data.success?(C(!0),Ve.success("OTP verified successfully!",{autoClose:2e3}),await P(_.data.token)):Ve.error(_.data.message,{autoClose:2e3})}catch(_){Ve.error("Error verifying OTP. Please try again.",{autoClose:2e3})}finally{p(!1)}},P=async _=>{try{(await Pe.post("/api/users/parentRegister",e,{headers:{Authorization:"".concat(_)}})).data.success?(y(!0),Ve.success("Registration Successful! Redirecting to login...",{autoClose:2e3}),setTimeout(()=>s("/login"),5e3)):Ve.error("Registration failed. Please try again.",{autoClose:2e3})}catch(M){Ve.error("Error during registration. Please try again.",{autoClose:2e3})}};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{}),r.jsx("div",{className:"max-w-3xl mx-auto",children:r.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"bg-[#ab1c1c] px-6 py-8 text-white",children:[r.jsx("h2",{className:"text-3xl font-bold text-center",children:"Create Your Account"}),r.jsx("p",{className:"mt-2 text-center text-red-100",children:"Register to book appointments and access our services"})]}),b?r.jsxs(r.Fragment,{children:[r.jsx(cg,{}),r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"mb-6 mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-[#ab1c1c]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Registration Successful!"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Thank you for registering with us. You can now log in to your account."}),r.jsx(ot,{to:"/login",className:"inline-block bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-medium py-3 px-6 rounded-md transition duration-300",children:"Go to Login"})]})]}):r.jsxs("form",{onSubmit:_=>_.preventDefault(),className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"parentName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Name ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("input",{required:!0,type:"text",id:"parentName",name:"parentName",value:e.parentName,onChange:I,className:"w-full px-4 py-2 border ".concat(f.parentName?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"Enter name"}),f.parentName&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.parentName})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"mobilenumber",className:"block text-sm font-medium text-gray-700 mb-1",children:["Mobile Number"," ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("input",{required:!0,type:"number",id:"mobilenumber",name:"mobilenumber",value:e.mobilenumber,onChange:I,className:"w-full px-4 py-2 border ".concat(f.mobilenumber?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:"10"}),f.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.mobilenumber})]}),r.jsxs("div",{className:"",children:[r.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{required:!0,type:n?"text":"password",id:"password",name:"password",value:e.password,onChange:I,className:"w-full px-4 py-2 border ".concat(f.password?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent pr-10"),placeholder:"Create a secure password"}),r.jsx("button",{type:"button",onClick:()=>a(!n),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),f.password&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.password})]}),r.jsx("div",{className:"bg-red-50 rounded-md p-3 mb-2 border border-red-100",children:r.jsxs("p",{className:"text-xs text-gray-600 flex items-start",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#ab1c1c] mr-1 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Password must be at least 8 characters long, contain at least one uppercase letter, one lowercase letter, one number, and at least one special character (@ or $)."]})}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm Password ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{required:!0,type:o?"text":"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:I,className:"w-full px-4 py-2 border ".concat(f.confirmPassword?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent pr-10"),placeholder:"Confirm your password"}),r.jsx("button",{type:"button",onClick:()=>i(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),f.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.confirmPassword})]})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:["Address ",r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})]}),r.jsx("textarea",{required:!0,id:"address",name:"address",value:e.address,onChange:I,rows:3,className:"w-full px-4 py-2 border ".concat(f.address?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent"),placeholder:"Enter your complete address"}),f.address&&r.jsx("p",{className:"mt-1 text-sm text-[#ab1c1c]",children:f.address})]}),w&&r.jsxs("div",{children:[r.jsx("div",{className:"bg-red-50 rounded-md p-3 mb-2 border border-red-100 flex items-center ",children:r.jsxs("p",{className:"text-xs text-gray-600 flex",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#ab1c1c] mr-1 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Please enter OTP  valid for 5 mins."]})}),r.jsx("input",{required:!0,type:"text",id:"otp",name:"otp",value:e.otp,onChange:I,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#ab1c1c] focus:border-transparent",placeholder:"Enter OTP *"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsx("span",{className:"text-[#ab1c1c]",children:"*"})," Required fields"]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{type:"button",onClick:T,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition duration-300",children:"Clear"}),w?r.jsx("button",{type:"button",onClick:O,className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md hover:bg-[#8e1818] transition duration-300 flex items-center",disabled:h||N,children:h?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying OTP..."]}):"Verify OTP and Submit"}):r.jsx("button",{type:"button",onClick:R,className:"px-6 py-2 bg-[#ab1c1c] text-white rounded-md hover:bg-[#8e1818] transition duration-300 flex items-center",disabled:h,children:h?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending OTP..."]}):"Send OTP to mobile"})]})]}),r.jsx("div",{className:"text-center mt-6 border-t border-gray-200 pt-4",children:r.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",r.jsx(ot,{to:"/login",className:"text-[#ab1c1c] font-medium hover:text-[#8e1818]",children:"Sign in"})]})})]})]})})]})},p8=(s,e,t)=>{const n=s[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};function f8(){const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState("1"),[i,c]=F.useState(!1);F.useEffect(()=>{(async()=>{c(!0);try{const g=await Pe.get("/api/data/allgames",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(g.data),u(g.data,a)}catch(g){console.error("Error fetching icons:",g)}finally{c(!1)}})()},[a]);const u=(f,g)=>{var w;const y=(((w=f.find(v=>v.groupId===g))==null?void 0:w.games)||[]).filter(v=>v.status==="active");Promise.all(y.map(async v=>{const N=await p8(Object.assign({"../assets/icons/AnimalFarm.webp":()=>fa(()=>import("./AnimalFarm-Dd_FYYrw.js"),[]),"../assets/icons/AnimalMatching.webp":()=>fa(()=>import("./AnimalMatching-l3BKKWC_.js"),[]),"../assets/icons/ConnectingLetters.webp":()=>fa(()=>import("./ConnectingLetters-DITF1NAp.js"),[]),"../assets/icons/DragAndMatch.webp":()=>fa(()=>import("./DragAndMatch-BLQrL6CE.js"),[]),"../assets/icons/JoiningShapes.webp":()=>fa(()=>import("./JoiningShapes-DRfGPxs4.js"),[]),"../assets/icons/Memorygame.webp":()=>fa(()=>import("./Memorygame-Cbk3h7nr.js"),[]),"../assets/icons/Search.webp":()=>fa(()=>import("./Search-CR-RX0HI.js"),[]),"../assets/icons/SentenceVerification1.webp":()=>fa(()=>import("./SentenceVerification1-B-AotmmA.js"),[]),"../assets/icons/SentenceVerification2.webp":()=>fa(()=>import("./SentenceVerification2-CVNvNXuQ.js"),[]),"../assets/icons/ShadowMatching.webp":()=>fa(()=>import("./ShadowMatching-DeXzSZWQ.js"),[]),"../assets/icons/Shape-Design.webp":()=>fa(()=>import("./Shape-Design-BqdO_MCz.js"),[]),"../assets/icons/imageMatching.webp":()=>fa(()=>import("./imageMatching-CE0earrI.js"),[]),"../assets/icons/tabledraganddrop.webp":()=>fa(()=>import("./tabledraganddrop-SMFGi8-H.js"),[]),"../assets/icons/windowsequencing.webp":()=>fa(()=>import("./windowsequencing-B9QSss-b.js"),[])}),"../assets/icons/".concat(v.img,".webp"),4);return{...v,url:N.default}})).then(n)};F.useEffect(()=>{s.length>0&&u(s,a)},[a,s]);const h=(f,g)=>{localStorage.setItem("gameId",f),window.open("".concat(g,"?gameId=").concat(f),"_blank")},p=f=>{o(f.target.value)};return r.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:r.jsxs("div",{className:"max-w-7xl mx-auto sm:mt-8 md:mt-16 lg:mt-18 xl:mt-20",children:[r.jsx("div",{className:"mb-8",children:r.jsxs("select",{onChange:p,value:a,className:"w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"1",children:"SUCCESSIVE PROCESSING"}),r.jsx("option",{value:"2",children:"SIMULTANEOUS PROCESSING"})]})}),i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(Gs,{})}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.length>0?t.map((f,g)=>r.jsx("div",{className:"bg-white rounded-3xl overflow-hidden shadow-lg hover:shadow-xl transition-shadow duration-300",children:r.jsxs("div",{className:"block cursor-pointer",onClick:()=>h(f.gameId,f.route),children:[r.jsx("div",{className:"p-6",children:r.jsx("img",{src:f.url,alt:f.name,className:"w-full h-48 object-contain"})}),r.jsxs("div",{className:"p-6 bg-blue-500 text-white text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:f.name}),r.jsx("p",{className:"text-sm",children:f.description})]})]})},g)):r.jsx("div",{className:"col-span-full text-center py-10",children:r.jsx("p",{className:"text-gray-500 text-lg",children:"No active games available in this category"})})})]})})}const S4="\r\nhttps://testingtotalapi.joywithlearning.com";function m8(){var Q,X,B,G,Y;const s=xs(),{childId:e}=Vo(),t=Bo(),[n,a]=F.useState(null),[o,i]=F.useState([]),[c,u]=F.useState([]),[h,p]=F.useState(""),[f,g]=F.useState(!0),[b,y]=F.useState(!1),[w,v]=F.useState(!1),[N,C]=F.useState(null),T=(Q=t.state)==null?void 0:Q.childData,I={"administrative-not-joined-after-registration":"Not joined after registration","administrative-services-on-hold":"Services on hold","administrative-timing-not-suitable":"Timing not suitable","academic-school-schedule-conflict":"School schedule conflict","academic-exam-period":"Exam period","health-medical-reasons":"Medical reasons","health-therapy-paused":"Therapy paused","health-weaning-off":"Weaning-off phase","health-under-observation":"Under observation",other:"Other"};F.useEffect(()=>{t.state&&t.state.childData?(a(t.state.childData),p(t.state.childData.doctorId||""),g(!1),R()):$()},[e,t.state]);const $=async()=>{try{g(!0);const Z=sessionStorage.getItem("token");if(!Z)throw new Error("Authentication token not found");const J=await Pe.get("/api/data/child/".concat(e),{headers:{Authorization:Z}});a(J.data),p(J.data.doctorId||""),g(!1),R()}catch(Z){const J=Z.response?"Error: ".concat(Z.response.status," - ").concat(Z.response.statusText):Z.message;C(J),g(!1)}},R=async()=>{try{y(!0);const Z=sessionStorage.getItem("token");if(!Z)throw new Error("Authentication token not found");const J=Cr(Z),xe=await Pe.get("/api/data/allDoctors/".concat(J.user.centreId),{headers:{Authorization:Z}}),ye=await Pe.get("/api/data/allTherapists/".concat(J.user.centreId),{headers:{Authorization:Z}});i(xe.data.doctors),u(ye.data.therapists),y(!1)}catch(Z){const J=Z.response?"Error: ".concat(Z.response.status," - ").concat(Z.response.statusText):Z.message;C(J),y(!1)}},O=()=>{if(!(n!=null&&n.doctorId))return"Not Assigned";const Z=o.find(J=>J._id===n.doctorId);return Z?Z.name:"Assigned"},P=()=>!(n!=null&&n.therapies)||n.therapies.length===0?["Not Assigned"]:n.therapies.map(Z=>{const J=c.find(xe=>xe._id===Z.therapistId);return"".concat(Z.therapyType,"  ").concat(J?J.name:"Assigned")}),_=Z=>{window.open("".concat(S4).concat(Z),"_blank")},M=()=>{s("/admindashboard/appointment?childId=".concat(n._id))},A=Z=>{const J=new Date,xe=new Date(Z);let ye=J.getFullYear()-xe.getFullYear();const ve=J.getMonth()-xe.getMonth();return(ve<0||ve===0&&J.getDate()<xe.getDate())&&ye--,ye},U=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),K=({status:Z})=>{const J=()=>Z?Z==="active"?{label:"Active",styles:"bg-green-100 text-green-800 border-green-200"}:Z==="pending"?{label:"Pending",styles:"bg-yellow-100 text-yellow-800 border-yellow-200"}:Z==="inactive"||Z.startsWith("inactive-")?{label:"Inactive",styles:"bg-red-100 text-red-800 border-red-200"}:{label:"Unknown",styles:"bg-gray-100 text-gray-800 border-gray-200"}:{label:"Pending",styles:"bg-yellow-100 text-yellow-800 border-yellow-200"},{label:xe,styles:ye}=J();return r.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(ye),children:xe})};return f?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-800"})}):N?r.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:[r.jsx("p",{children:N}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})]}):n?r.jsxs("div",{className:"p-4 sm:p-6 mt-16 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Child Details"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 w-full sm:w-auto",onClick:M,children:"Book Appointment"}),r.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",onClick:()=>s("/admindashboard/child/".concat(n._id,"/edit"),{state:{childData:n}}),children:"Edit Details"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Personal Information"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"sm:col-span-2 flex items-center gap-4 mb-4",children:[r.jsx("img",{src:n.profilePicture?"".concat(S4).concat(n.profilePicture):"https://via.placeholder.com/100?text=No+Image",alt:"Child Profile",className:"w-24 h-24 rounded-full object-cover border-2 border-[#ab1c1c]"}),r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n.name})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Full Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.name})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Date of Birth"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:U(n.dob)})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Age"}),r.jsxs("dd",{className:"text-sm font-medium text-gray-900",children:[A(n.dob)," years"]})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Gender"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.gender})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Registration Date"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:U(n.createdAt)})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Status"}),r.jsxs("dd",{children:[r.jsx(K,{status:n.admitStatus}),T.admitStatus==="inactive"&&T.inactiveReason&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:I[T.inactiveReason]||"Inactive"})]})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Other Info"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"School Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.schoolName||"N/A"})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"School Board"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.schoolBoard||"N/A"})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Case ID"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.caseId||"N/A"})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Registration ID"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.registrationId||"N/A"})]}),r.jsxs("div",{className:"border-b sm:border-b-0 pb-2 sm:pb-0",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Date of Joining"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:n.dateOfJoining?U(n.dateOfJoining):"N/A"})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Parent/Guardian Information"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Parent/Guardian Name"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((X=n.parentId)==null?void 0:X.name)||"Not provided"})]}),r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Contact Number"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((B=n.parentId)==null?void 0:B.mobilenumber)||"Not provided"})]}),r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Email Address"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((G=n.parentId)==null?void 0:G.email)||"Not provided"})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Address"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900 break-words",children:((Y=n.parentId)==null?void 0:Y.address)||"Not provided"})]})]})})]}),r.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Staff"})}),r.jsx("div",{className:"p-4",children:r.jsxs("dl",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"border-b pb-2",children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Doctor"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:b?"Loading...":O()})]}),r.jsxs("div",{children:[r.jsx("dt",{className:"text-sm text-gray-500 mb-1",children:"Therapist"}),r.jsx("dd",{className:"text-sm font-medium text-gray-900",children:b?"Loading...":P().map((Z,J)=>r.jsx("div",{children:Z},J))})]})]})})]})]}),r.jsxs("div",{className:"mt-6 bg-white shadow-md rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-red-50 px-4 py-3 border-l-4 border-[#ab1c1c]",children:r.jsx("h3",{className:"text-lg font-medium text-[#ab1c1c]",children:"Associated Files"})}),r.jsx("div",{className:"p-4",children:n.reports&&n.reports.length>0?r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Report Type"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Uploaded On"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:n.reports.map(Z=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-800",children:Z.type}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:U(Z.uploadedAt)}),r.jsx("td",{className:"px-4 py-2 text-sm space-x-2",children:r.jsx("button",{onClick:()=>_(Z.filePath),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"View"})})]},Z._id))})]})}):r.jsx("p",{className:"text-sm text-gray-500",children:"No files uploaded for this child."})})]}),r.jsx("div",{className:"mt-8 flex justify-center sm:justify-start",children:r.jsx("button",{className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 w-full sm:w-auto max-w-xs",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})})]}):r.jsxs("div",{className:"p-4 bg-yellow-100 text-yellow-700 rounded-md",children:[r.jsx("p",{children:"Child data not found."}),r.jsx("button",{className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:()=>s("/admindashboard"),children:"Back to Dashboard"})]})}function g8(){var v,N,C,T,I,$;const{childId:s}=Vo(),[e,t]=F.useState(null),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState({}),h=xs();F.useEffect(()=>{s&&(async()=>{try{a(!0);const O=await Pe.get("/api/parents/child/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(O.data),u(O.data),localStorage.setItem("centreId",O.data.centreId),a(!1)}catch(O){a(!1),console.log("Error fetching child details:",O)}})()},[s]);const p=R=>{const O=new Date(R),P=new Date;let _=P.getFullYear()-O.getFullYear();const M=P.getMonth()-O.getMonth();return(M<0||M===0&&P.getDate()<O.getDate())&&_--,_},f=R=>{const O={year:"numeric",month:"long",day:"numeric"};return new Date(R).toLocaleDateString(void 0,O)},g=R=>{const{name:O,value:P}=R.target;u(_=>({..._,[O]:P}))},b=()=>{o&&u(e),i(!o)},y=async()=>{try{a(!0),await Pe.put("/api/parents/edit-child-details/".concat(s),c,{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),t(c),i(!1),a(!1)}catch(R){a(!1),console.log("Error updating child information:",R),alert("Failed to update information. Please try again.")}},w=["CBSE","SSC","ICSE","Camebridge (IB)","NIOS","Others",""];return n?r.jsx(Gs,{}):e?r.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:r.jsxs("div",{className:"container  mx-auto px-4 py-6 bg-gray-50",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[r.jsxs("h1",{className:"text-2xl font-bold text-[#ab1c1c] ps-6",children:[e.name,"'s Details"]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>h("/parentdashboard/iepreports/".concat(s)),className:"bg-blue-500 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"IEP Reports"}),r.jsx("button",{onClick:()=>h("/parentdashboard/reports?childId=".concat(s)),className:"bg-yellow-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"Game Reports"}),r.jsx("button",{onClick:()=>h("/parentdashboard/bookappointment?childId=".concat(s)),className:"bg-purple-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-[#8e1818] transition",children:"Book Appointment"}),r.jsx("button",{onClick:b,className:"".concat(o?"bg-red-600 hover:bg-red-700":"bg-slate-600 hover:bg-[#8e1818]"," text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow transition"),children:o?"Cancel":"Edit Information"}),o&&r.jsx("button",{onClick:y,className:"bg-green-600 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-green-700 transition",children:"Save Changes"})]})]}),r.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 border border-gray-200",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6",children:[r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Personal Information"}),r.jsx("div",{className:"space-y-4",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),r.jsx("input",{type:"text",name:"name",value:c.name||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"dob",value:c.dob?new Date(c.dob).toISOString().split("T")[0]:"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),r.jsxs("select",{name:"gender",value:c.gender||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out appearance-none bg-white",children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",e.name]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Age:"})," ",p(e.dob)," years"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Date of Birth:"})," ",f(e.dob)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Gender:"})," ",e.gender]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Admit Status:"})," ",r.jsx("span",{className:"px-2 py-1 rounded text-xs ".concat(e.admitStatus==="active"?"bg-green-100 text-green-800":e.admitStatus==="inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.admitStatus.charAt(0).toUpperCase()+e.admitStatus.slice(1)})]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Centre name:"})," ",e.centreId.name]})]})})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Education Information"}),r.jsx("div",{className:"space-y-4",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name"}),r.jsx("input",{type:"text",name:"schoolName",value:c.schoolName||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out",placeholder:"Enter school name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Board"}),r.jsxs("select",{name:"schoolBoard",value:c.schoolBoard||"",onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 sm:py-3 sm:px-4 focus:ring-2 focus:ring-[#ab1c1c] focus:border-[#ab1c1c] transition duration-150 ease-in-out appearance-none bg-white",children:[r.jsx("option",{value:"",children:"Select School Board"}),w.map((R,O)=>R&&r.jsx("option",{value:R,children:R},O))]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Name:"})," ",e.schoolName||"Not specified"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Board:"})," ",e.schoolBoard||"Not specified"]})]})})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6 mb-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Associated Professionals"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Doctor:"})," ",((v=e==null?void 0:e.doctorId)==null?void 0:v.name)||"Not assigned"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Therapist:"})," ",((N=e==null?void 0:e.therapistId)==null?void 0:N.name)||"Not assigned"]})]})]})}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[r.jsx("h3",{className:"font-semibold text-[#ab1c1c] mb-3",children:"Records"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IEPs:"})," ",((C=e.IEPs)==null?void 0:C.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Prescription Reports:"})," ",((T=e.prescriptionReports)==null?void 0:T.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Appointments:"})," ",((I=e.appointments)==null?void 0:I.length)||0," records"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Game Reports:"})," ",(($=e.gameReports)==null?void 0:$.length)||0," records"]})]})]})}),r.jsx("div",{className:"flex justify-center mt-6",children:r.jsx("button",{onClick:()=>h("/parentdashboard"),className:"bg-gray-500 text-white px-3 py-2 text-sm sm:text-base sm:px-4 sm:py-2 rounded-md shadow hover:bg-gray-600 transition",children:"Back to Dashboard"})})]})]})}):r.jsx("div",{className:"text-center py-10 mt-16",children:"Child not found"})}const Oj=()=>{const[s]=A6(),e=s.get("childId"),[t,n]=F.useState([]);return F.useEffect(()=>{(async()=>{try{const o=await Pe.get("/api/data/gameReports/".concat(e));n(o.data)}catch(o){console.error("Error fetching game reports:",o)}})()},[e]),r.jsxs("div",{className:"p-6 ",children:[r.jsx("h1",{className:"text-2xl font-bold text-center text-[#ab1c1c] mb-6",children:"Game Reports"}),t.length===0?r.jsx("div",{className:"text-[#ab1c1c] text-lg",children:"No game reports found"}):r.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md",children:r.jsxs("table",{className:"min-w-full bg-red-100",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-200 text-[#ab1c1c]",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Game"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Tries"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Timer"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Status"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-300 text-left text-sm font-semibold uppercase",children:"Date Played"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:t.map(a=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:a.name}),r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:a.tries}),r.jsxs("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:[a.timer.toFixed(2)," seconds"]}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium \n        ".concat(a.status==="completed"?"bg-green-200 text-green-800":"bg-red-100 text-red-800"),children:a.status})}),r.jsx("td",{className:"px-6 py-4 text-sm text-[#ab1c1c]",children:new Date(a.datePlayed).toLocaleDateString("en-GB")})]},a._id))})]})})]})};function _j(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState(null);F.useEffect(()=>{(async()=>{try{a(!0);const g=await Pe.get("/api/parents/iep/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(g.data),a(!1)}catch(g){a(!1),console.log("Error fetching IEP data:",g)}})()},[s]);const h=f=>{u(f),i(!0)},p=()=>c?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Version History for ",c.therapy," IEP"]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-red-500",onClick:()=>i(!1),children:""})]}),r.jsx("div",{className:"p-6",children:c.monthlyGoals.map((f,g)=>{var v;const b=f.history;b.sort((N,C)=>new Date(C.updatedAt)-new Date(N.updatedAt));const y=f.latest,w=b.slice(1);return r.jsxs("div",{className:"mb-8",children:[r.jsxs("h6",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:[f.latest.month," - History"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Current Version"}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",y.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:y.goals.map((N,C)=>r.jsx("li",{children:N},C))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((v=y.performance)==null?void 0:v.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:y.performance.map((N,C)=>r.jsxs("li",{children:[N,"%"]},C))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:y.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:y.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Last Updated:"," ",new Date(y.updatedAt).toLocaleString()]})]})]}),w.length>0?r.jsxs("div",{children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Previous Versions"}),r.jsx("div",{className:"space-y-4",children:w.map((N,C)=>{var T;return r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",N.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:N.goals.map((I,$)=>r.jsx("li",{children:I},$))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((T=N.performance)==null?void 0:T.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:N.performance.map((I,$)=>r.jsxs("li",{children:[I,"%"]},$))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:N.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:N.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Updated:"," ",new Date(N.updatedAt).toLocaleString()]})]},C)})})]}):r.jsx("p",{className:"text-gray-500 italic",children:"No previous versions available"})]},g)})}),r.jsx("div",{className:"p-6 border-t border-red-200",children:r.jsx("button",{type:"button",className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>i(!1),children:"Close"})})]})}):null;return n?r.jsx(Gs,{}):r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-16",children:[r.jsx("h1",{className:"text-2xl font-bold text-center text-[#ab1c1c] mb-6",children:"IEP Reports"}),e.length>0?r.jsx("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6",children:r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Starting Month"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:e.map((f,g)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:f.therapy}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:[f.startingMonth," ",f.startingYear]}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm space-x-2",children:[r.jsx("button",{onClick:()=>$u(f),className:"bg-green-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-green-700 transition",children:"Generate PDF"}),r.jsx("button",{onClick:()=>h(f),className:"bg-purple-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-purple-700 transition",children:"View History"})]})]},g))})]})}):r.jsx("div",{className:"flex items-center justify-center",children:r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No IEP data available"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"IEP has not been assigned to the child yet."})]})}),o&&p()]})}const x8="\r\nhttps://testingtotalapi.joywithlearning.com";function b8(){const{childId:s}=Vo(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState(null),[h,p]=F.useState([]),[f,g]=F.useState(""),b=xs();F.useEffect(()=>{(async()=>{try{a(!0);const T=await Pe.get("/api/admins/iep/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(T.data),a(!1)}catch(T){a(!1),console.log("Error fetching IEP data:",T)}})()},[s]),F.useEffect(()=>{(async()=>{var T;try{const I=await Pe.get("/api/admins/child/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}});g(I.data.name||"Child");const $=((T=I.data.reports)==null?void 0:T.filter(R=>R.type==="IEP"))||[];console.log("ieps are : ",$),p($)}catch(I){console.log("Error fetching IEP reports:",I)}})()},[s]);const y=C=>{window.open("".concat(x8).concat(C),"_blank")},w=C=>new Date(C).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),v=C=>{u(C),i(!0)},N=()=>c?r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-4 flex flex-col items-center justify-center",children:[r.jsx("div",{className:"w-full max-w-4xl mb-4 flex justify-start",children:r.jsxs("button",{onClick:()=>b(-1),className:"flex items-center text-[#ab1c1c] hover:text-[#8e1818] transition-colors",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Dashboard"]})}),r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] text-center mb-6",children:"IEP Reports"}),r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b border-red-200 flex justify-between items-center",children:[r.jsxs("h5",{className:"text-2xl font-bold text-[#ab1c1c]",children:["Version History for ",c.therapy," IEP"]}),r.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 text-2xl border-2 px-3 py-1 rounded border-red-500",onClick:()=>i(!1),children:""})]}),r.jsx("div",{className:"p-6",children:c.monthlyGoals.map((C,T)=>{var O;const I=C.history;I.sort((P,_)=>new Date(_.updatedAt)-new Date(P.updatedAt));const $=C.latest,R=I.slice(1);return r.jsxs("div",{className:"mb-8",children:[r.jsxs("h6",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:[C.latest.month," - History"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Current Version"}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",$.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:$.goals.map((P,_)=>r.jsx("li",{children:P},_))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((O=$.performance)==null?void 0:O.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:$.performance.map((P,_)=>r.jsxs("li",{children:[P,"%"]},_))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:$.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:$.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Last Updated:"," ",new Date($.updatedAt).toLocaleString()]})]})]}),R.length>0?r.jsxs("div",{children:[r.jsx("h6",{className:"text-lg font-medium text-[#ab1c1c] mb-2",children:"Previous Versions"}),r.jsx("div",{className:"space-y-4",children:R.map((P,_)=>{var M;return r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsxs("p",{className:"font-medium",children:["Target: ",P.target]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Goals:"}),r.jsx("ul",{className:"list-disc pl-5",children:P.goals.map((A,U)=>r.jsx("li",{children:A},U))})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Performance:"}),((M=P.performance)==null?void 0:M.length)>0?r.jsx("ul",{className:"list-disc pl-5",children:P.performance.map((A,U)=>r.jsxs("li",{children:[A,"%"]},U))}):r.jsx("p",{className:"text-gray-500",children:"No performance data"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Therapist Feedback:"}),r.jsx("p",{children:P.therapistFeedback||"No feedback"})]}),r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"font-medium",children:"Doctor Feedback:"}),r.jsx("p",{children:P.doctorFeedback||"No feedback"})]}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Updated:"," ",new Date(P.updatedAt).toLocaleString()]})]},_)})})]}):r.jsx("p",{className:"text-gray-500 italic",children:"No previous versions available"})]},T)})}),r.jsx("div",{className:"p-6 border-t border-red-200",children:r.jsx("button",{type:"button",className:"bg-[#ab1c1c] hover:bg-[#8e1818] text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300",onClick:()=>i(!1),children:"Close"})})]})})]}):null;return n?r.jsx(Gs,{}):r.jsxs("div",{className:"container mx-auto px-4 py-6 mt-4 flex flex-col items-center justify-center ",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] text-center mb-6",children:"IEP Reports"}),e.length>0?r.jsx("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 w-full max-w-4xl",children:r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-red-100",children:[r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Therapy"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Starting Month"}),r.jsx("th",{className:"px-6 py-3 border-b-2 border-red-200 text-left text-sm font-semibold text-[#ab1c1c]",children:"Actions"})]})}),r.jsx("tbody",{children:e.map((C,T)=>r.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:C.therapy}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm text-gray-700",children:[C.startingMonth," ",C.startingYear]}),r.jsxs("td",{className:"px-6 py-4 border-b border-red-100 text-sm space-x-2",children:[r.jsx("button",{onClick:()=>$u(C),className:"bg-green-600 text-white px-3 py-2 text-sm rounded-md shadow hover:bg-green-700 transition",children:"Generate PDF"}),r.jsx("button",{onClick:()=>v(C),className:"bg-[#ab1c1c] text-white px-3 py-2 text-sm rounded-md shadow hover:bg-[#8e1818] transition",children:"View History"})]})]},T))})]})}):r.jsxs("div",{className:"bg-white border border-red-100 rounded-lg shadow-sm p-6 max-w-2xl w-full text-center flex flex-col items-center justify-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-50 mb-4",children:r.jsx("svg",{className:"h-6 w-6 text-[#ab1c1c]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No IEP data available"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"IEP has not been assigned to the child yet."})]}),o&&N(),r.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-4 sm:p-6 w-full max-w-4xl mt-10",children:[r.jsxs("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:["Past IEP Reports ",f&&" ".concat(f)]}),h.length>0?r.jsxs("table",{className:"min-w-full bg-white",children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Report Type"}),r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Uploaded On"}),r.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:"Action"})]})}),r.jsx("tbody",{children:h.map(C=>r.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 text-sm",children:C.type}),r.jsx("td",{className:"px-4 py-2 text-sm",children:w(C.uploadedAt)}),r.jsx("td",{className:"px-4 py-2",children:r.jsx("button",{onClick:()=>y(C.filePath),className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",children:"View"})})]},C._id))})]}):r.jsx("p",{className:"text-gray-500 text-sm",children:"No past IEP reports available."})]})]})}const y8=()=>{const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(null),[u,h]=F.useState([]),[p,f]=F.useState(!1),{referenceId:g}=Vo(),b=xs();F.useEffect(()=>((async()=>{try{const N=await Pe.get("/api/admins/get-jwl-enquiry/".concat(g),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(N.data);const C=await Pe.get("/api/jwl/jwlenquirequestions",{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});h(C.data);try{const T=await Pe.get("/api/admins/get-jwluser-video/".concat(N.data.parentEmail),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))},responseType:"blob"}),I=new Blob([T.data],{type:T.headers["content-type"]}),$=URL.createObjectURL(I);c($)}catch(T){console.error("Failed to fetch video",T)}n(!1)}catch(N){o("Failed to fetch data"),n(!1),console.error(N)}})(),()=>{i&&URL.revokeObjectURL(i)}),[g]);const y=v=>{const N=parseInt(v.replace("q",""));return u.find(C=>C.number===N)},w=()=>{f(!p)};return t?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsx(Gs,{})}):a?r.jsx("div",{className:"flex justify-center items-center h-screen text-red-600",children:a}):s?r.jsx("div",{className:"mt-10 mb-16 py-8 px-4 sm:px-6 lg:px-8",children:r.jsx("div",{className:"max-w-6xl mx-auto",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[r.jsx("div",{className:"bg-[#ab1c1c] p-6 text-white",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>b(-1),className:"flex items-center text-sm font-medium text-white hover:text-red-100 transition duration-150",children:[r.jsx("svg",{className:"h-5 w-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Enquiries"]}),r.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Enquiry Details"}),r.jsxs("p",{className:"text-red-100 mt-1",children:["Reference ID: ",s.referenceId]})]}),r.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(s.isArchived?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:s.isArchived?"Archived":"Active"})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Child Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ci,{label:"Name",value:s.childName}),r.jsx(Ci,{label:"Age",value:s.childAge}),r.jsx(Ci,{label:"Gender",value:s.childGender})]})]}),r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Parent Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ci,{label:"Name",value:s.parentName}),r.jsx(Ci,{label:"Email",value:s.parentEmail}),r.jsx(Ci,{label:"Phone",value:s.parentPhoneNo})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg mb-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Other Details"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsx(Ci,{label:"Preferred Center",value:s.preferredCenter}),r.jsx(Ci,{label:"Enquiry Date",value:Ij(new Date(s.enquiryDate),"dd MMM yyyy")})]})]}),s.checklist&&r.jsxs("div",{className:"mb-8",children:[r.jsxs("button",{onClick:w,className:"flex items-center justify-between w-full bg-red-50 hover:bg-red-100 text-[#ab1c1c] font-medium py-3 px-4 rounded-lg transition duration-200",children:[r.jsx("span",{children:"View Questionnaire Responses"}),p?r.jsx(O5,{className:"h-5 w-5"}):r.jsx(E5,{className:"h-5 w-5"})]}),p&&r.jsx("div",{className:"mt-4 bg-white border border-red-200 rounded-lg p-5 shadow-sm",children:r.jsx("div",{className:"space-y-6",children:Object.entries(s.checklist).map(([v,N])=>{const C=y(v);return r.jsx("div",{className:"pb-4 border-b border-red-100 last:border-0",children:C?r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:C.question}),C.example&&r.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[r.jsx("span",{className:"font-medium",children:"Example:"})," ",C.example]}),r.jsxs("p",{className:"mt-2 text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Response:"})," ",r.jsx("span",{className:"text-[#ab1c1c]",children:N.toString()})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:v}),r.jsxs("p",{className:"mt-2 text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Response:"})," ",r.jsx("span",{className:"text-[#ab1c1c]",children:N.toString()})]})]})},v)})})})]}),s.additionalNotes&&r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg mb-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Additional Notes"}),r.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:s.additionalNotes})]}),i&&r.jsxs("div",{className:"bg-red-50 p-5 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-red-200",children:"Video Submission"}),r.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:r.jsxs("video",{controls:!0,className:"w-full",children:[r.jsx("source",{src:i,type:"video/mp4"}),"Your browser does not support the video tag."]})})]})]})]})})}):r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Enquiry not found"})},Ci=({label:s,value:e})=>r.jsxs("div",{className:"flex",children:[r.jsxs("span",{className:"text-gray-600 font-medium w-1/3",children:[s,":"]}),r.jsx("span",{className:"text-gray-800 flex-1",children:e})]}),v8="/assets/defaultUser-Cz2xbWm6.webp",eh={error:(s,e)=>{console.error("[ERROR] ".concat(s),e)},warn:(s,e)=>{console.warn("[WARN] ".concat(s),e)},info:(s,e)=>{console.info("[INFO] ".concat(s),e)},debug:(s,e)=>{console.debug("[DEBUG] ".concat(s),e)}};function w8(){const s=Th(),[e,t]=F.useState(null),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState({}),[h,p]=F.useState(!1),[f,g]=F.useState(null),[b,y]=F.useState(null),[w,v]=F.useState(!1),N=F.useRef(null),[C,T]=F.useState(!1),[I,$]=F.useState({currentPassword:"",newPassword:"",confirmPassword:""}),R="\r\nhttps://testingtotalapi.joywithlearning.com";console.log("API URL:",R);const O=xs();F.useEffect(()=>{P()},[]);const P=async()=>{const G=sessionStorage.getItem("token");if(!G){O("/login");return}const Y=sessionStorage.getItem("role"),Z=sessionStorage.getItem("".concat(Y,"Id"));try{a(!0);const J=await Pe.get("/api/data/allUsers/".concat(Z),{headers:{Authorization:"".concat(G)}});t(J.data),u(J.data),eh.info("User data fetched:",J.data)}catch(J){eh.error("Error fetching user:",J),K("Failed to load profile data","error")}finally{a(!1)}},_=()=>{o&&u(e),i(!o)},M=G=>{const{name:Y,value:Z}=G.target;u({...c,[Y]:Z})},A=async()=>{const G=sessionStorage.getItem("token"),Y=sessionStorage.getItem("role"),Z=sessionStorage.getItem("".concat(Y,"Id"));try{const J=await Pe.put("/api/data/updateUser/".concat(Z),c,{headers:{Authorization:"".concat(G)}});t(J.data),i(!1),K("Profile updated successfully!","success"),s(M5({key:"name",value:J.data.name}))}catch(J){eh.error("Error updating profile:",J),K("Failed to update profile","error")}},U=async G=>{var xe,ye;if(G.preventDefault(),I.newPassword!==I.confirmPassword){K("New passwords do not match","error");return}const Y=sessionStorage.getItem("token"),Z=sessionStorage.getItem("role"),J=sessionStorage.getItem("".concat(Z,"Id"));try{await Pe.put("/api/data/changePassword/".concat(J),{currentPassword:I.currentPassword,newPassword:I.newPassword},{headers:{Authorization:"".concat(Y)}}),T(!1),$({currentPassword:"",newPassword:"",confirmPassword:""}),K("Password changed successfully! \n You will be redirected to Login page","success"),setTimeout(()=>{sessionStorage.removeItem("role"),sessionStorage.removeItem("token"),sessionStorage.removeItem(Z+"Id"),s(Oy()),O("/login")},3e3)}catch(ve){eh.error("Error changing password:",ve),K(((ye=(xe=ve.response)==null?void 0:xe.data)==null?void 0:ye.message)||"Failed to change password","error")}},K=(G,Y)=>{switch(Y){case"success":Ve.success(G);break;case"error":Ve.error(G);break;case"info":Ve.info(G);break;case"warning":Ve.warning(G);break;default:Ve(G)}},Q=G=>{const Y=G.target.files[0];if(Y){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(Y.type)){K("Please select a valid image file (JPG, PNG, GIF, WebP)","error");return}if(Y.size>5*1024*1024){K("File size should be less than 5MB","error");return}g(Y);const J=new FileReader;J.onloadend=()=>{y(J.result)},J.readAsDataURL(Y)}},X=async()=>{var J,xe;if(!f){K("Please select a file first","error");return}v(!0);const G=sessionStorage.getItem("token"),Y=sessionStorage.getItem("role"),Z=sessionStorage.getItem("".concat(Y,"Id"));try{const ye=new FormData;ye.append("profilePhoto",f);const ve=await Pe.put("/api/data/updateProfilePhoto/".concat(Z),ye,{headers:{Authorization:"".concat(G),"Content-Type":"multipart/form-data"}});ve.data.success&&(t({...e,profilePhoto:ve.data.profilePhoto}),p(!1),g(null),y(null),N.current&&(N.current.value=""),K("Profile photo updated successfully!","success"))}catch(ye){eh.error("Upload error:",ye),K(((xe=(J=ye.response)==null?void 0:J.data)==null?void 0:xe.message)||"Failed to upload profile photo","error")}finally{v(!1)}},B=()=>{g(null),y(null),p(!1),N.current&&(N.current.value="")};return n?r.jsx("div",{className:"flex justify-center items-center ",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 m-20 border-red-800"})}):e?r.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),r.jsx("div",{className:"max-w-3xl mx-auto",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[r.jsxs("div",{className:"bg-[#ab1c1c] px-6 py-8 rounded-t-xl flex flex-col md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{className:"flex flex-col justify-center md:items-start text-center md:text-left",children:[r.jsx("h1",{className:"text-3xl font-bold text-white",children:"Your Profile"}),r.jsxs("p",{className:"mt-2 text-red-100",children:["Hello, ",e.name||e.mobilenumber||"User","!"]})]}),e.role==="therapist"&&r.jsx("div",{className:"mt-6 md:mt-0 md:ml-8 flex flex-col items-center",children:r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:e.profilePhoto?"".concat(R,"/uploads/profilePhotos/").concat(e.profilePhoto):v8,alt:"Profile",className:"w-36 h-36 rounded-full border-4 border-white object-cover shadow-xl"}),r.jsx("button",{onClick:()=>p(!0),className:"mt-3 px-4 py-1 text-sm bg-white text-[#ab1c1c] rounded-full shadow hover:bg-gray-100 transition",children:e.profilePhoto?"Update Profile Photo":"Add Profile Photo"})]})})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-red-50 rounded-lg p-6 mb-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c]",children:"Personal Information"}),r.jsx("button",{onClick:_,className:"px-4 py-2 rounded-lg text-white ".concat(o?"bg-gray-500 hover:bg-gray-600":"bg-[#ab1c1c] hover:bg-[#8e1818]"," transition duration-300"),children:o?"Cancel":"Edit Information"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Name:"}),o?r.jsx("input",{type:"text",name:"name",value:c.name||"",onChange:M,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.name||"Not provided"})]}),e.role==="therapist"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Designation:"}),o?r.jsx("input",{type:"text",name:"designation",value:c.designation||"",onChange:M,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.designation||"Not provided"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Qualification:"}),o?r.jsx("input",{type:"text",name:"qualification",value:c.qualification||"",onChange:M,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.qualification||"Not provided"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"RCI Number:"}),o?r.jsx("input",{type:"text",name:"rciNumber",value:c.rciNumber||"",onChange:M,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.rciNumber||"Not provided"})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Phone:"}),o?r.jsx("input",{type:"text",name:"mobilenumber",value:c.mobilenumber||"",onChange:M,className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.mobilenumber||"Not provided"})]}),e.role==="parent"?r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[r.jsx("span",{className:"w-32 font-medium text-gray-600",children:"Address:"}),o?r.jsx("textarea",{name:"address",value:c.address||"",onChange:M,rows:"3",className:"mt-1 md:mt-0 flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}):r.jsx("span",{className:"mt-1 md:mt-0 text-gray-800",children:e.address||"Not provided"})]}):null,o&&r.jsx("div",{className:"flex justify-end mt-6",children:r.jsx("button",{onClick:A,className:"px-6 py-2 bg-[#8e1818] text-white rounded-lg hover:bg-red-700 transition duration-300",children:"Save Changes"})})]})]}),e.role==="therapist"&&r.jsxs("div",{className:"bg-red-50 rounded-lg p-6 mb-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c] mb-6",children:"Feedback"}),r.jsx("div",{className:"space-y-6",children:e.feedback&&e.feedback.length>0?e.feedback.map((G,Y)=>r.jsxs("div",{className:"p-4 bg-white border border-gray-300 rounded-lg shadow-sm",children:[r.jsx("div",{className:"flex justify-between items-center mb-2",children:r.jsx("span",{className:"text-sm text-gray-500",children:G.date?new Date(G.date).toLocaleDateString():"Date N/A"})}),r.jsx("p",{className:"text-gray-800 italic whitespace-pre-wrap",children:G.content||"No content provided."})]},G._id||Y)):r.jsx("p",{className:"text-gray-700 text-center py-4",children:"No feedback available yet."})})]}),r.jsxs("div",{className:"bg-red-50 rounded-lg p-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-[#ab1c1c] mb-6",children:"Password Management"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:()=>T(!0),className:"px-6 py-3 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300 w-full md:w-1/2",children:"Change Password"})})]})]})]})}),C&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-[#ab1c1c] mb-6",children:"Change Password"}),r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"Current Password"}),r.jsx("input",{type:"password",value:I.currentPassword,onChange:G=>$({...I,currentPassword:G.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"New Password"}),r.jsx("input",{type:"password",value:I.newPassword,onChange:G=>$({...I,newPassword:G.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-gray-700 mb-2",children:"Confirm New Password"}),r.jsx("input",{type:"password",value:I.confirmPassword,onChange:G=>$({...I,confirmPassword:G.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#ab1c1c] focus:border-[#ab1c1c]",required:!0})]})]}),r.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[r.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300",children:"Update Password"})]})]})]})}),h&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[r.jsx("button",{onClick:B,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("h2",{className:"text-2xl font-bold text-[#ab1c1c] mb-6",children:"Update Profile Photo"}),r.jsxs("div",{className:"mb-6 text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:b?r.jsx("img",{src:b,alt:"Profile Preview",className:"w-40 h-40 rounded-full object-cover border-4 border-[#ab1c1c]"}):r.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-200 flex items-center justify-center border-4 border-[#ab1c1c]",children:r.jsx("svg",{className:"w-20 h-20 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),r.jsx("p",{className:"text-gray-600 text-sm",children:f?"New photo selected":"Photo preview"})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:Q,className:"hidden",id:"photoInput"}),r.jsxs("label",{htmlFor:"photoInput",className:"block w-full bg-red-100 text-[#ab1c1c] border-2 border-dashed border-[#ab1c1c] rounded-lg p-4 text-center cursor-pointer hover:bg-red-200 transition duration-200",children:[r.jsx("svg",{className:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),r.jsx("p",{className:"font-semibold",children:"Click to select photo"}),r.jsx("p",{className:"text-sm text-gray-600",children:"JPG, PNG, GIF, WebP (Max 5MB)"})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:X,disabled:!f||w,className:"flex-1 py-2 rounded-lg font-semibold transition duration-200 ".concat(f&&!w?"bg-[#ab1c1c] text-white hover:bg-[#8e1818]":"bg-gray-300 text-gray-600 cursor-not-allowed"),children:w?"Uploading...":"Upload Photo"}),r.jsx("button",{onClick:B,disabled:w,className:"flex-1 py-2 rounded-lg font-semibold bg-gray-300 text-gray-800 hover:bg-gray-400 transition duration-200 disabled:opacity-50",children:"Cancel"})]})]})})]}):r.jsx("div",{className:"flex justify-center items-center bg-red-50",children:r.jsxs("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c]",children:"User not found"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Please try logging in again"}),r.jsx("button",{onClick:()=>O("/login"),className:"mt-4 px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8e1818] transition duration-300",children:"Go to Login"})]})})}const Fj="/assets/Delete-Dh1e9pDH.png",N8=()=>r.jsx("div",{className:"flex justify-center items-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#ab1c1c]"})}),S8=({currentDate:s,setCurrentDate:e,handleDayClick:t,role:n,setShowEditHolidaysPopup:a,holidays:o=[]})=>{const i=s.getFullYear(),c=s.getMonth(),u=new Date(i,c,1).getDay(),h=new Date(i,c+1,0).getDate(),p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],g=v=>{const N="".concat(i,"-").concat(String(c+1).padStart(2,"0"),"-").concat(String(v).padStart(2,"0"));return o.some(C=>new Date(C.date).toISOString().split("T")[0]===N)},b=F.useMemo(()=>{const v=[],N=new Date,C=N.getDate(),T=N.getMonth()===c&&N.getFullYear()===i;for(let I=0;I<u;I++)v.push({day:null,isCurrentMonth:!1});for(let I=1;I<=h;I++){const $=T&&I===C,R=g(I);v.push({day:I,isCurrentMonth:!0,isToday:$,isHoliday:R})}return v},[i,c,u,h,o,g]),y=()=>{const v=new Date(i,c-1,1);e(v)},w=()=>{const v=new Date(i,c+1,1);e(v)};return r.jsxs("div",{className:"flex flex-col items-center p-4 w-full max-w-sm",children:[r.jsxs("div",{className:"flex items-center justify-between w-full mb-4 px-2",children:[r.jsx("button",{onClick:y,className:"text-[#ab1c1c] text-xl p-1",children:"Prev"}),r.jsxs("h3",{className:"text-xl font-bold text-[#ab1c1c]",children:[f[c]," ",i]}),r.jsx("button",{onClick:w,className:"text-[#ab1c1c] text-xl p-1",children:"Next"})]}),r.jsx("div",{className:"grid grid-cols-7 text-center text-sm font-semibold text-gray-700 mb-2 w-full",children:p.map(v=>r.jsx("div",{className:"py-1",children:v},v))}),r.jsx("div",{className:"grid grid-cols-7 gap-1 text-center w-full",children:b.map((v,N)=>r.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-full text-sm transition duration-150 mx-auto\n              ".concat(v.day?"cursor-pointer hover:bg-red-100":"text-gray-300","\n              ").concat(v.isToday&&v.isHoliday?"bg-gradient-to-br from-[#ab1c1c] to-green-500 text-white font-bold ring-2 ring-yellow-400":v.isToday?"bg-[#ab1c1c] text-white font-bold ring-2 ring-red-300":v.isHoliday?"bg-green-500 text-white font-semibold":v.day?"text-gray-800":"","\n            "),onClick:v.day?()=>t(v.day):null,children:v.day},N))}),r.jsx("div",{className:"mt-4 space-y-2",children:r.jsxs("div",{className:"flex items-center justify-center space-x-3 text-xs",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-[#ab1c1c] rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Today"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),r.jsx("span",{className:"text-gray-600",children:"Holiday"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-[#ab1c1c] to-green-500 rounded-full ring-1 ring-yellow-400"}),r.jsx("span",{className:"text-gray-600",children:"Today + Holiday"})]})]})}),n==="superadmin"&&r.jsx("button",{onClick:()=>a(!0),className:"mt-4 w-full bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold py-2 rounded-lg transition duration-150 shadow-lg",children:"Edit Holidays"})]})},C8=({holidays:s})=>{const e=new Date,n=[...s].sort((i,c)=>new Date(i.date)-new Date(c.date)).filter(i=>new Date(i.date).setHours(0,0,0,0)>=e.setHours(0,0,0,0)),a=n[0]||null,o=i=>new Date(i).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-xl font-bold text-[#ab1c1c] mb-4",children:"Upcoming Holidays"}),r.jsx("div",{className:"max-h-[300px] overflow-y-auto pr-2 space-y-3",children:n.length>0?n.map((i,c)=>{const u=a&&i._id===a._id,h=u?"bg-red-100 border-l-8 border-red-500 shadow-md transform scale-[1.02]":"bg-red-50 border-l-4 border-[#ab1c1c] shadow-sm hover:bg-red-100";return r.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg transition duration-300 ".concat(h),children:[r.jsx("span",{className:"text-gray-800 ".concat(u?"font-bold":"font-semibold"),children:i.name}),r.jsx("span",{className:"text-sm text-gray-700 ".concat(u?"font-bold":""),children:o(i.date)})]},i._id||c)}):r.jsx("p",{className:"text-gray-500",children:"No upcoming holidays scheduled."})})]})},j8=({holidays:s,onSave:e,onClose:t})=>{const[n,a]=F.useState(s),[o,i]=F.useState(""),[c,u]=F.useState(""),[h,p]=F.useState(!1),[f,g]=F.useState(null),[b,y]=F.useState(!1),w=sessionStorage.getItem("token"),v=async I=>{const $=n[I];if(g($._id),$._id)try{await Pe.delete("/api/superadmin/holidays/".concat($._id),{headers:{Authorization:"".concat(w)}})}catch(R){console.error("Error deleting holiday:",R),alert("Failed to delete holiday."),g(null);return}a(R=>R.filter((O,P)=>P!==I)),g(null)},N=async()=>{if(o&&c){p(!0);try{await Pe.post("/api/superadmin/holidays",{name:c,date:o},{headers:{Authorization:"".concat(w)}}),i(""),u("");const I=await Pe.get("/api/superadmin/holidays",{headers:{Authorization:"".concat(w)}});a(I.data.data)}catch(I){console.error("Error adding holiday:",I),alert("Failed to add holiday.")}finally{p(!1)}}else alert("Please enter both date and occasion for the new holiday.")},C=async()=>{y(!0);try{await e(),t()}catch(I){console.error("Error saving:",I)}finally{y(!1)}},T=I=>new Date(I).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-auto relative border-t-4 border-[#ab1c1c]",children:[r.jsx("h3",{className:"text-xl font-bold text-[#ab1c1c] mb-4 text-center",children:"Edit Holidays"}),r.jsx("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto pr-2",children:n.length>0?n.map((I,$)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded-md border-l-2 border-gray-300",children:[r.jsxs("p",{className:"text-sm text-gray-800",children:[r.jsxs("span",{className:"font-semibold text-gray-700",children:[T(I.date),":"]})," ",I.name]}),r.jsx("button",{onClick:()=>v($),disabled:f===I._id,className:"text-red-600 hover:text-red-800 p-1 rounded-full transition duration-150 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f===I._id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):r.jsx("img",{src:Fj,alt:"Delete",className:"w-5 h-5"})})]},I._id||$)):r.jsx("p",{className:"text-gray-500 text-sm text-center",children:"No holidays added yet."})}),r.jsxs("div",{className:"mb-6 border-t pt-4",children:[r.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Add New Holiday"}),r.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 items-end",children:[r.jsxs("div",{className:"col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Date"}),r.jsx("input",{type:"date",value:o,onChange:I=>i(I.target.value),disabled:h,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),r.jsxs("div",{className:"col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Occasion"}),r.jsx("input",{type:"text",value:c,onChange:I=>u(I.target.value),disabled:h,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"e.g., Christmas"})]}),r.jsx("button",{onClick:N,disabled:h||!o||!c,className:"col-span-1 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium py-2 rounded-md transition duration-150 text-sm flex items-center justify-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-1"}),"Adding..."]}):"Add"})]})]}),r.jsx("button",{onClick:C,disabled:b||h||f,className:"w-full bg-[#ab1c1c] hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold py-2 rounded-md transition duration-150 shadow-lg flex items-center justify-center",children:b?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"}),r.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",children:""})]})})};function k8(){const s=xs(),[e,t]=F.useState(new Date),[n,a]=F.useState(!0),[o,i]=F.useState(!1),[c,u]=F.useState([]),[h,p]=F.useState(!1),[f,g]=F.useState("");F.useEffect(()=>{const y=sessionStorage.getItem("token"),w=sessionStorage.getItem("role");if(!y){s("/login");return}g(w),b()},[s]);const b=async(y=!1)=>{try{y?i(!0):a(!0);const w=sessionStorage.getItem("token"),v=await Pe.get("/api/superadmin/holidays",{headers:{Authorization:"".concat(w)}});u(v.data.data||[])}catch(w){console.error("Error fetching holidays:",w)}finally{y?i(!1):a(!1)}};return n?r.jsx(N8,{}):r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c] mb-4",children:"Calendar"}),r.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-start gap-6",children:[r.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-xl p-4 flex justify-center min-w-[300px]",children:r.jsx(S8,{currentDate:e,setCurrentDate:t,handleDayClick:y=>console.log("Clicked day:",y),role:sessionStorage.getItem("role"),setShowEditHolidaysPopup:p,holidays:c})}),r.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-xl p-4 min-w-[300px]",children:r.jsx(C8,{holidays:c})})]}),f==="superadmin"&&h&&r.jsx(j8,{holidays:c,onSave:()=>b(!0),onClose:()=>p(!1)}),o&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-40",children:r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-700 font-medium",children:"Refreshing holidays..."})]})})]})}const T8=()=>r.jsx("div",{className:"flex justify-center items-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#ab1c1c]"})});function I8(){const[s,e]=F.useState(!0),[t,n]=F.useState([]),[a,o]=F.useState(!1),[i,c]=F.useState(!1),[u,h]=F.useState(null),[p,f]=F.useState(""),[g,b]=F.useState({message:"",link:"",displayInScroller:!1,targetType:"all",targetRoles:[]}),[y,w]=F.useState(!1),[v,N]=F.useState(!1),[C,T]=F.useState([]),I=[{key:"admin",label:"Admin"},{key:"parent",label:"Parent"},{key:"doctor",label:"Doctor"},{key:"therapist",label:"Therapist"},{key:"superadmin",label:"Superadmin"}];F.useEffect(()=>{const A=sessionStorage.getItem("role");if(!sessionStorage.getItem("token")){e(!1);return}f(A),$(A)},[]);const $=async A=>{try{e(!0);const U=sessionStorage.getItem("token");let X=(await Pe.get("/api/superadmin/announcements",{headers:{Authorization:"".concat(U)}})).data||[];console.log("All Announcements from API:",X),console.log("User Role:",A),A!=="superadmin"&&(console.log("Filtering announcements for role:",A),X=X.filter(B=>B.targetType==="all"?!0:B.targetType==="specific"&&Array.isArray(B.targetRoles)?B.targetRoles.includes(A):!1)),console.log("Fetched Announcements:",X),n(X)}catch(U){console.error("Error fetching announcements:",U)}finally{e(!1)}},R=()=>{b({message:"",link:"",displayInScroller:!1,targetType:"all",targetRoles:[]}),h(null),w(!1)},O=A=>{b(U=>{const K=U.targetRoles.includes(A);return{...U,targetRoles:K?U.targetRoles.filter(Q=>Q!==A):[...U.targetRoles,A]}})},P=async()=>{if(!g.message.trim()){console.error("Please enter announcement text.");return}if(g.targetType==="specific"&&g.targetRoles.length===0){console.error("Please select at least one target role.");return}try{N(!0);const A=sessionStorage.getItem("token");u?(await Pe.put("/api/superadmin/announcements/".concat(u._id||u.id),{message:g.message,link:g.link&&g.link.trim()?g.link.trim():null,displayInScroller:!!g.displayInScroller,targetType:g.targetType,targetRoles:g.targetType==="specific"?g.targetRoles:[]},{headers:{Authorization:"".concat(A)}}),c(!1),h(null)):(await Pe.post("/api/superadmin/announcements",{message:g.message,link:g.link&&g.link.trim()?g.link.trim():null,displayInScroller:!!g.displayInScroller,targetType:g.targetType,targetRoles:g.targetType==="specific"?g.targetRoles:[]},{headers:{Authorization:"".concat(A)}}),o(!1)),await $(p),R()}catch(A){console.error("Error saving announcement:",A)}finally{N(!1)}},_=A=>{h(A),b({message:A.message,link:A.link||"",displayInScroller:A.displayInScroller,targetType:A.targetType,targetRoles:A.targetRoles||[]}),c(!0)},M=async A=>{if(window.confirm("Are you sure you want to delete this announcement?")&&!C.includes(A))try{T(K=>[...K,A]);const U=sessionStorage.getItem("token");await Pe.delete("/api/superadmin/announcements/".concat(A),{headers:{Authorization:"".concat(U)}}),n(K=>K.filter(Q=>Q._id!==A&&Q.id!==A))}catch(U){console.error("Error deleting announcement:",U),alert("Failed to delete announcement. Please try again.")}finally{T(U=>U.filter(K=>K!==A))}};return s?r.jsx(T8,{}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[#ab1c1c]",children:"Announcements"}),p==="superadmin"&&r.jsx("button",{onClick:()=>o(!0),className:"bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow",children:"+ Add Announcement"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-[#ab1c1c] mb-4",children:"Current Announcements"}),t.length===0?r.jsx("p",{className:"text-gray-500",children:"No announcements have been posted yet."}):r.jsx("div",{className:"space-y-4",children:t.map(A=>{const U=A._id||A.id,K=C.includes(U);return r.jsxs("div",{className:"p-4 rounded-lg border border-gray-100 shadow-sm\n               flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[r.jsxs("div",{className:"md:pr-6 flex-1 min-w-0 text-left",children:[r.jsx("p",{className:"text-gray-800 font-medium break-words",children:A.message}),A.link&&r.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:[" Links to: ",A.link]})]}),r.jsxs("div",{className:"md:text-right md:items-end flex flex-col gap-2 md:gap-0 flex-none",children:[r.jsx("p",{className:"text-sm text-gray-500 italic whitespace-nowrap",children:new Date(A.createdAt).toLocaleString()}),r.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[p==="superadmin"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:[A.displayInScroller?r.jsx("span",{className:"mr-2 text-green-600 font-medium",children:"Scroller Display"}):r.jsx("span",{className:"mr-2 text-gray-400",children:"Not in Scroller"}),r.jsx("span",{className:"mx-2 text-gray-300",children:"|"}),r.jsxs("span",{children:["Target:"," ",A.targetType==="all"?"All Users":A.targetType==="public"?"Public (Non-Logged In)":A.targetRoles&&A.targetRoles.length?A.targetRoles.map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1)).join(", "):"Specific Roles"]})]}),r.jsx("button",{onClick:()=>_(A),title:"Edit announcement",className:"p-2 rounded-md hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Edit announcement",children:r.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),r.jsx("button",{onClick:()=>M(U),disabled:K,title:"Delete announcement",className:"p-2 rounded-md hover:bg-gray-100 transition-colors ".concat(K?"opacity-60 cursor-not-allowed":"cursor-pointer"),"aria-label":"Delete announcement",children:K?r.jsx("div",{className:"w-5 h-5 border-b-2 border-red-500 rounded-full animate-spin"}):r.jsx("img",{src:Fj,alt:"Delete",className:"w-5 h-5 object-contain",draggable:!1})})]}),p!=="superadmin"&&r.jsxs("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:[A.displayInScroller?r.jsx("span",{className:"mr-2 text-green-600 font-medium",children:"Scroller Display"}):r.jsx("span",{className:"mr-2 text-gray-400",children:"Not in Scroller"}),r.jsx("span",{className:"mx-2 text-gray-300",children:"|"}),r.jsxs("span",{children:["Target:"," ",A.targetType==="all"?"All Users":A.targetType==="public"?"Public (Non-Logged In)":A.targetRoles&&A.targetRoles.length?A.targetRoles.map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1)).join(", "):"Specific Roles"]})]})]})]})]},U)})})]}),a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto relative border-t-4 border-[#ab1c1c]",children:[r.jsx("h3",{className:"text-2xl font-bold text-[#ab1c1c] mb-4",children:"Add Announcement"}),r.jsx("textarea",{value:g.message,onChange:A=>b(U=>({...U,message:A.target.value})),rows:5,placeholder:"Write announcement here...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c] mb-4"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link (Optional)"}),r.jsx("input",{type:"text",value:g.link,onChange:A=>b(U=>({...U,link:A.target.value})),placeholder:"Internal route: /training OR External URL: https://google.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-[#ab1c1c] focus:border-[#ab1c1c]"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Examples: /training, /contact, /services, https://example.com"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-4",children:[r.jsx("input",{type:"checkbox",checked:g.displayInScroller,onChange:A=>b(U=>({...U,displayInScroller:A.target.checked})),className:"form-checkbox h-4 w-4 text-[#ab1c1c] rounded"}),r.jsx("span",{className:"text-gray-800",children:"Display in the scroller"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="all",onChange:()=>b(A=>({...A,targetType:"all",targetRoles:[]})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"All Users"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="specific",onChange:()=>b(A=>({...A,targetType:"specific"})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"Specific Roles"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"targetType",checked:g.targetType==="public",onChange:()=>b(A=>({...A,targetType:"public",targetRoles:[]})),className:"form-radio h-4 w-4 text-[#ab1c1c]"}),r.jsx("span",{className:"text-gray-800",children:"Public (Non-Logged In Users)"})]}),g.targetType==="specific"&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>w(A=>!A),type:"button",className:"w-full text-left border border-gray-300 rounded-md p-2 flex items-center justify-between focus:outline-none bg-white hover:bg-gray-50 transition-colors",children:[r.jsx("div",{children:g.targetRoles.length===0?"Select roles...":"".concat(g.targetRoles.length," role(s) selected")}),r.jsx("div",{className:"text-gray-500",children:""})]}),y&&r.jsxs("div",{className:"absolute left-0 mt-2 w-full bg-white border border-gray-200 rounded-md shadow-lg z-10 max-h-40 overflow-y-auto p-3",children:[I.map(A=>r.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer hover:bg-gray-100 p-1 rounded",children:[r.jsx("input",{type:"checkbox",checked:g.targetRoles.includes(A.key),onChange:()=>O(A.key),className:"form-checkbox h-4 w-4 text-[#ab1c1c] rounded"}),r.jsx("span",{className:"text-gray-800",children:A.label})]},A.key)),r.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-gray-100",children:[r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:I.map(U=>U.key)})),className:"text-sm text-[#ab1c1c] hover:underline font-medium",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:[]})),className:"text-sm text-gray-600 hover:underline",children:"Clear"})]}),r.jsx("button",{type:"button",onClick:()=>w(!1),className:"w-full mt-3 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border border-gray-300 transition-colors",children:"Done Selecting Roles"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[r.jsx("button",{onClick:()=>{o(!1),R()},className:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:P,disabled:v,className:"px-4 py-2 rounded-md bg-[#ab1c1c] hover:bg-red-700 text-white font-semibold transition-colors disabled:opacity-50",children:v?"Adding...":"Add"})]}),r.jsx("button",{onClick:()=>{o(!1),R()},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",title:"Close",children:""})]})}),i&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto relative border-t-4 border-blue-600",children:[r.jsx("h3",{className:"text-2xl font-bold text-blue-600 mb-4",children:"Edit Announcement"}),r.jsx("textarea",{value:g.message,onChange:A=>b(U=>({...U,message:A.target.value})),rows:5,placeholder:"Write announcement here...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-blue-600 focus:border-blue-600 mb-4"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link (Optional)"}),r.jsx("input",{type:"text",value:g.link,onChange:A=>b(U=>({...U,link:A.target.value})),placeholder:"Internal route: /training OR External URL: https://google.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-blue-600 focus:border-blue-600"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Examples: /training, /contact, /services, https://example.com"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-4",children:[r.jsx("input",{type:"checkbox",checked:g.displayInScroller,onChange:A=>b(U=>({...U,displayInScroller:A.target.checked})),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),r.jsx("span",{className:"text-gray-800",children:"Display in the scroller"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="all",onChange:()=>b(A=>({...A,targetType:"all",targetRoles:[]})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"All Users"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="specific",onChange:()=>b(A=>({...A,targetType:"specific"})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"Specific Roles"})]}),r.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[r.jsx("input",{type:"radio",name:"editTargetType",checked:g.targetType==="public",onChange:()=>b(A=>({...A,targetType:"public",targetRoles:[]})),className:"form-radio h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-gray-800",children:"Public (Non-Logged In Users)"})]}),g.targetType==="specific"&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>w(A=>!A),type:"button",className:"w-full text-left border border-gray-300 rounded-md p-2 flex items-center justify-between focus:outline-none bg-white hover:bg-gray-50 transition-colors",children:[r.jsx("div",{children:g.targetRoles.length===0?"Select roles...":"".concat(g.targetRoles.length," role(s) selected")}),r.jsx("div",{className:"text-gray-500",children:""})]}),y&&r.jsxs("div",{className:"absolute left-0 mt-2 w-full bg-white border border-gray-200 rounded-md shadow-lg z-10 max-h-40 overflow-y-auto p-3",children:[I.map(A=>r.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer hover:bg-gray-100 p-1 rounded",children:[r.jsx("input",{type:"checkbox",checked:g.targetRoles.includes(A.key),onChange:()=>O(A.key),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),r.jsx("span",{className:"text-gray-800",children:A.label})]},A.key)),r.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-gray-100",children:[r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:I.map(U=>U.key)})),className:"text-sm text-blue-600 hover:underline font-medium",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>b(A=>({...A,targetRoles:[]})),className:"text-sm text-gray-600 hover:underline",children:"Clear"})]}),r.jsx("button",{type:"button",onClick:()=>w(!1),className:"w-full mt-3 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border border-gray-300 transition-colors",children:"Done Selecting Roles"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[r.jsx("button",{onClick:()=>{c(!1),R()},className:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:P,disabled:v,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white font-semibold transition-colors disabled:opacity-50",children:v?"Updating...":"Update"})]}),r.jsx("button",{onClick:()=>{c(!1),R()},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl",title:"Close",children:""})]})})]})}const $8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState([]),[i,c]=F.useState([]),[u,h]=F.useState({child:"all",doctor:"all",status:"all",date:""}),[p,f]=F.useState(""),g=sessionStorage.getItem("parentId");F.useEffect(()=>{(async()=>{try{const C=await Pe.get("/api/parents/getappointments/".concat(g),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});e(C.data.appointments),f(C.data.parentName),o(C.data.appointments);const T=C.data.appointments.map(I=>{var _,M,A,U,K;const $=new Date(I.appointmentDate),R=new Date((_=I.childId)==null?void 0:_.dob),O=$-R,P=Math.floor(O/(1e3*60*60*24*365.25));return{id:I._id,childName:((M=I.childId)==null?void 0:M.name)||"Unknown",age:P,appointmentDate:$,appointmentDateFormatted:$.toLocaleDateString(),appointmentDateValue:$.toISOString().split("T")[0],appointmentTime:I.appointmentTime||"Not specified",consultationType:I.consultationType||"Not specified",doctorName:((A=I.doctorId)==null?void 0:A.name)||"Not assigned",doctorId:((U=I.doctorId)==null?void 0:U._id)||null,status:I.status||"pending",centreName:((K=I.centreId)==null?void 0:K.name)||"Not specified",parentName:C.data.parentName||"Not specified"}});c(T),console.log(T)}catch(C){console.error("Error fetching appointments:",C)}finally{n(!1)}})()},[g]),F.useEffect(()=>{let N=s;u.child!=="all"&&(N=N.filter(C=>C.childId.name===u.child)),u.doctor!=="all"&&(N=N.filter(C=>C.doctorId.name===u.doctor)),u.status!=="all"&&(N=N.filter(C=>C.status===u.status)),u.date&&(N=N.filter(C=>new Date(C.appointmentDate).toLocaleDateString()===new Date(u.date).toLocaleDateString())),o(N)},[u,s]);const b=N=>{const{name:C,value:T}=N.target;h({...u,[C]:T})},y=N=>{switch(N){case"pending":return"bg-yellow-100  rounded-lg text-yellow-800";case"rejected":return"bg-red-100 rounded-lg text-red-800";case"approved":return"bg-green-200 rounded-lg  text-green-800";default:return"bg-gray-100 rounded-lg text-gray-800"}};if(t)return r.jsx("div",{className:"mt-16",children:r.jsx(Gs,{})});const w=[...new Set(s.map(N=>N.childId.name))],v=[...new Set(s.map(N=>{var C;return(C=N.doctorId)==null?void 0:C.name}))];return r.jsxs("div",{className:"container mx-auto p-4",children:[r.jsx(cg,{}),r.jsx("h1",{className:"text-3xl text-center font-bold text-[#ab1c1c] mt-10 mb-10",children:"Appointments"}),r.jsxs("div",{className:"flex flex-wrap justify-center mb-6 space-x-4",children:[r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Child"}),r.jsxs("select",{name:"child",value:u.child,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),w.map(N=>r.jsx("option",{value:N,children:N},N))]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Doctor"}),r.jsxs("select",{name:"doctor",value:u.doctor,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),v.map(N=>r.jsx("option",{value:N,children:N},N))]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),r.jsxs("select",{name:"status",value:u.status,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md",children:[r.jsx("option",{value:"all",children:"All"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:u.date,onChange:b,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#ab1c1c] focus:border-[#ab1c1c] sm:text-sm rounded-md"})]})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg",children:r.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Child Name"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Doctor Name"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Appointment Date"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Appointment Time"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Status"}),r.jsx("th",{className:"px-4 py-2 border-b text-center",children:"Actions"})]})}),r.jsx("tbody",{children:a.map((N,C)=>{var T;return r.jsxs("tr",{className:"hover:bg-red-50",children:[r.jsx("td",{className:"px-4 py-2 border-b text-center",children:N.childId.name}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:(T=N.doctorId)==null?void 0:T.name}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:new Date(N.appointmentDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:N.appointmentTime}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:r.jsxs("p",{className:y(N.status),children:[N.status[0].toUpperCase(),N.status.substring(1)]})}),r.jsx("td",{className:"px-4 py-2 border-b text-center",children:r.jsx("button",{onClick:()=>_y(i[C]),className:"text-[#ab1c1c] px-4 py-2 hover:text-[#8e1818] transition duration-300",children:"View PDF"})})]},N._id)})})]})})]})},A8=()=>{const s=sessionStorage.getItem("centreId"),[e,t]=F.useState([]),[n,a]=F.useState([]),[o,i]=F.useState(!0),[c,u]=F.useState(1),[h,p]=F.useState(""),f=10;F.useEffect(()=>{s&&g()},[s]);const g=async()=>{i(!0);try{const C=await Pe.get("/api/admins/getPendingAppointments/".concat(s),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}});t(C.data),a(C.data),u(1)}catch(C){console.error("Error fetching appointments:",C)}finally{i(!1)}},b=async(C,T)=>{try{await Pe.put("/api/admins/manageAppointment/".concat(C),{status:T},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),g()}catch(I){console.error("Error updating appointment status:",I)}},y=C=>{const T=C.target.value.toLowerCase();if(p(T),T==="")a(e);else{const I=e.filter($=>{var R,O,P,_;return((O=(R=$.childId)==null?void 0:R.name)==null?void 0:O.toLowerCase().includes(T))||((_=(P=$.childId)==null?void 0:P.parentName)==null?void 0:_.toLowerCase().includes(T))});a(I)}u(1)},w=Math.ceil(n.length/f),v=(c-1)*f,N=n.slice(v,v+f);return s?r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-6 text-center",children:"Pending Appointments"}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search by child or parent name...",value:h,onChange:y,className:"w-full p-2 border border-red-300 rounded focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o?r.jsxs("div",{className:"p-8 text-center text-[#ab1c1c]",children:["Loading appointments...",r.jsx(Gs,{})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-red-200",children:[r.jsx("thead",{className:"bg-[#ab1c1c] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Child"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Parent"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-red-200",children:N.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:h?"No matching appointments found":"No pending appointments"})}):N.map(C=>{var T,I,$;return r.jsxs("tr",{className:"hover:bg-red-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:((T=C.childId)==null?void 0:T.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:((I=C.childId)==null?void 0:I.parentId.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:(($=C.doctorId)==null?void 0:$.name)||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:new Date(C.appointmentDate).toLocaleDateString()})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:C.appointmentTime})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:C.consultationType})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>b(C._id,"approved"),className:"bg-green-500 hover:bg-green-600 text-white p-2 rounded flex items-center justify-center w-10 h-10",title:"Approve",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),r.jsx("button",{onClick:()=>b(C._id,"rejected"),className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded flex items-center justify-center w-10 h-10",title:"Reject",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})]},C._id)})})]})}),w>1&&r.jsxs("div",{className:"bg-red-50 px-4 py-3 flex items-center justify-between border-t border-red-200",children:[r.jsx("div",{children:r.jsxs("p",{className:"text-sm text-[#ab1c1c]",children:["Page ",r.jsx("span",{className:"font-medium",children:c})," of"," ",r.jsx("span",{className:"font-medium",children:w})," "," ",r.jsx("span",{className:"font-medium",children:n.length})," ","total"]})}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>u(C=>Math.max(1,C-1)),disabled:c===1,className:"px-3 py-1 border border-red-300 rounded text-[#ab1c1c] disabled:opacity-50 hover:bg-red-100",children:"Previous"}),r.jsx("button",{onClick:()=>u(C=>Math.min(w,C+1)),disabled:c===w,className:"px-3 py-1 border border-red-300 rounded text-[#ab1c1c] disabled:opacity-50 hover:bg-red-100",children:"Next"})]})]})]})})]}):r.jsx("div",{className:"container mx-auto px-4 py-8 text-center text-red-500",children:"Centre ID is missing in the URL parameters"})},E8=()=>{const[s,e]=F.useState([]),[t,n]=F.useState([]),[a,o]=F.useState([]),[i,c]=F.useState(!0),[u,h]=F.useState(null),[p,f]=F.useState(!1),[g,b]=F.useState(""),[y,w]=F.useState({from:"",to:""}),v=xs(),N=sessionStorage.getItem("centerId"),C=async()=>{try{const _=sessionStorage.getItem("centreId"),A=(await Pe.get("/api/admins/get-jwl-enquiries/".concat(_),{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}})).data;e(A),n(A.filter(U=>!U.isArchived)),o(A.filter(U=>U.isArchived)),c(!1)}catch(_){h("Failed to fetch users"),c(!1),console.error(_)}};F.useEffect(()=>{C()},[N]);const T=_=>{b(_)},I=_=>{const{name:M,value:A}=_.target;w(U=>({...U,[M]:A}))},$=(p?a:t).filter(_=>{const M=g.toLowerCase(),A=_.childName.toLowerCase().includes(M)||_.parentName.toLowerCase().includes(M)||_.parentEmail.toLowerCase().includes(M)||_.referenceId.toLowerCase().includes(M);if(!y.from&&!y.to)return A;const U=c4(_.enquiryDate),K=y.from?new Date(y.from):null,Q=y.to?new Date(y.to):null;Q&&Q.setHours(23,59,59,999);const X=(!K||U>=K)&&(!Q||U<=Q);return A&&X}),R=()=>{w({from:"",to:""})},O=_=>{v("/admindashboard/jwlenquiries/".concat(_))},P=async _=>{try{await Pe.put("/api/admins/archive-jwl-enquiry",{parentEmail:_},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),C()}catch(M){console.error("Failed to archive user",M)}};return i?r.jsx("div",{className:"mt-20",children:r.jsx(Gs,{})}):u?r.jsx("div",{className:"text-center text-red-600",children:u}):r.jsx("div",{className:"mt-16",children:r.jsx("div",{className:"p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8 flex-wrap gap-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:p?"Archived Users":"Active Users"}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("button",{className:"px-4 py-2 rounded-md font-medium transition duration-300 ".concat(p?"bg-gray-300 text-gray-700":"bg-blue-500 text-white"),onClick:()=>f(!1),children:"Active"}),r.jsx("button",{className:"px-4 py-2 rounded-md font-medium transition duration-300 ".concat(p?"bg-[#ab1c1c] text-white":"bg-gray-300 text-gray-700"),onClick:()=>f(!0),children:"Archived"})]})]}),r.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4 items-end",children:[r.jsxs("div",{className:"w-full md:w-1/2 lg:w-2/5 relative",children:[r.jsx("input",{type:"text",placeholder:"Search by child name, parent name, email or reference ID",className:"w-full p-3 pl-10 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",value:g,onChange:_=>T(_.target.value)}),r.jsx("div",{className:"absolute left-3 top-3 text-gray-400",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),r.jsxs("div",{className:"w-full md:w-1/2 lg:w-3/5 flex flex-col sm:flex-row gap-2 items-end",children:[r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),r.jsx("input",{type:"date",name:"from",value:y.from,onChange:I,className:"w-full p-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"w-full sm:w-1/3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),r.jsx("input",{type:"date",name:"to",value:y.to,onChange:I,className:"w-full p-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsx("div",{className:"w-full sm:w-1/3",children:r.jsx("button",{onClick:R,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-200",children:"Reset Dates"})})]})]}),r.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full leading-normal",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#ab1c1c] text-white",children:[r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Reference ID"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Child Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Name"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Phone"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Parent Email"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Enquiry Date"}),r.jsx("th",{className:"px-5 py-3 border-b-2 border-red-500 text-left text-sm font-semibold uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{children:$.length>0?$.map(_=>r.jsxs("tr",{className:"hover:bg-red-50 transition duration-200",children:[r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:_.referenceId})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:_.childName})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:_.parentName})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:_.parentPhoneNo})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:_.parentEmail})}),r.jsx("td",{className:"px-5 py-5 border-b border-gray-200 text-sm",children:r.jsx("p",{className:"text-gray-900 whitespace-nowrap",children:Ij(c4(_.enquiryDate),"dd-MM-yyyy")})}),r.jsxs("td",{className:"px-5 py-5 border-b border-gray-200 text-sm flex space-x-2",children:[r.jsx("button",{onClick:()=>O(_.referenceId),className:"px-4 py-2 bg-purple-800 text-white rounded-md hover:bg-purple-600 transition duration-200",children:"Details"}),!_.isArchived&&r.jsx("button",{onClick:()=>P(_.parentEmail),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-200",children:"Archive"})]})]},_._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"px-5 py-5 border-b border-gray-200 text-sm text-center",children:"No users found"})})})]})})})]})})})},D8=F.forwardRef((s,e)=>{const[t,n]=F.useState(!0),[a,o]=F.useState(!1),[i,c]=F.useState(!0),u=Bo();F.useEffect(()=>{var f;(f=s.onStateChange)==null||f.call(s,{isOpen:t,isMobile:a})},[t,a]),F.useImperativeHandle(e,()=>({getMobile:()=>a,getIsOpen:()=>t}));const h=f=>u.pathname===f||u.pathname===f+"/";F.useEffect(()=>{const f=()=>{const g=window.innerWidth<1024;o(g),g&&(n(!1),c(!1))};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]),F.useEffect(()=>{a&&(n(!1),setTimeout(()=>{c(!1)},300))},[u.pathname,a]),F.useEffect(()=>{if(t)c(!0);else if(!t){const f=setTimeout(()=>{c(!1)},300);return()=>clearTimeout(f)}},[t]);const p=()=>{t||c(!0),n(!t)};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed top-0 left-0 z-40 h-full bg-white shadow-lg transition-all duration-300 ".concat(t?"translate-x-0":"translate-x-[-100%]"," ").concat(t?"w-64":"w-0"," pt-16 overflow-hidden"),children:i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-bold text-[#ab1c1c]",children:"Parent Portal"})}),r.jsxs("nav",{className:"mt-6 w-64",children:[" ",r.jsxs("ul",{className:"space-y-2 px-2",children:[r.jsx("li",{children:r.jsxs(ot,{to:"/parentdashboard",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Cj,{size:18,className:"mr-3"}),r.jsx("span",{children:"Dashboard"}),h("/parentdashboard")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/parentdashboard/bookappointment",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard/bookappointment")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(jj,{size:18,className:"mr-3"}),r.jsx("span",{children:"Book Appointment"}),h("/parentdashboard/bookappointment")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/parentdashboard/viewappointments",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/parentdashboard/viewappointments")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(D6,{size:18,className:"mr-3"}),r.jsx("span",{children:"View Appointments"}),h("/parentdashboard/viewappointments")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})})]})]})]})}),r.jsx("button",{onClick:p,className:"fixed z-40 bg-[#ab1c1c] text-white shadow-md transition-all duration-300 ".concat(a?"top-16 ".concat(t?"left-64":"left-0"):"top-20 ".concat(t?"left-64":"left-0")),style:{borderRadius:"0 50% 50% 0",width:"28px",height:"48px",display:"flex",justifyContent:"center",alignItems:"center"},"aria-label":"Toggle navigation",children:t?r.jsx(kj,{size:20}):a?r.jsx(Hr,{size:20}):r.jsx(Tj,{size:20})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>n(!1)})]})});function C4(){const s=F.useRef(),[e,t]=F.useState(!1),[n,a]=F.useState(!0);return F.useEffect(()=>{s.current&&(t(s.current.getMobile()),a(s.current.getIsOpen()))},[]),r.jsxs("div",{className:" min-h-screen bg-gray-50",children:[r.jsx(D8,{ref:s,onStateChange:({isMobile:o,isOpen:i})=>{t(o),a(i)}}),r.jsx("div",{className:"transition-all duration-300 ".concat(!e&&n?"ml-64":""),children:r.jsxs(ig,{children:[r.jsx(st,{path:"/",element:r.jsx(r8,{})}),r.jsx(st,{path:"/bookappointment",element:r.jsx(c8,{})}),r.jsx(st,{path:"/viewappointments",element:r.jsx($8,{})}),r.jsx(st,{path:"/child/:childId",element:r.jsx(g8,{})}),r.jsx(st,{path:"/reports",element:r.jsx(Oj,{})}),r.jsx(st,{path:"/iepreports/:childId",element:r.jsx(_j,{})}),r.jsx(st,{path:"*",element:r.jsx(Eo,{to:"/parentdashboard",replace:!0})})]})})]})}const R8=F.forwardRef((s,e)=>{const[t,n]=F.useState(!0),[a,o]=F.useState(!1),[i,c]=F.useState(!0),u=Bo();F.useEffect(()=>{var f;(f=s.onStateChange)==null||f.call(s,{isOpen:t,isMobile:a})},[t,a]),F.useImperativeHandle(e,()=>({getMobile:()=>a,getIsOpen:()=>t}));const h=f=>u.pathname===f||u.pathname===f+"/";F.useEffect(()=>{const f=()=>{const g=window.innerWidth<1024;o(g),g&&(n(!1),c(!1))};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]),F.useEffect(()=>{a&&(n(!1),setTimeout(()=>{c(!1)},300))},[u.pathname,a]),F.useEffect(()=>{if(t)c(!0);else if(!t){const f=setTimeout(()=>{c(!1)},300);return()=>clearTimeout(f)}},[t]);const p=()=>{t||c(!0),n(!t)};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed top-0 left-0 z-40 h-full bg-white shadow-lg transition-all duration-300 ".concat(t?"translate-x-0 w-64":"translate-x-[-100%] w-0"," pt-16 overflow-hidden"),children:i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-bold text-[#ab1c1c]",children:"Admin Portal"})}),r.jsx("nav",{className:"mt-6 w-64",children:r.jsxs("ul",{className:"space-y-2 px-2",children:[r.jsx("li",{children:r.jsxs(ot,{to:"/admindashboard",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(R6,{size:18,className:"mr-3"}),r.jsx("span",{children:"Dashboard"}),h("/admindashboard")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/admindashboard/register",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/register")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(O6,{size:18,className:"mr-3"}),r.jsx("span",{children:"Register"}),h("/admindashboard/register")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/admindashboard/existingusers",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/existingusers")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(Cj,{size:18,className:"mr-3"}),r.jsx("span",{children:"Import"}),h("/admindashboard/existingusers")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/admindashboard/viewappointment",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/viewappointment")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(jj,{size:18,className:"mr-3"}),r.jsx("span",{children:"View Appointments"}),h("/admindashboard/viewappointment")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})}),r.jsx("li",{children:r.jsxs(ot,{to:"/admindashboard/jwlenquiries",className:"flex items-center p-3 rounded-md transition-colors ".concat(h("/admindashboard/jwlenquiries")?"bg-red-50 text-[#ab1c1c] font-bold":"text-gray-700 hover:bg-gray-100"),onClick:()=>a&&n(!1),children:[r.jsx(_6,{size:18,className:"mr-3"}),r.jsx("span",{children:"JWL Enquiries"}),h("/admindashboard/jwlenquiries")&&r.jsx(Hr,{size:18,className:"ml-auto"})]})})]})})]})}),r.jsx("button",{onClick:p,className:"fixed z-40 bg-[#ab1c1c] text-white shadow-md transition-all duration-300 ".concat(a?"top-16 ".concat(t?"left-64":"left-0"):"top-20 ".concat(t?"left-64":"left-0")),style:{borderRadius:"0 50% 50% 0",width:"28px",height:"48px",display:"flex",justifyContent:"center",alignItems:"center"},"aria-label":"Toggle navigation",children:t?r.jsx(kj,{size:20}):a?r.jsx(Hr,{size:20}):r.jsx(Tj,{size:20})}),t&&a&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>n(!1)})]})}),O8={Neredmet:"NE",Nacharam:"NA","Banjara Hills":"BH",Bowenpally:"BP",Kukatpally:"KP",Barkatpura:"BR",Champapet:"P",Manikonda:"MK",Suchitra:"SH"},_8=["CBSE","SSC","ICSE","Cambridge (IB)","NIOS","Others"],F8=["Occupational Therapy","Behavioural Therapy","Remedial Therapy","Speech Therapy"];function L8(){const[s,e]=F.useState(1),[t,n]=F.useState({name:"",mobilenumber:"",address:"",role:"Parent",password:"total12345678"}),[a,o]=F.useState([]),[i,c]=F.useState(""),[u,h]=F.useState(null),[p,f]=F.useState(!1),[g,b]=F.useState({childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:"",dateOfJoining:""}),[y,w]=F.useState({}),[v,N]=F.useState(!1),[C,T]=F.useState(!1),[I,$]=F.useState([]),R=["Case History","Prescription","IEP","IQ Report","OT Report","Speech Report","Admission Form","Parent Feed Back","Child Observatory Sheets","IEP OT","IEP BT","IEP ST","IEP RT","Other"],[O,P]=F.useState(!1),[_,M]=F.useState([]),[A,U]=F.useState(""),[K,Q]=F.useState([]),[X,B]=F.useState(""),[G,Y]=F.useState(""),[Z,J]=F.useState(""),[xe,ye]=F.useState(null),[ve,Re]=F.useState([{therapyType:"",therapistId:""}]),Ce=()=>{Re(Ge=>[...Ge,{therapyType:"",therapistId:""}])},pe=Ge=>{Re(nt=>nt.length===1?[{therapyType:"",therapistId:""}]:nt.filter((at,pt)=>pt!==Ge))},Te=(Ge,nt,at)=>{Re(pt=>pt.map((jt,It)=>It===Ge?{...jt,[nt]:at}:jt))};F.useEffect(()=>{oe(),Ie(),Be()},[]);const ee=Ge=>/^\d{6}\/[A-Z]{2}$/.test(Ge),he=Ge=>/^\d{6}\/[A-Z]{1,2}\/\d{2}$/.test(Ge),oe=async()=>{f(!0);try{const Ge=sessionStorage.getItem("token"),nt=await Pe.get("/api/data/parents",{headers:{Authorization:Ge}});o(Array.isArray(nt.data)?nt.data:[])}catch(Ge){console.error("Error fetching parents:",Ge)}finally{f(!1)}},Ie=async()=>{try{const Ge=sessionStorage.getItem("token"),nt=await Pe.get("/api/data/alldoctors",{headers:{Authorization:Ge}});M(Array.isArray(nt.data)?nt.data:[])}catch(Ge){console.error("Error fetching doctors:",Ge)}},Be=async()=>{try{const Ge=sessionStorage.getItem("token");if(!Ge)throw new Error("Authentication token not found");const at=Cr(Ge).user.centreId;console.log(at);const pt=await Pe.get("/api/data/allTherapists/".concat(at),{headers:{Authorization:Ge}});Q(pt.data.therapists.map(jt=>({id:jt._id,name:jt.name}))),console.log("Fetched therapists:",pt.data.therapists)}catch(Ge){console.error("Error fetching doctors:",Ge)}},We=Ge=>{n({...t,[Ge.target.name]:Ge.target.value})},Ke=async Ge=>{var nt,at;if(Ge.preventDefault(),!t.name||!t.mobilenumber){Ve.error("Please fill Parent Name and Mobile Number");return}N(!0);try{const pt=sessionStorage.getItem("token");let jt=sessionStorage.getItem("centreId");if(!jt&&pt){const rn=Cr(pt);jt=(nt=rn==null?void 0:rn.user)==null?void 0:nt.centreId}if(!jt){Ve.error("Centre ID not found. Please log in again."),N(!1);return}const It={...t,role:"parent",centreId:jt},an=await Pe.post("/api/admins/register",It,{headers:{Authorization:pt,"Content-Type":"application/json"}}),$s=an.data.user;an.data.isExisting?Ve.info("Parent already exists. Using existing account."):Ve.success("New Parent Created Successfully!"),o(rn=>[...rn,$s]),c($s._id),h($s),e(2)}catch(pt){console.error("Registration error:",pt);const jt=((at=pt.response)==null?void 0:at.data)||"Error creating parent";Ve.error(typeof jt=="string"?jt:"Registration failed")}finally{N(!1)}},be=Ge=>{const{name:nt,value:at}=Ge.target;b({...g,[nt]:at})},ue=()=>$(Ge=>[...Ge,{id:Date.now(),type:"",file:null}]),Fe=(Ge,nt)=>$(at=>at.map(pt=>pt.id===Ge?{...pt,type:nt}:pt)),He=(Ge,nt)=>{if(nt.size>50*1024*1024){Ve.error("Max 50MB");return}$(at=>at.map(pt=>pt.id===Ge?{...pt,file:nt}:pt))},rt=Ge=>$(nt=>nt.filter(at=>at.id!==Ge)),Je=Ge=>{const nt=Ge.target.files[0];if(nt&&nt.size>5*1024*1024){Ve.error("Profile picture size should not exceed 5MB"),ye(null);return}ye(nt)},Wt=async(Ge,nt,at)=>{const pt=new FormData;console.log("Sending reports to backend"),pt.append("report",Ge),pt.append("reportType",nt),await Pe.post("/api/admins/uploadChildReport/".concat(at),pt,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}})},At=()=>{const Ge={};return i||(Ge.parent="Please select a parent"),g.childName.trim()||(Ge.childName="Child name is required"),g.childDob||(Ge.childDob="Date of birth is required"),g.childGender||(Ge.childGender="Gender is required"),Ge},wt=async Ge=>{var nt,at,pt,jt;if(Ge.preventDefault(),!ee(G)){Ve.error("Invalid Registration ID format");return}if(!he(Z)){Ve.error("Invalid Case ID format");return}if(!g.childName||!g.childDob||!g.childGender){Ve.error("Please fill all child details");return}N(!0);try{const It=At();if(Object.keys(It).length>0){w(It),N(!1),Ve.error("Please fix the validation errors before submitting");return}const an=sessionStorage.getItem("centreId");if(!an){Ve.error("Centre ID not found in session storage"),N(!1);return}let $s="pending";const rn=ve.filter(Ps=>Ps.therapyType&&Ps.therapistId);(A||rn.length>0)&&($s="active");const Fn={name:g.childName,dob:g.childDob,gender:g.childGender,schoolName:g.childSchoolName||"",schoolBoard:g.childSchoolBoard||"",parentId:i,doctorId:A||null,dateOfJoining:g.dateOfJoining||null,therapies:rn,centreId:an,registrationId:G,caseId:Z,admitStatus:$s},As=(await Pe.post("/api/admins/addExistingChild",Fn,{headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"application/json"}})).data.child._id;if(xe){const Ps=new FormData;Ps.append("profilePicture",xe),await Pe.post("/api/admins/uploadProfilePicture/".concat(As),Ps,{headers:{"Content-Type":"multipart/form-data",Authorization:"".concat(sessionStorage.getItem("token"))}})}P(!0);try{for(const Ps of I)!Ps.file||!Ps.type||await Wt(Ps.file,Ps.type,As)}finally{P(!1)}Ve.success("Child registered successfully with all files!"),T(!0),b({childName:"",childDob:"",childGender:"",childSchoolName:"",childSchoolBoard:""}),$([]),ye(null),c(""),h(null),console.error("Registration error:",error),Ve.error(((at=(nt=error.response)==null?void 0:nt.data)==null?void 0:at.message)||"Failed to register child")}catch(It){console.error("Registration error:",It),Ve.error(((jt=(pt=It.response)==null?void 0:pt.data)==null?void 0:jt.message)||"Failed to register child")}finally{N(!1)}};return C?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg text-center border-t-4 border-red-800",children:[r.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Registration Complete!"}),r.jsx("button",{onClick:()=>{T(!1),e(1)},className:"mt-6 bg-[#ab1c1c] text-white px-6 py-2 rounded-lg",children:"Add Another"})]})}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[r.jsx(ao,{}),r.jsx("div",{className:"max-w-4xl w-full bg-white rounded-xl shadow-xl overflow-hidden mb-20 border-2 border-red-800",children:r.jsx("div",{className:"px-6 py-8",children:s===1?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-2xl font-extrabold text-[#ab1c1c]",children:"Register Parent for Existing Child"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the parent details to import child records"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx("input",{type:"text",name:"mobilenumber",placeholder:"Mobile Number",onChange:We,className:"p-2 border border-gray-300 rounded-lg w-full"}),r.jsx("input",{type:"text",name:"name",placeholder:"Full Name",onChange:We,className:"p-2 border border-gray-300 rounded-lg w-full"}),r.jsx("select",{disabled:!0,className:"p-2 border border-gray-300 rounded-lg bg-gray-100",children:r.jsx("option",{children:"Role: Parent"})}),r.jsx("input",{type:"text",disabled:!0,value:"Password: total12345678",className:"p-2 border border-gray-300 rounded-lg bg-gray-100"})]}),r.jsx("textarea",{name:"address",placeholder:"Full Address",onChange:We,className:"w-full p-2 border border-gray-300 rounded-lg",rows:"3"}),r.jsx("button",{onClick:Ke,className:"w-full bg-[#ab1c1c] text-white py-3 rounded-lg font-bold hover:bg-[#8e1818]",disabled:v,children:v?"Creating Parent...":"Add Child"})]}):r.jsxs("form",{className:"space-y-6",onSubmit:wt,children:[r.jsx("button",{type:"button",onClick:()=>e(1),className:"text-red-600 hover:underline decoration-red-600 transition-all",children:"Back"}),r.jsx("div",{className:"text-center",children:r.jsx("h2",{className:"text-2xl font-extrabold text-[#ab1c1c]",children:"Import Existing Child Record"})}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Selected Parent Details"}),r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",u==null?void 0:u.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Mobile:"})," ",u==null?void 0:u.mobilenumber]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Address:"})," ",u==null?void 0:u.address]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Case Details"}),r.jsxs("div",{className:"flex flex-col gap-1 mb-6",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Doctor"}),r.jsxs("select",{value:A,onChange:Ge=>U(Ge.target.value),className:"w-full py-1.5 px-2 text-sm border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:"Select Doctor"}),_.map(Ge=>r.jsx("option",{value:Ge._id,children:Ge.name},Ge._id))]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Therapist Details"}),ve.map((Ge,nt)=>r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type of Therapy"}),r.jsx("input",{list:"therapy-types",value:Ge.therapyType,onChange:at=>Te(nt,"therapyType",at.target.value),placeholder:"Type or select therapy",className:"w-full py-1.5 px-2 text-sm border border-gray-300 rounded-lg"}),r.jsx("datalist",{id:"therapy-types",children:F8.map(at=>r.jsx("option",{value:at},at))})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Therapist"}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsxs("select",{value:Ge.therapistId,onChange:at=>Te(nt,"therapistId",at.target.value),className:"flex-1 py-1.5 px-2 text-sm border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:Ge.therapyType?"Select Therapist":"Select Therapy First"}),K.map(at=>r.jsx("option",{value:at.id,children:at.name},at.id))]}),r.jsx("button",{type:"button",onClick:()=>pe(nt),className:"bg-[#ab1c1c] text-white px-3 py-1.5 rounded-lg text-sm hover:bg-[#8e1818]",children:"Remove"})]})]})]},nt)),r.jsx("button",{type:"button",onClick:Ce,className:"mt-2 bg-gray-200 px-3 py-1.5 rounded-lg text-sm hover:bg-gray-300",children:"+ Add Therapy"})]}),r.jsxs("div",{className:"flex flex-col gap-1 mt-6",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Branch"}),r.jsxs("select",{value:X,onChange:Ge=>B(Ge.target.value),className:"w-full py-1.5 px-2 text-sm border border-gray-300 rounded-lg",children:[r.jsx("option",{value:"",children:"Select Branch"}),Object.keys(O8).map(Ge=>r.jsx("option",{value:Ge,children:Ge},Ge))]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Child Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Registration ID"}),r.jsx("input",{type:"text",placeholder:"MMYY##/DR",value:G,onChange:Ge=>Y(Ge.target.value.toUpperCase()),className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Case ID"}),r.jsx("input",{type:"text",placeholder:"MMYY##/BR/##",value:Z,onChange:Ge=>J(Ge.target.value.toUpperCase()),className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Child Name"}),r.jsx("input",{type:"text",name:"childName",placeholder:"Enter child name",onChange:be,className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),r.jsx("input",{type:"date",name:"childDob",onChange:be,className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Gender"}),r.jsxs("select",{name:"childGender",onChange:be,className:"p-2 border rounded-lg",children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"Male",children:"Male"}),r.jsx("option",{value:"Female",children:"Female"})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date of Joining"}),r.jsx("input",{type:"date",name:"dateOfJoining",onChange:be,className:"p-2 border rounded-lg"})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Profile Picture"}),r.jsx("input",{type:"file",accept:"image/*",onChange:Je,className:"p-2 border rounded-lg"})]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"font-semibold text-red-700 mb-3",children:"School Information"}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[r.jsx("input",{type:"text",name:"childSchoolName",placeholder:"School Name",onChange:be,className:"p-2 border rounded"}),r.jsxs("select",{name:"childSchoolBoard",onChange:be,className:"p-2 border rounded",children:[r.jsx("option",{value:"",children:"Select Board (Optional)"}),_8.map(Ge=>r.jsx("option",{value:Ge,children:Ge},Ge))]})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-medium text-[#ab1c1c] mb-4",children:"Associated Files"}),I.map(Ge=>r.jsxs("div",{className:"flex gap-2 mb-2 items-end",children:[r.jsxs("div",{className:"flex flex-col gap-1 w-1/4",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Report Type"}),r.jsxs("select",{onChange:nt=>Fe(Ge.id,nt.target.value),className:"p-2 border rounded",children:[r.jsx("option",{value:"",children:"Select"}),R.map(nt=>r.jsx("option",{value:nt,children:nt},nt))]})]}),r.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Upload File"}),r.jsx("input",{type:"file",onChange:nt=>He(Ge.id,nt.target.files[0]),className:"p-2 border rounded"})]}),r.jsx("button",{type:"button",onClick:()=>rt(Ge.id),className:"text-red-600 mb-2",children:""})]},Ge.id)),r.jsx("button",{type:"button",onClick:ue,className:"bg-gray-200 px-3 py-1 rounded",children:"+ Add File"})]}),r.jsx("button",{type:"submit",disabled:v,className:"w-full py-3 bg-[#ab1c1c] text-white rounded-lg font-bold mt-4",children:v?"Processing...":"Register Child"})]})})})]})}function M8(){const s=F.useRef(),[e,t]=F.useState(!1),[n,a]=F.useState(!0);return F.useEffect(()=>{s.current&&(t(s.current.getMobile()),a(s.current.getIsOpen()))},[]),r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(R8,{ref:s,onStateChange:({isMobile:o,isOpen:i})=>{t(o),a(i)}}),r.jsx("div",{className:"transition-all duration-300 ".concat(!e&&n?"ml-64":""),children:r.jsxs(ig,{children:[r.jsx(st,{path:"/",element:r.jsx(BF,{})}),r.jsx(st,{path:"/register",element:r.jsx(HF,{})}),r.jsx(st,{path:"/existingusers",element:r.jsx(L8,{})}),r.jsx(st,{path:"/viewappointment",element:r.jsx(KF,{})}),r.jsx(st,{path:"/manageappointment",element:r.jsx(A8,{})}),r.jsx(st,{path:"/jwlenquiries",element:r.jsx(E8,{})}),r.jsx(st,{path:"/jwlenquiries/:referenceId",element:r.jsx(y8,{})}),r.jsx(st,{path:"/child/:childId",element:r.jsx(m8,{})}),r.jsx(st,{path:"/appointment",element:r.jsx(WF,{})}),r.jsx(st,{path:"/iepreports/:childId",element:r.jsx(b8,{})}),r.jsx(st,{path:"*",element:r.jsx(Eo,{to:"/admindashboard",replace:!0})})]})})]})}var l1={},j4;function P8(){return j4||(j4=1,(function(){var s;function e(j){var D=0;return function(){return D<j.length?{done:!1,value:j[D++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(j,D,z){return j==Array.prototype||j==Object.prototype||(j[D]=z.value),j};function n(j){j=[typeof globalThis=="object"&&globalThis,j,typeof window=="object"&&window,typeof self=="object"&&self,typeof l4=="object"&&l4];for(var D=0;D<j.length;++D){var z=j[D];if(z&&z.Math==Math)return z}throw Error("Cannot find global object")}var a=n(this);function o(j,D){if(D)e:{var z=a;j=j.split(".");for(var q=0;q<j.length-1;q++){var ne=j[q];if(!(ne in z))break e;z=z[ne]}j=j[j.length-1],q=z[j],D=D(q),D!=q&&D!=null&&t(z,j,{configurable:!0,writable:!0,value:D})}}o("Symbol",function(j){function D(fe){if(this instanceof D)throw new TypeError("Symbol is not a constructor");return new z(q+(fe||"")+"_"+ne++,fe)}function z(fe,ie){this.g=fe,t(this,"description",{configurable:!0,writable:!0,value:ie})}if(j)return j;z.prototype.toString=function(){return this.g};var q="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ne=0;return D}),o("Symbol.iterator",function(j){if(j)return j;j=Symbol("Symbol.iterator");for(var D="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),z=0;z<D.length;z++){var q=a[D[z]];typeof q=="function"&&typeof q.prototype[j]!="function"&&t(q.prototype,j,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return j});function i(j){return j={next:j},j[Symbol.iterator]=function(){return this},j}function c(j){var D=typeof Symbol<"u"&&Symbol.iterator&&j[Symbol.iterator];return D?D.call(j):{next:e(j)}}function u(j){if(!(j instanceof Array)){j=c(j);for(var D,z=[];!(D=j.next()).done;)z.push(D.value);j=z}return j}var h=typeof Object.create=="function"?Object.create:function(j){function D(){}return D.prototype=j,new D},p;if(typeof Object.setPrototypeOf=="function")p=Object.setPrototypeOf;else{var f;e:{var g={a:!0},b={};try{b.__proto__=g,f=b.a;break e}catch(j){}f=!1}p=f?function(j,D){if(j.__proto__=D,j.__proto__!==D)throw new TypeError(j+" is not extensible");return j}:null}var y=p;function w(j,D){if(j.prototype=h(D.prototype),j.prototype.constructor=j,y)y(j,D);else for(var z in D)if(z!="prototype")if(Object.defineProperties){var q=Object.getOwnPropertyDescriptor(D,z);q&&Object.defineProperty(j,z,q)}else j[z]=D[z];j.na=D.prototype}function v(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function N(j){if(j.l)throw new TypeError("Generator is already running");j.l=!0}v.prototype.s=function(j){this.h=j};function C(j,D){j.j={da:D,ea:!0},j.g=j.o||j.u}v.prototype.return=function(j){this.j={return:j},this.g=this.u};function T(j,D,z){return j.g=z,{value:D}}function I(j){this.g=new v,this.h=j}function $(j,D){N(j.g);var z=j.g.i;return z?R(j,"return"in z?z.return:function(q){return{value:q,done:!0}},D,j.g.return):(j.g.return(D),O(j))}function R(j,D,z,q){try{var ne=D.call(j.g.i,z);if(!(ne instanceof Object))throw new TypeError("Iterator result "+ne+" is not an object");if(!ne.done)return j.g.l=!1,ne;var fe=ne.value}catch(ie){return j.g.i=null,C(j.g,ie),O(j)}return j.g.i=null,q.call(j.g,fe),O(j)}function O(j){for(;j.g.g;)try{var D=j.h(j.g);if(D)return j.g.l=!1,{value:D.value,done:!1}}catch(z){j.g.h=void 0,C(j.g,z)}if(j.g.l=!1,j.g.j){if(D=j.g.j,j.g.j=null,D.ea)throw D.da;return{value:D.return,done:!0}}return{value:void 0,done:!0}}function P(j){this.next=function(D){return N(j.g),j.g.i?D=R(j,j.g.i.next,D,j.g.s):(j.g.s(D),D=O(j)),D},this.throw=function(D){return N(j.g),j.g.i?D=R(j,j.g.i.throw,D,j.g.s):(C(j.g,D),D=O(j)),D},this.return=function(D){return $(j,D)},this[Symbol.iterator]=function(){return this}}function _(j){function D(q){return j.next(q)}function z(q){return j.throw(q)}return new Promise(function(q,ne){function fe(ie){ie.done?q(ie.value):Promise.resolve(ie.value).then(D,z).then(fe,ne)}fe(j.next())})}function M(j){return _(new P(new I(j)))}o("Promise",function(j){function D(ie){this.h=0,this.i=void 0,this.g=[],this.s=!1;var ke=this.j();try{ie(ke.resolve,ke.reject)}catch(De){ke.reject(De)}}function z(){this.g=null}function q(ie){return ie instanceof D?ie:new D(function(ke){ke(ie)})}if(j)return j;z.prototype.h=function(ie){if(this.g==null){this.g=[];var ke=this;this.i(function(){ke.l()})}this.g.push(ie)};var ne=a.setTimeout;z.prototype.i=function(ie){ne(ie,0)},z.prototype.l=function(){for(;this.g&&this.g.length;){var ie=this.g;this.g=[];for(var ke=0;ke<ie.length;++ke){var De=ie[ke];ie[ke]=null;try{De()}catch(qe){this.j(qe)}}}this.g=null},z.prototype.j=function(ie){this.i(function(){throw ie})},D.prototype.j=function(){function ie(qe){return function(ct){De||(De=!0,qe.call(ke,ct))}}var ke=this,De=!1;return{resolve:ie(this.D),reject:ie(this.l)}},D.prototype.D=function(ie){if(ie===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(ie instanceof D)this.H(ie);else{e:switch(typeof ie){case"object":var ke=ie!=null;break e;case"function":ke=!0;break e;default:ke=!1}ke?this.A(ie):this.o(ie)}},D.prototype.A=function(ie){var ke=void 0;try{ke=ie.then}catch(De){this.l(De);return}typeof ke=="function"?this.I(ke,ie):this.o(ie)},D.prototype.l=function(ie){this.u(2,ie)},D.prototype.o=function(ie){this.u(1,ie)},D.prototype.u=function(ie,ke){if(this.h!=0)throw Error("Cannot settle("+ie+", "+ke+"): Promise already settled in state"+this.h);this.h=ie,this.i=ke,this.h===2&&this.G(),this.B()},D.prototype.G=function(){var ie=this;ne(function(){if(ie.C()){var ke=a.console;typeof ke<"u"&&ke.error(ie.i)}},1)},D.prototype.C=function(){if(this.s)return!1;var ie=a.CustomEvent,ke=a.Event,De=a.dispatchEvent;return typeof De>"u"?!0:(typeof ie=="function"?ie=new ie("unhandledrejection",{cancelable:!0}):typeof ke=="function"?ie=new ke("unhandledrejection",{cancelable:!0}):(ie=a.document.createEvent("CustomEvent"),ie.initCustomEvent("unhandledrejection",!1,!0,ie)),ie.promise=this,ie.reason=this.i,De(ie))},D.prototype.B=function(){if(this.g!=null){for(var ie=0;ie<this.g.length;++ie)fe.h(this.g[ie]);this.g=null}};var fe=new z;return D.prototype.H=function(ie){var ke=this.j();ie.M(ke.resolve,ke.reject)},D.prototype.I=function(ie,ke){var De=this.j();try{ie.call(ke,De.resolve,De.reject)}catch(qe){De.reject(qe)}},D.prototype.then=function(ie,ke){function De(St,ht){return typeof St=="function"?function($t){try{qe(St($t))}catch(Ut){ct(Ut)}}:ht}var qe,ct,Nt=new D(function(St,ht){qe=St,ct=ht});return this.M(De(ie,qe),De(ke,ct)),Nt},D.prototype.catch=function(ie){return this.then(void 0,ie)},D.prototype.M=function(ie,ke){function De(){switch(qe.h){case 1:ie(qe.i);break;case 2:ke(qe.i);break;default:throw Error("Unexpected state: "+qe.h)}}var qe=this;this.g==null?fe.h(De):this.g.push(De),this.s=!0},D.resolve=q,D.reject=function(ie){return new D(function(ke,De){De(ie)})},D.race=function(ie){return new D(function(ke,De){for(var qe=c(ie),ct=qe.next();!ct.done;ct=qe.next())q(ct.value).M(ke,De)})},D.all=function(ie){var ke=c(ie),De=ke.next();return De.done?q([]):new D(function(qe,ct){function Nt($t){return function(Ut){St[$t]=Ut,ht--,ht==0&&qe(St)}}var St=[],ht=0;do St.push(void 0),ht++,q(De.value).M(Nt(St.length-1),ct),De=ke.next();while(!De.done)})},D});function A(j,D){j instanceof String&&(j+="");var z=0,q=!1,ne={next:function(){if(!q&&z<j.length){var fe=z++;return{value:D(fe,j[fe]),done:!1}}return q=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}var U=typeof Object.assign=="function"?Object.assign:function(j,D){for(var z=1;z<arguments.length;z++){var q=arguments[z];if(q)for(var ne in q)Object.prototype.hasOwnProperty.call(q,ne)&&(j[ne]=q[ne])}return j};o("Object.assign",function(j){return j||U}),o("Object.is",function(j){return j||function(D,z){return D===z?D!==0||1/D===1/z:D!==D&&z!==z}}),o("Array.prototype.includes",function(j){return j||function(D,z){var q=this;q instanceof String&&(q=String(q));var ne=q.length;for(z=z||0,0>z&&(z=Math.max(z+ne,0));z<ne;z++){var fe=q[z];if(fe===D||Object.is(fe,D))return!0}return!1}}),o("String.prototype.includes",function(j){return j||function(D,z){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(D instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(D,z||0)!==-1}}),o("Array.prototype.keys",function(j){return j||function(){return A(this,function(D){return D})}});var K=this||self;function Q(j,D){j=j.split(".");var z=K;j[0]in z||typeof z.execScript>"u"||z.execScript("var "+j[0]);for(var q;j.length&&(q=j.shift());)j.length||D===void 0?z[q]&&z[q]!==Object.prototype[q]?z=z[q]:z=z[q]={}:z[q]=D}function X(){throw Error("Invalid UTF8")}function B(j,D){return D=String.fromCharCode.apply(null,D),j==null?D:j+D}var G,Y=typeof TextDecoder<"u",Z,J=typeof TextEncoder<"u",xe={},ye=null;function ve(j){var D;D===void 0&&(D=0),pe(),D=xe[D];for(var z=Array(Math.floor(j.length/3)),q=D[64]||"",ne=0,fe=0;ne<j.length-2;ne+=3){var ie=j[ne],ke=j[ne+1],De=j[ne+2],qe=D[ie>>2];ie=D[(ie&3)<<4|ke>>4],ke=D[(ke&15)<<2|De>>6],De=D[De&63],z[fe++]=qe+ie+ke+De}switch(qe=0,De=q,j.length-ne){case 2:qe=j[ne+1],De=D[(qe&15)<<2]||q;case 1:j=j[ne],z[fe]=D[j>>2]+D[(j&3)<<4|qe>>4]+De+q}return z.join("")}function Re(j){var D=j.length,z=3*D/4;z%3?z=Math.floor(z):"=.".indexOf(j[D-1])!=-1&&(z="=.".indexOf(j[D-2])!=-1?z-2:z-1);var q=new Uint8Array(z),ne=0;return Ce(j,function(fe){q[ne++]=fe}),ne!==z?q.subarray(0,ne):q}function Ce(j,D){function z(De){for(;q<j.length;){var qe=j.charAt(q++),ct=ye[qe];if(ct!=null)return ct;if(!/^[\s\xa0]*$/.test(qe))throw Error("Unknown base64 encoding at char: "+qe)}return De}pe();for(var q=0;;){var ne=z(-1),fe=z(0),ie=z(64),ke=z(64);if(ke===64&&ne===-1)break;D(ne<<2|fe>>4),ie!=64&&(D(fe<<4&240|ie>>2),ke!=64&&D(ie<<6&192|ke))}}function pe(){if(!ye){ye={};for(var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),D=["+/=","+/","-_=","-_.","-_"],z=0;5>z;z++){var q=j.concat(D[z].split(""));xe[z]=q;for(var ne=0;ne<q.length;ne++){var fe=q[ne];ye[fe]===void 0&&(ye[fe]=ne)}}}}var Te=typeof Uint8Array=="function";function ee(j){return Te&&j!=null&&j instanceof Uint8Array}var he;function oe(j){if(this.L=j,j!==null&&j.length===0)throw Error("ByteString should be constructed with non-empty values")}var Ie=typeof Uint8Array.prototype.slice=="function",Be=0,We=0;function Ke(j,D){if(j.constructor===Uint8Array)return j;if(j.constructor===ArrayBuffer)return new Uint8Array(j);if(j.constructor===Array)return new Uint8Array(j);if(j.constructor===String)return Re(j);if(j.constructor===oe)return!D&&(D=j.L)&&D.constructor===Uint8Array?D:(D=j.L,D=D==null||ee(D)?D:typeof D=="string"?Re(D):null,(j=j.L=D)?new Uint8Array(j):he||(he=new Uint8Array(0)));if(j instanceof Uint8Array)return new Uint8Array(j.buffer,j.byteOffset,j.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}function be(j,D){return Error("Invalid wire type: "+j+" (at position "+D+")")}function ue(){return Error("Failed to read varint, encoding is invalid.")}function Fe(j,D){D=D===void 0?{}:D,D=D.v===void 0?!1:D.v,this.h=null,this.g=this.i=this.j=0,this.v=D,j&&He(this,j)}function He(j,D){j.h=Ke(D,j.v),j.j=0,j.i=j.h.length,j.g=j.j}Fe.prototype.reset=function(){this.g=this.j};function rt(j){if(j.g>j.i)throw Error("Tried to read past the end of the data "+j.g+" > "+j.i)}function Je(j){var D=j.h,z=D[j.g],q=z&127;if(128>z)return j.g+=1,rt(j),q;if(z=D[j.g+1],q|=(z&127)<<7,128>z)return j.g+=2,rt(j),q;if(z=D[j.g+2],q|=(z&127)<<14,128>z)return j.g+=3,rt(j),q;if(z=D[j.g+3],q|=(z&127)<<21,128>z)return j.g+=4,rt(j),q;if(z=D[j.g+4],j.g+=5,q|=(z&15)<<28,128>z)return rt(j),q;if(128<=D[j.g++]&&128<=D[j.g++]&&128<=D[j.g++]&&128<=D[j.g++]&&128<=D[j.g++])throw ue();return rt(j),q}var Wt=[];function At(){this.g=[]}At.prototype.length=function(){return this.g.length},At.prototype.end=function(){var j=this.g;return this.g=[],j};function wt(j,D){for(;127<D;)j.g.push(D&127|128),D>>>=7;j.g.push(D)}function Ge(j){var D={},z=D.W===void 0?!1:D.W;this.l={v:D.v===void 0?!1:D.v},this.W=z,D=this.l,Wt.length?(z=Wt.pop(),D&&(z.v=D.v),j&&He(z,j),j=z):j=new Fe(j,D),this.g=j,this.j=this.g.g,this.h=this.i=-1}Ge.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};function nt(j){var D=j.g;if(D.g==D.i)return!1;j.j=j.g.g;var z=Je(j.g)>>>0;if(D=z>>>3,z&=7,!(0<=z&&5>=z))throw be(z,j.j);if(1>D)throw Error("Invalid field number: "+D+" (at position "+j.j+")");return j.i=D,j.h=z,!0}function at(j){switch(j.h){case 0:if(j.h!=0)at(j);else e:{j=j.g;for(var D=j.g,z=D+10;D<z;)if((j.h[D++]&128)===0){j.g=D,rt(j);break e}throw ue()}break;case 1:j=j.g,j.g+=8,rt(j);break;case 2:j.h!=2?at(j):(D=Je(j.g)>>>0,j=j.g,j.g+=D,rt(j));break;case 5:j=j.g,j.g+=4,rt(j);break;case 3:D=j.i;do{if(!nt(j))throw Error("Unmatched start-group tag: stream EOF");if(j.h==4){if(j.i!=D)throw Error("Unmatched end-group tag");break}at(j)}while(!0);break;default:throw be(j.h,j.j)}}var pt=[];function jt(){this.i=[],this.h=0,this.g=new At}function It(j,D){D.length!==0&&(j.i.push(D),j.h+=D.length)}function an(j,D){if(D=D.ba){It(j,j.g.end());for(var z=0;z<D.length;z++)It(j,D[z])}}var $s=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function rn(j,D){Object.isFrozen(j)||($s?j[$s]|=D:j.N!==void 0?j.N|=D:Object.defineProperties(j,{N:{value:D,configurable:!0,writable:!0,enumerable:!1}}))}function Fn(j){var D;return $s?D=j[$s]:D=j.N,D==null?0:D}function Yn(j){return rn(j,1),j}function As(j){return Array.isArray(j)?!!(Fn(j)&2):!1}function Ps(j){if(!Array.isArray(j))throw Error("cannot mark non-array as immutable");rn(j,2)}function Or(j){return j!==null&&typeof j=="object"&&!Array.isArray(j)&&j.constructor===Object}var la=Object.freeze(Yn([]));function sl(j){if(As(j.m))throw Error("Cannot mutate an immutable Message")}var nl=typeof Symbol<"u"&&typeof Symbol.hasInstance<"u";function Ko(j){return{value:j,configurable:!1,writable:!1,enumerable:!1}}function on(j,D,z){return D===-1?null:D>=j.i?j.g?j.g[D]:void 0:z!==void 0&&z&&j.g&&(z=j.g[D],z!=null)?z:j.m[D+j.h]}function Ns(j,D,z,q){q=q===void 0?!1:q,sl(j),D<j.i&&!q?j.m[D+j.h]=z:(j.g||(j.g=j.m[j.i+j.h]={}))[D]=z}function al(j,D,z,q){z=z===void 0?!0:z,q=q===void 0?!1:q;var ne=on(j,D,q);return ne==null&&(ne=la),As(j.m)?z&&(Ps(ne),Object.freeze(ne)):(ne===la||As(ne))&&(ne=Yn(ne.slice()),Ns(j,D,ne,q)),ne}function Zn(j,D,z){return j=on(j,D),j=j==null?j:+j,j==null?z===void 0?0:z:j}function _r(j,D,z,q){j.j||(j.j={});var ne=As(j.m),fe=j.j[z];if(!fe){q=al(j,z,!0,q===void 0?!1:q),fe=[],ne=ne||As(q);for(var ie=0;ie<q.length;ie++)fe[ie]=new D(q[ie]),ne&&Ps(fe[ie].m);ne&&(Ps(fe),Object.freeze(fe)),j.j[z]=fe}return fe}function Oe(j,D,z,q,ne){var fe=fe===void 0?!1:fe;return sl(j),fe=_r(j,z,D,fe),z=q||new z,j=al(j,D),ne!=null?(fe.splice(ne,0,z),j.splice(ne,0,z.m)):(fe.push(z),j.push(z.m)),z}function et(j,D){return j=on(j,D),j==null?0:j}function Ln(j,D){return j=on(j,D),j==null?"":j}function ln(j){switch(typeof j){case"number":return isFinite(j)?j:String(j);case"object":if(j&&!Array.isArray(j)){if(ee(j))return ve(j);if(j instanceof oe){var D=j.L;return D=D==null||typeof D=="string"?D:Te&&D instanceof Uint8Array?ve(D):null,(j.L=D)||""}}}return j}function Ss(j){var D=io;return D=D===void 0?Ku:D,Ba(j,D)}function Cs(j,D){if(j!=null){if(Array.isArray(j))j=Ba(j,D);else if(Or(j)){var z={},q;for(q in j)z[q]=Cs(j[q],D);j=z}else j=D(j);return j}}function Ba(j,D){for(var z=j.slice(),q=0;q<z.length;q++)z[q]=Cs(z[q],D);return Array.isArray(j)&&Fn(j)&1&&Yn(z),z}function io(j){return j&&typeof j=="object"&&j.toJSON?j.toJSON():(j=ln(j),Array.isArray(j)?Ss(j):j)}function Ku(j){return ee(j)?new Uint8Array(j):j}function uc(j,D,z){j||(j=Xu),Xu=null;var q=this.constructor.h;j||(j=q?[q]:[]),this.h=(q?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=j;e:{if(q=this.m.length,j=q-1,q&&(q=this.m[j],Or(q))){this.i=j-this.h,this.g=q;break e}D!==void 0&&-1<D?(this.i=Math.max(D,j+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE}if(z)for(D=0;D<z.length;D++)if(j=z[D],j<this.i)j+=this.h,(q=this.m[j])?Array.isArray(q)&&Yn(q):this.m[j]=la;else{q=this.g||(this.g=this.m[this.i+this.h]={});var ne=q[j];ne?Array.isArray(ne)&&Yn(ne):q[j]=la}}uc.prototype.toJSON=function(){return Ss(this.m)},uc.prototype.toString=function(){return this.m.toString()};var Xu;function Fr(){uc.apply(this,arguments)}if(w(Fr,uc),nl){var dc={};Object.defineProperties(Fr,(dc[Symbol.hasInstance]=Ko(function(){throw Error("Cannot perform instanceof checks for MutableMessage")}),dc))}function lo(j,D,z){if(z){var q={},ne;for(ne in z){var fe=z[ne],ie=fe.ha;ie||(q.F=fe.la||fe.fa.P,fe.aa?(q.U=uo(fe.aa),ie=function(ke){return function(De,qe,ct){return ke.F(De,qe,ct,ke.U)}}(q)):fe.ca?(q.T=Yp(fe.X.g,fe.ca),ie=function(ke){return function(De,qe,ct){return ke.F(De,qe,ct,ke.T)}}(q)):ie=q.F,fe.ha=ie),ie(D,j,fe.X),q={F:q.F,U:q.U,T:q.T}}}an(D,j)}var gr=Symbol();function Xo(j,D,z){return j[gr]||(j[gr]=function(q,ne){return D(q,ne,z)})}function co(j){var D=j[gr];if(!D){var z=Jp(j);D=function(q,ne){return ed(q,ne,z)},j[gr]=D}return D}function Ws(j){var D=j.aa;if(D)return co(D);if(D=j.ka)return Xo(j.X.g,D,j.ca)}function Xp(j){var D=Ws(j),z=j.X,q=j.fa.O;return D?function(ne,fe){return q(ne,fe,z,D)}:function(ne,fe){return q(ne,fe,z)}}function Yu(j,D,z,q,ne,fe){j=j();var ie=0;for(j.length&&typeof j[0]!="number"&&(z(D,j[0]),ie++);ie<j.length;){z=j[ie++];for(var ke=ie+1;ke<j.length&&typeof j[ke]!="number";)ke++;var De=j[ie++];switch(ke-=ie,ke){case 0:q(D,z,De);break;case 1:q(D,z,De,j[ie++]);break;case 2:ne(D,z,De,j[ie++],j[ie++]);break;case 3:ke=j[ie++];var qe=j[ie++],ct=j[ie++];Array.isArray(ct)?ne(D,z,De,ke,qe,ct):fe(D,z,De,ke,qe,ct);break;case 4:fe(D,z,De,j[ie++],j[ie++],j[ie++],j[ie++]);break;default:throw Error("unexpected number of binary field arguments: "+ke)}}return D}var Va=Symbol();function uo(j){var D=j[Va];if(!D){var z=Ua(j);D=function(q,ne){return td(q,ne,z)},j[Va]=D}return D}function Yp(j,D){var z=j[Va];return z||(z=function(q,ne){return lo(q,ne,D)},j[Va]=z),z}var Zu=Symbol();function Zp(j,D){j.push(D)}function n0(j,D,z){j.push(D,z.P)}function hc(j,D,z,q,ne){var fe=uo(ne),ie=z.P;j.push(D,function(ke,De,qe){return ie(ke,De,qe,q,fe)})}function pc(j,D,z,q,ne,fe){var ie=Yp(q,fe),ke=z.P;j.push(D,function(De,qe,ct){return ke(De,qe,ct,q,ie)})}function Ua(j){var D=j[Zu];return D||Yu(j,j[Zu]=[],Zp,n0,hc,pc)}var fc=Symbol();function Qp(j,D){j[0]=D}function Yo(j,D,z,q){var ne=z.O;j[D]=q?function(fe,ie,ke){return ne(fe,ie,ke,q)}:ne}function Qu(j,D,z,q,ne,fe){var ie=z.O,ke=co(ne);j[D]=function(De,qe,ct){return ie(De,qe,ct,q,ke,fe)}}function Ju(j,D,z,q,ne,fe,ie){var ke=z.O,De=Xo(q,ne,fe);j[D]=function(qe,ct,Nt){return ke(qe,ct,Nt,q,De,ie)}}function Jp(j){var D=j[fc];return D||Yu(j,j[fc]={},Qp,Yo,Qu,Ju)}function ed(j,D,z){for(;nt(D)&&D.h!=4;){var q=D.i,ne=z[q];if(!ne){var fe=z[0];fe&&(fe=fe[q])&&(ne=z[q]=Xp(fe))}if((!ne||!ne(D,j,q))&&(ne=D,q=j,fe=ne.j,at(ne),!ne.W)){var ie=ne.g.h;ne=ne.g.g,ne=fe===ne?he||(he=new Uint8Array(0)):Ie?ie.slice(fe,ne):new Uint8Array(ie.subarray(fe,ne)),(fe=q.ba)?fe.push(ne):q.ba=[ne]}}return j}function Mn(j,D,z){if(pt.length){var q=pt.pop();j&&(He(q.g,j),q.i=-1,q.h=-1),j=q}else j=new Ge(j);try{return ed(new D,j,Jp(z))}finally{D=j.g,D.h=null,D.j=0,D.i=0,D.g=0,D.v=!1,j.i=-1,j.h=-1,100>pt.length&&pt.push(j)}}function td(j,D,z){for(var q=z.length,ne=q%2==1,fe=ne?1:0;fe<q;fe+=2)(0,z[fe+1])(D,j,z[fe]);lo(j,D,ne?z[0]:void 0)}function sd(j,D){var z=new jt;td(j,z,Ua(D)),It(z,z.g.end()),j=new Uint8Array(z.h),D=z.i;for(var q=D.length,ne=0,fe=0;fe<q;fe++){var ie=D[fe];j.set(ie,ne),ne+=ie.length}return z.i=[j],j}function Lr(j,D){return{O:j,P:D}}var ca=Lr(function(j,D,z){if(j.h!==5)return!1;j=j.g;var q=j.h[j.g],ne=j.h[j.g+1],fe=j.h[j.g+2],ie=j.h[j.g+3];return j.g+=4,rt(j),ne=(q<<0|ne<<8|fe<<16|ie<<24)>>>0,j=2*(ne>>31)+1,q=ne>>>23&255,ne&=8388607,Ns(D,z,q==255?ne?NaN:1/0*j:q==0?j*Math.pow(2,-149)*ne:j*Math.pow(2,q-150)*(ne+Math.pow(2,23))),!0},function(j,D,z){if(D=on(D,z),D!=null){wt(j.g,8*z+5),j=j.g;var q=D;q=(z=0>q?1:0)?-q:q,q===0?0<1/q?Be=We=0:(We=0,Be=2147483648):isNaN(q)?(We=0,Be=2147483647):34028234663852886e22<q?(We=0,Be=(z<<31|2139095040)>>>0):11754943508222875e-54>q?(q=Math.round(q/Math.pow(2,-149)),We=0,Be=(z<<31|q)>>>0):(D=Math.floor(Math.log(q)/Math.LN2),q*=Math.pow(2,-D),q=Math.round(8388608*q),16777216<=q&&++D,We=0,Be=(z<<31|D+127<<23|q&8388607)>>>0),z=Be,j.g.push(z>>>0&255),j.g.push(z>>>8&255),j.g.push(z>>>16&255),j.g.push(z>>>24&255)}}),mc=Lr(function(j,D,z){if(j.h!==0)return!1;for(var q=j.g,ne=128,fe=0,ie=j=0;4>ie&&128<=ne;ie++)ne=q.h[q.g++],rt(q),fe|=(ne&127)<<7*ie;if(128<=ne&&(ne=q.h[q.g++],rt(q),fe|=(ne&127)<<28,j|=(ne&127)>>4),128<=ne)for(ie=0;5>ie&&128<=ne;ie++)ne=q.h[q.g++],rt(q),j|=(ne&127)<<7*ie+3;if(128>ne)q=fe>>>0,ne=j>>>0,(j=ne&2147483648)&&(q=~q+1>>>0,ne=~ne>>>0,q==0&&(ne=ne+1>>>0)),q=4294967296*ne+(q>>>0);else throw ue();return Ns(D,z,j?-q:q),!0},function(j,D,z){if(D=on(D,z),D!=null&&D!=null){wt(j.g,8*z),j=j.g;var q=D;for(z=0>q,q=Math.abs(q),D=q>>>0,q=Math.floor((q-D)/4294967296),q>>>=0,z&&(q=~q>>>0,D=(~D>>>0)+1,4294967295<D&&(D=0,q++,4294967295<q&&(q=0))),Be=D,We=q,z=Be,D=We;0<D||127<z;)j.g.push(z&127|128),z=(z>>>7|D<<25)>>>0,D>>>=7;j.g.push(z)}}),a0=Lr(function(j,D,z){return j.h!==0?!1:(Ns(D,z,Je(j.g)),!0)},function(j,D,z){if(D=on(D,z),D!=null&&D!=null)if(wt(j.g,8*z),j=j.g,z=D,0<=z)wt(j,z);else{for(D=0;9>D;D++)j.g.push(z&127|128),z>>=7;j.g.push(1)}}),Qn=Lr(function(j,D,z){if(j.h!==2)return!1;var q=Je(j.g)>>>0;j=j.g;var ne=j.g;j.g+=q,rt(j),j=j.h;var fe;if(Y)(fe=G)||(fe=G=new TextDecoder("utf-8",{fatal:!0})),fe=fe.decode(j.subarray(ne,ne+q));else{q=ne+q;for(var ie=[],ke=null,De,qe,ct;ne<q;)De=j[ne++],128>De?ie.push(De):224>De?ne>=q?X():(qe=j[ne++],194>De||(qe&192)!==128?(ne--,X()):ie.push((De&31)<<6|qe&63)):240>De?ne>=q-1?X():(qe=j[ne++],(qe&192)!==128||De===224&&160>qe||De===237&&160<=qe||((fe=j[ne++])&192)!==128?(ne--,X()):ie.push((De&15)<<12|(qe&63)<<6|fe&63)):244>=De?ne>=q-2?X():(qe=j[ne++],(qe&192)!==128||(De<<28)+(qe-144)>>30!==0||((fe=j[ne++])&192)!==128||((ct=j[ne++])&192)!==128?(ne--,X()):(De=(De&7)<<18|(qe&63)<<12|(fe&63)<<6|ct&63,De-=65536,ie.push((De>>10&1023)+55296,(De&1023)+56320))):X(),8192<=ie.length&&(ke=B(ke,ie),ie.length=0);fe=B(ke,ie)}return Ns(D,z,fe),!0},function(j,D,z){if(D=on(D,z),D!=null){var q=!1;if(q=q===void 0?!1:q,J){if(q&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(D))throw Error("Found an unpaired surrogate");D=(Z||(Z=new TextEncoder)).encode(D)}else{for(var ne=0,fe=new Uint8Array(3*D.length),ie=0;ie<D.length;ie++){var ke=D.charCodeAt(ie);if(128>ke)fe[ne++]=ke;else{if(2048>ke)fe[ne++]=ke>>6|192;else{if(55296<=ke&&57343>=ke){if(56319>=ke&&ie<D.length){var De=D.charCodeAt(++ie);if(56320<=De&&57343>=De){ke=1024*(ke-55296)+De-56320+65536,fe[ne++]=ke>>18|240,fe[ne++]=ke>>12&63|128,fe[ne++]=ke>>6&63|128,fe[ne++]=ke&63|128;continue}else ie--}if(q)throw Error("Found an unpaired surrogate");ke=65533}fe[ne++]=ke>>12|224,fe[ne++]=ke>>6&63|128}fe[ne++]=ke&63|128}}D=fe.subarray(0,ne)}wt(j.g,8*z+2),wt(j.g,D.length),It(j,j.g.end()),It(j,D)}}),gc=Lr(function(j,D,z,q,ne){if(j.h!==2)return!1;D=Oe(D,z,q),z=j.g.i,q=Je(j.g)>>>0;var fe=j.g.g+q,ie=fe-z;if(0>=ie&&(j.g.i=fe,ne(D,j),ie=fe-j.g.g),ie)throw Error("Message parsing ended unexpectedly. Expected to read "+(q+" bytes, instead read "+(q-ie)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return j.g.g=fe,j.g.i=z,!0},function(j,D,z,q,ne){if(D=_r(D,q,z),D!=null)for(q=0;q<D.length;q++){var fe=j;wt(fe.g,8*z+2);var ie=fe.g.end();It(fe,ie),ie.push(fe.h),fe=ie,ne(D[q],j),ie=j;var ke=fe.pop();for(ke=ie.h+ie.g.length()-ke;127<ke;)fe.push(ke&127|128),ke>>>=7,ie.h++;fe.push(ke),ie.h++}});function Jn(){Fr.apply(this,arguments)}if(w(Jn,Fr),nl){var xc={};Object.defineProperties(Jn,(xc[Symbol.hasInstance]=Ko(Object[Symbol.hasInstance]),xc))}function Ga(j){Jn.call(this,j)}w(Ga,Jn);function nd(){return[1,a0,2,ca,3,Qn,4,Qn]}function bc(j){Jn.call(this,j,-1,r0)}w(bc,Jn),bc.prototype.addClassification=function(j,D){return Oe(this,1,Ga,j,D),this};function Zo(){return[1,gc,Ga,nd]}var r0=[1];function rl(j){Jn.call(this,j)}w(rl,Jn);function ad(){return[1,ca,2,ca,3,ca,4,ca,5,ca]}function yc(j){Jn.call(this,j,-1,i0)}w(yc,Jn);function o0(){return[1,gc,rl,ad]}var i0=[1];function Qo(j){Jn.call(this,j)}w(Qo,Jn);function vc(){return[1,ca,2,ca,3,ca,4,ca,5,ca,6,mc]}var wc=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ho=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],po=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],rd=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Nc=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],od=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ol=[].concat(u(wc),u(ho),u(po),u(rd),u(Nc),u(od));function Wa(j,D,z){if(z=j.createShader(z===0?j.VERTEX_SHADER:j.FRAGMENT_SHADER),j.shaderSource(z,D),j.compileShader(z),!j.getShaderParameter(z,j.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+j.getShaderInfoLog(z));return z}function id(j){return _r(j,Ga,1).map(function(D){return{index:et(D,1),ga:Zn(D,2),label:on(D,3)!=null?Ln(D,3):void 0,displayName:on(D,4)!=null?Ln(D,4):void 0}})}function il(j){return{x:Zn(j,1),y:Zn(j,2),z:Zn(j,3),visibility:on(j,4)!=null?Zn(j,4):void 0}}function Ha(j,D){this.h=j,this.g=D,this.l=0}function Sc(j,D,z){return Cc(j,D),typeof j.g.canvas.transferToImageBitmap=="function"?Promise.resolve(j.g.canvas.transferToImageBitmap()):z?Promise.resolve(j.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(j.g.canvas):(j.i===void 0&&(j.i=document.createElement("canvas")),new Promise(function(q){j.i.height=j.g.canvas.height,j.i.width=j.g.canvas.width,j.i.getContext("2d",{}).drawImage(j.g.canvas,0,0,j.g.canvas.width,j.g.canvas.height),q(j.i)}))}function Cc(j,D){var z=j.g;if(j.o===void 0){var q=Wa(z,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),ne=Wa(z,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),fe=z.createProgram();if(z.attachShader(fe,q),z.attachShader(fe,ne),z.linkProgram(fe),!z.getProgramParameter(fe,z.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+z.getProgramInfoLog(fe));q=j.o=fe,z.useProgram(q),ne=z.getUniformLocation(q,"sampler0"),j.j={K:z.getAttribLocation(q,"aVertex"),J:z.getAttribLocation(q,"aTex"),ma:ne},j.u=z.createBuffer(),z.bindBuffer(z.ARRAY_BUFFER,j.u),z.enableVertexAttribArray(j.j.K),z.vertexAttribPointer(j.j.K,2,z.FLOAT,!1,0,0),z.bufferData(z.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),z.STATIC_DRAW),z.bindBuffer(z.ARRAY_BUFFER,null),j.s=z.createBuffer(),z.bindBuffer(z.ARRAY_BUFFER,j.s),z.enableVertexAttribArray(j.j.J),z.vertexAttribPointer(j.j.J,2,z.FLOAT,!1,0,0),z.bufferData(z.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),z.STATIC_DRAW),z.bindBuffer(z.ARRAY_BUFFER,null),z.uniform1i(ne,0)}q=j.j,z.useProgram(j.o),z.canvas.width=D.width,z.canvas.height=D.height,z.viewport(0,0,D.width,D.height),z.activeTexture(z.TEXTURE0),j.h.bindTexture2d(D.glName),z.enableVertexAttribArray(q.K),z.bindBuffer(z.ARRAY_BUFFER,j.u),z.vertexAttribPointer(q.K,2,z.FLOAT,!1,0,0),z.enableVertexAttribArray(q.J),z.bindBuffer(z.ARRAY_BUFFER,j.s),z.vertexAttribPointer(q.J,2,z.FLOAT,!1,0,0),z.bindFramebuffer(z.DRAW_FRAMEBUFFER?z.DRAW_FRAMEBUFFER:z.FRAMEBUFFER,null),z.clearColor(0,0,0,0),z.clear(z.COLOR_BUFFER_BIT),z.colorMask(!0,!0,!0,!0),z.drawArrays(z.TRIANGLE_FAN,0,4),z.disableVertexAttribArray(q.K),z.disableVertexAttribArray(q.J),z.bindBuffer(z.ARRAY_BUFFER,null),j.h.bindTexture2d(0)}function ef(j){this.g=j}var jc=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function kc(j,D){return D+j}function ld(j,D){window[j]=D}function Pn(j){var D=document.createElement("script");return D.setAttribute("src",j),D.setAttribute("crossorigin","anonymous"),new Promise(function(z){D.addEventListener("load",function(){z()},!1),D.addEventListener("error",function(){z()},!1),document.body.appendChild(D)})}function fo(){return M(function(j){switch(j.g){case 1:return j.o=2,T(j,WebAssembly.instantiate(jc),4);case 4:j.g=3,j.o=0;break;case 2:return j.o=0,j.j=null,j.return(!1);case 3:return j.return(!0)}})}function Jo(j){if(this.g=j,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=j&&j.locateFile||kc,typeof window=="object")var D=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")D=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.$=D,j.options){D=c(Object.keys(j.options));for(var z=D.next();!z.done;z=D.next()){z=z.value;var q=j.options[z].default;q!==void 0&&(this.j[z]=typeof q=="function"?q():q)}}}s=Jo.prototype,s.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function ll(j){var D,z,q,ne,fe,ie,ke,De,qe,ct,Nt;return M(function(St){switch(St.g){case 1:return j.Z?(D=j.g.files===void 0?[]:typeof j.g.files=="function"?j.g.files(j.j):j.g.files,T(St,fo(),2)):St.return();case 2:if(z=St.h,typeof window=="object")return ld("createMediapipeSolutionsWasm",{locateFile:j.locateFile}),ld("createMediapipeSolutionsPackedAssets",{locateFile:j.locateFile}),ie=D.filter(function(ht){return ht.data!==void 0}),ke=D.filter(function(ht){return ht.data===void 0}),De=Promise.all(ie.map(function(ht){var $t=ei(j,ht.url);if(ht.path!==void 0){var Ut=ht.path;$t=$t.then(function(cs){return j.overrideFile(Ut,cs),Promise.resolve(cs)})}return $t})),qe=Promise.all(ke.map(function(ht){return ht.simd===void 0||ht.simd&&z||!ht.simd&&!z?Pn(j.locateFile(ht.url,j.$)):Promise.resolve()})).then(function(){var ht,$t,Ut;return M(function(cs){if(cs.g==1)return ht=window.createMediapipeSolutionsWasm,$t=window.createMediapipeSolutionsPackedAssets,Ut=j,T(cs,ht($t),2);Ut.h=cs.h,cs.g=0})}),ct=function(){return M(function(ht){return j.g.graph&&j.g.graph.url?ht=T(ht,ei(j,j.g.graph.url),0):(ht.g=0,ht=void 0),ht})}(),T(St,Promise.all([qe,De,ct]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return q=D.filter(function(ht){return ht.simd===void 0||ht.simd&&z||!ht.simd&&!z}).map(function(ht){return j.locateFile(ht.url,j.$)}),importScripts.apply(null,u(q)),ne=j,T(St,createMediapipeSolutionsWasm(Module),6);case 6:ne.h=St.h,j.l=new OffscreenCanvas(1,1),j.h.canvas=j.l,fe=j.h.GL.createContext(j.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),j.h.GL.makeContextCurrent(fe),St.g=4;break;case 7:if(j.l=document.createElement("canvas"),Nt=j.l.getContext("webgl2",{}),!Nt&&(Nt=j.l.getContext("webgl",{}),!Nt))return alert("Failed to create WebGL canvas context when passing video frame."),St.return();j.G=Nt,j.h.canvas=j.l,j.h.createContext(j.l,!0,!0,{});case 4:j.i=new j.h.SolutionWasm,j.Z=!1,St.g=0}})}function l0(j){var D,z,q,ne,fe,ie,ke,De;return M(function(qe){if(qe.g==1){if(j.g.graph&&j.g.graph.url&&j.Y===j.g.graph.url)return qe.return();if(j.s=!0,!j.g.graph||!j.g.graph.url){qe.g=2;return}return j.Y=j.g.graph.url,T(qe,ei(j,j.g.graph.url),3)}for(qe.g!=2&&(D=qe.h,j.i.loadGraph(D)),z=c(Object.keys(j.C)),q=z.next();!q.done;q=z.next())ne=q.value,j.i.overrideFile(ne,j.C[ne]);if(j.C={},j.g.listeners)for(fe=c(j.g.listeners),ie=fe.next();!ie.done;ie=fe.next())ke=ie.value,tf(j,ke);De=j.j,j.j={},j.setOptions(De),qe.g=0})}s.reset=function(){var j=this;return M(function(D){j.i&&(j.i.reset(),j.o={},j.u={}),D.g=0})},s.setOptions=function(j,D){var z=this;if(D=D||this.g.options){for(var q=[],ne=[],fe={},ie=c(Object.keys(j)),ke=ie.next();!ke.done;fe={R:fe.R,S:fe.S},ke=ie.next()){var De=ke.value;De in this.j&&this.j[De]===j[De]||(this.j[De]=j[De],ke=D[De],ke!==void 0&&(ke.onChange&&(fe.R=ke.onChange,fe.S=j[De],q.push(function(qe){return function(){var ct;return M(function(Nt){if(Nt.g==1)return T(Nt,qe.R(qe.S),2);ct=Nt.h,ct===!0&&(z.s=!0),Nt.g=0})}}(fe))),ke.graphOptionXref&&(De={valueNumber:ke.type===1?j[De]:0,valueBoolean:ke.type===0?j[De]:!1,valueString:ke.type===2?j[De]:""},ke=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),ke.graphOptionXref),De),ne.push(ke))))}(q.length!==0||ne.length!==0)&&(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(ne),this.A=(this.A===void 0?[]:this.A).concat(q))}};function cd(j){var D,z,q,ne,fe,ie,ke;return M(function(De){switch(De.g){case 1:if(!j.s)return De.return();if(!j.A){De.g=2;break}D=c(j.A),z=D.next();case 3:if(z.done){De.g=5;break}return q=z.value,T(De,q(),4);case 4:z=D.next(),De.g=3;break;case 5:j.A=void 0;case 2:if(j.B){for(ne=new j.h.GraphOptionChangeRequestList,fe=c(j.B),ie=fe.next();!ie.done;ie=fe.next())ke=ie.value,ne.push_back(ke);j.i.changeOptions(ne),ne.delete(),j.B=void 0}j.s=!1,De.g=0}})}s.initialize=function(){var j=this;return M(function(D){return D.g==1?T(D,ll(j),2):D.g!=3?T(D,l0(j),3):T(D,cd(j),0)})};function ei(j,D){var z,q;return M(function(ne){return D in j.H?ne.return(j.H[D]):(z=j.locateFile(D,""),q=fetch(z).then(function(fe){return fe.arrayBuffer()}),j.H[D]=q,ne.return(q))})}s.overrideFile=function(j,D){this.i?this.i.overrideFile(j,D):this.C[j]=D},s.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},s.send=function(j,D){var z=this,q,ne,fe,ie,ke,De,qe,ct,Nt;return M(function(St){switch(St.g){case 1:return z.g.inputs?(q=1e3*(D==null?performance.now():D),T(St,z.D,2)):St.return();case 2:return T(St,z.initialize(),3);case 3:for(ne=new z.h.PacketDataList,fe=c(Object.keys(j)),ie=fe.next();!ie.done;ie=fe.next())if(ke=ie.value,De=z.g.inputs[ke]){e:{var ht=j[ke];switch(De.type){case"video":var $t=z.o[De.stream];if($t||($t=new Ha(z.h,z.G),z.o[De.stream]=$t),$t.l===0&&($t.l=$t.h.createTexture()),typeof HTMLVideoElement<"u"&&ht instanceof HTMLVideoElement)var Ut=ht.videoWidth,cs=ht.videoHeight;else typeof HTMLImageElement<"u"&&ht instanceof HTMLImageElement?(Ut=ht.naturalWidth,cs=ht.naturalHeight):(Ut=ht.width,cs=ht.height);cs={glName:$t.l,width:Ut,height:cs},Ut=$t.g,Ut.canvas.width=cs.width,Ut.canvas.height=cs.height,Ut.activeTexture(Ut.TEXTURE0),$t.h.bindTexture2d($t.l),Ut.texImage2D(Ut.TEXTURE_2D,0,Ut.RGBA,Ut.RGBA,Ut.UNSIGNED_BYTE,ht),$t.h.bindTexture2d(0),$t=cs;break e;case"detections":for($t=z.o[De.stream],$t||($t=new ef(z.h),z.o[De.stream]=$t),$t.data||($t.data=new $t.g.DetectionListData),$t.data.reset(ht.length),cs=0;cs<ht.length;++cs){Ut=ht[cs];var Jt=$t.data,cn=Jt.setBoundingBox,ua=cs,zn=Ut.boundingBox,Ht=new Qo;if(Ns(Ht,1,zn.xCenter),Ns(Ht,2,zn.yCenter),Ns(Ht,3,zn.height),Ns(Ht,4,zn.width),Ns(Ht,5,zn.rotation),Ns(Ht,6,zn.rectId),zn=sd(Ht,vc),cn.call(Jt,ua,zn),Ut.landmarks)for(Jt=0;Jt<Ut.landmarks.length;++Jt){Ht=Ut.landmarks[Jt];var zs=!!Ht.visibility;cn=$t.data,ua=cn.addNormalizedLandmark,zn=cs,Ht=Object.assign(Object.assign({},Ht),{visibility:zs?Ht.visibility:0}),zs=new rl,Ns(zs,1,Ht.x),Ns(zs,2,Ht.y),Ns(zs,3,Ht.z),Ht.visibility&&Ns(zs,4,Ht.visibility),Ht=sd(zs,ad),ua.call(cn,zn,Ht)}if(Ut.V)for(Jt=0;Jt<Ut.V.length;++Jt)cn=$t.data,ua=cn.addClassification,zn=cs,Ht=Ut.V[Jt],zs=new Ga,Ns(zs,2,Ht.ga),Ht.index&&Ns(zs,1,Ht.index),Ht.label&&Ns(zs,3,Ht.label),Ht.displayName&&Ns(zs,4,Ht.displayName),Ht=sd(zs,nd),ua.call(cn,zn,Ht)}$t=$t.data;break e;default:$t={}}}switch(qe=$t,ct=De.stream,De.type){case"video":ne.pushTexture2d(Object.assign(Object.assign({},qe),{stream:ct,timestamp:q}));break;case"detections":Nt=qe,Nt.stream=ct,Nt.timestamp=q,ne.pushDetectionList(Nt);break;default:throw Error("Unknown input config type: '"+De.type+"'")}}return z.i.send(ne),T(St,z.D,4);case 4:ne.delete(),St.g=0}})};function cl(j,D,z){var q,ne,fe,ie,ke,De,qe,ct,Nt,St,ht,$t,Ut,cs;return M(function(Jt){switch(Jt.g){case 1:if(!z)return Jt.return(D);for(q={},ne=0,fe=c(Object.keys(z)),ie=fe.next();!ie.done;ie=fe.next())ke=ie.value,De=z[ke],typeof De!="string"&&De.type==="texture"&&D[De.stream]!==void 0&&++ne;1<ne&&(j.I=!1),qe=c(Object.keys(z)),ie=qe.next();case 2:if(ie.done){Jt.g=4;break}if(ct=ie.value,Nt=z[ct],typeof Nt=="string")return Ut=q,cs=ct,T(Jt,Tc(j,ct,D[Nt]),14);if(St=D[Nt.stream],Nt.type==="detection_list"){if(St){for(var cn=St.getRectList(),ua=St.getLandmarksList(),zn=St.getClassificationsList(),Ht=[],zs=0;zs<cn.size();++zs){var Mr=Mn(cn.get(zs),Qo,vc);Mr={boundingBox:{xCenter:Zn(Mr,1),yCenter:Zn(Mr,2),height:Zn(Mr,3),width:Zn(Mr,4),rotation:Zn(Mr,5,0),rectId:et(Mr,6)},landmarks:_r(Mn(ua.get(zs),yc,o0),rl,1).map(il),V:id(Mn(zn.get(zs),bc,Zo))},Ht.push(Mr)}cn=Ht}else cn=[];q[ct]=cn,Jt.g=7;break}if(Nt.type==="proto_list"){if(St){for(cn=Array(St.size()),ua=0;ua<St.size();ua++)cn[ua]=St.get(ua);St.delete()}else cn=[];q[ct]=cn,Jt.g=7;break}if(St===void 0){Jt.g=3;break}if(Nt.type==="float_list"){q[ct]=St,Jt.g=7;break}if(Nt.type==="proto"){q[ct]=St,Jt.g=7;break}if(Nt.type!=="texture")throw Error("Unknown output config type: '"+Nt.type+"'");return ht=j.u[ct],ht||(ht=new Ha(j.h,j.G),j.u[ct]=ht),T(Jt,Sc(ht,St,j.I),13);case 13:$t=Jt.h,q[ct]=$t;case 7:Nt.transform&&q[ct]&&(q[ct]=Nt.transform(q[ct])),Jt.g=3;break;case 14:Ut[cs]=Jt.h;case 3:ie=qe.next(),Jt.g=2;break;case 4:return Jt.return(q)}})}function Tc(j,D,z){var q;return M(function(ne){return typeof z=="number"||z instanceof Uint8Array||z instanceof j.h.Uint8BlobList?ne.return(z):z instanceof j.h.Texture2dDataOut?(q=j.u[D],q||(q=new Ha(j.h,j.G),j.u[D]=q),ne.return(Sc(q,z,j.I))):ne.return(void 0)})}function tf(j,D){for(var z=D.name||"$",q=[].concat(u(D.wants)),ne=new j.h.StringList,fe=c(D.wants),ie=fe.next();!ie.done;ie=fe.next())ne.push_back(ie.value);fe=j.h.PacketListener.implement({onResults:function(ke){for(var De={},qe=0;qe<D.wants.length;++qe)De[q[qe]]=ke.get(qe);var ct=j.listeners[z];ct&&(j.D=cl(j,De,D.outs).then(function(Nt){Nt=ct(Nt);for(var St=0;St<D.wants.length;++St){var ht=De[q[St]];typeof ht=="object"&&ht.hasOwnProperty&&ht.hasOwnProperty("delete")&&ht.delete()}Nt&&(j.D=Nt)}))}}),j.i.attachMultiListener(ne,fe),ne.delete()}s.onResults=function(j,D){this.listeners[D||"$"]=j},Q("Solution",Jo),Q("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"});function sf(j){var D=this;j=j||{};var z={url:"face_detection_short.binarypb"},q={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Jo({locateFile:j.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:z,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(ne){var fe,ie,ke,De,qe,ct;return M(function(Nt){switch(Nt.g){case 1:fe=ne==="short"?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"],ie=c(fe),ke=ie.next();case 2:if(ke.done){Nt.g=4;break}return De=ke.value,qe="third_party/mediapipe/modules/face_detection/"+De,T(Nt,ei(D.g,De),5);case 5:ct=Nt.h,D.g.overrideFile(qe,ct),ke=ie.next(),Nt.g=2;break;case 4:return z.url=ne==="short"?"face_detection_short.binarypb":"face_detection_full.binarypb",q.graphOptionXref.calculatorName=ne==="short"?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",Nt.return(!0)}})}},minDetectionConfidence:q}})}s=sf.prototype,s.close=function(){return this.g.close(),Promise.resolve()},s.onResults=function(j){this.g.onResults(j)},s.initialize=function(){var j=this;return M(function(D){return T(D,j.g.initialize(),0)})},s.reset=function(){this.g.reset()},s.send=function(j){var D=this;return M(function(z){return T(z,D.g.send(j),0)})},s.setOptions=function(j){this.g.setOptions(j)},Q("FaceDetection",sf),Q("FACEDETECTION_LIPS",wc),Q("FACEDETECTION_LEFT_EYE",ho),Q("FACEDETECTION_LEFT_EYEBROW",po),Q("FACEDETECTION_RIGHT_EYE",rd),Q("FACEDETECTION_RIGHT_EYEBROW",Nc),Q("FACEDETECTION_FACE_OVAL",od),Q("FACEDETECTION_CONTOURS",ol),Q("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),Q("VERSION","0.4.1646425229")}).call(l1)),l1}var z8=P8();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B8=1e-7,V8=1e-4;class Lj{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Fy{refCount(e){return ma("refCount")}incRef(e){return ma("incRef")}timerAvailable(){return!0}time(e){return ma("time")}read(e){return ma("read")}readSync(e){return ma("readSync")}readToGPU(e,t){return ma("readToGPU")}numDataIds(){return ma("numDataIds")}disposeData(e,t){return ma("disposeData")}write(e,t,n){return ma("write")}move(e,t,n,a,o){return ma("move")}createTensorFromGPUData(e,t,n){return ma("createTensorFromGPUData")}memory(){return ma("memory")}floatPrecision(){return ma("floatPrecision")}epsilon(){return this.floatPrecision()===32?B8:V8}dispose(){return ma("dispose")}}function ma(s){throw new Error("'".concat(s,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(s){let e=s.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,ou(s,e,t)}function Pl(s,e,t){return Math.max(s,Math.min(e,t))}function Ly(s){return s%2===0?s:s+1}function ou(s,e,t){const n=s[e];s[e]=s[t],s[t]=n}function G8(s){let e=0;for(let t=0;t<s.length;t++)e+=s[t];return e}function V(s,e){if(!s)throw new Error(typeof e=="string"?e:e())}function ja(s,e,t=""){V(zt(s,e),()=>t+" Shapes ".concat(s," and ").concat(e," must match"))}function Au(s){V(s!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ae(s){if(s.length===0)return 1;let e=s[0];for(let t=1;t<s.length;t++)e*=s[t];return e}function W8(s,e){if(s===e)return!0;if(s==null||e==null||s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==null&&e[t]!==null&&s[t]!==e[t])return!1;return!0}function zt(s,e){if(s===e)return!0;if(s==null||e==null||s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function xu(s){return s%1===0}function O1(s){const e=Math.ceil(Math.sqrt(s));return[e,Math.ceil(s/e)]}function uu(s,e){return e<=s.length?s:s+" ".repeat(e-s.length)}function k4(s,e=a=>0,t,n){return new Promise((a,o)=>{let i=0;const c=()=>{if(s()){a();return}i++;const u=e(i);if(t!=null&&i>=t){o();return}n!=null?n(c,u):setTimeout(c,u)};c()})}function Mj(s,e){let t=1,n=-1;for(let o=0;o<s.length;++o)if(s[o]>=0)t*=s[o];else if(s[o]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(n," and dim ").concat(o));n=o}else if(s[o]<0)throw Error("Shapes can not be < 0. Found ".concat(s[o]," at dim ").concat(o));if(n===-1){if(e>0&&e!==t)throw Error("Size(".concat(e,") must match the product of shape ").concat(s));return s}if(t===0)throw Error("Cannot infer the missing size in [".concat(s,"] when ")+"there are 0 elements");if(e%t!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(t));const a=s.slice();return a[n]=e/t,a}function Rt(s,e){const t=e.length;return s=s==null?e.map((n,a)=>a):[].concat(s),V(s.every(n=>n>=-t&&n<t),()=>"All values in axis param must be in range [-".concat(t,", ").concat(t,") but ")+"got axis ".concat(s)),V(s.every(n=>xu(n)),()=>"All values in axis param must be integers but "+"got axis ".concat(s)),s.map(n=>n<0?t+n:n)}function Gi(s,e){const t=[],n=[],a=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||a?null:Rt(e,s).sort();let i=0;for(let c=0;c<s.length;++c){if(o!=null){if(o[i]===c&&s[c]!==1)throw new Error("Can't squeeze axis ".concat(c," since its dim '").concat(s[c],"' is not 1"));(o[i]==null||o[i]>c)&&s[c]===1&&(t.push(s[c]),n.push(c)),o[i]<=c&&i++}s[c]!==1&&(t.push(s[c]),n.push(c))}return{newShape:t,keptDims:n}}function Sn(s,e){return Os(s,e)}function Os(s,e){let t=null;if(s==null||s==="float32")t=new Float32Array(e);else if(s==="int32")t=new Int32Array(e);else if(s==="bool")t=new Uint8Array(e);else if(s==="string")t=new Array(e);else throw new Error("Unknown data type ".concat(s));return t}function H8(s,e){for(let t=0;t<s.length;t++){const n=s[t];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(n,"."))}}function q8(s){return s==="bool"||s==="complex64"||s==="float32"||s==="int32"||s==="string"}function Pj(s,e){return!(e==="complex64"||e==="float32"&&s!=="complex64"||e==="int32"&&s!=="float32"&&s!=="complex64"||e==="bool"&&s==="bool")}function Em(s){if(s==="float32"||s==="int32")return 4;if(s==="complex64")return 8;if(s==="bool")return 1;throw new Error("Unknown dtype ".concat(s))}function K8(s){if(s==null)return 0;let e=0;return s.forEach(t=>e+=t.length),e}function Ih(s){return typeof s=="string"||s instanceof String}function X8(s){return typeof s=="boolean"}function _1(s){return typeof s=="number"}function Eu(s){return Array.isArray(s)?Eu(s[0]):s instanceof Float32Array?"float32":s instanceof Int32Array||s instanceof Uint8Array||s instanceof Uint8ClampedArray?"int32":_1(s)?"float32":Ih(s)?"string":X8(s)?"bool":"float32"}function F1(s){return!!(s&&s.constructor&&s.call&&s.apply)}function L1(s,e){for(let t=e;t<s;++t)if(s%t===0)return t;return s}function ft(s){const e=s.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=s[e-1];for(let n=e-3;n>=0;--n)t[n]=t[n+1]*s[n+1];return t}function zj(s,e,t,n=!1){const a=new Array;if(e.length===1){const o=e[0]*(n?2:1);for(let i=0;i<o;i++)a[i]=t[s+i]}else{const o=e[0],i=e.slice(1),c=i.reduce((u,h)=>u*h)*(n?2:1);for(let u=0;u<o;u++)a[u]=zj(s+u*c,i,t,n)}return a}function lr(s,e,t=!1){if(s.length===0)return e[0];const n=s.reduce((a,o)=>a*o)*(t?2:1);if(n===0)return[];if(n!==e.length)throw new Error("[".concat(s,"] does not match the input size ").concat(e.length).concat(t?" for a complex tensor":"","."));return zj(0,s,e,t)}function Y8(s,e){if(Array.isArray(s))return s;if(e==="float32")return s instanceof Float32Array?s:new Float32Array(s);if(e==="int32")return s instanceof Int32Array?s:new Int32Array(s);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(s));throw new Error("Unknown dtype ".concat(e))}function My(s,e){const t=Rn(s,e);for(let n=0;n<t.length;n++)t[n]=1;return t}function Rn(s,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(s);if(e==="int32")return new Int32Array(s);if(e==="bool")return new Uint8Array(s);throw new Error("Unknown data type ".concat(e))}function Bj(s,e){const t=s.reduce((n,a)=>n*a,1);if(e==null||e==="float32")return lr(s,new Float32Array(t));if(e==="int32")return lr(s,new Int32Array(t));if(e==="bool")return lr(s,new Uint8Array(t));throw new Error("Unknown data type ".concat(e))}function Pa(s){s.forEach(e=>{V(Number.isInteger(e)&&e>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(s,"]."))})}function Zr(s,e,t){if(e===0)return 0;if(e===1)return s[0];let n=s[s.length-1];for(let a=0;a<s.length-1;++a)n+=t[a]*s[a];return n}function Du(s,e,t){if(e===0)return[];if(e===1)return[s];const n=new Array(e);for(let a=0;a<n.length-1;++a)n[a]=Math.floor(s/t[a]),s-=n[a]*t[a];return n[n.length-1]=s,n}function zl(s){return s&&s.then&&typeof s.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T4="tfjsflags";class Z8{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Q8,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){const a=this.urlFlags[e];Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(a,".")),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(zl(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);T4 in e&&e[T4].split(",").forEach(n=>{const[a,o]=n.split(":");this.urlFlags[a]=e7(a,o)})}}function Q8(s){const e={};return s.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(J8(e,n[0],n[1]),n.join("="))),e}function J8(s,e,t){s[decodeURIComponent(e)]=decodeURIComponent(t||"")}function e7(s,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":"".concat(+t)===t?+t:e}function Se(){return Vj}let Vj=null;function t7(s){Vj=s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let c1;function Uj(){if(c1==null){let s;if(typeof window<"u")s=window;else if(typeof global<"u")s=global;else if(typeof process<"u")s=process;else if(typeof self<"u")s=self;else throw new Error("Could not find a global object");c1=s}return c1}function s7(){const s=Uj();return s._tfGlobals==null&&(s._tfGlobals=new Map),s._tfGlobals}function Py(s,e){const t=s7();if(t.has(s))return t.get(s);{const n=e();return t.set(s,n),t.get(s)}}const ug="Abs",$h="Acos",Ah="Acosh",Ru="Add",dg="AddN",zy="All",By="Any",hg="ArgMax",pg="ArgMin",Eh="Asin",Dh="Asinh",Rh="Atan",Oh="Atanh",_h="Atan2",fg="AvgPool",Vy="AvgPoolGrad",mg="AvgPool3D",Uy="AvgPool3DGrad",gg="BatchMatMul",xg="BatchToSpaceND",Gy="Bincount",bg="BitwiseAnd",n7="BroadcastTo",Wy="BroadcastArgs",Fh="Cast",Lh="Ceil",Mh="ClipByValue",Hy="Complex",yg="ComplexAbs",vg="Concat",wg="Conv2D",qy="Conv2DBackpropFilter",Ng="Conv2DBackpropInput",Sg="Conv3D",Ky="Conv3DBackpropFilterV2",Xy="Conv3DBackpropInputV2",Ph="Cos",zh="Cosh",Yy="Cumprod",Cg="Cumsum",Zy="CropAndResize",Qy="DenseBincount",Jy="DepthToSpace",jg="DepthwiseConv2dNative",e2="DepthwiseConv2dNativeBackpropFilter",t2="DepthwiseConv2dNativeBackpropInput",s2="Diag",kg="Dilation2D",M1="Dilation2DBackpropInput",P1="Dilation2DBackpropFilter",a7="Draw",Bh="RealDiv",n2="Einsum",Vh="Elu",a2="EluGrad",Uh="Erf",Tg="Equal",Gh="Exp",Ig="ExpandDims",Wh="Expm1",r2="FFT",o2="Fill",i2="FlipLeftRight",Hh="Floor",qh="FloorDiv",$g="FusedBatchNorm",Ag="GatherV2",l2="GatherNd",Eg="Greater",Kh="GreaterEqual",Xh="Identity",c2="IFFT",u2="Imag",Yh="IsFinite",Zh="IsInf",Qh="IsNan",Dg="LeakyRelu",Rg="Less",Og="LessEqual",d2="LinSpace",Jh="Log",ep="Log1p",_g="LogicalAnd",Fg="LogicalNot",Lg="LogicalOr",r7="LogSoftmax",Mg="LRN",h2="LRNGrad",Pg="Max",tp="Maximum",zg="MaxPool",p2="MaxPoolGrad",Bg="MaxPool3D",f2="MaxPool3DGrad",m2="MaxPoolWithArgmax",Vg="Mean",Ug="Min",sp="Minimum",Gg="MirrorPad",np="Mod",g2="Multinomial",ap="Multiply",Wg="Neg",Hg="NotEqual",x2="NonMaxSuppressionV3",b2="NonMaxSuppressionV4",y2="NonMaxSuppressionV5",qg="OnesLike",Kg="OneHot",Xg="Pack",Yg="PadV2",rp="Pow",Zg="Prelu",Qg="Prod",v2="RaggedGather",w2="RaggedRange",N2="RaggedTensorToTensor",S2="Range",C2="Real",op="Reciprocal",ip="Relu",Jg="Reshape",ex="ResizeNearestNeighbor",j2="ResizeNearestNeighborGrad",tx="ResizeBilinear",k2="ResizeBilinearGrad",lp="Relu6",sx="Reverse",cp="Round",up="Rsqrt",T2="ScatterNd",I2="TensorScatterUpdate",$2="SearchSorted",nx="Select",dp="Selu",ax="Slice",hp="Sin",pp="Sinh",fp="Sign",mp="Sigmoid",gp="Softplus",xp="Sqrt",rx="Sum",ox="SpaceToBatchND",ix="SplitV",lx="Softmax",A2="SparseFillEmptyRows",E2="SparseReshape",D2="SparseSegmentMean",R2="SparseSegmentSum",O2="SparseToDense",bp="SquaredDifference",_2="Square",cx="StaticRegexReplace",F2="StridedSlice",L2="StringNGrams",M2="StringSplit",P2="StringToHashBucketFast",yp="Sub",vp="Tan",wp="Tanh",Np="Tile",z2="TopK",B2="Transform",du="Transpose",V2="Unique",ux="Unpack",dx="UnsortedSegmentSum",hx="ZerosLike",Sp="Step",z1="FromPixels",U2="RotateWithOffset",Dm="_FusedMatMul",Rm="FusedConv2D",Om="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(...s){Se().getBool("IS_TEST")||Se().getBool("PROD")||console.warn(...s)}function o7(...s){Se().getBool("IS_TEST")||Se().getBool("PROD")||console.log(...s)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _m=Py("kernelRegistry",()=>new Map),B1=Py("gradRegistry",()=>new Map);function V1(s,e){const t=Wj(s,e);return _m.get(t)}function I4(s){return B1.get(s)}function $4(s){const e=_m.entries(),t=[];for(;;){const{done:n,value:a}=e.next();if(n)break;const[o,i]=a,[c]=o.split("_");c===s&&t.push(i)}return t}function Gj(s){const{kernelName:e,backendName:t}=s,n=Wj(e,t);_m.has(n)&&Oa("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is already registered")),_m.set(n,s)}function i7(s){const{kernelName:e}=s;B1.has(e)&&Se().getBool("DEBUG")&&Oa("Overriding the gradient for '".concat(e,"'")),B1.set(e,s)}function Wj(s,e){return"".concat(e,"_").concat(s)}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hj(s){return s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array||s instanceof Uint8ClampedArray}var u1,A4;function l7(){if(A4)return u1;A4=1,u1=e;var s=null;try{s=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(M){}function e(M,A,U){this.low=M|0,this.high=A|0,this.unsigned=!!U}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(M){return(M&&M.__isLong__)===!0}e.isLong=t;var n={},a={};function o(M,A){var U,K,Q;return A?(M>>>=0,(Q=0<=M&&M<256)&&(K=a[M],K)?K:(U=c(M,(M|0)<0?-1:0,!0),Q&&(a[M]=U),U)):(M|=0,(Q=-128<=M&&M<128)&&(K=n[M],K)?K:(U=c(M,M<0?-1:0,!1),Q&&(n[M]=U),U))}e.fromInt=o;function i(M,A){if(isNaN(M))return A?C:N;if(A){if(M<0)return C;if(M>=y)return O}else{if(M<=-9223372036854776e3)return P;if(M+1>=w)return R}return M<0?i(-M,A).neg():c(M%b|0,M/b|0,A)}e.fromNumber=i;function c(M,A,U){return new e(M,A,U)}e.fromBits=c;var u=Math.pow;function h(M,A,U){if(M.length===0)throw Error("empty string");if(M==="NaN"||M==="Infinity"||M==="+Infinity"||M==="-Infinity")return N;if(typeof A=="number"?(U=A,A=!1):A=!!A,U=U||10,U<2||36<U)throw RangeError("radix");var K;if((K=M.indexOf("-"))>0)throw Error("interior hyphen");if(K===0)return h(M.substring(1),A,U).neg();for(var Q=i(u(U,8)),X=N,B=0;B<M.length;B+=8){var G=Math.min(8,M.length-B),Y=parseInt(M.substring(B,B+G),U);if(G<8){var Z=i(u(U,G));X=X.mul(Z).add(i(Y))}else X=X.mul(Q),X=X.add(i(Y))}return X.unsigned=A,X}e.fromString=h;function p(M,A){return typeof M=="number"?i(M,A):typeof M=="string"?h(M,A):c(M.low,M.high,typeof A=="boolean"?A:M.unsigned)}e.fromValue=p;var f=65536,g=1<<24,b=f*f,y=b*b,w=y/2,v=o(g),N=o(0);e.ZERO=N;var C=o(0,!0);e.UZERO=C;var T=o(1);e.ONE=T;var I=o(1,!0);e.UONE=I;var $=o(-1);e.NEG_ONE=$;var R=c(-1,2147483647,!1);e.MAX_VALUE=R;var O=c(-1,-1,!0);e.MAX_UNSIGNED_VALUE=O;var P=c(0,-2147483648,!1);e.MIN_VALUE=P;var _=e.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},_.toString=function(A){if(A=A||10,A<2||36<A)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(P)){var U=i(A),K=this.div(U),Q=K.mul(U).sub(this);return K.toString(A)+Q.toInt().toString(A)}else return"-"+this.neg().toString(A);for(var X=i(u(A,6),this.unsigned),B=this,G="";;){var Y=B.div(X),Z=B.sub(Y.mul(X)).toInt()>>>0,J=Z.toString(A);if(B=Y,B.isZero())return J+G;for(;J.length<6;)J="0"+J;G=""+J+G}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(P)?64:this.neg().getNumBitsAbs();for(var A=this.high!=0?this.high:this.low,U=31;U>0&&(A&1<<U)==0;U--);return this.high!=0?U+33:U+1},_.isZero=function(){return this.high===0&&this.low===0},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return(this.low&1)===1},_.isEven=function(){return(this.low&1)===0},_.equals=function(A){return t(A)||(A=p(A)),this.unsigned!==A.unsigned&&this.high>>>31===1&&A.high>>>31===1?!1:this.high===A.high&&this.low===A.low},_.eq=_.equals,_.notEquals=function(A){return!this.eq(A)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(A){return this.comp(A)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(A){return this.comp(A)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(A){return this.comp(A)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(A){return this.comp(A)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(A){if(t(A)||(A=p(A)),this.eq(A))return 0;var U=this.isNegative(),K=A.isNegative();return U&&!K?-1:!U&&K?1:this.unsigned?A.high>>>0>this.high>>>0||A.high===this.high&&A.low>>>0>this.low>>>0?-1:1:this.sub(A).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(P)?P:this.not().add(T)},_.neg=_.negate,_.add=function(A){t(A)||(A=p(A));var U=this.high>>>16,K=this.high&65535,Q=this.low>>>16,X=this.low&65535,B=A.high>>>16,G=A.high&65535,Y=A.low>>>16,Z=A.low&65535,J=0,xe=0,ye=0,ve=0;return ve+=X+Z,ye+=ve>>>16,ve&=65535,ye+=Q+Y,xe+=ye>>>16,ye&=65535,xe+=K+G,J+=xe>>>16,xe&=65535,J+=U+B,J&=65535,c(ye<<16|ve,J<<16|xe,this.unsigned)},_.subtract=function(A){return t(A)||(A=p(A)),this.add(A.neg())},_.sub=_.subtract,_.multiply=function(A){if(this.isZero())return N;if(t(A)||(A=p(A)),s){var U=s.mul(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}if(A.isZero())return N;if(this.eq(P))return A.isOdd()?P:N;if(A.eq(P))return this.isOdd()?P:N;if(this.isNegative())return A.isNegative()?this.neg().mul(A.neg()):this.neg().mul(A).neg();if(A.isNegative())return this.mul(A.neg()).neg();if(this.lt(v)&&A.lt(v))return i(this.toNumber()*A.toNumber(),this.unsigned);var K=this.high>>>16,Q=this.high&65535,X=this.low>>>16,B=this.low&65535,G=A.high>>>16,Y=A.high&65535,Z=A.low>>>16,J=A.low&65535,xe=0,ye=0,ve=0,Re=0;return Re+=B*J,ve+=Re>>>16,Re&=65535,ve+=X*J,ye+=ve>>>16,ve&=65535,ve+=B*Z,ye+=ve>>>16,ve&=65535,ye+=Q*J,xe+=ye>>>16,ye&=65535,ye+=X*Z,xe+=ye>>>16,ye&=65535,ye+=B*Y,xe+=ye>>>16,ye&=65535,xe+=K*J+Q*Z+X*Y+B*G,xe&=65535,c(ve<<16|Re,xe<<16|ye,this.unsigned)},_.mul=_.multiply,_.divide=function(A){if(t(A)||(A=p(A)),A.isZero())throw Error("division by zero");if(s){if(!this.unsigned&&this.high===-2147483648&&A.low===-1&&A.high===-1)return this;var U=(this.unsigned?s.div_u:s.div_s)(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:N;var K,Q,X;if(this.unsigned){if(A.unsigned||(A=A.toUnsigned()),A.gt(this))return C;if(A.gt(this.shru(1)))return I;X=C}else{if(this.eq(P)){if(A.eq(T)||A.eq($))return P;if(A.eq(P))return T;var B=this.shr(1);return K=B.div(A).shl(1),K.eq(N)?A.isNegative()?T:$:(Q=this.sub(A.mul(K)),X=K.add(Q.div(A)),X)}else if(A.eq(P))return this.unsigned?C:N;if(this.isNegative())return A.isNegative()?this.neg().div(A.neg()):this.neg().div(A).neg();if(A.isNegative())return this.div(A.neg()).neg();X=N}for(Q=this;Q.gte(A);){K=Math.max(1,Math.floor(Q.toNumber()/A.toNumber()));for(var G=Math.ceil(Math.log(K)/Math.LN2),Y=G<=48?1:u(2,G-48),Z=i(K),J=Z.mul(A);J.isNegative()||J.gt(Q);)K-=Y,Z=i(K,this.unsigned),J=Z.mul(A);Z.isZero()&&(Z=T),X=X.add(Z),Q=Q.sub(J)}return X},_.div=_.divide,_.modulo=function(A){if(t(A)||(A=p(A)),s){var U=(this.unsigned?s.rem_u:s.rem_s)(this.low,this.high,A.low,A.high);return c(U,s.get_high(),this.unsigned)}return this.sub(this.div(A).mul(A))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return c(~this.low,~this.high,this.unsigned)},_.and=function(A){return t(A)||(A=p(A)),c(this.low&A.low,this.high&A.high,this.unsigned)},_.or=function(A){return t(A)||(A=p(A)),c(this.low|A.low,this.high|A.high,this.unsigned)},_.xor=function(A){return t(A)||(A=p(A)),c(this.low^A.low,this.high^A.high,this.unsigned)},_.shiftLeft=function(A){return t(A)&&(A=A.toInt()),(A&=63)===0?this:A<32?c(this.low<<A,this.high<<A|this.low>>>32-A,this.unsigned):c(0,this.low<<A-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(A){return t(A)&&(A=A.toInt()),(A&=63)===0?this:A<32?c(this.low>>>A|this.high<<32-A,this.high>>A,this.unsigned):c(this.high>>A-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(A){if(t(A)&&(A=A.toInt()),A&=63,A===0)return this;var U=this.high;if(A<32){var K=this.low;return c(K>>>A|U<<32-A,U>>>A,this.unsigned)}else return A===32?c(U,0,this.unsigned):c(U>>>A-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},_.toBytes=function(A){return A?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var A=this.high,U=this.low;return[U&255,U>>>8&255,U>>>16&255,U>>>24,A&255,A>>>8&255,A>>>16&255,A>>>24]},_.toBytesBE=function(){var A=this.high,U=this.low;return[A>>>24,A>>>16&255,A>>>8&255,A&255,U>>>24,U>>>16&255,U>>>8&255,U&255]},e.fromBytes=function(A,U,K){return K?e.fromBytesLE(A,U):e.fromBytesBE(A,U)},e.fromBytesLE=function(A,U){return new e(A[0]|A[1]<<8|A[2]<<16|A[3]<<24,A[4]|A[5]<<8|A[6]<<16|A[7]<<24,U)},e.fromBytesBE=function(A,U){return new e(A[4]<<24|A[5]<<16|A[6]<<8|A[7],A[0]<<24|A[1]<<16|A[2]<<8|A[3],U)},u1}var qj=l7();const Kj=k6(qj),c7=F6({__proto__:null,default:Kj},[qj]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $l=Kj||c7;function px(s){return $l.fromString(s,!0,16)}const Xj=px("c3a5c85c97cb3127"),Il=px("b492b66fbe98f273"),Un=px("9ae16a3b2f90404f");function U1(s){return s.xor(s.shru(47))}function Yj(s,e,t){const n=s.slice(e,e+t);return $l.fromBytes(Array.from(n),!0,!0)}function ds(s,e){return Yj(s,e,8)}function E4(s,e){return Yj(s,e,4)}function hn(s,e){return e===0?s:s.shru(e).or(s.shl(64-e))}function $i(s,e,t=px("9ddfea08eb382d69")){let n=s.xor(e).mul(t);n=n.xor(n.shru(47));let a=e.xor(n).mul(t);return a=a.xor(a.shru(47)),a=a.mul(t),a}function u7(s,e,t,n,a,o){a=a.add(s),o=hn(o.add(a).add(n),21);const i=a;return a=a.add(e),a=a.add(t),o=o.add(hn(a,44)),[a.add(n),o.add(i)]}function rm(s,e,t,n){return u7(ds(s,e),ds(s,e+8),ds(s,e+16),ds(s,e+24),t,n)}function d7(s,e=s.length){if(e>=8){const t=Un.add(e*2),n=ds(s,0).add(Un),a=ds(s,e-8),o=hn(a,37).mul(t).add(n),i=hn(n,25).add(a).mul(t);return $i(o,i,t)}if(e>=4){const t=Un.add(e*2),n=E4(s,0);return $i(n.shl(3).add(e),E4(s,e-4),t)}if(e>0){const t=s[0],n=s[e>>1],a=s[e-1],o=t+(n<<8),i=e+(a<<2);return U1(Un.mul(o).xor(Xj.mul(i))).mul(Un)}return Un}function h7(s,e=s.length){const t=Un.add(e*2),n=ds(s,0).mul(Il),a=ds(s,8),o=ds(s,e-8).mul(t),i=ds(s,e-16).mul(Un);return $i(hn(n.add(a),43).add(hn(o,30)).add(i),n.add(hn(a.add(Un),18)).add(o),t)}function p7(s,e=s.length){const t=Un.add(e*2),n=ds(s,0).mul(Un),a=ds(s,8),o=ds(s,e-8).mul(t),i=ds(s,e-16).mul(Un),c=hn(n.add(a),43).add(hn(o,30)).add(i),u=$i(c,n.add(hn(a.add(Un),18)).add(o),t),h=ds(s,16).mul(t),p=ds(s,24),f=c.add(ds(s,e-32)).mul(t),g=u.add(ds(s,e-24)).mul(t);return $i(hn(h.add(p),43).add(hn(f,30)).add(g),h.add(hn(p.add(n),18)).add(f),t)}function f7(s,e=s.length){const t=$l.fromNumber(81,!0);if(e<=32)return e<=16?d7(s,e):h7(s,e);if(e<=64)return p7(s,e);let n=t,a=t.mul(Il).add(113),o=U1(a.mul(Un).add(113)).mul(Un),i=[$l.UZERO,$l.UZERO],c=[$l.UZERO,$l.UZERO];n=n.mul(Un).add(ds(s,0));let u=0;const h=(e-1>>6)*64,p=h+(e-1&63)-63;do n=hn(n.add(a).add(i[0]).add(ds(s,u+8)),37).mul(Il),a=hn(a.add(i[1]).add(ds(s,u+48)),42).mul(Il),n=n.xor(c[1]),a=a.add(i[0]).add(ds(s,u+40)),o=hn(o.add(c[0]),33).mul(Il),i=rm(s,u,i[1].mul(Il),n.add(c[0])),c=rm(s,u+32,o.add(c[1]),a.add(ds(s,u+16))),[o,n]=[n,o],u+=64;while(u!==h);const f=Il.add(o.and(255).shl(1));return u=p,c[0]=c[0].add(e-1&63),i[0]=i[0].add(c[0]),c[0]=c[0].add(i[0]),n=hn(n.add(a).add(i[0]).add(ds(s,u+8)),37).mul(f),a=hn(a.add(i[1]).add(ds(s,u+48)),42).mul(f),n=n.xor(c[1].mul(9)),a=a.add(i[0].mul(9).add(ds(s,u+40))),o=hn(o.add(c[0]),33).mul(f),i=rm(s,u,i[1].mul(f),n.add(c[0])),c=rm(s,u+32,o.add(c[1]),a.add(ds(s,u+16))),[o,n]=[n,o],$i($i(i[0],c[0],f).add(U1(a).mul(Xj)).add(o),$i(i[1],c[1],f).add(n),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wi(s,e){return e==="string"?Ai(s):ec([s],e)}function m7(s,e){return s instanceof Float32Array&&e==="float32"||s instanceof Int32Array&&e==="int32"||s instanceof Uint8Array&&e==="bool"}function ec(s,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(s)&&(s=Bl(s)),Se().getBool("DEBUG")&&H8(s,e),m7(s,e))return s;if(e==null||e==="float32"||e==="complex64")return new Float32Array(s);if(e==="int32")return new Int32Array(s);if(e==="bool"){const t=new Uint8Array(s.length);for(let n=0;n<t.length;++n)Math.round(s[n])!==0&&(t[n]=1);return t}else throw new Error("Unknown data type ".concat(e))}function sa(){return Se().platform.now()}function Ai(s,e="utf-8"){return e=e||"utf-8",Se().platform.encode(s,e)}function Ri(s,e="utf-8"){return e=e||"utf-8",Se().platform.decode(s,e)}function ur(s){return Se().platform.isTypedArray!=null?Se().platform.isTypedArray(s):Hj(s)}function Bl(s,e=[],t=!1){if(e==null&&(e=[]),typeof s=="boolean"||typeof s=="number"||typeof s=="string"||zl(s)||s==null||ur(s)&&t)e.push(s);else if(Array.isArray(s)||ur(s))for(let n=0;n<s.length;++n)Bl(s[n],e,t);else{let n=-1;for(const a of Object.keys(s))/^([1-9]+[0-9]*|0)$/.test(a)&&(n=Math.max(n,Number(a)));for(let a=0;a<=n;a++)Bl(s[a],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g7{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new b7)}profileKernel(e,t,n){let a;const o=()=>{a=n()};let i;const c=sa();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const h of a)h.dataSync();i=Promise.resolve({kernelMs:sa()-c})}if(Se().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let h=0;h<a.length;h++){const p=a[h];p.data().then(f=>{x7(f,p.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:i.then(h=>h.kernelMs),extraInfo:i.then(h=>h.getExtraProfileInfo!=null?h.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:a,inputs:o,extraInfo:i}=e;n.forEach(c=>{Promise.all([c.data(),a,i]).then(u=>{this.logger.logKernelProfile(t,c,u[0],u[1],o,u[2])})})}}function x7(s,e,t){if(e!=="float32")return!1;for(let n=0;n<s.length;n++){const a=s[n];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(t,"'")),!0}return!1}class b7{logKernelProfile(e,t,n,a,o,i){const c=typeof a=="number"?uu("".concat(a,"ms"),9):a.error,u=uu(e,25),h=t.rank,p=t.size,f=uu(t.shape.toString(),14);let g="";for(const b in o){const y=o[b];if(y!=null){const w=y.shape||t.shape,v=w.length;g+="".concat(b,": ").concat(v,"D ").concat(v>0?w:""," ")}}console.log("%c".concat(u,"	%c").concat(c,"	%c").concat(h,"D ").concat(f,"	%c").concat(p,"	%c").concat(g,"	%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(s,e,t){const n={},a={};for(let u=0;u<e.length;u++)n[e[u].id]=!0;for(let u=0;u<s.length;u++){const h=s[u],p=h.inputs;for(const f in p){const g=p[f];let b=!1;for(let y=0;y<e.length;y++)if(n[g.id]){h.outputs.forEach(w=>n[w.id]=!0),b=!0,a[h.id]=!0;break}if(b)break}}const o={};o[t.id]=!0;const i={};for(let u=s.length-1;u>=0;u--){const h=s[u],p=h.inputs;for(let f=0;f<h.outputs.length;f++)if(o[h.outputs[f].id]){for(const g in p)o[p[g].id]=!0,i[h.id]=!0;break}}const c=[];for(let u=0;u<s.length;u++){const h=s[u];if(a[h.id]&&i[h.id]){const p={};for(const g in h.inputs){const b=h.inputs[g];n[b.id]&&(p[g]=b)}const f=Object.assign({},h);f.inputs=p,f.outputs=h.outputs,c.push(f)}}return c}function v7(s,e,t,n){for(let a=e.length-1;a>=0;a--){const o=e[a],i=[];if(o.outputs.forEach(u=>{const h=s[u.id];h!=null?i.push(h):i.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));const c=o.gradient(i);for(const u in o.inputs){if(!(u in c))throw new Error("Cannot backprop through input ".concat(u,". ")+"Available gradients found: ".concat(Object.keys(c),"."));const h=t(()=>c[u]());if(h.dtype!=="float32")throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(u," must have 'float32' dtype, but has '").concat(h.dtype,"'"));const p=o.inputs[u];if(!zt(h.shape,p.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(u,"' has shape '").concat(h.shape,"', which does not match ")+"the shape of the input '".concat(p.shape,"'"));if(s[p.id]==null)s[p.id]=h;else{const f=s[p.id];s[p.id]=n(f,h),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4=20,th=3,d1=7;function w7(s,e,t,n){const a=ft(e),o=N7(s,e,t,a),i=e.length,c=vm(s,e,t,a,o),u=["Tensor"];return n&&(u.push("  dtype: ".concat(t)),u.push("  rank: ".concat(i)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(c.map(h=>"    "+h).join("\n")),u.join("\n")}function N7(s,e,t,n){const a=Ae(e),o=n[n.length-1],i=new Array(o).fill(0),c=e.length,u=t==="complex64"?oh(s):s;if(c>1)for(let h=0;h<a/o;h++){const p=h*o;for(let f=0;f<o;f++)i[f]=Math.max(i[f],rh(u[p+f],0,t).length)}return i}function rh(s,e,t){let n;return Array.isArray(s)?n="".concat(parseFloat(s[0].toFixed(d1))," + ")+"".concat(parseFloat(s[1].toFixed(d1)),"j"):Ih(s)?n="'".concat(s,"'"):t==="bool"?n=Zj(s):n=parseFloat(s.toFixed(d1)).toString(),uu(n,e)}function Zj(s){return s===0?"false":"true"}function vm(s,e,t,n,a,o=!0){const i=t==="complex64"?2:1,c=e[0],u=e.length;if(u===0){if(t==="complex64"){const w=oh(s);return[rh(w[0],0,t)]}return t==="bool"?[Zj(s[0])]:[s[0].toString()]}if(u===1){if(c>D4){const v=th*i;let N=Array.from(s.slice(0,v)),C=Array.from(s.slice((c-th)*i,c*i));return t==="complex64"&&(N=oh(N),C=oh(C)),["["+N.map((T,I)=>rh(T,a[I],t)).join(", ")+", ..., "+C.map((T,I)=>rh(T,a[c-th+I],t)).join(", ")+"]"]}return["["+(t==="complex64"?oh(s):Array.from(s)).map((v,N)=>rh(v,a[N],t)).join(", ")+"]"]}const h=e.slice(1),p=n.slice(1),f=n[0]*i,g=[];if(c>D4){for(let w=0;w<th;w++){const v=w*f,N=v+f;g.push(...vm(s.slice(v,N),h,t,p,a,!1))}g.push("...");for(let w=c-th;w<c;w++){const v=w*f,N=v+f;g.push(...vm(s.slice(v,N),h,t,p,a,w===c-1))}}else for(let w=0;w<c;w++){const v=w*f,N=v+f;g.push(...vm(s.slice(v,N),h,t,p,a,w===c-1))}const b=u===2?",":"";g[0]="["+(c>0?g[0]+b:"");for(let w=1;w<g.length-1;w++)g[w]=" "+g[w]+b;let y=",\n";for(let w=2;w<u;w++)y+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(o?"":y),g}function oh(s){const e=[];for(let t=0;t<s.length;t+=2)e.push([s[t],s[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Js{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Ae(e),n!=null){const a=n.length;V(a===this.size,()=>"Length of values '".concat(a,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Os(t,this.size),this.strides=ft(e)}set(e,...t){t.length===0&&(t=[0]),V(t.length===this.rank,()=>"The number of provided coordinates (".concat(t.length,") must ")+"match the rank (".concat(this.rank,")"));const n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const a of e){if(a<0||a>=this.shape[t]){const o="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(o)}t++}let n=e[e.length-1];for(let a=0;a<e.length-1;++a)n+=this.strides[a]*e[a];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Nr().makeTensor(this.values,this.shape,this.dtype)}}let Nr=null,iu=null;function S7(s){Nr=s}function C7(s){iu=s}class os{constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ae(e),this.strides=ft(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return iu.buffer(this.shape,this.dtype,e)}bufferSync(){return iu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return lr(this.shape,e,this.dtype==="complex64")}arraySync(){return lr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Nr().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(n=>Ri(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Nr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Nr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Ri(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Nr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Nr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return iu.print(this,e)}clone(){return this.throwIfDisposed(),iu.clone(this)}toString(e=!1){const t=this.dataSync();return w7(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),iu.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),Nr().makeVariable(this,e,t,n)}}Object.defineProperty(os,Symbol.hasInstance,{value:s=>!!s&&s.data!=null&&s.dataSync!=null&&s.throwIfDisposed!=null});function Ee(){return Py("Tensor",()=>os)}Ee();class Fm extends os{constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!zt(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));Nr().disposeTensor(this),this.dataId=e.dataId,Nr().incRef(this,null)}dispose(){Nr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Fm,Symbol.hasInstance,{value:s=>s instanceof os&&s.assign!=null&&s.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var R4;(function(s){s.R0="R0",s.R1="R1",s.R2="R2",s.R3="R3",s.R4="R4",s.R5="R5",s.R6="R6"})(R4||(R4={}));var G1;(function(s){s.float32="float32",s.int32="int32",s.bool="int32",s.complex64="complex64"})(G1||(G1={}));var W1;(function(s){s.float32="float32",s.int32="int32",s.bool="bool",s.complex64="complex64"})(W1||(W1={}));var H1;(function(s){s.float32="float32",s.int32="float32",s.bool="float32",s.complex64="complex64"})(H1||(H1={}));var q1;(function(s){s.float32="complex64",s.int32="complex64",s.bool="complex64",s.complex64="complex64"})(q1||(q1={}));const j7={float32:H1,int32:G1,bool:W1,complex64:q1};function wa(s,e){if(s==="string"||e==="string"){if(s==="string"&&e==="string")return"string";throw new Error("Can not upcast ".concat(s," with ").concat(e))}return j7[s][e]}function G2(s){return wa(s,"int32")}function Qj(s){return s!=null&&typeof s=="object"&&"texture"in s&&s.texture instanceof WebGLTexture}function Jj(s){return typeof GPUBuffer<"u"&&s!=null&&typeof s=="object"&&"buffer"in s&&s.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(s,e){if(s.dtype===e.dtype)return[s,e];const t=wa(s.dtype,e.dtype);return[s.cast(t),e.cast(t)]}function k7(s,e){V(s.dtype===e.dtype,()=>"The dtypes of the first(".concat(s.dtype,") and")+" second(".concat(e.dtype,") input must match"))}function ek(s){const e=[];return tk(s,e,new Set),e}function tk(s,e,t){if(s==null)return;if(s instanceof os){e.push(s);return}if(!T7(s))return;const n=s;for(const a in n){const o=n[a];t.has(o)||(t.add(o),tk(o,e,t))}}function T7(s){return Array.isArray(s)||typeof s=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1(s){return s.kernelName!=null}class O4{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class bu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new O4}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(Oa("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new g7(this.backendInstance),!0}setupRegisteredKernels(){$4(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){$4(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(n&&!(n instanceof Fy)&&typeof n.then=="function"){const a=++this.pendingBackendInitId,o=n.then(i=>a<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,Oa("Initialization of backend ".concat(e," failed")),Oa(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return Oa("Initialization of backend ".concat(e," failed")),Oa(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:a,asyncInit:o}=this.initializeBackend(n);if(o||a)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),a=n.backend,o=this.readSync(t),i=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,o,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let a;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(a),()=>(a=t(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,t,n){e();try{const a=n();return t(),a}catch(a){throw t(),a}}nextTensorId(){return bu.nextTensorId++}nextVariableId(){return bu.nextVariableId++}clone(e){const t=re.runKernel(Xh,{x:e}),n={x:e},a=i=>({x:()=>{const c="float32",u={x:i},h={dtype:c};return re.runKernel(Fh,u,h)}}),o=[];return this.addTapeNode(this.state.activeScope.name,n,[t],a,o,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,!(V1(e,this.backendName)!=null))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const a=this.backend.numDataIds();let o=0;n.forEach(u=>{o+=u.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],c=a-t-o-i;if(c>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(c," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const a=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let c;this.backendName==null&&this.backend;let u;const h=h1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(h1(e)){const{kernelName:y,inputs:w,attrs:v}=e;this.backendName==null&&this.backend;const N=V1(y,this.backendName);V(N!=null,()=>"Cannot find registered kernel '".concat(y,"' for backend '").concat(this.backendName,"'")),c=()=>{const C=this.backend.numDataIds();u=N.kernelFunc({inputs:w,attrs:v,backend:this.backend});const T=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,C,T);const I=T.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(a){const $=this.getTensorsForGradient(y,w,I);n=this.saveTensorsForBackwardMode($)}return I}}else{const{forwardFunc:y}=e,w=v=>{a&&(n=v.map(N=>this.keep(this.clone(N))))};c=()=>{const v=this.backend.numDataIds();u=this.tidy(()=>y(this.backend,w));const N=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,v,N),N}}const{inputs:p,attrs:f}=e,g=h1(e)?null:e.backwardsFunc;let b;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=c():(b=this.profiler.profileKernel(h,p,()=>c()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(b),t=b.outputs)}),a&&this.addTapeNode(h,p,t,g,n,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:h,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map(y=>p[y]!=null?p[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:b.timeMs,extraInfo:b.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,t,n){const a=I4(e);if(a!=null){const o=a.inputsToSave||[],i=a.outputsToSave||[];let c;a.saveAllInputs?(V(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),c=Object.keys(t).map(h=>t[h])):c=o.map(h=>t[h]);const u=n.filter((h,p)=>i[p]);return c.concat(u)}return[]}makeTensor(e,t,n,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let o=e;n==="string"&&Ih(e[0])&&(o=e.map(u=>Ai(u)));const i=a.write(o,t,n),c=new os(t,n,i,this.nextTensorId());if(this.trackTensor(c,a),n==="string"){const u=this.state.tensorInfo.get(i),h=K8(o);this.state.numBytes+=h-u.bytes,u.bytes=h}return c}makeTensorFromDataId(e,t,n,a){n=n||"float32";const o={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(o,a)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:a,dtype:o}=e,i=new os(a,o,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,a){n=n||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const o=new Fm(e,t,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name ".concat(o.name," was already registered"));return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*Em(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Fm||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const n=e.size*Em(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,a,o,i){const c={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},u=I4(e);u!=null&&(a=u.gradFunc),a!=null&&(c.gradient=h=>(h=h.map((p,f)=>{if(p==null){const g=n[f],b=Rn(g.size,g.dtype);return this.makeTensor(b,g.shape,g.dtype)}return p}),a(h.length>1?h:h[0],o,i))),this.state.activeTape.push(c)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=ek(e),n=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!n.has(i.id)&&i.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===a.id&&this.track(o)})}gradients(e,t,n,a=!1){if(V(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));V(o instanceof os,()=>"The result y returned by f() must be a tensor.");const i=y7(this.state.activeTape,t,o);if(!a&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const c={};c[o.id]=n==null?I7(o.shape):n,v7(c,i,h=>this.tidy(h),$7);const u=t.map(h=>c[h.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(h=>{for(const p of h.saved)p.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(e){return V(F1(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{V(t.every(c=>c instanceof os),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n;const a={};t.forEach((c,u)=>{a[u]=c});const o=(c,u)=>(n=e(...t,u),V(n.value instanceof os,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),V(F1(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(c,u)=>{const h=n.gradFunc(c,u),p=Array.isArray(h)?h:[h];V(p.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),V(p.every(g=>g instanceof os),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return p.forEach((g,b)=>{f[b]=()=>g}),f};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=sa(),n=await this.backend.time(e);return n.wallMs=sa()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new O4;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}bu.nextTensorId=0;bu.nextVariableId=0;function I7(s){const e=My(Ae(s),"float32");return re.makeTensor(e,s,"float32")}function sk(){const s=Uj();if(s._tfengine==null){const e=new Z8(s);s._tfengine=new bu(e)}return t7(s._tfengine.ENV),S7(()=>s._tfengine),s._tfengine}const re=sk();function $7(s,e){const t={a:s,b:e};return re.runKernel(Ru,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(){return typeof navigator<"u"&&navigator!=null}function nk(s){if(s||A7()){if(s||(s=navigator),s.product==="ReactNative")return!0;const e=s.userAgent||s.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=s;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function ak(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ra=Se();ra.registerFlag("DEBUG",()=>!1,s=>{s&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ra.registerFlag("IS_BROWSER",()=>ak());ra.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ra.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ra.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ra.registerFlag("PROD",()=>!1);ra.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ra.getBool("DEBUG"));ra.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ra.registerFlag("IS_TEST",()=>!1);ra.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ra.getBool("DEBUG"));ra.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ra.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ra.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(s,e){let t=s;if(ur(s))return e==="string"?[]:[s.length];if(Qj(s)){const a=s.channels||"RGBA";return[s.height,s.width*a.length]}else if(Jj(s))return[s.buffer.size/(e==null?4:Em(e))];if(!Array.isArray(s))return[];const n=[];for(;Array.isArray(t)||ur(t)&&e!=="string";)n.push(t.length),t=t[0];return Array.isArray(s)&&Se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&rk(s,n,[]),n}function rk(s,e,t){if(t=t||[],!Array.isArray(s)&&!ur(s)){V(e.length===0,()=>"Element arr[".concat(t.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements"));return}V(e.length>0,()=>"Element arr[".concat(t.join("]["),"] should be a primitive, ")+"but is an array of ".concat(s.length," elements")),V(s.length===e[0],()=>"Element arr[".concat(t.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(s.length," elements"));const n=e.slice(1);for(let a=0;a<s.length;++a)rk(s[a],n,t.concat(a))}function _4(s,e,t,n){if(s!=="string_or_numeric"){if(s==null)throw new Error("Expected dtype cannot be null.");if(s!=="numeric"&&s!==e||s==="numeric"&&e==="string")throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must ")+"be ".concat(s," tensor, but got ").concat(e," tensor"))}}function H(s,e,t,n="numeric"){if(s instanceof Ee())return _4(n,s.dtype,e,t),s;let a=Eu(s);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),_4(n,a,e,t),s==null||!ur(s)&&!Array.isArray(s)&&typeof s!="number"&&typeof s!="boolean"&&typeof s!="string"){const u=s==null?"null":s.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(t,"' must be a ")+"Tensor or TensorLike, but got '".concat(u,"'"))}const o=Hi(s,a);!ur(s)&&!Array.isArray(s)&&(s=[s]);const c=a!=="string"?ec(s,a):Bl(s,[],!0);return re.makeTensor(c,o,a)}function Lm(s,e,t,n="numeric"){if(!Array.isArray(s))throw new Error("Argument ".concat(e," passed to ").concat(t," must be a ")+"`Tensor[]` or `TensorLike[]`");return s.map((o,i)=>H(o,"".concat(e,"[").concat(i,"]"),t,n))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ok="__op";function se(s){const e=Object.keys(s);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let t=e[0];const n=s[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+ok;const a=(...o)=>{re.startScope(t);try{const i=n(...o);return zl(i)&&console.error("Cannot return a Promise inside of tidy."),re.endScope(i),i}catch(i){throw re.endScope(null),i}};return Object.defineProperty(a,"name",{value:t,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(s,e){const t=H(s,"real","complex"),n=H(e,"imag","complex");ja(t.shape,n.shape,"real and imag shapes, ".concat(t.shape," and ").concat(n.shape,", ")+"must match in call to tf.complex().");const a={real:t,imag:n};return re.runKernel(Hy,a)}const Oi=se({complex_:E7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qi(s,e,t,n){if(n==null)n=Eu(s);else if(n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Jj(s)||Qj(s)){if(n!=="float32"&&n!=="int32")throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(n,"."));return re.backend.createTensorFromGPUData(s,e||t,n)}if(!ur(s)&&!Array.isArray(s)&&typeof s!="number"&&typeof s!="boolean"&&typeof s!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Pa(e);const a=Ae(e),o=Ae(t);V(a===o,()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(a," values but has ").concat(o));for(let i=0;i<t.length;++i){const c=t[i],u=i===t.length-1?c!==Ae(e.slice(i)):!0;V(t[i]===e[i]||!u,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(t,") does not match the provided ")+"shape (".concat(e,"). "))}}return!ur(s)&&!Array.isArray(s)&&(s=[s]),e=e||t,s=n!=="string"?ec(s,n):Bl(s,[],!0),re.makeTensor(s,e,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jr(s,e,t){const n=Hi(s,t);return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Dr{static join(e){return new Dr(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(n=>ur(n)?n.buffer:n),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=t+a.byteLength;this.shards.push({buffer:a,start:t,end:o}),t=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(n===-1)throw new Error("Could not find start shard for byte ".concat(e));const a=t-e,o=new ArrayBuffer(a),i=new Uint8Array(o);let c=0;for(let u=n;u<this.shards.length;u++){const h=this.shards[u],f=e+c-h.start,g=c,y=Math.min(t,h.end)-h.start,w=new Uint8Array(h.buffer,f,y-f);if(i.set(w,g),c+=w.length,t<h.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(a){return e<a.start?-1:e>=a.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const n=D7(this.shards,t);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function D7(s,e){let t=0,n=s.length;for(;t<=n;){const a=Math.floor((n-t)/2)+t,o=e(s[a]);if(o===0)return a;o<0?n=a:t=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(){return re}function F4(){return re.memory()}function me(s,e){return re.tidy(s,e)}function kt(s){ek(s).forEach(t=>t.dispose())}function pn(s){return re.keep(s)}function R7(s){return re.setBackend(s)}function O7(){return re.ready()}function _7(){return re.backendName}function ik(s,e,t=1){return re.registerBackend(s,e,t)}function lk(){return re.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _i=4;async function K1(s,e){const t=[],n=[],a=Array.isArray(s)?s.map(i=>i.name):Object.keys(s);for(let i=0;i<a.length;++i){const c=a[i],u=Array.isArray(s)?s[i].tensor:s[c];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(u.dtype));const h={name:c,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const p=new Promise(async f=>{const g=await u.bytes(),b=g.reduce((v,N)=>v+N.length,0)+_i*g.length,y=new Uint8Array(b);let w=0;for(let v=0;v<g.length;v++){const N=g[v],C=new Uint8Array(new Uint32Array([N.length]).buffer);y.set(C,w),w+=_i,y.set(N,w),w+=N.length}f(y)});n.push(p)}else n.push(u.data());e!=null&&(h.group=e),t.push(h)}const o=await Promise.all(n);return{data:M7(o),specs:t}}function ck(s,e){const t=new Dr(s),n={};let a=0;for(const o of e){const i=F7(o,(c,u)=>t.slice(a+c,a+u));n[o.name]=uk(o,t.slice(a,a+i)),a+=i}return n}function F7(s,e){const t=Ae(s.shape);let n;if("quantization"in s){const a=s.quantization;n=Vl[a.dtype]}else if(s.dtype==="string"){let a=0;for(let o=0;o<t;o++)a+=_i+new Uint32Array(e(a,a+_i))[0];return a}else n=Vl[s.dtype];return t*n}async function L7(s,e){const t=Ae(s.shape);let n;if("quantization"in s){const a=s.quantization;n=Vl[a.dtype]}else if(s.dtype==="string"){let a=0;for(let o=0;o<t;o++)a+=_i+new Uint32Array(await e(a,a+_i))[0];return a}else n=Vl[s.dtype];return t*n}function uk(s,e){const t=s.name,n=s.dtype,a=s.shape,o=Ae(a);let i,c=0;if("quantization"in s){const u=s.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error("Weight ".concat(s.name," with quantization ").concat(u.dtype," ")+"doesn't have corresponding metadata min and scale.")}else if(u.dtype==="float16"){if(n!=="float32")throw new Error("Weight ".concat(s.name," is quantized with ").concat(u.dtype," ")+"which only supports weights of type float32 not ".concat(n,"."))}else throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(u.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");const h=Vl[u.dtype],p=u.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(n==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){i=new Float32Array(p.length);for(let f=0;f<p.length;f++){const g=p[f];i[f]=g*u.scale+u.min}}else if(u.dtype==="float16")i=G7()(p);else throw new Error("Unsupported quantization type ".concat(u.dtype," ")+"for weight type float32.");else if(n==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error("Unsupported quantization type ".concat(u.dtype," ")+"for weight type int32.");i=new Int32Array(p.length);for(let f=0;f<p.length;f++){const g=p[f];i[f]=Math.round(g*u.scale+u.min)}}else throw new Error("Unsupported dtype in weight '".concat(t,"': ").concat(n));c+=o*h}else if(n==="string"){const u=Ae(s.shape);i=[];for(let h=0;h<u;h++){const p=new Uint32Array(e.slice(c,c+_i))[0];c+=_i;const f=new Uint8Array(e.slice(c,c+p));i.push(f),c+=p}}else{const u=Vl[n];if(n==="float32")i=new Float32Array(e);else if(n==="int32")i=new Int32Array(e);else if(n==="bool")i=new Uint8Array(e);else if(n==="complex64"){i=new Float32Array(e);const h=new Float32Array(i.length/2),p=new Float32Array(i.length/2);for(let y=0;y<h.length;y++)h[y]=i[y*2],p[y]=i[y*2+1];const f=jr(h,a,"float32"),g=jr(p,a,"float32"),b=Oi(f,g);return f.dispose(),g.dispose(),b}else throw new Error("Unsupported dtype in weight '".concat(t,"': ").concat(n));c+=o*u}return jr(i,a,n)}async function L4(s,e,t){let n=new Uint8Array(e);for(;n.byteLength<t;){const{done:a,value:o}=await s.read();if(a&&o==null){const c=t-n.byteLength;throw new Error("Reader is done but ".concat(c," bytes are still expected"))}const i=new Uint8Array(n.length+o.byteLength);i.set(n,0),i.set(new Uint8Array(o),n.length),n=i}return n.buffer}async function dk(s,e){const t={},n=s.getReader();let a=new ArrayBuffer(0);for(const o of e){const i=await L7(o,async(h,p)=>(a=await L4(n,a,p),a.slice(h,p)));a=await L4(n,a,i);const c=a.slice(0,i);a=a.slice(i);const u=uk(o,c);if(t[o.name]=u,_7()==="webgpu"){const h=lk();"uploadToGPU"in h&&Ae(u.shape)>=Se().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&h.uploadToGPU(u.dataId)}}return t}function M7(s){if(s===null)throw new Error("Invalid input value: ".concat(JSON.stringify(s)));let e=0;const t=[];s.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(o.constructor.name))});const n=new Uint8Array(e);let a=0;return t.forEach(o=>{n.set(new Uint8Array(o.buffer),a),a+=o.byteLength}),n.buffer}const W2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function M4(s){return W2?Buffer.byteLength(s,"utf8"):new Blob([s]).size}function P7(s){if(W2)return Buffer.from(s).toString("base64");const e=new Uint8Array(s);let t="";for(let n=0,a=e.length;n<a;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function z7(s){if(W2){const n=Buffer.from(s,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const e=atob(s),t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t.set([e.charCodeAt(n)],n);return t.buffer}function hk(s){return Dr.join(s)}function P4(s){const e="/";for(s=s.trim();s.endsWith(e);)s=s.slice(0,s.length-1);const t=s.split(e);return t[t.length-1]}function pk(s,e){const t={modelTopology:s.modelTopology,format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy,weightsManifest:e};return s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(t.initializerSignature=s.initializerSignature),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig),t}function fk(s,e,t){const n={modelTopology:s.modelTopology,format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy};if(s.trainingConfig!=null&&(n.trainingConfig=s.trainingConfig),s.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");n.weightSpecs=e,n.weightData=t}return s.signature!=null&&(n.signature=s.signature),s.userDefinedMetadata!=null&&(n.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(n.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(n.initializerSignature=s.initializerSignature),n}async function H2(s,e){let t,n;return s.weightsManifest!=null&&([t,n]=await e(s.weightsManifest)),fk(s,t,n)}function Cp(s){if(s.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:s.modelTopology==null?0:M4(JSON.stringify(s.modelTopology)),weightSpecsBytes:s.weightSpecs==null?0:M4(JSON.stringify(s.weightSpecs)),weightDataBytes:s.weightData==null?0:new Dr(s.weightData).byteLength}}function X1(s){const e=[];for(const t of s)e.push(...t.weights);return e}function B7(){const s=t=>{let n=t<<13,a=0;for(;(n&8388608)===0;)a-=8388608,n<<=1;return n&=-8388609,a+=947912704,n|a},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=s(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function V7(){const s=new Uint32Array(64);s[0]=0,s[31]=1199570944,s[32]=2147483648,s[63]=3347054592;for(let e=1;e<31;e++)s[e]=e<<23;for(let e=33;e<63;e++)s[e]=2147483648+(e-32<<23);return s}function U7(){const s=new Uint32Array(64);for(let e=0;e<64;e++)s[e]=1024;return s[0]=s[32]=0,s}function G7(){const s=B7(),e=V7(),t=U7();return n=>{const a=new ArrayBuffer(4*n.length),o=new Uint32Array(a);for(let i=0;i<n.length;i++){const c=n[i],u=s[t[c>>10]+(c&1023)]+e[c>>10];o[i]=u}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ys{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ys.instance==null&&(ys.instance=new ys),ys.instance}static registerSaveRouter(e){ys.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ys.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ys.getHandlers(e,"save")}static getLoadHandlers(e,t){return ys.getHandlers(e,"load",t)}static getHandlers(e,t,n){const a=[];return(t==="load"?ys.getInstance().loadRouters:ys.getInstance().saveRouters).forEach(i=>{const c=i(e,n);c!==null&&a.push(c)}),a}}const W7=s=>ys.registerSaveRouter(s),H7=s=>ys.registerLoadRouter(s),mk=s=>ys.getSaveHandlers(s),q7=(s,e)=>ys.getLoadHandlers(s,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y1="tensorflowjs",Z1=1,Rl="models_store",ki="model_info_store";function gk(){if(!Se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const s=typeof window>"u"?self:window,e=s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB||s.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Q1(s){const e=s.result;e.createObjectStore(Rl,{keyPath:"modelPath"}),e.createObjectStore(ki,{keyPath:"modelPath"})}class Ul{constructor(e){if(this.indexedDB=gk(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,a)=>{const o=this.indexedDB.open(Y1,Z1);o.onupgradeneeded=()=>Q1(o),o.onsuccess=()=>{const i=o.result;if(t==null){const c=i.transaction(Rl,"readonly"),h=c.objectStore(Rl).get(this.modelPath);h.onsuccess=()=>{if(h.result==null)return i.close(),a(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));n(h.result.modelArtifacts)},h.onerror=p=>(i.close(),a(h.error)),c.oncomplete=()=>i.close()}else{t.weightData=Dr.join(t.weightData);const c=Cp(t),u=i.transaction(ki,"readwrite");let h=u.objectStore(ki),p;try{p=h.put({modelPath:this.modelPath,modelArtifactsInfo:c})}catch(g){return a(g)}let f;p.onsuccess=()=>{f=i.transaction(Rl,"readwrite");const g=f.objectStore(Rl);let b;try{b=g.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:c})}catch(y){return a(y)}b.onsuccess=()=>n({modelArtifactsInfo:c}),b.onerror=y=>{h=u.objectStore(ki);const w=h.delete(this.modelPath);w.onsuccess=()=>(i.close(),a(b.error)),w.onerror=v=>(i.close(),a(b.error))}},p.onerror=g=>(i.close(),a(p.error)),u.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}}},o.onerror=i=>a(o.error)})}}Ul.URL_SCHEME="indexeddb://";const xk=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Ul.URL_SCHEME)?K7(s.slice(Ul.URL_SCHEME.length)):null;ys.registerSaveRouter(xk);ys.registerLoadRouter(xk);function K7(s){return new Ul(s)}function X7(s){return s.startsWith(Ul.URL_SCHEME)?s.slice(Ul.URL_SCHEME.length):s}class Y7{constructor(){this.indexedDB=gk()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(Y1,Z1);n.onupgradeneeded=()=>Q1(n),n.onsuccess=()=>{const a=n.result,o=a.transaction(ki,"readonly"),c=o.objectStore(ki).getAll();c.onsuccess=()=>{const u={};for(const h of c.result)u[h.modelPath]=h.modelArtifactsInfo;e(u)},c.onerror=u=>(a.close(),t(c.error)),o.oncomplete=()=>a.close()},n.onerror=a=>t(n.error)})}async removeModel(e){return e=X7(e),new Promise((t,n)=>{const a=this.indexedDB.open(Y1,Z1);a.onupgradeneeded=()=>Q1(a),a.onsuccess=()=>{const o=a.result,i=o.transaction(ki,"readwrite"),c=i.objectStore(ki),u=c.get(e);let h;u.onsuccess=()=>{if(u.result==null)return o.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const p=c.delete(e),f=()=>{h=o.transaction(Rl,"readwrite");const b=h.objectStore(Rl).delete(e);b.onsuccess=()=>t(u.result.modelArtifactsInfo),b.onerror=y=>n(u.error)};p.onsuccess=f,p.onerror=g=>(f(),o.close(),n(u.error))}},u.onerror=p=>(o.close(),n(u.error)),i.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}},a.onerror=o=>n(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Do="/",lu="tensorflowjs_models",bk="info",Z7="model_topology",Q7="weight_specs",J7="weight_data",eL="model_metadata";function yk(s){return{info:[lu,s,bk].join(Do),topology:[lu,s,Z7].join(Do),weightSpecs:[lu,s,Q7].join(Do),weightData:[lu,s,J7].join(Do),modelMetadata:[lu,s,eL].join(Do)}}function vk(s){for(const e of Object.values(s))window.localStorage.removeItem(e)}function tL(s){const e=s.split(Do);if(e.length<3)throw new Error("Invalid key format: ".concat(s));return e.slice(1,e.length-1).join(Do)}function sL(s){return s.startsWith(Gl.URL_SCHEME)?s.slice(Gl.URL_SCHEME.length):s}class Gl{constructor(e){if(!Se().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=yk(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=Cp(e),o=Dr.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,P7(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch(i){throw vk(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=a;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const c=JSON.parse(o);t.format=c.format,t.generatedBy=c.generatedBy,t.convertedBy=c.convertedBy,c.signature!=null&&(t.signature=c.signature),c.userDefinedMetadata!=null&&(t.userDefinedMetadata=c.userDefinedMetadata),c.modelInitializer!=null&&(t.modelInitializer=c.modelInitializer),c.initializerSignature!=null&&(t.initializerSignature=c.initializerSignature),c.trainingConfig!=null&&(t.trainingConfig=c.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=z7(i),t}}Gl.URL_SCHEME="localstorage://";const wk=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Gl.URL_SCHEME)?nL(s.slice(Gl.URL_SCHEME.length)):null;ys.registerSaveRouter(wk);ys.registerLoadRouter(wk);function nL(s){return new Gl(s)}class aL{constructor(){V(Se().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),V(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=lu+Do,n=Do+bk;for(let a=0;a<this.LS.length;++a){const o=this.LS.key(a);if(o.startsWith(t)&&o.endsWith(n)){const i=tL(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=sL(e);const t=yk(e);if(this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '".concat(e,"'"));const n=JSON.parse(this.LS.getItem(t.info));return vk(t),n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hu="://";class Vn{constructor(){this.managers={}}static getInstance(){return Vn.instance==null&&(Vn.instance=new Vn),Vn.instance}static registerManager(e,t){V(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(hu)&&(e=e.slice(0,e.indexOf(hu))),V(e.length>0,()=>"scheme must not be an empty string.");const n=Vn.getInstance();V(n.managers[e]==null,()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){const t=Vn.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(Vn.getInstance().managers)}}function wm(s){if(s.indexOf(hu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Vn.getSchemes().join(",")));return{scheme:s.split(hu)[0],path:s.split(hu)[1]}}async function Nk(s,e,t=!1){V(s!==e,()=>"Old path and new path are the same: '".concat(s,"'"));const n=ys.getLoadHandlers(s);V(n.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(s,".")),V(n.length<2,()=>"Copying failed because more than one (".concat(n.length,") ")+"load handlers for source URL ".concat(s,"."));const a=n[0],o=ys.getSaveHandlers(e);V(o.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,".")),V(o.length<2,()=>"Copying failed because more than one (".concat(n.length,") ")+"save handlers for destination URL ".concat(e,"."));const i=o[0],c=wm(s).scheme,u=wm(s).path,h=c===wm(s).scheme,p=await a.load();t&&h&&await Vn.getManager(c).removeModel(u);const f=await i.save(p);return t&&!h&&await Vn.getManager(c).removeModel(u),f.modelArtifactsInfo}async function rL(){const s=Vn.getSchemes(),e={};for(const t of s){const n=await Vn.getManager(t).listModels();for(const a in n){const o=t+hu+a;e[o]=n[a]}}return e}async function oL(s){const e=wm(s);return Vn.getManager(e.scheme).removeModel(e.path)}async function iL(s,e){return Nk(s,e,!1)}async function lL(s,e){return Nk(s,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cL{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Se().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();const a=this.functionRefs[n.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return Hj(e)}}if(Se().get("IS_BROWSER")){Se().setPlatform("browser",new cL);try{Vn.registerManager(Gl.URL_SCHEME,new aL)}catch(s){}try{Vn.registerManager(Ul.URL_SCHEME,new Y7)}catch(s){}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uL={importFetch:()=>require("node-fetch")};let p1;class dL{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Se().global.fetch!=null?Se().global.fetch(e,t):(p1==null&&(p1=uL.importFetch()),p1(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Se().get("IS_NODE")&&!Se().get("IS_BROWSER")&&Se().setPlatform("node",new dL);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dt(s,e="float32",t){return e=e||"float32",Pa(s),new Js(s,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(s,e){const t=H(s,"x","cast");if(!q8(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const n={x:t},a={dtype:e};return re.runKernel(Fh,n,a)}const Xe=se({cast_:hL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(s){const t={x:H(s,"x","clone","string_or_numeric")};return re.runKernel(Xh,t)}const Ro=se({clone_:pL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(s,e=!1){console.log(s.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sk();const fL={buffer:Dt,cast:Xe,clone:Ro,print:Sk};C7(fL);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mL(s,e){let t=H(s,"a","add"),n=H(e,"b","add");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(Ru,a)}const Me=se({add_:mL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(s,e){let t=H(s,"a","floorDiv"),n=H(e,"b","floorDiv");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(qh,a)}const q2=se({floorDiv_:gL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xL(s,e){let t=H(s,"a","div"),n=H(e,"b","div");if([t,n]=Is(t,n),t.dtype==="int32"&&n.dtype==="int32")return q2(t,n);const a={a:t,b:n},o={};return re.runKernel(Bh,a,o)}const Qe=se({div_:xL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bL(s,e){let t=H(s,"a","mul"),n=H(e,"b","mul");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(ap,a)}const ae=se({mul_:bL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yL(s){const e=H(s,"x","abs");if(e.dtype==="complex64"){const t={x:e};return re.runKernel(yg,t)}else{const t={x:e};return re.runKernel(ug,t)}}const Xs=se({abs_:yL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vL(s){const t={x:H(s,"x","acos")};return re.runKernel($h,t)}const Ck=se({acos_:vL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wL(s){const t={x:H(s,"x","acosh")};return re.runKernel(Ah,t)}const jk=se({acosh_:wL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(s){V(Array.isArray(s),()=>"The argument passed to tf.addN() must be a list of tensors"),V(s.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(s.length));const e=s.map((a,o)=>H(a,"tensors".concat(o),"addN")),t=e[0];e.forEach(a=>{if(a.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!zt(a.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const n=e;return re.runKernel(dg,n)}const SL=se({addN_:NL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(s,e=null,t=!1){const a={x:H(s,"x","all","bool")},o={axis:e,keepDims:t};return re.runKernel(zy,a,o)}const K2=se({all_:CL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jL(s,e=null,t=!1){const a={x:H(s,"x","any","bool")},o={axis:e,keepDims:t};return re.runKernel(By,a,o)}const Mm=se({any_:jL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(s,e=0){const n={x:H(s,"x","argMax")},a={axis:e};return re.runKernel(hg,n,a)}const yu=se({argMax_:kL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(s,e=0){const n={x:H(s,"x","argMin")},a={axis:e};return re.runKernel(pg,n,a)}const kk=se({argMin_:TL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(s){const t={x:H(s,"x","asin")};return re.runKernel(Eh,t)}const Tk=se({asin_:IL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(s){const t={x:H(s,"x","asinh")};return re.runKernel(Dh,t)}const Ik=se({asinh_:$L});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AL(s){const t={x:H(s,"x","atan")};return re.runKernel(Rh,t)}const $k=se({atan_:AL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(s,e){let t=H(s,"a","atan2"),n=H(e,"b","atan2");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(_h,a)}const Ak=se({atan2_:EL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(s){const t={x:H(s,"x","atanh")};return re.runKernel(Oh,t)}const Ek=se({atanh_:DL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(s,e,t,n,a="NHWC",o){const i=s[3],c=[...e,i],u=Go(a);return mn(s,c,t,o,n,null,null,u)}function pr(s,e,t,n,a,o,i="channelsLast"){const[c,u]=hh(e);let h;if(i==="channelsLast")h=[c,u,s[3],s[3]];else if(i==="channelsFirst")h=[c,u,s[1],s[1]];else throw new Error("Unknown dataFormat ".concat(i));return mn(s,h,t,n,a,o,!1,i)}function Uo(s,e,t,n,a,o,i="NDHWC"){const[c,u,h]=J1(e);let p,f;if(i==="NDHWC")f="channelsLast",p=[c,u,h,s[4],s[4]];else if(i==="NCDHW")f="channelsFirst",p=[c,u,h,s[1],s[1]];else throw new Error("Unknown dataFormat ".concat(i));return Ki(s,p,t,n,a,!1,f,o)}function mn(s,e,t,n,a,o,i=!1,c="channelsLast"){let[u,h,p,f]=[-1,-1,-1,-1];if(c==="channelsLast")[u,h,p,f]=s;else if(c==="channelsFirst")[u,f,h,p]=s;else throw new Error("Unknown dataFormat ".concat(c));const[g,b,,y]=e,[w,v]=hh(t),[N,C]=hh(n),T=pu(g,N),I=pu(b,C),{padInfo:$,outHeight:R,outWidth:O}=_L(a,h,p,w,v,T,I,o,c),P=i?y*f:y;let _;return c==="channelsFirst"?_=[u,P,R,O]:c==="channelsLast"&&(_=[u,R,O,P]),{batchSize:u,dataFormat:c,inHeight:h,inWidth:p,inChannels:f,outHeight:R,outWidth:O,outChannels:P,padInfo:$,strideHeight:w,strideWidth:v,filterHeight:g,filterWidth:b,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationHeight:N,dilationWidth:C,inShape:s,outShape:_,filterShape:e}}function Ki(s,e,t,n,a,o=!1,i="channelsLast",c){let[u,h,p,f,g]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,h,p,f,g]=s;else if(i==="channelsFirst")[u,g,h,p,f]=s;else throw new Error("Unknown dataFormat ".concat(i));const[b,y,w,,v]=e,[N,C,T]=J1(t),[I,$,R]=J1(n),O=pu(b,I),P=pu(y,$),_=pu(w,R),{padInfo:M,outDepth:A,outHeight:U,outWidth:K}=FL(a,h,p,f,N,C,T,O,P,_,c),Q=o?v*g:v;let X;return i==="channelsFirst"?X=[u,Q,A,U,K]:i==="channelsLast"&&(X=[u,A,U,K,Q]),{batchSize:u,dataFormat:i,inDepth:h,inHeight:p,inWidth:f,inChannels:g,outDepth:A,outHeight:U,outWidth:K,outChannels:Q,padInfo:M,strideDepth:N,strideHeight:C,strideWidth:T,filterDepth:b,filterHeight:y,filterWidth:w,effectiveFilterDepth:O,effectiveFilterHeight:P,effectiveFilterWidth:_,dilationDepth:I,dilationHeight:$,dilationWidth:R,inShape:s,outShape:X,filterShape:e}}function RL(s,e,t,n,a){n==null&&(n=X2(s,e,t));const o=s[0],i=s[1],c=ph((o-e+2*n)/t+1,a),u=ph((i-e+2*n)/t+1,a);return[c,u]}function OL(s,e,t,n,a,o){a==null&&(a=X2(s,e[0],n[0]));const i=[0,0,0,t];for(let c=0;c<3;c++)s[c]+2*a>=e[c]&&(i[c]=ph((s[c]-e[c]+2*a)/n[c]+1,o));return i}function X2(s,e,t,n=1){const a=pu(e,n);return Math.floor((s[0]*(t-1)-t+a)/2)}function hh(s){return typeof s=="number"?[s,s,s]:s.length===2?[s[0],s[1],1]:s}function J1(s){return typeof s=="number"?[s,s,s]:s}function pu(s,e){return e<=1?s:s+(s-1)*(e-1)}function _L(s,e,t,n,a,o,i,c,u){let h,p,f;if(typeof s=="number"){h={top:s,bottom:s,left:s,right:s,type:s===0?"VALID":"NUMBER"};const b=RL([e,t],o,n,s,c);p=b[0],f=b[1]}else if(s==="same"){p=Math.ceil(e/n),f=Math.ceil(t/a);const g=Math.max(0,(p-1)*n+o-e),b=Math.max(0,(f-1)*a+i-t),y=Math.floor(g/2),w=g-y,v=Math.floor(b/2),N=b-v;h={top:y,bottom:w,left:v,right:N,type:"SAME"}}else if(s==="valid")h={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((e-o+1)/n),f=Math.ceil((t-i+1)/a);else if(typeof s=="object"){const g=u==="channelsLast"?s[1][0]:s[2][0],b=u==="channelsLast"?s[1][1]:s[2][1],y=u==="channelsLast"?s[2][0]:s[3][0],w=u==="channelsLast"?s[2][1]:s[3][1];h={top:g,bottom:b,left:y,right:w,type:g===0&&b===0&&y===0&&w===0?"VALID":"EXPLICIT"},p=ph((e-o+g+b)/n+1,c),f=ph((t-i+y+w)/a+1,c)}else throw Error("Unknown padding parameter: ".concat(s));return{padInfo:h,outHeight:p,outWidth:f}}function FL(s,e,t,n,a,o,i,c,u,h,p){let f,g,b,y;if(s==="valid"&&(s=0),typeof s=="number"){f={top:s,bottom:s,left:s,right:s,front:s,back:s,type:s===0?"VALID":"NUMBER"};const v=OL([e,t,n,1],[c,u,h],1,[a,o,i],s,p);g=v[0],b=v[1],y=v[2]}else if(s==="same"){g=Math.ceil(e/a),b=Math.ceil(t/o),y=Math.ceil(n/i);const w=(g-1)*a+c-e,v=(b-1)*o+u-t,N=(y-1)*i+h-n,C=Math.floor(w/2),T=w-C,I=Math.floor(v/2),$=v-I,R=Math.floor(N/2),O=N-R;f={top:I,bottom:$,left:R,right:O,front:C,back:T,type:"SAME"}}else throw Error("Unknown padding parameter: ".concat(s));return{padInfo:f,outDepth:g,outHeight:b,outWidth:y}}function ph(s,e){if(!e)return Math.trunc(s);switch(e){case"round":return Math.round(s);case"ceil":return Math.ceil(s);case"floor":return Math.floor(s);default:throw new Error("Unknown roundingMode ".concat(e))}}function Fi(s){const[e,t,n]=hh(s);return e===1&&t===1&&n===1}function jn(s,e){return Fi(s)||Fi(e)}function Wl(s){return hh(s).every(e=>e>0)}function Go(s){if(s==="NHWC")return"channelsLast";if(s==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat ".concat(s))}function Kn(s,e,t){if(t!=null){if(typeof e=="string")throw Error("Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(e,"."));if(typeof e=="number")V(xu(e),()=>"Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(e,"."));else if(typeof e=="object")e.forEach(n=>{n.forEach(a=>{V(xu(a),()=>"Error in ".concat(s,": pad must be an integer when using ")+"dimRoundingMode ".concat(t," but got pad ").concat(a,"."))})});else throw Error("Error in ".concat(s,": Unknown padding parameter: ").concat(e))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(s,e){const n={x:H(s,"x","reshape","string_or_numeric")},a={shape:e};return re.runKernel(Jg,n,a)}const le=se({reshape_:LL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(s,e,t,n,a){const o=H(s,"x","avgPool","float32"),i=1;V(jn(t,i),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(i,"'"));let c=o,u=!1;o.rank===3&&(u=!0,c=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(c.rank===4,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(c.rank,".")),Kn("avgPool",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a};let f=re.runKernel(fg,h,p);return f=Xe(f,o.dtype),u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const fx=se({avgPool_:ML});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(s,e,t,n,a,o="NDHWC"){const i=H(s,"x","avgPool3d","float32");let c=i,u=!1;i.rank===4&&(u=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(c.rank===5,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(c.rank,".")),V(o==="NDHWC",()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),V(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(t,"'")),Kn("avgPool3d",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a,dataFormat:o};let f=re.runKernel(mg,h,p);return f=Xe(f,c.dtype),u?le(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Dk=se({avgPool3d_:PL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zL(s,e=0){V(s.length>=1,()=>"Pass at least one tensor to concat");const t=Lm(s,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(o.dtype,". "))}),t.length===1)return Ro(t[0]);const n=t,a={axis:e};return re.runKernel(vg,n,a)}const Ts=se({concat_:zL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(s,e,t=!1,n=!1){let a=H(s,"a","matMul"),o=H(e,"b","matMul");[a,o]=Is(a,o);const i={a,b:o},c={transposeA:t,transposeB:n};return re.runKernel(gg,i,c)}const Ft=se({matMul_:BL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(s){const t={x:H(s,"x","sigmoid","float32")};return re.runKernel(mp,t)}const kr=se({sigmoid_:VL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UL(s,e,t){const n=H(s,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");const a={x:n},o={begin:e,size:t};return re.runKernel(ax,a,o)}const yt=se({slice_:UL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(s){const t={x:H(s,"x","tanh","float32")};return re.runKernel(wp,t)}const Hl=se({tanh_:GL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(s,e,t,n,a,o){const i=H(s,"forgetBias","basicLSTMCell"),c=H(e,"lstmKernel","basicLSTMCell"),u=H(t,"lstmBias","basicLSTMCell"),h=H(n,"data","basicLSTMCell"),p=H(a,"c","basicLSTMCell"),f=H(o,"h","basicLSTMCell"),g=Ts([h,f],1),b=Ft(g,c),y=Me(b,u),w=y.shape[0],v=y.shape[1]/4,N=[w,v],C=yt(y,[0,0],N),T=yt(y,[0,v],N),I=yt(y,[0,v*2],N),$=yt(y,[0,v*3],N),R=Me(ae(kr(C),Hl(T)),ae(p,kr(Me(i,I)))),O=ae(Hl(R),kr($));return[R,O]}const HL=se({basicLSTMCell_:WL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(s,e,t){const n=H(s,"x","batchToSpaceND"),a=e.reduce((c,u)=>c*u);V(n.rank>=1+e.length,()=>"input rank is ".concat(n.rank," but should be > than blockShape.length ").concat(e.length)),V(t.length===e.length,()=>"crops.length is ".concat(t.length," but should be equal to blockShape.length  ").concat(e.length)),V(n.shape[0]%a===0,()=>"input tensor batch is ".concat(n.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(a));const o={x:n},i={blockShape:e,crops:t};return re.runKernel(xg,o,i)}const mx=se({batchToSpaceND_:qL});function KL(s){let e;return s.rank===0||s.rank===1?e=le(s,[1,1,1,s.size]):s.rank===2?e=le(s,[1,1,s.shape[0],s.shape[1]]):s.rank===3?e=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]):e=s,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XL(s,e,t,n,a,o){o==null&&(o=.001);const i=H(s,"x","batchNorm"),c=H(e,"mean","batchNorm"),u=H(t,"variance","batchNorm");let h;a!=null&&(h=H(a,"scale","batchNorm"));let p;n!=null&&(p=H(n,"offset","batchNorm")),V(c.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(p==null||c.rank===p.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(h==null||c.rank===h.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const g={x:KL(i),scale:h,offset:p,mean:c,variance:u},b={varianceEpsilon:o},y=re.runKernel($g,g,b);return le(y,i.shape)}const kp=se({batchNorm_:XL});function YL(s,e,t,n,a,o){const i=H(s,"x","batchNorm"),c=H(e,"mean","batchNorm"),u=H(t,"variance","batchNorm");let h;a!=null&&(h=H(a,"scale","batchNorm"));let p;return n!=null&&(p=H(n,"offset","batchNorm")),V(i.rank===2,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(i.rank,".")),V(c.rank===2||c.rank===1,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===2||u.rank===1,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===2||h.rank===1,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===2||p.rank===1,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const Rk=se({batchNorm2d_:YL});function ZL(s,e,t,n,a,o){const i=H(s,"x","batchNorm"),c=H(e,"mean","batchNorm"),u=H(t,"variance","batchNorm");let h;a!=null&&(h=H(a,"scale","batchNorm"));let p;return n!=null&&(p=H(n,"offset","batchNorm")),V(i.rank===3,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(i.rank,".")),V(c.rank===3||c.rank===1,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===3||u.rank===1,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===3||h.rank===1,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===3||p.rank===1,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const Ok=se({batchNorm3d_:ZL});function QL(s,e,t,n,a,o){const i=H(s,"x","batchNorm"),c=H(e,"mean","batchNorm"),u=H(t,"variance","batchNorm");let h;a!=null&&(h=H(a,"scale","batchNorm"));let p;return n!=null&&(p=H(n,"offset","batchNorm")),V(i.rank===4,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(i.rank,".")),V(c.rank===4||c.rank===1,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")),V(u.rank===4||u.rank===1,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),h!=null&&V(h.rank===4||h.rank===1,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(h.rank,".")),p!=null&&V(p.rank===4||p.rank===1,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(p.rank,".")),kp(i,c,u,p,h,o)}const _k=se({batchNorm4d_:QL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(s,e,t){const n=H(s,"x","bincount"),a=H(e,"weights","bincount");V(n.dtype==="int32",()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(n.dtype)),V(t>=0,()=>"size must be non-negative, but got ".concat(t,".")),V(a.size===n.size||a.size===0,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(n.shape,", weights shape: ")+"".concat(a.shape,"."));const o={x:n,weights:a},i={size:t};return re.runKernel(Gy,o,i)}const Fk=se({bincount_:JL});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eM(s,e){const t=H(s,"x","bitwiseAnd"),n=H(e,"y","bitwiseAnd");if(!zt(t.shape,n.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(t.shape,", y: ").concat(n.shape));if(t.dtype!=="int32"||n.dtype!=="int32")throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(t.dtype," and type of y: ").concat(n.dtype));const a={a:t,b:n};return re.runKernel(bg,a)}const tM=se({bitwiseAnd_:eM});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sM(s,e){const t=H(s,"s0","broadcastArgs","int32"),n=H(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(t.rank));if(n.rank!==1)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(n.rank));const a={s0:t,s1:n};return re.runKernel(Wy,a)}const nM=se({broadcastArgs_:sM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aM(s,e){let t=H(s,"broadcastTo","x");const n=t.shape;if(Pa(e),e.length<t.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(t.rank,"."));if(e.length>t.rank){const h=t.shape.slice();for(;h.length<e.length;)h.unshift(1);t=le(t,h)}const a=t.shape,o=Array.from(e);for(let h=e.length-1;h>=0;h--)if(a[h]===e[h])o[h]=1;else if(t.shape[h]!==1)throw new Error("broadcastTo(): [".concat(n,"] cannot be broadcast to [").concat(e,"]."));if(o.map((h,p)=>h>1?p:-1).filter(h=>h>=0).length===0)return Ro(t);const c={x:t},u={reps:o};return re.runKernel(Np,c,u)}const fu=se({broadcastTo_:aM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(s){const t={x:H(s,"x","ceil","float32")};return re.runKernel(Lh,t)}const Lk=se({ceil_:rM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ou(s,e,t){Pa(s),t=t||Eu(e);const n={shape:s,value:e,dtype:t};return re.runKernel(o2,{},n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(s,e,t){const n=H(s,"x","clipByValue");if(V(e<=t,()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(t,").")),e===t)return Ou(n.shape,e,n.dtype);const a={x:n},o={clipValueMin:e,clipValueMax:t};return re.runKernel(Mh,a,o)}const oa=se({clipByValue_:oM});function iM(s){return Ts(s,0)}const Mk=se({concat1d_:iM});function lM(s,e){return Ts(s,e)}const Pk=se({concat2d_:lM});function cM(s,e){return Ts(s,e)}const zk=se({concat3d_:cM});function uM(s,e){return Ts(s,e)}const Bk=se({concat4d_:uM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dM(s,e,t,n,a="NHWC",o=[1,1],i){const c=H(s,"x","conv2d","float32"),u=H(e,"filter","conv2d","float32");let h=c,p=!1;c.rank===3&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(h.rank===4,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(h.rank,".")),V(u.rank===4,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")),Kn("conv2d",n,i);const f=a==="NHWC"?h.shape[3]:h.shape[1];V(f===u.shape[2],()=>"Error in conv2d: depth of input (".concat(f,") must match ")+"input depth for filter ".concat(u.shape[2],".")),V(jn(t,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'")),V(Wl(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv2D: Strides should be larger than 0.");const g={x:h,filter:u},b={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i},y=re.runKernel(wg,g,b);return p?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Li=se({conv2d_:dM});function hM(s,e,t,n,a="NWC",o=1,i){const c=H(s,"x","conv1d"),u=H(e,"filter","conv1d");let h=c,p=!1;c.rank===2&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1]])),V(h.rank===3,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(h.rank,".")),V(u.rank===3,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")),Kn("conv1d",n,i),V(h.shape[2]===u.shape[1],()=>"Error in conv1d: depth of input (".concat(h.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")),V(jn(t,o),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(t," and dilation '").concat(o,"'")),V(Wl(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv1D: Stride should be larger than 0."),V(a==="NWC",()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));const f=le(u,[1,u.shape[0],u.shape[1],u.shape[2]]),g=le(h,[h.shape[0],1,h.shape[1],h.shape[2]]),v=Li(g,f,[1,t],n,"NHWC",[1,o],i);return p?le(v,[v.shape[2],v.shape[3]]):le(v,[v.shape[0],v.shape[2],v.shape[3]])}const Y2=se({conv1d_:hM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(s,e,t,n,a,o="NHWC",i){V(s.length===e.rank,()=>"Length of inShape "+"(".concat(s.length,") and rank of dy (").concat(e.rank,") must match"));let c=s,u=e,h=!1;e.rank===3&&(h=!0,u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]),c=[1,s[0],s[1],s[2]]),V(c.length===4,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(c.length,".")),V(u.rank===4,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)),V(t.rank===4,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(t.rank));const p=o==="NHWC"?c[3]:c[1],f=o==="NHWC"?u.shape[3]:u.shape[1];V(p===t.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(p,") must ")+"match input depth for filter ".concat(t.shape[2],".")),V(f===t.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(t.shape[3],".")),Kn("conv2dDerInput",a,i);const g={dy:u,filter:t},b={strides:n,pad:a,dataFormat:o,dimRoundingMode:i,inputShape:c},y=re.runKernel(Ng,g,b);return h?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Z2=se({conv2DBackpropInput_:pM});function fM(s,e,t,n,a,o){const i=H(s,"x","conv2dTranspose"),c=H(e,"filter","conv2dTranspose");return Z2(t,i,c,n,a,"NHWC",o)}const Q2=se({conv2dTranspose_:fM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mM(s,e,t,n,a="NDHWC",o=[1,1,1]){const i=H(s,"x","conv3d"),c=H(e,"filter","conv3d");let u=i,h=!1;i.rank===4&&(h=!0,u=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(u.rank===5,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")),V(c.rank===5,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(c.rank,".")),V(u.shape[4]===c.shape[3],()=>"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(c.shape[3],".")),V(jn(t,o),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'")),V(a==="NDHWC",()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")),V(Wl(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),V(Wl(t),()=>"Error in conv3D: Strides should be larger than 0.");const p={x:u,filter:c},f={strides:t,pad:n,dataFormat:a,dilations:o},g=re.runKernel(Sg,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Vk=se({conv3d_:mM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(s,e,t,n,a){V(s.length===e.rank,()=>"Length of inShape "+"(".concat(s.length,") and rank of dy (").concat(e.rank,") must match"));let o=s,i=e,c=!1;e.rank===4&&(c=!0,i=le(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,s[0],s[1],s[2],s[3]]);const u=o[4],h=i.shape[4];V(o.length===5,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,".")),V(i.rank===5,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)),V(t.rank===5,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(t.rank)),V(u===t.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(t.shape[3],".")),V(h===t.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(t.shape[4],"."));const p={dy:i,filter:t},f={pad:a,strides:n,inputShape:o},g=re.runKernel(Xy,p,f);return c?le(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Uk=se({conv3DBackpropInput_:gM});function xM(s,e,t,n,a){const o=H(s,"x","conv3dTranspose"),i=H(e,"filter","conv3dTranspose");return Uk(t,o,i,n,a)}const Gk=se({conv3dTranspose_:xM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(s){const t={x:H(s,"x","cos","float32")};return re.runKernel(Ph,t)}const gx=se({cos_:bM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(s){const t={x:H(s,"x","cosh","float32")};return re.runKernel(zh,t)}const J2=se({cosh_:yM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vM(s,e=0,t=!1,n=!1){const o={x:H(s,"x","cumprod")},i={axis:e,exclusive:t,reverse:n};return re.runKernel(Yy,o,i)}const Pm=se({cumprod_:vM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wM(s,e=0,t=!1,n=!1){const o={x:H(s,"x","cumsum")},i={axis:e,exclusive:t,reverse:n};return re.runKernel(Cg,o,i)}const ev=se({cumsum_:wM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NM(s,e,t,n=!1){const a=H(s,"x","denseBincount"),o=H(e,"weights","denseBincount");V(a.dtype==="int32",()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)),V(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")),V(t>=0,()=>"size must be non-negative, but got ".concat(t,".")),V(o.size===a.size||o.size===0,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(o.shape,"."));const i={x:a,weights:o},c={size:t,binaryOutput:n};return re.runKernel(Qy,i,c)}const ey=se({denseBincount_:NM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SM(s,e,t="NHWC"){const n=H(s,"x","depthToSpace","float32"),a=t==="NHWC"?n.shape[1]:n.shape[2],o=t==="NHWC"?n.shape[2]:n.shape[3],i=t==="NHWC"?n.shape[3]:n.shape[1];V(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e)),V(a*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(n.shape)),V(o*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(e," for depthToSpace with input shape\n        ").concat(n.shape)),V(i%(e*e)===0,()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(i," for depthToSpace with input shape ").concat(n.shape));const c={x:n},u={blockSize:e,dataFormat:t};return re.runKernel(Jy,c,u)}const Wk=se({depthToSpace_:SM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CM(s,e,t,n,a="NHWC",o=[1,1],i){const c=H(s,"x","depthwiseConv2d","float32"),u=H(e,"filter","depthwiseConv2d","float32");let h=c,p=!1;c.rank===3&&(p=!0,h=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(h.rank===4,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(h.rank,".")),V(u.rank===4,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,"."));const f=a==="NHWC"?h.shape[3]:h.shape[1];V(f===u.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(f,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")),Kn("depthwiseConv2d",n,i);const g={x:h,filter:u},b={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i},y=re.runKernel(jg,g,b);return p?le(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Tp=se({depthwiseConv2d_:CM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jM(s){const t={x:H(s,"x","diag")};return re.runKernel(s2,t)}const kM=se({diag_:jM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(s,e,t,n,a=[1,1],o="NHWC"){const i=H(s,"x","dilation2d"),c=H(e,"filter","dilation2d");V(i.rank===3||i.rank===4,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,".")),V(c.rank===3,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(c.rank,".")),V(o==="NHWC",()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(o));let u=i,h=!1;i.rank===3&&(u=le(i,[1,i.shape[0],i.shape[1],i.shape[2]]),h=!0),V(u.shape[3]===c.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(c.shape[2]));const p={x:u,filter:c},f={strides:t,pad:n,dilations:a},g=re.runKernel(kg,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Hk=se({dilation2d_:TM});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vu(s,e){const t=s.length,n=[];for(let a=0;a<t;a++){const o=t-1-a,i=s[o]||1;(e[e.length-1-a]||1)>1&&i===1&&n.unshift(o)}return n}function sn(s,e){const t=[];for(let n=0;n<e.length;n++){const a=s[s.length-n-1],o=e.length-n-1,i=e[o];(a==null||a===1&&i>1)&&t.unshift(o)}return t}function Tt(s,e){const t=Math.max(s.length,e.length),n=new Array(t);for(let a=0;a<t;a++){let o=s[s.length-a-1];o==null&&(o=1);let i=e[e.length-a-1];if(i==null&&(i=1),o===1)n[t-a-1]=i;else if(i===1)n[t-a-1]=o;else if(o!==i){const c="Operands could not be broadcast together with shapes "+"".concat(s," and ").concat(e,".");throw Error(c)}else n[t-a-1]=o}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IM(s,e){let t=H(s,"a","equal","string_or_numeric"),n=H(e,"b","equal","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Tg,a)}const Ir=se({equal_:IM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $M(s,e,t){const n=H(e,"a","where"),a=H(t,"b","where"),o=H(s,"condition","where","bool"),i=Tt(Tt(o.shape,n.shape),a.shape),c=fu(o,i),u=fu(n,i),h=fu(a,i),p={condition:c,t:u,e:h};return re.runKernel(nx,p)}const Dn=se({where_:$M});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(s){const t={x:H(s,"x","zerosLike")};return re.runKernel(hx,t)}const Vt=se({zerosLike_:AM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(s,e){let t=H(s,"a","div"),n=H(e,"b","div");[t,n]=Is(t,n);const a=Qe(t,n),o=Vt(a),i=Ir(n,o);return Dn(i,o,a)}const qk=se({divNoNan_:EM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(s,e){const t=H(s,"t1","dot"),n=H(e,"t2","dot");V((t.rank===1||t.rank===2)&&(n.rank===1||n.rank===2),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(t.rank," and ").concat(n.rank,"."));const a=t.rank===1?t.size:t.shape[1],o=n.rank===1?n.size:n.shape[0];if(V(a===o,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(o,".")),t.rank===1&&n.rank===1){const i=le(t,[1,-1]),c=le(n,[-1,1]),u=Ft(i,c);return le(u,[])}else if(t.rank===1&&n.rank===2){const i=le(t,[1,-1]),c=le(n,[n.shape[0],n.shape[1]]),u=Ft(i,c);return le(u,[u.size])}else if(t.rank===2&&n.rank===1){const i=le(n,[-1,1]),c=Ft(t,i);return le(c,[c.size])}else{const i=le(n,[n.shape[0],n.shape[1]]);return Ft(t,i)}}const Kk=se({dot_:DM});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RM(s,...e){const t=e.map((a,o)=>H(a,"tensors".concat(o),"einsum")),n={equation:s};return re.runKernel(n2,t,n)}const cu=se({einsum_:RM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OM(s){const t={x:H(s,"x","elu","float32")};return re.runKernel(Vh,t)}const Ip=se({elu_:OM});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _M(s,e){const t=H(s,"x","ensureShape","string_or_numeric");if(!W8(t.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(t.shape," is not compatible with expected shape ").concat(e));return s}const FM=se({ensureShape_:_M});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LM(s){let e=H(s,"x","erf");V(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Xe(e,"float32"));const t={x:e};return re.runKernel(Uh,t)}const tv=se({erf_:LM});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sv(s,e){for(let t=0;t<s.length;++t)if(s[s.length-t-1]!==e-1-t)return!1;return!0}function Xk(s,e,t){const n=s.length+e.length,a=[];let o=0,i=0;for(let c=0;c<n;c++)t.indexOf(c)===-1?a.push(s[o++]):a.push(e[i++]);return a}function gn(s,e){const t=[],n=s.length;for(let o=0;o<n;o++)e.indexOf(o)===-1&&t.push(s[o]);const a=e.map(o=>s[o]);return[t,a]}function _s(s,e){const t=e.map(n=>1);return Xk(s,t,e)}function kn(s,e,t){V(sv(e,t),()=>"".concat(s," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(t," input."))}function ws(s,e){if(sv(s,e))return null;const t=[];for(let n=0;n<e;++n)s.indexOf(n)===-1&&t.push(n);return s.forEach(n=>t.push(n)),t}function Xi(s){return s.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Fs(s,e){const t=[];for(let n=e-s;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MM(s,e=null,t=!1){const a={x:H(s,"x","max")},o={reductionIndices:e,keepDims:t};return re.runKernel(Pg,a,o)}const cr=se({max_:MM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(s,e=null,t=!1){const a={x:H(s,"x","min")},o={axis:e,keepDims:t};return re.runKernel(Ug,a,o)}const fh=se({min_:PM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(s,e){let t=H(s,"base","pow"),n=H(e,"exp","pow");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(rp,a)}const _o=se({pow_:zM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(s,e){if((ur(s)&&e!=="string"||Array.isArray(s))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ur(s)&&!(s instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return qi(s,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(s){const t={x:H(s,"x","sqrt","float32")};return re.runKernel(xp,t)}const Cn=se({sqrt_:BM});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VM(s){const e=H(s,"x","square"),t={};return re.runKernel("Square",{x:e},t)}const is=se({square_:VM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(s,e=null,t=!1){let n=H(s,"x","sum");n.dtype==="bool"&&(n=Xe(n,"int32"));const a={x:n},o={axis:e,keepDims:t};return re.runKernel(rx,a,o)}const it=se({sum_:UM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GM(s,e="euclidean",t=null,n=!1){s=H(s,"x","norm");const a=Yk(s,e,t);let o=a.shape;if(n){const i=Rt(t,s.shape);o=_s(a.shape,i)}return le(a,o)}function Yk(s,e,t=null){if(s.rank===0)return Xs(s);if(s.rank!==1&&t===null)return Yk(le(s,[-1]),e,t);if(s.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return it(Xs(s),t);if(e===1/0)return cr(Xs(s),t);if(e===-1/0)return fh(Xs(s),t);if(e==="euclidean"||e===2)return Cn(it(_o(Xs(s),gt(2,"int32")),t));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(t)&&t.length===2){if(e===1)return cr(it(Xs(s),t[0]),t[1]-1);if(e===1/0)return cr(it(Xs(s),t[1]),t[0]);if(e===-1/0)return fh(it(Xs(s),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Cn(it(is(s),t));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(t))}const $p=se({norm_:GM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WM(s,e=null,t=!1){return $p(s,"euclidean",e,t)}const Zk=se({euclideanNorm_:WM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(s){const t={x:H(s,"x","exp")};return re.runKernel(Gh,t)}const Wn=se({exp_:HM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(s,e=0){const t=H(s,"x","expandDims","string_or_numeric");V(e<=t.rank,()=>"Axis must be <= rank of the tensor");const n={input:t},a={dim:e};return re.runKernel(Ig,n,a)}const vn=se({expandDims_:qM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KM(s){const t={x:H(s,"x","expm1")};return re.runKernel(Wh,t)}const Qk=se({expm1_:KM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XM(s,e){const t=H(s,"x","tile","string_or_numeric");V(t.rank===e.length,()=>"Error in transpose: rank of input ".concat(t.rank," ")+"must match length of reps ".concat(e,"."));const n={x:t},a={reps:e};return re.runKernel(Np,n,a)}const rr=se({tile_:XM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YM(s,e,t,n="float32"){e==null&&(e=s);const a=Dt([s,e],n),o=s<=e?s:e;for(let c=0;c<o;++c)a.set(1,c,c);const i=le(a.toTensor(),[s,e]);if(t==null)return i;if(t.length===1)return rr(vn(i,0),[t[0],1,1]);if(t.length===2)return rr(vn(vn(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return rr(vn(vn(vn(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(t.length,"D."))}const nv=se({eye_:YM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(s){const t={x:H(s,"x","floor","float32")};return re.runKernel(Hh,t)}const Ap=se({floor_:ZM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(s,e,t=0,n=0){const a=H(s,"x","gather"),o=H(e,"indices","gather","int32"),i={x:a,indices:o},c={axis:t,batchDims:n};return re.runKernel(Ag,i,c)}const Ep=se({gather_:QM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(s,e){let t=H(s,"a","greater","string_or_numeric"),n=H(e,"b","greater","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Eg,a)}const ka=se({greater_:JM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eP(s,e){let t=H(s,"a","greaterEqual","string_or_numeric"),n=H(e,"b","greaterEqual","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Kh,a)}const Yi=se({greaterEqual_:eP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(s){const t={input:H(s,"input","imag")};return re.runKernel(u2,t)}const xx=se({imag_:tP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(s){const t={x:H(s,"x","isFinite")};return re.runKernel(Yh,t)}const Jk=se({isFinite_:sP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(s){const t={x:H(s,"x","isInf")};return re.runKernel(Zh,t)}const eT=se({isInf_:nP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(s){const t={x:H(s,"x","isNaN")};return re.runKernel(Qh,t)}const tT=se({isNaN_:aP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rP(s,e=.2){const n={x:H(s,"x","leakyRelu")},a={alpha:e};return re.runKernel(Dg,n,a)}const bx=se({leakyRelu_:rP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oP(s,e){let t=H(s,"a","less","string_or_numeric"),n=H(e,"b","less","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Rg,a)}const mh=se({less_:oP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(s,e){let t=H(s,"a","lessEqual","string_or_numeric"),n=H(e,"b","lessEqual","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Og,a)}const tc=se({lessEqual_:iP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lP(s,e,t){if(t<=0)throw new Error("The number of values should be positive.");const n={start:s,stop:e,num:t};return re.runKernel(d2,{},n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cP(s,e=5,t=1,n=1,a=.5){const o=H(s,"x","localResponseNormalization");V(o.rank===4||o.rank===3,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(o.rank,".")),V(xu(e),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,"."));let i=o,c=!1;o.rank===3&&(c=!0,i=le(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const u={x:i},h={depthRadius:e,bias:t,alpha:n,beta:a},p=re.runKernel(Mg,u,h);return c?le(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const sT=se({localResponseNormalization_:cP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uP(s){const t={x:H(s,"x","log","float32")};return re.runKernel(Jh,t)}const La=se({log_:uP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dP(s){const t={x:H(s,"x","log1p")};return re.runKernel(ep,t)}const yx=se({log1p_:dP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(s,e){V(F1(s),()=>"The f passed in variableGrads(f) must be a function"),V(e==null||Array.isArray(e)&&e.every(h=>h instanceof Fm),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const h in re.registeredVariables)e.push(re.registeredVariables[h])}const n=t?e.filter(h=>!h.trainable):null,a=e.length;e=e.filter(h=>h.trainable),V(e.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable.");const o=!0,{value:i,grads:c}=re.gradients(s,e,null,o);V(c.some(h=>h!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),V(i.rank===0,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor"));const u={};return e.forEach((h,p)=>{c[p]!=null&&(u[h.name]=c[p])}),n!=null&&n.forEach(h=>u[h.name]=null),{value:i,grads:u}}function Fo(s){return re.customGrad(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(s){const t={x:H(s,"x","neg")};return re.runKernel(Wg,t)}const fs=se({neg_:pP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fP(s){const t={x:H(s,"x","softplus")};return re.runKernel(gp,t)}const _u=se({softplus_:fP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(s){const e=H(s,"x","logSigmoid");return Fo(n=>({value:fs(_u(fs(n))),gradFunc:i=>ae(i,kr(fs(n)))}))(e)}const nT=se({logSigmoid_:mP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gP(s,e){let t=H(s,"a","sub"),n=H(e,"b","sub");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(yp,a)}const tt=se({sub_:gP});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xP(s,e=-1){const t=H(s,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(t.rank," and axis was ").concat(e));return Fo((a,o)=>{const c=cr(a,e,!0),u=tt(a,c),h=tt(Xe(u,"float32"),La(it(Wn(u),e,!0)));return o([h]),{value:h,gradFunc:(f,g)=>{const[b]=g,y=!0,w=Wn(b);return tt(f,ae(it(f,e,y),w))}}})(t)}const av=se({logSoftmax_:xP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(s,e=null,t=!1){const n=H(s,"x","logSumExp"),a=Rt(e,n.shape),o=cr(n,a,!0),i=tt(n,o),c=Wn(i),u=it(c,a),h=La(u),p=Me(le(o,h.shape),h);if(t){const f=_s(p.shape,a);return le(p,f)}return p}const vx=se({logSumExp_:bP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yP(s,e){const t=H(s,"a","logicalAnd","bool"),n=H(e,"b","logicalAnd","bool");Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(_g,a)}const to=se({logicalAnd_:yP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(s){const t={x:H(s,"x","logicalNot","bool")};return re.runKernel(Fg,t)}const wx=se({logicalNot_:vP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(s,e){const t=H(s,"a","logicalOr","bool"),n=H(e,"b","logicalOr","bool");Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Lg,a)}const rv=se({logicalOr_:wP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(s,e){const t=H(s,"a","logicalXor","bool"),n=H(e,"b","logicalXor","bool");return Tt(t.shape,n.shape),to(rv(s,e),wx(to(s,e)))}const aT=se({logicalXor_:NP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const om=2147483648;function SP(s,e,t="left"){const n=H(s,"sortedSequence","searchSorted"),a=H(e,"values","searchSorted"),o=n.shape[n.shape.length-1],i=a.shape[a.shape.length-1],c=le(n,[-1,o]),u=le(a,[-1,i]);if(c.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(c.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ae(u.shape)>=om)throw new Error("values tensor size must less than ".concat(om));if(c.shape[1]>=om)throw new Error("trailing dim_size must less than ".concat(om," for int32 output type, was ").concat(c.shape[1]));const h={sortedSequence:c,values:u},p={side:t};return re.runKernel($2,h,p)}const ov=se({searchSorted_:SP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CP(s,e){return ov(s,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(s,e,t,n,a){const o=H(s,"x","maxPool"),i=1;let c=o,u=!1;o.rank===3&&(u=!0,c=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(c.rank===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(c.rank,".")),V(jn(t,i),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(i,"'")),Kn("maxPool",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a},f=re.runKernel(zg,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Nx=se({maxPool_:jP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(s,e=[1,1,1],t,n,a,o="NDHWC"){const i=H(s,"x","maxPool3d");let c=i,u=!1;i.rank===4&&(u=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),V(c.rank===5,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(c.rank,".")),V(o==="NDHWC",()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),Kn("maxPool3d",n,a);const h={x:c},p={filterSize:e,strides:t,pad:n,dimRoundingMode:a,dataFormat:o},f=re.runKernel(Bg,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const rT=se({maxPool3d_:kP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(s,e,t,n,a=!1){const i={x:H(s,"x","maxPoolWithArgmax")},c={filterSize:e,strides:t,pad:n,includeBatchInIndex:a},u=re.runKernel(m2,i,c);return{result:u[0],indexes:u[1]}}const IP=se({maxPoolWithArgmax_:TP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(s,e){let t=H(s,"a","maximum"),n=H(e,"b","maximum");[t,n]=Is(t,n),t.dtype==="bool"&&(t=Xe(t,"int32"),n=Xe(n,"int32")),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(tp,a)}const Wo=se({maximum_:$P});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(s,e=null,t=!1){const a={x:H(s,"x","mean")},o={axis:e,keepDims:t};return re.runKernel(Vg,a,o)}const ks=se({mean_:AP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ys(s,e="float32"){if(Pa(s),e==="complex64"){const n=Ys(s,"float32"),a=Ys(s,"float32");return Oi(n,a)}const t=Rn(Ae(s),e);return re.makeTensor(t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(s,e="float32"){if(Pa(s),e==="complex64"){const n=ya(s,"float32"),a=Ys(s,"float32");return Oi(n,a)}const t=My(Ae(s),e);return re.makeTensor(t,s,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EP(s,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError("".concat(t," is not a valid third argument to meshgrid"));if(s===void 0)return[];let n=H(s,"x","meshgrid",s instanceof os?s.dtype:"float32");if(e===void 0)return[n];let a=H(e,"y","meshgrid",e instanceof os?e.dtype:"float32");const o=Ae(n.shape),i=Ae(a.shape);return t==="xy"?(n=le(n,[1,-1]),a=le(a,[-1,1]),[Ft(ya([i,1],n.dtype),n),Ft(a,ya([1,o],a.dtype))]):(n=le(n,[-1,1]),a=le(a,[1,-1]),[Ft(n,ya([1,i],n.dtype)),Ft(ya([o,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DP(s,e){let t=H(s,"a","minimum"),n=H(e,"b","minimum");[t,n]=Is(t,n),t.dtype==="bool"&&(t=Xe(t,"int32"),n=Xe(n,"int32")),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(sp,a)}const ql=se({minimum_:DP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(s,e,t){V(t==="reflect"||t==="symmetric",()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(t,"."));const n=H(s,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");V(e.length===n.rank,()=>"Padding doesn't match input. Must be ".concat(n.rank,". ")+"Got ".concat(e.length,"."));const a=t==="reflect"?1:0;for(let c=0;c<n.rank;c++)V(e[c].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),V(e[c][0]>=0&&e[c][0]<=n.shape[c]-a&&e[c][1]>=0&&e[c][1]<=n.shape[c]-a,()=>"Padding in dimension ".concat(c," cannot be greater than or equal ")+"to ".concat(n.shape[c]-a," or less than 0 for input of ")+"shape ".concat(n.shape));const o={paddings:e,mode:t},i={x:n};return re.runKernel(Gg,i,o)}const oT=se({mirrorPad_:RP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OP(s,e){let t=H(s,"a","mod"),n=H(e,"b","mod");[t,n]=Is(t,n);const a={a:t,b:n};return re.runKernel(np,a)}const iT=se({mod_:OP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(s,e=null,t=!1){s=H(s,"x","moments");const n=Rt(e,s.shape),a=ks(s,n,t);let o=a.shape;t||(o=_s(a.shape,n));const i=is(tt(Xe(s,"float32"),le(a,o))),c=ks(i,n,t);return{mean:a,variance:c}}const Sx=se({moments_:_P});function FP(s,e,t,n){const a=H(e,"data","multiRNNCell"),o=Lm(t,"c","multiRNNCell"),i=Lm(n,"h","multiRNNCell");let c=a;const u=[];for(let f=0;f<s.length;f++){const g=s[f](c,o[f],i[f]);u.push(g[0]),u.push(g[1]),c=g[1]}const h=[],p=[];for(let f=0;f<u.length;f+=2)h.push(u[f]),p.push(u[f+1]);return[h,p]}const LP=se({multiRNNCell_:FP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(s,e,t,n=!1){const a=H(s,"logits","multinomial"),o=a.size,i=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(o,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));t=t||Math.random();const u={logits:i===1?le(a,[1,-1]):a},h={numSamples:e,seed:t,normalized:n},p=re.runKernel(g2,u,h);return i===1?le(p,[p.size]):p}const PP=se({multinomial_:MP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(s,e){let t=H(s,"a","notEqual","string_or_numeric"),n=H(e,"b","notEqual","string_or_numeric");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n};return re.runKernel(Hg,a)}const wu=se({notEqual_:zP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(s,e,t=1,n=0,a="int32"){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const i={indices:H(s,"indices","oneHot","int32")},c={dtype:a,depth:e,onValue:t,offValue:n};return re.runKernel(Kg,i,c)}const iv=se({oneHot_:BP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VP(s){const t={x:H(s,"x","onesLike")};return re.runKernel(qg,t)}const Ma=se({onesLike_:VP});function UP(s,e){const t=H(s,"v1","outerProduct"),n=H(e,"v2","outerProduct");V(t.rank===1&&n.rank===1,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(t.rank," and ").concat(n.rank,"."));const a=le(t,[-1,1]),o=le(n,[1,-1]);return Ft(a,o)}const GP=se({outerProduct_:UP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(s,e,t=0){const n=H(s,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:t},o={x:n};return re.runKernel(Yg,o,a)}const Zi=se({pad_:WP});function HP(s,e,t=0){return V(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Zi(s,[e],t)}const qP=se({pad1d_:HP});function KP(s,e,t=0){return V(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const XP=se({pad2d_:KP});function YP(s,e,t=0){return V(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const ZP=se({pad3d_:YP});function QP(s,e,t=0){return V(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Zi(s,e,t)}const JP=se({pad4d_:QP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(s,e,t){const n=H(s,"x","spaceToBatchND");V(n.rank>=1+e.length,()=>"input rank ".concat(n.rank," should be > than [blockShape] ").concat(e.length)),V(t.length===e.length,()=>"paddings.shape[0] ".concat(t.length," must be equal to [blockShape] ").concat(e.length)),V(n.shape.reduce((i,c,u)=>u>0&&u<=e.length?i&&(c+t[u-1][0]+t[u-1][1])%e[u-1]===0:i,!0),()=>"input spatial dimensions ".concat(n.shape.slice(1)," with paddings ").concat(t.toString()," must be divisible by blockShapes ").concat(e.toString()));const a={x:n},o={blockShape:e,paddings:t};return re.runKernel(ox,a,o)}const Cx=se({spaceToBatchND_:ez});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(s,e,t,n,a,o,i){a==null&&(a=[1,1]),o==null&&(o=1),n===0&&(n="valid");const c=H(s,"x","maxPool");let u=c,h=!1;c.rank===3&&(h=!0,u=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),V(jn(o,a),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(a,"'"));const p=pr(u.shape,e,o,a,n),f=[p.dilationHeight,p.dilationWidth];let g;n==="same"?g=nz([p.filterHeight,p.filterWidth],f):g=[[0,0],[0,0]];const b=f[0]===1&&f[1]===1,[y,w]=sz([p.inHeight,p.inWidth],f,g),v=b?n:"valid",N=b?u:Cx(u,f,y),T=(t==="avg"?()=>fx(N,e,o,v,i):()=>Nx(N,e,o,v,i))(),I=b?T:mx(T,f,w);return h?le(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function sz(s,e,t){const n=t.map(p=>p[0]),a=t.map(p=>p[1]),o=s.concat(n,a),i=e.map((p,f)=>(p-o[f]%p)%p),c=a.map((p,f)=>p+i[f]),u=e.map((p,f)=>[n[f],c[f]]),h=e.map((p,f)=>[0,i[f]]);return[u,h]}function nz(s,e){const n=s.map((i,c)=>i+(i-1)*(e[c]-1)).map(i=>i-1),a=n.map(i=>Math.floor(i/2)),o=n.map((i,c)=>i-a[c]);return n.map((i,c)=>[a[c],o[c]])}const lT=se({pool_:tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(s,e){const t=H(s,"x","prelu"),n=H(e,"alpha","prelu"),a={x:t,alpha:n};return re.runKernel(Zg,a)}const jx=se({prelu_:az});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(s,e=null,t=!1){let n=H(s,"x","prod");n.dtype==="bool"&&(n=Xe(n,"int32"));const a={x:n},o={axis:e,keepDims:t};return re.runKernel(Qg,a,o)}const cT=se({prod_:rz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(s,e,t,n){const a=s.map((p,f)=>H(p,"tensors".concat(f),"raggedGather","int32")),o=H(e,"paramsDenseValues","raggedGather"),i=H(t,"indices","raggedGather","int32"),c={paramsNestedSplits:a,paramsDenseValues:o,indices:i},u={outputRaggedRank:n},h=re.runKernel(v2,c,u);return{outputNestedSplits:h.slice(0,h.length-1),outputDenseValues:h[h.length-1]}}const iz=se({raggedGather_:oz});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(s,e,t){const n=H(s,"starts","raggedRange"),a=H(e,"limits","raggedRange",n.dtype),o=H(t,"deltas","raggedRange",n.dtype),i={starts:n,limits:a,deltas:o},c=re.runKernel(w2,i);return{rtNestedSplits:c[0],rtDenseValues:c[1]}}const cz=se({raggedRange_:lz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(s,e,t,n,a){const o=H(s,"shape","raggedTensorToTensor","int32"),i=H(e,"values","raggedTensorToTensor"),c=H(t,"defaultValue","raggedTensorToTensor",i.dtype),u=n.map((f,g)=>H(f,"tensors".concat(g),"raggedTensorToTensor","int32")),h={shape:o,values:i,defaultValue:c,rowPartitionTensors:u},p={rowPartitionTypes:a};return re.runKernel(N2,h,p)}const dz=se({raggedTensorToTensor_:uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(s,e,t){Pa(s);const n=Ae(s);let a=null;if(t==null||t==="float32")a=new Float32Array(n);else if(t==="int32")a=new Int32Array(n);else if(t==="bool")a=new Uint8Array(n);else throw new Error("Unknown data type ".concat(t));for(let o=0;o<n;o++)a[o]=e();return re.makeTensor(a,s,t)}const pz=se({rand_:hz});var Nm={exports:{}},fz=Nm.exports,z4;function mz(){return z4||(z4=1,function(s){(function(e,t,n){function a(u){var h=this,p=c();h.next=function(){var f=2091639*h.s0+h.c*23283064365386963e-26;return h.s0=h.s1,h.s1=h.s2,h.s2=f-(h.c=f|0)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(u),h.s0<0&&(h.s0+=1),h.s1-=p(u),h.s1<0&&(h.s1+=1),h.s2-=p(u),h.s2<0&&(h.s2+=1),p=null}function o(u,h){return h.c=u.c,h.s0=u.s0,h.s1=u.s1,h.s2=u.s2,h}function i(u,h){var p=new a(u),f=h&&h.state,g=p.next;return g.int32=function(){return p.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.quick=g,f&&(typeof f=="object"&&o(f,p),g.state=function(){return o(p,{})}),g}function c(){var u=4022871197,h=function(p){p=String(p);for(var f=0;f<p.length;f++){u+=p.charCodeAt(f);var g=.02519603282416938*u;u=g>>>0,g-=u,g*=u,u=g>>>0,g-=u,u+=g*4294967296}return(u>>>0)*23283064365386963e-26};return h}t&&t.exports?t.exports=i:this.alea=i})(fz,s)}(Nm)),Nm.exports}var Sm={exports:{}},gz=Sm.exports,B4;function xz(){return B4||(B4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},c===(c|0)?u.x=c:h+=c;for(var p=0;p<h.length+64;p++)u.x^=h.charCodeAt(p)|0,u.next()}function o(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xor128=i})(gz,s)}(Sm)),Sm.exports}var Cm={exports:{}},bz=Cm.exports,V4;function yz(){return V4||(V4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,c===(c|0)?u.x=c:h+=c;for(var p=0;p<h.length+64;p++)u.x^=h.charCodeAt(p)|0,p==h.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u.v=c.v,u.d=c.d,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xorwow=i})(bz,s)}(Cm)),Cm.exports}var jm={exports:{}},vz=jm.exports,U4;function wz(){return U4||(U4=1,function(s){(function(e,t,n){function a(c){var u=this;u.next=function(){var p=u.x,f=u.i,g,b;return g=p[f],g^=g>>>7,b=g^g<<24,g=p[f+1&7],b^=g^g>>>10,g=p[f+3&7],b^=g^g>>>3,g=p[f+4&7],b^=g^g<<7,g=p[f+7&7],g=g^g<<13,b^=g^g<<9,p[f]=b,u.i=f+1&7,b};function h(p,f){var g,b=[];if(f===(f|0))b[0]=f;else for(f=""+f,g=0;g<f.length;++g)b[g&7]=b[g&7]<<15^f.charCodeAt(g)+b[g+1&7]<<13;for(;b.length<8;)b.push(0);for(g=0;g<8&&b[g]===0;++g);for(g==8?b[7]=-1:b[g],p.x=b,p.i=0,g=256;g>0;--g)p.next()}h(u,c)}function o(c,u){return u.x=c.x.slice(),u.i=c.i,u}function i(c,u){c==null&&(c=+new Date);var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(p.x&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xorshift7=i})(vz,s)}(jm)),jm.exports}var km={exports:{}},Nz=km.exports,G4;function Sz(){return G4||(G4=1,function(s){(function(e,t,n){function a(c){var u=this;u.next=function(){var p=u.w,f=u.X,g=u.i,b,y;return u.w=p=p+1640531527|0,y=f[g+34&127],b=f[g=g+1&127],y^=y<<13,b^=b<<17,y^=y>>>15,b^=b>>>12,y=f[g]=y^b,u.i=g,y+(p^p>>>16)|0};function h(p,f){var g,b,y,w,v,N=[],C=128;for(f===(f|0)?(b=f,f=null):(f=f+"\0",b=0,C=Math.max(C,f.length)),y=0,w=-32;w<C;++w)f&&(b^=f.charCodeAt((w+32)%f.length)),w===0&&(v=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,w>=0&&(v=v+1640531527|0,g=N[w&127]^=b+v,y=g==0?y+1:0);for(y>=128&&(N[(f&&f.length||0)&127]=-1),y=127,w=4*128;w>0;--w)b=N[y+34&127],g=N[y=y+1&127],b^=b<<13,g^=g<<17,b^=b>>>15,g^=g>>>12,N[y]=b^g;p.w=v,p.X=N,p.i=y}h(u,c)}function o(c,u){return u.i=c.i,u.w=c.w,u.X=c.X.slice(),u}function i(c,u){c==null&&(c=+new Date);var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(p.X&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.xor4096=i})(Nz,s)}(km)),km.exports}var Tm={exports:{}},Cz=Tm.exports,W4;function jz(){return W4||(W4=1,function(s){(function(e,t,n){function a(c){var u=this,h="";u.next=function(){var f=u.b,g=u.c,b=u.d,y=u.a;return f=f<<25^f>>>7^g,g=g-b|0,b=b<<24^b>>>8^y,y=y-f|0,u.b=f=f<<20^f>>>12^g,u.c=g=g-b|0,u.d=b<<16^g>>>16^y,u.a=y-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,c===Math.floor(c)?(u.a=c/4294967296|0,u.b=c|0):h+=c;for(var p=0;p<h.length+20;p++)u.b^=h.charCodeAt(p)|0,u.next()}function o(c,u){return u.a=c.a,u.b=c.b,u.c=c.c,u.d=c.d,u}function i(c,u){var h=new a(c),p=u&&u.state,f=function(){return(h.next()>>>0)/4294967296};return f.double=function(){do var g=h.next()>>>11,b=(h.next()>>>0)/4294967296,y=(g+b)/(1<<21);while(y===0);return y},f.int32=h.next,f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}t&&t.exports?t.exports=i:this.tychei=i})(Cz,s)}(Tm)),Tm.exports}var Im={exports:{}};const kz={},Tz=Object.freeze(Object.defineProperty({__proto__:null,default:kz},Symbol.toStringTag,{value:"Module"})),Iz=T6(Tz);var $z=Im.exports,H4;function Az(){return H4||(H4=1,function(s){(function(e,t,n){var a=256,o=6,i=52,c="random",u=n.pow(a,o),h=n.pow(2,i),p=h*2,f=a-1,g;function b(I,$,R){var O=[];$=$==!0?{entropy:!0}:$||{};var P=N(v($.entropy?[I,T(t)]:I==null?C():I,3),O),_=new y(O),M=function(){for(var A=_.g(o),U=u,K=0;A<h;)A=(A+K)*a,U*=a,K=_.g(1);for(;A>=p;)A/=2,U/=2,K>>>=1;return(A+K)/U};return M.int32=function(){return _.g(4)|0},M.quick=function(){return _.g(4)/4294967296},M.double=M,N(T(_.S),t),($.pass||R||function(A,U,K,Q){return Q&&(Q.S&&w(Q,_),A.state=function(){return w(_,{})}),K?(n[c]=A,U):A})(M,P,"global"in $?$.global:this==n,$.state)}function y(I){var $,R=I.length,O=this,P=0,_=O.i=O.j=0,M=O.S=[];for(R||(I=[R++]);P<a;)M[P]=P++;for(P=0;P<a;P++)M[P]=M[_=f&_+I[P%R]+($=M[P])],M[_]=$;(O.g=function(A){for(var U,K=0,Q=O.i,X=O.j,B=O.S;A--;)U=B[Q=f&Q+1],K=K*a+B[f&(B[Q]=B[X=f&X+U])+(B[X]=U)];return O.i=Q,O.j=X,K})(a)}function w(I,$){return $.i=I.i,$.j=I.j,$.S=I.S.slice(),$}function v(I,$){var R=[],O=typeof I,P;if($&&O=="object")for(P in I)try{R.push(v(I[P],$-1))}catch(_){}return R.length?R:O=="string"?I:I+"\0"}function N(I,$){for(var R=I+"",O,P=0;P<R.length;)$[f&P]=f&(O^=$[f&P]*19)+R.charCodeAt(P++);return T($)}function C(){try{var I;return g&&(I=g.randomBytes)?I=I(a):(I=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(I)),T(I)}catch(O){var $=e.navigator,R=$&&$.plugins;return[+new Date,e,R,e.screen,T(t)]}}function T(I){return String.fromCharCode.apply(0,I)}if(N(n.random(),t),s.exports){s.exports=b;try{g=Iz}catch(I){}}else n["seed"+c]=b})(typeof self<"u"?self:$z,[],Math)}(Im)),Im.exports}var f1,q4;function Ez(){if(q4)return f1;q4=1;var s=mz(),e=xz(),t=yz(),n=wz(),a=Sz(),o=jz(),i=Az();return i.alea=s,i.xor128=e,i.xorwow=t,i.xorshift7=n,i.xor4096=a,i.tychei=o,f1=i,f1}var kx=Ez();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lv{constructor(e,t,n,a,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=kx.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,t,n=!1;for(;!n;){let a,o,i;do a=2*this.random()-1,o=2*this.random()-1,i=a*a+o*o;while(i>=1||i===0);const c=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*c,t=this.mean+this.stdDev*o*c,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Dz{constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;const o=a||Math.random();this.randu=kx.alea(o.toString()),this.randn=new lv(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,a,o,i;for(;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0);if(i*=i*i,e=a*a,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<t||Math.log(o)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Rz{constructor(e=0,t=1,n,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=kx.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(s,e,t=1,n="float32",a){if(Pa(s),t==null&&(t=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type ".concat(n));const o=new Dz(e,t,n,a),i=Dt(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const _z=se({randomGamma_:Oz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(s,e=0,t=1,n,a){if(Pa(s),n!=null&&n==="bool")throw new Error("Unsupported data type ".concat(n));const o=new lv(e,t,n,!1,a),i=Dt(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const cv=se({randomNormal_:Fz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(s,e,t){if(e!=null&&e==="bool")throw new Error("Unsupported data type ".concat(e));return cv(s,0,1,e,t)}const Mz=se({randomStandardNormal_:Lz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(s,e=0,t=1,n="float32",a){Pa(s);const o=Dt(s,n),i=new Rz(e,t,null,a);for(let c=0;c<o.values.length;c++)o.values[c]=i.nextValue();return o.toTensor()}const sc=se({randomUniform_:Pz});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(s,e,t,n){return sc(s,e,t,"int32",n)}const Bz=se({randomUniformInt_:zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nu(s,e,t=1,n="float32"){if(t===0)throw new Error("Cannot have a step of zero");const a={start:s,stop:e,step:t,dtype:n};return re.runKernel(S2,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(s){const t={input:H(s,"input","real")};return re.runKernel(C2,t)}const gh=se({real_:Vz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(s){const t={x:H(s,"x","reciprocal")};return re.runKernel(op,t)}const uT=se({reciprocal_:Uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(s){const t={x:H(s,"x","relu")};return re.runKernel(ip,t)}const ro=se({relu_:Gz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(s){const t={x:H(s,"x","relu6")};return re.runKernel(lp,t)}const uv=se({relu6_:Wz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(s,e){const n={x:H(s,"x","reverse")},a={dims:e};return re.runKernel(sx,n,a)}const dr=se({reverse_:Hz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qz(s){const e=H(s,"x","reverse");return V(e.rank===1,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")),dr(e,0)}const Kz=se({reverse1d_:qz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(s,e){const t=H(s,"x","reverse");return V(t.rank===2,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(t.rank,".")),dr(t,e)}const Yz=se({reverse2d_:Xz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(s,e){const t=H(s,"x","reverse");return V(t.rank===3,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(t.rank,".")),dr(t,e)}const Qz=se({reverse3d_:Zz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(s,e){const t=H(s,"x","reverse");return V(t.rank===4,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(t.rank,".")),dr(t,e)}const eB=se({reverse4d_:Jz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(s){const t={x:H(s,"x","round")};return re.runKernel(cp,t)}const dv=se({round_:tB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sB(s){const t={x:H(s,"x","rsqrt","float32")};return re.runKernel(up,t)}const hv=se({rsqrt_:sB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(s){const t={x:H(s,"x","selu")};return re.runKernel(dp,t)}const pv=se({selu_:nB});function aB(s,e,t,n,a,o=[1,1],i="NHWC"){const c=H(s,"x","separableConv2d"),u=H(e,"depthwiseFilter","separableConv2d"),h=H(t,"pointwiseFilter","separableConv2d");let p=c,f=!1;if(c.rank===3&&(f=!0,p=le(c,[1,c.shape[0],c.shape[1],c.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");V(p.rank===4,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")),V(u.rank===4,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")),V(h.rank===4,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")),V(h.shape[0]===1,()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(h.shape[0],".")),V(h.shape[1]===1,()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(h.shape[1],"."));const g=u.shape[2],b=u.shape[3];V(h.shape[2]===g*b,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(g*b,", ")+"but got ".concat(h.shape[2],"."));const y=Tp(p,u,n,a,i,o),v=Li(y,h,1,"valid",i);return f?le(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const fv=se({separableConv2d_:aB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function rB(s,e){const t=H(s,"x","setdiff1d"),n=H(e,"y","setdiff1d");V(t.dtype===n.dtype,()=>"x and y should have the same dtype, but got x (".concat(t.dtype,") and y (").concat(n.dtype,").")),V(t.rank===1,()=>"x should be 1D tensor, but got x (".concat(t.shape,").")),V(n.rank===1,()=>"y should be 1D tensor, but got y (".concat(n.shape,")."));const a=await t.data(),o=await n.data(),i=new Set(o);let c=0;for(let p=0;p<a.length;p++)i.has(a[p])||c++;const u=new Js([c],t.dtype),h=new Js([c],"int32");for(let p=0,f=0;p<a.length;p++)i.has(a[p])||(u.values[f]=a[p],h.values[f]=p,f++);return[u.toTensor(),h.toTensor()]}const oB=rB;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(s){const t={x:H(s,"x","sign")};return re.runKernel(fp,t)}const dT=se({sign_:iB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(s){const t={x:H(s,"x","sin","float32")};return re.runKernel(hp,t)}const mv=se({sin_:lB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(s){const t={x:H(s,"x","sinh")};return re.runKernel(pp,t)}const gv=se({sinh_:cB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(s,e,t){const n=H(s,"x","slice1d");return V(n.rank===1,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(n.rank," tensor")),yt(n,[e],[t])}const Tx=se({slice1d_:uB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(s,e,t){const n=H(s,"x","slice2d");return V(n.rank===2,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(n.rank," tensor")),yt(n,e,t)}const xv=se({slice2d_:dB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(s,e,t){const n=H(s,"x","slice3d");return V(n.rank===3,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(n.rank," tensor")),yt(n,e,t)}const Ix=se({slice3d_:hB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(s,e,t){const n=H(s,"x","slice4d");return V(n.rank===4,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(n.rank," tensor")),yt(n,e,t)}const xh=se({slice4d_:pB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(s,e=-1){const t=H(s,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(t.rank," and dim was ").concat(e));const n={logits:t},a={dim:e};return re.runKernel(lx,n,a)}const $x=se({softmax_:fB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(s){V(s.dtype==="complex64",()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(s.dtype,"."));const e={input:s};return re.runKernel(r2,e)}const Ax=se({fft_:mB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(s){V(s.dtype==="complex64",()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(s.dtype,"."));const e={input:s};return re.runKernel(c2,e)}const bh=se({ifft_:gB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xB(s){const e=s.shape[s.shape.length-1],t=s.size/e;let n;if(e<=2){const a=le(s,[t,e]);n=bh(a)}else{const a=[t,2*(e-1)],o=le(gh(s),[t,e]),i=le(xx(s),[t,e]),c=dr(yt(o,[0,1],[t,e-2]),1),u=ae(dr(yt(i,[0,1],[t,e-2]),1),gt(-1)),h=Ts([o,c],1),p=Ts([i,u],1),f=le(Oi(h,p),[a[0],a[1]]);n=bh(f)}if(n=gh(n),s.rank===3&&s.shape[0]!==0){const a=n,o=s.shape[0];n=le(n,[o,n.shape[0]/o,n.shape[1]]),a.dispose()}return n}const bv=se({irfft_:xB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(s,e,t=0){const a={x:H(s,"x","split")},o={numOrSizeSplits:e,axis:t};return re.runKernel(ix,a,o)}const va=se({split_:bB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(s,e){V(s.dtype==="float32",()=>"The dtype for rfft() must be real value but got ".concat(s.dtype));let t=s.shape[s.shape.length-1];const n=s.size/t;let a;if(e!=null&&e<t){const y=s.shape.map(v=>0),w=s.shape.map(v=>v);w[s.shape.length-1]=e,a=yt(s,y,w),t=e}else if(e!=null&&e>t){const y=s.shape.map(w=>w);y[s.shape.length-1]=e-t,a=Ts([s,Ys(y)],s.shape.length-1),t=e}else a=s;const o=Vt(a),i=le(Oi(a,o),[n,t]),c=Ax(i),u=Math.floor(t/2)+1,h=gh(c),p=xx(c),f=va(h,[u,t-u],h.shape.length-1),g=va(p,[u,t-u],p.shape.length-1),b=a.shape.slice();return b[a.shape.length-1]=u,le(Oi(f[0],g[0]),b)}const Ex=se({rfft_:yB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(s,e){let t=H(s,"a","squaredDifference"),n=H(e,"b","squaredDifference");[t,n]=Is(t,n),Tt(t.shape,n.shape);const a={a:t,b:n},o={};return re.runKernel(bp,a,o)}const yv=se({squaredDifference_:vB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(s,e){const t=H(s,"x","squeeze","string_or_numeric");return le(t,Gi(t.shape,e).newShape)}const Rs=se({squeeze_:wB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(s,e=0){const t=Lm(s,"tensors","stack","string_or_numeric");V(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&V(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const n=t,a={axis:e};return re.runKernel(Xg,n,a)}const Na=se({stack_:NB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(s,e=0){const n={x:H(s,"x","step")},a={alpha:e};return re.runKernel(Sp,n,a)}const Fu=se({step_:SB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CB(s,e,t,n,a=0,o=0,i=0,c=0,u=0){const p={x:H(s,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:n,beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:c,shrinkAxisMask:u};return re.runKernel(F2,p,f)}const hT=se({stridedSlice_:CB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(s){const t={x:H(s,"x","tan","float32")};return re.runKernel(vp,t)}const pT=se({tan_:jB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Us(s,e){Au(s);const t=Hi(s,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return qi(s,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _l(s,e,t){if(Au(s),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const n=Hi(s,t);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(s,e,t){if(Au(s),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const n=Hi(s,t);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(s,e,t){if(Au(s),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const n=Hi(s,t);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TB(s,e,t){if(Au(s),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const n=Hi(s,t);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return qi(s,e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IB(s,e,t){if(Au(s),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const n=Hi(s,t);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||n,qi(s,e,n,t)}function mT(s,e,t){const n=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(t.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(s)+", sliceDim: ".concat(n,", and batchDim: ").concat(a,".");if(t.rank<a)throw new Error(o+" update.rank < ".concat(a,". "));if(s.length<n+(t.rank-a))throw new Error(o+" Output shape length < ".concat(n+(t.rank-a)));if(t.rank!==a+s.length-n)throw new Error(o+" update.rank != ".concat(a+s.length-n));for(let i=0;i<a;++i)if(t.shape[i]!==e.shape[i])throw new Error(o+" updates.shape[".concat(i,"] (").concat(t.shape[i],") != indices.shape[").concat(i,"] (").concat(e.shape[i],")."));for(let i=0;i<t.rank-a;++i)if(t.shape[i+a]!==s[i+n])throw new Error(o+" updates.shape[".concat(i+a,"] (").concat(t.shape[i+a],") != shape[").concat(i+a,"] (").concat(s[i+a],")"))}function vv(s,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(s.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(s.rank,"."));if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(t));if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(s.size===0)throw new Error("Updates specified for empty output. updates shape: ".concat(s.shape))}mT(t,e,s)}function nc(s,e,t){const n=e.shape.length,a=n>1?e.shape[n-1]:1,o=t.length;let i=1;for(let f=a;f<o;++f)i*=t[f];const c=a<1?1:a,u=Ae(e.shape)/c,h=[...ft(t.slice(0,a)),1],p=Ae(t);return{sliceRank:a,numUpdates:u,sliceSize:i,strides:h,outputSize:p}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(s,e,t){const n=H(s,"tensor","tensorScatterupdate"),a=H(e,"indices","tensorScatterupdate","int32"),o=H(t,"updates","tensorScatterupdate");if(vv(o,a,n.shape),n.dtype!==o.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(n.dtype," and ").concat(o.dtype,"."));const i={tensor:n,indices:a,updates:o},c={};return re.runKernel(I2,i,c)}const AB=se({tensorScatterUpdate_:$B});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(s,e=1,t=!0){const n=H(s,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=n.shape[n.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(e));const o={x:n},i={k:e,sorted:t},[c,u]=re.runKernel(z2,o,i);return{values:c,indices:u}}const gT=se({topk_:EB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(s,e=0,t=1,n,a){if(Pa(s),n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new lv(e,t,n,!0,a),i=Dt(s,n);for(let c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}const wv=se({truncatedNormal_:DB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(s,e=0){const t=H(s,"x","unique","string_or_numeric");V(t.rank>0,()=>"The input tensor must be at least 1D");const n={x:t},a={axis:e},[o,i]=re.runKernel(V2,n,a);return{values:o,indices:i}}const xT=se({unique_:RB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OB(s,e,t){const n=H(s,"x","unsortedSegmentSum"),a=H(e,"segmentIds","unsortedSegmentSum","int32");V(xu(t),()=>"numSegments must be of dtype int");const o={x:n,segmentIds:a},i={numSegments:t};return re.runKernel(dx,o,i)}const Nv=se({unsortedSegmentSum_:OB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(s,e=0){const t=H(s,"x","unstack","string_or_numeric");V(e>=-t.shape.length&&e<t.shape.length,()=>"Axis = ".concat(e," is not in [-").concat(t.shape.length,", ").concat(t.shape.length,")"));const n={value:t},a={axis:e};return re.runKernel(ux,n,a)}const hr=se({unstack_:_B});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FB(s,e){return ov(s,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bT(s,e=!0,t,n){return re.makeVariable(s,e,t,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sv(s,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const n=Dt(s,"int32"),a=Dt([t.length,s.length],"int32");for(let o=0;o<t.length;o++){const i=n.indexToLoc(t[o]),c=o*s.length;a.values.set(i,c)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function LB(s){const e=H(s,"condition","whereAsync","bool"),t=await e.data(),n=Sv(e.shape,t);return s!==e&&e.dispose(),n}const yT=LB;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MB(s,e,t){const n=H(s,"tensor","boolMask"),a=H(e,"mask","boolMask","bool"),o=t==null?0:t,i=a.rank,c=n.shape;V(i>0,()=>"mask cannot be scalar"),ja(c.slice(o,o+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let w=o;w<o+i;w++)u*=c[w];const h=c.slice(0,o).concat([u],c.slice(o+i)),p=le(n,h),f=le(a,[-1]),g=await yT(f),b=Rs(g,[1]),y=Ep(p,b,o);return s!==n&&n.dispose(),e!==a&&a.dispose(),b.dispose(),p.dispose(),f.dispose(),g.dispose(),y}const PB=MB;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(s,e,t){const n=H(s,"x","transpose");if(e==null&&(e=n.shape.map((i,c)=>c).reverse()),V(n.rank===e.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(e,".")),e.forEach(i=>{V(i>=0&&i<n.rank,()=>"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(e))}),n.rank<=1)return n.clone();const a={x:n},o={perm:e};return n.dtype==="complex64"?me(()=>{let i=gh(n),c=xx(n);return i=re.runKernel(du,{x:i},o),c=re.runKernel(du,{x:c},o),t&&(c=fs(c)),Oi(i,c)}):re.runKernel(du,a,o)}const Bt=se({transpose_:zB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(s,e,t,n,a=!0){const o=H(s,"v","movingAverage"),i=H(e,"x","movingAverage"),c=H(t,"decay","movingAverage");k7(o,i),V(zt(o.shape,i.shape),()=>"Shape mismatch in v and x");const u=gt(1),h=tt(u,c);let p=ae(tt(i,o),h);if(a){V(n!=null,()=>"When using zeroDebias: true, step is required.");const f=H(n,"step","movingAverage");p=Qe(p,tt(u,_o(c,f)))}return Me(o,p)}const VB=se({movingAverage_:BB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(s,e,t){Pa(t);const n=H(s,"indices","scatterND","int32"),a=H(e,"updates","scatterND");vv(a,n,t);const o={indices:n,updates:a},i={shape:t};return re.runKernel(T2,o,i)}const GB=se({scatterND_:UB});function WB(s,e,t,n){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(s.dtype,"."));if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(s.shape,"."));const a=s.rank>0?s.shape[0]:1,o=s.rank>1?s.shape[1]:1;if(t.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(t.length,", should be: ").concat(o,"."));const i=e.size;if(!(e.rank===0||e.rank===1&&i===a))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(a,"]"));if(e.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(s,e,t,n=0){Pa(t);const a=H(s,"sparseIndices","sparseToDense","int32"),o=H(e,"sparseValues","sparseToDense","string_or_numeric"),i=H(n,"defaultValue","sparseToDense",o.dtype);WB(a,o,t,i);const c={sparseIndices:a,sparseValues:o,defaultValue:i},u={outputShape:t};return re.runKernel(O2,c,u)}const qB=se({sparseToDense_:HB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(s,e){const t=H(e,"indices","gatherND","int32"),a={params:H(s,"x","gatherND","string_or_numeric"),indices:t};return re.runKernel(l2,a)}const XB=se({gatherND_:KB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(s,e){if(e==null)return s.shape.slice();if(zt(s.shape,e))return e;if(s.shape.length===e.length){const t=[];for(let n=0;n<s.shape.length;n++)e[n]==null&&s.shape[n]!=null?t.push(s.shape[n]):t.push(e[n]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(s,e,t,n){const a=H(s,"x","dropout");if(V(a.dtype==="float32",()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")),V(e>=0&&e<1,()=>"rate must be a float in the range [0, 1), but got ".concat(e,".")),e===0)return s instanceof os?a.clone():a;const o=YB(a,t),i=1-e,c=Qe(Ap(Me(sc(o,0,1,"float32",n),i)),i);return ae(a,c)}const vT=se({dropout_:ZB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(s){return Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2))))}function Cv(s,e,t){const n=1-s%2,a=new Float32Array(s);for(let o=0;o<s;++o){const i=2*Math.PI*o/(s+n-1);a[o]=e-t*Math.cos(i)}return Us(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function QB(s,e,t=1){const n=H(s,"predictions","inTopK"),a=H(e,"targets","inTopK");V(n.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(n.rank)),V(n.rank-1===a.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(n.rank," and targets rank ").concat(a.rank)),ja(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=n.shape[n.shape.length-1];V(t>0&&t<=o,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(t));const i=await n.data(),c=await a.data(),[u,h]=[i.length/o,o],p=Sn("bool",u);for(let f=0;f<u;f++){const g=f*h,b=i.subarray(g,g+h),y=[];for(let w=0;w<b.length;w++)y.push({value:b[w],index:w});y.sort((w,v)=>v.value-w.value),p[f]=0;for(let w=0;w<t;w++)if(y[w].index===c[f]){p[f]=1;break}}return s!==n&&n.dispose(),e!==a&&a.dispose(),jr(p,a.shape,"bool")}const JB=QB;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(s,e,t,n,a,o="NHWC",i){let c=s;s.rank===3&&(c=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let u=e;u.rank===3&&(u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]])),V(c.rank===4,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(c.shape,".")),V(u.rank===4,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")),V(t.length===4,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(t,"."));const h=o==="NHWC"?c.shape[3]:c.shape[1],p=o==="NHWC"?u.shape[3]:u.shape[1];V(h===t[2],()=>"Error in conv2dDerFilter: depth of input ".concat(h,") must ")+"match input depth in filter (".concat(t[2],".")),V(p===t[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(p,") must ")+"match output depth for filter (".concat(t[3],").")),Kn("conv2dDerFilter",a,i);const f={x:c,dy:u},g={strides:n,pad:a,dataFormat:o,dimRoundingMode:i,filterShape:t};return re.runKernel(qy,f,g)}const jv=se({conv2DBackpropFilter_:e9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dx(s,e,t){if(t==null||t==="linear")return s;if(t==="relu")return ae(s,Fu(e));throw new Error("Cannot compute gradient for fused activation ".concat(t,"."))}function Rx(s,e){let t=e;const n=sn(s.shape,e.shape);return n.length>0&&(t=it(t,n)),le(t,s.shape)}function Ox(s,e,t,n){if(e==="linear")return s;if(e==="relu")return ro(s);if(e==="elu")return Ip(s);if(e==="relu6")return uv(s);if(e==="prelu")return jx(s,t);if(e==="leakyrelu")return bx(s,n);if(e==="sigmoid")return kr(s);throw new Error("Unknown fused activation ".concat(e,"."))}const _x=(s,e)=>!(s>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9({x:s,filter:e,strides:t,pad:n,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:c,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:p}){if(u=u||"linear",_x(re.state.gradientDepth,u)===!1){V(a==="NHWC",()=>"Error in fused conv2d: got dataFormat of ".concat(a," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let R=Li(s,e,t,n,a,o,i);return c!=null&&(R=Me(R,c)),Ox(R,u,h,p)}const f=H(s,"x","conv2d","float32"),g=H(e,"filter","conv2d","float32");let b=f,y=!1;f.rank===3&&(y=!0,b=le(f,[1,f.shape[0],f.shape[1],f.shape[2]])),V(b.rank===4,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(b.rank,".")),V(g.rank===4,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")),Kn("fused conv2d",n,i);const w=a==="NHWC"?b.shape[3]:b.shape[1];V(g.shape[2]===w,()=>"Error in conv2d: depth of input (".concat(w,") must match ")+"input depth for filter ".concat(g.shape[2],".")),V(jn(t,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(t," and dilations '").concat(o,"'"));const v=mn(b.shape,g.shape,t,o,n,i);let N;c!=null&&(N=H(c,"bias","fused conv2d"),[N]=Is(N,f),a==="NHWC"?Tt(v.outShape,N.shape):(V(N.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(N.shape.length,".")),V(N.shape.length===0||N.shape[0]===v.outChannels||N.shape[0]===1,()=>"Error in fused conv2d: bias shape (".concat(N.shape,") is not ")+"compatible with the number of output channels "+"(".concat(v.outChannels,")"))));let C;if(h!=null){const R=h.shape;if(V(R.length<=1||R.length===3,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(R.length,".")),R.length===1)V(R[0]===1||R[0]===v.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(R,") is not compatible with the number of output ")+"channels (".concat(v.outChannels,")."));else if(R.length===3)try{Tt(R,v.outShape)}catch(O){const P="Error in fused conv2d: PReLU activation weights (".concat(R,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(v.outShape,").");throw Error(P)}C=H(h,"prelu weights","fused conv2d")}const T=(R,O)=>{V(a==="NHWC",()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported."));const[P,_,M,A]=O,U=Dx(R,M,u);V(Fi(o),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'"));const K=Z2(_.shape,U,P,t,n),Q=jv(_,U,P.shape,t,n),X=[K,Q];if(A!=null){const B=Rx(A,U);X.push(B)}return X},I={x:b,filter:g,bias:N,preluActivationWeights:C},$={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:p};return c==null?Fo((O,P,_)=>{let M=re.runKernel(Rm,I,$);return _([P,O,M]),y&&(M=le(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:T}})(b,g):Fo((O,P,_,M)=>{let A=re.runKernel(Rm,I,$);return M([P,O,A,_]),y&&(A=le(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:T}})(b,g,N)}const NT=se({fusedConv2d_:t9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(s,e,t,n,a,o=[1,1],i){let c=s;s.rank===3&&(c=le(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let u=e;u.rank===3&&(u=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={x:c,dy:u},p={strides:n,pad:a,dimRoundingMode:i,dilations:o,filterShape:t};return re.runKernel(e2,h,p)}const ST=se({depthwiseConv2dNativeBackpropFilter_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(s,e,t,n,a,o=[1,1],i){let c=e,u=!1;e.rank===3&&(u=!0,c=le(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={dy:c,filter:t},p={strides:n,pad:a,dimRoundingMode:i,dilations:o,inputShape:s},f=re.runKernel(t2,h,p);return u?le(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const CT=se({depthwiseConv2dNativeBackpropInput_:n9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9({x:s,filter:e,strides:t,pad:n,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:c,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:p}){if(_x(re.state.gradientDepth,u)===!1){let $=Tp(s,e,t,n,a,o,i);return c!=null&&($=Me($,c)),Ox($,u,h,p)}const f=H(s,"x","depthwiseConv2d","float32"),g=H(e,"filter","depthwiseConv2d","float32");let b=f,y=!1;f.rank===3&&(y=!0,b=le(f,[1,f.shape[0],f.shape[1],f.shape[2]])),V(b.rank===4,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(b.rank,".")),V(g.rank===4,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")),V(b.shape[3]===g.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(b.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")),o==null&&(o=[1,1]),V(jn(t,o),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(t," and dilations '").concat(o,"'")),Kn("fused depthwiseConv2d",n,i);const w=mn(b.shape,g.shape,t,o,n,i,!0);let v;c!=null&&(v=H(c,"bias","fused conv2d"),[v]=Is(v,f),Tt(w.outShape,v.shape));let N;h!=null&&(N=H(h,"prelu weights","fused depthwiseConv2d"));const C=($,R)=>{V(Fi(o),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'"));const[O,P,_,M]=R,A=Dx($,_,u),U=CT(P.shape,A,O,t,n,o,i),K=ST(P,A,O.shape,t,n,o,i);if(M!=null){const Q=Rx(v,A);return[U,K,Q]}return[U,K]},T={x:b,filter:g,bias:v,preluActivationWeights:N},I={strides:t,pad:n,dataFormat:a,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:p};return c==null?Fo((R,O,P)=>{let _=re.runKernel(Om,T,I);return P([O,R,_]),y&&(_=le(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:C}})(b,g):Fo((R,O,P,_)=>{let M=re.runKernel(Om,T,I);return _([O,R,M,P]),y&&(M=le(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:C}})(b,g,v)}const r9=se({fusedDepthwiseConv2d_:a9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9({a:s,b:e,transposeA:t=!1,transposeB:n=!1,bias:a,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:c=.2}){if(_x(re.state.gradientDepth,o)===!1){let A=Ft(s,e,t,n);return a!=null&&(A=Me(A,a)),Ox(A,o,i,c)}let u=H(s,"a","fused matMul"),h=H(e,"b","fused matMul");[u,h]=Is(u,h);const p=t?u.shape[u.rank-2]:u.shape[u.rank-1],f=n?h.shape[h.rank-1]:h.shape[h.rank-2],g=t?u.shape[u.rank-1]:u.shape[u.rank-2],b=n?h.shape[h.rank-2]:h.shape[h.rank-1],y=u.shape.slice(0,-2),w=h.shape.slice(0,-2),v=Ae(y),N=Ae(w);V(p===f,()=>"Error in fused matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(u.shape," and ")+"".concat(h.shape," and transposeA=").concat(t)+" and transposeB=".concat(n," must match."));const T=Tt(u.shape.slice(0,-2),h.shape.slice(0,-2)).concat([g,b]),I=t?le(u,[v,p,g]):le(u,[v,g,p]),$=n?le(h,[N,b,f]):le(h,[N,f,b]);let R;a!=null&&(R=H(a,"bias","fused matMul"),[R]=Is(R,u),Tt(T,R.shape));let O;i!=null&&(O=H(i,"prelu weights","fused matMul"));const P=(A,U)=>{const[K,Q,X,B]=U,G=Dx(le(A,X.shape),X,o);let Y,Z;if(!t&&!n?(Y=Ft(G,Q,!1,!0),Z=Ft(K,G,!0,!1)):!t&&n?(Y=Ft(G,Q,!1,!1),Z=Ft(G,K,!0,!1)):t&&!n?(Y=Ft(Q,G,!1,!0),Z=Ft(K,G,!1,!1)):(Y=Ft(Q,G,!0,!0),Z=Ft(G,K,!0,!0)),a!=null){const J=Rx(B,G);return[Y,Z,J]}else return[Y,Z]},_={a:I,b:$,bias:R,preluActivationWeights:O},M={transposeA:t,transposeB:n,activation:o,leakyreluAlpha:c};return a==null?Fo((U,K,Q)=>{const X=re.runKernel(Dm,_,M);return Q([U,K,X]),{value:le(X,T),gradFunc:P}})(I,$):Fo((U,K,Q,X)=>{const B=re.runKernel(Dm,_,M);return X([U,K,B,Q]),{value:le(B,T),gradFunc:P}})(I,$,R)}const ty=se({fusedMatMul_:o9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9=Object.freeze(Object.defineProperty({__proto__:null,conv2d:NT,depthwiseConv2d:r9,matMul:ty},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(s){return Cv(s,.54,.46)}const c9=se({hammingWindow_:l9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(s){return Cv(s,.5,.5)}const jT=se({hannWindow_:u9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(s,e,t,n=!1,a=0){let o=0;const i=[];for(;o+e<=s.size;)i.push(yt(s,o,e)),o+=t;if(n)for(;o<s.size;){const c=o+e-s.size,u=Ts([yt(s,o,e-c),Ou([c],a)]);i.push(u),o+=t}return i.length===0?_l([],[0,e]):le(Ts(i),[i.length,e])}const kT=se({frame_:d9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(s,e,t,n,a=jT){n==null&&(n=wT(e));const o=kT(s,e,t),i=ae(o,a(e));return Ex(i,n)}const p9=se({stft_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(s,e,t,n,a="bilinear",o=0){const i=H(s,"image","cropAndResize"),c=H(e,"boxes","cropAndResize","float32"),u=H(t,"boxInd","cropAndResize","int32"),h=c.shape[0];V(i.rank===4,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")),V(c.rank===2&&c.shape[1]===4,()=>"Error in cropAndResize: boxes must be have size [".concat(h,",4] ")+"but had shape ".concat(c.shape,".")),V(u.rank===1&&u.shape[0]===h,()=>"Error in cropAndResize: boxInd must be have size [".concat(h,"] ")+"but had shape ".concat(c.shape,".")),V(n.length===2,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(n.length,".")),V(n[0]>=1&&n[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(n)),V(a==="bilinear"||a==="nearest",()=>"method must be bilinear or nearest, but was ".concat(a));const p={image:i,boxes:c,boxInd:u},f={method:a,extrapolationValue:o,cropSize:n};return re.runKernel(Zy,p,f)}const m9=se({cropAndResize_:f9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(s){const e=H(s,"image","flipLeftRight","float32");V(e.rank===4,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,"."));const t={image:e};return re.runKernel(i2,t,{})}const x9=se({flipLeftRight_:g9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(s){const e=H(s,"image","grayscaleToRGB"),t=e.rank-1,n=e.shape[t];V(e.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")),V(n===1,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(n,"."));const a=new Array(e.rank);return a.fill(1,0,t),a[t]=3,rr(e,a)}const y9=se({grayscaleToRGB_:b9});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(s){const e=H(s,"image","RGBToGrayscale"),t=e.rank-1,n=e.shape[t];V(e.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")),V(n===3,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(n,"."));const a=e.dtype,o=Xe(e,"float32"),i=Us([.2989,.587,.114]);let c;switch(e.rank){case 2:c=cu("ij,j->i",o,i);break;case 3:c=cu("ijk,k->ij",o,i);break;case 4:c=cu("ijkl,l->ijk",o,i);break;case 5:c=cu("ijklm,m->ijkl",o,i);break;case 6:c=cu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return c=vn(c,-1),Xe(c,a)}const w9=se({rgbToGrayscale_:v9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(s,e,t=0,n=.5){const a=H(s,"image","rotateWithOffset","float32");V(a.rank===4,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,"."));const o={image:a},i={radians:e,fillValue:t,center:n};return re.runKernel(U2,o,i)}const S9=se({rotateWithOffset_:N9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lu(s,e,t,n,a,o){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=s.shape[0];return t=Math.min(t,i),V(0<=n&&n<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(n,"'")),V(s.rank===2,()=>"boxes must be a 2D tensor, but was of rank '".concat(s.rank,"'")),V(s.shape[1]===4,()=>"boxes must have 4 columns, but 2nd dimension was ".concat(s.shape[1])),V(e.rank===1,()=>"scores must be a 1D tensor"),V(e.shape[0]===i,()=>"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(e.shape[0])),V(0<=o&&o<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(o,"'")),{maxOutputSize:t,iouThreshold:n,scoreThreshold:a,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY){const o=H(s,"boxes","nonMaxSuppression","float32"),i=H(e,"scores","nonMaxSuppression","float32"),c=Lu(o,i,t,n,a);t=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold;const u={maxOutputSize:t,iouThreshold:n,scoreThreshold:a};return re.runKernel(x2,{boxes:o,scores:i},u)}const j9=se({nonMaxSuppression_:C9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(s,e,t){const n=T9(s,e,t),a=n<0?-(n+1):n;s.splice(a,0,e)}function T9(s,e,t){return $9(s,e,t||I9)}function I9(s,e){return s>e?1:s<e?-1:0}function $9(s,e,t){let n=0,a=s.length,o=0,i=!1;for(;n<a;){o=n+(a-n>>>1);const c=t(e,s[o]);c>0?n=o+1:(a=o,i=!c)}return i?n:-n-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kv(s,e,t,n,a){return $v(s,e,t,n,a,0)}function Tv(s,e,t,n,a,o){return $v(s,e,t,n,a,0,!1,o,!0)}function Iv(s,e,t,n,a,o){return $v(s,e,t,n,a,o,!0)}function $v(s,e,t,n,a,o,i=!1,c=!1,u=!1){const h=[];for(let v=0;v<e.length;v++)e[v]>a&&h.push({score:e[v],boxIndex:v,suppressBeginIndex:0});h.sort(K4);const p=o>0?-.5/o:0,f=[],g=[];for(;f.length<t&&h.length>0;){const v=h.pop(),{score:N,boxIndex:C,suppressBeginIndex:T}=v;if(N<a)break;let I=!1;for(let $=f.length-1;$>=T;--$){const R=A9(s,C,f[$]);if(R>=n){I=!0;break}if(v.score=v.score*E9(n,p,R),v.score<=a)break}v.suppressBeginIndex=f.length,I||(v.score===N?(f.push(C),g.push(v.score)):v.score>a&&k9(h,v,K4))}const b=f.length,y=t-b;c&&y>0&&(f.push(...new Array(y).fill(0)),g.push(...new Array(y).fill(0)));const w={selectedIndices:f};return i&&(w.selectedScores=g),u&&(w.validOutputs=b),w}function A9(s,e,t){const n=s.subarray(e*4,e*4+4),a=s.subarray(t*4,t*4+4),o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),h=Math.min(a[0],a[2]),p=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),b=(c-o)*(u-i),y=(f-h)*(g-p);if(b<=0||y<=0)return 0;const w=Math.max(o,h),v=Math.max(i,p),N=Math.min(c,f),C=Math.min(u,g),T=Math.max(N-w,0)*Math.max(C-v,0);return T/(b+y-T)}function E9(s,e,t){const n=Math.exp(e*t*t);return t<=s?n:0}function K4(s,e){return s.score-e.score||s.score===e.score&&e.boxIndex-s.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function D9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY){const o=H(s,"boxes","nonMaxSuppressionAsync"),i=H(e,"scores","nonMaxSuppressionAsync"),c=Lu(o,i,t,n,a);t=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold;const u=await Promise.all([o.data(),i.data()]),h=u[0],p=u[1],{selectedIndices:f}=kv(h,p,t,n,a);return o!==s&&o.dispose(),i!==e&&i.dispose(),Us(f,"int32")}const R9=D9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=0){const i=H(s,"boxes","nonMaxSuppression"),c=H(e,"scores","nonMaxSuppression"),u=Lu(i,c,t,n,a,o);t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,o=u.softNmsSigma;const h={boxes:i,scores:c},p={maxOutputSize:t,iouThreshold:n,scoreThreshold:a,softNmsSigma:o},f=re.runKernel(y2,h,p);return{selectedIndices:f[0],selectedScores:f[1]}}const _9=se({nonMaxSuppressionWithScore_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function F9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=0){const i=H(s,"boxes","nonMaxSuppressionAsync"),c=H(e,"scores","nonMaxSuppressionAsync"),u=Lu(i,c,t,n,a,o);t=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,o=u.softNmsSigma;const h=await Promise.all([i.data(),c.data()]),p=h[0],f=h[1],{selectedIndices:g,selectedScores:b}=Iv(p,f,t,n,a,o);return i!==s&&i.dispose(),c!==e&&c.dispose(),{selectedIndices:Us(g,"int32"),selectedScores:Us(b)}}const L9=F9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=!1){const i=H(s,"boxes","nonMaxSuppression"),c=H(e,"scores","nonMaxSuppression"),u=Lu(i,c,t,n,a,null),h=u.maxOutputSize,p=u.iouThreshold,f=u.scoreThreshold,g={boxes:i,scores:c},b={maxOutputSize:h,iouThreshold:p,scoreThreshold:f,padToMaxOutputSize:o},y=re.runKernel(b2,g,b);return{selectedIndices:y[0],validOutputs:y[1]}}const P9=se({nonMaxSuppressionPadded_:M9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function z9(s,e,t,n=.5,a=Number.NEGATIVE_INFINITY,o=!1){const i=H(s,"boxes","nonMaxSuppressionAsync"),c=H(e,"scores","nonMaxSuppressionAsync"),u=Lu(i,c,t,n,a,null),h=u.maxOutputSize,p=u.iouThreshold,f=u.scoreThreshold,[g,b]=await Promise.all([i.data(),c.data()]),{selectedIndices:y,validOutputs:w}=Tv(g,b,h,p,f,o);return i!==s&&i.dispose(),c!==e&&c.dispose(),{selectedIndices:Us(y,"int32"),validOutputs:gt(w,"int32")}}const B9=z9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(s,e,t=!1,n=!1){const a=H(s,"images","resizeBilinear");V(a.rank===3||a.rank===4,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),V(e.length===2,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")),V(n===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;a.rank===3&&(i=!0,o=le(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={images:o},u={alignCorners:t,halfPixelCenters:n,size:e},h=re.runKernel(tx,c,u);return i?le(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const TT=se({resizeBilinear_:V9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(s,e,t=!1,n=!1){const a=H(s,"images","resizeNearestNeighbor");V(a.rank===3||a.rank===4,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),V(e.length===2,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")),V(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),V(n===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;a.rank===3&&(i=!0,o=le(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={images:o},u={alignCorners:t,halfPixelCenters:n,size:e},h=re.runKernel(ex,c,u);return i?le(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const IT=se({resizeNearestNeighbor_:U9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(s,e="binary",t=!1,n=.5){const a=H(s,"image","threshold"),o=.2989,i=.587,c=.114,u=a.shape[0]*a.shape[1];let h=ae(Us([n]),255),p,f,g,b;if(V(a.rank===3,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,".")),V(a.shape[2]===3||a.shape[2]===1,()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],".")),V(a.dtype==="int32"||a.dtype==="float32",()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,".")),V(e==="otsu"||e==="binary",()=>"Method must be binary or otsu, but was ".concat(e)),a.shape[2]===3){[p,f,g]=va(a,[1,1,1],-1);const v=ae(p,o),N=ae(f,i),C=ae(g,c);b=Me(Me(v,N),C)}else b=s;if(e==="otsu"){const v=Fk(Xe(dv(b),"int32"),jr([]),256);h=W9(v,u)}const y=t?tc(b,h):ka(b,h);return Xe(ae(y,255),"int32")}function W9(s,e){let t=Us([-1]),n=Us([0]),a=Us([0]),o,i,c,u,h,p;for(let f=0;f<s.size-1;f++){o=yt(s,0,f+1),i=yt(s,f+1),h=Qe(it(o),e),p=Qe(it(i),e);const g=it(ae(o,Nu(0,o.size)));c=Qe(g,it(o));const b=Ou(i.shape,o.size),y=Me(Nu(0,i.size),b),w=ae(i,y);u=Qe(it(w),it(i));const v=tt(c,u),N=tt(c,u),C=ae(h,p);a=ae(ae(C,v),N);const T=ka(a,n);n=Dn(T,a,n),t=Dn(T,Us([f]),t)}return t}const H9=se({threshold_:G9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(s,e,t="nearest",n="constant",a=0,o){const i=H(s,"image","transform","float32"),c=H(e,"transforms","transform","float32");V(i.rank===4,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,".")),V(c.rank===2&&(c.shape[0]===i.shape[0]||c.shape[0]===1)&&c.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),V(o==null||o.length===2,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(o,"."));const u={image:i,transforms:c},h={interpolation:t,fillMode:n,fillValue:a,outputShape:o};return re.runKernel(B2,u,h)}const K9=se({transform_:q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(s,e,t){const n=H(s,"a","bandPart");V(n.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(n.rank,"."));const a=n.shape,[o,i]=n.shape.slice(-2);let c,u;typeof e=="number"?(V(e%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(e,".")),V(e<=o,()=>"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(o,").")),c=H(e<0?o:e,"numLower","bandPart")):(V(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),c=Dn(mh(e,0),o,ql(e,o))),typeof t=="number"?(V(t%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(t,".")),V(t<=i,()=>"bandPart(): numUpper (".concat(t,")")+" must not be greater than the number of columns (".concat(i,").")),u=H(t<0?i:t,"numUpper","bandPart")):(V(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=Dn(mh(t,0),i,ql(t,i)));const h=le(Nu(0,o,1,"int32"),[-1,1]),p=Nu(0,i,1,"int32"),f=tt(h,p),g=to(tc(f,c),Yi(f,fs(u))),b=Ys([o,i],n.dtype);return le(Na(hr(le(n,[-1,o,i])).map(y=>Dn(g,y,b))),a)}const Y9=se({bandPart_:X9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(s){let e;if(Array.isArray(s)){e=!1,V(s!=null&&s.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=s[0].shape[0];for(let o=1;o<s.length;++o)V(s[o].shape[0]===a,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(s[o].shape[0]," vs. ").concat(a,")"))}else e=!0,s=va(s,s.shape[0],0).map(a=>Rs(a,[0]));V(s.length<=s[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(s.length,") exceeds ")+"number of dimensions (".concat(s[0].shape[0],")."));const t=[],n=s;for(let a=0;a<s.length;++a)t.push(re.tidy(()=>{let o=n[a];if(a>0)for(let i=0;i<a;++i){const c=ae(it(ae(t[i],o)),t[i]);o=tt(o,c)}return Qe(o,$p(o,"euclidean"))}));return e?Na(t,0):t}const Q9=se({gramSchmidt_:Z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(s,e=!1){if(V(s.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(s.rank)),s.rank===2)return X4(s,e);{const t=s.shape.slice(0,s.shape.length-2).reduce((u,h)=>u*h),n=hr(le(s,[t,s.shape[s.shape.length-2],s.shape[s.shape.length-1]]),0),a=[],o=[];n.forEach(u=>{const[h,p]=X4(u,e);a.push(h),o.push(p)});const i=le(Na(a,0),s.shape),c=le(Na(o,0),s.shape);return[i,c]}}function X4(s,e=!1){return re.tidy(()=>{V(s.shape.length===2,()=>"qr2d() requires a 2D Tensor, but got a ".concat(s.shape.length,"D Tensor."));const t=s.shape[0],n=s.shape[1];let a=nv(t),o=Ro(s);const i=_l([[1]],[1,1]);let c=Ro(i);const u=t>=n?n:t;for(let h=0;h<u;++h){const p=o,f=c,g=a;[c,o,a]=re.tidy(()=>{const b=yt(o,[h,h],[t-h,1]),y=$p(b),w=yt(o,[h,h],[1,1]),v=Dn(ka(w,0),_l([[-1]]),_l([[1]])),N=tt(w,ae(v,y)),C=Qe(b,N);C.shape[0]===1?c=Ro(i):c=Ts([i,yt(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const T=fs(Qe(Ft(v,N),y)),I=yt(o,[h,0],[t-h,n]),$=ae(T,c),R=Bt(c);if(h===0)o=tt(I,Ft($,Ft(R,I)));else{const _=tt(I,Ft($,Ft(R,I)));o=Ts([yt(o,[0,0],[h,n]),_],0)}const O=Bt($),P=yt(a,[0,h],[t,a.shape[1]-h]);if(h===0)a=tt(P,Ft(Ft(P,c),O));else{const _=tt(P,Ft(Ft(P,c),O));a=Ts([yt(a,[0,0],[t,h]),_],1)}return[c,o,a]}),kt([p,f,g])}return!e&&t>n&&(a=yt(a,[0,0],[t,n]),o=yt(o,[0,0],[n,n])),[a,o]})}const eV=se({qr_:J9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aa;(function(s){s[s.NONE=0]="NONE",s[s.MEAN=1]="MEAN",s[s.SUM=2]="SUM",s[s.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(aa||(aa={}));function tV(s,e,t=aa.SUM_BY_NONZERO_WEIGHTS){const n=H(s,"losses","computeWeightedLoss");let a=null;e!=null&&(a=H(e,"weights","computeWeightedLoss"));const o=a==null?n:ae(n,a);if(t===aa.NONE)return o;if(t===aa.SUM)return it(o);if(t===aa.MEAN){if(a==null)return ks(o);{const i=n.size/a.size,c=Qe(it(o),it(a));return i>1?Qe(c,gt(i)):c}}if(t===aa.SUM_BY_NONZERO_WEIGHTS){if(a==null)return Qe(it(o),gt(n.size));{const i=ae(a,ya(n.shape)),c=Xe(it(wu(i,gt(0))),"float32");return Qe(it(o),c)}}throw Error("Unknown reduction: ".concat(t))}const Ho=se({computeWeightedLoss_:tV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(s,e,t,n=aa.SUM_BY_NONZERO_WEIGHTS){const a=H(s,"labels","absoluteDifference"),o=H(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=H(t,"weights","absoluteDifference")),ja(a.shape,o.shape,"Error in absoluteDifference: ");const c=Xs(tt(a,o));return Ho(c,i,n)}const nV=se({absoluteDifference_:sV});function aV(s,e,t,n,a=aa.SUM_BY_NONZERO_WEIGHTS){const o=H(s,"labels","cosineDistance"),i=H(e,"predictions","cosineDistance");let c=null;n!=null&&(c=H(n,"weights","cosineDistance")),ja(o.shape,i.shape,"Error in cosineDistance: ");const u=gt(1),h=tt(u,it(ae(o,i),t,!0));return Ho(h,c,a)}const rV=se({cosineDistance_:aV});function oV(s,e,t,n=aa.SUM_BY_NONZERO_WEIGHTS){let a=H(s,"labels","hingeLoss");const o=H(e,"predictions","hingeLoss");let i=null;t!=null&&(i=H(t,"weights","hingeLoss")),ja(a.shape,o.shape,"Error in hingeLoss: ");const c=gt(1);a=tt(ae(gt(2),a),c);const u=ro(tt(c,ae(a,o)));return Ho(u,i,n)}const iV=se({hingeLoss_:oV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(s,e,t,n=1,a=aa.SUM_BY_NONZERO_WEIGHTS){const o=H(s,"labels","huberLoss"),i=H(e,"predictions","huberLoss");let c=null;t!=null&&(c=H(t,"weights","huberLoss")),ja(o.shape,i.shape,"Error in huberLoss: ");const u=gt(n),h=Xs(tt(i,o)),p=ql(h,u),f=tt(h,p),g=Me(ae(gt(.5),is(p)),ae(u,f));return Ho(g,c,a)}const cV=se({huberLoss_:lV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(s,e,t,n=1e-7,a=aa.SUM_BY_NONZERO_WEIGHTS){const o=H(s,"labels","logLoss"),i=H(e,"predictions","logLoss");let c=null;t!=null&&(c=H(t,"weights","logLoss")),ja(o.shape,i.shape,"Error in logLoss: ");const u=gt(1),h=gt(n),p=fs(ae(o,La(Me(i,h)))),f=ae(tt(u,o),La(Me(tt(u,i),h))),g=tt(p,f);return Ho(g,c,a)}const dV=se({logLoss_:uV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(s,e,t,n=aa.SUM_BY_NONZERO_WEIGHTS){const a=H(s,"labels","meanSquaredError"),o=H(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=H(t,"weights","meanSquaredError")),ja(a.shape,o.shape,"Error in meanSquaredError: ");const c=yv(a,o);return Ho(c,i,n)}const pV=se({meanSquaredError_:hV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(s,e){const t=H(s,"labels","sigmoidCrossEntropyWithLogits"),n=H(e,"logits","sigmoidCrossEntropyWithLogits");ja(t.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=ro(n),o=ae(n,t),i=yx(Wn(fs(Xs(n))));return Me(tt(a,o),i)}function mV(s,e,t,n=0,a=aa.SUM_BY_NONZERO_WEIGHTS){let o=H(s,"multiClassLabels","sigmoidCrossEntropy");const i=H(e,"logits","sigmoidCrossEntropy");let c=null;if(t!=null&&(c=H(t,"weights","sigmoidCrossEntropy")),ja(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),n>0){const h=gt(n),p=gt(1),f=gt(.5);o=Me(ae(o,tt(p,h)),ae(f,h))}const u=fV(o,i);return Ho(u,c,a)}const gV=se({sigmoidCrossEntropy_:mV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(s,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(t));return Fo((a,o,i)=>{const u=vx(o,[t],!0),h=tt(Xe(o,"float32"),u);i([a,h]);const p=fs(ae(h,a));return{value:it(p,[t]),gradFunc:(b,y)=>{const[w,v]=y,N=_s(b.shape,[t]);return[ae(le(b,N),tt(Xe(w,"float32"),Wn(v))),ae(le(b,N),tt(Wn(v),Xe(w,"float32")))]}}})(s,e)}function bV(s,e,t,n=0,a=aa.SUM_BY_NONZERO_WEIGHTS){let o=H(s,"onehotLabels","softmaxCrossEntropy");const i=H(e,"logits","softmaxCrossEntropy");let c=null;if(t!=null&&(c=H(t,"weights","softmaxCrossEntropy")),ja(o.shape,i.shape,"Error in softmaxCrossEntropy: "),n>0){const h=gt(n),p=gt(1),f=gt(o.shape[1]);o=Me(ae(o,tt(p,h)),Qe(h,f))}const u=xV(o,i);return Ho(u,c,a)}const yV=se({softmaxCrossEntropy_:bV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(s,e,t,n){const a=H(s,"indices","sparseFillEmptyRows","int32"),o=H(e,"values","sparseFillEmptyRows"),i=H(t,"denseShape","sparseFillEmptyRows","int32"),c=H(n,"defaultValue","sparseFillEmptyRows",o.dtype);if(a.rank!==2)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(o.rank!==1)throw new Error("Values should be Tensor1D but received shape ".concat(o.shape));if(i.rank!==1)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(c.rank!==0)throw new Error("Default value should be a scalar but received shape ".concat(c.shape));const u={indices:a,values:o,denseShape:i,defaultValue:c},h=re.runKernel(A2,u);return{outputIndices:h[0],outputValues:h[1],emptyRowIndicator:h[2],reverseIndexMap:h[3]}}const wV=se({sparseFillEmptyRows_:vV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NV(s,e,t){const n=H(s,"inputIndices","sparseReshape","int32"),a=H(e,"inputShape","sparseReshape","int32"),o=H(t,"newShape","sparseReshape","int32");if(n.rank!==2)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(n.shape));if(a.rank!==1)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(o.rank!==1)throw new Error("New shape should be Tensor1D but received shape ".concat(o.shape));const i={inputIndices:n,inputShape:a,newShape:o},c=re.runKernel(E2,i);return{outputIndices:c[0],outputShape:c[1]}}const SV=se({sparseReshape_:NV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(s,e,t){const n=H(s,"data","sparseSegmentMean"),a=H(e,"indices","sparseSegmentMean","int32"),o=H(t,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(o.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(o.shape));const i={data:n,indices:a,segmentIds:o};return re.runKernel(D2,i)}const jV=se({sparseSegmentMean_:CV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kV(s,e,t){const n=H(s,"data","sparseSegmentSum"),a=H(e,"indices","sparseSegmentSum","int32"),o=H(t,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(o.rank!==1)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(o.shape));const i={data:n,indices:a,segmentIds:o};return re.runKernel(R2,i)}const TV=se({sparseSegmentSum_:kV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IV(s,e,t,n,a,o,i,c){const u=H(s,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error("Data must be a vector, saw: ".concat(u.shape));const h=H(e,"dataSplits","stringNGrams");if(h.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const p={separator:t,nGramWidths:n,leftPad:a,rightPad:o,padWidth:i,preserveShortSequences:c},f={data:u,dataSplits:h},g=re.runKernel(L2,f,p);return{nGrams:g[0],nGramsSplits:g[1]}}const $V=se({stringNGrams_:IV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(s,e,t=!0){const n=H(s,"input","stringSplit","string"),a=H(e,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error("Input should be Tensor1D but received shape ".concat(n.shape));if(a.rank!==0)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));const o={skipEmpty:t},i={input:n,delimiter:a},c=re.runKernel(M2,i,o);return{indices:c[0],values:c[1],shape:c[2]}}const EV=se({stringSplit_:AV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(s,e){const t=H(s,"input","stringToHashBucketFast","string"),n={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:t};return re.runKernel(P2,a,n)}const RV=se({stringToHashBucketFast_:DV});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(s,e,t,n=!0){const a=H(s,"input","staticRegexReplace","string"),o={pattern:e,rewrite:t,replaceGlobal:n};return re.runKernel(cx,{x:a},o)}const _V=se({staticRegexReplace_:OV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FV={fft:Ax,ifft:bh,rfft:Ex,irfft:bv},LV={hammingWindow:c9,hannWindow:jT,frame:kT,stft:p9},_a={flipLeftRight:x9,grayscaleToRGB:y9,resizeNearestNeighbor:IT,resizeBilinear:TT,rgbToGrayscale:w9,rotateWithOffset:S9,cropAndResize:m9,nonMaxSuppression:j9,nonMaxSuppressionAsync:R9,nonMaxSuppressionWithScore:_9,nonMaxSuppressionWithScoreAsync:L9,nonMaxSuppressionPadded:P9,nonMaxSuppressionPaddedAsync:B9,threshold:H9,transform:K9},$T={bandPart:Y9,gramSchmidt:Q9,qr:eV},MV={absoluteDifference:nV,computeWeightedLoss:Ho,cosineDistance:rV,hingeLoss:iV,huberLoss:cV,logLoss:dV,meanSquaredError:pV,sigmoidCrossEntropy:gV,softmaxCrossEntropy:yV},PV={sparseFillEmptyRows:wV,sparseReshape:SV,sparseSegmentMean:jV,sparseSegmentSum:TV},zV={stringNGrams:$V,stringSplit:EV,stringToHashBucketFast:RV,staticRegexReplace:_V};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BV=new Map,VV=new Map;class Mu{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class ar{constructor(){this.classNameMap={}}static getMap(){return ar.instance==null&&(ar.instance=new ar),ar.instance}static register(e){ar.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ue(s,e,t){V(s.className!=null,()=>"Class being registered does not have the static className property defined."),V(typeof s.className=="string",()=>"className is required to be a string, but got type "+typeof s.className),V(s.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=s.className);const n=t,a=e+">"+n;return ar.register(s),BV.set(a,s),VV.set(s,a),s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qi extends Mu{minimize(e,t=!1,n){const{value:a,grads:o}=this.computeGradients(e,n);if(n!=null){const i=n.map(c=>({name:c.name,tensor:o[c.name]}));this.applyGradients(i)}else this.applyGradients(o);return kt(o),t?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return hP(e,t)}dispose(){this.iterations_!=null&&kt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:gt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Qi,Symbol.hasInstance,{value:s=>s.minimize!=null&&s.computeGradients!=null&&s.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AT extends Qi{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=re.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=re.registeredVariables[n],i=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:"".concat(n,"/accum_grad"),variable:me(()=>Vt(o).variable(i))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:"".concat(n,"/accum_var"),variable:me(()=>Vt(o).variable(i))});const c=Array.isArray(e)?e[a].tensor:e[n];if(c==null)return;const u=this.accumulatedGrads[a].variable,h=this.accumulatedUpdates[a].variable;me(()=>{const p=Me(ae(u,this.rho),ae(is(c),1-this.rho)),f=ae(Qe(Cn(Me(h,this.epsilon)),Cn(Me(u,this.epsilon))),c),g=Me(ae(h,this.rho),ae(is(f),1-this.rho));u.assign(p),h.assign(g);const b=Me(ae(f,-this.learningRate),o);o.assign(b)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(kt(this.accumulatedGrads.map(e=>e.variable)),kt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ET extends Qi{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=re.registeredVariables[n];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:"".concat(n,"/accumulator"),variable:me(()=>Ou(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[a].tensor:e[n];if(i==null)return;const c=this.accumulatedGrads[a].variable;me(()=>{const u=Me(c,is(i));c.assign(u);const h=Me(ae(Qe(i,Cn(Me(u,re.backend.epsilon()))),-this.learningRate),o);o.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&kt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DT extends Qi{static get className(){return"Adam"}constructor(e,t,n,a=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],me(()=>{this.accBeta1=gt(t).variable(),this.accBeta2=gt(n).variable()}),a==null&&(this.epsilon=re.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);me(()=>{const n=tt(1,this.accBeta1),a=tt(1,this.accBeta2);t.forEach((o,i)=>{const c=re.registeredVariables[o],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(o,"/m"),variable:me(()=>Vt(c).variable(u))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:"".concat(o,"/v"),variable:me(()=>Vt(c).variable(u))});const h=Array.isArray(e)?e[i].tensor:e[o];if(h==null)return;const p=this.accumulatedFirstMoment[i].variable,f=this.accumulatedSecondMoment[i].variable,g=Me(ae(p,this.beta1),ae(h,1-this.beta1)),b=Me(ae(f,this.beta2),ae(is(h),1-this.beta2)),y=Qe(g,n),w=Qe(b,a);p.assign(g),f.assign(b);const v=Me(ae(Qe(y,Me(Cn(w),this.epsilon)),-this.learningRate),c);c.assign(v)}),this.accBeta1.assign(ae(this.accBeta1,this.beta1)),this.accBeta2.assign(ae(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&kt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&kt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),me(()=>{this.accBeta1.assign(_o(this.beta1,this.iterations_+1)),this.accBeta2.assign(_o(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RT extends Qi{static get className(){return"Adamax"}constructor(e,t,n,a=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],me(()=>{this.iteration=gt(0).variable(),this.accBeta1=gt(t).variable()}),a==null&&(this.epsilon=re.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);me(()=>{const n=tt(1,this.accBeta1),a=Qe(-this.learningRate,Me(ae(this.iteration,this.decay),1));t.forEach((o,i)=>{const c=re.registeredVariables[o],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:"".concat(o,"/m"),variable:Vt(c).variable(u)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:"".concat(o,"/v"),variable:Vt(c).variable(u)});const h=Array.isArray(e)?e[i].tensor:e[o];if(h==null)return;const p=this.accumulatedFirstMoment[i].variable,f=this.accumulatedWeightedInfNorm[i].variable,g=Me(ae(p,this.beta1),ae(h,1-this.beta1)),b=ae(f,this.beta2),y=Xs(h),w=Wo(b,y);p.assign(g),f.assign(w);const v=Me(ae(Qe(a,n),Qe(g,Me(w,this.epsilon))),c);c.assign(v)}),this.iteration.assign(Me(this.iteration,1)),this.accBeta1.assign(ae(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&kt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&kt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Av extends Qi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=Array.isArray(e)?e[a].tensor:e[n];if(o==null)return;const i=re.registeredVariables[n];me(()=>{const c=Me(ae(this.c,o),i);i.assign(c)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=pn(gt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OT extends Av{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=gt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=re.registeredVariables[n];this.accumulations[a]==null&&(this.accumulations[a]={originalName:"".concat(n,"/momentum"),variable:me(()=>Vt(o).variable(!1))});const i=this.accumulations[a].variable,c=Array.isArray(e)?e[a].tensor:e[n];c!=null&&me(()=>{let u;const h=Me(ae(this.m,i),c);this.useNesterov?u=Me(ae(this.c,Me(c,ae(h,this.m))),o):u=Me(ae(this.c,h),o),i.assign(h),o.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&kt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _T extends Qi{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,a=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,a==null&&(this.epsilon=re.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,a)=>{const o=re.registeredVariables[n],i=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:"".concat(n,"/rms"),variable:me(()=>Vt(o).variable(i))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:"".concat(n,"/momentum"),variable:me(()=>Vt(o).variable(i))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:"".concat(n,"/mg"),variable:me(()=>Vt(o).variable(i))});const c=Array.isArray(e)?e[a].tensor:e[n];if(c==null)return;const u=this.accumulatedMeanSquares[a].variable,h=this.accumulatedMoments[a].variable;me(()=>{const p=Me(ae(u,this.decay),ae(is(c),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[a].variable,g=Me(ae(f,this.decay),ae(c,1-this.decay)),b=Qe(ae(c,this.learningRate),Cn(tt(p,Me(is(g),this.epsilon)))),y=Me(ae(h,this.momentum),b);u.assign(p),f.assign(g),h.assign(y);const w=tt(o,y);o.assign(w)}else{const f=Me(ae(u,this.decay),ae(is(c),1-this.decay)),g=Me(ae(h,this.momentum),Qe(ae(c,this.learningRate),Cn(Me(f,this.epsilon))));u.assign(f),h.assign(g);const b=tt(o,g);o.assign(b)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&kt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&kt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&kt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(a=>({originalName:a.name,variable:a.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UV=[AT,ET,DT,RT,OT,_T,Av];function GV(){for(const s of UV)Ue(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WV="model",HV=".json",qV=".weights.bin";function Y4(s){return new Promise(e=>setTimeout(e)).then(s)}class Kl{constructor(e){if(!Se().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Kl.URL_SCHEME)&&(e=e.slice(Kl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=WV),this.modelJsonFileName=e+HV,this.weightDataFileName=e+qV}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=Dr.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=pk(e,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),c=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(c.download=this.modelJsonFileName,c.href=i,await Y4(()=>c.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=n,await Y4(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Cp(e)}}}}Kl.URL_SCHEME="downloads://";class KV{constructor(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const n=new FileReader;n.onload=a=>{const o=JSON.parse(a.target.result),i=o.modelTopology;if(i==null){t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));return}if(o.weightsManifest==null){t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const u=H2(o,h=>this.loadWeights(h));e(u)},n.onerror=a=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(e){const t=[],n=[];for(const i of e)t.push(...i.weights),n.push(...i.paths);const a=this.checkManifestAndWeightFiles(e),o=n.map(i=>this.loadWeightsFile(i,a[i]));return Promise.all(o).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((n,a)=>{const o=new FileReader;o.onload=i=>{const c=i.target.result;n(c)},o.onerror=i=>a("Failed to weights data from file of path '".concat(e,"'.")),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map(o=>P4(o.name)),a={};for(const o of e)o.paths.forEach(i=>{const c=P4(i);if(t.indexOf(c)!==-1)throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(c,"'"));if(t.push(c),n.indexOf(c)===-1)throw new Error("Weight file with basename '".concat(c,"' is not provided."));a[i]=this.weightsFiles[n.indexOf(c)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return a}}const XV=s=>Se().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(Kl.URL_SCHEME)?YV(s.slice(Kl.URL_SCHEME.length)):null;ys.registerSaveRouter(XV);function YV(s="model"){return new Kl(s)}function ZV(s){return new KV(s)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(s,e,t,n){i(s),t=t==null?0:t,n=n==null?1:n,c(t,n);let a=0;const o=u=>(u.then(h=>{const p=t+ ++a/s.length*(n-t);return e(p),h}),u);function i(u){V(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function c(u,h){V(u>=0&&u<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(u)),V(h>=0&&h<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(h)),V(h>=u,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(u," and endFraction ")+"".concat(h))}return Promise.all(s.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function FT(s,e){e==null&&(e={});const t=e.fetchFunc==null?Se().platform.fetch:e.fetchFunc,n=s.map(f=>t(f,e.requestInit,{isBinary:!0})),c=(e.onProgress==null?await Promise.all(n):await Z4(n,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(c):await Z4(c,e.onProgress,.5,1)}function QV(s,e){var t;const n=e.fetchFunc==null?Se().platform.fetch:e.fetchFunc;let a=0,o;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async i=>{for(var c;a<s.length;){o||(o=(await n(s[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:h}=await o.read();if(u){a++,o=void 0,(c=e.onProgress)===null||c===void 0||c.call(e,a/s.length);continue}i.enqueue(h);return}i.close()}})}async function JV(s,e="",t,n){return LT(i=>FT(i,{requestInit:n}))(s,e,t)}function LT(s){return async(e,t="",n)=>{const a=e.map(()=>!1),o={},i=n!=null?n.map(()=>!1):[],c=[];if(e.forEach((b,y)=>{let w=0;b.weights.forEach(v=>{const N="quantization"in v?v.quantization.dtype:v.dtype,C=Vl[N]*Ae(v.shape),T=()=>{a[y]=!0,o[y]==null&&(o[y]=[]),o[y].push({manifestEntry:v,groupOffset:w,sizeBytes:C})};n!=null?n.forEach((I,$)=>{I===v.name&&(T(),i[$]=!0)}):T(),c.push(v.name),w+=C})}),!i.every(b=>b)){const b=n.filter((y,w)=>!i[w]);throw new Error("Could not find weights in manifest with names: "+"".concat(b.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(c.join(", "),"."))}const u=a.reduce((b,y,w)=>(y&&b.push(w),b),[]),h=[];u.forEach(b=>{e[b].paths.forEach(y=>{const w=t+(t.endsWith("/")?"":"/")+y;h.push(w)})});const p=await s(h),f={};let g=0;return u.forEach(b=>{const y=e[b].paths.length,w=new Dr(p.slice(g,g+y));o[b].forEach(N=>{const C=w.slice(N.groupOffset,N.groupOffset+N.sizeBytes),T=ck(C,[N.manifestEntry]);for(const I in T)f[I]=T[I]}),g+=y}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eU="application/octet-stream",tU="application/json";class Ev{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(V(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Se().platform.fetch,V(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&V(e.length===2,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=pk(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(a)],{type:tU}),"model.json"),e.weightData!=null){const i=Dr.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:eU}),"model.weights.bin")}const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:Cp(e),responses:[o]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(o){let i="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const n=t.modelTopology,a=t.weightsManifest;if(n==null&&a==null)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return H2(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=X1(e.weightsManifest),a=()=>QV(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:a})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,a]=sU(t),o=this.weightPathPrefix||n,i=[],c=[];for(const u of e)for(const h of u.paths)this.weightUrlConverter!=null?c.push(this.weightUrlConverter(h)):i.push(o+h+a);return this.weightUrlConverter&&i.push(...await Promise.all(c)),i}async loadWeights(e){const t=await this.getWeightUrls(e),n=X1(e),a=await FT(t,this.loadOptions);return[n,a]}}Ev.URL_SCHEME_REGEX=/^https?:\/\//;function sU(s){const e=s.lastIndexOf("/"),t=s.lastIndexOf("?"),n=s.substring(0,e),a=t>e?s.substring(t):"";return[n+"/",a]}function sy(s){return s.match(Ev.URL_SCHEME_REGEX)!=null}const MT=(s,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(s)?t=s.every(n=>sy(n)):t=sy(s),t)return Dv(s,e)}return null};ys.registerSaveRouter(MT);ys.registerLoadRouter(MT);function Dv(s,e){return new Ev(s,e)}function nU(s,e){return Dv(s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m1{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class PT{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class aU{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function rU(s,e,t,n){const a=arguments;return new aU(zT(...a))}function zT(s,e,t,n){return arguments.length===1?s.modelTopology!=null||s.weightSpecs!=null?new m1(s):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new m1({modelTopology:s})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new m1({modelTopology:s,weightSpecs:e,weightData:t,trainingConfig:n}))}function oU(s){return new PT(s)}function iU(s){return new PT(s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BT=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Dr,browserFiles:ZV,browserHTTPRequest:nU,concatenateArrayBuffers:hk,copyModel:iL,decodeWeights:ck,decodeWeightsStream:dk,encodeWeights:K1,fromMemory:rU,fromMemorySync:zT,getLoadHandlers:q7,getModelArtifactsForJSON:H2,getModelArtifactsForJSONSync:fk,getModelArtifactsInfoForJSON:Cp,getSaveHandlers:mk,getWeightSpecs:X1,http:Dv,isHTTPScheme:sy,listModels:rL,loadWeights:JV,moveModel:lL,registerLoadRouter:H7,registerSaveRouter:W7,removeModel:oL,weightsLoaderFactory:LT,withSaveHandler:oU,withSaveHandlerSync:iU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let jl;function lU(s,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(s==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,n=!1,a=!1,o=!1,i=!1,c=!1;if(s.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&s instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement)o=!0;else if(s.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&s instanceof ImageBitmap)c=!0;else throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(s.constructor.name));if(V1(z1,re.backendName)!=null){const y={pixels:s},w={numChannels:e};return re.runKernel(z1,y,w)}const[h,p]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height];let f;if(i)f=s.getContext("2d").getImageData(0,0,h,p).data;else if(n||t)f=s.data;else if(o||a||c){if(jl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")jl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else jl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});jl.canvas.width=h,jl.canvas.height=p,jl.drawImage(s,0,0,h,p),f=jl.getImageData(0,0,h,p).data}let g;if(e===4)g=new Int32Array(f);else{const y=h*p;g=new Int32Array(y*e);for(let w=0;w<y;w++)for(let v=0;v<e;++v)g[w*e+v]=f[w*4+v]}return fT(g,[p,h,e],"int32")}function cU(s){if(s.rank!==2&&s.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(s.rank,"."));const e=s.rank===2?1:s.shape[2];if(e>4||e===2)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if(s.dtype!=="float32"&&s.dtype!=="int32")throw new Error("Unsupported type for toPixels: ".concat(s.dtype,".")+" Please use float32 or int32 tensors.")}async function uU(s,e){let t=H(s,"img","toPixels");if(!(s instanceof os)){const h=t;t=Xe(h,"int32"),h.dispose()}cU(t);const[n,a]=t.shape.slice(0,2),o=t.rank===2?1:t.shape[2],i=await t.data(),c=t.dtype==="float32"?255:1,u=new Uint8ClampedArray(a*n*4);for(let h=0;h<n*a;++h){const p=[0,0,0,255];for(let g=0;g<o;g++){const b=i[h*o+g];if(t.dtype==="float32"){if(b<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(b,"."))}else if(t.dtype==="int32"&&(b<0||b>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(b,"."));o===1?(p[0]=b*c,p[1]=b*c,p[2]=b*c):p[g]=b*c}const f=h*4;u[f+0]=Math.round(p[0]),u[f+1]=Math.round(p[1]),u[f+2]=Math.round(p[2]),u[f+3]=Math.round(p[3])}return t!==s&&t.dispose(),u}const dU=se({fromPixels_:lU});function Rv(s,e){const t=s.shape.length,n=e.shape.length;if(t<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(t,"."));if(n<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[n-1]>t)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[n-1]," vs. ").concat(t));if(Ae(s.shape)===0)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(s.shape,"."));const a=e.shape,o=a[a.length-1];let i=1;for(let f=0;f<a.length-1;++f)i*=a[f];const c=s.shape,u=a.slice();u.pop();let h=1;for(let f=o;f<t;++f)h*=c[f],u.push(c[f]);const p=[...ft(s.shape).map(f=>f/h),1].slice(0,o);return[u,i,h,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ny=-2,hU=-1;function Ov(s,e,t){const n=s.shape.length;V(n===e.length,()=>"Error in slice".concat(n,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(n,").")),V(n===t.length,()=>"Error in slice".concat(n,"D: Length of size ").concat(t," must ")+"match the rank of the array (".concat(n,")."));for(let a=0;a<n;++a)V(e[a]+t[a]<=s.shape[a],()=>"Error in slice".concat(n,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+t[a],") would overflow input.shape[").concat(a,"] (").concat(s.shape[a],")"))}function pU(s){const e=[];let t=0;for(;s>0;)s&1&&e.push(t),s/=2,t++;return e}function _v(s,e,t){const n=[];for(let a=0;a<s.length;a++)n[a]=Math.ceil((e[a]-s[a])/t[a]);return n}function VT(s,e,t,n){const a=[...s];for(let o=a.length;o<n.length;o++)a.push(1);for(let o=0;o<t;o++)o===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function UT(s,e,t){return t<=s?t:t-(e-1)}function GT(s,e){const t=[];for(let n=0;n<s;n++)t.push(e+n);return t}function fU(s,e,t,n,a,o,i,c,u){const h=s.length;let p=new Array(h),f=new Array(h),g=new Array(h);if(e.length&&t>0){const b=e[0],y=t+1;p=WT(i,b,y,n,s),f=HT(c,b,y,a,s),g=VT(o,b,y,s)}else for(let b=0;b<h;b++)p[b]=KT(i,n,o,s,b,u),f[b]=XT(c,a,o,s,b,u),g[b]=qT(o,b,u);return{begin:p,end:f,strides:g}}function WT(s,e,t,n,a){const o=[...a],i=GT(t,e);for(let c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=0;else{const u=UT(e,t,c);let h=n[u];s&1<<u&&(h=0),o[c]=h}return o}function HT(s,e,t,n,a){const o=[...a],i=GT(t,e);for(let c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=Number.MAX_SAFE_INTEGER;else{const u=UT(e,t,c);let h=n[u];s&1<<u&&(h=Number.MAX_SAFE_INTEGER),o[c]=h}for(let c=0;c<o.length;c++){const u=a[c];o[c]<0&&(o[c]+=u),o[c]=Pl(0,o[c],a[c])}return o}function qT(s,e,t){let n=s[e];return(t&1<<e||n==null)&&(n=1),n}function KT(s,e,t,n,a,o){let i=e[a];const c=t[a]||1;(s&1<<a||o&1<<a||i==null)&&(c>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const u=n[a];return i<0&&(i+=u),i=Pl(0,i,u-1),i}function XT(s,e,t,n,a,o){let i=e[a];const c=t[a]||1;(s&1<<a||o&1<<a||i==null)&&(c>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const u=n[a];return i<0&&(i+=u),c>0?i=Pl(0,i,u):i=Pl(-1,i,u-1),i}function Fv(s,e,t){let n=t.length;for(let a=0;a<t.length;a++)if(t[a]>1){n=a;break}for(let a=n+1;a<t.length;a++)if(e[a]>0||t[a]!==s[a])return!1;return!0}function Lv(s,e){let t=s.length>0?s[s.length-1]:1;for(let n=0;n<s.length-1;n++)t+=s[n]*e[n];return t}function Fx(s,e,t){let n;const a=s.shape.length;typeof e=="number"?n=[e,...new Array(a-1).fill(0)]:e.length<a?n=e.concat(new Array(a-e.length).fill(0)):n=e.slice(),n.forEach(i=>{V(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(a).fill(-1):typeof t=="number"?o=[t,...new Array(a-1).fill(-1)]:t.length<a?o=t.concat(new Array(a-t.length).fill(-1)):o=t,o=o.map((i,c)=>i>=0?i:(V(i===-1,()=>"Negative size values should be exactly -1 but got "+"".concat(i," for the slice() size at index ").concat(c,".")),s.shape[c]-n[c])),[n,o]}function Mv(s,e,t,n,a,o,i,c,u){let h;if(n==null?(h=new Array(e.length),h.fill(1)):h=n,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let p=!1;const f={dims:h.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:h.slice(),beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:c,shrinkAxisMask:u};for(let T=0;T<f.dims;T++)p&&(1<<T&c)!==0&&f.numAddAxisAfterEllipsis++,1<<T&i&&(p=!0);p||(f.ellipsisMask|=1<<f.dims,f.dims++);const g={dims:s.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};mU(f,g);let b=!0,y=!0,w=!0;const v=[],N=[];for(let T=0;T<s.length;++T){if(g.strides[T]===0)throw Error("strides[".concat(T,"] must be non-zero"));const I=!!(g.shrinkAxisMask&1<<T),$=s[T];if($===-1){v.push(I?1:-1);continue}const R=[g.beginMask&1<<T,g.endMask&1<<T],O=[g.strides[T]>0?0:-1,g.strides[T]>0?$:$-1];if(I&&g.strides[T]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&g.strides[T]===1;const P=!!(g.beginMask&1<<T&&g.endMask&1<<T);if(g.beginValid&&g.endValid){if(I){const U=g.begin[T]<0?$+g.begin[T]:g.begin[T];if(g.begin[T]=U,g.end[T]=g.begin[T]+1,U<0||U>=$)throw Error("slice index ".concat(g.begin[T]," of dimension ").concat(T," out of bounds."))}else g.begin[T]=Q4(g.begin[T],0,g.strides[T],$,R,O),g.end[T]=Q4(g.end[T],1,g.strides[T],$,R,O);const A=g.strides[T]===1&&g.begin[T]===0&&g.end[T]===$;b=b&&A,y=y&&(T===0&&g.strides[T]===1||A)}else b=b&&g.strides[T]===1&&P,y=y&&(T===0&&g.strides[T]===1||P);let _,M=!1;if(g.beginValid&&g.endValid?(_=g.end[T]-g.begin[T],M=!0):I?(_=1,M=!0):P&&$>=0&&(g.strides[T]<0?_=-$:_=$,M=!0),M){let A;_===0||_<0!=g.strides[T]<0?A=0:A=Math.trunc(_/g.strides[T])+(_%g.strides[T]!==0?1:0),v.push(A)}else v.push(-1)}for(let T=0;T<g.finalShapeGatherIndices.length;++T){const I=g.finalShapeGatherIndices[T];I>=0?N.push(v[I]):I===ny&&N.push(1)}return{finalShapeSparse:N.filter((T,I)=>g.finalShapeGatherIndices[I]!==ny),finalShape:N,isIdentity:b,sliceDim0:y,isSimpleSlice:w,begin:g.begin,end:g.end,strides:g.strides}}function mU(s,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=s.begin!=null,e.endValid=s.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let n=0;n<s.dims;n++)if(1<<n&s.ellipsisMask){const a=Math.min(e.dims-(s.dims-n)+1+s.numAddAxisAfterEllipsis,e.dims);for(;t<a;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=n}else if(1<<n&s.newAxisMask)e.finalShapeGatherIndices.push(ny),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error("Index out of range using input dim ".concat(t,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));s.begin!=null&&(e.begin[t]=s.begin[n]),s.end!=null&&(e.end[t]=s.end[n]),e.strides[t]=s.strides[n],s.beginMask&1<<n&&(e.beginMask|=1<<t),s.endMask&1<<n&&(e.endMask|=1<<t),s.shrinkAxisMask&1<<n?(e.finalShapeGatherIndices.push(hU),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(n)),e.inputShapeGatherIndicesSparse[t]=n,t++}}function Q4(s,e,t,n,a,o){if(a[e])return t>0?o[e]:o[e+1&1];{const i=s<0?n+s:s;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const gU=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Ov,computeFlatOffset:Lv,computeOutShape:_v,getNormalizedAxes:fU,isSliceContinous:Fv,maskToAxes:pU,parseSliceParams:Fx,sliceInfo:Mv,startForAxis:KT,startIndicesWithElidedDims:WT,stopForAxis:XT,stopIndicesWithElidedDims:HT,stridesForAxis:qT,stridesWithElidedDims:VT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xU{static sgd(e){return new Av(e)}static momentum(e,t,n=!1){return new OT(e,t,n)}static rmsprop(e,t=.9,n=0,a=null,o=!1){return new _T(e,t,n,a,o)}static adam(e=.001,t=.9,n=.999,a=null){return new DT(e,t,n,a)}static adadelta(e=.001,t=.95,n=null){return new AT(e,t,n)}static adamax(e=.002,t=.9,n=.999,a=null,o=0){return new RT(e,t,n,a,o)}static adagrad(e,t=.1){return new ET(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nu=xU;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bU=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:s=>s();function YT(){return new Promise(s=>bU(()=>s()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pv(s,e){const t=s[0].length;s.forEach((a,o)=>{V(a.length===t,()=>"Error in concat".concat(t,"D: rank of tensors[").concat(o,"] must be the same ")+"as the rank of the rest (".concat(t,")"))}),V(e>=0&&e<t,()=>"Error in concat".concat(t,"D: axis must be between 0 and ").concat(t-1,"."));const n=s[0];s.forEach((a,o)=>{for(let i=0;i<t;i++)V(i===e||a[i]===n[i],()=>"Error in concat".concat(t,"D: Shape of tensors[").concat(o,"] (").concat(a,") ")+"does not match the shape of the rest (".concat(n,") ")+"along the non-concatenated axis ".concat(o,"."))})}function Qr(s,e){const t=s[0].slice();for(let n=1;n<s.length;n++)t[e]+=s[n][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sr;(function(s){s[s.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",s[s.VALUE_ROWIDS=1]="VALUE_ROWIDS",s[s.ROW_LENGTHS=2]="ROW_LENGTHS",s[s.ROW_SPLITS=3]="ROW_SPLITS",s[s.ROW_LIMITS=4]="ROW_LIMITS",s[s.ROW_STARTS=5]="ROW_STARTS"})(Sr||(Sr={}));function ZT(s,e,t){let n=new Array;if(t==null&&e==null)return n;if(e==null)for(;n.length<s+t.length;)n.push(-1);else n=e.slice();if(t==null)return n;if(s+t.length!==n.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(s+t.length,", but shape.rank = ").concat(n.length));for(let a=1;a<t.length;++a){const o=t[a],i=n[n.length-t.length+a],c=n[i];if(o>=0)if(c>=0){if(c!==o)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(a+s,"] = ").concat(o," but shape[").concat(a+s,"] = ").concat(c))}else n[i]=o}return n}function QT(s){const e={FIRST_DIM_SIZE:Sr.FIRST_DIM_SIZE,VALUE_ROWIDS:Sr.VALUE_ROWIDS,ROW_LENGTHS:Sr.ROW_LENGTHS,ROW_SPLITS:Sr.ROW_SPLITS,ROW_LIMITS:Sr.ROW_LIMITS,ROW_STARTS:Sr.ROW_STARTS},t=[];for(const n of s)if(n in e)t.push(e[n]);else break;return t}function JT(s){return s.length===0?0:s[0]===Sr.FIRST_DIM_SIZE?s.length-1:s.length}function eI(s,e){if(s==null||e==null)return;const t=s.length,n=e.length;if(t>=n)throw new Error("defaultValue.shape=".concat(s," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(t," must be less than ragged tensor input flatValues.rank = ").concat(n,")"));for(let a=0;a<Math.min(t,n-1);++a){const o=s[a],i=e[a+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error("defaultValue.shape=".concat(s,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(a-s.length,"] = ").concat(o," but ragged tensor input.flatValues.shape[").concat(a-s.length,"] = ").concat(i))}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zv=30;function Lx(s){return s<=zv?s:L1(s,Math.floor(Math.sqrt(s)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(s,e,t){const n=t*(typeof s=="number"?s:s[0]),a=e*(typeof s=="number"?s:s[1]);return[n,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dp(s,e,t,n=!0){let a=[];if(n)a=a.concat(e.slice(0)),a.push(s[0]/t),a=a.concat(s.slice(1));else{a=a.concat(s[0]);const o=e.length;for(let i=0;i<o;++i)a=a.concat([s[i+1]/e[i],e[i]]);a=a.concat(s.slice(o+1))}return a}function Rp(s,e,t=!0){const n=[];if(t){n.push(e);for(let a=e+1;a<s;++a)a<=2*e?(n.push(a),n.push(a-(e+1))):n.push(a)}else{const a=[],o=[];for(let i=1;i<s;++i)i>=e*2+1||i%2===1?o.push(i):a.push(i);n.push(...a),n.push(0),n.push(...o)}return n}function Op(s,e,t,n=!0){const a=[];n?a.push(s[0]/t):a.push(s[0]*t);for(let o=1;o<s.length;++o)o<=e.length?n?a.push(e[o-1]*s[o]):a.push(s[o]/e[o-1]):a.push(s[o]);return a}function Vv(s,e){const t=[0];for(let n=0;n<e;++n)t.push(s[n][0]);return t}function Uv(s,e,t){const n=s.slice(0,1);for(let a=0;a<t;++a)n.push(s[a+1]-e[a][0]-e[a][1]);return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mx=1.7580993408473768,Px=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gv=.3275911,Wv=.254829592,Hv=-.284496736,qv=1.421413741,Kv=-1.453152027,Xv=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(s,e){if(s.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(s.length,", imag: ").concat(e.length,"."));const t=new Float32Array(s.length*2);for(let n=0;n<t.length;n+=2)t[n]=s[n/2],t[n+1]=e[n/2];return t}function tI(s){const e=new Float32Array(s.length/2),t=new Float32Array(s.length/2);for(let n=0;n<s.length;n+=2)e[n/2]=s[n],t[n/2]=s[n+1];return{real:e,imag:t}}function sI(s){const e=Math.ceil(s.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let a=0;a<s.length;a+=4)t[Math.floor(a/4)]=s[a],n[Math.floor(a/4)]=s[a+1];return{real:t,imag:n}}function nI(s){const e=Math.floor(s.length/4),t=new Float32Array(e),n=new Float32Array(e);for(let a=2;a<s.length;a+=4)t[Math.floor(a/4)]=s[a],n[Math.floor(a/4)]=s[a+1];return{real:t,imag:n}}function Yv(s,e){const t=s[e*2],n=s[e*2+1];return{real:t,imag:n}}function aI(s,e,t,n){s[n*2]=e,s[n*2+1]=t}function rI(s,e){const t=new Float32Array(s/2),n=new Float32Array(s/2);for(let a=0;a<Math.ceil(s/2);a++){const o=(e?2:-2)*Math.PI*(a/s);t[a]=Math.cos(o),n[a]=Math.sin(o)}return{real:t,imag:n}}function oI(s,e,t){const n=(t?2:-2)*Math.PI*(s/e),a=Math.cos(n),o=Math.sin(n);return{real:a,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g1="->",yU=/->/g,J4=",",eC="...";function Zv(s,e){s=s.replace(/\s/g,"");const t=(s.length-s.replace(yU,"").length)/g1.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error('Equation must contain exactly one arrow ("'.concat(g1,'").'));const[n,a]=s.split(g1);V(n.indexOf(eC)===-1,()=>'The ellipsis notation ("'.concat(eC,'") is not supported yet.'));const o=n.split(J4),i=o.length;if(e!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(e));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const c=[];for(let g=0;g<a.length;++g){const b=a[g];if(!o.some(y=>y.indexOf(b)!==-1))throw new Error("Output subscripts contain the label ".concat(b," ")+"not present in the input subscripts.");c.indexOf(b)===-1&&c.push(b)}for(let g=0;g<n.length;++g){const b=n[g];c.indexOf(b)===-1&&b!==J4&&c.push(b)}const u=new Array(o.length);for(let g=0;g<i;++g){if(new Set(o[g].split("")).size!==o[g].length)throw new Error("Found duplicate axes in input component ".concat(o[g],". ")+"Support for duplicate axes in input is not implemented yet.");u[g]=[];for(let b=0;b<o[g].length;++b)u[g].push(c.indexOf(o[g][b]))}const h=c.length,p=a.length,f=[];for(let g=p;g<h;++g)f.push(g);return{allDims:c,summedDims:f,idDims:u}}function Qv(s,e){let t=new Array(s);t.fill(-1);for(let a=0;a<e.length;++a)t[e[a]]=a;const n=[];for(let a=0;a<s;++a)t[a]===-1&&n.push(a);return t=t.filter(a=>a!==-1),{permutationIndices:t,expandDims:n}}function Jv(s,e,t){const n=new Array(s);for(let a=0;a<t.length;++a){const o=t[a].shape;for(let i=0;i<e[a].length;++i)n[e[a][i]]===void 0?n[e[a][i]]=o[i]:V(n[e[a][i]]===o[i],()=>"Expected dimension ".concat(n[e[a][i]]," at axis ").concat(i," ")+"of input shaped ".concat(JSON.stringify(o),", ")+"but got dimension ".concat(o[i]))}}function ew(s,e){const t=s,n=[];let a=0;s.length===0&&t.push(-1),a=s.length+1;for(let i=0;i<a;++i)n.push([]);const o=[];for(let i=0;i<t.length;++i){const c=t[i],u=vU(e,c);for(const h of u)o.indexOf(h)===-1&&(n[i].push(h),o.push(h))}return{path:t,steps:n}}function tw(s){return s.every((e,t)=>e===t)}function vU(s,e){const t=[];for(let n=0;n<s.length;++n)(s[n].length===0||s[n].indexOf(e)!==-1||e===-1)&&t.push(n);return t}function sw(s,e,t=0){let n=[];if(typeof e=="number")V(s.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),n=new Array(e).fill(s.shape[t]/e);else{const a=e.reduce((i,c)=>(c===-1&&(i+=1),i),0);V(a<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((c,u)=>u>0?c+u:c);e[o]=s.shape[t]-i}V(s.shape[t]===e.reduce((i,c)=>i+c),()=>"The sum of sizes must match the size of the axis dimension."),n=e}return n}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iI(s){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s)}function lI(s,e){return"indices(".concat(s,", 0) is invalid: ").concat(e," < 0")}function cI(s,e,t){return"indices(".concat(s,", 0) is invalid: ").concat(e," >= ").concat(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uI(s,e){return"only one output dimension may be -1, not both ".concat(s," and ").concat(e)}function dI(s,e){return"size ".concat(s," must be non-negative, not ").concat(e)}function hI(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function pI(s,e){const t=Ae(s),n=Ae(e);return"Input to reshape is a SparseTensor with ".concat(t,"\n  dense values, but the requested shape requires a multiple of ").concat(n,". inputShape=").concat(s," outputShape= ").concat(e)}function fI(s,e){const t=Ae(s),n=Ae(e);return"Input to reshape is a tensor with ".concat(t," dense values, but the requested shape has ").concat(n,". inputShape=").concat(s," outputShape=").concat(e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(){return"segment ids must be >= 0"}function mI(){return"segment ids are not increasing"}function gI(s,e){return"Segment id ".concat(s," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function xI(s,e,t){return"Bad: indices[".concat(s,"] == ").concat(e," out of range [0, ").concat(t,")")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(s,e){let t=!1,n;for(s<=zv?(n=s,t=!0):n=L1(s,Math.floor(Math.sqrt(s)));!t;)n>e||n===s?t=!0:n=L1(s,n+1);return n}function yI(s,e,t){const n=[],a=s.length;for(let o=0;o<a;o++)o!==e?n.push(s[o]):n.push(t);return n}function nw(s,e,t,n){const a=e.shape.length,o=s.shape.length;if(n!==0&&(n<-a||n>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(n));if(n<0&&(n+=a),n>o)throw new Error("batchDims (".concat(n,") must be less than rank(x) (\n    ").concat(o,")."));if(t<n)throw new Error("batchDims (".concat(n,") must be less than or equal to axis (").concat(t,")."));for(let f=0;f<n;++f)if(s.shape[f]!==e.shape[f])throw new Error("x.shape[".concat(f,"]: ").concat(s.shape[f]," should be equal to indices.shape[").concat(f,"]: ").concat(e.shape[f],"."));const i=s.shape[t],c=[];let u=1,h=1,p=1;for(let f=0;f<n;++f)c.push(s.shape[f]),u*=s.shape[f];for(let f=n;f<t;f++)c.push(s.shape[f]),h*=s.shape[f];for(let f=n;f<a;f++)c.push(e.shape[f]);for(let f=t+1;f<o;f++)c.push(s.shape[f]),p*=s.shape[f];return{batchSize:u,sliceSize:p,outerSize:h,dimSize:i,outputShape:c}}const wU=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:nw,computeOutShape:yI,segOpComputeOptimalWindowSize:bI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(s){try{return s.map(e=>Ri(e))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(e))}}function vI(s){return s.map(e=>Ai(e))}const NU=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Wv,ERF_A2:Hv,ERF_A3:qv,ERF_A4:Kv,ERF_A5:Xv,ERF_P:Gv,PARALLELIZE_THRESHOLD:zv,get RowPartitionType(){return Sr},SELU_SCALE:Px,SELU_SCALEALPHA:Mx,applyActivation:Ox,assertAndGetBroadcastShape:Tt,assertAxesAreInnerMostDims:kn,assertParamsConsistent:Pv,assignToTypedArray:aI,axesAreInnerMostDims:sv,calculateShapes:nc,checkEinsumDimSizes:Jv,checkPadOnDimRoundingMode:Kn,combineLocations:Xk,combineRaggedTensorToTensorShapes:ZT,complexWithEvenIndex:sI,complexWithOddIndex:nI,computeConv2DInfo:mn,computeConv3DInfo:Ki,computeDefaultPad:X2,computeDilation2DInfo:jp,computeOptimalWindowSize:Lx,computeOutAndReduceShapes:gn,computeOutShape:Qr,computePool2DInfo:pr,computePool3DInfo:Uo,convertConv2DDataFormat:Go,decodeEinsumEquation:Zv,eitherStridesOrDilationsAreOne:jn,expandShapeToKeepDim:_s,exponent:oI,exponents:rI,fromStringArrayToUint8:vI,fromUint8ToStringArray:Mo,getAxesPermutation:ws,getBroadcastDims:vu,getComplexWithIndex:Yv,getEinsumComputePath:ew,getEinsumPermutation:Qv,getFusedBiasGradient:Rx,getFusedDyActivation:Dx,getImageCenter:Bv,getInnerMostAxes:Fs,getPermuted:Rp,getRaggedRank:JT,getReductionAxes:sn,getReshaped:Dp,getReshapedPermuted:Op,getRowPartitionTypesHelper:QT,getSliceBeginCoords:Vv,getSliceSize:Uv,getSparseFillEmptyRowsIndicesDenseShapeMismatch:iI,getSparseFillEmptyRowsNegativeIndexErrorMessage:lI,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:cI,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:hI,getSparseReshapeInputOutputMismatchErrorMessage:fI,getSparseReshapeInputOutputMultipleErrorMessage:pI,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:uI,getSparseReshapeNegativeOutputDimErrorMessage:dI,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:xI,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:ay,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:mI,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:gI,getUndoAxesPermutation:Xi,isIdentityPermutation:tw,log:o7,mergeRealAndImagArrays:Lo,prepareAndValidate:Rv,prepareSplitSize:sw,segment_util:wU,shouldFuse:_x,slice_util:gU,splitRealAndImagArrays:tI,stridesOrDilationsArePositive:Wl,tupleValuesAreOne:Fi,upcastType:wa,validateDefaultValueShape:eI,validateInput:vv,validateUpdateShape:mT,warn:Oa},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */GV();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SU=Se();SU.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,s=>{s&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ga;(function(s){s[s.DT_INVALID=0]="DT_INVALID",s[s.DT_FLOAT=1]="DT_FLOAT",s[s.DT_DOUBLE=2]="DT_DOUBLE",s[s.DT_INT32=3]="DT_INT32",s[s.DT_UINT8=4]="DT_UINT8",s[s.DT_INT16=5]="DT_INT16",s[s.DT_INT8=6]="DT_INT8",s[s.DT_STRING=7]="DT_STRING",s[s.DT_COMPLEX64=8]="DT_COMPLEX64",s[s.DT_INT64=9]="DT_INT64",s[s.DT_BOOL=10]="DT_BOOL",s[s.DT_QINT8=11]="DT_QINT8",s[s.DT_QUINT8=12]="DT_QUINT8",s[s.DT_QINT32=13]="DT_QINT32",s[s.DT_BFLOAT16=14]="DT_BFLOAT16",s[s.DT_QINT16=15]="DT_QINT16",s[s.DT_QUINT16=16]="DT_QUINT16",s[s.DT_UINT16=17]="DT_UINT16",s[s.DT_COMPLEX128=18]="DT_COMPLEX128",s[s.DT_HALF=19]="DT_HALF",s[s.DT_RESOURCE=20]="DT_RESOURCE",s[s.DT_VARIANT=21]="DT_VARIANT",s[s.DT_UINT32=22]="DT_UINT32",s[s.DT_UINT64=23]="DT_UINT64",s[s.DT_FLOAT_REF=101]="DT_FLOAT_REF",s[s.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",s[s.DT_INT32_REF=103]="DT_INT32_REF",s[s.DT_UINT8_REF=104]="DT_UINT8_REF",s[s.DT_INT16_REF=105]="DT_INT16_REF",s[s.DT_INT8_REF=106]="DT_INT8_REF",s[s.DT_STRING_REF=107]="DT_STRING_REF",s[s.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",s[s.DT_INT64_REF=109]="DT_INT64_REF",s[s.DT_BOOL_REF=110]="DT_BOOL_REF",s[s.DT_QINT8_REF=111]="DT_QINT8_REF",s[s.DT_QUINT8_REF=112]="DT_QUINT8_REF",s[s.DT_QINT32_REF=113]="DT_QINT32_REF",s[s.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",s[s.DT_QINT16_REF=115]="DT_QINT16_REF",s[s.DT_QUINT16_REF=116]="DT_QUINT16_REF",s[s.DT_UINT16_REF=117]="DT_UINT16_REF",s[s.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",s[s.DT_HALF_REF=119]="DT_HALF_REF",s[s.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",s[s.DT_VARIANT_REF=121]="DT_VARIANT_REF",s[s.DT_UINT32_REF=122]="DT_UINT32_REF",s[s.DT_UINT64_REF=123]="DT_UINT64_REF"})(ga||(ga={}));var tC;(function(s){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(s.CheckpointFormatVersion||(s.CheckpointFormatVersion={}))})(tC||(tC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CU={};function wI(s){return CU[s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E(s,e,t,n,a){const o=e.inputParams[s];if(o&&o.inputIndexStart!==void 0){const c=o.inputIndexStart,u=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?c+1:o.inputIndexEnd,h=c<0?e.inputNames.length+c:c;if(o.type==="tensor")return wn(e.inputNames[h],t,n,a);if(o.type==="tensors"){const g=e.inputs.slice(c,u);return e.inputNames.slice(c,u).filter((y,w)=>{var v;return((v=g[w])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(y=>wn(y,t,n,a))}const p=wn(e.inputNames[h],t,n,a),f=p.dataSync();return o.type==="number"?f[0]:lr(p.shape,f)}const i=e.attrParams[s];return i&&i.value}function wn(s,e,t,n){const[a,o]=xa(s,t);if(n!=null){const c=n.getHashTableHandleByName(a);if(c!=null)return c}const i=t.currentContextIds.find(c=>!!e[zm(a,c)]);return i!==void 0?e[zm(a,i)][o]:void 0}function sC(s,e,t){return e[zm(s,t.currentContextId)]}function Io(s,e){const[t,n,a]=xa(s,e);return[zm(t,e&&e.currentContextId),n,a]}function zm(s,e){return e?"".concat(s,"-").concat(e):s}function xa(s,e){if(s==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const o=e.parseNodeNameCache.get(s);if(o!=null)return o}const n=s.split(":");let a;if(n.length===1)a=[s,0,void 0];else{const o=n[0],i=n.length===3?n[1]:void 0,c=Number(n[n.length-1]);a=[o,c,i]}return t&&e.parseNodeNameCache.set(s,a),a}function $m(s,e,t){let n=E("pad",s,e,t);if(n==="explicit"){n=E("explicitPaddings",s,e,t);const a=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)a[o][0]=n[o*2],a[o][1]=n[o*2+1];return a}return n}function $o(s){return s.kept?s:Ro(s)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jU=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kU=Object.freeze(Object.defineProperty({__proto__:null,json:jU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TU=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],IU=Object.freeze(Object.defineProperty({__proto__:null,json:TU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $U=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],AU=Object.freeze(Object.defineProperty({__proto__:null,json:$U},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EU=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],DU=Object.freeze(Object.defineProperty({__proto__:null,json:EU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RU=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],OU=Object.freeze(Object.defineProperty({__proto__:null,json:RU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _U=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],FU=Object.freeze(Object.defineProperty({__proto__:null,json:_U},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LU=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],MU=Object.freeze(Object.defineProperty({__proto__:null,json:LU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PU=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],zU=Object.freeze(Object.defineProperty({__proto__:null,json:PU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BU=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],VU=Object.freeze(Object.defineProperty({__proto__:null,json:BU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UU=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],GU=Object.freeze(Object.defineProperty({__proto__:null,json:UU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WU=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],HU=Object.freeze(Object.defineProperty({__proto__:null,json:WU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],KU=Object.freeze(Object.defineProperty({__proto__:null,json:qU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XU=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],YU=Object.freeze(Object.defineProperty({__proto__:null,json:XU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZU=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],QU=Object.freeze(Object.defineProperty({__proto__:null,json:ZU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JU=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],eG=Object.freeze(Object.defineProperty({__proto__:null,json:JU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tG=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],sG=Object.freeze(Object.defineProperty({__proto__:null,json:tG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nG=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],aG=Object.freeze(Object.defineProperty({__proto__:null,json:nG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rG=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],oG=Object.freeze(Object.defineProperty({__proto__:null,json:rG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iG=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],lG=Object.freeze(Object.defineProperty({__proto__:null,json:iG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nC{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[kU,IU,AU,DU,OU,FU,MU,zU,VU,GU,HU,KU,YU,QU,eG,sG,aG,oG,lG],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,a)=>(n[a.tfOpName]=a,n),{})}transformGraph(e,t={}){const n=e.node,a=[],o=[],i=[],c=n.reduce((w,v)=>(w[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?a.push(w[v.name]):v.op==="Const"?o.push(w[v.name]):(v.input==null||v.input.length===0)&&i.push(w[v.name]),w),{});let u=[];const h=[];let p={},f={};t!=null&&(p=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const g=Object.keys(c);g.forEach(w=>{const v=c[w];v.inputNames.forEach((N,C)=>{const[T,,I]=Io(N),$=c[T];if($.outputs!=null){const R=$.outputs.indexOf(I);if(R!==-1){const O="".concat(T,":").concat(R);v.inputNames[C]=O}}v.inputs.push($),$.children.push(v)})}),Object.keys(f).length===0?g.forEach(w=>{const v=c[w];v.children.length===0&&h.push(v)}):Object.keys(f).forEach(w=>{const[v]=Io(w),N=c[v];N!=null&&(N.signatureKey=f[w],h.push(N))}),Object.keys(p).length>0?Object.keys(p).forEach(w=>{const[v]=Io(w),N=c[v];N&&(N.signatureKey=p[w],u.push(N))}):u=a;let b={};e.library!=null&&e.library.function!=null&&(b=e.library.function.reduce((w,v)=>(w[v.signature.name]=this.mapFunction(v),w),{}));const y={nodes:c,inputs:u,outputs:h,weights:o,placeholders:a,signature:t,functions:b};return i.length>0&&(y.initNodes=i),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=wI(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((a,o)=>(a[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},a),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((a,o)=>{const i=o.type;let c;switch(o.type){case"string":c=ry(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=ry(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":c=hy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=hy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":c=iy(e.attr,o.tfName,o.defaultValue||0),c===void 0&&o.tfDeprecatedName&&(c=iy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":c=dy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=dy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":c=oy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=oy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":c=fy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=fy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":c=uy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=uy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":c=py(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=py(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":c=ly(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=ly(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":c=cy(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=cy(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":c=aC(e.attr,o.tfName,o.defaultValue),c===void 0&&o.tfDeprecatedName&&(c=aC(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(o.type," for op: ").concat(e.op))}return a[o.name]={value:c,type:i},a},{})),n}mapFunction(e){const t=e.nodeDef,n=[],a=[];let o={};t!=null&&(o=t.reduce((f,g)=>(f[g.name]=this.mapNode(g),g.op==="Const"&&a.push(f[g.name]),f),{}));const i=[],c=[];e.signature.inputArg.forEach(f=>{const[g]=Io(f.name),b={name:g,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:aw(f.type),type:"dtype"}},children:[]};b.signatureKey=f.name,i.push(b),o[g]=b}),Object.keys(o).forEach(f=>{const g=o[f];g.inputNames.forEach((b,y)=>{const[w,,v]=Io(b),N=o[w];if(N.outputs!=null){const C=N.outputs.indexOf(v);if(C!==-1){const T="".concat(w,":").concat(C);g.inputNames[y]=T}}g.inputs.push(N),N.children.push(g)})});const h=e.ret;e.signature.outputArg.forEach(f=>{const[g,b]=Io(h[f.name]),y=o[g];y!=null&&(y.defaultOutput=b,c.push(y))});const p=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:c,weights:a,placeholders:n,signature:p}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}}function cG(s){const e=Se().global;if(typeof e.atob<"u")return e.atob(s);if(typeof Buffer<"u")return new Buffer(s,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function NI(s,e){const t=Array.isArray(s)?String.fromCharCode.apply(null,s):cG(s);return e?t:t.toLowerCase()}function ry(s,e,t,n=!1){const a=s[e];return a!=null?NI(a.s,n):t}function oy(s,e,t){const n=s[e];return n?n.b:t}function iy(s,e,t){const n=s[e]||{},a=n.i!=null?n.i:n.f!=null?n.f:t;return typeof a=="number"?a:parseInt(a,10)}function aw(s){switch(typeof s=="string"&&(s=ga[s]),s){case ga.DT_FLOAT:case ga.DT_HALF:return"float32";case ga.DT_INT32:case ga.DT_INT64:case ga.DT_INT8:case ga.DT_UINT8:return"int32";case ga.DT_BOOL:return"bool";case ga.DT_DOUBLE:return"float32";case ga.DT_STRING:return"string";case ga.DT_COMPLEX64:case ga.DT_COMPLEX128:return"complex64";default:return null}}function aC(s,e,t){const n=s[e];return n&&n.func?n.func.name:t}function ly(s,e,t){const n=s[e];return n&&n.type?aw(n.type):t}function cy(s,e,t){const n=s[e];return n&&n.list&&n.list.type?n.list.type.map(a=>aw(a)):t}function SI(s){if(!s.unknownRank)return s.dim!=null?s.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function uy(s,e,t){const n=s[e];return n&&n.shape?SI(n.shape):t}function dy(s,e,t){const n=s[e];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):t}function hy(s,e,t,n=!1){const a=s[e];return a&&a.list&&a.list.s?a.list.s.map(o=>NI(o,n)):t}function py(s,e,t){const n=s[e];return n&&n.list&&n.list.shape?n.list.shape.map(a=>SI(a)):t}function fy(s,e,t){const n=s[e];return n&&n.list&&n.list.b?n.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uG{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,o)=>(a[o]=this.getAttr(o),a),{}))}getInput(e){return wn(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(n.tensor!=null)return wn(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return iy(this.node.rawAttrs,e,t);if(n.s!=null)return ry(this.node.rawAttrs,e,t);if(n.b!=null)return oy(this.node.rawAttrs,e,t);if(n.shape!=null)return uy(this.node.rawAttrs,e,t);if(n.type!=null)return ly(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return dy(this.node.rawAttrs,e,t);if(n.list.s!=null)return hy(this.node.rawAttrs,e,t);if(n.list.shape!=null)return py(this.node.rawAttrs,e,t);if(n.list.b!=null)return fy(this.node.rawAttrs,e,t);if(n.list.type!=null)return cy(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:ok,abs:Xs,acos:Ck,acosh:jk,add:Me,addN:SL,all:K2,any:Mm,argMax:yu,argMin:kk,asin:Tk,asinh:Ik,atan:$k,atan2:Ak,atanh:Ek,avgPool:fx,avgPool3d:Dk,basicLSTMCell:HL,batchNorm:kp,batchNorm2d:Rk,batchNorm3d:Ok,batchNorm4d:_k,batchToSpaceND:mx,bincount:Fk,bitwiseAnd:tM,booleanMaskAsync:PB,broadcastArgs:nM,broadcastTo:fu,buffer:Dt,cast:Xe,ceil:Lk,clipByValue:oa,clone:Ro,complex:Oi,concat:Ts,concat1d:Mk,concat2d:Pk,concat3d:zk,concat4d:Bk,conv1d:Y2,conv2d:Li,conv2dTranspose:Q2,conv3d:Vk,conv3dTranspose:Gk,cos:gx,cosh:J2,cosineWindow:Cv,cumprod:Pm,cumsum:ev,denseBincount:ey,depthToSpace:Wk,depthwiseConv2d:Tp,diag:kM,dilation2d:Hk,div:Qe,divNoNan:qk,dot:Kk,dropout:vT,einsum:cu,elu:Ip,enclosingPowerOfTwo:wT,ensureShape:FM,equal:Ir,erf:tv,euclideanNorm:Zk,exp:Wn,expandDims:vn,expm1:Qk,eye:nv,fft:Ax,fill:Ou,floor:Ap,floorDiv:q2,fused:i9,gather:Ep,gatherND:XB,greater:ka,greaterEqual:Yi,ifft:bh,imag:xx,image:_a,inTopKAsync:JB,irfft:bv,isFinite:Jk,isInf:eT,isNaN:tT,leakyRelu:bx,less:mh,lessEqual:tc,linalg:$T,linspace:lP,localResponseNormalization:sT,log:La,log1p:yx,logSigmoid:nT,logSoftmax:av,logSumExp:vx,logicalAnd:to,logicalNot:wx,logicalOr:rv,logicalXor:aT,losses:MV,lowerBound:CP,matMul:Ft,max:cr,maxPool:Nx,maxPool3d:rT,maxPoolWithArgmax:IP,maximum:Wo,mean:ks,meshgrid:EP,min:fh,minimum:ql,mirrorPad:oT,mod:iT,moments:Sx,movingAverage:VB,mul:ae,multiRNNCell:LP,multinomial:PP,neg:fs,norm:$p,notEqual:wu,oneHot:iv,ones:ya,onesLike:Ma,op:se,outerProduct:GP,pad:Zi,pad1d:qP,pad2d:XP,pad3d:ZP,pad4d:JP,pool:lT,pow:_o,prelu:jx,print:Sk,prod:cT,raggedGather:iz,raggedRange:cz,raggedTensorToTensor:dz,rand:pz,randomGamma:_z,randomNormal:cv,randomStandardNormal:Mz,randomUniform:sc,randomUniformInt:Bz,range:Nu,real:gh,reciprocal:uT,relu:ro,relu6:uv,reshape:le,reverse:dr,reverse1d:Kz,reverse2d:Yz,reverse3d:Qz,reverse4d:eB,rfft:Ex,round:dv,rsqrt:hv,scalar:gt,scatterND:GB,searchSorted:ov,selu:pv,separableConv2d:fv,setdiff1dAsync:oB,sigmoid:kr,sign:dT,signal:LV,sin:mv,sinh:gv,slice:yt,slice1d:Tx,slice2d:xv,slice3d:Ix,slice4d:xh,softmax:$x,softplus:_u,spaceToBatchND:Cx,sparse:PV,sparseToDense:qB,spectral:FV,split:va,sqrt:Cn,square:is,squaredDifference:yv,squeeze:Rs,stack:Na,step:Fu,stridedSlice:hT,string:zV,sub:tt,sum:it,tan:pT,tanh:Hl,tensor:jr,tensor1d:Us,tensor2d:_l,tensor3d:fT,tensor4d:kB,tensor5d:TB,tensor6d:IB,tensorScatterUpdate:AB,tile:rr,topk:gT,transpose:Bt,truncatedNormal:wv,unique:xT,unsortedSegmentSum:Nv,unstack:hr,upperBound:FB,variable:bT,where:Dn,whereAsync:yT,zeros:Ys,zerosLike:Vt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dG=(s,e,t,n=Tn)=>{switch(s.op){case"BiasAdd":case"AddV2":case"Add":return[n.add(E("a",s,e,t),E("b",s,e,t))];case"AddN":return[n.addN(E("tensors",s,e,t))];case"FloorMod":case"Mod":return[n.mod(E("a",s,e,t),E("b",s,e,t))];case"Mul":return[n.mul(E("a",s,e,t),E("b",s,e,t))];case"RealDiv":case"Div":return[n.div(E("a",s,e,t),E("b",s,e,t))];case"DivNoNan":return[n.divNoNan(E("a",s,e,t),E("b",s,e,t))];case"FloorDiv":return[n.floorDiv(E("a",s,e,t),E("b",s,e,t))];case"Sub":return[n.sub(E("a",s,e,t),E("b",s,e,t))];case"Minimum":return[n.minimum(E("a",s,e,t),E("b",s,e,t))];case"Maximum":return[n.maximum(E("a",s,e,t),E("b",s,e,t))];case"Pow":return[n.pow(E("a",s,e,t),E("b",s,e,t))];case"SquaredDifference":return[n.squaredDifference(E("a",s,e,t),E("b",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hG=(s,e,t,n=Tn)=>{switch(s.op){case"Abs":case"ComplexAbs":return[n.abs(E("x",s,e,t))];case"Acos":return[n.acos(E("x",s,e,t))];case"Acosh":return[n.acosh(E("x",s,e,t))];case"Asin":return[n.asin(E("x",s,e,t))];case"Asinh":return[n.asinh(E("x",s,e,t))];case"Atan":return[n.atan(E("x",s,e,t))];case"Atan2":return[n.atan2(E("x",s,e,t),E("y",s,e,t))];case"Atanh":return[n.atanh(E("x",s,e,t))];case"Ceil":return[n.ceil(E("x",s,e,t))];case"Complex":return[n.complex(E("real",s,e,t),E("imag",s,e,t))];case"Cos":return[n.cos(E("x",s,e,t))];case"Cosh":return[n.cosh(E("x",s,e,t))];case"Elu":return[n.elu(E("x",s,e,t))];case"Erf":return[n.erf(E("x",s,e,t))];case"Exp":return[n.exp(E("x",s,e,t))];case"Expm1":return[n.expm1(E("x",s,e,t))];case"Floor":return[n.floor(E("x",s,e,t))];case"Log":return[n.log(E("x",s,e,t))];case"Log1p":return[n.log1p(E("x",s,e,t))];case"Imag":return[n.imag(E("x",s,e,t))];case"Neg":return[n.neg(E("x",s,e,t))];case"Reciprocal":return[n.reciprocal(E("x",s,e,t))];case"Real":return[n.real(E("x",s,e,t))];case"Relu":return[n.relu(E("x",s,e,t))];case"Round":return[n.round(E("x",s,e,t))];case"Selu":return[n.selu(E("x",s,e,t))];case"Sigmoid":return[n.sigmoid(E("x",s,e,t))];case"Sin":return[n.sin(E("x",s,e,t))];case"Sign":return[n.sign(E("x",s,e,t))];case"Sinh":return[n.sinh(E("x",s,e,t))];case"Softplus":return[n.softplus(E("x",s,e,t))];case"Sqrt":return[n.sqrt(E("x",s,e,t))];case"Square":return[n.square(E("x",s,e,t))];case"Tanh":return[n.tanh(E("x",s,e,t))];case"Tan":return[n.tan(E("x",s,e,t))];case"ClipByValue":return[n.clipByValue(E("x",s,e,t),E("clipValueMin",s,e,t),E("clipValueMax",s,e,t))];case"Relu6":return[n.relu6(E("x",s,e,t))];case"Rsqrt":return[n.rsqrt(wn(s.inputNames[0],e,t))];case"LeakyRelu":return[n.leakyRelu(E("x",s,e,t),E("alpha",s,e,t))];case"Prelu":return[n.prelu(E("x",s,e,t),E("alpha",s,e,t))];case"IsNan":return[n.isNaN(wn(s.inputNames[0],e,t))];case"IsInf":return[n.isInf(wn(s.inputNames[0],e,t))];case"IsFinite":return[n.isFinite(wn(s.inputNames[0],e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nr(s,e,t=""){if(!(typeof s=="number"||typeof e=="number")){V(s.length===e.length,()=>t+" Shapes ".concat(s," and ").concat(e," must match"));for(let n=0;n<s.length;n++){const a=s[n],o=e[n];V(a<0||o<0||a===o,()=>t+" Shapes ".concat(s," and ").concat(e," must match"))}}}function rC(s){return!(typeof s=="number"||s.some(e=>e<0))}function sh(s,e,t){let n=my(s,t);const a=!rC(n);if(a&&e.length===0)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(n));if(a&&e.forEach(o=>{n=my(o.shape,n)}),!rC(n))throw new Error("Non-fully-defined elementShape: ".concat(n));return n}function my(s,e){if(typeof s=="number")return e;if(typeof e=="number")return s;if(s.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(s," vs. ").concat(e));const t=[];for(let n=0;n<s.length;++n){const a=s[n],o=e[n];if(a>=0&&o>=0&&a!==o)throw new Error("Incompatible shape during merge: ".concat(s," vs. ").concat(e));t[n]=a>=0?a:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pG{constructor(e,t,n,a,o,i,c){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=c,this.tensors=[],this.closed_=!1,this.idTensor=gt(0),pn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));const t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),nr(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,pn(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((n,a)=>this.write(n,t[a]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return jr([],[0].concat(this.elementShape));const n=this.readMany(e);return nr(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Na(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(this.size()===0)return jr([],[0].concat(this.elementShape));const t=[];for(let a=0;a<this.size();a++)t.push(a);const n=this.readMany(t);return nr(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),Ts(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,hr(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0;const a=e.map(u=>(n+=u,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const o=n===0?0:t.size/n,i=[];me(()=>{t=le(t,[1,n,o]);for(let u=0;u<e.length;++u){const p=[0,u===0?0:a[u-1],0],f=[1,e[u],o];i[u]=le(yt(t,p,f),this.elementShape)}return i});const c=[];for(let u=0;u<e.length;u++)c[u]=u;this.writeMany(c,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xl{get id(){return this.idTensor.id}constructor(e,t,n,a=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(o=>{if(n!==o.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(o.dtype));nr(t,o.shape,"TensorList shape mismatch: "),pn(o)}),this.idTensor=gt(0),this.maxNumElements=a,pn(this.idTensor)}copy(){return new Xl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(n!==-1&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));nr(e,this.elementShape,"TensorList shape mismatch: ");const a=sh(this.elementShape,this.tensors,e);return me(()=>{const o=this.tensors.map(i=>le(i,a));return Na(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(this.size()===0)throw new Error("Trying to pop from an empty list.");const n=sh(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,nr(a.shape,e,"TensorList shape mismatch: "),le(a,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(nr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");pn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));const t=new Xl([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(this.tensors[e]==null)throw new Error("element at index ".concat(e," is null."));nr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const a=sh(this.elementShape,this.tensors,t);return le(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));nr(this.elementShape,t.shape,"TensorList shape mismatch: "),pn(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));nr(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=sh(this.elementShape,this.tensors,n);return e.length===0?jr([],[0].concat(a)):me(()=>{const o=e.map(i=>le(this.tensors[i],a));return Na(o,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));nr(this.elementShape,t,"TensorList shape mismatch: ");const n=sh(this.elementShape,this.tensors,t);return this.size()===0?jr([],[0].concat(n)):me(()=>{const a=this.tensors.map(o=>le(o,n));return Ts(a,0)})}}function fG(s,e,t){const n=s.dtype;if(s.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(s.shape));if(s.dtype!==t)throw new Error("Invalid data types; op elements ".concat(s.dtype,", but list elements ").concat(t));const a=s.shape.slice(1);nr(a,e,"TensorList shape mismatch: ");const o=hr(s);return new Xl(o,e,n)}function mG(s,e,t,n){return new Xl([],s,e,n)}function gG(s,e,t,n){if(e.length!==s.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(s.shape[0]));const a=Math.max(...e);if(n!=null&&n!==-1&&a>=n)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(n,")"));const o=new Xl([],t,s.dtype,n),i=hr(s,0);return e.forEach((c,u)=>{o.setItem(c,i[u])}),o}function xG(s,e,t){let n=0;const a=e.map(p=>(n+=p,n));if(n!==s.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(s.shape));const o=s.shape.slice(1),i=my(o,t),c=n===0?0:s.size/n,u=me(()=>{const p=[];s=le(s,[1,n,c]);for(let f=0;f<e.length;++f){const b=[0,f===0?0:a[f-1],0],y=[1,e[f],c];p[f]=le(yt(s,b,y),i)}return s.dispose(),p}),h=new Xl([],t,s.dtype,e.length);for(let p=0;p<u.length;p++)h.setItem(p,u[p]);return h}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bG=async(s,e,t)=>{switch(s.op){case"If":case"StatelessIf":{const n=E("thenBranch",s,e,t),a=E("elseBranch",s,e,t),o=E("cond",s,e,t),i=E("args",s,e,t);return(await o.data())[0]?t.functionMap[n].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[a].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const n=E("body",s,e,t),a=E("cond",s,e,t),o=E("args",s,e,t),i=await t.functionMap[a].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),c=o.map(p=>p.id);let u=await i[0].data();i.forEach(p=>{!p.kept&&c.indexOf(p.id)===-1&&p.dispose()});let h=o;for(;u[0];){const p=h;h=await t.functionMap[n].executeFunctionAsync(h,t.tensorArrayMap,t.tensorListMap);const f=h.map(b=>b.id);p.forEach(b=>{!b.kept&&c.indexOf(b.id)===-1&&f.indexOf(b.id)===-1&&b.dispose()});const g=await t.functionMap[a].executeFunctionAsync(h,t.tensorArrayMap,t.tensorListMap);u=await g[0].data(),g.forEach(b=>{!b.kept&&c.indexOf(b.id)===-1&&f.indexOf(b.id)===-1&&b.dispose()})}return h}case"LoopCond":{const n=E("pred",s,e,t);return[$o(n)]}case"Switch":{const n=E("pred",s,e,t);let a=E("data",s,e,t);return a.kept||(a=$o(a)),(await n.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const n=s.inputNames.find(a=>wn(a,e,t)!==void 0);if(n){const a=wn(n,e,t);return[$o(a)]}return}case"Enter":{const n=E("frameName",s,e,t),a=E("tensor",s,e,t);return t.enterFrame(n),[$o(a)]}case"Exit":{const n=E("tensor",s,e,t);return t.exitFrame(),[$o(n)]}case"NextIteration":{const n=E("tensor",s,e,t);return t.nextIteration(),[$o(n)]}case"TensorArrayV3":{const n=E("size",s,e,t),a=E("dtype",s,e,t),o=E("elementShape",s,e,t),i=E("dynamicSize",s,e,t),c=E("clearAfterRead",s,e,t),u=E("identicalElementShapes",s,e,t),h=E("name",s,e,t),p=new pG(h,a,n,o,u,i,c);return t.addTensorArray(p),[p.idTensor,gt(1)]}case"TensorArrayWriteV3":{const n=E("tensorArrayId",s,e,t),a=E("index",s,e,t),o=E("tensor",s,e,t),i=t.getTensorArray(n.id);return i.write(a,o),[i.idTensor]}case"TensorArrayReadV3":{const n=E("tensorArrayId",s,e,t),a=E("index",s,e,t);return[t.getTensorArray(n.id).read(a)]}case"TensorArrayGatherV3":{const n=E("tensorArrayId",s,e,t),a=E("indices",s,e,t),o=E("dtype",s,e,t);return[t.getTensorArray(n.id).gather(a,o)]}case"TensorArrayScatterV3":{const n=E("tensorArrayId",s,e,t),a=E("indices",s,e,t),o=E("tensor",s,e,t),i=t.getTensorArray(n.id);return i.scatter(a,o),[i.idTensor]}case"TensorArrayConcatV3":{const n=E("tensorArrayId",s,e,t),a=t.getTensorArray(n.id),o=E("dtype",s,e,t);return[a.concat(o)]}case"TensorArraySplitV3":{const n=E("tensorArrayId",s,e,t),a=E("tensor",s,e,t),o=E("lengths",s,e,t),i=t.getTensorArray(n.id);return i.split(o,a),[i.idTensor]}case"TensorArraySizeV3":{const n=E("tensorArrayId",s,e,t),a=t.getTensorArray(n.id);return[gt(a.size(),"int32")]}case"TensorArrayCloseV3":{const n=E("tensorArrayId",s,e,t),a=t.getTensorArray(n.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const n=E("tensorListId",s,e,t),a=E("index",s,e,t),o=E("tensor",s,e,t),i=t.getTensorList(n.id);return i.setItem(a,o),[i.idTensor]}case"TensorListGetItem":{const n=E("tensorListId",s,e,t),a=E("index",s,e,t),o=E("elementShape",s,e,t),i=E("elementDType",s,e,t);return[t.getTensorList(n.id).getItem(a,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const n=E("indices",s,e,t),a=E("tensor",s,e,t),o=E("elementShape",s,e,t),i=E("numElements",s,e,t),c=gG(a,n,o,i);return t.addTensorList(c),[c.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const n=E("elementShape",s,e,t),a=E("elementDType",s,e,t);let o;s.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=E(o,s,e,t),c=s.op==="TensorListReserve"?-1:i,u=mG(n,a,i,c);return t.addTensorList(u),[u.idTensor]}case"TensorListGather":{const n=E("tensorListId",s,e,t),a=E("indices",s,e,t),o=E("elementShape",s,e,t),i=E("elementDType",s,e,t);return[t.getTensorList(n.id).gather(a,i,o)]}case"TensorListStack":{const n=E("tensorListId",s,e,t),a=E("elementShape",s,e,t),o=E("elementDType",s,e,t),i=E("numElements",s,e,t);return[t.getTensorList(n.id).stack(a,o,i)]}case"TensorListFromTensor":{const n=E("tensor",s,e,t),a=E("elementShape",s,e,t),o=E("elementDType",s,e,t),i=fG(n,a,o);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const n=E("tensorListId",s,e,t),a=t.getTensorList(n.id),o=E("dtype",s,e,t),i=E("elementShape",s,e,t);return[a.concat(o,i)]}case"TensorListPushBack":{const n=E("tensorListId",s,e,t),a=E("tensor",s,e,t),o=t.getTensorList(n.id);return o.pushBack(a),[o.idTensor]}case"TensorListPopBack":{const n=E("tensorListId",s,e,t),a=E("elementShape",s,e,t),o=E("elementDType",s,e,t);return[t.getTensorList(n.id).popBack(a,o)]}case"TensorListSplit":{const n=E("tensor",s,e,t),a=E("elementShape",s,e,t),o=E("lengths",s,e,t),i=xG(n,o,a);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const n=E("tensorListId",s,e,t),a=t.getTensorList(n.id);return[gt(a.size(),"int32")]}case"TensorListResize":{const n=E("tensorListId",s,e,t),a=E("size",s,e,t),i=t.getTensorList(n.id).resize(a);return t.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(s,e,t){const[n,a]=E("fusedOps",s,e,t),o=n==="biasadd",i=!o,c=a==="prelu",u=n==="fusedbatchnorm",h=E("numArgs",s,e,t);if(o){if(c&&h!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&o&&h!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const p=E("strides",s,e,t),f=$m(s,e,t),g=E("dataFormat",s,e,t).toUpperCase(),b=E("dilations",s,e,t);let[y,w]=E("args",s,e,t);i&&(w=y,y=void 0);const v=E("leakyreluAlpha",s,e,t);return{stride:p,pad:f,dataFormat:g,dilations:b,biasArg:y,preluArg:w,activationFunc:a,leakyreluAlpha:v}}const yG=(s,e,t,n=Tn)=>{switch(s.op){case"Conv1D":{const a=E("stride",s,e,t),o=E("pad",s,e,t),i=E("dataFormat",s,e,t).toUpperCase(),c=E("dilation",s,e,t);return[n.conv1d(E("x",s,e,t),E("filter",s,e,t),a,o,i,c)]}case"Conv2D":{const a=E("strides",s,e,t),o=$m(s,e,t),i=E("dataFormat",s,e,t).toUpperCase(),c=E("dilations",s,e,t);return[n.conv2d(E("x",s,e,t),E("filter",s,e,t),[a[1],a[2]],o,i,[c[1],c[2]])]}case"_FusedConv2D":{const{stride:a,pad:o,dataFormat:i,dilations:c,biasArg:u,preluArg:h,activationFunc:p,leakyreluAlpha:f}=oC(s,e,t);return[n.fused.conv2d({x:E("x",s,e,t),filter:E("filter",s,e,t),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[c[1],c[2]],bias:u,activation:p,preluActivationWeights:h,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:o,dataFormat:i,dilations:c,biasArg:u,preluArg:h,activationFunc:p,leakyreluAlpha:f}=oC(s,e,t);return[n.fused.depthwiseConv2d({x:E("x",s,e,t),filter:E("filter",s,e,t),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[c[1],c[2]],bias:u,activation:p,preluActivationWeights:h,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=E("outputShape",s,e,t),o=E("strides",s,e,t),i=$m(s,e,t);return[n.conv2dTranspose(E("x",s,e,t),E("filter",s,e,t),a,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=E("strides",s,e,t),o=$m(s,e,t),i=E("dilations",s,e,t),c=E("dataFormat",s,e,t).toUpperCase();return[n.depthwiseConv2d(E("input",s,e,t),E("filter",s,e,t),[a[1],a[2]],o,c,[i[1],i[2]])]}case"Conv3D":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("dataFormat",s,e,t).toUpperCase(),c=E("dilations",s,e,t);return[n.conv3d(E("x",s,e,t),E("filter",s,e,t),[a[1],a[2],a[3]],o,i,[c[1],c[2],c[3]])]}case"AvgPool":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("kernelSize",s,e,t);return[n.avgPool(E("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPool":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("kernelSize",s,e,t);return[n.maxPool(E("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPoolWithArgmax":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("kernelSize",s,e,t),c=E("includeBatchInIndex",s,e,t),{result:u,indexes:h}=n.maxPoolWithArgmax(E("x",s,e,t),[i[1],i[2]],[a[1],a[2]],o,c);return[u,h]}case"AvgPool3D":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("kernelSize",s,e,t);return[n.avgPool3d(E("x",s,e,t),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"MaxPool3D":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("kernelSize",s,e,t);return[n.maxPool3d(E("x",s,e,t),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"Dilation2D":{const a=E("strides",s,e,t),o=E("pad",s,e,t),i=E("dilations",s,e,t),c=a[1],u=a[2],h=i[1],p=i[2];return[n.dilation2d(E("x",s,e,t),E("filter",s,e,t),[c,u],o,[h,p],"NHWC")]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG=(s,e,t,n=Tn)=>{switch(s.op){case"Fill":{const a=E("shape",s,e,t),o=E("dtype",s,e,t),i=E("value",s,e,t);return[n.fill(a,i,o)]}case"LinSpace":{const a=E("start",s,e,t),o=E("stop",s,e,t),i=E("num",s,e,t);return[n.linspace(a,o,i)]}case"Multinomial":{const a=E("logits",s,e,t),o=E("numSamples",s,e,t),i=E("seed",s,e,t);return[n.multinomial(a,o,i)]}case"OneHot":{const a=E("indices",s,e,t),o=E("depth",s,e,t),i=E("onValue",s,e,t),c=E("offValue",s,e,t),u=E("dtype",s,e,t);return[n.oneHot(a,o,i,c,u)]}case"Ones":return[n.ones(E("shape",s,e,t),E("dtype",s,e,t))];case"OnesLike":return[n.onesLike(E("x",s,e,t))];case"RandomStandardNormal":return[n.randomStandardNormal(E("shape",s,e,t),E("dtype",s,e,t),E("seed",s,e,t))];case"RandomUniform":return[n.randomUniform(E("shape",s,e,t),E("minval",s,e,t),E("maxval",s,e,t),E("dtype",s,e,t))];case"RandomUniformInt":return[n.randomUniformInt(E("shape",s,e,t),E("minval",s,e,t),E("maxval",s,e,t),E("seed",s,e,t))];case"Range":{const a=E("start",s,e,t),o=E("stop",s,e,t),i=E("step",s,e,t);return[n.range(a,o,i,E("dtype",s,e,t))]}case"TruncatedNormal":{const a=E("shape",s,e,t),o=E("mean",s,e,t),i=E("stdDev",s,e,t),c=E("seed",s,e,t);return[n.truncatedNormal(a,o,i,E("dtype",s,e,t),c)]}case"Zeros":return[n.zeros(E("shape",s,e,t),E("dtype",s,e,t))];case"ZerosLike":return[n.zerosLike(E("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1(s,e,t){const n=E("boxes",s,e,t),a=E("scores",s,e,t),o=E("maxOutputSize",s,e,t),i=E("iouThreshold",s,e,t),c=E("scoreThreshold",s,e,t),u=E("softNmsSigma",s,e,t);return{boxes:n,scores:a,maxOutputSize:o,iouThreshold:i,scoreThreshold:c,softNmsSigma:u}}const wG=async(s,e,t,n,a=Tn)=>{switch(s.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h,softNmsSigma:p}=x1(s,e,t),f=await a.image.nonMaxSuppressionWithScoreAsync(o,i,c,u,h,p);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h}=x1(s,e,t),p=E("padToMaxOutputSize",s,e,t),f=await a.image.nonMaxSuppressionPaddedAsync(o,i,c,u,h,p);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:c,iouThreshold:u,scoreThreshold:h}=x1(s,e,t);return[await a.image.nonMaxSuppressionAsync(o,i,c,u,h)]}case"Where":{const o=a.cast(E("condition",s,e,t),"bool"),i=[await a.whereAsync(o)];return o.dispose(),i}case"ListDiff":return a.setdiff1dAsync(E("x",s,e,t),E("y",s,e,t));default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NG=(s,e,t,n=Tn)=>{switch(s.op){case"LowerBound":{const a=E("sortedSequence",s,e,t),o=E("values",s,e,t);return[n.lowerBound(a,o)]}case"TopKV2":{const a=E("x",s,e,t),o=E("k",s,e,t),i=E("sorted",s,e,t),c=n.topk(a,o,i);return[c.values,c.indices]}case"UpperBound":{const a=E("sortedSequence",s,e,t),o=E("values",s,e,t);return[n.upperBound(a,o)]}case"Unique":{const a=E("x",s,e,t),o=n.unique(a);return[o.values,o.indices]}case"UniqueV2":{const a=E("x",s,e,t),o=E("axis",s,e,t),i=n.unique(a,o);return[i.values,i.indices]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG=(s,e,t,n=Tn)=>{switch(s.op){case"Const":return e[s.name];case"PlaceholderWithDefault":const a=E("default",s,e,t);return[wn(s.name,e,t)||a];case"Placeholder":return[wn(s.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const p=E("x",s,e,t);return[$o(p)]}case"IdentityN":return E("x",s,e,t).map(p=>$o(p));case"Snapshot":const o=E("x",s,e,t);return[$o(o)];case"Shape":return[n.tensor1d(E("x",s,e,t).shape,"int32")];case"ShapeN":return E("x",s,e,t).map(p=>n.tensor1d(p.shape));case"Size":return[n.scalar(E("x",s,e,t).size,"int32")];case"Rank":return[n.scalar(E("x",s,e,t).rank,"int32")];case"NoOp":return[n.scalar(1)];case"Print":const i=E("x",s,e,t),c=E("data",s,e,t),u=E("message",s,e,t),h=E("summarize",s,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let p=0;p<c.length;p++)console.log(Array.prototype.slice.call(c[p].dataSync()).slice(0,h));return[i];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CG{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=gt(0),this.tensorMap=new Map,pn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return gt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),me(()=>{const a=hr(t),o=n.length,i=a.length;V(o===i,()=>"The number of elements doesn't match, keys has "+"".concat(o," elements, the values has ").concat(i," ")+"elements.");for(let c=0;c<o;c++){const u=n[c],h=a[c];pn(h),this.tensorMap.set(u,h)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return me(()=>{const a=[];for(let o=0;o<n.length;o++){const i=n[o],c=this.findWithDefault(i,t);a.push(c)}return Na(a)})}findWithDefault(e,t){const n=this.tensorMap.get(e);return n!=null?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jG=async(s,e,t,n)=>{switch(s.op){case"HashTable":case"HashTableV2":{const a=n.getHashTableHandleByName(s.name);if(a!=null)return[a];{const o=E("keyDType",s,e,t),i=E("valueDType",s,e,t),c=new CG(o,i);return n.addHashTable(s.name,c),[c.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=E("tableHandle",s,e,t,n),o=E("keys",s,e,t),i=E("values",s,e,t);return[await n.getHashTableById(a.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const a=E("tableHandle",s,e,t,n),o=E("keys",s,e,t),i=E("defaultValue",s,e,t);return[await n.getHashTableById(a.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=E("tableHandle",s,e,t,n);return[n.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kG=(s,e,t,n=Tn)=>{switch(s.op){case"ResizeBilinear":{const a=E("images",s,e,t),o=E("size",s,e,t),i=E("alignCorners",s,e,t),c=E("halfPixelCenters",s,e,t);return[n.image.resizeBilinear(a,[o[0],o[1]],i,c)]}case"ResizeNearestNeighbor":{const a=E("images",s,e,t),o=E("size",s,e,t),i=E("alignCorners",s,e,t),c=E("halfPixelCenters",s,e,t);return[n.image.resizeNearestNeighbor(a,[o[0],o[1]],i,c)]}case"CropAndResize":{const a=E("image",s,e,t),o=E("boxes",s,e,t),i=E("boxInd",s,e,t),c=E("cropSize",s,e,t),u=E("method",s,e,t),h=E("extrapolationValue",s,e,t);return[n.image.cropAndResize(a,o,i,c,u,h)]}case"ImageProjectiveTransformV3":{const a=E("images",s,e,t),o=E("transforms",s,e,t),i=E("outputShape",s,e,t),c=E("fillValue",s,e,t),u=E("interpolation",s,e,t),h=E("fillMode",s,e,t);return[n.image.transform(a,o,u.toLowerCase(),h.toLowerCase(),c,i)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG=(s,e,t,n=Tn)=>{switch(s.op){case"Equal":return[n.equal(E("a",s,e,t),E("b",s,e,t))];case"NotEqual":return[n.notEqual(E("a",s,e,t),E("b",s,e,t))];case"Greater":return[n.greater(E("a",s,e,t),E("b",s,e,t))];case"GreaterEqual":return[n.greaterEqual(E("a",s,e,t),E("b",s,e,t))];case"Less":return[n.less(E("a",s,e,t),E("b",s,e,t))];case"LessEqual":return[n.lessEqual(E("a",s,e,t),E("b",s,e,t))];case"LogicalAnd":return[n.logicalAnd(E("a",s,e,t),E("b",s,e,t))];case"LogicalNot":return[n.logicalNot(E("a",s,e,t))];case"LogicalOr":return[n.logicalOr(E("a",s,e,t),E("b",s,e,t))];case"Select":case"SelectV2":return[n.where(E("condition",s,e,t),E("a",s,e,t),E("b",s,e,t))];case"BitwiseAnd":return[n.bitwiseAnd(E("a",s,e,t),E("b",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IG=(s,e,t,n=Tn)=>{switch(s.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[n.matMul(E("a",s,e,t),E("b",s,e,t),E("transposeA",s,e,t),E("transposeB",s,e,t))];case"Einsum":return[n.einsum(E("equation",s,e,t),...E("tensors",s,e,t))];case"Transpose":return[n.transpose(E("x",s,e,t),E("perm",s,e,t))];case"_FusedMatMul":const[a,o]=E("fusedOps",s,e,t),i=a==="biasadd",c=o==="prelu",u=E("numArgs",s,e,t),h=E("leakyreluAlpha",s,e,t);if(i){if(c&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[p,f]=E("args",s,e,t);return[n.fused.matMul({a:E("a",s,e,t),b:E("b",s,e,t),transposeA:E("transposeA",s,e,t),transposeB:E("transposeB",s,e,t),bias:p,activation:o,preluActivationWeights:f,leakyreluAlpha:h})];case"MatrixBandPart":return[n.linalg.bandPart(E("a",s,e,t),E("numLower",s,e,t),E("numUpper",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $G=(s,e,t,n=Tn)=>{switch(s.op){case"EuclideanNorm":return[n.euclideanNorm(E("x",s,e,t),E("axis",s,e,t),E("keepDims",s,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[n.batchNorm(E("x",s,e,t),E("mean",s,e,t),E("variance",s,e,t),E("offset",s,e,t),E("scale",s,e,t),E("epsilon",s,e,t))];case"FusedBatchNormV3":return[n.batchNorm(E("x",s,e,t),E("mean",s,e,t),E("variance",s,e,t),E("offset",s,e,t),E("scale",s,e,t),E("epsilon",s,e,t))];case"LRN":return[n.localResponseNormalization(E("x",s,e,t),E("radius",s,e,t),E("bias",s,e,t),E("alpha",s,e,t),E("beta",s,e,t))];case"Softmax":return[n.softmax(E("x",s,e,t))];case"LogSoftmax":return[n.logSoftmax(E("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AG=(s,e,t,n=Tn)=>{switch(s.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:o}=n.raggedGather(E("paramsNestedSplits",s,e,t),E("paramsDenseValues",s,e,t),E("indices",s,e,t),E("outputRaggedRank",s,e,t));return a.concat(o)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:o}=n.raggedRange(E("starts",s,e,t),E("limits",s,e,t),E("splits",s,e,t));return[a,o]}case"RaggedTensorToTensor":return[n.raggedTensorToTensor(E("shape",s,e,t),E("values",s,e,t),E("defaultValue",s,e,t),E("rowPartitionTensors",s,e,t),E("rowPartitionTypes",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=(s,e,t,n=Tn)=>{switch(s.op){case"Max":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.max(E("x",s,e,t),c,u)]}case"Mean":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.mean(E("x",s,e,t),c,u)]}case"Min":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.min(E("x",s,e,t),c,u)]}case"Sum":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.sum(E("x",s,e,t),c,u)]}case"All":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.all(E("x",s,e,t),c,u)]}case"Any":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.any(E("x",s,e,t),c,u)]}case"ArgMax":{const c=E("axis",s,e,t);return[n.argMax(E("x",s,e,t),c)]}case"ArgMin":{const c=E("axis",s,e,t);return[n.argMin(E("x",s,e,t),c)]}case"Prod":{const c=E("axis",s,e,t),u=E("keepDims",s,e,t);return[n.prod(E("x",s,e,t),c,u)]}case"Cumprod":{const c=E("axis",s,e,t),u=E("exclusive",s,e,t),h=E("reverse",s,e,t);return[n.cumprod(E("x",s,e,t),c,u,h)]}case"Cumsum":{const c=E("axis",s,e,t),u=E("exclusive",s,e,t),h=E("reverse",s,e,t);return[n.cumsum(E("x",s,e,t),c,u,h)]}case"Bincount":const a=E("x",s,e,t),o=E("weights",s,e,t),i=E("size",s,e,t);return[n.bincount(a,o,i)];case"DenseBincount":{const c=E("x",s,e,t),u=E("weights",s,e,t),h=E("size",s,e,t),p=E("binaryOutput",s,e,t);return[n.denseBincount(c,u,h,p)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DG=(s,e,t,n=Tn)=>{switch(s.op){case"ConcatV2":case"Concat":{const a=E("n",s,e,t),o=E("axis",s,e,t);let i=E("tensors",s,e,t);return i=i.slice(0,a),[n.concat(i,o)]}case"Gather":{const a=E("x",s,e,t),o=E("indices",s,e,t);return[n.gather(a,n.cast(o,"int32"),0)]}case"GatherV2":{const a=E("axis",s,e,t),o=E("batchDims",s,e,t),i=E("x",s,e,t),c=E("indices",s,e,t);return[n.gather(i,n.cast(c,"int32"),a,o)]}case"Reverse":{const a=E("dims",s,e,t),o=[];for(let c=0;c<a.length;c++)a[c]&&o.push(c);const i=E("x",s,e,t);return[n.reverse(i,o)]}case"ReverseV2":{const a=E("axis",s,e,t),o=E("x",s,e,t);return[n.reverse(o,a)]}case"Slice":{const a=E("begin",s,e,t),o=E("size",s,e,t);return[n.slice(E("x",s,e,t),a,o)]}case"StridedSlice":{const a=E("begin",s,e,t),o=E("end",s,e,t),i=E("strides",s,e,t),c=E("beginMask",s,e,t),u=E("endMask",s,e,t),h=E("ellipsisMask",s,e,t),p=E("newAxisMask",s,e,t),f=E("shrinkAxisMask",s,e,t),g=E("x",s,e,t);return[n.stridedSlice(g,a,o,i,c,u,h,p,f)]}case"Pack":return me(()=>{const a=E("axis",s,e,t),o=E("tensors",s,e,t),i=o[0].shape,c=n.squeeze(o[0]).shape,u=o.map(h=>{const p=zt(h.shape,i);if(!p&&!zt(n.squeeze(h).shape,c))throw new Error("the input tensors shape does not match");return p?h:n.reshape(h,i)});return[n.stack(u,a)]});case"Unpack":{const a=E("axis",s,e,t),o=E("tensor",s,e,t);return n.unstack(o,a)}case"Tile":{const a=E("reps",s,e,t);return[n.tile(E("x",s,e,t),a)]}case"Split":case"SplitV":{const a=E("axis",s,e,t),o=E("numOrSizeSplits",s,e,t),i=E("x",s,e,t);return n.split(i,o,a)}case"ScatterNd":{const a=E("indices",s,e,t),o=E("values",s,e,t),i=E("shape",s,e,t);return[n.scatterND(a,o,i)]}case"GatherNd":{const a=E("x",s,e,t),o=E("indices",s,e,t);return[n.gatherND(a,o)]}case"SparseToDense":{const a=E("sparseIndices",s,e,t),o=E("outputShape",s,e,t),i=E("sparseValues",s,e,t),c=E("defaultValue",s,e,t);return[n.sparseToDense(a,i,o,i.dtype===c.dtype?c:n.cast(c,i.dtype))]}case"TensorScatterUpdate":{const a=E("indices",s,e,t),o=E("values",s,e,t),i=E("tensor",s,e,t);return[n.tensorScatterUpdate(i,a,o)]}default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RG=(s,e,t,n=Tn)=>{switch(s.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:o,emptyRowIndicator:i,reverseIndexMap:c}=n.sparse.sparseFillEmptyRows(E("indices",s,e,t),E("values",s,e,t),E("denseShape",s,e,t),E("defaultValue",s,e,t));return[a,o,i,c]}case"SparseReshape":{const{outputIndices:a,outputShape:o}=n.sparse.sparseReshape(E("inputIndices",s,e,t),E("inputShape",s,e,t),E("newShape",s,e,t));return[a,o]}case"SparseSegmentMean":return[n.sparse.sparseSegmentMean(E("data",s,e,t),E("indices",s,e,t),E("segmentIds",s,e,t))];case"SparseSegmentSum":return[n.sparse.sparseSegmentSum(E("data",s,e,t),E("indices",s,e,t),E("segmentIds",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OG=(s,e,t,n=Tn)=>{switch(s.op){case"FFT":return[n.fft(E("x",s,e,t))];case"IFFT":return[n.ifft(E("x",s,e,t))];case"RFFT":return[n.rfft(E("x",s,e,t))];case"IRFFT":return[n.irfft(E("x",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _G=(s,e,t,n=Tn)=>{switch(s.op){case"StaticRegexReplace":return[n.string.staticRegexReplace(E("input",s,e,t),E("pattern",s,e,t),E("rewrite",s,e,t),E("replaceGlobal",s,e,t))];case"StringNGrams":{const{nGrams:a,nGramsSplits:o}=n.string.stringNGrams(E("data",s,e,t),E("dataSplits",s,e,t),E("separator",s,e,t),E("nGramWidths",s,e,t),E("leftPad",s,e,t),E("rightPad",s,e,t),E("padWidth",s,e,t),E("preserveShortSequences",s,e,t));return[a,o]}case"StringSplit":{const{indices:a,values:o,shape:i}=n.string.stringSplit(E("input",s,e,t),E("delimiter",s,e,t),E("skipEmpty",s,e,t));return[a,o,i]}case"StringToHashBucketFast":return[n.string.stringToHashBucketFast(E("input",s,e,t),E("numBuckets",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FG=(s,e,t,n=Tn)=>{switch(s.op){case"Cast":return[n.cast(E("x",s,e,t),E("dtype",s,e,t))];case"ExpandDims":{const a=E("axis",s,e,t);return[n.expandDims(E("x",s,e,t),a)]}case"Squeeze":{const a=E("axis",s,e,t);return[n.squeeze(E("x",s,e,t),a)]}case"Reshape":return[n.reshape(E("x",s,e,t),E("shape",s,e,t))];case"EnsureShape":return[n.ensureShape(E("x",s,e,t),E("shape",s,e,t))];case"MirrorPad":return[n.mirrorPad(E("x",s,e,t),E("padding",s,e,t),E("mode",s,e,t))];case"PadV2":case"Pad":return[n.pad(E("x",s,e,t),E("padding",s,e,t),E("constantValue",s,e,t))];case"SpaceToBatchND":{const a=E("blockShape",s,e,t),o=E("paddings",s,e,t);return[n.spaceToBatchND(E("x",s,e,t),a,o)]}case"BatchToSpaceND":{const a=E("blockShape",s,e,t),o=E("crops",s,e,t);return[n.batchToSpaceND(E("x",s,e,t),a,o)]}case"DepthToSpace":{const a=E("blockSize",s,e,t),o=E("dataFormat",s,e,t).toUpperCase();return[n.depthToSpace(E("x",s,e,t),a,o)]}case"BroadcastTo":return[n.broadcastTo(E("x",s,e,t),E("shape",s,e,t))];case"BroadcastArgs":return[n.broadcastArgs(E("s0",s,e,t),E("s1",s,e,t))];default:throw TypeError("Node type ".concat(s.op," is not implemented"))}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iC(s,e,t,n,a=me){const o=((i,c,u)=>{switch(i.category){case"arithmetic":return a(()=>dG(i,c,u));case"basic_math":return a(()=>hG(i,c,u));case"control":return bG(i,c,u);case"convolution":return a(()=>yG(i,c,u));case"creation":return a(()=>vG(i,c,u));case"dynamic":return wG(i,c,u);case"evaluation":return a(()=>NG(i,c,u));case"image":return a(()=>kG(i,c,u));case"graph":return a(()=>SG(i,c,u));case"logical":return a(()=>TG(i,c,u));case"matrices":return a(()=>IG(i,c,u));case"normalization":return a(()=>$G(i,c,u));case"ragged":return a(()=>AG(i,c,u));case"reduction":return a(()=>EG(i,c,u));case"slice_join":return a(()=>DG(i,c,u));case"sparse":return a(()=>RG(i,c,u));case"spectral":return a(()=>OG(i,c,u));case"string":return a(()=>_G(i,c,u));case"transformation":return a(()=>FG(i,c,u));case"hash_table":return jG(i,c,u,n);case"custom":const h=wI(i.op);if(h&&h.customExecutor)return h.customExecutor(new uG(i,c,u));throw TypeError("Custom op ".concat(i.op," is not registered."));default:throw TypeError("Unknown op '".concat(i.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(s,e,t);return zl(o)?o.then(i=>[].concat(i)):[].concat(o)}class lC{constructor(e={},t={},n={},a={},o){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=a,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":"".concat(t.frameName,"-").concat(t.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cC(s,e,t,n){const a=new Set,o=[];let i=null,c=null;const u=new Set,h=new Set(Object.keys(s).map(g=>xa(g)[0]));n=n||[];const p=new Set(n.map(g=>xa(g.name)[0])),f=[...e];for(;f.length>0;){const g=f.pop();if((Al(g)||GG(g)||WG(g))&&i==null&&(i=g,c=i.children.map(b=>b.name).filter(b=>a.has(b))),a.add(g.name),t[g.name]==null&&!h.has(g.name)&&!p.has(g.name)){if(g.inputs.length===0){o.push(g.name);continue}g.inputs.forEach(b=>{u.has(b.name)||(u.add(b.name),f.push(b))})}}return{inputs:s,outputs:e,usedNodes:a,missingInputs:o,dynamicNode:i,syncInputs:c}}function LG(s,e){const{usedNodes:t,inputs:n}=e,a=Object.keys(n).map(v=>xa(v)[0]).map(v=>s.nodes[v]),o=s.initNodes||[],i=v=>t.has(typeof v=="string"?v:v.name);function c(v){return[...new Map(v.map(N=>[N.name,N])).values()]}const u=c([...a,...s.weights,...o]).filter(i),h=c([...u,...Object.values(s.nodes)]).filter(i),p=new Map(h.map(v=>[v.name,v])),f={};for(const v of h){f[v.name]=f[v.name]||0;for(const N of v.children)i(N)||(f[N.name]=Number.POSITIVE_INFINITY),f[N.name]=(f[N.name]||0)+1}const g=Object.entries(f).filter(([,v])=>v===0).map(([v])=>v),b=[...g];for(;g.length>0;){const v=g.pop(),N=p.get(v);for(const C of N.children.filter(i))--f[C.name]===0&&(b.push(C.name),g.push(C.name))}const y=b.map(v=>p.get(v)),w=MG(y,u);return PG(w,u),w}function MG(s,e){const t=new Map(s.map(i=>[i.name,i])),n=e.map(i=>i.name),a=new Set(n);for(;n.length>0;){const i=n.pop(),c=t.get(i);for(const u of c.children)!t.has(u.name)||a.has(u.name)||(a.add(u.name),n.push(u.name))}return s.filter(i=>a.has(i.name))}class im extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}}function PG(s,e){const t=new Map(s.map((c,u)=>[c.name,u])),n=new Set(e.map(c=>c.name)),a=c=>n.has(typeof c=="string"?c:c.name),o=new Set(s.map(c=>c.name)),i=c=>o.has(typeof c=="string"?c:c.name);for(const c of s){for(const u of c.children.filter(i)){if(!t.has(u.name))throw new im("Child ".concat(u.name," of node ").concat(c.name," is unreachable."));if(t.get(c.name)>t.get(u.name))throw new im("Node ".concat(c.name," is scheduled to run after its child ").concat(u.name,"."))}if(!a(c))for(const u of c.inputs){if(!t.has(u.name))throw new im("Input ".concat(u.name," of node ").concat(c.name," is unreachable."));if(t.get(u.name)>t.get(c.name))throw new im("Node ".concat(c.name," is scheduled to run before its input ").concat(u.name,"."))}}}function zG(s){const e=new Map(s.map((c,u)=>[c.name,u])),t=Number.MAX_SAFE_INTEGER,n=s.map((c,u)=>Al(c)?t:u),a=c=>{const u=n[e.get(c.name)];return u==null?-1:u},o=s.map((c,u)=>c.children.map(a).reduce((h,p)=>Math.max(h,p),n[u])),i=new Map;for(let c=0;c<s.length;++c){const u=o[c];if(u===t)continue;const h=s[c],p=s[u];i.has(p.name)||i.set(p.name,[]),i.get(p.name).push(h)}return i}const BG=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),VG=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),UG=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Al(s){return BG.has(s.op)}function GG(s){return VG.has(s.op)}function WG(s){return UG.has(s.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bm{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(n=>e[n].map(a=>a.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(n=>{this._functionExecutorMap[n]=new Bm(e.functions[n],this)})}getCompilationKey(e,t){const n=e.map(o=>o.name).sort(),a=t.map(o=>o.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){const n=cC(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:o,syncInputs:i}=n;if(o!=null)throw new Error("This execution contains the node '".concat(o.name,"', which has ")+"the dynamic op '".concat(o.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(a.length>0){const h=t.map(f=>f.name),p=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(h,"] from the provided inputs ")+"[".concat(p,"]. Missing the following inputs: [").concat(a,"]"))}const c=LG(this.graph,n),u=zG(c);return{orderedNodes:c,nodeLiveUntilMap:u}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return pn(t),t}cloneTensorList(e){return e?e.map(n=>this.cloneAndKeepTensor(n)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,this.cloneTensorList(n)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const a=n.map(g=>this.graph.nodes[xa(g)[0]]),o=t.map(g=>xa(g)[0]),i=new Set(o);let c=o.map(g=>this.graph.nodes[g]);c.length===0&&(c=this._outputs);const u=this.getCompilationKey(a,c);let h=this.compiledMap.get(u);h==null&&(h=this.compile(e,c),this.compiledMap.set(u,h));try{this.keepIntermediateTensors=Se().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const p={},f={};return me(()=>{const g=new lC(this.weightMap,p,f,this.functionExecutorMap,this.parseNodeNameCache),b=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(N=>{const[C,T]=xa(N,g),I=[];I[T]=e[N],b[C]=I,this.keepIntermediateTensors&&(this.clonedTensorsMap[C]=this.cloneTensorList(I))});const y=this.getFrozenTensorIds(b),{orderedNodes:w,nodeLiveUntilMap:v}=h;for(const N of w){if(b[N.name])continue;const C=iC(N,b,g,this._resourceManager);if(zl(C))throw new Error("The execution of the op '".concat(N.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");b[N.name]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[N.name]=this.cloneTensorList(C)),this.checkTensorForDisposalWithNodeLiveUntilInfo(N,b,g,y,i,v.get(N.name))}return this.parent==null&&g.dispose(y),t.map(N=>wn(N,b,g))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(n=>e[n]).map(n=>n.map(a=>a.id)));return new Set(t)}checkTensorForDisposal(e,t,n,a,o,i,c){if(!(Al(t)||i.has(e))){for(const u of n[e])u!=null&&(c[u.id]=(c[u.id]||0)+t.children.length);for(const u of t.inputs){if(Al(u))continue;const h=sC(u.name,n,a);if(h!=null)for(const p of h){if(!p||p.kept||o.has(p.id))continue;const f=c[p.id];f===1?(p.dispose(),delete c[p.id]):f!=null&&c[p.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,a,o,i){function c(u){return Al(u)||o.has(u.name)}if(!(Al(e)||i==null))for(const u of i){if(c(u))continue;const h=sC(u.name,t,n);for(const p of h)!p||p.kept||a.has(p.id)||p.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,a={},o={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Se().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const i=new lC(this.weightMap,a,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const c=await this.executeWithControlFlow(e,i,t,n),u=t.map(g=>wn(g,c,i)),h=u.map(g=>g.id),p=Object.keys(e).map(g=>e[g].id),f=new Set([...h,...p,...this.weightIds]);return Object.values(c).forEach(g=>{g.forEach(b=>{b&&!b.isDisposed&&!f.has(b.id)&&b.dispose()})}),this.parent==null&&i.dispose(f),u}async executeFunctionAsync(e,t,n){const a=e.reduce((o,i,c)=>(o[this.inputs[c].name]=i,o),{});return this._executeAsync(a,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,a){const o=Object.keys(e),i=o.map(I=>this.graph.nodes[xa(I)[0]]),c=n.map(I=>xa(I)[0]),u=new Set(c);let h=c.map(I=>this.graph.nodes[I]);h.length===0&&(h=this._outputs);const{usedNodes:p,missingInputs:f,dynamicNode:g,syncInputs:b}=cC(e,h,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(I=>({node:I,contexts:t.currentContext})),w=Object.assign({},this.weightMap);Object.keys(e).forEach(I=>{const[$,R]=xa(I),O=[];O[R]=e[I],w[$]=O});const v={},N=this.getFrozenTensorIds(w),C={};for(;y.length>0;){const I=this.processStack(i,y,t,w,C,N,u,v,p);await Promise.all(I)}g==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const T=h.filter(I=>!Al(I)&&!wn(I.name,w,t)).map(I=>I.name);if(T.length>0){let I="";throw g!=null&&(I="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(b,"]")),new Error("Cannot compute the outputs [".concat(T,"] from the provided ")+"inputs [".concat(o,"]. Consider providing the following inputs: ")+"[".concat(f,"]. ").concat(I))}return w}processStack(e,t,n,a,o,i,c,u,h){const p=[];for(;t.length>0;){const f=t.pop();n.currentContext=f.contexts;let g="";if(f.node.op==="Enter"&&E("isConstant",f.node,a,n)&&([g]=Io(f.node.name,n)),a[f.node.name]==null){const b=iC(f.node,a,n,this._resourceManager);g||([g]=Io(f.node.name,n));const y=n.currentContext;zl(b)?p.push(b.then(w=>(a[g]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(w)),n.currentContext=y,this.checkTensorForDisposal(g,f.node,a,n,i,c,u),this.processChildNodes(f.node,t,n,a,o,h),w))):(a[g]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(b)),this.checkTensorForDisposal(g,f.node,a,n,i,c,u),this.processChildNodes(f.node,t,n,a,o,h))}else this.processChildNodes(f.node,t,n,a,o,h)}return p}processChildNodes(e,t,n,a,o,i){e.children.forEach(c=>{const[u]=Io(c.name,n);o[u]||!i.has(c.name)||(c.op==="Merge"?c.inputNames.some(h=>!!wn(h,a,n))&&(o[u]=!0,t.push({contexts:n.currentContext,node:c})):c.inputNames.every(h=>!!wn(h,a,n))&&(o[u]=!0,t.push({contexts:n.currentContext,node:c})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[a]=xa(t),o=this.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,c=i.length===n.shape.length&&n.shape.every((u,h)=>i[h]===-1||i[h]===u);V(c,()=>"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(i,"], but was ")+"[".concat(n.shape,"]"))}o.attrParams.dtype&&o.attrParams.dtype.value&&V(n.dtype===o.attrParams.dtype.value,()=>"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;const a={};for(const o in e){const i=(n=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||n===void 0?void 0:n[o];i!=null?a[i.name]=e[o]:a[o]=e[o]}return a}checkInputs(e){const t=Object.keys(e).filter(n=>{const[a]=xa(n);return this.graph.nodes[a]==null});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(t=>{var n,a;const o=(a=(n=this._signature)===null||n===void 0?void 0:n.outputs)===null||a===void 0?void 0:a[t];return o!=null?o.name:t},{})}checkOutputs(e){e.forEach(t=>{const[n]=xa(t);if(!this.graph.nodes[n])throw new Error("The output '".concat(t,"' is not found in the graph"))})}}class HG{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qG="?tfjs-format=file",KG="model.json";class XG{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=BT){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new HG}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return zl(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await dk(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(a=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=a,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new Bm(nC.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=nC.Instance.transformGraph(e.modelInitializer);this.initializer=new Bm(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(n.length>1)throw new Error("Found more than one (".concat(n.length,") save handlers for ")+"URL '".concat(e,"'"));e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof os?[e]:e,n={};return t.forEach((a,o)=>n[this.structuredOutputKeys[o]]=a),n}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof os)&&!Array.isArray(e)){const o=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(o!=null)for(const i in o){const c=o[i];c.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[c.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let a=0;return this.inputNodes.reduce((o,i)=>{var c,u,h;const p=(h=(u=(c=this.signature)===null||c===void 0?void 0:c.inputs)===null||u===void 0?void 0:u[i])===null||h===void 0?void 0:h.resourceId;return p!=null?o[i]=this.resourceIdToCapturedInput[p]:o[i]=e[a++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let a=0;a<n.length;a++){const o=n[a],i=t[o];this.resourceIdToCapturedInput[i.resourceId]=e[a]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&kt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function YG(s,e={},t=BT){if(s==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof s=="string"&&(s=ZG(s));const n=new XG(s,e,t);return await n.load(),n}function ZG(s){return s.endsWith("/")||(s=s+"/"),"".concat(s).concat(KG).concat(qG)}/**
    * @license
    * Copyright 2024 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var Mi=function(){return Mi=Object.assign||function(s){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a]);return s},Mi.apply(this,arguments)};function Po(s,e,t,n){return new(t||(t=Promise))(function(a,o){function i(h){try{u(n.next(h))}catch(p){o(p)}}function c(h){try{u(n.throw(h))}catch(p){o(p)}}function u(h){var p;h.done?a(h.value):(p=h.value,p instanceof t?p:new t(function(f){f(p)})).then(i,c)}u((n=n.apply(s,[])).next())})}function zo(s,e){var t,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return function(p){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(a=2&p[0]?n.return:p[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,p[1])).done)return a;switch(n=0,a&&(p=[2&p[0],a.value]),p[0]){case 0:case 1:a=p;break;case 4:return i.label++,{value:p[1],done:!1};case 5:i.label++,n=p[1],p=[0];continue;case 7:p=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!((a=a.length>0&&a[a.length-1])||p[0]!==6&&p[0]!==2)){i=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){i.label=p[1];break}if(p[0]===6&&i.label<a[1]){i.label=a[1],a=p;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(p);break}a[2]&&i.ops.pop(),i.trys.pop();continue}p=e.call(s,i)}catch(f){p=[6,f],n=0}finally{t=a=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([u,h])}}}var CI=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],b1={modelType:"short",runtime:"mediapipe",maxFaces:1},QG=function(){function s(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new z8.FaceDetection({locateFile:function(n,a){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(n)}return"".concat(a,"/").concat(n)}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:e.modelType}),this.faceDetectorSolution.onResults(function(n){if(t.height=n.image.height,t.width=n.image.width,t.faces=[],n.detections!==null)for(var a=0,o=n.detections;a<o.length;a++){var i=o[a];t.faces.push(t.normalizedToAbsolute(i.landmarks,(c=i.boundingBox,u=void 0,h=void 0,p=void 0,u=c.xCenter-c.width/2,h=u+c.width,p=c.yCenter-c.height/2,{xMin:u,xMax:h,yMin:p,yMax:p+c.height,width:c.width,height:c.height})))}var c,u,h,p})}return s.prototype.normalizedToAbsolute=function(e,t){var n=this;return{keypoints:e.map(function(a,o){return{x:a.x*n.width,y:a.y*n.height,name:CI[o]}}),box:{xMin:t.xMin*this.width,yMin:t.yMin*this.height,xMax:t.xMax*this.width,yMax:t.yMax*this.height,width:t.width*this.width,height:t.height*this.height}}},s.prototype.estimateFaces=function(e,t){return Po(this,void 0,void 0,function(){var n,a;return zo(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),e instanceof os?(a=ImageData.bind,[4,uU(e)]):[3,2];case 1:return n=new(a.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,o.label=3;case 3:return e=n,[4,this.faceDetectorSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}})})},s.prototype.dispose=function(){this.faceDetectorSolution.close()},s.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},s.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},s}();function JG(s){return Po(this,void 0,void 0,function(){var e,t;return zo(this,function(n){switch(n.label){case 0:return e=function(a){if(a==null)return Mi({},b1);var o=Mi({},a);return o.runtime="mediapipe",o.modelType==null&&(o.modelType=b1.modelType),o.maxFaces==null&&(o.maxFaces=b1.maxFaces),o}(s),[4,(t=new QG(e)).initialize()];case 1:return n.sent(),[2,t]}})})}function eW(s,e,t,n){var a=s.width,o=s.height,i=1,c=Math.cos(s.rotation),u=Math.sin(s.rotation),h=s.xCenter,p=s.yCenter,f=1/e,g=1/t,b=new Array(16);return b[0]=a*c*i*f,b[1]=-o*u*f,b[2]=0,b[3]=(-.5*a*c*i+.5*o*u+h)*f,b[4]=a*u*i*g,b[5]=o*c*g,b[6]=0,b[7]=(-.5*o*c-.5*a*u*i+p)*g,b[8]=0,b[9]=0,b[10]=a*f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,function(y){if(y.length!==16)throw new Error("Array length must be 16 but got ".concat(y.length));return[[y[0],y[1],y[2],y[3]],[y[4],y[5],y[6],y[7]],[y[8],y[9],y[10],y[11]],[y[12],y[13],y[14],y[15]]]}(b)}function jI(s){return s instanceof os?{height:s.shape[0],width:s.shape[1]}:{height:s.height,width:s.width}}function kI(s){return s instanceof os?s:dU(s)}function y1(s,e){V(s.width!==0,function(){return"".concat(e," width cannot be 0.")}),V(s.height!==0,function(){return"".concat(e," height cannot be 0.")})}function tW(s,e){var t=function(n,a,o,i){var c=a-n,u=i-o,h=u/c;return{scale:h,offset:o-n*h}}(0,255,e[0],e[1]);return me(function(){return Me(ae(s,t.scale),t.offset)})}function sW(s,e,t){var n=e.outputTensorSize,a=e.keepAspectRatio,o=e.borderMode,i=e.outputTensorFloatRange,c=jI(s),u=function(g,b){return{xCenter:.5*g.width,yCenter:.5*g.height,width:g.width,height:g.height,rotation:0}}(c),h=function(g,b,y){if(y===void 0&&(y=!1),!y)return{top:0,left:0,right:0,bottom:0};var w=b.height,v=b.width;y1(b,"targetSize"),y1(g,"roi");var N,C,T=w/v,I=g.height/g.width,$=0,R=0;return T>I?(N=g.width,C=g.width*T,R=(1-I/T)/2):(N=g.height/T,C=g.height,$=(1-T/I)/2),g.width=N,g.height=C,{top:R,left:$,right:$,bottom:R}}(u,n,a),p=eW(u,c.width,c.height),f=me(function(){var g=kI(s),b=_l(function(v,N,C){return y1(C,"inputResolution"),[1/C.width*v[0][0]*N.width,1/C.height*v[0][1]*N.width,v[0][3]*N.width,1/C.width*v[1][0]*N.height,1/C.height*v[1][1]*N.height,v[1][3]*N.height,0,0]}(p,c,n),[1,8]),y=o==="zero"?"constant":"nearest",w=_a.transform(vn(Xe(g,"float32")),b,"bilinear",y,0,[n.height,n.width]);return i!=null?tW(w,i):w});return{imageTensor:f,padding:h,transformationMatrix:p}}function uC(s){s.reduceBoxesInLowestLayer==null&&(s.reduceBoxesInLowestLayer=!1),s.interpolatedScaleAspectRatio==null&&(s.interpolatedScaleAspectRatio=1),s.fixedAnchorSize==null&&(s.fixedAnchorSize=!1);for(var e=[],t=0;t<s.numLayers;){for(var n=[],a=[],o=[],i=[],c=t;c<s.strides.length&&s.strides[c]===s.strides[t];){var u=dC(s.minScale,s.maxScale,c,s.strides.length);if(c===0&&s.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),i.push(.1),i.push(u),i.push(u);else{for(var h=0;h<s.aspectRatios.length;++h)o.push(s.aspectRatios[h]),i.push(u);if(s.interpolatedScaleAspectRatio>0){var p=c===s.strides.length-1?1:dC(s.minScale,s.maxScale,c+1,s.strides.length);i.push(Math.sqrt(u*p)),o.push(s.interpolatedScaleAspectRatio)}}c++}for(var f=0;f<o.length;++f){var g=Math.sqrt(o[f]);n.push(i[f]/g),a.push(i[f]*g)}var b=0,y=0;if(s.featureMapHeight.length>0)b=s.featureMapHeight[t],y=s.featureMapWidth[t];else{var w=s.strides[t];b=Math.ceil(s.inputSizeHeight/w),y=Math.ceil(s.inputSizeWidth/w)}for(var v=0;v<b;++v)for(var N=0;N<y;++N)for(var C=0;C<n.length;++C){var T={xCenter:(N+s.anchorOffsetX)/y,yCenter:(v+s.anchorOffsetY)/b,width:0,height:0};s.fixedAnchorSize?(T.width=1,T.height=1):(T.width=a[C],T.height=n[C]),e.push(T)}t=c}return e}function dC(s,e,t,n){return n===1?.5*(s+e):s+(e-s)*t/(n-1)}function hC(s,e){var t=e[0],n=e[1];return[t*s[0]+n*s[1]+s[3],t*s[4]+n*s[5]+s[7]]}function nW(s){return me(function(){var e=function(a){return me(function(){return[yt(a,[0,0,0],[1,-1,1]),yt(a,[0,0,1],[1,-1,-1])]})}(s),t=e[0],n=e[1];return{boxes:Rs(n),logits:Rs(t)}})}function aW(s,e,t,n){return Po(this,void 0,void 0,function(){var a,o,i,c,u;return zo(this,function(h){switch(h.label){case 0:return s.sort(function(p,f){return Math.max.apply(Math,f.score)-Math.max.apply(Math,p.score)}),a=_l(s.map(function(p){return[p.locationData.relativeBoundingBox.yMin,p.locationData.relativeBoundingBox.xMin,p.locationData.relativeBoundingBox.yMax,p.locationData.relativeBoundingBox.xMax]})),o=Us(s.map(function(p){return p.score[0]})),[4,_a.nonMaxSuppressionAsync(a,o,e,t)];case 1:return[4,(i=h.sent()).array()];case 2:return c=h.sent(),u=s.filter(function(p,f){return c.indexOf(f)>-1}),kt([a,o,i]),[2,u]}})})}function rW(s,e,t){return Po(this,void 0,void 0,function(){var n,a,o,i,c;return zo(this,function(u){switch(u.label){case 0:return n=s[0],a=s[1],o=function(h,p,f){return me(function(){var g,b,y,w;f.reverseOutputOrder?(b=Rs(yt(h,[0,f.boxCoordOffset+0],[-1,1])),g=Rs(yt(h,[0,f.boxCoordOffset+1],[-1,1])),w=Rs(yt(h,[0,f.boxCoordOffset+2],[-1,1])),y=Rs(yt(h,[0,f.boxCoordOffset+3],[-1,1]))):(g=Rs(yt(h,[0,f.boxCoordOffset+0],[-1,1])),b=Rs(yt(h,[0,f.boxCoordOffset+1],[-1,1])),y=Rs(yt(h,[0,f.boxCoordOffset+2],[-1,1])),w=Rs(yt(h,[0,f.boxCoordOffset+3],[-1,1]))),b=Me(ae(Qe(b,f.xScale),p.w),p.x),g=Me(ae(Qe(g,f.yScale),p.h),p.y),f.applyExponentialOnBoxSize?(y=ae(Wn(Qe(y,f.hScale)),p.h),w=ae(Wn(Qe(w,f.wScale)),p.w)):(y=ae(Qe(y,f.hScale),p.h),w=ae(Qe(w,f.wScale),p.h));var v=tt(g,Qe(y,2)),N=tt(b,Qe(w,2)),C=Me(g,Qe(y,2)),T=Me(b,Qe(w,2)),I=Ts([le(v,[f.numBoxes,1]),le(N,[f.numBoxes,1]),le(C,[f.numBoxes,1]),le(T,[f.numBoxes,1])],1);if(f.numKeypoints)for(var $=0;$<f.numKeypoints;++$){var R=f.keypointCoordOffset+$*f.numValuesPerKeypoint,O=void 0,P=void 0;f.reverseOutputOrder?(O=Rs(yt(h,[0,R],[-1,1])),P=Rs(yt(h,[0,R+1],[-1,1]))):(P=Rs(yt(h,[0,R],[-1,1])),O=Rs(yt(h,[0,R+1],[-1,1])));var _=Me(ae(Qe(O,f.xScale),p.w),p.x),M=Me(ae(Qe(P,f.yScale),p.h),p.y);I=Ts([I,le(_,[f.numBoxes,1]),le(M,[f.numBoxes,1])],1)}return I})}(a,e,t),i=me(function(){var h=n;return t.sigmoidScore?(t.scoreClippingThresh!=null&&(h=oa(n,-t.scoreClippingThresh,t.scoreClippingThresh)),h=kr(h)):h}),[4,oW(o,i,t)];case 1:return c=u.sent(),kt([o,i]),[2,c]}})})}function oW(s,e,t){return Po(this,void 0,void 0,function(){var n,a,o,i,c,u,h,p,f,g,b,y;return zo(this,function(w){switch(w.label){case 0:return n=[],[4,s.data()];case 1:return a=w.sent(),[4,e.data()];case 2:for(o=w.sent(),i=0;i<t.numBoxes;++i)if(!(t.minScoreThresh!=null&&o[i]<t.minScoreThresh||(c=i*t.numCoords,u=iW(a[c+0],a[c+1],a[c+2],a[c+3],o[i],t.flipVertically,i),(h=u.locationData.relativeBoundingBox).width<0||h.height<0))){if(t.numKeypoints>0)for((p=u.locationData).relativeKeypoints=[],f=t.numKeypoints*t.numValuesPerKeypoint,g=0;g<f;g+=t.numValuesPerKeypoint)b=c+t.keypointCoordOffset+g,y={x:a[b+0],y:t.flipVertically?1-a[b+1]:a[b+1]},p.relativeKeypoints.push(y);n.push(u)}return[2,n]}})})}function iW(s,e,t,n,a,o,i){return{score:[a],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-t:s,xMax:n,yMax:o?1-s:t,width:n-e,height:t-s}}}}var lW={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},cW={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},v1={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},uW={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},dW={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},hW=.3,pW={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},fW={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},Vm,mW=function(){function s(e,t,n){this.detectorModel=t,this.maxFaces=n,e==="full"?(this.imageToTensorConfig=fW,this.tensorsToDetectionConfig=dW,this.anchors=uC(cW)):(this.imageToTensorConfig=pW,this.tensorsToDetectionConfig=uW,this.anchors=uC(lW));var a=Us(this.anchors.map(function(u){return u.width})),o=Us(this.anchors.map(function(u){return u.height})),i=Us(this.anchors.map(function(u){return u.xCenter})),c=Us(this.anchors.map(function(u){return u.yCenter}));this.anchorTensor={x:i,y:c,w:a,h:o}}return s.prototype.dispose=function(){this.detectorModel.dispose(),kt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},s.prototype.reset=function(){},s.prototype.detectFaces=function(e,t){return t===void 0&&(t=!1),Po(this,void 0,void 0,function(){var n,a,o,i,c,u,h,p,f,g,b;return zo(this,function(y){switch(y.label){case 0:return e==null?(this.reset(),[2,[]]):(n=me(function(){var w=Xe(kI(e),"float32");return t&&(w=Rs(_a.flipLeftRight(vn(w,0)),[0])),w}),a=sW(n,this.imageToTensorConfig),o=a.imageTensor,i=a.transformationMatrix,c=this.detectorModel.execute(o,"Identity:0"),u=nW(c),h=u.boxes,[4,rW([p=u.logits,h],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return(f=y.sent()).length===0?(kt([n,o,c,p,h]),[2,f]):[4,aW(f,this.maxFaces,hW)];case 2:return g=y.sent(),b=function(w,v){w===void 0&&(w=[]);var N,C=(N=v,[].concat.apply([],N));return w.forEach(function(T){var I=T.locationData;I.relativeKeypoints.forEach(function(M){var A=hC(C,[M.x,M.y]),U=A[0],K=A[1];M.x=U,M.y=K});var $=I.relativeBoundingBox,R=Number.MAX_VALUE,O=Number.MAX_VALUE,P=Number.MIN_VALUE,_=Number.MIN_VALUE;[[$.xMin,$.yMin],[$.xMin+$.width,$.yMin],[$.xMin+$.width,$.yMin+$.height],[$.xMin,$.yMin+$.height]].forEach(function(M){var A=hC(C,M),U=A[0],K=A[1];R=Math.min(R,U),P=Math.max(P,U),O=Math.min(O,K),_=Math.max(_,K)}),I.relativeBoundingBox={xMin:R,xMax:P,yMin:O,yMax:_,width:P-R,height:_-O}}),w}(g,i),kt([n,o,c,p,h]),[2,b]}})})},s.prototype.estimateFaces=function(e,t){return Po(this,void 0,void 0,function(){var n,a;return zo(this,function(o){return n=jI(e),a=!!t&&t.flipHorizontal,[2,this.detectFaces(e,a).then(function(i){return i.map(function(c){for(var u=c.locationData.relativeKeypoints.map(function(y,w){return Mi(Mi({},y),{x:y.x*n.width,y:y.y*n.height,name:CI[w]})}),h=c.locationData.relativeBoundingBox,p=0,f=["width","xMax","xMin"];p<f.length;p++)h[f[p]]*=n.width;for(var g=0,b=["height","yMax","yMin"];g<b.length;g++)h[b[g]]*=n.height;return{keypoints:u,box:h}})})]})})},s}();function gW(s){return Po(this,void 0,void 0,function(){var e,t,n;return zo(this,function(a){switch(a.label){case 0:return e=function(o){if(o==null)return Mi({},v1);var i=Mi({},o);return i.modelType==null&&(i.modelType=v1.modelType),i.maxFaces==null&&(i.maxFaces=v1.maxFaces),i.detectorModelUrl==null&&(i.modelType==="full"?i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),i}(s),t=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,YG(e.detectorModelUrl,{fromTFHub:t})];case 1:return n=a.sent(),[2,new mW(e.modelType,n,e.maxFaces)]}})})}function xW(s,e){return Po(this,void 0,void 0,function(){var t,n;return zo(this,function(a){if(s===Vm.MediaPipeFaceDetector){if(n=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,gW(t)];if(t.runtime==="mediapipe")return[2,JG(t)];n=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(n))}throw new Error("".concat(s," is not a supported model name."))})})}(function(s){s.MediaPipeFaceDetector="MediaPipeFaceDetector"})(Vm||(Vm={}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TI={kernelName:ug,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,Fu(Xe(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bW={kernelName:$h,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=is(Xe(t,"float32")),a=Cn(tt(gt(1),n));return fs(Qe(s,a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yW={kernelName:Ah,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=Cn(tt(is(Xe(t,"float32")),1));return Qe(s,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vW={kernelName:Ru,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{let c=s;const u=sn(t.shape,a);return u.length>0&&(c=it(c,u)),le(c,t.shape)},b:()=>{let c=s;const u=sn(n.shape,a);return u.length>0&&(c=it(c,u)),le(c,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW={kernelName:dg,saveAllInputs:!0,gradFunc:(s,e)=>{const t={};return e.forEach((n,a)=>{t[a]=()=>s.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NW={kernelName:hg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Vt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SW={kernelName:pg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Vt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW={kernelName:Eh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,Cn(tt(gt(1),is(Xe(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW={kernelName:Dh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=Cn(Me(gt(1),is(Xe(t,"float32"))));return Qe(s,n)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW={kernelName:_h,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{const c=Me(is(t),is(n));let u=ae(s,Qe(n,c));const h=sn(t.shape,a);return h.length>0&&(u=it(u,h)),le(u,t.shape)},b:()=>{const c=Me(is(t),is(n));let u=fs(ae(s,Qe(t,c)));const h=sn(n.shape,a);return h.length>0&&(u=it(u,h)),le(u,n.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TW={kernelName:Rh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,Me(is(Xe(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW={kernelName:Oh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,tt(gt(1),is(Xe(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(s,e,t,n,a,o){const i=H(s,"dy","avgPool3dGrad"),c=H(e,"input","avgPool3dGrad");let u=i,h=c,p=!1;c.rank===4&&(p=!0,u=le(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),h=le(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),V(u.rank===5,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),V(h.rank===5,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")),Kn("avgPool3dGrad",a,o);const f={dy:u,input:h},g={filterSize:t,strides:n,pad:a,dimRoundingMode:o},b=re.runKernel(Uy,f,g);return p?le(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const AW=se({avgPool3dGrad_:$W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EW={kernelName:mg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{filterSize:a,strides:o,pad:i,dimRoundingMode:c}=t;return{x:()=>AW(s,n,a,o,i,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(s,e,t,n,a){const o=H(s,"dy","avgPoolGrad"),i=H(e,"input","avgPoolGrad");V(i.rank===o.rank,()=>"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(o.rank,")"));let c=i,u=o,h=!1;i.rank===3&&(h=!0,c=le(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=le(o,[1,o.shape[0],o.shape[1],o.shape[2]])),V(u.rank===4,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")),V(c.rank===4,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,"."));const p={dy:u,input:c},f={filterSize:t,strides:n,pad:a},g=re.runKernel(Vy,p,f);return h?le(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const RW=se({avgPoolGrad_:DW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OW={kernelName:fg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{filterSize:a,strides:o,pad:i}=t;return{x:()=>RW(s,n,a,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _W={kernelName:gg,inputsToSave:["a","b"],gradFunc:(s,e,t)=>{const[n,a]=e,{transposeA:o,transposeB:i}=t;return!o&&!i?{a:()=>Ft(s,a,!1,!0),b:()=>Ft(n,s,!0,!1)}:!o&&i?{a:()=>Ft(s,a,!1,!1),b:()=>Ft(s,n,!0,!1)}:o&&!i?{a:()=>Ft(a,s,!1,!0),b:()=>Ft(n,s,!1,!1)}:{a:()=>Ft(a,s,!0,!0),b:()=>Ft(s,n,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FW={kernelName:xg,gradFunc:(s,e,t)=>{const{blockShape:n,crops:a}=t;return{x:()=>Cx(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW={kernelName:n7,gradFunc:(s,e,t)=>{const n=t,a=n.inputShape,o=n.shape,i=Array.from(o);for(let u=a.length-1;u>=0;u--)if(a[u]===o[u])i[u]=1;else if(a[u]!==1)throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(o,"]."));const c=[];for(let u=0;u<i.length;u++)i[u]>1&&c.push(u);return{x:()=>it(s,c,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MW={kernelName:Fh,gradFunc:s=>({x:()=>s.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PW={kernelName:Lh,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zW={kernelName:Mh,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{clipValueMin:a,clipValueMax:o}=t;return{x:()=>Dn(to(Yi(n,a),tc(n,o)),s,Vt(s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BW={kernelName:yg,inputsToSave:["x"],gradFunc:TI.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW={kernelName:vg,saveAllInputs:!0,gradFunc:(s,e,t)=>{const n=e.map(u=>u.shape),{axis:a}=t,o=Rt(a,e[0].shape)[0],i=n.map(u=>u[o]);return va(s,i,o).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UW={kernelName:wg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,{dilations:o,strides:i,pad:c,dataFormat:u}=t;return V(Fi(o),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")),{x:()=>Z2(n.shape,s,a,i,c,u),filter:()=>jv(n,s,a.shape,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GW={kernelName:Ng,inputsToSave:["dy","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,{strides:o,pad:i,dataFormat:c,dimRoundingMode:u}=t;return{dy:()=>Li(s,a,o,i,c,1,u),filter:()=>jv(s,n,a.shape,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(s,e,t,n,a){let o=s;s.rank===4&&(o=le(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));let i=e;i.rank===4&&(i=le(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),V(o.rank===5,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(o.shape,".")),V(i.rank===5,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(i.shape,".")),V(t.length===5,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(t,".")),V(o.shape[4]===t[3],()=>"Error in conv3dDerFilter: depth of input ".concat(o.shape[4],") must ")+"match input depth in filter (".concat(t[3],".")),V(i.shape[4]===t[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must ")+"match output depth for filter (".concat(t[4],")."));const c={x:o,dy:i},u={strides:n,pad:a,filterShape:t};return re.runKernel(Ky,c,u)}const HW=se({conv3DBackpropFilter_:WW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qW={kernelName:Sg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const{dilations:n,strides:a,pad:o}=t;V(Fi(n),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(n,"'"));const[i,c]=e;return{x:()=>Uk(i.shape,s,c,a,o),filter:()=>HW(i,s,c.shape,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW={kernelName:Ph,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(fs(mv(Xe(t,"float32"))),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XW={kernelName:zh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(gv(Xe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW={kernelName:Cg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a,exclusive:o,reverse:i}=t;return{x:()=>{const c=ws([a],n.rank);let u=ev(s,a,o,!i);return c!=null&&(u=Bt(u,c)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZW={kernelName:jg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const{dilations:n,strides:a,pad:o,dimRoundingMode:i}=t,c=n==null?[1,1]:n;V(Fi(c),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'"));const[u,h]=e;return V(u.rank===4,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(u.rank,".")),V(h.rank===4,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(h.rank,".")),V(u.shape[3]===h.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(u.shape[3],") must match the inChannels dimension ")+"in filter ".concat(h.shape[2],".")),V(jn(a,c),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(c,"'.")),Kn("depthwiseConv2d",o,i),{x:()=>CT(u.shape,s,h,a,o,c,i),filter:()=>ST(u,s,h.shape,a,o,c,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QW={kernelName:kg,inputsToSave:["x","filter"],gradFunc:(s,e,t)=>{const[n,a]=e,o={x:n,filter:a,dy:s},i={x:n,filter:a,dy:s};return{x:()=>re.runKernel(M1,o,t),filter:()=>re.runKernel(P1,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JW={kernelName:Vh,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e,n={dy:s,y:t};return{x:()=>re.runKernel(a2,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eH={kernelName:Uh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e,n=ae(Wn(fs(is(t))),2/Math.sqrt(Math.PI));return{x:()=>ae(s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH={kernelName:Gh,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH={kernelName:Ig,inputsToSave:["input"],gradFunc:(s,e)=>{const[t]=e;return{input:()=>le(s,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH={kernelName:Wh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,Wn(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH={kernelName:Hh,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH={kernelName:qh,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{const c=Qe(s,Xe(n,"float32")),u=sn(t.shape,a);return u.length>0?le(it(c,u),t.shape):c},b:()=>{let c=ae(s,Xe(t,"float32"));const u=sn(n.shape,a);u.length>0&&(c=le(it(c,u),n.shape));const h=is(n);return fs(Qe(c,Xe(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH={kernelName:$g,inputsToSave:["x","mean","variance","scale"],gradFunc:(s,e,t)=>{const{varianceEpsilon:n}=t,[a,o,i,c]=e,u=c==null?gt(1):c,h=sn(o.shape,a.shape),p=[];if(o.rank===1){for(let I=0;I<a.shape.length-1;++I)p.push(a.shape[I]);p.push(1)}const f=tt(a,o),g=ae(s,u),b=hv(Me(i,gt(n))),y=ae(ae(ae(b,b),b),gt(-.5));return{x:()=>o.rank===1?le(ae(ae(s,rr(le(b,[1,1,1,o.shape[0]]),p)),u),a.shape):le(ae(ae(s,b),u),a.shape),mean:()=>{let I=ae(ae(b,gt(-1)),g);return o.rank===1&&(I=it(I,h)),le(I,o.shape)},variance:()=>{let I=ae(ae(y,f),g);return o.rank===1&&(I=it(I,h)),le(I,o.shape)},scale:()=>{const I=ae(f,b);let $=ae(s,I);return o.rank===1&&($=it($,h)),le($,o.shape)},offset:()=>{let I=s;return o.rank===1&&(I=it(I,h)),le(I,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH={kernelName:Ag,inputsToSave:["x","indices"],gradFunc:(s,e,t)=>{const[n,a]=e,{axis:o,batchDims:i}=t,c=Rt(o,n.shape)[0],u=(h,p,f)=>()=>{const g=h.shape,b=p.size,y=g.slice(0,c),w=y.length,v=g.slice(o,g.length).slice(1),N=v.length,C=pC(0,w),T=pC(w+1,w+1+N),I=fC([y,[b],v]),$=le(f,I),R=le(p,[b]),O=fC([[w],C,T]),P=Bt($,O);let _=Nv(P,R,h.shape[c]);const M=Xi(O);return _=Bt(_,M),_};if(i===1){const h=n.shape[0],p=n.split(h,0);return{x:()=>Na(p.map((b,y)=>u(b,a.slice(y,1),s.slice(y,1))())).reshape(n.shape),indices:()=>a}}else return{x:u(n,a,s),indices:()=>a}}};function pC(s,e){const t=[];for(let n=s;n<e;++n)t.push(n);return t}function fC(s){const e=[];for(let t=0;t<s.length;++t)for(let n=0;n<s[t].length;++n)e.push(s[t][n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH={kernelName:Kh,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>Vt(t),b:()=>Vt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH={kernelName:Xh,gradFunc:s=>({x:()=>Xe(s,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uH={kernelName:Yh,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH={kernelName:Zh,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH={kernelName:Qh,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH={kernelName:Dg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{alpha:a}=t,o=ka(n,0);return{x:()=>Dn(o,s,ae(s,a))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH={kernelName:ep,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,Me(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH={kernelName:Jh,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,Xe(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH={kernelName:r7,inputsToSave:[],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t;return{logits:()=>{const i=Wn(n);return tt(s,ae(it(s,a,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xH(s,e,t,n=5,a=1,o=1,i=.5){const c={x:s,y:e,dy:t},u={depthRadius:n,bias:a,alpha:o,beta:i};return re.runKernel(h2,c,u)}const bH=se({localResponseNormalizationBackprop_:xH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH={kernelName:Mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{depthRadius:o,bias:i,alpha:c,beta:u}=t;return{x:()=>bH(n,a,s,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function II(s,e,t,n){return e.rank<t.rank&&(e=le(e,_s(e.shape,n))),s.rank<t.rank&&(s=le(s,_s(s.shape,n))),{x:()=>ae(s,Xe(Ir(t,e),s.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC={kernelName:Pg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const n=t,{reductionIndices:a}=n,o=e[0],i=e[1],c=Rt(a,o.shape),u=II(s,i,o,c);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH={kernelName:tp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>ae(s,Xe(Yi(t,n),"float32")),b:()=>ae(s,Xe(mh(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(s,e,t,n,a,o,i){const c=H(s,"dy","maxPool3dGrad"),u=H(e,"input","maxPool3dGrad"),h=H(t,"output","maxPool3dGrad");let p=c,f=u,g=h,b=!1;u.rank===4&&(b=!0,p=le(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),f=le(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),g=le(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),V(p.rank===5,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(p.rank,".")),V(f.rank===5,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")),V(g.rank===5,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(g.rank,".")),Kn("maxPool3dGrad",o,i);const y={dy:p,input:f,output:g},w={filterSize:n,strides:a,pad:o,dimRoundingMode:i},v=re.runKernel(f2,y,w);return b?le(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const NH=se({maxPool3dGrad_:wH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SH={kernelName:Bg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=t;return{x:()=>NH(s,n,a,o,i,c,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(s,e,t,n,a,o,i){const c=H(s,"dy","maxPoolGrad"),u=H(e,"input","maxPoolGrad"),h=H(t,"output","maxPoolGrad");V(u.rank===c.rank,()=>"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(c.rank,")")),V(c.rank===4,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,".")),V(u.rank===4,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")),Kn("maxPoolGrad",o,i);const p={dy:c,input:u,output:h},f={filterSize:n,strides:a,pad:o,dimRoundingMode:i};return re.runKernel(p2,p,f)}const jH=se({maxPoolGrad_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kH={kernelName:zg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n,a]=e,{filterSize:o,strides:i,pad:c}=t;return{x:()=>jH(s,n,a,o,i,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH={kernelName:Vg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t,o=Rt(a,n.shape),c=gn(n.shape,o)[1],u=Ae(c);return{x:()=>{const p=n.shape.slice();o.forEach(b=>{p[b]=1});const f=le(s,p);return Qe(ae(f,ya(n.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH={kernelName:Ug,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(s,e,t)=>{const n=t,{axis:a}=n,[o,i]=e,c=Rt(a,o.shape),u=II(s,i,o,c);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H={kernelName:sp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e;return{a:()=>ae(s,Xe(tc(t,n),"float32")),b:()=>ae(s,Xe(ka(t,n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AH={kernelName:Gg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const n=e[0],{paddings:a}=t,o=a.map(i=>i[0]);return{x:()=>yt(s,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH={kernelName:np,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{const c=sn(t.shape,a);return c.length>0?le(it(s,c),t.shape):s},b:()=>{const c=ae(s,fs(Ap(Qe(t,n)))),u=sn(n.shape,a);return u.length>0?le(it(c,u),n.shape):c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DH={kernelName:ap,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{const c=ae(s,Xe(n,"float32")),u=sn(t.shape,a);return u.length>0?le(it(c,u),t.shape):c},b:()=>{const c=ae(s,Xe(t,"float32")),u=sn(n.shape,a);return u.length>0?le(it(c,u),n.shape):c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH={kernelName:Wg,gradFunc:s=>({x:()=>fs(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OH={kernelName:Kg,inputsToSave:["indices"],gradFunc:(s,e)=>{const t=e[0];return{indices:()=>Ys(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:qg,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH={kernelName:Xg,saveAllInputs:!0,gradFunc:(s,e,t)=>{const{axis:n}=t;return hr(s,n).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC={kernelName:Yg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const n=e[0],{paddings:a}=t,o=a.map(i=>i[0]);return{x:()=>yt(s,o,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LH={kernelName:rp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(s,e)=>{const[t,n,a]=e,o=t,i=n,c=Tt(o.shape,i.shape);return{a:()=>{const p=Xe(i,"float32");let f=ae(s,ae(p,_o(o,tt(p,gt(1)))));const g=sn(o.shape,c);return g.length>0&&(f=it(f,g)),le(f,o.shape)},b:()=>{const p=ka(o,0),f=Dn(p,La(o),Vt(o));let g=ae(s,ae(a,f));const b=sn(i.shape,c);return b.length>0&&(g=it(g,b)),le(g,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH={kernelName:Zg,inputsToSave:["x","alpha"],gradFunc:(s,e)=>{const[t,n]=e,a=ka(t,0);return{x:()=>Dn(a,s,ae(s,n)),alpha:()=>{let o=Dn(a,Vt(s),ae(s,t));const i=sn(n.shape,s.shape);return i.length>0&&(o=it(o,i)),le(o,n.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(s,e,t){const n=s.shape.slice();n[t]=1;const a=le(e,n),o=Pm(s,t,!0,!1),i=Pm(s,t,!0,!0),c=ae(o,i);return ae(a,c)}function zH(s,e,t){const n=s.shape.length,a=n-t.length,o=ws(t,n);let i=s;o!=null&&(i=Bt(s,o));const c=i.shape.slice(),h=c.splice(n-t.length,t.length).reduce((g,b)=>g*b,1);c.push(h);const p=i.reshape(c);let f=PH(p,e,a);if(f=f.reshape(i.shape),o!=null){const g=Xi(o);f=Bt(f,g)}return f}const BH={kernelName:Qg,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{axis:a}=t;let o=[];return a==null?o=n.shape.map((i,c)=>c):typeof a=="number"?o=[a]:o=a,{x:()=>zH(n,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH={kernelName:Bh,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{const c=Qe(s,Xe(n,"float32")),u=sn(t.shape,a);return u.length>0?le(it(c,u),t.shape):c},b:()=>{let c=ae(s,Xe(t,"float32"));const u=sn(n.shape,a);u.length>0&&(c=le(it(c,u),n.shape));const h=is(n);return fs(Qe(c,Xe(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH={kernelName:op,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,fs(is(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH={kernelName:lp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e,n=ae(tc(t,6),Fu(t));return{x:()=>ae(s,Xe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH={kernelName:ip,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,Xe(Fu(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HH={kernelName:Jg,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>le(s,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qH={kernelName:tx,inputsToSave:["images"],gradFunc:(s,e,t)=>{const[n]=e,a={dy:s,images:n};return{images:()=>re.runKernel(k2,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH={kernelName:ex,inputsToSave:["images"],gradFunc:(s,e,t)=>{const[n]=e,a={dy:s,images:n};return{images:()=>re.runKernel(j2,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XH={kernelName:sx,gradFunc:(s,e,t)=>{const{dims:n}=t,a=Rt(n,s.shape);return{x:()=>dr(s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH={kernelName:cp,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH={kernelName:up,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>fs(Qe(s,ae(_o(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QH={kernelName:nx,inputsToSave:["condition"],gradFunc:(s,e)=>{const[t]=e;return{condition:()=>Xe(Vt(t),"float32"),t:()=>ae(s,Xe(t,s.dtype)),e:()=>ae(s,Xe(wx(t),s.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH={kernelName:dp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>{const n=ka(t,gt(0)),a=gt(Mx),o=gt(Px),i=ae(s,o),c=ae(ae(s,a),Wn(Xe(t,"float32")));return Dn(n,i,c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq={kernelName:mp,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,ae(t,tt(gt(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tq={kernelName:fp,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sq={kernelName:hp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(gx(Xe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nq={kernelName:pp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(J2(Xe(t,"float32")),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:ax,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{begin:a,size:o}=t,i=n.shape,[c,u]=Fx(n,a,o),h=[];for(let p=0;p<s.rank;p++)h.push([c[p],i[p]-c[p]-u[p]]);return{x:()=>Zi(s,h)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rq={kernelName:lx,outputsToSave:[!0],gradFunc:(s,e,t)=>{const[n]=e,{dim:a}=t,o=!0,i=ae(s,n);return{logits:()=>tt(i,ae(it(i,[a],o),n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq={kernelName:gp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,kr(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xC={kernelName:ox,gradFunc:(s,e,t)=>{const{blockShape:n,paddings:a}=t;return{x:()=>mx(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bC={kernelName:ix,gradFunc:(s,e,t)=>{const{axis:n}=t;return{x:()=>Ts(s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iq={kernelName:xp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,ae(Cn(Xe(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:_2,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(s,ae(Xe(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq={kernelName:bp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=gt(2);return{a:()=>ae(s,ae(a,tt(t,n))),b:()=>ae(s,ae(a,tt(n,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uq={kernelName:Sp,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq={kernelName:yp,inputsToSave:["a","b"],gradFunc:(s,e)=>{const[t,n]=e,a=Tt(t.shape,n.shape);return{a:()=>{let c=s;const u=sn(t.shape,a);return u.length>0&&(c=it(c,u)),le(c,t.shape)},b:()=>{let c=s;const u=sn(n.shape,a);return u.length>0&&(c=it(c,u)),le(fs(c),n.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq={kernelName:rx,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,a=n.shape.slice(),{axis:o}=t;Rt(o,n.shape).forEach(h=>{a[h]=1});const c=le(s,a),u=ae(c,ya(n.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pq={kernelName:vp,inputsToSave:["x"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>Qe(s,is(gx(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fq={kernelName:wp,outputsToSave:[!0],gradFunc:(s,e)=>{const[t]=e;return{x:()=>ae(tt(gt(1),is(t)),s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq={kernelName:Np,inputsToSave:["x"],gradFunc:(s,e,t)=>{const[n]=e,{reps:a}=t;return{x:()=>{let i=Vt(n);if(n.rank===1)for(let c=0;c<a[0];++c)i=Me(i,yt(s,[c*n.shape[0]],[n.shape[0]]));else if(n.rank===2)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)i=Me(i,yt(s,[c*n.shape[0],u*n.shape[1]],[n.shape[0],n.shape[1]]));else if(n.rank===3)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)for(let h=0;h<a[2];++h)i=Me(i,yt(s,[c*n.shape[0],u*n.shape[1],h*n.shape[2]],[n.shape[0],n.shape[1],n.shape[2]]));else if(n.rank===4)for(let c=0;c<a[0];++c)for(let u=0;u<a[1];++u)for(let h=0;h<a[2];++h)for(let p=0;p<a[3];++p)i=Me(i,yt(s,[c*n.shape[0],u*n.shape[1],h*n.shape[2],p*n.shape[3]],[n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));else throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(n.rank," tensors yet."));return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq={kernelName:du,gradFunc:(s,e,t)=>{const n=t,{perm:a}=n,o=Xi(a);return{x:()=>Bt(s,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xq={kernelName:ux,gradFunc:(s,e,t)=>{const n=t,{axis:a}=n;return{value:()=>Na(s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bq={kernelName:dx,inputsToSave:["segmentIds"],gradFunc:(s,e)=>{const[t]=e;return{x:()=>yq(s,t)}}};function yq(s,e){const t=Wo(e,Vt(e)),n=Ep(s,t);let a=Yi(e,gt(0,"int32"));const o=n.rank-a.rank;for(let c=0;c<o;++c)a=vn(a,c+1);a=to(a,ya(n.shape,"bool"));const i=Vt(n);return Dn(a,n,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq={kernelName:hx,gradFunc:s=>({x:()=>Vt(s)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq=[TI,bW,yW,vW,wW,NW,SW,CW,jW,kW,TW,IW,EW,OW,_W,FW,LW,MW,PW,zW,BW,VW,GW,UW,qW,KW,XW,YW,ZW,QW,VH,JW,eH,tH,sH,nH,rH,aH,oH,iH,lH,cH,uH,dH,hH,pH,fH,mH,gH,yH,mC,mC,vH,SH,kH,TH,IH,$H,AH,EH,DH,RH,OH,_H,FH,gC,gC,LH,MH,BH,UH,GH,WH,HH,qH,KH,XH,YH,ZH,QH,JH,eq,tq,sq,nq,aq,rq,oq,xC,xC,bC,bC,iq,cq,lq,uq,dq,hq,pq,fq,mq,gq,xq,bq,vq];for(const s of wq)i7(s);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.abs=function(){return this.throwIfDisposed(),Xs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.acos=function(){return this.throwIfDisposed(),Ck(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.acosh=function(){return this.throwIfDisposed(),jk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.add=function(s){return this.throwIfDisposed(),Me(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.all=function(s,e){return this.throwIfDisposed(),K2(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.any=function(s,e){return this.throwIfDisposed(),Mm(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.argMax=function(s){return this.throwIfDisposed(),yu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.argMin=function(s){return this.throwIfDisposed(),kk(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asScalar=function(){return this.throwIfDisposed(),V(this.size===1,()=>"The array must have only 1 element."),le(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asType=function(s){return this.throwIfDisposed(),Xe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as1D=function(){return this.throwIfDisposed(),le(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as2D=function(s,e){return this.throwIfDisposed(),le(this,[s,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as3D=function(s,e,t){return this.throwIfDisposed(),le(this,[s,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as4D=function(s,e,t,n){return this.throwIfDisposed(),le(this,[s,e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.as5D=function(s,e,t,n,a){return this.throwIfDisposed(),le(this,[s,e,t,n,a])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asin=function(){return this.throwIfDisposed(),Tk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.asinh=function(){return this.throwIfDisposed(),Ik(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atan=function(){return this.throwIfDisposed(),$k(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atan2=function(s){return this.throwIfDisposed(),Ak(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.atanh=function(){return this.throwIfDisposed(),Ek(this)};Ee().prototype.avgPool=function(s,e,t,n){return this.throwIfDisposed(),fx(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.batchToSpaceND=function(s,e){return this.throwIfDisposed(),mx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.batchNorm=function(s,e,t,n,a){return this.throwIfDisposed(),kp(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.broadcastTo=function(s){return this.throwIfDisposed(),fu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cast=function(s){return this.throwIfDisposed(),Xe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.ceil=function(){return this.throwIfDisposed(),Lk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.clipByValue=function(s,e){return this.throwIfDisposed(),oa(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.concat=function(s,e){return this.throwIfDisposed(),s instanceof os&&(s=[s]),Ts([this,...s],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv1d=function(s,e,t,n,a,o){return this.throwIfDisposed(),Y2(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv2dTranspose=function(s,e,t,n,a){return this.throwIfDisposed(),Q2(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.conv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),Li(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cos=function(){return this.throwIfDisposed(),gx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cosh=function(){return this.throwIfDisposed(),J2(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cumprod=function(s,e,t){return this.throwIfDisposed(),Pm(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.cumsum=function(s,e,t){return this.throwIfDisposed(),ev(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.depthToSpace=function(s,e){return this.throwIfDisposed(),Wk(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.depthwiseConv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),Tp(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.dilation2d=function(s,e,t,n,a){return this.throwIfDisposed(),Hk(this,s,e,t,n,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.divNoNan=function(s){return this.throwIfDisposed(),qk(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.div=function(s){return this.throwIfDisposed(),Qe(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.dot=function(s){return this.throwIfDisposed(),Kk(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.elu=function(){return this.throwIfDisposed(),Ip(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.equal=function(s){return this.throwIfDisposed(),Ir(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.erf=function(){return this.throwIfDisposed(),tv(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.euclideanNorm=function(s,e){return this.throwIfDisposed(),Zk(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.exp=function(){return this.throwIfDisposed(),Wn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.expandDims=function(s){return this.throwIfDisposed(),vn(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.expm1=function(){return this.throwIfDisposed(),Qk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.fft=function(){return this.throwIfDisposed(),Ax(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.flatten=function(){return this.throwIfDisposed(),le(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.floor=function(){return this.throwIfDisposed(),Ap(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.floorDiv=function(s){return this.throwIfDisposed(),q2(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.gather=function(s,e,t){return this.throwIfDisposed(),Ep(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.greaterEqual=function(s){return this.throwIfDisposed(),Yi(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.greater=function(s){return this.throwIfDisposed(),ka(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.ifft=function(){return this.throwIfDisposed(),bh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.irfft=function(){return this.throwIfDisposed(),bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isFinite=function(){return this.throwIfDisposed(),Jk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isInf=function(){return this.throwIfDisposed(),eT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.isNaN=function(){return this.throwIfDisposed(),tT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.leakyRelu=function(s){return this.throwIfDisposed(),bx(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.lessEqual=function(s){return this.throwIfDisposed(),tc(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.less=function(s){return this.throwIfDisposed(),mh(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.localResponseNormalization=function(s,e,t,n){return this.throwIfDisposed(),sT(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSigmoid=function(){return this.throwIfDisposed(),nT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSoftmax=function(s){return this.throwIfDisposed(),av(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logSumExp=function(s,e){return this.throwIfDisposed(),vx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.log=function(){return this.throwIfDisposed(),La(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.log1p=function(){return this.throwIfDisposed(),yx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalAnd=function(s){return this.throwIfDisposed(),to(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalNot=function(){return this.throwIfDisposed(),wx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalOr=function(s){return this.throwIfDisposed(),rv(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.logicalXor=function(s){return this.throwIfDisposed(),aT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.matMul=function(s,e,t){return this.throwIfDisposed(),Ft(this,s,e,t)};Ee().prototype.maxPool=function(s,e,t,n){return this.throwIfDisposed(),Nx(this,s,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.max=function(s,e){return this.throwIfDisposed(),cr(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.maximum=function(s){return this.throwIfDisposed(),Wo(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mean=function(s,e){return this.throwIfDisposed(),ks(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.min=function(s,e){return this.throwIfDisposed(),fh(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.minimum=function(s){return this.throwIfDisposed(),ql(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mirrorPad=function(s,e){return this.throwIfDisposed(),oT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mod=function(s){return this.throwIfDisposed(),iT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.mul=function(s){return this.throwIfDisposed(),ae(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.neg=function(){return this.throwIfDisposed(),fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.norm=function(s,e,t){return this.throwIfDisposed(),$p(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.notEqual=function(s){return this.throwIfDisposed(),wu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.oneHot=function(s,e=1,t=0){return this.throwIfDisposed(),iv(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.onesLike=function(){return this.throwIfDisposed(),Ma(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.pad=function(s,e){return this.throwIfDisposed(),Zi(this,s,e)};Ee().prototype.pool=function(s,e,t,n,a,o){return this.throwIfDisposed(),lT(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.pow=function(s){return this.throwIfDisposed(),_o(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.prelu=function(s){return this.throwIfDisposed(),jx(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.prod=function(s,e){return this.throwIfDisposed(),cT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reciprocal=function(){return this.throwIfDisposed(),uT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.relu=function(){return this.throwIfDisposed(),ro(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.relu6=function(){return this.throwIfDisposed(),uv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reshapeAs=function(s){return this.throwIfDisposed(),le(this,s.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reshape=function(s){return this.throwIfDisposed(),le(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.resizeBilinear=function(s,e,t){return this.throwIfDisposed(),TT(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.resizeNearestNeighbor=function(s,e,t){return this.throwIfDisposed(),IT(this,s,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.reverse=function(s){return this.throwIfDisposed(),dr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.rfft=function(){return this.throwIfDisposed(),Ex(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.round=function(){return this.throwIfDisposed(),dv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.rsqrt=function(){return this.throwIfDisposed(),hv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.selu=function(){return this.throwIfDisposed(),pv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.separableConv2d=function(s,e,t,n,a,o){return this.throwIfDisposed(),fv(this,s,e,t,n,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sigmoid=function(){return this.throwIfDisposed(),kr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sign=function(){return this.throwIfDisposed(),dT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sin=function(){return this.throwIfDisposed(),mv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sinh=function(){return this.throwIfDisposed(),gv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.slice=function(s,e){return this.throwIfDisposed(),yt(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.softmax=function(s){return this.throwIfDisposed(),$x(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.softplus=function(){return this.throwIfDisposed(),_u(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.spaceToBatchND=function(s,e){return this.throwIfDisposed(),Cx(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.split=function(s,e){return this.throwIfDisposed(),va(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sqrt=function(){return this.throwIfDisposed(),Cn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.square=function(){return this.throwIfDisposed(),is(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.squaredDifference=function(s){return this.throwIfDisposed(),yv(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.squeeze=function(s){return this.throwIfDisposed(),Rs(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.stack=function(s,e){this.throwIfDisposed();const t=s instanceof os?[this,s]:[this,...s];return Na(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.step=function(s){return this.throwIfDisposed(),Fu(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.stridedSlice=function(s,e,t,n,a,o,i,c){return this.throwIfDisposed(),hT(this,s,e,t,n,a,o,i,c)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sub=function(s){return this.throwIfDisposed(),tt(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.sum=function(s,e){return this.throwIfDisposed(),it(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tan=function(){return this.throwIfDisposed(),pT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tanh=function(){return this.throwIfDisposed(),Hl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.tile=function(s){return this.throwIfDisposed(),rr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toBool=function(){return this.throwIfDisposed(),Xe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toFloat=function(){return this.throwIfDisposed(),Xe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.toInt=function(){return this.throwIfDisposed(),Xe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.topk=function(s,e){return this.throwIfDisposed(),gT(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.transpose=function(s){return this.throwIfDisposed(),Bt(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unique=function(s){return this.throwIfDisposed(),xT(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unsortedSegmentSum=function(s,e){return this.throwIfDisposed(),Nv(this,s,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.unstack=function(s){return this.throwIfDisposed(),hr(this,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.where=function(s,e){return this.throwIfDisposed(),Dn(s,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ee().prototype.zerosLike=function(){return this.throwIfDisposed(),Vt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,qr.prototype)}}class or extends Error{constructor(e){super(e),Object.setPrototypeOf(this,or.prototype)}}class ce extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ce.prototype)}}class Et extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Et.prototype)}}class rw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,rw.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $I{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yl(s,e){if(Array.isArray(s)){let t=[];for(let n=0;n<e;n++)t=t.concat(s);return t}else{const t=new Array(e);return t.fill(s),t}}function Kr(s,e){if(!s)throw new rw(e)}function yC(s,e){let t=0;for(const n of s)n===e&&t++;return t}function na(s){return s.length===1?s[0]:s}function Zt(s){return Array.isArray(s)?s:[s]}function Ao(s){const t=s.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function El(s){return s.length<=1||s.indexOf("_")===-1?s:s.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let er={};function ow(s){if(s==null)return null;const e={};return e.className=s.getClassName(),e.config=s.getConfig(),e}function gy(s){if(!(s==null||typeof s!="object"))if(Array.isArray(s))s.forEach(e=>gy(e));else{const e=Object.keys(s);for(const t of e){const n=s[t];n!=null&&typeof n=="object"&&(!Array.isArray(n)&&n.type==="ndarray"&&typeof n.value=="number"?s[t]=n.value:gy(n))}}}function _p(s,e={},t={},n="object",a=!1){if(typeof s=="string"){const o=s;let i;if(o in t)i=t[o];else if(o in er)i=er[o];else if(i=e[o],i==null)throw new ce("Unknown ".concat(n,": ").concat(s,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(n," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(n," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}else{const o=s;if(o.className==null||o.config==null)throw new ce("".concat(n,": Improper config format: ")+"".concat(JSON.stringify(o),".\n")+"'className' and 'config' must set.");const i=o.className;let c,u;if(i in t?[c,u]=t[i]:i in er?[c,u]=er.className:i in e&&([c,u]=e[i]),c==null)throw new ce("Unknown ".concat(n,": ").concat(i,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(n," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(n," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(u!=null){const h={};for(const b of Object.keys(er))h[b]=er[b];for(const b of Object.keys(t))h[b]=t[b];const p=o.config;p.customObjects=h;const f=Object.assign({},er);for(const b of Object.keys(t))er[b]=t[b];gy(o.config);const g=u(c,o.config,t,a);return er=Object.assign({},f),g}else{const h=Object.assign({},er);for(const f of Object.keys(t))er[f]=t[f];const p=new c(o.config);return er=Object.assign({},h),p}}}function Nq(s,e){return s<e?-1:s>e?1:0}function lm(s,e){return-1*Nq(s,e)}function Ei(s){if(s==null)return s;const e=[];for(const t of s)e.indexOf(t)===-1&&e.push(t);return e}function Sq(s){if(s==null)throw new ce("Invalid value in obj: ".concat(JSON.stringify(s)));for(const e in s)if(s.hasOwnProperty(e))return!1;return!0}function ac(s,e,t){if(t!=null&&s.indexOf(t)<0)throw new ce("".concat(t," is not a valid ").concat(e,".  Valid values are ").concat(s," or null/undefined."))}function iw(s,e,t=0,n=1/0){return Kr(t>=0),Kr(n>=t),Array.isArray(s)&&s.length>=t&&s.length<=n&&s.every(a=>typeof a===e)}function fn(s,e){Array.isArray(s)?(V(s.length>0,()=>"".concat(e," is unexpectedly an empty array.")),s.forEach((t,n)=>fn(t,"element ".concat(n+1," of ").concat(e)))):V(Number.isInteger(s)&&s>0,()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(AI(s),"."))}function AI(s){return s===null?"null":Array.isArray(s)?"["+s.map(e=>AI(e)).join(",")+"]":typeof s=="string"?'"'.concat(s,'"'):"".concat(s)}function Cq(s,e,t){let n=t!=null?t():sa(),a;return(...i)=>{const c=t!=null?t():sa();return c-n<e||(n=c,a=s(...i)),a}}function EI(s){return s==="relu"?"relu":s==="linear"?"linear":s==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let jq=0;function DI(){return jq++}const cm={};function zx(s=""){return s in cm||(cm[s]=0),cm[s]+=1,s+cm[s].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kq=["channelsFirst","channelsLast"],Tq=["nearest","bilinear"],Iq=["valid","same","causal"],$q=["max","avg"],Aq=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const au=new Map;function Ls(s){ac(kq,"DataFormat",s)}function Eq(s){ac(Tq,"InterpolationFormat",s)}function za(s){ac(Iq,"PaddingMode",s)}function RI(s){ac($q,"PoolMode",s)}const dh=[],vC="/";function Fl(s,e){dh.push(s);try{const t=e();return dh.pop(),t}catch(t){throw dh.pop(),t}}function Dq(){return dh.length===0?"":dh.join(vC)+vC}function OI(s){if(!FI(s))throw new Error("Not a valid tensor name: '"+s+"'");return Dq()+s}function _I(s){if(!FI(s))throw new Error("Not a valid tensor name: '"+s+"'");au.has(s)||au.set(s,0);const e=au.get(s);if(au.set(s,au.get(s)+1),e>0){const t="".concat(s,"_").concat(e);return au.set(t,1),t}else return s}const Rq=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function FI(s){return!!s.match(Rq)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oq(s){return s===parseInt(s.toString(),10)}function Di(s,e,t){e==null&&(e=0),t==null&&(t=s.length);let n=1;for(let a=e;a<t;++a)n*=s[a];return n}function Su(s){if(s.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<s.length;t++){const n=s[t];n<e&&(e=n)}return e}function Pi(s){if(s.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<s.length;t++){const n=s[t];n>e&&(e=n)}return e}function $r(s,e){if(e<s)throw new ce("end (".concat(e,") < begin (").concat(s,") is forbidden."));const t=[];for(let n=s;n<e;++n)t.push(n);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let w1;function Zs(){return w1==null&&(w1=lk().epsilon()),w1}function Ar(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jr(s,e){return Xe(s,e)}function Fp(s,e=-1){const t=s.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),le(s,t)}function _q(s,e){return me(()=>{if(s.shape.length!==2)throw new ce("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(s.shape.length," tensor."));const t=Fp(s,1);return xy(t,[1,e,1])})}function Fq(s){const e=[Di(s.shape)];return le(s,e)}function Lq(s){if(s.rank<=1)throw new ce("batchFlatten requires a minimum rank of 2. Got rank: ".concat(s.rank,"."));const e=[s.shape[0],Di(s.shape,1)];return le(s,e)}function Ll(s,e,t){return me(()=>{switch(s.rank){case 1:return Tx(s,e,t);case 2:return xv(s,[e,0],[t,s.shape[1]]);case 3:return Ix(s,[e,0,0],[t,s.shape[1],s.shape[2]]);case 4:return xh(s,[e,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3]]);case 5:return yt(s,[e,0,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3],s.shape[4]]);case 6:return yt(s,[e,0,0,0,0,0],[t,s.shape[1],s.shape[2],s.shape[3],s.shape[4],s.shape[5]]);default:throw new ce("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function N1(s,e,t){return me(()=>{switch(s.rank){case 1:return Tx(s,e,t);case 2:return xv(s,[0,e],[s.shape[0],t]);case 3:return Ix(s,[0,0,e],[s.shape[0],s.shape[1],t]);case 4:return xh(s,[0,0,0,e],[s.shape[0],s.shape[1],s.shape[2],t]);default:throw new ce("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function um(s,e,t,n){return me(()=>{switch(s.rank){case 1:return Tx(s,e,t);case 2:switch(n){case 1:return Ll(s,e,t);case 2:return N1(s,e,t);default:throw new ce("The axis is not within the rank of the tensor "+"".concat(n))}case 3:switch(n){case 1:return Ll(s,e,t);case 2:return Ix(s,[0,e,0],[s.shape[0],t,s.shape[2]]);case 3:return N1(s,e,t);default:throw new ce("The axis is not within the rank of the tensor "+"".concat(n))}case 4:switch(n){case 1:return Ll(s,e,t);case 2:return xh(s,[0,e,0,0],[s.shape[0],t,s.shape[2],s.shape[3]]);case 3:return xh(s,[0,0,e,0],[s.shape[0],s.shape[1],t,s.shape[3]]);case 4:return N1(s,e,t);default:throw new ce("The axis is not within the rank of the tensor "+"".concat(n))}default:throw new ce("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(s.rank))}})}function lw(s,e=-1){let t;return e<0&&(t=s[0].rank,t!==0?e=t:e=0),e===s[0].rank&&(e=-1),Ts(s,e)}function wC(s,e){switch(s.rank){case 1:return Mk([s,e]);case 2:return Pk([s,e],0);case 3:return zk([s,e],0);case 4:return Bk([s,e],0);default:throw new ce("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(s.rank))}}function xy(s,e){if(Array.isArray(e)||(e=[e]),s.rank!==e.length)throw new ce("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(s.rank,")"));return rr(s,e)}function Bx(s,e=0,t=1,n,a){return cv(s,e,t,n,a)}function eo(s,e,t,n){if(s.rank<2||e.rank<2)throw new Et("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(s.shape," and y shape = ").concat(e.shape));if(e.rank>=3){const a=s.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(a!==o)throw new Et("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(s.shape," and ")+" y shape = ".concat(e.shape))}if(s.rank===2&&e.rank===2)return ty({a:s,b:e,transposeA:!1,transposeB:!1,bias:n?by(s.rank,n,Ar()):null,activation:t});{const a=s.shape.slice(),o=a.pop();s=le(s,[-1,o]);const i=e.shape.slice(),c=i.pop(),u=i.pop(),h=[...i,c],p=Array.from({length:e.rank},(y,w)=>w===0?e.rank-2:w<=e.rank-2?w-1:w);e=le(Bt(e,p),[u,-1]);const f=[...a,...h];return le(ty({a:s,b:e,transposeA:!1,transposeB:!1,bias:n?by(s.rank,n,Ar()):null,activation:t}),f)}}function LI(s,e,t){return me(()=>(Array.isArray(e)?e=Us(e,"int32"):e=Xe(e,"int32"),Ep(s,e,t)))}function Lp(s){return ae(s,s)}function by(s,e,t){const n=e.shape;if(e.rank!==1&&e.rank!==s)throw new ce("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(s));if(s===5){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1,1,1]):le(e,[1,n[3],n[0],n[1],n[2]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,1,1,n[0]]):le(e,[1].concat(n))}else if(s===4){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1,1]):le(e,[1,n[2],n[0],n[1]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,1,n[0]]):le(e,[1].concat(n))}else if(s===3){if(t==="channelsFirst")return n.length===1?le(e,[1,n[0],1]):le(e,[1,n[1],n[0]]);if(t==="channelsLast")return n.length===1?le(e,[1,1,n[0]]):le(e,[1].concat(n))}else if(s<3)return e;throw new ce("Unsupported input rank by biasAdd: ".concat(e.rank))}function Rr(s,e,t){return me(()=>(t==null&&(t=Ar()),Ls(t),Me(s,by(s.rank,e,t))))}function Mq(s,e=1){if(e!==1)throw new Et("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return Ip(s)}function Pq(s){return me(()=>Qe(s,Me(Xs(s),1)))}function MI(s,e,t,n){return me(()=>vT(s,e,t,n))}function zq(s){return me(()=>{const e=Me(.5,ae(.2,s));return oa(e,0,1)})}function Mp(s,e,t=!1){return t?s():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Bq=["fanIn","fanOut","fanAvg"],Vq=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uq(s){ac(Bq,"FanMode",s)}function Gq(s){ac(Vq,"Distribution",s)}class fr extends Mu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class PI extends fr{apply(e,t){return Ys(e,t)}}PI.className="Zeros";Ue(PI);class cw extends fr{apply(e,t){return ya(e,t)}}cw.className="Ones";Ue(cw);class zI extends fr{constructor(e){if(super(),typeof e!="object")throw new ce("Expected argument of type ConstantConfig but got ".concat(e));if(e.value===void 0)throw new ce("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return me(()=>ae(gt(this.value),ya(e,t)))}getConfig(){return{value:this.value}}}zI.className="Constant";Ue(zI);class BI extends fr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return sc(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}BI.className="RandomUniform";Ue(BI);class VI extends fr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Et("randomNormal does not support dType ".concat(t,"."));return Bx(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VI.className="RandomNormal";Ue(VI);class UI extends fr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Et("truncatedNormal does not support dType ".concat(t,"."));return wv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}UI.className="TruncatedNormal";Ue(UI);class GI extends fr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return me(()=>{if(e.length!==2||e[0]!==e[1])throw new ce("Identity matrix initializer can only be used for 2D square matrices.");return ae(this.gain,nv(e[0]))})}getConfig(){return{gain:this.gain}}}GI.className="Identity";Ue(GI);function Wq(s,e="channelsLast"){let t,n;if(Ls(e),s.length===2)t=s[0],n=s[1];else if([3,4,5].indexOf(s.length)!==-1){if(e==="channelsFirst"){const a=Di(s,2);t=s[1]*a,n=s[0]*a}else if(e==="channelsLast"){const a=Di(s,0,s.length-2);t=s[s.length-2]*a,n=s[s.length-1]*a}}else{const a=Di(s);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}class Sa extends fr{constructor(e){if(super(),e.scale<0)throw new ce("scale must be a positive float. Got: ".concat(e.scale));this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Uq(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Gq(this.distribution),this.seed=e.seed}apply(e,t){const n=Wq(e),a=n[0],o=n[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,a):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(a+o)/2),this.distribution==="normal"){const c=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Et("".concat(this.getClassName()," does not support dType ").concat(t,"."));return wv(e,0,c,t,this.seed)}else{const c=Math.sqrt(3*i);return sc(e,-c,c,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Sa.className="VarianceScaling";Ue(Sa);class uw extends Sa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}uw.className="GlorotUniform";Ue(uw);class dw extends Sa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}dw.className="GlorotNormal";Ue(dw);class hw extends Sa{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}hw.className="HeNormal";Ue(hw);class pw extends Sa{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}pw.className="HeUniform";Ue(pw);class fw extends Sa{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}fw.className="LeCunNormal";Ue(fw);class mw extends Sa{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Sa.className}}mw.className="LeCunUniform";Ue(mw);class WI extends fr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return me(()=>{if(e.length<2)throw new Et("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError("Unsupported data type ".concat(t,"."));t=t;const n=Ae(e.slice(0,-1)),a=e[e.length-1],o=n*a;o>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(o,") elements: ")+"Slowness may result.");const i=[Math.max(a,n),Math.min(a,n)],c=Bx(i,0,1,t,this.seed),u=$T.qr(c,!1);let h=u[0];const f=u[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return h=ae(h,f.sign()),n<a&&(h=h.transpose()),ae(gt(this.gain),h.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}WI.className="Orthogonal";Ue(WI);const NC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function SC(s,e={}){return _p(s,ar.getMap().classNameMap,e,"initializer")}function vs(s){return ow(s)}function ms(s){if(typeof s=="string"){const e=s in NC?NC[s]:s;if(e==="GlorotNormal")return new dw;if(e==="GlorotUniform")return new uw;if(e==="HeNormal")return new hw;if(e==="HeUniform")return new pw;if(e==="LeCunNormal")return new fw;if(e==="LeCunUniform")return new mw;{const t={};return t.className=e,t.config={},SC(t)}}else return s instanceof fr?s:SC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yy(s){return Array.isArray(s)&&Array.isArray(s[0])}function Um(s){return s.length===0?[]:Array.isArray(s[0])?s:[s]}function vt(s){let e;if(Array.isArray(s)){if(s.length!==1)throw new ce("Expected Tensor length to be 1; got ".concat(s.length));e=s[0]}else e=s;return e}function Kt(s){if(Array.isArray(s)&&Array.isArray(s[0])){if(s.length===1)return s=s,s[0];throw new ce("Expected exactly 1 Shape; got ".concat(s.length))}else return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gm(s){let e=0;for(const t of s)t.shape.length===0?e+=1:e+=t.shape.reduce((n,a)=>n*a);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const CC="Variable";class Hq{constructor(e,t="float32",n=CC,a=!0,o=null){this.dtype=t==null?"float32":t,this.shape=e.shape,this.id=DI(),n=n==null?CC:n,this.originalName=OI(n),this.name=_I(this.originalName),this.trainable_=a,this.constraint=o,this.val=bT(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),qq(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function qq(s,e){if(s.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(s.shape)+" vs. "+JSON.stringify(e.shape))}function vy(s){return s.map(e=>e.read())}function gw(s){s.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qs{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class so{constructor(e,t,n,a,o,i,c){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=o,this.outputTensorIndex=c,this.id=DI(),i!=null&&(this.originalName=OI(i),this.name=_I(this.originalName)),this.rank=t.length}}let Kq=0;class Vx{constructor(e,t){this.callArgs=t,this.id=Kq++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Xq=0;class Ot extends Mu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Xq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const n=this.getClassName();t=Ao(n)+"_"+zx(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),n=[o].concat(e.inputShape)}this.batchInputShape=n;let a=e.dtype;a==null&&(a=e.inputDType),a==null&&(a="float32"),this.dtype=a}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new or("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new ce("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return na(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return na(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new qr("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new qr("Layer ".concat(this.name)+" is not connected, no input to return.");return na(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new qr("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new qr("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return na(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Zt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const n=Zt(this.inputSpec);if(t.length!==n.length)throw new ce("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let a=0;a<t.length;a++){const o=t[a],i=n[a];if(i==null)continue;const c=o.rank;if(i.ndim!=null&&c!==i.ndim)throw new ce("Input ".concat(a," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(c));if(i.maxNDim!=null&&c>i.maxNDim)throw new ce("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(c));if(i.minNDim!=null&&c<i.minNDim)throw new ce("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(c,"."));if(i.dtype!=null&&o.dtype!==i.dtype)throw new ce("Input ".concat(a," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(o.dtype,"."));if(i.axes){const u=o.shape;for(const h in i.axes){const p=Number(h),f=i.axes[h],g=p>=0?u[p]:u[u.length+p];if(f!=null&&[f,null].indexOf(g)===-1)throw new ce("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(p," of input shape to ")+"have value ".concat(f," but got shape ").concat(u,"."))}}if(i.shape!=null)for(let u=0;u<i.shape.length;++u){const h=i.shape[u],p=o.shape[u];if(h!=null&&p!=null&&h!==p)throw new ce("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(o.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=Zt(e),a=Qq(e),o=Jq(e);if(a===o)throw new ce("Arguments to apply() must be all SymbolicTensors or all Tensors");return Fl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const c of Zt(e))i.push(c.shape);this.build(na(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,i);const c=Zt(i),u=[];for(let h of c)n.indexOf(h)!==-1&&(h=h.clone()),u.push(h);if(i=na(u),this.activityRegularizer!=null)throw new Et("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Yq(e),c=this.computeOutputShape(i);let u;const h=Zq(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),c!=null&&c.length>0&&Array.isArray(c[0])?u=c.map((p,f)=>new so(h,p,this,Zt(e),t,this.name,f)):u=new so(h,c,this,Zt(e),t,this.name),this.addInboundNode(e,u,null,null,i,c,t),this._refCount++,this.activityRegularizer!=null)throw new Et("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{n!=null&&e[a]!=null&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new qr("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new qr("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new or("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Gm(this.weights)}build(e){this.built=!0}getWeights(e=!1){return vy(e?this.trainableWeights:this.weights)}setWeights(e){me(()=>{const t=this.weights;if(t.length!==e.length)throw new ce('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(t.length===0)return;const n=[],a=vy(t);for(let o=0;o<a.length;++o){const i=a[o],c=t[o],u=e[o];if(!zt(i.shape,u.shape))throw new ce("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(u.shape));n.push([c,u])}gw(n)})}addWeight(e,t,n,a,o,i,c,u){if(this._addedWeightNames.indexOf(e)!==-1)throw new ce("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(a=u!=null?u():ms("zeros"));const h=a.apply(t,n),p=new Hq(h,n,e,i,c);return h.dispose(),o!=null&&this.addLoss(()=>o.apply(p.read())),i==null&&(i=!0),i?this._trainableWeights.push(p):this._nonTrainableWeights.push(p),p}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Zt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")});else throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const a=this.computeMask(e,n),o=Zt(t),i=Zt(a);if(o.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(o.length," tensors ")+"but ".concat(o.length," masks for those tensors"));for(let c=0;c<o.length;c++)o[c].kerasMask=i[c]}addInboundNode(e,t,n,a,o,i,c=null){const u=Zt(e);t=Zt(t),n=Zt(n),a=Zt(a),o=Um(o),i=Um(i);const h=[],p=[],f=[];for(const g of u)h.push(g.sourceLayer),p.push(g.nodeIndex),f.push(g.tensorIndex);new Vx({outboundLayer:this,inboundLayers:h,nodeIndices:p,tensorIndices:f,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:o,outputShapes:i},c);for(let g=0;g<t.length;g++)t[g].sourceLayer=this,t[g].nodeIndex=this.inboundNodes.length-1,t[g].tensorIndex=g}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Yq(s){s=Zt(s);const e=[];for(const t of s)e.push(t.shape);return na(e)}function Zq(s){return"float32"}function HI(s,e,t){if((e==null||t!=null&&t>0)&&(e=s.sourceLayer,t=s.nodeIndex),e.inboundNodes.length===0)return[s];{const n=e.inboundNodes[t];if(n.inboundLayers.length===0)return n.inputTensors;{const a=[];for(let o=0;o<n.inboundLayers.length;o++){const i=n.inputTensors[o],c=n.inboundLayers[o],u=n.nodeIndices[o],h=HI(i,c,u);for(const p of h)a.indexOf(p)===-1&&a.push(p)}return a}}}function Qq(s){let e=!0;for(const t of Zt(s))if(!(t instanceof so)){e=!1;break}return e}function Jq(s){let e=!0;for(const t of Zt(s))if(t instanceof so){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Pp extends Ot{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:zx("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ce("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new ce("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ce("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const a=new so(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new Vx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new ce("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Pp.className="InputLayer";Ue(Pp);function eK(s){if(s.batchShape==null&&s.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(s.batchShape!=null&&s.shape!=null)throw new ce("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=s.batchShape;s.shape!=null&&e==null&&(e=[null].concat(s.shape));let t=s.dtype;return t==null&&(t="float32"),new Pp({batchInputShape:e,name:s.name,dtype:t,sparse:s.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tK(s,e){if(s.dtype==null||s.dtype===e.dtype)return e;try{return Xe(e,s.dtype)}catch(t){throw new ce("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(s.name,"' (").concat(s.dtype,")."))}}class Ti{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Ti)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=tK(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new ce("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof so){if(this.id2Value[e.id]==null)throw new ce("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ce("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof so){if(this.id2Value[e.id]==null)throw new ce("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ce("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&kt(this.id2Mask)}}const Wm=new $I,Hm=new $I;function sK(s){Wm!=null&&Wm.setMaxEntries(s),Hm!=null&&Hm.setMaxEntries(s)}function ih(s,e,t,n){const a=t==null?!1:t.training,o=Array.isArray(s),i=o?s:[s],c=i.map(y=>y.name),u=[],h=e.names();for(const y of c)h.indexOf(y)!==-1?u.push(e.getValue(y)):u.push(null);const p=c.join(",")+"|"+e.names().sort().join(",");let f=Wm.get(p),g;if(f==null){const y=nK(i,e);f=y.sorted,g=y.recipientCounts,Wm.put(p,f),Hm.put(p,g)}g={},a||Object.assign(g,Hm.get(p));const b=new Ti(e);for(let y=0;y<f.length;++y){const w=f[y],v=w.sourceLayer;if(v instanceof Pp)continue;const N=[],C=[],T=[];let I=!1;for(const _ of w.inputs){const M=b.getValue(_),A=b.getMask(_);N.push(M),C.push(A),A!=null&&(I=!0),a||(g[_.name]--,g[_.name]===0&&!e.hasKey(_)&&c.indexOf(_.name)===-1&&!M.isDisposed&&_.sourceLayer.stateful!==!0&&T.push(M))}I&&(t=t||{},t.mask=C[0]);const $=Zt(v.apply(N,t));let R=null;v.supportsMasking&&(R=v.computeMask(N,C));const O=rK(w),P=Array.isArray(O)?O:[O];for(let _=0;_<P.length;++_){b.hasKey(P[_])||b.add(P[_],$[_],Array.isArray(R)?R[0]:R);const M=c.indexOf(P[_].name);M!==-1&&(u[M]=$[_])}a||kt(T)}return b.disposeMasks(),o?u:u[0]}function nK(s,e){V(s!=null&&s.length>0,()=>"Expected at least one fetch, got none");let t=[],n={};if(s.length===1){const a=jC(s[0],e);t=a.sorted,n=a.recipientMap}else{const a=new Set;for(const o of s){const{sorted:i,recipientMap:c}=jC(o,e);for(const u of i)a.has(u.name)||(t.push(u),a.add(u.name));for(const u in c)n[u]==null&&(n[u]=new Set),c[u].forEach(h=>n[u].add(h))}}return{sorted:t,recipientCounts:aK(n)}}function aK(s){const e={};for(const t in s)e[t]=s[t].size;return e}function jC(s,e){const t=new Set,n=[],a={};for(const c of e.names())t.add(c);const o=[],i=[];for(o.push(s);o.length>0;){const c=o[o.length-1];if(t.has(c.name)){o.pop();continue}const u=i[i.length-1]===o.length-1;if(c.inputs.length===0||u)o.pop(),n.push(c),t.add(c.name),u&&i.pop();else{i.push(o.length-1);for(const h of c.inputs)a[h.name]==null&&(a[h.name]=new Set),a[h.name].add(c.name),!t.has(h.name)&&o.push(h)}}return{sorted:n,recipientMap:a}}function rK(s){let e;if(s.sourceLayer.inboundNodes.length===1)e=s.sourceLayer.output;else{let t=null;for(let n=0;n<s.sourceLayer.inboundNodes.length;++n)for(const a of s.sourceLayer.inboundNodes[n].outputTensors)if(a.id===s.id){t=n;break}e=s.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK=Se();oK.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,sK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xw(s,e){return me(()=>Cn(it(ae(s,s),e,!0)))}class zp extends Mu{getConfig(){return{}}}class qI extends zp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>{const t=xw(e,this.axis),n=oa(t,0,this.maxValue);return ae(e,Qe(n,Me(Zs(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}qI.className="MaxNorm";Ue(qI);class KI extends zp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>Qe(e,Me(Zs(),xw(e,this.axis))))}getConfig(){return{axis:this.axis}}}KI.className="UnitNorm";Ue(KI);class XI extends zp{apply(e){return ro(e)}}XI.className="NonNeg";Ue(XI);class YI extends zp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return me(()=>{const t=xw(e,this.axis),n=Me(ae(this.rate,oa(t,this.minValue,this.maxValue)),ae(1-this.rate,t));return ae(e,Qe(n,Me(Zs(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}YI.className="MinMaxNorm";Ue(YI);const kC={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function en(s){return ow(s)}function TC(s,e={}){return _p(s,ar.getMap().classNameMap,e,"constraint")}function tn(s){if(s==null)return null;if(typeof s=="string"){const t={className:s in kC?kC[s]:s,config:{}};return TC(t)}else return s instanceof zp?s:TC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function kl(s){if(s==null)return;const e=[],t=[],n=[];for(const a in s){const o=s[a];if(typeof o!="number"){const i=o;e.push(i.data()),t.push(a),n.push(i)}}if(e.length>0){const a=await Promise.all(e);for(let o=0;o<a.length;++o)s[t[o]]=a[o][0];kt(n)}}function ZI(s){if(s!=null)for(const e in s){const t=s[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var IC;(function(s){s[s.SILENT=0]="SILENT",s[s.VERBOSE=1]="VERBOSE"})(IC||(IC={}));const iK=125;class yh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class lK{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class cK extends yh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const n=t.size==null?0:t.size;this.seen+=n;for(const a in t){const o=t[a];if(typeof o=="number")this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+o*n;else{let i;a in this.totals?i=this.totals[a]:this.totals[a]=0;const c=me(()=>Me(this.totals[a],ae(o,n)));this.totals[a]=c,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:me(()=>{const a=ae(Qe(1,this.seen),this.totals[n]);t[n]=a,this.totals[n].dispose(),pn(t[n])}))}}class uK extends yh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const o in this.history){const i=this.history[o];for(let c=0;c<i.length;++c)if(typeof i[c]!="number"){const u=i[c];e.push(u.data()),t.push(o),n.push(c)}}const a=await Promise.all(e);for(let o=0;o<a.length;++o)this.history[t[o]][n[o]].dispose(),this.history[t[o]][n[o]]=a[o][0]}}class dK extends yh{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||YT,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=iK),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");_1(this.yieldEvery)&&(this.maybeWait=Cq(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const a=[];this.yield!=null&&(await kl(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await kl(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];this.epochEnd!=null&&(await kl(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await kl(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];this.batchEnd!=null&&(await kl(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):_1(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await kl(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await kl(e),await this.trainEnd(e))}}function QI(s,e){return s==null&&(s={}),s instanceof yh?[s]:Array.isArray(s)&&s[0]instanceof yh?s:Zt(s).map(n=>new dK(n,e))}class sr{constructor(){}static registerCallbackConstructor(e,t){V(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)),sr.checkForDuplicate(t),sr.constructors[e]==null&&(sr.constructors[e]=[]),sr.constructors[e].push(t)}static checkForDuplicate(e){for(const t in sr.constructors)sr.constructors[+t].forEach(a=>{if(a===e)throw new ce("Duplicate callback constructor.")})}static clear(){sr.constructors={}}static createCallbacks(e){const t=[];for(const n in sr.constructors){const a=+n;e>=a&&t.push(...sr.constructors[a])}return t.map(n=>new n)}}sr.constructors={};function JI(s,e,t,n,a,o,i,c,u){const h=new uK,p=[new cK,...sr.createCallbacks(e)];s!=null&&p.push(...s),p.push(h);const f=new lK(p);return f.setParams({epochs:t,initialEpoch:n,samples:a,steps:o,batchSize:i,verbose:e,doValidation:c,metrics:u}),{callbackList:f,history:h}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oo(s,e={},t=!1){return _p(s,ar.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qm(s,e){return me(()=>{s.dtype!=="float32"&&(s=Xe(s,"float32"));const t=it(Lp(s),e,!0),n=Ou(t.shape,Zs()),a=Cn(Wo(t,n));return Qe(s,a)})}function Ux(s,e){return me(()=>ks(Lp(tt(e,s)),-1))}function bw(s,e){return me(()=>ks(Xs(tt(e,s)),-1))}function yw(s,e){return me(()=>{const t=tt(s,e),n=oa(Xs(s),Zs(),Number.MAX_VALUE),a=Xs(Qe(t,n));return ae(100,ks(a,-1))})}function hK(s,e){return me(()=>{const t=oa(e,Zs(),Number.MAX_VALUE),n=La(Me(1,t)),a=oa(s,Zs(),Number.MAX_VALUE),o=La(Me(1,a));return ks(Lp(tt(n,o)),-1)})}function pK(s,e){return me(()=>{const t=Wo(0,tt(1,ae(s,e)));return ks(Lp(t),-1)})}function fK(s,e){return me(()=>{const t=Wo(0,tt(1,ae(s,e)));return ks(t,-1)})}function mK(s,e){return me(()=>{const t=it(ae(s,e),-1),n=cr(ae(tt(1,s),e),-1);return Wo(0,Me(1,tt(n,t)))})}function gK(s,e){return me(()=>{const t=Math.log(2),n=tt(e,s),a=tt(Me(n,_u(ae(-2,n))),t);return ks(a,-1)})}function vh(s,e,t=!1){return me(()=>{if(t)e=$x(e);else{const n=it(e,e.shape.length-1,!0);e=Qe(e,n)}return e=oa(e,Zs(),1-Zs()),fs(it(ae(Xe(s,"float32"),La(e)),e.shape.length-1))})}function Km(s,e,t=!1){return me(()=>{const n=Xe(Ap(Fq(s)),"int32");e=oa(e,Zs(),1-Zs());const a=e.shape,o=le(iv(n,a[a.length-1]),a);return vh(o,e,t)})}function xK(s,e){if(!zt(s.shape,e.shape))throw new ce("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(s.shape)," and ").concat(JSON.stringify(e.shape)));return me(()=>{const t=ro(e),n=fs(Xs(e));return Me(tt(t,ae(e,s)),yx(Wn(n)))})}function Gx(s,e){return me(()=>{let t;return t=oa(e,Zs(),1-Zs()),t=La(Qe(t,tt(1,t))),ks(xK(s,t),-1)})}function bK(s,e){return me(()=>{const t=oa(s,Zs(),1),n=oa(e,Zs(),1);return it(ae(s,La(Qe(t,n))),-1)})}function yK(s,e){return me(()=>{const t=La(Me(Zs(),e));return ks(tt(e,ae(s,t)),-1)})}function e$(s,e){return me(()=>{const t=qm(s,-1),n=qm(e,-1),a=ae(t,n);return fs(it(a,-1))})}const Xm={meanSquaredError:Ux,meanAbsoluteError:bw,meanAbsolutePercentageError:yw,meanSquaredLogarithmicError:hK,squaredHinge:pK,hinge:fK,categoricalHinge:mK,logcosh:gK,categoricalCrossentropy:vh,sparseCategoricalCrossentropy:Km,binaryCrossentropy:Gx,kullbackLeiblerDivergence:bK,poisson:yK,cosineProximity:e$};function S1(s){if(typeof s=="string"){if(s in Xm)return Xm[s];let e="Unknown loss ".concat(s);throw s.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(s,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ce(e)}else return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t$(s,e){return me(()=>{const t=ae(.5,Ma(e)),n=Jr(ka(e,t),s.dtype);return ks(Ir(s,n),-1)})}function s$(s,e){return me(()=>Jr(Ir(yu(s,-1),yu(e,-1)),"float32"))}function vK(s,e){return me(()=>Xe(it(to(Ir(s,1),Ir(e,1))),"float32"))}function wK(s,e){return me(()=>Xe(it(to(Ir(s,0),Ir(e,1))),"float32"))}function NK(s,e){return me(()=>{const t=vK(s,e),n=wK(s,e),a=Me(t,n);return Xe(Dn(ka(a,0),Qe(t,a),0),"float32")})}function SK(s,e){return Gx(s,e)}function CK(s,e){return s.rank===e.rank&&(s=Rs(s,[s.rank-1])),e=yu(e,-1),e.dtype!==s.dtype&&(e=Xe(e,s.dtype)),Xe(Ir(s,e),"float32")}const jK=Ux,kK=Ux,TK=bw,IK=bw,$K=yw,AK=yw,n$=vh,EK=e$,a$=Km,Ym={binaryAccuracy:t$,categoricalAccuracy:s$,precision:NK,categoricalCrossentropy:n$,sparseCategoricalCrossentropy:a$,mse:jK,MSE:kK,mae:TK,MAE:IK,mape:$K,MAPE:AK,cosine:EK};function DK(s){if(typeof s=="string"&&s in Ym)return Ym[s];if(typeof s!="string"&&s!=null)return s;throw new ce("Unknown metric ".concat(s))}function dm(s){if(Kr(s!==null,"Unknown LossOrMetricFn ".concat(s)),typeof s=="string")return s;{let e;for(const t of Object.keys(Xm))if(Xm[t]===s){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Ym))if(Ym[t]===s){e=t;break}return e!==void 0?e:s.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RK(s){const e={Adagrad:()=>nu.adagrad(.01),Adadelta:()=>nu.adadelta(1,.95,Zs()),Adam:()=>nu.adam(.001,.9,.999,Zs()),Adamax:()=>nu.adamax(.002,.9,.999,Zs(),0),RMSProp:()=>nu.rmsprop(.001,.9,0,Zs()),SGD:()=>nu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,s in e)return e[s]();throw new ce("Unknown Optimizer ".concat(s))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $C=1*1024*1024;function AC(s,e,t=!1){if(s==null||typeof s!="object"||Object.getPrototypeOf(s)!==Object.prototype||!wy(s))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const n=JSON.stringify(s);n.length>$C&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat($C,"."))}}function wy(s){if(s===null)return!0;if(typeof s=="object")if(Object.getPrototypeOf(s)===Object.prototype){const e=Object.keys(s);for(const t of e)if(typeof t!="string"||!wy(s[t]))return!1;return!0}else if(Array.isArray(s)){for(const e of s)if(!wy(e))return!1;return!0}else return!1;else{const e=typeof s;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function OK(s,e,t,n=console.log){const a=FK(s),o=["Layer (type)","Input Shape","Output shape","Param #"];a?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(p=>Math.floor(e*p)));let i;if(!a){o.push("Receives inputs"),i=[];for(const p in s.nodesByDepth)i.push(...s.nodesByDepth[p])}n("_".repeat(e)),Zm(o,t,n),n("=".repeat(e));const c=s.layers;for(let p=0;p<c.length;++p)a?LK(c[p],t,n):MK(c[p],t,i,n),n((p===c.length-1?"=":"_").repeat(e));s.checkTrainableWeightsConsistency();const u=_K(s),h=Gm(s.nonTrainableWeights);n("Total params: ".concat(u+h)),n("Trainable params: ".concat(u)),n("Non-trainable params: ".concat(h)),n("_".repeat(e))}function _K(s){let e;return s.collectedTrainableWeights!=null?e=Gm(s.collectedTrainableWeights):e=Gm(s.trainableWeights),e}function FK(s){let e=!0;const t=[],n=[];for(const a in s.nodesByDepth)t.push(s.nodesByDepth[a]);for(const a of t){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){e=!1;break}n.push(...a)}if(e)for(const a of s.layers){let o=!1;for(const i of a.inboundNodes)if(n.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Zm(s,e,t=console.log){let n="";for(let a=0;a<s.length;++a)a>0&&(n=n.slice(0,n.length-1)+" "),n+=s[a],n=n.slice(0,e[a]),n+=" ".repeat(e[a]-n.length);t(n)}function LK(s,e,t){let n,a;try{a=s.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch(u){a="multiple"}try{n=JSON.stringify(s.outputShape)}catch(u){n="multiple"}const o=s.name,i=s.getClassName(),c=["".concat(o," (").concat(i,")"),a,n,s.countParams().toString()];Zm(c,e,t)}function MK(s,e,t,n){let a,o;try{o=s.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch(f){o="multiple"}try{a=JSON.stringify(s.outputShape)}catch(f){a="multiple"}const i=[];for(const f of s.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let g=0;g<f.inboundLayers.length;++g){const b=f.inboundLayers[g].name,y=f.nodeIndices[g],w=f.tensorIndices[g];i.push("".concat(b,"[").concat(y,"][").concat(w,"]"))}const c=s.name,u=s.getClassName(),h=i.length===0?"":i[0],p=["".concat(c," (").concat(u,")"),o,a,s.countParams().toString(),h];Zm(p,e,n);for(let f=1;f<i.length;++f)Zm(["","","","",i[f]],e,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function r$(s,e,t){return(s==="inboundNodes"||s==="outputLayers"||s==="inputLayers")&&e===0&&typeof t=="string"}function Ny(s,e){if(s===null)return null;if(typeof s=="string")return El(s);if(typeof s=="number"||typeof s=="boolean")return s;if(s instanceof Array){const t=[],n=s.length;for(let a=0;a<n;++a){const o=s[a];r$(e,a,o)?t.push(o):t.push(Ny(o,e))}return t}else{const t={};for(const n of Object.keys(s)){const a=s[n];if(n==="name"&&typeof a=="string")t[n]=a;else{const o=El(n);t[o]=Ny(a,o)}}return t}}function Sy(s,e){if(s==null)return null;if(typeof s=="string")return Ao(s);if(typeof s=="number"||typeof s=="boolean")return s;if(s instanceof Array){const t=[],n=s.length;for(let a=0;a<n;++a){const o=s[a];r$(e,a,o)?t.push(o):t.push(Sy(o,e))}return t}else{const t={};for(const n of Object.keys(s)){const a=s[n],o=Ao(n);(n==="name"||n==="className")&&typeof a=="string"?t[o]=a:t[o]=Sy(a,n)}return t}}/** @license See the LICENSE file. */const o$="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const PK=s=>{const e=Object.keys(s);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class wr extends Ot{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=zx(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ei(this.inputs).length!==this.inputs.length)throw new ce("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(C=>C.name)));Ei(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(C=>C.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const T=C.sourceLayer,I=C.nodeIndex,$=C.tensorIndex;this.outputLayers.push(T),this.outputLayersNodeIndices.push(I),this.outputLayersTensorIndices.push($)}for(const C of this.inputs){const T=C.sourceLayer,I=C.nodeIndex,$=C.tensorIndex;Kr(I===0,"input layer has >1 nodes"),Kr($===0,"input layer has >1 tensors"),this.inputLayers.push(T),this.inputLayersNodeIndices.push(I),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const T=this.inputLayers[C];if(!(T instanceof Pp))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(C," (0-based) originates ")+"from layer type ".concat(T.getClassName(),"."));this.inputNames.push(T.name),this.feedInputShapes.push(T.batchInputShape),this.feedInputNames.push(T.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const t={},n={},a={},o={},i={},c=[],u=(C,T,I,$,R,O)=>{($==null||R==null||O==null)&&($=C.sourceLayer,R=C.nodeIndex,O=C.tensorIndex);const P=$.inboundNodes[R];if(I.indexOf(P)!==-1)throw new or("The tensor ".concat(C.name,' at layer "').concat($.name,'" ')+"is part of a cycle.");if(T.indexOf(P)!==-1)return;this.containerNodes.add(wr.nodeKey($,R)),$.id in i||(i[$.id]=Object.keys(i).length),I.indexOf(P)===-1&&I.push(P);const _=P.inboundLayers.length;for(let M=0;M<_;M++){const A=P.inputTensors[M],U=P.inboundLayers[M],K=P.nodeIndices[M],Q=P.tensorIndices[M];u(A,T,I,U,K,Q)}for(T.push(P);I.indexOf(P)>=0;)I.splice(I.indexOf(P),1);c.push(P)},h=[],p=[];for(const C of this.outputs)u(C,h,p);const f=c.slice().reverse();for(const C of f){n[C.id]=C,C.id in t||(t[C.id]=0);let T=t[C.id];const I=a[C.outboundLayer.id]==null?0:a[C.outboundLayer.id];T=Math.max(T,I),a[C.outboundLayer.id]=T,o[C.outboundLayer.id]=C.outboundLayer,t[C.id]=T;for(let $=0;$<C.inboundLayers.length;$++){const R=C.inboundLayers[$],O=C.nodeIndices[$],P=R.inboundNodes[O],_=t[P.id]==null?0:t[P.id];t[P.id]=Math.max(T+1,_),n[P.id]=P}}const g={};for(const C in t){const T=t[C];T in g||(g[T]=[]),g[T].push(n[C])}const b={};for(const C in a){const T=a[C];T in b||(b[T]=[]),b[T].push(o[C])}let y=Object.keys(b).map(C=>parseInt(C,10)).sort(lm);this.layers=[];for(const C of y){const T=b[C];T.sort((I,$)=>{const R=i[I.id],O=i[$.id];return R<O?-1:R>O?1:0});for(const I of T)I instanceof wr&&this.internalContainerRefs.push(I),this.layers.push(I)}this.layersByDepth=b,y=Object.keys(g).map(C=>parseInt(C,10)).sort(lm);const w=this.inputs.slice(),v=[];for(const C of y)for(const T of g[C]){const I=T.outboundLayer;if(I!=null){for(const $ of T.inputTensors)if(w.indexOf($)===-1)throw new or("Graph disconnected: cannot obtain value for tensor ".concat($)+' at layer "'.concat(I.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(v));for(const $ of T.outputTensors)w.push($);v.push(I.name)}}this.nodesByDepth=g;const N=this.layers.map(C=>C.name);for(const C of N){const T=N.filter(I=>I===C).length;if(T!==1)throw new or('The name "'.concat(C,'" is used ').concat(T," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(N))}this.outboundNodes=[],this.inboundNodes=[],new Vx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(n=>n.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new ce("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.layers)t.push(...n.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const n={};let a=0;const o=PK(e);o&&this.parseWeights(e);for(const c of this.layers)for(const[u,h]of c.weights.entries()){const p=o?"".concat(h.name.split("/").slice(0,-1).join("/")+"/").concat(u):h.originalName;if(n[p]!=null)throw new ce("Duplicate weight name: ".concat(p));n[p]=h,a++}const i=[];for(const c in e){let u=c;if(n[c]==null){const h=c.split("/");u=h.slice(0,-2).concat([h[h.length-1]]).join("/")}if(n[u]!=null)i.push([n[u],e[c]]);else if(t)throw new ce("Provided weight data has no target variable: ".concat(c));delete n[u]}if(t){const c=[];for(const u in n)c.push(u);if(c.length>0)throw new ce("".concat(c.length," of ").concat(a," weights are not set: ")+"".concat(c))}gw(i)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],o=n.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");o!==t&&(e[o]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(o$),t.backend="TensorFlow.js",t}toJSON(e,t=!0){const n=Sy(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return me(()=>{e=Zt(e);const n=new Ti;for(let a=0;a<this.inputs.length;++a)n.add(this.inputs[a],e[a]);return ih(this.outputs,n,t)})}computeMask(e,t){return me(()=>{e=Zt(e);let n;return t==null?n=Yl(null,e.length):n=Zt(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){const t=Um(e);if(t.length!==this.inputLayers.length)throw new ce("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let c=0;c<t.length;c++){const u=this.inputLayers[c],h=t[c],p=u.name+"_0_0";n[p]=h}const a=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(lm);if(a.length>1)for(const c of a){const u=this.nodesByDepth[c];for(const h of u){const p=h.outboundLayer;if(this.inputLayers.map(w=>w.id).indexOf(p.id)!==-1)continue;const f=[];for(let w=0;w<h.inboundLayers.length;w++){const v=h.inboundLayers[w],N=h.nodeIndices[w],C=h.tensorIndices[w],T="".concat(v.name,"_").concat(N,"_").concat(C),I=n[T];f.push(I)}const g=p.computeOutputShape(na(f)),b=Um(g),y=p.inboundNodes.indexOf(h);for(let w=0;w<b.length;w++){const v="".concat(p.name,"_").concat(y,"_").concat(w);n[v]=b[w]}}}const o=[],i=[];for(let c=0;c<this.outputLayers.length;c++){const u=this.outputLayers[c],h=this.outputLayersNodeIndices[c],p=this.outputLayersTensorIndices[c],f="".concat(u.name,"_").concat(h,"_").concat(p);i.push(f)}for(let c=0;c<i.length;c++){const u=i[c];Kr(u in n),o.push(n[u])}return na(o)}runInternalGraph(e,t){t==null&&(t=Yl(null,e.length));const n={};for(let u=0;u<this.inputs.length;++u){const h=this.inputs[u],p=e[u],f=t[u];n[h.id]=[p,f]}const a=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(lm);for(const u of a){const h=this.nodesByDepth[u];for(const p of h){const f=p.outboundLayer,g=p.inputTensors,b=p.outputTensors,y=new Array;for(const w of g)w.id in n&&y.push(n[w.id]);if(y.length===g.length){let w={},v,N,C,T;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){const[I,$]=y[0];w.mask==null&&(w.mask=$),C=Zt(f.call(I,w)),T=Zt(f.computeMask(I,$)),v=[I],N=[$]}else v=y.map(I=>I[0]),N=y.map(I=>I[1]),w.mask==null&&(w.mask=N),C=Zt(f.call(v,w)),T=Zt(f.computeMask(v,N));if(f.activityRegularizer)throw new Et("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let I=0;I<b.length;++I){const $=b[I],R=C[I],O=T[I];n[$.id]=[R,O]}}}}const o=[],i=[],c=[];for(const u of this.outputs){Kr(u.id in n,"Could not compute output ".concat(u.name," : ").concat(u.id));const[h,p]=n[u.id];c.push(h.shape),o.push(h),i.push(p)}return[o,i,c]}buildNodeConversionMap(e){const t={};let n;for(const a of this.layers){n=a instanceof wr?1:0;for(let o=0;o<a.inboundNodes.length;o++){const i=wr.nodeKey(a,o);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new ce("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new ce("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new ce("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return me(()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const a=wr.nodeKey(t,n);this.containerNodes.has(a)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const c=i.getClassName(),u=i.getConfig(),h=[];for(let f=0;f<i.inboundNodes.length;f++){const g=i.inboundNodes[f],b=wr.nodeKey(i,f);let y={};if(this.containerNodes.has(b)){if(g.callArgs)try{JSON.stringify(g.callArgs),y=g.callArgs}catch(w){console.warn("Layer ".concat(i.name," was passed ")+"non-serializable keyword arguments: "+"".concat(g.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),y={}}if(g.inboundLayers.length>0){const w=[];for(let v=0;v<g.inboundLayers.length;v++){const N=g.inboundLayers[v],C=g.nodeIndices[v],T=g.tensorIndices[v],I=wr.nodeKey(N,C);let $=t[I];$==null&&($=0),w.push([N.name,$,T,y])}h.push(w)}}}const p={};p.name=i.name,p.className=c,p.config=u,p.inboundNodes=h,n.push(p)}e.layers=n;const a=[];for(let i=0;i<this.inputLayers.length;i++){const c=this.inputLayers[i],u=this.inputLayersNodeIndices[i],h=wr.nodeKey(c,u);if(!this.containerNodes.has(h))continue;let p=t[h];p==null&&(p=0);const f=this.inputLayersTensorIndices[i];a.push([c.name,p,f])}e.inputLayers=a;const o=[];for(let i=0;i<this.outputLayers.length;i++){const c=this.outputLayers[i],u=this.outputLayersNodeIndices[i],h=wr.nodeKey(c,u);if(!this.containerNodes.has(h))continue;let p=t[h];p==null&&(p=0);const f=this.outputLayersTensorIndices[i];o.push([c.name,p,f])}return e.outputLayers=o,e}static fromConfig(e,t,n={},a=!1){const o={},i={};function c(v,N){v.name in i?i[v.name].push(N):i[v.name]=[N]}function u(v,N){const C=[];let T;for(const I of N){const $=I[0],R=I[1],O=I[2];if(T=I[3]==null?{}:I[3],!($ in o)){c(v,N);return}const P=o[$];if(P.inboundNodes.length<=R){c(v,N);return}const _=P.inboundNodes[R];C.push(_.outputTensors[O])}C.length>0&&v.apply(na(C),T)}function h(v){const N=v.name,C=Oo(v,t.customObjects!=null?t.customObjects:{});C.setFastWeightInitDuringBuild(a),o[N]=C,v.inboundNodes.forEach(I=>{if(!(I instanceof Array))throw new ce("Corrupted configuration, expected array for nodeData: ".concat(I));c(C,I)})}const p=t.name,f=t.layers;for(const v of f)h(v);for(;!Sq(i);)for(const v of f){const N=o[v.name];if(N.name in i){const C=i[N.name];delete i[N.name];for(const T of C)u(N,T)}}const g=[],b=[],y=t.inputLayers;for(const v of y){const N=v[0],C=v[1],T=v[2];Kr(N in o);const $=o[N].inboundNodes[C].outputTensors;g.push($[T])}const w=t.outputLayers;for(const v of w){const N=v[0],C=v[1],T=v[2];Kr(N in o);const $=o[N].inboundNodes[C].outputTensors;b.push($[T])}return new e({inputs:g,outputs:b,name:p})}get stateful(){if(this._stateful)throw new ce("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){me(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zK(s,e,t){const n=e.length;if(s==null||Array.isArray(s)&&s.length===0)return e.map(a=>null);if(n===1)return Array.isArray(s)&&s.length===1?s:typeof s=="object"&&e[0]in s?[s[e[0]]]:[s];if(Array.isArray(s)){if(s.length!==n)throw new Error("Provided ".concat(t," is an array of ").concat(s.length," ")+"element(s), but the model has ".concat(n," outputs. ")+"Make sure a set of weights is provided for each model output.");return s}else if(typeof s=="object"&&Object.keys(s).length>0&&typeof s[Object.keys(s)[0]]=="object"){const a=[];return e.forEach(o=>{o in s?a.push(s[o]):a.push(null)}),a}else throw new Error("The model has multiple (".concat(n,") outputs, ")+"so ".concat(t," must be either an array with ")+"".concat(n," elements or an object with ").concat(e," keys. ")+"Provided ".concat(t," not understood: ").concat(JSON.stringify(s)))}function i$(s,e){return zK(s,e,"classWeight")}async function l$(s,e,t,n){if(t!=null){const a=me(()=>{if(s.shape.length===1)return Ro(s);if(s.shape.length===2){if(s.shape[1]>1)return yu(s,1);if(s.shape[1]===1)return le(s,[s.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(s.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}else throw new Error("Unexpected rank of target (y) tensor (".concat(s.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),o=Array.from(await a.data());kt(a);const i=[];return o.forEach(c=>{if(t[c]==null)throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(c," exists in the data but not in ")+"classWeight");i.push(t[c])}),Us(i,"float32")}else return null}function BK(s,e){return ae(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VK=32;function c$(s,e){let t,n;const a=e;t=a.xs,n=a.ys,V(t!=null&&n!=null,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e));const o=EC("input",s.inputNames,t),i=EC("output",s.outputNames,n),c=o[0].shape[0];V(o.length===s.inputs.length,()=>"LayersModel has ".concat(s.inputs.length," inputs, but the dataset ")+"provides ".concat(o.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(s.inputNames),")")),V(i.length===s.outputs.length,()=>"LayersModel has ".concat(s.outputs.length," outputs, but the dataset ")+"provides ".concat(i.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(s.outputNames),")"));for(let u=0;u<o.length;u++)V(o[u].shape[0]===c,()=>"Batch size mismatch: input "+"".concat(s.inputNames[u]," has ").concat(o[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(s.inputNames[0],"."));for(let u=0;u<i.length;u++)V(i[u].shape[0]===c,()=>"Batch size mismatch: output "+"".concat(s.outputNames[u]," has ").concat(i[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(s.inputNames[0],"."));return{xs:o,ys:i}}function EC(s,e,t){if(t instanceof os)return[t];if(Array.isArray(t))return V(t.length===e.length,()=>"Received an array of ".concat(t.length," Tensors, but expected ").concat(e.length," to match the ").concat(s," keys ").concat(e,".")),t;{const n=[];for(const a of e){if(t[a]==null)throw new ce("The feature data generated by the dataset lacks the required "+"".concat(s," key '").concat(a,"'."));n.push(t[a])}return n}}function UK(s){if(s.length===3)throw new Et("Validation with sample weights is not implemented yet.");return{xs:s[0],ys:s[1]}}async function GK(s,e,t){const n=t.batchesPerEpoch!=null;if(V(s.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),V(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),V(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(t.epochs)),V(!n||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(t.batchesPerEpoch)),V(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");s.isTraining=!0;try{const a=t.validationData!=null;let o,i;if(a)if(DC(t.validationData))V(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(t.validationBatches));else{const v=UK(t.validationData);o=v.xs,i=v.ys}const c=s.makeTrainFunction(),u=s.getDedupedMetricsNames();let h;a?h=u.slice().concat(u.map(v=>"val_"+v)):h=u.slice();const p=QI(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:g,history:b}=JI(p,f,t.epochs,null,null,WK(e,t),null,a,h);g.setModel(s),s.history=b,await g.onTrainBegin(),s.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,w=await e.iterator();for(;y<t.epochs;){const v={};await g.onEpochBegin(y);let N=0,C=0;for(n||(w=await e.iterator());!n||N<t.batchesPerEpoch;){const T=await w.next();if(n&&T.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(t.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(N," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(t.batchesPerEpoch*t.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(T.value!=null){const{xs:I,ys:$}=c$(s,T.value),R={};R.batch=C,R.size=I[0].shape[0],await g.onBatchBegin(C,R);const O=[];if(t.classWeight!=null){const M=i$(t.classWeight,s.outputNames);for(let A=0;A<M.length;++A)O.push(await l$($[A],null,M[A]))}const P=I.concat($).concat(O),_=c(P);kt(P);for(let M=0;M<u.length;++M){const A=u[M],U=_[M];R[A]=U,pn(U)}await g.onBatchEnd(C,R),ZI(R),C++,N++}if(n?N>=t.batchesPerEpoch:T.done){if(a){let I;DC(t.validationData)?I=Zt(await s.evaluateDataset(t.validationData,{batches:t.validationBatches})):I=Zt(s.evaluate(o,i,{batchSize:t.validationBatchSize==null?VK:t.validationBatchSize,verbose:0}));for(let $=0;$<s.metricsNames.length;++$)v["val_".concat(s.metricsNames[$])]=I[$]}break}if(s.stopTraining_)break}if(await g.onEpochEnd(y,v),y++,s.stopTraining_)break}return await g.onTrainEnd(),await s.history.syncData(),s.history}finally{s.isTraining=!1}}function WK(s,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(s.size)&&(t=s.size),t}function DC(s){return typeof s.iterator=="function"}function HK(s){return typeof s.next=="function"}async function qK(s,e,t){t=t||{};const n=t.batches!=null,a=s.testFunction;let o=[];if(t.verbose>0)throw new Et("Verbose mode is not implemented yet.");V(!n||t.batches>0&&Number.isInteger(t.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(t.batches)));const i=HK(e)?e:await e.iterator();let c=0,u=0;for(;!n||u<t.batches;){const h=await i.next();if(o=me(()=>{if(h.value){const{xs:p,ys:f}=c$(s,h.value),g=p.concat(f),b=me(()=>a(g));if(kt(g),u===0)for(let w=0;w<b.length;++w)o.push(gt(0));const y=g[0].shape[0];for(let w=0;w<b.length;++w){const v=b[w],N=o[w];o[w]=me(()=>Me(o[w],ae(y,v))),u>0&&kt(N)}kt(b),c+=y,++u}return o}),h.done){n&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(t.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let h=0;h<o.length;++h){const p=o[h];o[h]=Qe(o[h],c),kt(p)}return na(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function C1(s){V(s>0&&Number.isInteger(s),()=>"batchSize is required to be a positive integer, but got ".concat(s))}function nh(s,e,t){return s==null?[null]:Array.isArray(s)?s.map(n=>Ll(n,e,t-e)):Ll(s,e,t-e)}function Cy(s,e){return me(()=>s==null?null:Array.isArray(s)?s.map(t=>Cy(t,e)):LI(s,e.dtype==="int32"?e:Xe(e,"int32")))}function j1(s,e){const t=[];let n=0,a=null;for(;n<s;)a=n+e,a>=s&&(a=s),t.push([n,a]),n=a;return t}function u$(s){const e=[];s instanceof os&&(s=[s]);for(let t=0;t<s.length;++t){const n=s[t];if(n.rank===1)e.push(Fp(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(n)}}return e}function vr(s,e){if(s==null)return;const t=[];if(e instanceof os)t.push(e.id);else if(Array.isArray(e))e.forEach(a=>t.push(a.id));else if(e!=null)for(const a in e){const o=e[a];t.push(o.id)}const n=[];if(s instanceof os)t.indexOf(s.id)===-1&&n.push(s);else if(Array.isArray(s))s.forEach(a=>{t.indexOf(a.id)===-1&&n.push(a)});else if(s!=null)for(const a in s){const o=s[a];t.indexOf(o.id)===-1&&n.push(o)}n.forEach(a=>{a.isDisposed||a.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function KK(s){return s instanceof os}function jy(s){return Array.isArray(s)}function RC(s){return!KK(s)&&!jy(s)}function OC(s,e,t,n=!0,a=""){if(e==null||e.length===0){if(s!=null){let i=!1;if(jy(s)&&s.length>0)i=!0;else if(RC(s)){for(const c in s)if(s.hasOwnProperty(c)){i=!0;break}}else i=!0;if(i)throw new ce("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(s))}return[]}if(s==null)return e.map(i=>null);let o;if(RC(s)){s=s,o=[];for(const i of e){if(s[i]==null)throw new ce('No data provided for "'.concat(i,'". Need data for each key in: ')+"".concat(e));o.push(s[i])}}else if(jy(s)){if(s=s,s.length!==e.length)throw new ce("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(s));o=s}else{if(s=s,e.length>1)throw new ce("The model ".concat(a," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(s.shape));o=[s]}if(o=u$(o),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const c=o[i];if(c.shape.length!==t[i].length)throw new ce("Error when checking ".concat(a,": expected ").concat(e[i]," ")+"to have ".concat(t[i].length," dimension(s). but got array with ")+"shape ".concat(c.shape));for(let u=0;u<t[i].length;++u){if(u===0&&!n)continue;const h=c.shape[u],p=t[i][u];if(p!=null&&p>=0&&h!==p)throw new ce("".concat(a," expected a batch of elements where each ")+"example has shape [".concat(t[i].slice(1,t[i].length),"] ")+"(i.e.,tensor shape [*,".concat(t[i].slice(1,t[i].length),"])")+" but the ".concat(a," received an input with ").concat(c.shape[0])+" examples, each with shape [".concat(c.shape.slice(1,c.shape.length),"]")+" (tensor shape [".concat(c.shape,"])"))}}return o}function XK(s,e,t){const n=Ei(s.map(o=>o.shape[0]));n.sort();const a=Ei(e.map(o=>o.shape[0]));if(a.sort(),n.length>1)throw new ce("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(s.map(o=>o.shape))));if(a.length>1)throw new ce("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map(o=>o.shape))));if(n.length>0&&a.length>0&&!zt(n,a))throw new ce("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function YK(s,e,t){const n=[Ux,Gx,vh];for(let a=0;a<s.length;++a){const o=s[a],i=e[a],c=t[a];if(i!=null){if(i===vh&&o.shape[o.shape.length-1]===1)throw new ce("You are passing a target array of shape ".concat(o.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(n.indexOf(i)!==-1){const u=o.shape.slice(1),h=c.slice(1);for(let p=0;p<u.length;++p){const f=u[p],g=h[p];if(g!=null&&f!==g)throw new ce("A target Tensor with shape ".concat(o.shape," was passed for an ")+"output of shape ".concat(c,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}function _C(s,e,t,n=!0,a=""){let o;if(Array.isArray(s)){if(s.length!==e.length)throw new ce("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(s.length," Tensors(s)."));o=s}else{if(e.length>1)throw new ce("The model expects ".concat(e.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(s.shape),"."));o=[s]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const c=o[i];if(c.shape.length!==t[i].length)throw new ce("Error when checking ".concat(a,": expected ").concat(e[i]," ")+"to have ".concat(t[i].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(c.shape)));for(let u=0;u<t[i].length;++u){if(u===0&&!n)continue;const h=c.shape[u],p=t[i][u];if(p!=null&&p!==h)throw new ce("Error when checking ".concat(a,": expected ")+"".concat(e[i]," to have shape ").concat(JSON.stringify(t[i])," but ")+"got array with shape ".concat(JSON.stringify(c.shape),"."))}}}function ZK(s,e){if(s==null||Array.isArray(s)&&s.length===0)return e.map(n=>[]);let t;if(typeof s=="string"||typeof s=="function")t=[s];else if(Array.isArray(s)||typeof s=="object")t=s;else throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(s));if(Array.isArray(t))return e.map(n=>t);{const n=[];for(const a of e){let o=t.hasOwnProperty(a)?t[a]:[];Array.isArray(o)||(o=[o]),n.push(o)}return n}}const QK="layers-model";class mu extends wr{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new ce("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");OK(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=RK(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Qi))throw new ce("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new ce('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const i of this.outputNames)e.loss[i]==null&&console.warn('Output "'.concat(i,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(i," during training")),t.push(S1(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ce("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));t=e.loss.map(c=>S1(c))}else{const i=S1(e.loss);this.outputs.forEach(c=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const c=this.internalOutputShapes[i],u=this.outputNames[i];this.feedOutputNames.push(u),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Fl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;const c=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([c,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const a=ZK(e.metrics,this.outputNames),o=(i,c,u)=>{this.outputNames.length>1&&(c=this.outputNames[i]+"_"+c),this.metricsNames.push(c),this.metricsTensors.push([u,i])};Fl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;const c=a[i];(h=>{const p="";let f,g,b;for(const y of h){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===Gx?["accuracy","acc"].indexOf(y)!==-1?g=t$:["crossentropy","ce"].indexOf(y)!==-1&&(g=SK):this.lossFunctions[i]===Km?["accuracy","acc"].indexOf(y)!==-1?g=CK:["crossentropy","ce"].indexOf(y)!==-1&&(g=a$):["accuracy","acc"].indexOf(y)!==-1?g=s$:["crossentropy","ce"].indexOf(y)!==-1&&(g=n$);let N;["accuracy","acc"].indexOf(y)!==-1?N="acc":["crossentropy","ce"].indexOf(y)!==-1&&(N="ce"),b=g,f=p+N}else b=DK(y),f=p+dm(y);let w;Fl(f,()=>{w=b}),o(i,f,w)}})(c)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){const a=n.batchSize==null?32:n.batchSize;C1(a);const i=this.standardizeUserDataXY(e,t,!0,a);try{const c=i[0].concat(i[1]);this.makeTestFunction();const u=this.testFunction,h=this.testLoop(u,c,a,n.verbose,n.steps);return na(h)}finally{vr(i[0],e),vr(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),qK(this,e,t)}checkNumSamples(e,t,n,a="steps"){let o;if(n!=null){if(o=null,t!=null)throw new ce("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new ce("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));return o}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new ce("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),a=n?t:[t],o=this.retrieveSymbolicTensors(a),i=new Ti;if(e instanceof os&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ce("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let u=0;u<this.inputs.length;++u)i.add(this.inputs[u],e[u])}else for(const u of this.inputs){const h=e[u.name];if(h==null)throw new ce("No value is provided for the model's input ".concat(u.name));i.add(u,h)}const c=ih(o,i);return n?c:c[0]}retrieveSymbolicTensors(e){const t=Yl(null,e.length);let n=e.length;for(const a of this.layers){const o=Array.isArray(a.output)?a.output:[a.output],i=o.map(c=>c.name);for(let c=0;c<e.length;++c){const u=i.indexOf(e[c]);if(u!==-1&&(t[c]=o[u],n--),n===0)break}if(n===0)break}if(n>0){const a=[];throw t.forEach((o,i)=>{o==null&&a.push(e[i])}),new ce("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(a)))}return t}predictLoop(e,t=32,n=!1){return me(()=>{const a=this.checkNumSamples(e);if(n)throw new Et("Verbose predictLoop() is not implemented yet.");const o=j1(a,t),i=this.outputs.map(c=>[]);for(let c=0;c<o.length;++c)me(()=>{const h=o[c][0],p=o[c][1],f=nh(e,h,p),g=[];if(Array.isArray(f))for(let y=0;y<f.length;++y)g.push({key:this.inputs[y],value:f[y]});else g.push({key:this.inputs[0],value:f});const b=new Ti(g);return ih(this.outputs,b)}).forEach((h,p)=>i[p].push(h));return na(i.map(c=>Ts(c,0)))})}predict(e,t={}){const n=u$(e);_C(n,this.inputNames,this.feedInputShapes,!1);try{const a=t.batchSize==null?32:t.batchSize;return C1(a),this.predictLoop(n,a)}finally{vr(n,e)}}predictOnBatch(e){_C(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,a){if(this.optimizer_==null)throw new or("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const c=this.feedOutputShapes[i];this.feedLossFns[i]===Km?o.push(c.slice(0,c.length-1).concat([1])):o.push(c)}if(e=OC(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=OC(t,this.feedOutputNames,o,!1,"target"),XK(e,t),YK(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&e[0].shape[0]%a!==0)throw new ce("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(a,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a,o=!0,i){const[c,u]=this.standardizeUserDataXY(e,t,o,i);if(n!=null)throw new Error("sample weight is not supported yet.");let h=null;if(a!=null){const p=i$(a,this.outputNames);h=[];for(let f=0;f<p.length;++f)h.push(await l$(u[f],null,p[f]))}return[c,u,h]}testLoop(e,t,n,a=0,o){return me(()=>{const i=this.checkNumSamples(t,n,o,"steps"),c=[];if(a>0)throw new Et("Verbose mode is not implemented yet.");if(o!=null)throw new Et("steps mode in testLoop() is not implemented yet");{const u=j1(i,n),h=Us($r(0,i));for(let p=0;p<u.length;++p){const f=u[p][0],g=u[p][1],b=Ll(h,f,g-f),y=Cy(t,b),w=e(y);if(p===0)for(let v=0;v<w.length;++v)c.push(gt(0));for(let v=0;v<w.length;++v){const N=w[v];c[v]=Me(c[v],ae(g-f,N))}}for(let p=0;p<c.length;++p)c[p]=Qe(c[p],i)}return c})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const a=e[n];let o=a;if(yC(e,a)>1){const i=yC(e.slice(0,n),a);o+="_".concat(i)}t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],c=()=>{const f=[];for(let w=0;w<this.inputs.length;++w)f.push({key:this.inputs[w],value:n[w]});const g=new Ti(f),b=ih(this.outputs,g,{training:!0});let y;for(let w=0;w<this.lossFunctions.length;++w){const v=this.lossFunctions[w];let N=v(a[w],b[w]);o[w]!=null&&(N=BK(N,o[w]));const C=ks(N);t.push(C),w===0?y=N:y=Me(y,N)}for(let w=0;w<this.metricsTensors.length;++w){let v;if(this.outputs.length>1&&w<this.outputs.length)v=t[w];else{const N=this.metricsTensors[w][0],C=this.metricsTensors[w][1];v=ks(N(a[C],b[C]))}pn(v),i.push(v)}return y=ks(y),this.calculateLosses().forEach(w=>{y=Me(y,w)}),y},u=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(c,!0,u)].concat(i)}}makeTestFunction(){this.testFunction=e=>me(()=>{const t=[];let n;const a=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let h=0;h<this.inputs.length;++h)i.push({key:this.inputs[h],value:a[h]});const c=new Ti(i),u=ih(this.outputs,c);for(let h=0;h<this.lossFunctions.length;++h){const p=this.lossFunctions[h],f=ks(p(o[h],u[h]));h===0?n=f:n=Me(n,f),t.push(n)}for(let h=0;h<this.metricsTensors.length;++h){const p=this.metricsTensors[h][0],f=this.metricsTensors[h][1],g=ks(p(o[f],u[f]));t.push(g)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,o,i,c,u,h,p,f,g;try{const b=n.batchSize==null?32:n.batchSize;C1(b);const w=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,!1,b);a=w[0],o=w[1],g=w[2];let v=!1,N;if(n.validationData!=null&&n.validationData.length>0){if(v=!0,n.validationData.length===2)u=n.validationData[0],h=n.validationData[1];else throw n.validationData.length===3?new Et("validationData including sample weights is not supported yet."):new ce("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(n.validationData," is invalid."));const M=await this.standardizeUserData(u,h,null,null,!0,b);p=M[0],f=M[1],N=p.concat(f)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){v=!0;const _=Math.floor(a[0].shape[0]*(1-n.validationSplit)),M=a[0].shape[0];p=nh(a,_,M),i=a,a=nh(a,0,_),f=nh(o,_,M),c=o,o=nh(o,0,_),N=p.concat(f)}else n.validationSteps!=null&&(v=!0);const C=a.concat(o).concat(g);this.checkTrainableWeightsConsistency();const T=this.makeTrainFunction(),I=this.getDedupedMetricsNames();let $,R;v?(this.makeTestFunction(),$=this.testFunction,R=I.slice().concat(I.map(_=>"val_"+_))):($=null,N=[],R=I.slice());const O=QI(n.callbacks,n.yieldEvery);return await this.fitLoop(T,C,I,b,n.epochs,n.verbose,O,$,N,n.shuffle,R,n.initialEpoch,null,null)}finally{this.isTraining=!1,vr(a,e),vr(o,t),vr(i,e),vr(c,t),vr(p,u),vr(f,h),g!=null&&kt(g)}}async fitLoop(e,t,n,a,o,i,c,u,h,p,f,g,b,y){a==null&&(a=32),o==null&&(o=1),p==null&&(p=!0),g==null&&(g=0);let w=!1;if(u!=null&&h!=null&&(w=!0),y!=null&&(w=!0,b==null))throw new ce("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,a,b,"steps_per_epoch");let N;v!=null&&(N=$r(0,v)),i==null&&(i=1);const{callbackList:C,history:T}=JI(c,i,o,g,v,b,a,w,f);C.setModel(this),this.history=T,await C.onTrainBegin(),this.stopTraining_=!1;for(let I=g;I<o;++I){await C.onEpochBegin(I);const $={};if(b!=null)throw new Et("stepsPerEpoch mode is not implemented yet.");{if(p==="batch")throw new Et("batch shuffling is not implemneted yet");p&&U8(N);const R=Us(N),O=j1(v,a);for(let P=0;P<O.length;++P){const _={};if(await C.onBatchBegin(P,_),me(()=>{const M=O[P][0],A=O[P][1],U=Ll(R,M,A-M);_.batch=P,_.size=A-M;const K=Cy(t,U),Q=e(K);for(let X=0;X<n.length;++X){const B=n[X],G=Q[X];_[B]=G,pn(G)}if(P===O.length-1&&w){const X=this.testLoop(u,h,a);for(let B=0;B<n.length;++B){const G=n[B],Y=X[B];pn(Y),$["val_"+G]=Y}}}),await C.onBatchEnd(P,_),ZI(_),this.stopTraining_)break}R.dispose()}if(await C.onEpochEnd(I,$),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return GK(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),a=n[0],o=n[1],c=this.makeTrainFunction()(a.concat(o)),u=[];for(const h of c){const p=await h.data();u.push(p[0])}return kt(c),vr(n[0],e),vr(n[1],t),na(u)}getNamedWeights(e){const t=[],n=e!=null&&e.trainableOnly,a=n?this.trainableWeights:this.weights,o=this.getWeights(n);for(let i=0;i<a.length;++i)n&&!a[i].trainable||t.push({name:a[i].originalName,tensor:o[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=F4().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-F4().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ao(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Ao(t))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const a of t)if(typeof n[a]=="string")e[a]=Ao(n[a]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ao(dm(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ao(dm(e)));{const e={};for(const t in this.metrics)e[t]=Ao(dm(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Ny(e.optimizer_config),n=Oo(t);let a;if(typeof e.loss=="string")a=El(e.loss);else if(Array.isArray(e.loss))a=e.loss.map(i=>El(i));else if(e.loss!=null){a={};for(const i in e.loss)a[i]=El(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>El(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=El(e.metrics[i])}this.compile({loss:a,metrics:o,optimizer:n})}async save(e,t){if(typeof e=="string"){const h=mk(e);if(h.length===0)throw new ce("Cannot find any save handlers for URL '".concat(e,"'"));if(h.length>1)throw new ce("Found more than one (".concat(h.length,") save handlers for ")+"URL '".concat(e,"'"));e=h[0]}if(e.save==null)throw new ce("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await K1(this.getNamedWeights(t)),c={modelTopology:this.toJSON(null,!1),format:QK,generatedBy:"TensorFlow.js tfjs-layers v".concat(o$),convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){c.trainingConfig=this.getTrainingConfig();const h="optimizer",{data:p,specs:f}=await K1(await this.optimizer.getWeights(),h);n.specs.push(...f),n.data=hk([n.data,p])}return this.userDefinedMetadata!=null&&(AC(this.userDefinedMetadata,this.name,!0),c.userDefinedMetadata=this.userDefinedMetadata),c.weightData=n.data,c.weightSpecs=n.specs,e.save(c)}setUserDefinedMetadata(e){AC(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}mu.className="Model";Ue(mu);class d$ extends mu{}d$.className="Functional";Ue(d$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wh extends mu{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:zx("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(n=>n<0))throw new ce("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof wh||e instanceof mu;let n;if(t){if(n=e,n.outputs.length!==1)throw new ce("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new ce("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ce("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const a=eK({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new ce("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(e.inboundNodes[0].outputTensors.length!==1)throw new ce("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=HI(this.outputs[0])}this.inboundNodes=[],new Vx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Yl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{const a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Kt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new mu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new or("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new or("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new or("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new or("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},a=!1){let o,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new ce("Legacy serialization format not supported yet.");o=t}else V(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=t.layers,delete t.layers,i=t;const c=new e(i);if(!(c instanceof wh))throw new Et("Sequential.fromConfig called on non-Sequential input: ".concat(c));for(const u of o){const p=Oo(u,void 0,a);a&&p.setFastWeightInitDuringBuild(!0),c.add(p)}return c}set stopTraining(e){if(this.model==null)throw new ce("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new ce("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}wh.className="Sequential";Ue(wh);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let On=class extends Mu{getConfig(){return{}}};class h$ extends On{apply(e,t=1){return Mq(e,t)}}h$.className="elu";Ue(h$);class p$ extends On{apply(e){return pv(e)}}p$.className="selu";Ue(p$);class f$ extends On{apply(e){return ro(e)}}f$.className="relu";Ue(f$);class m$ extends On{apply(e){return me(()=>ql(6,ro(e)))}}m$.className="relu6";Ue(m$);class g$ extends On{apply(e){return e}}g$.className="linear";Ue(g$);class x$ extends On{apply(e){return kr(e)}}x$.className="sigmoid";Ue(x$);class b$ extends On{apply(e){return zq(e)}}b$.className="hardSigmoid";Ue(b$);class y$ extends On{apply(e){return _u(e)}}y$.className="softplus";Ue(y$);class v$ extends On{apply(e){return Pq(e)}}v$.className="softsign";Ue(v$);class w$ extends On{apply(e){return Hl(e)}}w$.className="tanh";Ue(w$);let vw=class extends On{apply(e,t=-1){return $x(e,t)}};vw.className="softmax";Ue(vw);class N$ extends On{apply(e,t=-1){return av(e,t)}}N$.className="logSoftmax";Ue(N$);class S$ extends On{apply(e){return me(()=>me(()=>{const t=Math.sqrt(2),n=ae(.5,Me(1,tv(Qe(e,t))));return ae(e,n)}))}}S$.className="gelu";Ue(S$);class C$ extends On{apply(e){return me(()=>ae(.5,ae(e,Me(1,Hl(ae(Cn(Qe(2,Math.PI)),Me(e,ae(.044715,_o(e,3)))))))))}}C$.className="gelu_new";Ue(C$);class j$ extends On{apply(e){return me(()=>ae(e,Hl(_u(e))))}}j$.className="mish";Ue(j$);class k$ extends On{apply(e,t=1){return me(()=>ae(kr(ae(e,t)),e))}}k$.className="swish";Ue(k$);function zi(s){return s.getClassName()}function k1(s,e={}){return _p(s,ar.getMap().classNameMap,e,"activation")}function Bi(s){if(s==null){const e={};return e.className="linear",e.config={},k1(e)}if(typeof s=="string"){const e={};return e.className=s,e.config={},k1(e)}else return s instanceof On?s:k1(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JK(s){if(s!=null&&typeof s!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(s))}class T$ extends Mu{}class I$ extends T${constructor(e){super(),JK(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return me(()=>{let t=Ys([1]);return this.hasL1&&(t=Me(t,it(ae(this.l1,Xs(e))))),this.hasL2&&(t=Me(t,it(ae(this.l2,Lp(e))))),le(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}I$.className="L1L2";Ue(I$);const FC={l1l2:"L1L2"};function ls(s){return ow(s)}function LC(s,e={}){return _p(s,ar.getMap().classNameMap,e,"regularizer")}function gs(s){if(s==null)return null;if(typeof s=="string"){const t={className:s in FC?FC[s]:s,config:{}};return LC(t)}else return s instanceof T$?s:LC(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $$ extends Ot{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=vt(e);let n=ro(e);return this.maxValue!=null&&(n=oa(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}$$.className="ReLU";Ue($$);class A$ extends Ot{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=vt(e);return bx(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}A$.className="LeakyReLU";Ue(A$);class E$ extends Ot{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=ms(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=gs(e.alphaRegularizer),this.alphaConstraint=tn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new ce("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes))}build(e){e=Kt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const a of this.sharedAxes)t[a-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(this.sharedAxes!=null)for(let a=1;a<e.length;++a)n[a]=e[a];this.inputSpec=[new Qs({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=vt(e),jx(e,this.alpha.read())}getConfig(){const e={alphaInitializer:vs(this.alphaInitializer),alphaRegularizer:ls(this.alphaRegularizer),alphaConstraint:en(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}E$.className="PReLU";Ue(E$);let D$=class extends Ot{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Et("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=vt(e);return Ip(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};D$.className="ELU";Ue(D$);class R$ extends Ot{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const n=vt(e);return ae(n,Xe(ka(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}R$.className="ThresholdedReLU";Ue(R$);class O$ extends Ot{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new vw().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return me(()=>{let n=vt(e);const a=t.mask;if(a!=null){const o=ae(tt(ya(n.shape),Xe(a,n.dtype)),gt(-1e9));n=Me(n,o)}return this.axis instanceof Array?this.axis.length>1?Wn(tt(n,vx(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}O$.className="Softmax";Ue(O$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gu(s,e,t){if(typeof s=="number")return Yl(s,e);if(s.length!==e)throw new ce("The ".concat(t," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(s.length," elements."));for(let n=0;n<e;++n){const a=s[n];if(!Oq(a))throw new ce("The ".concat(t," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(s)," including a")+" non-integer number ".concat(a))}return s}function Tr(s,e,t,n,a=1){if(s==null)return s;const o=e+(e-1)*(a-1);let i;return t==="same"?i=s:i=s-o+1,Math.floor((i+n-1)/n)}function Xr(s,e,t,n){if(s==null)return null;if(n==="valid")s=s*e+Pi([t-e,0]);else if(n==="same")s=s*e;else throw new ce("Unsupport padding mode: ".concat(n,"."));return s}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ww(s,e){return me(()=>(Ls(e),e==="channelsFirst"?Bt(s,[0,2,3,1]):s))}function _$(s,e){return me(()=>(Ls(e),e==="channelsFirst"?Bt(s,[0,2,3,4,1]):s))}function eX(s,e,t,n=1,a="valid",o,i=1){return me(()=>{if(o==null&&(o=Ar()),Ls(o),s.shape.length!==3)throw new ce("The input of a conv1dWithBias operation should be 3, but is "+"".concat(s.shape.length," instead."));if(e.shape.length!==3)throw new ce("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(t!=null&&t.shape.length!==1)throw new ce("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if(o==="channelsFirst"&&(s=Bt(s,[0,2,1])),a==="causal")throw new Et("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let c=Y2(s,e,n,a==="same"?"same":"valid","NWC",i);return t!=null&&(c=Rr(c,t)),c})}function MC(s,e,t,n=[1,1],a="valid",o,i,c=null){return me(()=>{if(o==null&&(o=Ar()),Ls(o),s.rank!==3&&s.rank!==4)throw new ce("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(s.rank,"."));if(e.rank!==3&&e.rank!==4)throw new ce("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(s.rank,"."));let u=ww(s,o);if(a==="causal")throw new Et("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=NT({x:u,filter:e,strides:n,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:c}),o==="channelsFirst"&&(u=Bt(u,[0,3,1,2])),u})}function tX(s,e,t,n=[1,1,1],a="valid",o,i){return me(()=>{if(o==null&&(o=Ar()),Ls(o),s.rank!==4&&s.rank!==5)throw new ce("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(s.rank,"."));if(e.rank!==4&&e.rank!==5)throw new ce("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(s.rank,"."));let c=_$(s,o);if(a==="causal")throw new Et("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return c=Vk(c,e,n,a==="same"?"same":"valid","NDHWC",i),t!=null&&(c=Rr(c,t)),o==="channelsFirst"&&(c=Bt(c,[0,4,1,2,3])),c})}class Wx extends Ot{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Wx.verifyArgs(t),this.rank=e,fn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Et("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=gu(t.kernelSize,e,"kernelSize"),this.strides=gu(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,za(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ls(this.dataFormat),this.activation=Bi(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=ms(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=tn(t.biasConstraint),this.biasRegularizer=gs(t.biasRegularizer),this.activityRegularizer=gs(t.activityRegularizer),this.dilationRate=gu(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ce("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ce("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ce("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}}static verifyArgs(e){if(Kr("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!iw(e.kernelSize,"number",1,3))throw new ce("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:zi(this.activation),useBias:this.useBias,biasInitializer:vs(this.biasInitializer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),biasConstraint:en(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class Pu extends Wx{constructor(e,t){super(e,t),this.kernel=null,Pu.verifyArgs(t),this.filters=t.filters,fn(this.filters,"filters"),this.kernelInitializer=ms(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=tn(t.kernelConstraint),this.kernelRegularizer=gs(t.kernelRegularizer)}build(e){e=Kt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ce("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return me(()=>{e=vt(e);let n;const a=this.bias==null?null:this.bias.read(),o=EI(this.activation.getClassName());if(o!=null&&this.rank===2)n=MC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)n=eX(e,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=MC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=tX(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Et("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(e){e=Kt(e);const t=[],n=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<n.length;++o){const i=Tr(n[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);t.push(i)}let a=[e[0]];return this.dataFormat==="channelsLast"?(a=a.concat(t),a.push(this.filters)):(a.push(this.filters),a=a.concat(t)),a}getConfig(){const e={filters:this.filters,kernelInitializer:vs(this.kernelInitializer),kernelRegularizer:ls(this.kernelRegularizer),kernelConstraint:en(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ce("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class Bp extends Pu{constructor(e){super(2,e),Bp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!iw(e.kernelSize,"number",1,2))throw new ce("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Bp.className="Conv2D";Ue(Bp);class Vp extends Pu{constructor(e){super(3,e),Vp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new ce("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}Vp.className="Conv3D";Ue(Vp);class F$ extends Bp{constructor(e){if(super(e),this.inputSpec=[new Qs({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ce("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=Kt(e),e.length!==4)throw new ce("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ce("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qs({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{let n=vt(e);if(n.shape.length!==4)throw new ce("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(n.shape.length));const a=n.shape,o=a[0];let i,c;this.dataFormat==="channelsFirst"?(i=2,c=3):(i=1,c=2);const u=a[i],h=a[c],p=this.kernelSize[0],f=this.kernelSize[1],g=this.strides[0],b=this.strides[1],y=Xr(u,g,p,this.padding),w=Xr(h,b,f,this.padding),v=[o,y,w,this.filters];this.dataFormat!=="channelsLast"&&(n=Bt(n,[0,2,3,1]));let N=Q2(n,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(N=Bt(N,[0,3,1,2])),this.bias!=null&&(N=Rr(N,this.bias.read(),this.dataFormat)),this.activation!=null&&(N=this.activation.apply(N)),N})}computeOutputShape(e){e=Kt(e);const t=e.slice();let n,a,o;this.dataFormat==="channelsFirst"?(n=1,a=2,o=3):(n=3,a=1,o=2);const i=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],h=this.strides[1];return t[n]=this.filters,t[a]=Xr(t[a],u,i,this.padding),t[o]=Xr(t[o],h,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}F$.className="Conv2DTranspose";Ue(F$);class L$ extends Vp{constructor(e){if(super(e),this.inputSpec=[new Qs({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ce("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(e=Kt(e),e.length!==5)throw new ce("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ce("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qs({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{let n=vt(e);if(n.shape.length!==5)throw new ce("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(n.shape.length));const a=n.shape,o=a[0];let i,c,u;this.dataFormat==="channelsFirst"?(u=2,i=3,c=4):(u=1,i=2,c=3);const h=a[u],p=a[i],f=a[c],g=this.kernelSize[0],b=this.kernelSize[1],y=this.kernelSize[2],w=this.strides[0],v=this.strides[1],N=this.strides[2],C=Xr(h,w,g,this.padding),T=Xr(p,v,b,this.padding),I=Xr(f,N,y,this.padding),$=[o,C,T,I,this.filters];this.dataFormat!=="channelsLast"&&(n=Bt(n,[0,2,3,4,1]));let R=Gk(n,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(R=Bt(R,[0,4,1,2,3])),this.bias!==null&&(R=Rr(R,this.bias.read(),this.dataFormat)),this.activation!==null&&(R=this.activation.apply(R)),R})}computeOutputShape(e){e=Kt(e);const t=e.slice();let n,a,o,i;this.dataFormat==="channelsFirst"?(n=1,a=2,o=3,i=4):(n=4,a=1,o=2,i=3);const c=this.kernelSize[0],u=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],f=this.strides[1],g=this.strides[2];return t[n]=this.filters,t[a]=Xr(t[a],p,c,this.padding),t[o]=Xr(t[o],f,u,this.padding),t[i]=Xr(t[i],g,h,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}L$.className="Conv3DTranspose";Ue(L$);class M$ extends Pu{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new ce("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new ce("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new ce("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=ms(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=gs(t.depthwiseRegularizer),this.depthwiseConstraint=tn(t.depthwiseConstraint),this.pointwiseInitializer=ms(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=gs(t.pointwiseRegularizer),this.pointwiseConstraint=tn(t.pointwiseConstraint)}build(e){if(e=Kt(e),e.length<this.rank+2)throw new ce("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new ce("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),o=[];for(let c=0;c<this.rank;++c)o.push(1);o.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Qs({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return me(()=>{e=vt(e);let n;if(this.rank===1)throw new Et("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Bt(e,[0,2,3,1])),n=fv(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=Rr(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Bt(n,[0,3,1,2])),n})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=vs(this.depthwiseInitializer),e.pointwiseInitializer=vs(this.pointwiseInitializer),e.depthwiseRegularizer=ls(this.depthwiseRegularizer),e.pointwiseRegularizer=ls(this.pointwiseRegularizer),e.depthwiseConstraint=en(this.depthwiseConstraint),e.pointwiseConstraint=en(this.pointwiseConstraint),e}}M$.className="SeparableConv";class P$ extends M${constructor(e){super(2,e)}}P$.className="SeparableConv2D";Ue(P$);class Hx extends Pu{constructor(e){super(1,e),Hx.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!iw(e.kernelSize,"number",1,1))throw new ce("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Hx.className="Conv1D";Ue(Hx);class z$ extends Ot{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return me(()=>{if(e=vt(e),this.dataFormat==="channelsLast"){const n=um(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return um(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const n=um(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return um(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}z$.className="Cropping2D";Ue(z$);class B$ extends Ot{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ls(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Eq(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{const t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return me(()=>{let n=vt(e);const a=n.shape;if(this.dataFormat==="channelsFirst"){n=Bt(n,[0,2,3,1]);const o=this.size[0]*a[2],i=this.size[1]*a[3],c=this.interpolation==="nearest"?_a.resizeNearestNeighbor(n,[o,i]):_a.resizeBilinear(n,[o,i]);return Bt(c,[0,3,1,2])}else{const o=this.size[0]*a[1],i=this.size[1]*a[2];return this.interpolation==="nearest"?_a.resizeNearestNeighbor(n,[o,i]):_a.resizeBilinear(n,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}B$.className="UpSampling2D";Ue(B$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sX(s,e,t=[1,1],n="valid",a,o){return me(()=>{a==null&&(a=Ar()),Ls(a);let i=ww(s,a);if(s.rank!==4)throw new ce("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(s.rank,"-D"));if(e.rank!==4)throw new ce("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return i=Tp(i,e,t,n==="same"?"same":"valid","NHWC",o),a==="channelsFirst"&&(i=Bt(i,[0,3,1,2])),i})}class V$ extends Wx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=ms(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=tn(e.depthwiseConstraint),this.depthwiseRegularizer=gs(e.depthwiseRegularizer)}build(e){if(e=Kt(e),e.length<4)throw new ce("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new ce("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{e=vt(e);let n=sX(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=Rr(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=Kt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=Tr(t,this.kernelSize[0],this.padding,this.strides[0]),i=Tr(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],a,o,i]:[e[0],o,i,a]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=vs(this.depthwiseInitializer),e.depthwiseRegularizer=ls(this.depthwiseRegularizer),e.depthwiseConstraint=en(this.depthwiseRegularizer),e}}V$.className="DepthwiseConv2D";Ue(V$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function U$(s,e,t,n){if(Array.isArray(s)){if(e!=null||t!=null)throw new ce("When inputs is an array, neither initialState or constants should be provided");n!=null&&(t=s.slice(s.length-n,s.length),s=s.slice(0,s.length-n)),s.length>1&&(e=s.slice(1,s.length)),s=s[0]}function a(o){return o==null||Array.isArray(o)?o:[o]}return e=a(e),t=a(t),{inputs:s,initialState:e,constants:t}}function G$(s,e,t,n=!1,a,o,i=!1,c=!1){return me(()=>{const u=e.shape.length;if(u<3)throw new ce("Input should be at least 3D, but is ".concat(u,"D."));const h=[1,0].concat($r(2,u));e=Bt(e,h),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=Xe(Xe(a,"bool"),"float32"),a.rank===u-1&&(a=vn(a,-1)),a=Bt(a,h)),n&&(e=dr(e,0),a!=null&&(a=dr(a,0)));const p=[];let f,g=t;const b=e.shape[0],y=hr(e);let w;a!=null&&(w=hr(a));for(let N=0;N<b;++N){const C=y[N],T=me(()=>s(C,g));if(a==null)f=T[0],g=T[1];else{const I=me(()=>{const $=w[N],R=tt(Ma($),$),O=Me(ae(T[0],$),ae(g[0],R)),P=g.map((_,M)=>Me(ae(T[1][M],$),ae(_,R)));return{output:O,newStates:P}});f=I.output,g=I.newStates}c&&p.push(f)}let v;return c&&(v=Na(p,1)),[f,v,g]})}class Ji extends Ot{constructor(e){super(e);let t;if(e.cell==null)throw new ce("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new Cw({cells:e.cell}):t=e.cell,t.stateSize==null)throw new ce("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Qs({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return $r(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){yy(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let a;if(this.returnSequences?a=[e[0],e[1],n]:a=[e[0],n],this.returnState){const o=[];for(const i of t)o.push([e[0],i]);return[a].concat(o)}else return a}computeMask(e,t){return me(()=>{Array.isArray(t)&&(t=t[0]);const n=this.returnSequences?t:null;if(this.returnState){const a=this.states.map(o=>null);return[n].concat(a)}else return n})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Et("Constants support is not implemented in RNN yet.");yy(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Qs({shape:[t,null,...n]});const a=[e[0]].concat(e.slice(2));this.cell.build(a);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!zt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new ce("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=o.map(i=>new Qs({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){me(()=>{if(!this.stateful)throw new qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(n==null)throw new ce("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Ys([n,a])):this.states_=[Ys([n,this.cell.stateSize])];else if(e==null)kt(this.states_),this.keptStates!=null&&(kt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Ys([n,a])):this.states_[0]=Ys([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ce("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t===!0?this.keptStates.push(this.states_.slice()):kt(this.states_);for(let a=0;a<this.states_.length;++a){const o=e[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,c=[n,i];if(!zt(o.shape,c))throw new ce("State ".concat(a," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(c,", received shape=").concat(o.shape));this.states_[a]=o}}this.states_=this.states_.map(a=>pn(a.clone()))})}apply(e,t){let n=t==null?null:t.initialState,a=t==null?null:t.constants;t==null&&(t={});const o=U$(e,n,a,this.numConstants);e=o.inputs,n=o.initialState,a=o.constants;let i=[],c=[];if(n!=null){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(const h of n)this.stateSpec.push(new Qs({shape:h.shape}));c=c.concat(this.stateSpec)}if(a!=null&&(t.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof so){const h=[e].concat(i),p=this.inputSpec.concat(c),f=this.inputSpec;this.inputSpec=p;const g=super.apply(h,t);return this.inputSpec=f,g}else return super.apply(e,t)}call(e,t){return me(()=>{const n=t==null?null:t.mask,a=t==null?null:t.training;let o=t==null?null:t.initialState;e=vt(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new ce("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(o.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const c={training:a},h=G$((y,w)=>{const v=this.cell.call([y].concat(w),c);return[v[0],v.slice(1)]},e,o,this.goBackwards,n,null,this.unroll,this.returnSequences),p=h[0],f=h[1],g=h[2];this.stateful&&this.resetStates(g,a);const b=this.returnSequences?f:p;return this.returnState?[b].concat(g):b})}getInitialState(e){return me(()=>{let t=Ys(e.shape);return t=it(t,[1,2]),t=Fp(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?xy(t,[1,n]):t):this.cell.stateSize>1?[xy(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Ji.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){const a=t.cell,o=Oo(a,n);return new e(Object.assign(t,{cell:o}))}}Ji.className="RNN";Ue(Ji);class qx extends Ot{}class Nw extends qx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,fn(this.units,"units"),this.activation=Bi(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=Su([1,Pi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,Pi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Kt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{if(e=e,e.length!==2)throw new ce("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const a=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Ma(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Ma(n),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,c=this.recurrentDropoutMask;i!=null?o=eo(ae(e,i),this.kernel.read()):o=eo(e,this.kernel.read()),this.bias!=null&&(o=Rr(o,this.bias.read())),c!=null&&(n=ae(n,c));let u=Me(o,eo(n,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zi(this.activation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}Nw.className="SimpleRNNCell";Ue(Nw);class W$ extends Ji{constructor(e){e.cell=new Nw(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(kt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(kt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return new e(t)}}W$.className="SimpleRNN";Ue(W$);class Sw extends qx{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ce("GRUCell does not support reset_after parameter set to true.");this.units=e.units,fn(this.units,"units"),this.activation=Bi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Bi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=Su([1,Pi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,Pi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Kt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return me(()=>{if(e=e,e.length!==2)throw new ce("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training==null?!1:t.training;let a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Ma(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Ma(a),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let c,u,h;0<this.dropout&&this.dropout<1&&(e=ae(e,o[0]));let p=eo(e,this.kernel.read());this.useBias&&(p=Rr(p,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ae(a,i[0]));const f=this.recurrentKernel.read(),[g,b]=va(f,[2*this.units,this.units],f.rank-1),y=eo(a,g),[w,v,N]=va(p,3,p.rank-1),[C,T]=va(y,2,y.rank-1);c=this.recurrentActivation.apply(Me(w,C)),u=this.recurrentActivation.apply(Me(v,T));const I=eo(ae(u,a),b);h=this.activation.apply(Me(N,I));const $=Me(ae(c,a),ae(Me(1,fs(c)),h));return[$,$]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zi(this.activation),recurrentActivation:zi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Sw.className="GRUCell";Ue(Sw);class H$ extends Ji{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Sw(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(kt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(kt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}H$.className="GRU";Ue(H$);class Kx extends qx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,fn(this.units,"units"),this.activation=Bi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Bi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ms(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=Su([1,Pi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Su([1,Pi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Kt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let a;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;a=new(t=class extends fr{apply(u,h){const p=o.apply([i]),f=new cw().apply([i]),g=o.apply([i*2]);return wC(wC(p,f),g)}},t.className="CustomInit",t)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return me(()=>{const n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new ce("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let a=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Ma(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Ma(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,c=this.recurrentDropoutMask;let u,h,p,f;0<this.dropout&&this.dropout<1&&(e=ae(e,i[0]));let g=eo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ae(a,c[0])),g=Me(g,eo(a,this.recurrentKernel.read())),this.useBias&&(g=Rr(g,this.bias.read()));const[b,y,w,v]=va(g,4,g.rank-1);u=this.recurrentActivation.apply(b),h=this.recurrentActivation.apply(y),p=Me(ae(h,o),ae(u,this.activation.apply(w))),f=this.recurrentActivation.apply(v);const N=ae(f,this.activation.apply(p));return[N,N,p]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:zi(this.activation),recurrentActivation:zi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),recurrentInitializer:vs(this.recurrentInitializer),biasInitializer:vs(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ls(this.kernelRegularizer),recurrentRegularizer:ls(this.recurrentRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Kx.className="LSTMCell";Ue(Kx);class q$ extends Ji{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Kx(e),super(e)}call(e,t){return me(()=>{this.cell.dropoutMask!=null&&(kt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(kt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}q$.className="LSTM";Ue(q$);class Cw extends qx{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return me(()=>{e=e;let n=e.slice(1);const a=[];for(const c of this.cells.slice().reverse())Array.isArray(c.stateSize)?a.push(n.splice(0,c.stateSize.length)):a.push(n.splice(0,1));a.reverse();const o=[];let i;for(let c=0;c<this.cells.length;++c){const u=this.cells[c];n=a[c],c===0?i=[e[0]].concat(n):i=[i[0]].concat(n),i=u.call(i,t),o.push(i.slice(1))}n=[];for(const c of o.slice().reverse())n.push(...c);return[i[0]].concat(n)})}build(e){yy(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,a)=>{Fl("RNNCell_".concat(a),()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=o=>({className:o.getClassName(),config:o.getConfig()}),a={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),a)}static fromConfig(e,t,n={}){const a=[];for(const o of t.cells)a.push(Oo(o,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return vy(e)}setWeights(e){const t=[];for(const n of this.cells){const a=n.weights.length,o=e.splice(a);for(let i=0;i<n.weights.length;++i)t.push([n.weights[i],o[i]])}gw(t)}}Cw.className="StackedRNNCells";Ue(Cw);function Vi(s){const{ones:e,rate:t,training:n=!1,count:a=1,dropoutFunc:o}=s,i=()=>o!=null?o(e(),t):MI(e(),t),c=()=>Mp(i,e,n);return!a||a<=1?pn(c().clone()):Array(a).fill(void 0).map(c).map(h=>pn(h.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var nX=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};class K$ extends Ji{constructor(e){if(e.unroll)throw new Et("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Et("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Qs({ndim:5})]}call(e,t){return me(()=>{if(this.cell.dropoutMask!=null&&(kt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(kt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new ce("ConvRNN2D cell does not support constants");const n=t==null?null:t.mask,a=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:o})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return me(()=>{const{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),o=[a[0],...a.slice(2)],i=Ys(o);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){me(()=>{if(!this.stateful)throw new qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),o=[a[0],...a.slice(2)];if(n[0]==null)throw new ce("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ys(o)):this.states_=[Ys(o)];else if(e==null)kt(this.states_),this.keptStates!=null&&(kt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ys(o)):this.states_[0]=Ys(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ce("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):kt(this.states_);for(let c=0;c<this.states_.length;++c){const u=e[c],h=o;if(!zt(u.shape,h))throw new ce("State ".concat(c," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(h,", received shape=").concat(u.shape));this.states_[c]=u}}this.states_=this.states_.map(c=>pn(c.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:a,padding:o,strides:i,dilationRate:c}=this.cell,u=t==="channelsFirst",h=e[u?3:2],p=e[u?4:3],f=Tr(h,a[0],o,i[0],c[0]),g=Tr(p,a[1],o,i[1],c[1]);return[...e.slice(0,2),...u?[n,f,g]:[f,g,n]]}}K$.className="ConvRNN2D";class jw extends Kx{constructor(e){const{filters:t,kernelSize:n,strides:a,padding:o,dataFormat:i,dilationRate:c}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,fn(this.filters,"filters"),this.kernelSize=gu(n,2,"kernelSize"),this.kernelSize.forEach(u=>fn(u,"kernelSize")),this.strides=gu(a||1,2,"strides"),this.strides.forEach(u=>fn(u,"strides")),this.padding=o||"valid",za(this.padding),this.dataFormat=i||"channelsLast",Ls(this.dataFormat),this.dilationRate=gu(c||1,2,"dilationRate"),this.dilationRate.forEach(u=>fn(u,"dilationRate"))}build(e){var t;e=Kt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ce("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const a=e[n],o=4,i=this.kernelSize.concat([a,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const c=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",c,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const h=this.biasInitializer,p=this.filters;u=new(t=class extends fr{apply(g,b){const y=h.apply([p]),w=ya([p]),v=h.apply([p*2]);return lw([y,w,v])}},t.className="CustomInit",t)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return me(()=>{if(e.length!==3)throw new ce("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,a=e[0],o=e[1],i=e[2],c=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Vi({ones:()=>Ma(a),rate:this.dropout,training:n,count:c,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,h=(J,xe,ye)=>!xe||!xe[ye]?J:ae(xe[ye],J);let p=h(a,u,0),f=h(a,u,1),g=h(a,u,2),b=h(a,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Vi({ones:()=>Ma(o),rate:this.recurrentDropout,training:n,count:c,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let w=h(o,y,0),v=h(o,y,1),N=h(o,y,2),C=h(o,y,3);const T=3,[I,$,R,O]=va(this.kernel.read(),c,T),[P,_,M,A]=this.useBias?va(this.bias.read(),c):[null,null,null,null];p=this.inputConv(p,I,P,this.padding),f=this.inputConv(f,$,_,this.padding),g=this.inputConv(g,R,M,this.padding),b=this.inputConv(b,O,A,this.padding);const[U,K,Q,X]=va(this.recurrentKernel.read(),c,T);w=this.recurrentConv(w,U),v=this.recurrentConv(v,K),N=this.recurrentConv(N,Q),C=this.recurrentConv(C,X);const B=this.recurrentActivation.apply(Me(p,w)),G=this.recurrentActivation.apply(Me(f,v)),Y=Me(ae(G,i),ae(B,this.activation.apply(Me(g,N)))),Z=ae(this.recurrentActivation.apply(Me(b,C)),this.activation.apply(Y));return[Z,Z,Y]})}getConfig(){const e=super.getConfig(),{units:t}=e,n=nX(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){const o=Li(e,t,this.strides,a||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?Rr(o,n,this.dataFormat):o}recurrentConv(e,t){return Li(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}jw.className="ConvLSTM2DCell";Ue(jw);class X$ extends K${constructor(e){const t=new jw(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}X$.className="ConvLSTM2D";Ue(X$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kw extends Ot{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,n=[];for(let a=0;a<this.noiseShape.length;++a)n.push(this.noiseShape[a]==null?t[a]:this.noiseShape[a]);return n}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e);if(0<this.rate&&this.rate<1){const a=t.training==null?!1:t.training,o=this.getNoiseShape(n);return Mp(()=>MI(n,this.rate,o,this.seed),()=>n,a)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}kw.className="Dropout";Ue(kw);class Y$ extends kw{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}Y$.className="SpatialDropout1D";Ue(Y$);class Z$ extends Ot{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,fn(this.units,"units"),this.activation=Bi(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=ms(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ms(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=tn(e.kernelConstraint),this.biasConstraint=tn(e.biasConstraint),this.kernelRegularizer=gs(e.kernelRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Kt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Kt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e),a=EI(this.activation.getClassName());let o;return a!=null?o=eo(n,this.kernel.read(),a,this.bias?this.bias.read():null):(o=eo(n,this.kernel.read()),this.bias!=null&&(o=Rr(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:zi(this.activation),useBias:this.useBias,kernelInitializer:vs(this.kernelInitializer),biasInitializer:vs(this.biasInitializer),kernelRegularizer:ls(this.kernelRegularizer),biasRegularizer:ls(this.biasRegularizer),activityRegularizer:ls(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),biasConstraint:en(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}Z$.className="Dense";Ue(Z$);class Q$ extends Ot{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Kt(e);for(const t of e.slice(1))if(t==null)throw new ce('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],Di(e,1)]}call(e,t){return me(()=>{this.invokeCallHook(e,t);let n=vt(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){const a=[0];for(let o=2;o<n.rank;++o)a.push(o);a.push(1),n=Bt(n,a)}return Lq(n)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}Q$.className="Flatten";Ue(Q$);class J$ extends Ot{constructor(e){super(e),this.supportsMasking=!0,this.activation=Bi(e.activation)}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e);return this.activation.apply(n)})}getConfig(){const e={activation:zi(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}J$.className="Activation";Ue(J$);class eA extends Ot{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return me(()=>(e=vt(e),_q(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}eA.className="RepeatVector";Ue(eA);class tA extends Ot{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",a=t.slice();let o=1,i=null;for(let u=0;u<a.length;++u){const h=a[u];if(this.isUnknown(h))if(i===null)i=u;else throw new ce("Can only specifiy one unknown dimension.");else o*=h}const c=Di(e);if(i!==null){if(o===0||c%o!==0)throw new ce(n);a[i]=c/o}else if(c!==o)throw new ce(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e),a=n.shape,o=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return le(n,o)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}tA.className="Reshape";Ue(tA);class sA extends Ot{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=$r(1,e.dims.length+1);if(!zt(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Qs({ndim:this.dims.length+1})]}computeOutputShape(e){e=Kt(e);const t=e.slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return Bt(vt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}sA.className="Permute";Ue(sA);class nA extends Ot{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=vt(e);return Mm(wu(n,this.maskValue),-1)}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e),i=Mm(wu(n,this.maskValue),-1,!0);return ae(n,Xe(i,n.dtype))})}}nA.className="Masking";Ue(nA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aA extends Ot{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Zt(e.inputLength))}this.inputDim=e.inputDim,fn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,fn(this.outputDim,"outputDim"),this.embeddingsInitializer=ms(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=gs(e.embeddingsRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.embeddingsConstraint=tn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return me(()=>this.maskZero?(e=vt(e),wu(e,Vt(e))):null)}computeOutputShape(e){if(e=Kt(e),this.inputLength==null)return[...e,this.outputDim];const t=Zt(this.inputLength);if(t.length!==e.length-1)throw new ce('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let a=0;a<t.length;++a){const o=t[a],i=e[a+1];if(o!=null&&i!=null&&o!==i)throw new ce('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));o==null&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return me(()=>{this.invokeCallHook(e,t);let n=vt(e);n.dtype!=="int32"&&(n=Jr(n,"int32"));const a=LI(this.embeddings.read(),le(n,[n.size]));return le(a,Kt(this.computeOutputShape(n.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vs(this.embeddingsInitializer),embeddingsRegularizer:ls(this.embeddingsRegularizer),activityRegularizer:ls(this.activityRegularizer),embeddingsConstraint:en(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}aA.className="Embedding";Ue(aA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rc extends Ot{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Et}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){const o=e[e.length-t.length+a],i=t[a];if(o==null||i==null||o<0||i<0)n.push(null);else if(o===1)n.push(i);else if(i===1)n.push(o);else{if(o!==i)throw new ce("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(o)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Kt(e)]),e=e,e.length<2)throw new ce("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const o of e)o!=null&&o[0]!==null&&t.push(o[0]);if(t=Ei(t),t.length>1)throw new ce("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}const a=e.map(o=>o.length);e.indexOf(null)===-1&&Ei(a).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return me(()=>{if(e=e,this.reshapeRequired){const n=[],a=e.map(o=>o.rank);if(a.indexOf(null)===-1){const o=Pi(a);for(let i of e){const c=i.rank;for(let u=0;u<o-c;++u)i=Fp(i,1);n.push(i)}return this.mergeFunction(n)}else{let o=!1;for(const u of e){const h=u.rank;if(h==null){const p=u.shape,f=p[0],g=p.slice(1).concat([f]);let b=le(u,[f].concat(Di(p.slice(1))));b=Bt(b,[1,0]),b=le(b,g),n.push(b),o=!0}else if(h>1){const p=$r(1,h).concat([0]);n.push(Bt(u,p)),o=!0}else n.push(u)}let i=this.mergeFunction(n);const c=i.rank;if(o){if(c==null){const u=i.shape,h=u.length,p=u[h-1],f=[p].concat(u.slice(0,u.length-1));i=le(Bt(le(i,[-1,p]),[1,0]),f)}else if(c>1){const u=[c-1].concat($r(0,c-1));i=Bt(i,u)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let a=1;a<e.length;++a){const o=e[a]==null?null:e[a].slice(1);t=this.computeElementwiseOpOutputShape(t,o)}let n=[];for(const a of e)a!=null&&a[0]!==null&&n.push(a[0]);return n=Ei(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return me(()=>{if(t==null)return null;if(!Array.isArray(t))throw new ce("`mask` should be an Array");if(!Array.isArray(e))throw new ce("`inputs` should be an Array");if(t.length!==e.length)throw new ce("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every(a=>a==null))return null;t=t.map(a=>a==null?a:vn(a,0));let n=t[0];for(let a=1;a<t.length-1;++a)n=to(n,t[a]);return n})}}class rA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Me(t,e[n]);return t})}}rA.className="Add";Ue(rA);class oA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ae(t,e[n]);return t})}}oA.className="Multiply";Ue(oA);class iA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Me(t,e[n]);return ae(1/e.length,t)})}}iA.className="Average";Ue(iA);class lA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Wo(t,e[n]);return t})}}lA.className="Maximum";Ue(lA);class cA extends rc{constructor(e){super(e)}mergeFunction(e){return me(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=ql(t,e[n]);return t})}}cA.className="Minimum";Ue(cA);class uA extends rc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new ce("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const a of e)if(a!=null){t=!1;break}if(t)return;const n=[];for(let a=0;a<e.length;++a){const o=e[a].slice();o.splice(this.axis,1);let i=!1;for(const c of n)if(zt(c,o)){i=!0;break}i||n.push(o)}if(n.length>1)throw new ce("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return me(()=>lw(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new ce("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),a=this.axis<0?n.length+this.axis:this.axis;for(const o of t.slice(1)){if(n[a]==null||o[a]==null){n[a]=null;break}n[a]+=o[a]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new ce("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ce("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new ce("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return me(()=>{let n=!0;if(t.forEach(i=>{if(i!=null){n=!1;return}}),n)return null;const a=[];for(let i=0;i<e.length;++i)t[i]==null?a.push(Xe(Ma(e[i]),"bool")):t[i].rank<e[i].rank?a.push(vn(t[i],-1)):a.push(t[i]);const o=Ts(a,this.axis);return K2(o,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}uA.className="Concatenate";Ue(uA);function ah(s,e){for(;s<0;)s+=e;return s}function aX(s,e,t){if(s.shape.length>3||e.shape.length>3)throw new Et("batchDot is not implemented for tensors of 4D or higher rank yet");if(V(s.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(s.shape.length)),V(s.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length)),typeof t=="number"&&(t=[t,t]),s.dtype==="complex64"||e.dtype==="complex64")throw new Et("batchDot is not implemented for complex64-type Tensors yet.");const n=s.shape.length,a=e.shape.length;t==null&&(t=[n-1,a-2]);const o=t;return me(()=>{let i;if(n>a){i=n-a;const u=[];for(let h=0;h<i;++h)u.push(1);e=le(e,e.shape.concat(u))}else if(a>n){i=a-n;const u=[];for(let h=0;h<i;++h)u.push(1);s=le(s,s.shape.concat(u))}else i=0;let c;if(s.shape.length===2&&e.shape.length===2)o[0]===o[1]?c=it(ae(s,e),o[0]):c=it(ae(Bt(s,[1,0]),e),o[1]);else{const u=o[0]!==s.shape.length-1,h=o[1]===e.shape.length-1;c=Ft(s,e,u,h)}if(i>0){let u;n>a?u=n+a-3:u=n-1;const h=[];for(let p=u;p<u+i;++p)h.push(p);c=Rs(c,h)}return c.shape.length===1&&(c=vn(c,1)),c})}class dA extends rc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){V(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Et("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new ce("Dimension incompatibility: "+"".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){if(e.length!==2)throw new ce("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t=e[0],n=e[1],a;return Array.isArray(this.axes)?a=this.axes.map((o,i)=>ah(o,e[i].shape.length)):a=[ah(this.axes,t.shape.length),ah(this.axes,n.shape.length)],this.normalize&&(t=qm(t,a[0]),n=qm(n,a[1])),aX(t,n,a)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[ah(this.axes,e.length),ah(this.axes,t.length)],n}computeOutputShape(e){V(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Et("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);const o=t.concat(n);return o.length===1&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}dA.className="Dot";Ue(dA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hA extends Ot{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e);return Mp(()=>Me(Bx(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}}hA.className="GaussianNoise";Ue(hA);class pA extends Ot{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return me(()=>{this.invokeCallHook(e,t);const n=vt(e);return this.rate>0&&this.rate<1?Mp(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return ae(n,Bx(n.shape,1,o))},()=>n,t.training||!1):n})}}pA.className="GaussianDropout";Ue(pA);class fA extends Ot{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||vt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return me(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e);return Mp(()=>{const o=vt(e),c=-1.6732632423543772*1.0507009873554805;let u=Yi(sc(n),this.rate);u=Jr(u,"float32");const h=((1-this.rate)*(1+this.rate*c**2))**-.5,p=-h*c*this.rate,f=Me(ae(o,u),ae(Me(u,-1),c));return Me(ae(f,h),p)},()=>vt(e),t.training||!1)}return e})}}fA.className="AlphaDropout";Ue(fA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nh(s,e,t,n,a,o=.001){let i;if(s.rank===2)i=Rk(s,e,t,n,a,o);else if(s.rank===3)i=Ok(s,e,t,n,a,o);else if(s.rank===4)i=_k(s,e,t,n,a,o);else throw new Et("batchNormalization is not implemented for array of rank ".concat(s.rank," ")+"yet");return i}function rX(s,e,t,n,a=.001){return me(()=>{const o=Sx(s,n),i=o.mean,c=o.variance;return[Nh(s,i,c,t,e,a),i,c]})}function oX(s,e,t,n,a=.001){return me(()=>{const o=Sx(s,n),i=o.mean,c=o.variance,u=[];for(const y of $r(0,s.rank))n.indexOf(y)!==-1?u.push(1):u.push(s.shape[y]);const h=le(i,u),p=le(c,u),f=e==null?null:le(e,u),g=t==null?null:le(t,u);return[Nh(s,h,p,g,f,a),i,c]})}function iX(s,e,t,n,a=.001){return zt(n.slice().sort(),$r(0,s.rank-1))?rX(s,e,t,n,a):oX(s,e,t,n,a)}class mA extends Ot{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ms(e.betaInitializer||"zeros"),this.gammaInitializer=ms(e.gammaInitializer||"ones"),this.movingMeanInitializer=ms(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ms(e.movingVarianceInitializer||"ones"),this.betaConstraint=tn(e.betaConstraint),this.gammaConstraint=tn(e.gammaConstraint),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer)}build(e){e=Kt(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new ce("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Qs({ndim:e.length,axes:{[t]:n}})];const a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return me(()=>{const n=t.training==null?!1:t.training,a=vt(e),o=a.shape,i=o.length,c=$r(0,i),u=this.axis>=0?this.axis:this.axis+i;c.splice(u,1);const h=Yl(1,i);h[u]=o[u];const p=c.slice();p.sort();const f=!zt(p,$r(0,i).slice(0,i-1)),g=()=>{if(f){const C=le(this.movingMean.read(),h),T=le(this.movingVariance.read(),h),I=this.center?le(this.beta.read(),h):null,$=this.scale?le(this.gamma.read(),h):null;return Nh(a,C,T,I,$,this.epsilon)}else return Nh(a,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return g();const[b,y,w]=iX(a,this.gamma.read(),this.beta.read(),c,this.epsilon),v=(C,T,I)=>{me(()=>{const $=1-I,R=C.read(),O=ae(tt(R,T),$);C.write(tt(R,O))})};return(()=>{v(this.movingMean,y,this.momentum),v(this.movingVariance,w,this.momentum)})(),b})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vs(this.betaInitializer),gammaInitializer:vs(this.gammaInitializer),movingMeanInitializer:vs(this.movingMeanInitializer),movingVarianceInitializer:vs(this.movingVarianceInitializer),betaRegularizer:ls(this.betaRegularizer),gammaRegularizer:ls(this.gammaRegularizer),betaConstraint:en(this.betaConstraint),gammaConstraint:en(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}mA.className="BatchNormalization";Ue(mA);class gA extends Ot{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}else throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ms(e.betaInitializer||"zeros"),this.gammaInitializer=ms(e.gammaInitializer||"ones"),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Kt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error("Invalid axis: ".concat(o));if(this.axis.length!==Ei(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map(o=>e[o]),a=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,t){const n=vt(e),a=n.shape,o=a.length;return me(()=>{let{mean:c,variance:u}=Sx(n,this.axis,!0);const h=Yl(1,o);for(const w of this.axis)h[w]=a[w];const p=w=>w!=null&&w.shape.length!==o?le(w,h):w;let f=this.scale?p(this.gamma.read()):null,g=this.center?p(this.beta.read()):null;const b=[],y=[];for(let w=0;w<o;++w)this.axis.indexOf(w)!==-1?(b.push(a[w]),y.push(1)):(b.push(1),y.push(a[w]));return c=rr(c,b),u=rr(u,b),f!=null&&(f=rr(f,y)),g!=null&&(g=rr(g,y)),Nh(n,c,u,g,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vs(this.betaInitializer),gammaInitializer:vs(this.gammaInitializer),betaRegularizer:ls(this.betaRegularizer),gammaRegularizer:ls(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}gA.className="LayerNormalization";Ue(gA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lX(s,e,t){return me(()=>{if(s.rank!==4)throw new ce("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(s.rank,"-D tensor."));if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new ce("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Ar()),t!=="channelsLast"&&t!=="channelsFirst")throw new ce("Unknown data format: ".concat(t,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let n;return t==="channelsFirst"?n=[[0,0],[0,0],e[0],e[1]]:n=[[0,0],e[0],e[1],[0,0]],Zi(s,n)})}class xA extends Ot{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ar():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ce("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ce("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],e.padding[1].length!==2)throw new ce("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){e=Kt(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return me(()=>lX(vt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}xA.className="ZeroPadding2D";Ue(xA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xx(s,e,t,n,a,o){return me(()=>{Ls(a),RI(o),za(n),t==null&&(t=[1,1]),n==null&&(n="valid"),a==null&&(a=Ar()),o==null&&(o="max"),s=ww(s,a);let i;const c=n==="same"?"same":"valid";return o==="max"?i=Nx(s,e,t,c):i=fx(s,e,t,c),a==="channelsFirst"&&(i=Bt(i,[0,3,1,2])),i})}function bA(s,e,t,n,a,o){return me(()=>{Ls(a),RI(o),za(n),t==null&&(t=[1,1,1]),n==null&&(n="valid"),a==null&&(a=Ar()),o==null&&(o="max"),s=_$(s,a);let i;const c=n==="same"?"same":"valid";return o==="max"?i=rT(s,e,t,c):i=Dk(s,e,t,c),a==="channelsFirst"&&(i=Bt(i,[0,4,1,2,3])),i})}class yA extends Ot{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new ce("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));if(fn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new ce("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));fn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,za(this.padding),this.inputSpec=[new Qs({ndim:3})]}computeOutputShape(e){e=Kt(e);const t=Tr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return me(()=>{this.invokeCallHook(e,t),e=Fp(vt(e),2);const n=this.poolingFunction(vt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Rs(n,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class vA extends yA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),Xx(e,t,n,a,o,"max")}}vA.className="MaxPooling1D";Ue(vA);class wA extends yA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),Xx(e,t,n,a,o,"avg")}}wA.className="AveragePooling1D";Ue(wA);class NA extends Ot{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ce("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];fn(this.poolSize,"poolSize"),fn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ls(this.dataFormat),za(this.padding),this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){e=Kt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Tr(t,this.poolSize[0],this.padding,this.strides[0]),n=Tr(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return me(()=>(this.invokeCallHook(e,t),this.poolingFunction(vt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class SA extends NA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),Xx(e,t,n,a,o,"max")}}SA.className="MaxPooling2D";Ue(SA);class CA extends NA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),Xx(e,t,n,a,o,"avg")}}CA.className="AveragePooling2D";Ue(CA);class jA extends Ot{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ce("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];fn(this.poolSize,"poolSize"),fn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ls(this.dataFormat),za(this.padding),this.inputSpec=[new Qs({ndim:5})]}computeOutputShape(e){e=Kt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Tr(t,this.poolSize[0],this.padding,this.strides[0]),n=Tr(n,this.poolSize[1],this.padding,this.strides[1]),a=Tr(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return me(()=>(this.invokeCallHook(e,t),this.poolingFunction(vt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class kA extends jA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),bA(e,t,n,a,o,"max")}}kA.className="MaxPooling3D";Ue(kA);class TA extends jA{constructor(e){super(e)}poolingFunction(e,t,n,a,o){return Ls(o),za(a),bA(e,t,n,a,o,"avg")}}TA.className="AveragePooling3D";Ue(TA);class IA extends Ot{constructor(e){super(e),this.inputSpec=[new Qs({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Et}}class $A extends IA{constructor(e){super(e||{})}call(e,t){return me(()=>{const n=vt(e);return ks(n,1)})}}$A.className="GlobalAveragePooling1D";Ue($A);class AA extends IA{constructor(e){super(e||{})}call(e,t){return me(()=>{const n=vt(e);return cr(n,1)})}}AA.className="GlobalMaxPooling1D";Ue(AA);class EA extends Ot{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ls(this.dataFormat),this.inputSpec=[new Qs({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Et}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class DA extends EA{call(e,t){return me(()=>{const n=vt(e);return this.dataFormat==="channelsLast"?ks(n,[1,2]):ks(n,[2,3])})}}DA.className="GlobalAveragePooling2D";Ue(DA);class RA extends EA{call(e,t){return me(()=>{const n=vt(e);return this.dataFormat==="channelsLast"?cr(n,[1,2]):cr(n,[2,3])})}}RA.className="GlobalMaxPooling2D";Ue(RA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class OA extends Ot{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){const a=t.layer,o=Oo(a,n);delete t.layer;const i={layer:o};return Object.assign(i,t),new e(i)}}class _A extends OA{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Kt(e),e.length<3)throw new ce("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Kt(e);const t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return me(()=>(e=vt(e),G$((i,c)=>[vt(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}_A.className="TimeDistributed";Ue(_A);function cX(s){ac(Aq,"BidirectionalMergeMode",s)}const uX="concat";class FA extends OA{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Oo(n),t.goBackwards=t.goBackwards!==!0;const a={};if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=Oo(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?uX:e.mergeMode,cX(this.mergeMode),e.weights)throw new Et("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,a,o;return this.returnState&&(o=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,a=[n]):this.mergeMode==null?a=[n,n.slice()]:a=[n],this.returnState?this.mergeMode==null?a.concat(o).concat(o.slice()):[n].concat(o).concat(o.slice()):na(a)}apply(e,t){let n=t==null?null:t.initialState,a=t==null?null:t.constants;t==null&&(t={});const o=U$(e,n,a,this.numConstants);if(e=o.inputs,n=o.initialState,a=o.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&a==null)return super.apply(e,t);const i=[],c=[];if(n!=null){const h=n.length;if(h%2>0)throw new ce("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);const p=n.map(f=>new Qs({shape:f.shape}));this.forwardLayer.stateSpec=p.slice(0,h/2),this.backwardLayer.stateSpec=p.slice(h/2),c.push(...p)}if(a!=null)throw new Et("Support for constants in Bidirectional layers is not implemented yet.");const u=i[0]instanceof so;for(const h of i)if(h instanceof so!==u)throw new ce("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const h=[e].concat(i),p=this.inputSpec.concat(c),f=this.inputSpec;this.inputSpec=p;const g=super.apply(h,t);return this.inputSpec=f,g}else return super.apply(e,t)}call(e,t){return me(()=>{const n=t.initialState;let a,o;if(n==null)a=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const u=n.slice(0,n.length/2),h=n.slice(n.length/2);a=this.forwardLayer.call(e,Object.assign(t,{initialState:u})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:h}))}let i;this.returnState&&(Array.isArray(a)&&(i=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),this.returnSequences&&(o=dr(o,1));let c;return this.mergeMode==="concat"?c=lw([a,o]):this.mergeMode==="sum"?c=Me(a,o):this.mergeMode==="ave"?c=ae(.5,Me(a,o)):this.mergeMode==="mul"?c=ae(a,o):this.mergeMode==null&&(c=[a,o]),this.returnState?this.mergeMode==null?c.concat(i):[c].concat(i):c})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Fl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Fl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(n)?n.concat(o).concat(o):[n].concat(o).concat(o)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=Oo(t.layer);if(delete t.layer,t.numConstants!=null)throw new Et("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const a=t;return a.layer=n,new e(a)}}FA.className="Bidirectional";Ue(FA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LA extends Ot{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return me(()=>(e=vt(e),e.dtype!=="float32"&&(e=Jr(e,"float32")),Me(ae(e,this.scale),this.offset)))}}LA.className="Rescaling";Ue(LA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:dX,cropAndResize:hX}=_a;class MA extends Ot{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,a,o,i,c,u){return me(()=>{let h,p=!1;const f=t/i,g=n/c,b=(a+t)/i,y=(o+n)/c,w=[f,g,b,y],v=[];e.rank===3?(p=!0,h=Na([e])):h=e;for(let $=0;$<h.shape[0];$++)v.push(w);const N=jr(v,[v.length,4]),C=Nu(0,v.length,1,"int32"),I=hX(h,N,C,[a,o],"nearest");return Jr(p?vt(hr(I)):I,u)})}upsize(e,t,n,a){return me(()=>{const o=dX(e,[t,n]);return Jr(o,a)})}call(e,t){return me(()=>{const n=vt(e),a=n.dtype,o=n.shape,i=o[o.length-3],c=o[o.length-2];let u=0;i!==this.height&&(u=Math.floor((i-this.height)/2));let h=0;return c!==this.width&&(h=Math.floor((c-this.width)/2),h===0&&(h=1)),u>=0&&h>=0?this.centerCrop(n,u,h,this.height,this.width,i,c,a):this.upsize(e,this.height,this.width,a)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Kt(e);const t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}MA.className="CenterCrop";Ue(MA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pX(s,e,t,n){let a=vt(s);if(a.dtype!=="int32"&&(a=Jr(a,"int32")),e==="int")return a;const o=a.shape;if(a.rank===0&&(a=vn(a,-1)),e==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=vn(a,-1)),a.rank>2)throw new ce("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(e," and input shape ").concat(o)+" which would result in output rank ".concat(a.rank,"."));const i=["multiHot","oneHot"].includes(e),c=a;let u;if(typeof n<"u"&&e==="count"?u=ey(c,n,t,i):u=ey(c,[],t,i),e!=="tfIdf")return u;if(n)return ae(u,n);throw new ce("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PA extends Ot{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Kt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return me(()=>{e=vt(e),e.dtype!=="int32"&&(e=Jr(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new ce("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=vt(t.countWeights)}const a=cr(e),o=fh(e),i=ka(this.numTokens,a).bufferSync().get(0),c=Yi(o,0).bufferSync().get(0);if(!(i&&c))throw new ce("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return pX(e,this.outputMode,this.numTokens,n)})}}PA.className="CategoryEncoding";Ue(PA);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fX=["bilinear","nearest"],PC=new Set(fX);class zA extends Ot{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(PC.has(e.interpolation))this.interpolation=e.interpolation;else throw new ce("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Kt(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return me(()=>{const n=[this.height,this.width];if(this.interpolation==="bilinear")return _a.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return _a.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...PC]," are supported"))})}}zA.className="Resizing";Ue(zA);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class BA{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}BA.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VA extends Ot{constructor(e){super(e),this.randomGenerator=new BA(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}VA.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mX=["bilinear","nearest"],zC=new Set(mX);class UA extends VA{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new ce("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));if(this.widthLower<-1||this.widthUpper<-1)throw new ce("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new ce("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n)if(zC.has(n))this.interpolation=n;else throw new ce("Invalid interpolation parameter: ".concat(n," is not implemented"))}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Kt(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return me(()=>{const n=vt(e);this.imgHeight=n.shape[n.shape.length-3];const a=n.shape[n.shape.length-2];this.widthFactor=sc([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*a;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return _a.resizeBilinear(e,i);case"nearest":return _a.resizeNearestNeighbor(e,i);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...zC]," are supported"))}})}}UA.className="RandomWidth";Ue(UA);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var BC;(function(s){s[s.FAIL=0]="FAIL",s[s.SHORTEST=1]="SHORTEST",s[s.LONGEST=2]="LONGEST"})(BC||(BC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(s,e){Array.isArray(s)||(s=[s]),s.forEach(t=>{t!=null&&V(t.dtype!=="complex64",()=>"".concat(e," does not support complex64 tensors in the CPU backend."))})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=Sv;class Yx extends Fy{nextDataId(){return Yx.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Lj(this,Wr())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Se().get("IS_NODE")&&Oa("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if(t==="string"&&n!=null&&n.length>0&&Ih(n[0])){const o=n.map(i=>Ai(i));a=this.write(o,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,n,a,o){this.data.set(e,{values:t,dtype:a,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){const a=this.readSync(n.real.dataId),o=this.readSync(n.imag.dataId);return Lo(a,o)}return Y8(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(a=>Ri(a));return Dt(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Dt(e.shape,e.dtype,t)}makeOutput(e,t,n){return Wr().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=sa();return e(),{kernelMs:sa()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){lt([e],"where");const t=this.readSync(e.dataId);return gX(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Yx.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GA(s){const e=new Float32Array(s.length);for(let t=0;t<s.length;++t)e[t]=Math.abs(s[t]);return e}const xX=s=>{const{x:e}=s.inputs,t=s.backend;lt(e,"abs");let n=new Float32Array(Ae(e.shape));const a=t.data.get(e.dataId).values;return n=GA(a),t.makeOutput(n,e.shape,e.dtype)},bX={kernelName:ug,backendName:"cpu",kernelFunc:xX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(s){return(e,t,n,a,o)=>{const i=Tt(e,t),c=i.length,u=ft(i),h=Ae(i),p=Sn(o,h),f=e.length,g=t.length,b=ft(e),y=ft(t),w=vu(e,i),v=vu(t,i);if(w.length+v.length===0)for(let N=0;N<p.length;++N)p[N]=s(n[N%n.length],a[N%a.length]);else for(let N=0;N<p.length;++N){const C=Du(N,c,u),T=C.slice(-f);w.forEach(O=>T[O]=0);const I=Zr(T,f,b),$=C.slice(-g);v.forEach(O=>$[O]=0);const R=Zr($,g,y);p[N]=s(n[I],a[R])}return[p,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(s){const{inputs:e,backend:t}=s,{real:n,imag:a}=e,o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,c=t.makeTensorInfo(n.shape,"complex64"),u=t.data.get(c.dataId);return u.complexTensorInfos={real:t.makeTensorInfo(n.shape,"float32",o),imag:t.makeTensorInfo(a.shape,"float32",i)},c}const yX={kernelName:Hy,backendName:"cpu",kernelFunc:ba};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qm(s,e,t="float32"){if(t==="complex64"){const a=Qm(s,e,"float32"),o=Qm(s,e,"float32");return ba({inputs:{real:a,imag:o},backend:s})}const n=Rn(Ae(e),t);return s.makeTensorInfo(e,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(s){const{inputs:e,backend:t}=s,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const vX={kernelName:Xh,backendName:"cpu",kernelFunc:no};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zl(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.data.get(n.dataId).complexTensorInfos.real,o=t.data.get(a.dataId).values;return t.makeTensorInfo(a.shape,a.dtype,o)}const wX={kernelName:C2,backendName:"cpu",kernelFunc:Zl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WA(s,e,t,n){if(n==="int32"){const a=Int32Array.from(s);return[e,"int32",a]}if(n==="bool"){const a=ec([0],t),[o,i]=Ms((c,u)=>c!==u?1:0)(e,[],s,a,"bool");return[i,"bool",o]}throw new Error("Error in Cast: failed to cast ".concat(t," to ").concat(n))}function Ui(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dtype:o}=n;if(o==="complex64"){if(a.dtype==="complex64")return no({inputs:{x:a},backend:t});const p=Qm(t,a.shape,a.dtype),f=Ui({inputs:{x:a},backend:t,attrs:{dtype:"float32"}}),g=ba({inputs:{real:f,imag:p},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),g}if(a.dtype==="complex64"){const p=Zl({inputs:{input:a},backend:t}),f=Ui({inputs:{x:p},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(p),f}if(!Pj(a.dtype,o)){const p=no({inputs:{x:a},backend:t});return{dataId:p.dataId,shape:p.shape,dtype:o}}const i=t.data.get(a.dataId).values,[c,u,h]=WA(i,a.shape,a.dtype,o);return t.makeTensorInfo(c,u,h)}const NX={kernelName:Fh,backendName:"cpu",kernelFunc:Ui};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(s,e,t,n){return t==null?({inputs:a,backend:o})=>{const{a:i,b:c}=a,u=o;lt([i,c],s);const h=u.data.get(i.dataId).values,p=u.data.get(c.dataId).values,f=i.dtype==="string"?Mo(h):h,g=i.dtype==="string"?Mo(p):p,b=n||i.dtype,[y,w]=e(i.shape,c.shape,f,g,b);return u.makeTensorInfo(w,b,y)}:({inputs:a,backend:o})=>{const{a:i,b:c}=a,u=o;if(i.dtype==="complex64"||c.dtype==="complex64"){const h=Ui({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),p=u.data.get(h.dataId),f=p.complexTensorInfos.real,g=p.complexTensorInfos.imag,b=u.data.get(f.dataId).values,y=u.data.get(g.dataId).values,w=Ui({inputs:{x:c},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(w.dataId),N=v.complexTensorInfos.real,C=v.complexTensorInfos.imag,T=u.data.get(N.dataId).values,I=u.data.get(C.dataId).values,[$,R,O]=t(i.shape,c.shape,b,y,T,I),P=u.makeTensorInfo(O,"float32",$),_=u.makeTensorInfo(O,"float32",R),M=ba({inputs:{real:P,imag:_},backend:u});return u.disposeIntermediateTensorInfo(h),u.disposeIntermediateTensorInfo(w),u.disposeIntermediateTensorInfo(P),u.disposeIntermediateTensorInfo(_),M}else{const h=u.data.get(i.dataId).values,p=u.data.get(c.dataId).values,f=n||i.dtype,[g,b]=e(i.shape,c.shape,h,p,f);return u.makeTensorInfo(b,f,g)}}}function Tw(s){return(e,t,n,a,o,i)=>{const c=Tt(e,t),u=Ae(c),h=c.length,p=ft(c),f=Sn("float32",u),g=Sn("float32",u),b=vu(e,c),y=vu(t,c),w=Lo(n,a),v=Lo(o,i),N=e.length,C=ft(e),T=t.length,I=ft(t);if(b.length+y.length===0)for(let $=0;$<f.length;$++){const R=$%w.length,O=$%v.length,P=s(w[R*2],w[R*2+1],v[O*2],v[O*2+1]);f[$]=P.real,g[$]=P.imag}else for(let $=0;$<f.length;$++){const R=Du($,h,p),O=R.slice(-N);b.forEach(U=>O[U]=0);const P=Zr(O,N,C),_=R.slice(-T);y.forEach(U=>_[U]=0);const M=Zr(_,T,I),A=s(w[P*2],w[P*2+1],v[M*2],v[M*2+1]);f[$]=A.real,g[$]=A.imag}return[f,g,c]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HA=Ms((s,e)=>s+e),SX=Tw((s,e,t,n)=>({real:s+t,imag:e+n})),Cu=nn(Ru,HA,SX),CX={kernelName:Ru,backendName:"cpu",kernelFunc:Cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iw(s,e,t,n,a){const o=Ae(n),i=Rn(a,t);for(let c=0;c<s.length;c++){const u=s[c];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o>0?i[u]+=e[c]:i[u]+=1)}return i}function qA(s,e,t,n=!1){const a=s.shape[0],o=s.shape[1],i=Dt([a,t],e.dtype);for(let c=0;c<a;c++)for(let u=0;u<o;u++){const h=s.get(c,u);if(h<0)throw new Error("Input x must be non-negative!");h>=t||(n?i.set(1,c,h):e.size>0?i.set(i.get(c,h)+e.get(c,u),c,h):i.set(i.get(c,h)+1,c,h))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KA=Ms((s,e)=>s&e),jX=nn(bg,KA),kX={kernelName:bg,backendName:"cpu",kernelFunc:jX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oo(s){return(e,t,n)=>{const a=Os(t,e.length);for(let o=0;o<e.length;++o)a[o]=s(e[o],n);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(s,e,t){const n=oo(e);return el(s,n,t)}function el(s,e,t){return({inputs:n,attrs:a,backend:o})=>{const{x:i}=n;lt(i,s);const c=o,u=c.data.get(i.dataId).values;let h;if(i.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");h=Mo(u)}else h=u;const p=t||i.dtype,f=e(h,p,a);return c.makeTensorInfo(i.shape,p,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XA=oo(s=>Math.ceil(s)),TX=el(Lh,XA),IX={kernelName:Lh,backendName:"cpu",kernelFunc:TX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YA(s,e,t,n){const a=Os(t,Ae(e));if(n&&t!=="string"){let o=0;s.forEach(i=>{const c=Ae(i.shape);a.set(i.vals,o),o+=c})}else{let o=0;s.forEach(i=>{const c=t==="string"?Mo(i.vals):i.vals;let u=0;for(let h=0;h<i.shape[0];++h){const p=h*e[1]+o;for(let f=0;f<i.shape[1];++f)a[p+f]=c[u++]}o+=i.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZA=Ms((s,e)=>s===e?1:0),QA=nn(Tg,ZA,null,"bool"),$X={kernelName:Tg,backendName:"cpu",kernelFunc:QA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA=oo(s=>Math.exp(s)),eE=el(Gh,JA,"float32"),AX={kernelName:Gh,backendName:"cpu",kernelFunc:eE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tE=oo(s=>Math.expm1(s)),EX=el(Wh,tE),DX={kernelName:Wh,backendName:"cpu",kernelFunc:EX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sE=oo(s=>Math.floor(s)),RX=el(Hh,sE),OX={kernelName:Hh,backendName:"cpu",kernelFunc:RX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE=Ms((s,e)=>Math.floor(s/e)),_X=nn(qh,nE,null,"int32"),FX={kernelName:qh,backendName:"cpu",kernelFunc:_X};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aE(s,e,t,n,a,o,i,c,u){const h=Dt([n,o],t);for(let p=0;p<n;p++){const f=[];let g=0;for(let b=0;b<a;b++){const y=s[p*a+b];g+=y*i[b],f.push(y)}if(g<0||g>=u/o)throw new Error("Invalid indices: ".concat(f," does not index into ").concat(c));for(let b=0;b<o;b++)h.values[p*o+b]=e.get(...e.indexToLoc(g*o+b))}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rE(s,e,t){const n=Dt(t,s.dtype);for(let a=0;a<n.size;++a){const i=n.indexToLoc(a).slice(),c=i[0],u=i[2],h=e.locToIndex([c,u]);i[2]=e.values[h];const p=s.locToIndex(i);0<=p&&p<s.values.length&&(n.values[a]=s.values[p])}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE=Ms((s,e)=>s>e?1:0),LX=nn(Eg,oE,null,"bool"),MX={kernelName:Eg,backendName:"cpu",kernelFunc:LX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE=Ms((s,e)=>s>=e?1:0),PX=nn(Kh,iE,null,"bool"),zX={kernelName:Kh,backendName:"cpu",kernelFunc:PX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lE=Ms((s,e)=>s<e?1:0),BX=nn(Rg,lE,null,"bool"),VX={kernelName:Rg,backendName:"cpu",kernelFunc:BX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cE=Ms((s,e)=>s<=e?1:0),UX=nn(Og,cE,null,"bool"),GX={kernelName:Og,backendName:"cpu",kernelFunc:UX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(s,e,t){const n=(e-s)/(t-1),a=Rn(t,"float32");a[0]=s;for(let o=1;o<a.length;o++)a[o]=a[o-1]+n;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dE=oo(s=>Math.log(s)),WX=el(Jh,dE),HX={kernelName:Jh,backendName:"cpu",kernelFunc:WX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hE(s,e,t,n){const a=Sn(n,Ae(t));for(let o=0;o<a.length;++o){const i=o*e;let c=s[i];for(let u=0;u<e;++u){const h=s[i+u];(Number.isNaN(h)||h>c)&&(c=h)}a[o]=c}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pE=Ms((s,e)=>Math.max(s,e)),qX=nn(tp,pE),KX={kernelName:tp,backendName:"cpu",kernelFunc:qX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE=Ms((s,e)=>Math.min(s,e)),XX=nn(sp,fE),YX={kernelName:sp,backendName:"cpu",kernelFunc:XX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $w=Ms((s,e)=>s*e),ZX=Tw((s,e,t,n)=>({real:s*t-e*n,imag:s*n+e*t})),Zx=nn(ap,$w,ZX),QX={kernelName:ap,backendName:"cpu",kernelFunc:Zx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mE(s,e,t){const n=Wi(-1,t);return $w([],e,n,s,t)}function JX(s){const{inputs:e,backend:t}=s,{x:n}=e;lt(n,"neg");const a=t.data.get(n.dataId).values,[o,i]=mE(a,n.shape,n.dtype);return t.makeTensorInfo(i,n.dtype,o)}const eY={kernelName:Wg,backendName:"cpu",kernelFunc:JX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gE=Ms((s,e)=>s!==e?1:0),tY=nn(Hg,gE,null,"bool"),sY={kernelName:Hg,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aw(s,e,t,n,a){const o=e.length,i=Ae(e),c=ft(e),u=ft(a),h=Sn(t,Ae(a));for(let p=0;p<i;++p){const f=Du(p,o,c),g=new Array(f.length);for(let y=0;y<g.length;y++)g[y]=f[n[y]];const b=Zr(g,o,u);h[b]=s[p]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(s){const{inputs:e,attrs:t,backend:n}=s,{x:a}=e,{perm:o}=t;lt(a,"transpose");const i=a.shape.length,c=new Array(i);for(let f=0;f<c.length;f++)c[f]=a.shape[o[f]];const u=n.data.get(a.dataId).values,h=Aw(u,a.shape,a.dtype,o,c);return{dataId:n.write(h,c,a.dtype),shape:c,dtype:a.dtype}}const nY={kernelName:du,backendName:"cpu",kernelFunc:ia};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xE(s,e,t,n){const[a,o]=gn(s,n),i=wa(e,"int32"),c=Rn(Ae(a),i),u=Ae(o);for(let h=0;h<c.length;++h){const p=h*u;let f=1;for(let g=0;g<u;++g)f*=t[p+g];c[h]=f}return{outVals:c,outShape:a,outDtype:i}}function aY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;lt(a,"prod");const c=a.shape.length,u=Rt(o,a.shape),h=ws(u,c);let p=u,f=a;const g=[];h!=null&&(f=ia({inputs:{x:a},backend:t,attrs:{perm:h}}),g.push(f),p=Fs(p.length,c));const b=t.data.get(f.dataId).values,{outVals:y,outShape:w,outDtype:v}=xE(f.shape,f.dtype,b,p);let N=w;return i&&(N=_s(w,u)),g.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(N,v,y)}const rY={kernelName:Qg,backendName:"cpu",kernelFunc:aY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oY(s,e,t){s.forEach((n,a)=>{if(n<0||n>=t){const o=Du(a,e.length,ft(e)).join(",");throw new Error("indices[".concat(o,"] = ").concat(n," is not in [0, ").concat(t,")"))}})}function iY(s,e){for(let t=0;t<s.length;++t){const n=s[t],a=t===s.length-1?e:s[t+1].length;if(n.length===0)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>a)throw new Error("Ragged splits must not point past values");for(let o=1;o<n.length;++o)if(n[o-1]>n[o])throw new Error("Ragged splits must be sorted in ascending order")}}function lY(s,e,t,n){const a=[];let o=0;const i=e.length-1+t.length,c=new Array(i).fill(null).map(()=>[0]);iY(t,n);let u=1;for(let h=0;h<e.length-1;++h){u*=e[h];const p=e[h+1];for(let f=1;f<u+1;++f)c[h].push(f*p)}for(let h=0;h<s.length;++h){let p=s[h],f=s[h]+1;for(let g=0;g<t.length;++g){const b=t[g],y=g+e.length-1;if(y>=0){const w=c[y],v=w[w.length-1]-b[p];for(let N=p;N<f;++N)c[y].push(b[N+1]+v)}p=b[p],f=b[f]}f!==p&&(a.push([p,f]),o+=f-p)}return{outSplits:c,valueSlices:a,numValues:o}}function cY(s){const e=[];for(let t=0;t<s.length;++t){const n=s[t].length,a=Os("int32",n);e.push(a),s[t].forEach((o,i)=>a[i]=o)}return e}function VC(s,e){const t=s.slice(0,e);for(;t.length<e;)t.push(1);for(let n=e;n<s.length;n++)t[e-1]*=s[n];return t}function uY(s,e,t,n,a,o){const i=VC(e,2)[1],c=VC(o,2)[1];let u=0;for(const h of t)for(let p=h[0];p<h[1];++p){for(let f=0;f<n;++f)a[u*c+f]=s[p*i+f];++u}}function dY(s,e,t,n,a){const o=e.slice();o[0]=a;const i=Os(t,Ae(o)),c=s.length,u=c===0?0:c/e[0];return uY(s,e,n,u,i,o),[i,o]}function bE(s,e,t,n,a,o,i,c){if(s.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(oY(o,i,u),n.length===0)throw new Error("params.rank must be nonzero");const h=n[0],{outSplits:p,valueSlices:f,numValues:g}=lY(o,i,s,h),b=cY(p),y=dY(t,n,a,f,g);return[b,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UC=2147483647;function yE(s,e,t,n,a,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const c=e.length===0,u=a.length===0,h=i.length===0,p=[];c||p.push(e[0]),u||p.push(a[0]),h||p.push(i[0]);for(let v=1;v<p.length;++v)if(p[v]!==p[v-1])throw new Error("starts, limits, and deltas must have the same shape");const f=p.length===0?1:p[0],g=Os("int32",f+1);g[0]=0;for(let v=0;v<f;++v){const N=c?s[0]:s[v],C=u?n[0]:n[v],T=h?o[0]:o[v];if(T===0)throw new Error("Requires delta != 0");let I;if(T>0&&C<N||T<0&&C>N)I=0;else if(I=Math.ceil(Math.abs((C-N)/T)),I>UC)throw new Error("Requires ((limit - start) / delta) <= ".concat(UC));g[v+1]=g[v]+I}const b=g[f],y=Os(t,b);let w=0;for(let v=0;v<f;++v){const N=g[v+1]-g[v];let C=c?s[0]:s[v];const T=h?o[0]:o[v];for(let I=0;I<N;++I)y[w++]=C,C+=T}return[g,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tr=Sr;class Jm{constructor(e,t,n,a,o,i,c,u,h,p){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=c,this.rowPartitionValues=u,this.rowPartitionValuesShapes=h,this.rowPartitionTypes=QT(p),this.raggedRank=JT(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===tr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===tr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case tr.VALUE_ROWIDS:return Jm.getMaxWidthValueRowID(t);case tr.ROW_SPLITS:return Jm.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(tr[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let n=0;for(let a=0;a<t-1;++a){const o=e[a+1]-e[a];o>n&&(n=o)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let n=0,a=e[0],o=0;for(let i=1;i<t;++i){const c=e[i];c!==a&&(a=c,o=Math.max(i-n,o),n=i)}return Math.max(t-n,o)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return WC(e,n)}calculateOutputSize(e){const t=this.valuesShape,n=this.defaultValueShape;eI(n,t);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=ZT(this.raggedRank,a,t);i[0]<0&&(i[0]=e);for(let c=1;c<=this.raggedRank;++c)i[c]<0&&(i[c]=this.getMaxWidth(c));return i}calculateFirstParentOutputIndex(e,t,n){const a=Math.min(e,n),o=[];let i=0;for(let c=0;c<a;++c,i+=t)o.push(i);for(let c=a;c<e;++c)o.push(-1);return V(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,n,a){const o=e.length,i=[];for(let c=0;c<o-1;++c){const u=e[c+1]-e[c];let h=Math.min(a,u),p=t[c];p===-1&&(h=0);for(let f=0;f<h;++f)i.push(p),p+=n;for(let f=0;f<u-h;++f)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,a){const o=e.length,i=[];if(o===0)return[];let c=0,u=e[0];if(u>=t.length)throw new Error("Got currentValueRowId=".concat(u,", which is not less than ").concat(t.length));let h=t[u];i.push(h);for(let p=1;p<o;++p){const f=e[p];if(f===u)h>=0&&(++c,c<a?h+=n:h=-1);else{if(c=0,u=f,f>=t.length)throw new Error("Got nextValueRowId=".concat(f," which is not less than ").concat(t.length));h=t[f]}i.push(h)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,a){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case tr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,n,a);case tr.ROW_SPLITS:if(o.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(o.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(o,t,n,a);default:throw new Error("Unsupported partition type: ".concat(tr[i]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case tr.FIRST_DIM_SIZE:return e[0];case tr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case tr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(tr[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let u=a.length-2;u>=0;--u)a[u]=a[u+1]*n[u+1];const o=WC(n,!1),i=Os(this.valuesDType,Ae(o));if(a[0]*n[0]>0){let u=this.calculateFirstParentOutputIndex(t,a[0],n[0]);for(let h=1;h<=this.raggedRank;++h)u=this.calculateOutputIndex(h-1,u,a[h],n[h]);this.setOutput(this.raggedRank,u,i,o)}return[o,i]}setOutput(e,t,n,a){if(n.length===0)return;const o=this.values,i=n;let c=a.slice();c=c.slice(e+1);const u=Ae(c),h=t.length;let p=this.defaultValue;if(p.length!==u&&p.length!==1){const y=this.defaultValueShape;me(()=>{const w=le(p,y);p=fu(w,c).dataSync()})}let f=0,g=0,b=0;for(let y=0;y<=h;++y){let w=y<h?t[y]:-1;if(w===b){++b;continue}if(g<b){const v=o.subarray(f*u),N=i.subarray(g*u),C=(b-g)*u;GC(N,v,C)}if(y>=h){const v=n.length;w=Math.floor(v/u)}if(w>b)if(this.defaultValue.length===1)i.subarray(b*u,w*u).fill(this.defaultValue[0]),b=w;else for(;w>b;){const v=i.slice(b*u);GC(v,p,u),++b}w<0?(f=y+1,g=b):(f=y,g=b,b=g+1)}}}function GC(s,e,t){for(let n=0;n<t;n++)s[n]=e[n]}function WC(s,e){const t=[];for(let n of s){if(n<0){if(!e)throw new Error("Dimension ".concat(n," must be >= 0"));if(n<-1)throw new Error("Dimension ".concat(n," must be >= -1"));n=-1}t.push(n)}return t}function vE(s,e,t,n,a,o,i,c,u,h){return new Jm(s,e,t,n,a,o,i,c,u,h).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wE(s,e,t,n){const a=s===e,o=s<e&&t<0,i=e<s&&t>1;if(a||o||i)return Rn(0,n);const c=Math.abs(Math.ceil((e-s)/t)),u=Rn(c,n);e<s&&t===1&&(t=-1),u[0]=s;for(let h=1;h<u.length;h++)u[h]=u[h-1]+t;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NE=oo(s=>1/Math.sqrt(s)),hY=el(up,NE),pY={kernelName:up,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(s,e,t,n,a,o,i,c,u,h){const p=[n/a,a],f=s.values,g=e.values;if(n===0)return Dt(t,e.dtype);const b=u instanceof Js?u:Dt(p,e.dtype);typeof u=="string"||typeof u=="number"?b.values.fill(u):typeof u=="boolean"&&b.values.fill(+u);for(let y=0;y<o;y++){const w=[];let v=0;for(let N=0;N<i;N++){const C=f[y*i+N];w.push(C),v+=C*c[N]}if(v<0||v>=n/a)throw new Error("Invalid indices: ".concat(w," does not index into ").concat(t));for(let N=0;N<a;N++)h?b.values[v*a+N]+=g[y*a+N]:b.values[v*a+N]=e.rank===0?g[0]:g[y*a+N]}return b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY=oo(s=>1/(1+Math.exp(-s))),SE=Qt(mp,s=>1/(1+Math.exp(-s))),mY={kernelName:mp,backendName:"cpu",kernelFunc:SE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CE(s,e,t,n,a){const o=Fv(n,e,t),i=Ae(t),c=ft(n);if(o){const f=Lv(e,c);return a==="string"?s.slice(f,f+i):s.subarray(f,f+i)}const u=a==="string"?Mo(s):s,h=Dt(n,a,u),p=Dt(t,a);for(let f=0;f<p.size;++f){const g=p.indexToLoc(f),b=g.map((y,w)=>y+e[w]);p.set(h.get(...b),...g)}return a==="string"?vI(p.values):p.values}function Ql(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,size:i}=n;lt(a,"slice");const[c,u]=Fx(a,o,i);Ov(a,c,u);const h=t.data.get(a.dataId).values,p=CE(h,c,u,a.shape,a.dtype);return t.makeTensorInfo(u,a.dtype,p)}const gY={kernelName:ax,backendName:"cpu",kernelFunc:Ql};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jE(s,e,t,n,a,o,i){const c=e[0],u=o[0],h=new Array(u),p=new Array(c),f=e[1];if(u===0){if(c!==0)throw new Error(iI(c));const v=Os(t,0),N=Os(a,0);return[v,[0,f],N,h,p]}let g=!0,b=0;const y=new Array(u).fill(0);for(let v=0;v<c;++v){const N=s[v*f];if(N<0)throw new Error(lI(v,N));if(N>=u)throw new Error(cI(v,N,u));++y[N],g=g&&N>=b,b=N}let w=!0;for(let v=0;v<u;++v){const N=y[v]===0;h[v]=N,w=w&&!N,y[v]=Math.max(y[v],1),v>0&&(y[v]+=y[v-1])}if(w&&g){const v=s,N=n;for(let C=0;C<c;++C)p[C]=C;return[v,[c,f],N,h,p]}else{const v=y[u-1],N=Os(t,v*f),C=Os(a,v),T=new Array(u).fill(0);for(let I=0;I<c;++I){const $=s[I*f],R=T[$],O=($===0?0:y[$-1])+R;T[$]++;for(let P=0;P<f;++P)N[O*f+P]=s[I*f+P];C[O]=n[I],p[I]=O}for(let I=0;I<u;++I)if(T[I]===0){const R=I===0?0:y[I-1];N[R*f+0]=I;for(let O=1;O<f;++O)N[R*f+O]=0;C[R]=i}return[N,[v,f],C,h,p]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(s,e,t,n,a){const o=Ae(n),i=e[0],c=a.length,u=[];let h=1,p=-1;for(let v=0;v<c;++v){const N=a[v];if(N===-1){if(p!==-1)throw new Error(uI(p,v));p=v,u.push(1)}else{if(N<0)throw new Error(dI(v,N));h*=N,u.push(N)}}if(p!==-1){if(h<=0)throw new Error(hI());const v=Math.trunc(o/h);if(h*v!==o)throw new Error(pI(n,u));u[p]=v}if(Ae(u)!==o)throw new Error(fI(n,u));const g=n.length,b=[];if(g>0){b[g-1]=1;for(let v=g-2;v>=0;--v)b[v]=b[v+1]*n[v+1]}const y=[];if(c>0){y[c-1]=1;for(let v=c-2;v>=0;--v)y[v]=y[v+1]*u[v+1]}const w=Os(t,i*c);for(let v=0;v<i;++v){let N=0;for(let C=0;C<g;++C)N+=s[v*g+C]*b[C];for(let C=0;C<c;++C)w[v*c+C]=Math.trunc(N/y[C]),N%=y[C]}return[w,[i,c],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ew(s,e,t,n,a,o=!1,i=0){const c=n.length,u=[e[0],s.length/e[0]],h=u[1],f=c>0?a[c-1]+1:0;if(f<0)throw new Error(ay());const g=e.slice();g[0]=f;const b=g.reduce((T,I)=>T*I,1),y=Os(t,b);if(c===0)return f>0&&y.fill(i),[y,g];if(f<=0)throw new Error(ay());let w=0,v=1,N=0,C=a[w];for(;;){let T=0;if(v<c){if(T=a[v],C===T){++v;continue}if(C>=T)throw new Error(mI())}if(C<0||C>=f)throw new Error(gI(C,f));C>N&&y.fill(i,N*h,C*h);for(let I=w;I<v;++I){const $=n[I];if($<0||$>=u[0])throw new Error(xI(I,n[I],u[0]));for(let R=0;R<h;R++)y[C*h+R]+=s[$*h+R]}if(o)for(let I=0;I<h;I++)y[C*h+I]/=v-w;if(w=v,++v,N=C+1,C=T,v>c)break}return N<f&&y.fill(i,N*h,f*h),[y,g]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=oo(s=>Math.sqrt(s)),bY=Qt(xp,s=>Math.sqrt(s)),yY={kernelName:xp,backendName:"cpu",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TE=Ms((s,e)=>{const t=s-e;return t*t}),vY=nn(bp,TE),wY={kernelName:bp,backendName:"cpu",kernelFunc:vY};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IE=oo((s,e)=>{const{pattern:t,replaceGlobal:n,rewrite:a}=e;return s.replace(new RegExp(t,n?"g":""),a)}),NY=el(cx,IE),SY={kernelName:cx,backendName:"cpu",kernelFunc:NY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $E(s,e,t,n){const a=Dt(s,e.dtype);for(let o=0;o<a.size;o++){const i=a.indexToLoc(o),c=new Array(i.length);for(let u=0;u<c.length;u++)c[u]=i[u]*t[u]+n[u];a.set(e.get(...c),...i)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CY{constructor(e,t,n,a,o,i){this.separator=Ai(e),this.nGramWidths=t,this.leftPad=Ai(n),this.rightPad=Ai(a),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,o,i){for(let c=0;c<o;++c){const u=this.getPadWidth(i),h=Math.max(0,u-c),p=Math.max(0,u-(o-(c+1))),f=i-(h+p),g=t+(h>0?0:c-u);let b=0;b+=h*this.leftPad.length;for(let C=0;C<f;++C)b+=e[g+C].length;b+=p*this.rightPad.length;const y=h+p+f-1;b+=y*this.separator.length,n[a+c]=new Uint8Array(b);const w=n[a+c];let v=0;const N=C=>C.forEach(T=>w[v++]=T);for(let C=0;C<h;++C)N(this.leftPad),N(this.separator);for(let C=0;C<f-1;++C)N(e[g+C]),N(this.separator);if(f>0){N(e[g+f-1]);for(let C=0;C<p;++C)N(this.separator),N(this.rightPad)}else{for(let C=0;C<p-1;++C)N(this.rightPad),N(this.separator);N(this.rightPad)}}}compute(e,t){const n=e.length,a=t.length;if(a>0){let u=t[0];if(u!==0)throw new Error("First split value must be 0, got ".concat(u));for(let h=1;h<a;++h){let p=t[h]>=u;if(p=p&&t[h]<=n,!p)throw new Error("Invalid split value ".concat(t[h],", must be in [").concat(u,", ").concat(n,"]"));u=t[h]}if(u!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(u))}const o=a-1,i=Os("int32",a);if(n===0||a===0){const u=new Array(n);for(let h=0;h<=o;++h)i[h]=0;return[u,i]}i[0]=0;for(let u=1;u<=o;++u){const h=t[u]-t[u-1];let p=0;this.nGramWidths.forEach(f=>{p+=this.getNumNGrams(h,f)}),this.preserveShort&&h>0&&p===0&&(p=1),i[u]=i[u-1]+p}const c=new Array(i[o]);for(let u=0;u<o;++u){const h=t[u];let p=i[u];if(this.nGramWidths.forEach(f=>{const g=t[u+1]-t[u],b=this.getNumNGrams(g,f);this.createNGrams(e,h,c,p,b,f),p+=b}),this.preserveShort&&p===i[u]){const f=t[u+1]-t[u];if(f===0)continue;const g=f+2*this.padWidth;this.createNGrams(e,h,c,p,1,g)}}return[c,i]}}function AE(s,e,t,n,a,o,i,c){return new CY(t,n,a,o,i,c).compute(s,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jY(s,e,t,n){if(!s.length)return;if(e.length===0){for(let o=0;o<s.length;++o)n.push(s.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=s.indexOf(o);for(;i!==-1;){const c=s.subarray(0,i);(!t||c.length!==0)&&n.push(c),s=s.subarray(i+1),i=s.indexOf(o)}(!t||s.length!==0)&&n.push(s);return}let a=0;for(let o=0;o<s.length+1;o++)if(o===s.length||e.indexOf(s[o])!==-1){const i=s.subarray(a,o);(!t||i.length!==0)&&n.push(i),a=o+1}}function EE(s,e,t){const n=s.length,a=[];let o=0,i=0;const c=new Array(n);for(let g=0;g<n;++g){const b=a.length;jY(s[g],e,t,a);const y=a.length-b;c[g]=y,o+=y,i=Math.max(i,y)}const u=Os("int32",o*2),h=new Array(o),p=[n,i];let f=0;for(let g=0;g<n;++g)for(let b=0;b<c[g];++b)u[f*2]=g,u[f*2+1]=b,h[f]=a[f],++f;return[u,h,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DE(s,e){const t=Os("int32",s.length);for(let n=0;n<s.length;++n)t[n]=f7(s[n]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RE=Ms((s,e)=>s-e),kY=Tw((s,e,t,n)=>({real:s-t,imag:e-n})),Dw=nn(yp,RE,kY),TY={kernelName:yp,backendName:"cpu",kernelFunc:Dw};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OE(s,e){const t=new Array(s.rank);for(let a=0;a<t.length;a++)t[a]=s.shape[a]*e[a];const n=Dt(t,s.dtype);for(let a=0;a<n.values.length;++a){const o=n.indexToLoc(a),i=new Array(s.rank);for(let u=0;u<i.length;u++)i[u]=o[u]%s.shape[u];const c=s.locToIndex(i);n.values[a]=s.values[c]}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lh=(s,e)=>{const t=e.value-s.value;return t===0?s.index-e.index:t};function _E(s,e,t=0,n=s.length-1){for(;n>t;){if(n-t>600){const c=n-t+1,u=e-t+1,h=Math.log(c),p=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*p*(c-p)/c)*Math.sign(u-c/2),g=Math.max(t,Math.floor(e-u*p/c+f)),b=Math.min(n,Math.floor(e+(c-u)*p/c+f));_E(s,e,g,b)}const a=s[e];let o=t,i=n;for(ou(s,t,e),lh(s[n],a)>0&&ou(s,t,n);o<i;){for(ou(s,o,i),o++,i--;lh(s[o],a)<0;)o=o+1;for(;lh(s[i],a)>0;)i=i-1}lh(s[t],a)===0?ou(s,t,i):(i=i+1,ou(s,i,n)),i<=e&&(t=i+1),e<=i&&(n=i-1)}}function FE(s,e,t,n,a){const o=e[e.length-1],[i,c]=[s.length/o,o],u=Sn(t,i*n),h=Sn("int32",i*n);for(let f=0;f<i;f++){const g=f*c,b=s.subarray(g,g+c);let y=new Array(b.length);b.forEach((C,T)=>y[T]={value:C,index:T}),n<y.length&&(_E(y,n),y=y.slice(0,n)),a&&y.sort(lh);const w=f*n,v=u.subarray(w,w+n),N=h.subarray(w,w+n);for(let C=0;C<n;C++)v[C]=y[C].value,N[C]=y[C].index}const p=e.slice();return p[p.length-1]=n,[Dt(p,t,u),Dt(p,"int32",h)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LE(s,e,t,n){const a=Rt(e,t)[0],o=[1,t[0],1];for(let y=0;y<a;y++)o[0]*=t[y];o[1]=t[a];for(let y=a+1;y<t.length;y++)o[2]*=t[y];const i=new Map,c=new Int32Array(t[a]),u=new Js(o,n,s),h=[],p=o[0]===1&&o[2]===1;for(let y=0;y<t[a];y++){let w;if(p)w=s[y].toString();else{const N=[];for(let C=0;C<o[0];C++)for(let T=0;T<o[2];T++)N.push(u.get(C,y,T));w=N.join(",")}const v=i.get(w);if(v!=null)c[y]=v;else{const N=i.size;i.set(w,N),c[y]=N,h.push(y)}}const f=o.slice();f[1]=i.size;const g=new Js(f,n);h.forEach((y,w)=>{for(let v=0;v<o[0];v++)for(let N=0;N<o[2];N++)g.set(u.get(v,y,N),v,w,N)});const b=t.slice();return b[a]=f[1],{outputValues:g.values,outputShape:b,indices:c}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY=Object.freeze(Object.defineProperty({__proto__:null,addImpl:HA,bincountImpl:Iw,bincountReduceImpl:qA,bitwiseAndImpl:KA,castImpl:WA,ceilImpl:XA,concatImpl:YA,equalImpl:ZA,expImpl:JA,expm1Impl:tE,floorDivImpl:nE,floorImpl:sE,gatherNdImpl:aE,gatherV2Impl:rE,greaterEqualImpl:iE,greaterImpl:oE,lessEqualImpl:cE,lessImpl:lE,linSpaceImpl:uE,logImpl:dE,maxImpl:hE,maximumImpl:pE,minimumImpl:fE,multiplyImpl:$w,negImpl:mE,notEqualImpl:gE,prodImpl:xE,raggedGatherImpl:bE,raggedRangeImpl:yE,raggedTensorToTensorImpl:vE,rangeImpl:wE,rsqrtImpl:NE,scatterImpl:Ol,sigmoidImpl:fY,simpleAbsImpl:GA,sliceImpl:CE,sparseFillEmptyRowsImpl:jE,sparseReshapeImpl:kE,sparseSegmentReductionImpl:Ew,sqrtImpl:xY,squaredDifferenceImpl:TE,staticRegexReplaceImpl:IE,stridedSliceImpl:$E,stringNGramsImpl:AE,stringSplitImpl:EE,stringToHashBucketFastImpl:DE,subImpl:RE,tileImpl:OE,topKImpl:FE,transposeImpl:Aw,uniqueImpl:LE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ik("cpu",()=>new Yx,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ME=Qt(Vh,s=>s>=0?s:Math.exp(s)-1),$Y={kernelName:Vh,backendName:"cpu",kernelFunc:ME};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{alpha:o}=n;lt([a],"leakyRelu");const i=Ae(a.shape),c=t.data.get(a.dataId).values,u=Sn("float32",i);for(let h=0;h<c.length;h++)u[h]=c[h]<0?o*c[h]:c[h];return t.makeTensorInfo(a.shape,"float32",u)}const AY={kernelName:Dg,backendName:"cpu",kernelFunc:PE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EY=Ms((s,e)=>s<0?e*s:s);function zE(s){const{inputs:e,backend:t}=s,{x:n,alpha:a}=e;lt([n,a],"prelu");const o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,[c,u]=EY(n.shape,a.shape,o,i,"float32");return t.makeTensorInfo(u,"float32",c)}const DY={kernelName:Zg,backendName:"cpu",kernelFunc:zE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BE=Qt(ip,s=>Math.max(0,s)),RY={kernelName:ip,backendName:"cpu",kernelFunc:BE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VE=Qt(lp,s=>Math.min(Math.max(0,s),6)),OY={kernelName:lp,backendName:"cpu",kernelFunc:VE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(s,e,t,n,a){if(t==="linear")return no({inputs:{x:e},backend:s});if(t==="relu")return BE({inputs:{x:e},backend:s});if(t==="elu")return ME({inputs:{x:e},backend:s});if(t==="relu6")return VE({inputs:{x:e},backend:s});if(t==="prelu")return zE({inputs:{x:e,alpha:n},backend:s});if(t==="leakyrelu")return PE({inputs:{x:e},backend:s,attrs:{alpha:a}});if(t==="sigmoid")return SE({inputs:{x:e},backend:s});throw new Error("Activation ".concat(t," has not been implemented for the CPU backend."))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{shape:o}=n,i=Ae(a.shape),c=Mj(o,i),u=Ae(c);V(i===u,()=>"The new shape (".concat(c,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(i," elements. The new shape and old ")+"shape must have the same number of elements."),t.incRef(a.dataId);const h=t.data.get(a.dataId);if(h.complexTensorInfos!=null){const p=h.complexTensorInfos.real,f=h.complexTensorInfos.imag;p.shape=c,f.shape=c}return{dataId:a.dataId,shape:c,dtype:a.dtype}}const _Y={kernelName:Jg,backendName:"cpu",kernelFunc:hs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UE(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o}=e,{transposeA:i,transposeB:c}=n;lt([a,o],"matMul");const u=a.shape.length,h=o.shape.length,p=i?a.shape[u-2]:a.shape[u-1],f=c?o.shape[h-1]:o.shape[h-2],g=i?a.shape[u-1]:a.shape[u-2],b=c?o.shape[h-2]:o.shape[h-1],y=a.shape.slice(0,-2),w=o.shape.slice(0,-2),v=Ae(y),N=Ae(w),T=Tt(a.shape.slice(0,-2),o.shape.slice(0,-2)).concat([g,b]);V(p===f,()=>"Error in matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(i)+" and transposeB=".concat(c," must match."));const I=i?[v,p,g]:[v,g,p],$=c?[N,b,f]:[N,f,b],R=hs({inputs:{x:a},backend:t,attrs:{shape:I}}),O=hs({inputs:{x:o},backend:t,attrs:{shape:$}}),P=i?R.shape[1]:R.shape[2],_=i?R.shape[2]:R.shape[1],M=c?O.shape[1]:O.shape[2],A=Math.max(v,N),U=t.data.get(R.dataId).values,K=t.data.get(O.dataId).values,Q=ft(R.shape),X=ft(O.shape),[B,G,Y]=i?[Q[0],1,Q[1]]:[Q[0],Q[1],1],[Z,J,xe]=c?[1,X[1],X[0]]:[X[1],1,X[0]],ye=_*M,ve=Dt([A,_,M],R.dtype),Re=ve.values,Ce=t.blockSize;for(let pe=0;pe<A;pe++){const Te=pe%v,ee=pe%N;for(let he=0;he<_;he+=Ce){const oe=Math.min(he+Ce,_);for(let Ie=0;Ie<M;Ie+=Ce){const Be=Math.min(Ie+Ce,M);for(let We=0;We<P;We+=Ce){const Ke=Math.min(We+Ce,P);for(let be=he;be<oe;be++)for(let ue=Ie;ue<Be;ue++){let Fe=0;for(let He=We;He<Ke;He++){const rt=U[Te*B+be*G+He*Y],Je=K[He*Z+ue*J+ee*xe];Fe+=rt*Je}Re[pe*ye+(be*M+ue)]+=Fe}}}}}return t.disposeIntermediateTensorInfo(R),t.disposeIntermediateTensorInfo(O),t.makeTensorInfo(T,ve.dtype,ve.values)}const FY={kernelName:gg,backendName:"cpu",kernelFunc:UE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LY(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o,bias:i,preluActivationWeights:c}=e,{transposeA:u,transposeB:h,activation:p,leakyreluAlpha:f}=n;let g,b,y;const w=[];g=UE({inputs:{a,b:o},attrs:{transposeA:u,transposeB:h},backend:t}),i&&(b=Cu({inputs:{a:g,b:i},backend:t}),w.push(g),g=b),p&&(y=eg(t,g,p,c,f),w.push(g),g=y);for(const N of w)t.disposeIntermediateTensorInfo(N);return g}const MY={kernelName:Dm,backendName:"cpu",kernelFunc:LY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY=Qt($h,s=>Math.acos(s)),zY={kernelName:$h,backendName:"cpu",kernelFunc:PY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY=Qt(Ah,s=>Math.acosh(s)),VY={kernelName:Ah,backendName:"cpu",kernelFunc:BY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UY(s){const{inputs:e,backend:t}=s,n=e;lt(e,"addN");const a=n.map(c=>t.data.get(c.dataId).values),o=Dt(n[0].shape,n[0].dtype),i=o.values;for(let c=0;c<n.length;c++){const u=a[c];for(let h=0;h<i.length;h++)i[h]+=u[h]}return t.makeTensorInfo(o.shape,o.dtype,o.values)}const GY={kernelName:dg,backendName:"cpu",kernelFunc:UY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;lt(a,"all");const c=Rt(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=ia({inputs:{x:a},backend:t,attrs:{perm:h}}),u=Fs(u.length,a.shape.length)),kn("all",u,p.shape.length);const[f,g]=gn(p.shape,u),b=Ae(g),y=Rn(Ae(f),p.dtype),w=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let T=w[C];for(let I=0;I<b;++I){const $=w[C+I];T=T&&$}y[N]=T}h!=null&&t.disposeIntermediateTensorInfo(p);const v=t.makeTensorInfo(f,p.dtype,y);if(i){const N=_s(f,c),C=hs({inputs:{x:v},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(v),C}return v}const HY={kernelName:zy,backendName:"cpu",kernelFunc:WY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;lt(a,"any");const c=Rt(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=ia({inputs:{x:a},backend:t,attrs:{perm:h}}),u=Fs(u.length,a.shape.length)),kn("any",u,p.shape.length);const[f,g]=gn(p.shape,u),b=Ae(g),y=Rn(Ae(f),p.dtype),w=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let T=w[C];for(let I=0;I<b;++I){const $=w[C+I];T=T||$}y[N]=T}h!=null&&t.disposeIntermediateTensorInfo(p);const v=t.makeTensorInfo(f,p.dtype,y);if(i){const N=_s(f,c),C=hs({inputs:{x:v},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(v),C}return v}const KY={kernelName:By,backendName:"cpu",kernelFunc:qY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;lt(a,"argMax");let i=Rt(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=ia({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=Fs(i.length,u.shape.length)),i=[i[0]],kn("argMax",i,u.shape.length);const[p,f]=gn(u.shape,i),g=Ae(p),b=Rn(g,"int32"),y=Ae(f),w=t.data.get(u.dataId).values;for(let v=0;v<b.length;++v){const N=v*y;let C=w[N],T=0;for(let I=0;I<y;++I){const $=w[N+I];$>C&&(C=$,T=I)}b[v]=T}return h.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(p,"int32",b)}const YY={kernelName:hg,backendName:"cpu",kernelFunc:XY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZY(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;lt(a,"argMin");let i=Rt(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=ia({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=Fs(i.length,u.shape.length)),i=[i[0]],kn("argMin",i,u.shape.length);const[p,f]=gn(u.shape,i),g=Ae(p),b=Rn(g,"int32"),y=Ae(f),w=t.data.get(u.dataId).values;for(let v=0;v<b.length;++v){const N=v*y;let C=w[N],T=0;for(let I=0;I<y;++I){const $=w[N+I];$<C&&(C=$,T=I)}b[v]=T}return h.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(p,"int32",b)}const QY={kernelName:pg,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JY=Qt(Eh,s=>Math.asin(s)),eZ={kernelName:Eh,backendName:"cpu",kernelFunc:JY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tZ=Qt(Dh,s=>Math.asinh(s)),sZ={kernelName:Dh,backendName:"cpu",kernelFunc:tZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ=Qt(Rh,s=>Math.atan(s)),aZ={kernelName:Rh,backendName:"cpu",kernelFunc:nZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rZ=Ms((s,e)=>Math.atan2(s,e)),oZ=nn(_h,rZ),iZ={kernelName:_h,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lZ=Qt(Oh,s=>Math.atanh(s)),cZ={kernelName:Oh,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rw(s,e,t,n,a,o){const i=a.strideHeight,c=a.strideWidth,u=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.top,b=a.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=Dt(a.outShape,t),v=w.values,N=a.outShape[1]*a.outShape[2]*a.outShape[3],C=a.outShape[2]*a.outShape[3],T=a.outShape[3];for(let I=0;I<a.batchSize;++I){const $=I*N,R=I*n[0];for(let O=0;O<a.inChannels;++O)for(let P=0;P<a.outHeight;++P){const _=P*i-g,M=Math.max(0,_),A=Math.min(a.inHeight,p+_),U=$+P*C;for(let K=0;K<a.outWidth;++K){const Q=K*c-b,X=Math.max(0,Q),B=Math.min(a.inWidth,f+Q);let G=y,Y=0,Z=0;for(let xe=M;xe<A;xe+=u){const ye=R+xe*n[1];for(let ve=X;ve<B;ve+=h){const Re=ye+ve*n[2],Ce=s[Re+O];o==="max"&&Ce>G?G=Ce:o==="avg"&&(Y+=Ce,Z++)}if(isNaN(G))break}const J=U+K*T+O;v[J]=o==="avg"?Y/Z:G}}}return w}function GE(s,e,t,n,a=!1,o=!1){const i=Dt(n.outShape,"int32"),c=n.strideHeight,u=n.strideWidth,h=n.dilationHeight,p=n.dilationWidth,f=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.top,y=n.padInfo.left,w=Dt(e,t,s);for(let v=0;v<n.batchSize;++v)for(let N=0;N<n.inChannels;++N)for(let C=0;C<n.outHeight;++C){const T=C*c-b;let I=T;for(;I<0;)I+=h;const $=Math.min(n.inHeight,f+T);for(let R=0;R<n.outWidth;++R){const O=R*u-y;let P=O;for(;P<0;)P+=p;const _=Math.min(n.inWidth,g+O);let M=Number.NEGATIVE_INFINITY,A=-1;for(let U=I;U<$;U+=h){const K=U-T;for(let Q=P;Q<_;Q+=p){const X=Q-O,B=w.get(v,U,Q,N);B>M&&(M=B,a?A=o?((v*n.inHeight+U)*n.inWidth+Q)*n.inChannels+N:(U*n.inWidth+Q)*n.inChannels+N:A=K*g+X)}}i.set(A,v,C,R,N)}}return i}function WE(s,e,t,n,a,o){const i=a.strideDepth,c=a.strideHeight,u=a.strideWidth,h=a.dilationDepth,p=a.dilationHeight,f=a.dilationWidth,g=a.effectiveFilterDepth,b=a.effectiveFilterHeight,y=a.effectiveFilterWidth,w=a.padInfo.front,v=a.padInfo.top,N=a.padInfo.left,C=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=Dt(a.outShape,t),I=T.values,$=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],R=a.outShape[2]*a.outShape[3]*a.outShape[4],O=a.outShape[3]*a.outShape[4],P=a.outShape[4];for(let _=0;_<a.batchSize;++_){const M=_*$,A=_*n[0];for(let U=0;U<a.inChannels;++U)for(let K=0;K<a.outDepth;++K){const Q=K*i-w;let X=Q;for(;X<0;)X+=h;const B=Math.min(a.inDepth,g+Q),G=M+K*R;for(let Y=0;Y<a.outHeight;++Y){const Z=Y*c-v;let J=Z;for(;J<0;)J+=p;const xe=Math.min(a.inHeight,b+Z),ye=G+Y*O;for(let ve=0;ve<a.outWidth;++ve){const Re=ve*u-N;let Ce=Re;for(;Ce<0;)Ce+=f;const pe=Math.min(a.inWidth,y+Re),Te=ye+ve*P;let ee=C,he=0,oe=0;for(let Be=X;Be<B;Be+=h){const We=A+Be*n[1];for(let Ke=J;Ke<xe;Ke+=p){const be=We+Ke*n[2];for(let ue=Ce;ue<pe;ue+=f){const Fe=be+ue*n[3],He=s[Fe+U];if(o==="max"&&He>ee?ee=He:o==="avg"&&(he+=He,oe++),isNaN(ee))break}if(isNaN(ee))break}if(isNaN(ee))break}const Ie=Te+U;I[Ie]=o==="avg"?he/Math.max(oe,1):ee}}}}return T}function uZ(s,e){const t=Dt(e.outShape,"int32"),n=e.strideDepth,a=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,g=e.padInfo.front,b=e.padInfo.top,y=e.padInfo.left;for(let w=0;w<e.batchSize;++w)for(let v=0;v<e.inChannels;++v)for(let N=0;N<e.outDepth;++N){const C=N*n-g;let T=C;for(;T<0;)T+=i;const I=Math.min(e.inDepth,h+C);for(let $=0;$<e.outHeight;++$){const R=$*a-b;let O=R;for(;O<0;)O+=c;const P=Math.min(e.inHeight,p+R);for(let _=0;_<e.outWidth;++_){const M=_*o-y;let A=M;for(;A<0;)A+=u;const U=Math.min(e.inWidth,f+M);let K=Number.NEGATIVE_INFINITY,Q=-1;for(let X=T;X<I;X+=i){const B=X-C;for(let G=O;G<P;G+=c){const Y=G-R;for(let Z=A;Z<U;Z+=u){const J=Z-M,xe=s.get(w,X,G,Z,v);xe>=K&&(K=xe,Q=B*p*f+Y*p+J)}}}t.set(Q,w,N,$,_,v)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;lt(a,"avgPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(jn(i,h),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=pr(a.shape,o,i,h,c,u);let f;if(p.filterWidth===1&&p.filterHeight===1&&zt(p.inShape,p.outShape))f=no({inputs:{x:a},backend:t});else{const g=t.data.get(a.dataId).values,b=ft(a.shape),y=Rw(g,a.shape,a.dtype,b,p,"avg");f=t.makeTensorInfo(p.outShape,a.dtype,y.values)}return f}const hZ={kernelName:fg,backendName:"cpu",kernelFunc:dZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n;lt(a,"avgPool3d");const p=Uo(a.shape,o,i,1,c,u,h),f=t.data.get(a.dataId).values,g=WE(f,a.shape,a.dtype,ft(a.shape),p,"avg");return t.makeTensorInfo(g.shape,"float32",g.values)}const fZ={kernelName:mg,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,{filterSize:i,strides:c,pad:u,dimRoundingMode:h}=n;lt([a,o],"avgPool3DGrad");const p=Uo(o.shape,i,c,1,u,h),f=p.strideDepth,g=p.strideHeight,b=p.strideWidth,y=p.filterDepth,w=p.filterHeight,v=p.filterWidth,N=p.dilationDepth,C=p.dilationHeight,T=p.dilationWidth,I=p.effectiveFilterDepth,$=p.effectiveFilterHeight,R=p.effectiveFilterWidth,O=I-1-p.padInfo.front,P=R-1-p.padInfo.left,_=$-1-p.padInfo.top,M=Dt(o.shape,"float32"),A=1/(y*w*v),U=t.bufferSync(a);for(let K=0;K<p.batchSize;++K)for(let Q=0;Q<p.inChannels;++Q)for(let X=0;X<p.inDepth;++X)for(let B=0;B<p.inHeight;++B)for(let G=0;G<p.inWidth;++G){const Y=X-O,Z=B-_,J=G-P;let xe=0;for(let ye=0;ye<I;ye+=N){const ve=(Y+ye)/f;if(!(ve<0||ve>=p.outDepth||Math.floor(ve)!==ve))for(let Re=0;Re<$;Re+=C){const Ce=(Z+Re)/g;if(!(Ce<0||Ce>=p.outHeight||Math.floor(Ce)!==Ce))for(let pe=0;pe<R;pe+=T){const Te=(J+pe)/b;if(Te<0||Te>=p.outWidth||Math.floor(Te)!==Te)continue;const ee=U.get(K,ve,Ce,Te,Q);xe+=ee}}}M.set(xe*A,K,X,B,G,Q)}return t.makeTensorInfo(M.shape,M.dtype,M.values)}const gZ={kernelName:Uy,backendName:"cpu",kernelFunc:mZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o;lt([a,o],"avgPoolGrad");const{filterSize:c,strides:u,pad:h}=n,p=pr(i.shape,c,u,1,h),f=p.strideHeight,g=p.strideWidth,b=p.filterHeight,y=p.filterWidth,w=p.dilationHeight,v=p.dilationWidth,N=p.effectiveFilterHeight,C=p.effectiveFilterWidth,T=C-1-p.padInfo.left,I=N-1-p.padInfo.top,$=Dt(i.shape,"float32"),R=1/(b*y),O=t.data.get(a.dataId).values,P=Dt(a.shape,"float32",O);for(let _=0;_<p.batchSize;++_)for(let M=0;M<p.inChannels;++M)for(let A=0;A<p.inHeight;++A)for(let U=0;U<p.inWidth;++U){const K=A-I,Q=U-T;let X=0;for(let B=0;B<N;B+=w){const G=(K+B)/f;if(!(G<0||G>=p.outHeight||Math.floor(G)!==G))for(let Y=0;Y<C;Y+=v){const Z=(Q+Y)/g;if(Z<0||Z>=p.outWidth||Math.floor(Z)!==Z)continue;const J=P.get(_,G,Z,M);X+=J}}$.set(X*R,_,A,U,M)}return t.makeTensorInfo($.shape,$.dtype,$.values)}const bZ={kernelName:Vy,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,scale:o,offset:i,mean:c,variance:u}=e;V(c.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(i==null||c.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(o==null||c.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),lt([a,c,u,o,i],"batchNorm");let{varianceEpsilon:h}=n;h==null&&(h=.001);const p=t.data.get(a.dataId).values,f=t.data.get(c.dataId).values,g=t.data.get(u.dataId).values,b=o?t.data.get(o.dataId).values:new Float32Array([1]),y=i?t.data.get(i.dataId).values:new Float32Array([0]),w=new Float32Array(p.length),v=y.length,N=b.length,C=g.length,T=f.length;let I=0,$=0,R=0,O=0;for(let P=0;P<p.length;++P)w[P]=y[I++]+(p[P]-f[$++])*b[R++]/Math.sqrt(g[O++]+h),I>=v&&(I=0),$>=T&&($=0),R>=N&&(R=0),O>=C&&(O=0);return t.makeTensorInfo(a.shape,a.dtype,w)}const vZ={kernelName:$g,backendName:"cpu",kernelFunc:yZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,crops:i}=n;lt([a],"batchToSpaceND");const c=o.reduce((N,C)=>N*C),u=Dp(a.shape,o,c),h=Rp(u.length,o.length),p=Op(a.shape,o,c),f=Vv(i,o.length),g=Uv(p,i,o.length),b=hs({inputs:{x:a},backend:t,attrs:{shape:u}}),y=ia({inputs:{x:b},backend:t,attrs:{perm:h}}),w=hs({inputs:{x:y},backend:t,attrs:{shape:p}}),v=Ql({inputs:{x:w},backend:t,attrs:{begin:f,size:g}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),v}const NZ={kernelName:xg,backendName:"cpu",kernelFunc:wZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i}=n,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,h=Iw(c,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}const CZ={kernelName:Gy,backendName:"cpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jZ(s){const{inputs:e,backend:t}=s,{s0:n,s1:a}=e,o=t.data.get(n.dataId).values,i=t.data.get(a.dataId).values,c=Tt(Array.from(o),Array.from(i));return t.makeTensorInfo([c.length],"int32",Int32Array.from(c))}const kZ={kernelName:Wy,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ=Qt(Mh,(s,e)=>{const t=e;return s>t.clipValueMax?t.clipValueMax:s<t.clipValueMin?t.clipValueMin:s}),IZ={kernelName:Mh,backendName:"cpu",kernelFunc:TZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Z=s=>{const{x:e}=s.inputs,t=s.backend,n=new Float32Array(Ae(e.shape)),a=t.data.get(e.dataId),o=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,c=t.data.get(o.dataId).values,u=t.data.get(i.dataId).values;for(let h=0;h<c.length;h++){const p=c[h],f=u[h];n[h]=Math.hypot(p,f)}return t.makeOutput(n,e.shape,"float32")},AZ={kernelName:yg,backendName:"cpu",kernelFunc:$Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ju(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.data.get(n.dataId).complexTensorInfos.imag,o=t.data.get(a.dataId).values;return t.makeTensorInfo(a.shape,a.dtype,o)}const EZ={kernelName:u2,backendName:"cpu",kernelFunc:ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ku(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n,o=Rt(a,e[0].shape)[0],i=e.map(w=>w.shape);Pv(i,o);let c=Qr(e.map(w=>w.shape),o);if(Ae(c)===0)return t.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter(w=>Ae(w.shape)>0);if(u.length===1)return no({inputs:{x:u[0]},backend:t});if(u[0].dtype==="complex64"){const w=u.map(I=>Zl({inputs:{input:I},backend:t})),v=u.map(I=>ju({inputs:{input:I},backend:t})),N=ku({inputs:w,backend:t,attrs:{axis:o}}),C=ku({inputs:v,backend:t,attrs:{axis:o}}),T=ba({inputs:{real:N,imag:C},backend:t});return w.forEach(I=>t.disposeIntermediateTensorInfo(I)),v.forEach(I=>t.disposeIntermediateTensorInfo(I)),t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(C),T}const h=u.map(w=>{const N=[-1,Ae(w.shape.slice(o))];return hs({inputs:{x:w},backend:t,attrs:{shape:N}})}),p=h.map(w=>({vals:t.data.get(w.dataId).values,shape:w.shape}));c=Qr(h.map(w=>w.shape),1);const f=h[0].shape[0]===1,g=YA(p,c,e[0].dtype,f),b=Qr(u.map(w=>w.shape),o),y=t.makeTensorInfo(b,e[0].dtype,g);return h.forEach(w=>t.disposeIntermediateTensorInfo(w)),y}const DZ={kernelName:vg,backendName:"cpu",kernelFunc:ku};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}=n;lt([a,o],"conv2d");const f=Go(u),g=mn(a.shape,o.shape,i,h,c,p,!1,f),b=g.filterHeight,y=g.filterWidth,w=g.dilationHeight,v=g.dilationWidth,N=g.padInfo.left,C=g.padInfo.top,T=g.dataFormat==="channelsLast",I=new Js(g.outShape,a.dtype),$=ft(a.shape),R=ft(o.shape),O=$[0],P=T?$[1]:$[2],_=T?$[2]:1,M=T?1:$[1],A=I.strides[0],U=T?I.strides[1]:I.strides[2],K=T?I.strides[2]:1,Q=T?1:I.strides[1],X=t.data.get(a.dataId).values,B=t.data.get(o.dataId).values,G=I.values;for(let Y=0;Y<g.batchSize;++Y){const Z=Y*O,J=Y*A;for(let xe=0;xe<g.outHeight;++xe){const ye=J+xe*U,ve=xe*g.strideHeight-C;for(let Re=0;Re<b;++Re){const Ce=ve+Re*w;if(Ce<0||Ce>=g.inHeight)continue;const pe=Re*R[0],Te=Z+Ce*P;for(let ee=0;ee<g.outWidth;++ee){const he=ye+ee*K,oe=ee*g.strideWidth-N;for(let Ie=0;Ie<y;++Ie){const Be=oe+Ie*v;if(Be<0||Be>=g.inWidth)continue;const We=pe+Ie*R[1],Ke=Te+Be*_;let be=We;for(let ue=0;ue<g.inChannels;++ue){const Fe=X[Ke+ue*M];for(let He=0;He<g.outChannels;++He)G[he+He*Q]+=Fe*B[be+He];be+=g.outChannels}}}}}}return t.makeTensorInfo(I.shape,I.dtype,G)}const RZ={kernelName:wg,backendName:"cpu",kernelFunc:HE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,dataFormat:u,dimRoundingMode:h,filterShape:p}=n;lt([a,o],"conv2dBackpropFilter");const f=Go(u),g=mn(a.shape,p,i,1,c,h,!1,f),{strideHeight:b,strideWidth:y,filterHeight:w,filterWidth:v}=g,N=g.dataFormat==="channelsLast",C=new Js(g.filterShape,"float32"),T=g.padInfo.left,I=g.padInfo.top,$=t.data.get(a.dataId).values,R=t.data.get(o.dataId).values,O=new Js(a.shape,a.dtype,$),P=new Js(o.shape,o.dtype,R);for(let _=0;_<w;++_){const M=Math.max(0,Math.ceil((I-_)/b)),A=Math.min(g.outHeight,(g.inHeight+I-_)/b);for(let U=0;U<v;++U){const K=Math.max(0,Math.ceil((T-U)/y)),Q=Math.min(g.outWidth,(g.inWidth+T-U)/y);for(let X=0;X<g.inChannels;++X)for(let B=0;B<g.outChannels;++B){let G=0;for(let Y=0;Y<g.batchSize;++Y)for(let Z=M;Z<A;++Z){const J=_+Z*b-I;for(let xe=K;xe<Q;++xe){const ye=U+xe*y-T;N?G+=O.get(Y,J,ye,X)*P.get(Y,Z,xe,B):G+=O.get(Y,X,J,ye)*P.get(Y,B,Z,xe)}}C.set(G,_,U,X,B)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const _Z={kernelName:qy,backendName:"cpu",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{inputShape:i,strides:c,pad:u,dataFormat:h,dimRoundingMode:p}=n;lt([a,o],"conv2dBackpropInput");const f=ft(o.shape),g=ft(a.shape);let b=Go(h);const y=mn(i,o.shape,c,1,u,p,!1,b),w=new Js(y.inShape,"float32"),v=w.values,N=t.data.get(a.dataId).values,C=t.data.get(o.dataId).values,[T,I,$]=f,{batchSize:R,filterHeight:O,filterWidth:P,inChannels:_,inHeight:M,inWidth:A,outChannels:U,outHeight:K,outWidth:Q,strideHeight:X,strideWidth:B}=y;b=y.dataFormat;const G=O-1-y.padInfo.top,Y=P-1-y.padInfo.left,Z=b==="channelsLast",J=w.strides[0],xe=Z?w.strides[1]:w.strides[2],ye=Z?w.strides[2]:1,ve=Z?1:w.strides[1],Re=g[0],Ce=Z?g[1]:g[2],pe=Z?g[2]:1,Te=Z?1:g[1];for(let ee=0;ee<R;++ee)for(let he=0;he<_;++he)for(let oe=0;oe<M;++oe){const Ie=oe-G,Be=Math.max(0,Math.ceil(Ie/X)),We=Math.min(K,(O+Ie)/X);for(let Ke=0;Ke<A;++Ke){const be=Ke-Y,ue=Math.max(0,Math.ceil(be/B)),Fe=Math.min(Q,(P+be)/B);let He=0;for(let Je=Be;Je<We;++Je){const Wt=Je*X-Ie;for(let At=ue;At<Fe;++At){const wt=At*B-be,Ge=Re*ee+Ce*Je+pe*At,nt=T*(O-1-Wt)+I*(P-1-wt)+$*he;for(let at=0;at<U;++at){const pt=N[Ge+Te*at],jt=C[nt+at];He+=pt*jt}}}const rt=J*ee+xe*oe+ye*Ke+ve*he;v[rt]=He}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const LZ={kernelName:Ng,backendName:"cpu",kernelFunc:FZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n;lt([a,o],"conv3d");const h=Ki(a.shape,o.shape,i,u,c),{filterDepth:p,filterHeight:f,filterWidth:g,dilationDepth:b,dilationHeight:y,dilationWidth:w,padInfo:v}=h,N=v.front,C=v.left,T=v.top,I=new Js(h.outShape,a.dtype),$=t.data.get(a.dataId).values,R=t.data.get(o.dataId).values,O=I.values,P=ft(a.shape),_=ft(o.shape);for(let M=0;M<h.batchSize;++M){const A=M*P[0],U=M*I.strides[0];for(let K=0;K<h.outDepth;++K){const Q=U+K*I.strides[1],X=K*h.strideDepth-N;for(let B=0;B<p;++B){const G=X+B*b;if(G<0||G>=h.inDepth)continue;const Y=B*_[0],Z=A+G*P[1];for(let J=0;J<h.outHeight;++J){const xe=Q+J*I.strides[2],ye=J*h.strideHeight-T;for(let ve=0;ve<f;++ve){const Re=ye+ve*y;if(Re<0||Re>=h.inHeight)continue;const Ce=Y+ve*_[1],pe=Z+Re*P[2];for(let Te=0;Te<h.outWidth;++Te){const ee=xe+Te*h.outChannels,he=Te*h.strideWidth-C;for(let oe=0;oe<g;++oe){const Ie=he+oe*w;if(Ie<0||Ie>=h.inWidth)continue;const Be=Ce+oe*_[2],We=pe+Ie*h.inChannels;let Ke=Be;for(let be=0;be<h.inChannels;++be){const ue=$[We+be];for(let Fe=0;Fe<h.outChannels;++Fe)O[ee+Fe]+=ue*R[Ke+Fe];Ke+=h.outChannels}}}}}}}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const PZ={kernelName:Sg,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,filterShape:u}=n;lt([a,o],"conv3dBackpropFilterV2");const h=ft(a.shape),p=ft(o.shape),f=Ki(a.shape,u,i,1,c),g=f.strideDepth,b=f.strideHeight,y=f.strideWidth,w=f.filterDepth,v=f.filterHeight,N=f.filterWidth,C=new Js(f.filterShape,"float32"),T=C.values,[I,$,R,O]=C.strides,P=t.data.get(o.dataId).values,[_,M,A,U]=p,K=t.data.get(a.dataId).values,[Q,X,B,G]=h,Y=f.padInfo.front,Z=f.padInfo.left,J=f.padInfo.top;for(let xe=0;xe<w;++xe){const ye=Math.max(0,Math.ceil((Y-xe)/g)),ve=Math.min(f.outDepth,(f.inDepth+Y-xe)/g),Re=xe*I;for(let Ce=0;Ce<v;++Ce){const pe=Math.max(0,Math.ceil((J-Ce)/b)),Te=Math.min(f.outHeight,(f.inHeight+J-Ce)/b),ee=Ce*$+Re;for(let he=0;he<N;++he){const oe=Math.max(0,Math.ceil((Z-he)/y)),Ie=Math.min(f.outWidth,(f.inWidth+Z-he)/y),Be=he*R+ee;for(let We=0;We<f.inChannels;++We){const Ke=We*O+Be;for(let be=0;be<f.outChannels;++be){let ue=0;for(let Fe=0;Fe<f.batchSize;++Fe){const He=Fe*Q,rt=Fe*_;for(let Je=ye;Je<ve;++Je){const At=(xe+Je*g-Y)*X+He,wt=Je*M+rt;for(let Ge=pe;Ge<Te;++Ge){const at=(Ce+Ge*b-J)*B+At,pt=Ge*A+wt;for(let jt=oe;jt<Ie;++jt){const an=(he+jt*y-Z)*G+at,$s=jt*U+pt;ue+=K[an+We]*P[$s+be]}}}}T[Ke+be]=ue}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const BZ={kernelName:Ky,backendName:"cpu",kernelFunc:zZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{pad:i,strides:c,inputShape:u}=n;lt([a],"conv3dBackpropInputV2");const h=ft(a.shape),p=ft(o.shape),f=Ki(u,o.shape,c,1,i),g=new Js(f.inShape,"float32"),b=g.values,[y,w,v,N]=g.strides,C=t.data.get(a.dataId).values,[T,I,$,R]=h,O=t.data.get(o.dataId).values,[P,_,M,A]=p,{batchSize:U,filterDepth:K,filterHeight:Q,filterWidth:X,inChannels:B,inDepth:G,inHeight:Y,inWidth:Z,outChannels:J,outDepth:xe,outHeight:ye,outWidth:ve,strideDepth:Re,strideHeight:Ce,strideWidth:pe}=f,Te=K-1-f.padInfo.front,ee=Q-1-f.padInfo.top,he=X-1-f.padInfo.left;for(let oe=0;oe<U;++oe)for(let Ie=0;Ie<B;++Ie)for(let Be=0;Be<G;++Be){const We=Be-Te,Ke=Math.max(0,Math.ceil(We/Re)),be=Math.min(xe,(K+We)/Re);for(let ue=0;ue<Y;++ue){const Fe=ue-ee,He=Math.max(0,Math.ceil(Fe/Ce)),rt=Math.min(ye,(Q+Fe)/Ce);for(let Je=0;Je<Z;++Je){const Wt=Je-he,At=Math.max(0,Math.ceil(Wt/pe)),wt=Math.min(ve,(X+Wt)/pe);let Ge=0;for(let nt=Ke;nt<be;++nt){const at=nt*Re-We;for(let pt=He;pt<rt;++pt){const jt=pt*Ce-Fe;for(let It=At;It<wt;++It){const an=It*pe-Wt,$s=T*oe+I*nt+$*pt+R*It,rn=P*(K-1-at)+_*(Q-1-jt)+M*(X-1-an)+A*Ie;for(let Fn=0;Fn<J;++Fn){const Yn=C[$s+Fn],As=O[rn+Fn];Ge+=Yn*As}}}}b[y*oe+w*Be+v*ue+N*Je+Ie]=Ge}}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const UZ={kernelName:Xy,backendName:"cpu",kernelFunc:VZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ=Qt(Ph,s=>Math.cos(s)),WZ={kernelName:Ph,backendName:"cpu",kernelFunc:GZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HZ=Qt(zh,s=>Math.cosh(s)),qZ={kernelName:zh,backendName:"cpu",kernelFunc:HZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZ(s){const{inputs:e,backend:t,attrs:n}=s,{image:a,boxes:o,boxInd:i}=e,{cropSize:c,method:u,extrapolationValue:h}=n,[p,f,g,b]=a.shape,y=o.shape[0],[w,v]=c,N=Dt([y,w,v,b],"float32"),C=t.data.get(o.dataId).values,T=t.data.get(i.dataId).values,I=t.data.get(a.dataId).values,$=ft(a.shape),R=ft(N.shape);for(let O=0;O<y;O++){const P=O*4,_=C[P],M=C[P+1],A=C[P+2],U=C[P+3],K=T[O];if(K>=p)continue;const Q=w>1?(A-_)*(f-1)/(w-1):0,X=v>1?(U-M)*(g-1)/(v-1):0;for(let B=0;B<w;B++){const G=w>1?_*(f-1)+B*Q:.5*(_+A)*(f-1);if(G<0||G>f-1){for(let Y=0;Y<v;Y++)for(let Z=0;Z<b;Z++){const J=Z+Y*R[2]+B*R[1]+O*R[0];N.values[J]=h}continue}if(u==="bilinear"){const Y=Math.floor(G),Z=Math.ceil(G),J=G-Y;for(let xe=0;xe<v;xe++){const ye=v>1?M*(g-1)+xe*X:.5*(M+U)*(g-1);if(ye<0||ye>g-1){for(let pe=0;pe<b;pe++){const Te=pe+xe*R[2]+B*R[1]+O*R[0];N.values[Te]=h}continue}const ve=Math.floor(ye),Re=Math.ceil(ye),Ce=ye-ve;for(let pe=0;pe<b;pe++){let Te=pe+ve*$[2]+Y*$[1]+K*$[0];const ee=I[Te];Te=pe+Re*$[2]+Y*$[1]+K*$[0];const he=I[Te];Te=pe+ve*$[2]+Z*$[1]+K*$[0];const oe=I[Te];Te=pe+Re*$[2]+Z*$[1]+K*$[0];const Ie=I[Te],Be=ee+(he-ee)*Ce,We=oe+(Ie-oe)*Ce;Te=pe+xe*R[2]+B*R[1]+O*R[0],N.values[Te]=Be+(We-Be)*J}}}else for(let Y=0;Y<v;++Y){const Z=v>1?M*(g-1)+Y*X:.5*(M+U)*(g-1);if(Z<0||Z>g-1){for(let ye=0;ye<b;ye++){const ve=ye+Y*R[2]+B*R[1]+O*R[0];N.values[ve]=h}continue}const J=Math.round(Z),xe=Math.round(G);for(let ye=0;ye<b;ye++){const ve=ye+J*$[2]+xe*$[1]+K*$[0],Re=ye+Y*R[2]+B*R[1]+O*R[0];N.values[Re]=I[ve]}}}}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const XZ={kernelName:Zy,backendName:"cpu",kernelFunc:KZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;lt(a,"cumprod");const u=ws([o],a.shape.length);let h=a;u!=null&&(h=ia({inputs:{x:a},backend:t,attrs:{perm:u}}));const p=Fs(1,a.shape.length)[0];if(p!==h.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(h.shape.length-1," but got axis=").concat(p));const f=wa(h.dtype,"int32"),g=My(Ae(h.shape),f),b=t.data.get(h.dataId).values,y=h.shape[h.shape.length-1],w=c?(N,C)=>N+y-C-1:(N,C)=>N+C;for(let N=0;N<b.length;N+=y)for(let C=0;C<y;C++){const T=w(N,C);if(C===0)g[T]=i?1:b[T];else{const I=w(N,C-1);g[T]=i?b[I]*g[I]:b[T]*g[I]}}const v=t.makeTensorInfo(h.shape,f,g);if(u!=null){const N=Xi(u),C=ia({inputs:{x:v},backend:t,attrs:{perm:N}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(h),C}return v}const ZZ={kernelName:Yy,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QZ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;lt(a,"cumsum");const u=ws([o],a.shape.length);let h=a;u!=null&&(h=ia({inputs:{x:a},backend:t,attrs:{perm:u}}));const p=Fs(1,a.shape.length)[0];if(p!==h.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(h.shape.length-1," but got axis=").concat(p));const f=wa(h.dtype,"int32"),g=Rn(Ae(h.shape),f),b=t.data.get(h.dataId).values,y=h.shape[h.shape.length-1],w=c?(N,C)=>N+y-C-1:(N,C)=>N+C;for(let N=0;N<b.length;N+=y)for(let C=0;C<y;C++){const T=w(N,C);if(C===0)g[T]=i?0:b[T];else{const I=w(N,C-1);g[T]=i?b[I]+g[I]:b[T]+g[I]}}const v=t.makeTensorInfo(h.shape,f,g);if(u!=null){const N=Xi(u),C=ia({inputs:{x:v},backend:t,attrs:{perm:N}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(h),C}return v}const JZ={kernelName:Cg,backendName:"cpu",kernelFunc:QZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i,binaryOutput:c}=n;if(a.shape.length===1){const u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=Iw(u,h,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,p)}else if(a.shape.length===2){const u=t.bufferSync(a),h=t.bufferSync(o),p=qA(u,h,i,c);return t.makeTensorInfo(p.shape,o.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}const tQ={kernelName:Qy,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockSize:o,dataFormat:i}=n;V(i==="NHWC",()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(i));const c=a.shape[0],u=a.shape[1],h=a.shape[2],p=a.shape[3],f=u*o,g=h*o,b=p/(o*o),y=t.data.get(a.dataId).values,w=new Float32Array(c*f*g*b);let v=0;for(let N=0;N<c;++N)for(let C=0;C<f;++C){const T=Math.floor(C/o),I=C%o;for(let $=0;$<g;++$){const R=Math.floor($/o),O=$%o,P=(I*o+O)*b;for(let _=0;_<b;++_){const A=_+P+p*(R+h*(T+u*N));w[v++]=y[A]}}}return t.makeTensorInfo([c,f,g,b],a.dtype,w)}const nQ={kernelName:Jy,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u,dimRoundingMode:h}=n;lt([a,o],"depthwiseConv2DNative");const p=ft(a.shape),f=ft(o.shape);let g=u;g==null&&(g=[1,1]),V(jn(i,g),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(g,"'"));const b=mn(a.shape,o.shape,i,g,c,h,!0),{filterHeight:y,filterWidth:w,dilationHeight:v,dilationWidth:N,padInfo:C}=b,T=C.left,I=C.top,$=b.outChannels/b.inChannels,R=new Js(b.outShape,a.dtype),O=t.data.get(a.dataId).values,P=t.data.get(o.dataId).values,_=R.values;for(let M=0;M<b.batchSize;++M){const A=M*p[0],U=M*R.strides[0];for(let K=0;K<b.outHeight;++K){const Q=U+K*R.strides[1],X=K*b.strideHeight-I;for(let B=0;B<y;++B){const G=X+B*v;if(G<0||G>=b.inHeight)continue;const Y=B*f[0],Z=A+G*p[1];for(let J=0;J<b.outWidth;++J){const xe=Q+J*R.strides[2],ye=J*b.strideWidth-T;for(let ve=0;ve<w;++ve){const Re=ye+ve*N;if(Re<0||Re>=b.inWidth)continue;const Ce=Y+ve*f[1],pe=Z+Re*b.inChannels;let Te=xe,ee=Ce;for(let he=0;he<b.inChannels;++he){const oe=O[pe+he];for(let Ie=0;Ie<$;++Ie)_[Te+Ie]+=oe*P[ee+Ie];Te+=$,ee+=$}}}}}}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const aQ={kernelName:jg,backendName:"cpu",kernelFunc:qE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,filterShape:p}=n;lt([a,o],"depthwiseConv2dNativeBackpropFilter");const f=mn(a.shape,p,i,c,u,h,!0),{strideHeight:g,strideWidth:b,filterHeight:y,filterWidth:w}=f,v=new Js(f.filterShape,"float32"),N=f.padInfo.left,C=f.padInfo.top,T=f.outChannels/f.inChannels,I=t.data.get(a.dataId).values,$=new Js(a.shape,a.dtype,I),R=t.data.get(o.dataId).values,O=new Js(o.shape,o.dtype,R);for(let P=0;P<y;++P){const _=Math.max(0,Math.ceil((C-P)/g)),M=Math.min(f.outHeight,(f.inHeight+C-P)/g);for(let A=0;A<w;++A){const U=Math.max(0,Math.ceil((N-A)/b)),K=Math.min(f.outWidth,(f.inWidth+N-A)/b);for(let Q=0;Q<f.outChannels;++Q){const X=Math.trunc(Q/T),B=Q%T;let G=0;for(let Y=0;Y<f.batchSize;++Y)for(let Z=_;Z<M;++Z){const J=P+Z*g-C;for(let xe=U;xe<K;++xe){const ye=A+xe*b-N;G+=$.get(Y,J,ye,X)*O.get(Y,Z,xe,Q)}}v.set(G,P,A,X,B)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const oQ={kernelName:e2,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iQ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,inputShape:p}=n;lt([a,o],"depthwiseConv2DNativeBackpropInput");const f=ft(a.shape),g=ft(o.shape),b=mn(p,o.shape,i,c,u,h,!0),y=new Js(b.inShape,"float32"),w=y.values,[v,N,C]=y.strides,T=t.data.get(a.dataId).values,[I,$,R]=f,O=t.data.get(o.dataId).values,[P,_,M]=g,{batchSize:A,filterHeight:U,filterWidth:K,inChannels:Q,inHeight:X,inWidth:B,outChannels:G,outHeight:Y,outWidth:Z,strideHeight:J,strideWidth:xe}=b,ye=U-1-b.padInfo.top,ve=K-1-b.padInfo.left,Re=G/Q;for(let Ce=0;Ce<A;++Ce)for(let pe=0;pe<Q;++pe)for(let Te=0;Te<X;++Te){const ee=Te-ye,he=Math.max(0,Math.ceil(ee/J)),oe=Math.min(Y,(U+ee)/J);for(let Ie=0;Ie<B;++Ie){const Be=Ie-ve,We=Math.max(0,Math.ceil(Be/xe)),Ke=Math.min(Z,(K+Be)/xe);let be=0;for(let ue=he;ue<oe;++ue){const Fe=ue*J-ee;for(let He=We;He<Ke;++He){const rt=He*xe-Be,Je=I*Ce+$*ue+R*He,Wt=P*(U-1-Fe)+_*(K-1-rt)+M*pe;for(let At=0;At<Re;++At){const wt=pe*Re+At,Ge=T[Je+wt],nt=O[Wt+At];be+=Ge*nt}}}w[v*Ce+N*Te+C*Ie+pe]=be}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const lQ={kernelName:t2,backendName:"cpu",kernelFunc:iQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(s){const{inputs:e,backend:t}=s,{x:n}=e,a=Ae(n.shape),o=t.data.get(n.dataId).values,i=Dt([a,a],n.dtype),c=i.values;for(let h=0;h<o.length;h++)c[h*a+h]=o[h];const u=[...n.shape,...n.shape];return t.makeTensorInfo(u,i.dtype,i.values)}const uQ={kernelName:s2,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ={kernelName:kg,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a}=s,{strides:o,pad:i,dilations:c}=t,u=e,h=u.data.get(n.dataId).values,p=n.shape.length,f=u.data.get(a.dataId).values,g=a.shape.length,{batchSize:b,inHeight:y,inWidth:w,inChannels:v,outHeight:N,outWidth:C,padInfo:T,strideHeight:I,strideWidth:$,filterHeight:R,filterWidth:O,dilationHeight:P,dilationWidth:_,outShape:M}=jp(n.shape,a.shape,o,i,"NHWC",c),A=Ae(M),U=M.length,K=Os(n.dtype,A);for(let X=0;X<b;++X)for(let B=0;B<N;++B){const G=B*I-T.top;for(let Y=0;Y<C;++Y){const Z=Y*$-T.left;for(let J=0;J<v;++J){let xe=Number.MIN_SAFE_INTEGER;for(let ve=0;ve<R;++ve){const Re=G+ve*P;if(Re>=0&&Re<y)for(let Ce=0;Ce<O;++Ce){const pe=Z+Ce*_;if(pe>=0&&pe<w){const Te=Zr([X,Re,pe,J],p,ft(n.shape)),ee=Zr([ve,Ce,J],g,ft(a.shape)),he=h[Te]+f[ee];he>xe&&(xe=he)}}}const ye=Zr([X,B,Y,J],U,ft(M));K[ye]=xe}}}return{dataId:u.write(ec(K,n.dtype),M,n.dtype),shape:M,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ={kernelName:P1,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a,dy:o}=s,{strides:i,pad:c,dilations:u}=t,h=e,p=lr(n.shape,h.data.get(n.dataId).values),f=lr(a.shape,h.data.get(a.dataId).values),{batchSize:g,inHeight:b,inWidth:y,inChannels:w,outHeight:v,outWidth:N,padInfo:C,strideHeight:T,strideWidth:I,filterHeight:$,filterWidth:R,dilationHeight:O,dilationWidth:P,outShape:_}=jp(n.shape,a.shape,i,c,"NHWC",u);V(o.rank===_.length,()=>"Error in ".concat(P1,", dy ")+"must have the same rank as output ".concat(_.length,", but got ")+"".concat(o.rank));const M=lr(_,h.data.get(o.dataId).values),A=Bj(a.shape,a.dtype);for(let K=0;K<g;++K)for(let Q=0;Q<v;++Q){const X=Q*T-C.top;for(let B=0;B<N;++B){const G=B*I-C.left;for(let Y=0;Y<w;++Y){let Z=Number.MIN_SAFE_INTEGER,J=0,xe=0;for(let ye=0;ye<$;++ye){const ve=X+ye*O;if(ve>=0&&ve<b)for(let Re=0;Re<R;++Re){const Ce=G+Re*P;if(Ce>=0&&Ce<y){const pe=p[K][ve][Ce][Y]+f[ye][Re][Y];pe>Z&&(Z=pe,J=ye,xe=Re)}}}A[J][xe][Y]+=M[K][Q][B][Y]}}}return{dataId:h.write(ec(A,n.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ={kernelName:M1,backendName:"cpu",kernelFunc:({inputs:s,backend:e,attrs:t})=>{const{x:n,filter:a,dy:o}=s,{strides:i,pad:c,dilations:u}=t,h=e,p=lr(n.shape,h.data.get(n.dataId).values),f=lr(a.shape,h.data.get(a.dataId).values),{batchSize:g,inHeight:b,inWidth:y,inChannels:w,outHeight:v,outWidth:N,padInfo:C,strideHeight:T,strideWidth:I,filterHeight:$,filterWidth:R,dilationHeight:O,dilationWidth:P,outShape:_}=jp(n.shape,a.shape,i,c,"NHWC",u);V(o.rank===_.length,()=>"Error in ".concat(M1,", dy ")+"must have the same rank as output ".concat(_.length,", but got ")+"".concat(o.rank));const M=lr(_,h.data.get(o.dataId).values),A=Bj(n.shape,n.dtype);for(let K=0;K<g;++K)for(let Q=0;Q<v;++Q){const X=Q*T-C.top;for(let B=0;B<N;++B){const G=B*I-C.left;for(let Y=0;Y<w;++Y){let Z=Number.MIN_SAFE_INTEGER,J=X<0?0:X,xe=G<0?0:G;for(let ye=0;ye<$;++ye){const ve=X+ye*O;if(ve>=0&&ve<b)for(let Re=0;Re<R;++Re){const Ce=G+Re*P;if(Ce>=0&&Ce<y){const pe=p[K][ve][Ce][Y]+f[ye][Re][Y];pe>Z&&(Z=pe,J=ve,xe=Ce)}}}A[K][J][xe][Y]+=M[K][Q][B][Y]}}}return{dataId:h.write(ec(A,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(s){const{inputs:e,backend:t,attrs:n}=s,{image:a}=e,{canvas:o,options:i}=n,{contextOptions:c,imageOptions:u}=i||{},h=(u==null?void 0:u.alpha)||1,p=(c==null?void 0:c.contextType)||"2d";if(p!=="2d")throw new Error("Context type ".concat(c.contextType," is not supported by the CPU backend."));const f=o.getContext(p,(c==null?void 0:c.contextAttributes)||{});if(f==null)throw new Error("Could not get the context with ".concat(p," type."));const[g,b]=a.shape.slice(0,2),y=a.shape.length===2?1:a.shape[2],w=t.data.get(a.dataId).values,v=a.dtype==="float32"?255:1,N=new Uint8ClampedArray(b*g*4);for(let T=0;T<g*b;++T){const I=[0,0,0,255*h];for(let R=0;R<y;R++){const O=w[T*y+R];if(a.dtype==="float32"){if(O<0||O>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(O,"."))}else if(a.dtype==="int32"&&(O<0||O>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(O,"."));y===1?(I[0]=O*v,I[1]=O*v,I[2]=O*v):I[R]=O*v}const $=T*4;N[$+0]=Math.round(I[0]),N[$+1]=Math.round(I[1]),N[$+2]=Math.round(I[2]),N[$+3]=Math.round(I[3])}o.width=b,o.height=g;const C=new ImageData(N,b,g);return f.putImageData(C,0,0),a}const mQ={kernelName:a7,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;lt(a,"sum");let c;a.dtype==="bool"?c=Ui({inputs:{x:a},backend:t,attrs:{dtype:"int32"}}):c=no({inputs:{x:a},backend:t});const u=c.shape.length,h=Rt(o,c.shape),p=ws(h,u);let f=h,g=c;p!=null&&(g=ia({inputs:{x:c},backend:t,attrs:{perm:p}}),f=Fs(f.length,u)),kn("sum",f,g.shape.length);const[b,y]=gn(g.shape,f),w=wa(g.dtype,"int32");let v=Qm(t,b,w);const N=Ae(y),C=t.data.get(v.dataId).values,T=t.data.get(g.dataId).values;for(let I=0;I<C.length;++I){const $=I*N;let R=0;for(let O=0;O<N;++O)R+=T[$+O];C[I]=R}if(i){const I=_s(v.shape,h),$=v;v=hs({inputs:{x:v},backend:t,attrs:{shape:I}}),t.disposeIntermediateTensorInfo($)}return t.disposeIntermediateTensorInfo(c),p!=null&&t.disposeIntermediateTensorInfo(g),v}const gQ={kernelName:rx,backendName:"cpu",kernelFunc:Up};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(s){const{inputs:e,backend:t,attrs:n}=s,{equation:a}=n,o=e,{allDims:i,summedDims:c,idDims:u}=Zv(a,o.length);Jv(i.length,u,o);const{path:h,steps:p}=ew(c,u),f=p.length;let g=null,b=i.length;const y=[];for(let w=0;w<f;++w){for(const v of p[w]){const{permutationIndices:N,expandDims:C}=Qv(b,u[v]);let T;tw(N)?T=o[v]:(T=ia({inputs:{x:o[v]},backend:t,attrs:{perm:N}}),y.push(T));const I=T.shape.slice();for(let $=0;$<C.length;++$)I.splice(C[$],0,1);zt(T.shape,I)||(T=hs({inputs:{x:T},backend:t,attrs:{shape:I}}),y.push(T)),g===null?g=T:(g=Zx({inputs:{a:T,b:g},backend:t}),y.push(g))}w<f-1&&(h[w]>=0&&(g=Up({inputs:{x:g},backend:t,attrs:{axis:h[w]-(i.length-b),keepDims:!1}}),y.push(g)),b--)}for(const w of y)w!==g&&t.disposeIntermediateTensorInfo(w);return g}const bQ={kernelName:n2,backendName:"cpu",kernelFunc:xQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(s){const{inputs:e,backend:t}=s,{dy:n,y:a}=e;lt([n,a],"eluGrad");const o=new Float32Array(Ae(a.shape)),i=t.data.get(a.dataId).values,c=t.data.get(n.dataId).values;for(let u=0;u<i.length;++u){const h=i[u];h>=0?o[u]=c[u]:o[u]=c[u]*(h+1)}return t.makeTensorInfo(a.shape,"float32",o)}const vQ={kernelName:a2,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wQ=Gv,NQ=Wv,SQ=Hv,CQ=qv,jQ=Kv,kQ=Xv,TQ=Qt(Uh,s=>{const e=Math.sign(s),t=Math.abs(s),n=1/(1+wQ*t);return e*(1-((((kQ*n+jQ)*n+CQ)*n+SQ)*n+NQ)*n*Math.exp(-t*t))}),IQ={kernelName:Uh,backendName:"cpu",kernelFunc:TQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tg(s){const{inputs:e,backend:t,attrs:n}=s,{input:a}=e,{dim:o}=n,i=a.shape.length,c=a.shape.slice();let u=o;return o<0&&(V(-(i+1)<=o,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),u=i+o+1),c.splice(u,0,1),hs({inputs:{x:a},backend:t,attrs:{shape:c}})}const $Q={kernelName:Ig,backendName:"cpu",kernelFunc:tg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AQ=Ms((s,e)=>s/e),Ow=nn(Bh,AQ),ky={kernelName:Bh,backendName:"cpu",kernelFunc:Ow};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KE(s,e,t){const n=s.shape,a=n[0],o=n[1],i=t.data.get(s.dataId),c=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,h=[a,o],p=Ae(h),f=Sn("float32",p),g=Sn("float32",p);for(let v=0;v<a;v++){const N=Ql({inputs:{x:c},backend:t,attrs:{begin:[v,0],size:[1,o]}}),C=Ql({inputs:{x:u},backend:t,attrs:{begin:[v,0],size:[1,o]}}),T=ba({inputs:{real:N,imag:C},backend:t}),{real:I,imag:$}=EQ(T,e,t),R=Lo(I,$);for(let O=0;O<o;O++){const P=Yv(R,O);f[v*o+O]=P.real,g[v*o+O]=P.imag}t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo(T)}const b=t.makeTensorInfo(h,"float32",f),y=t.makeTensorInfo(h,"float32",g),w=ba({inputs:{real:b,imag:y},backend:t});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),w}function EQ(s,e,t){const n=Ae(s.shape),a=t.data.get(s.dataId),o=t.data.get(a.complexTensorInfos.real.dataId).values,i=t.data.get(a.complexTensorInfos.imag.dataId).values;if(DQ(n)){const c=Ty(o,i,n,e,t),u=[s.shape[0],s.shape[1]];if(e){const h=t.makeTensorInfo(u,"float32",c.real),p=t.makeTensorInfo(u,"float32",c.imag),f=t.makeTensorInfo([],"float32",Wi(n,"float32")),g=no({inputs:{x:f},backend:t}),b=ky.kernelFunc({inputs:{a:h,b:f},backend:t}),y=ky.kernelFunc({inputs:{a:p,b:g},backend:t}),w=t.data.get(b.dataId).values,v=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),{real:w,imag:v}}return c}else{const c=Lo(o,i),u=RQ(c,n,e);return tI(u)}}function DQ(s){return(s&s-1)===0}function Ty(s,e,t,n,a){if(t===1)return{real:s,imag:e};const o=Lo(s,e),i=t/2,c=sI(o),u=c.real,h=c.imag,p=[u.length],f=a.makeTensorInfo(p,"float32",u),g=a.makeTensorInfo(p,"float32",h),b=ba({inputs:{real:f,imag:g},backend:a}),y=nI(o),w=y.real,v=y.imag,N=[w.length],C=a.makeTensorInfo(N,"float32",w),T=a.makeTensorInfo(N,"float32",v),I=ba({inputs:{real:C,imag:T},backend:a}),$=Ty(u,h,i,n,a),R=$.real,O=$.imag,P=[R.length],_=a.makeTensorInfo(P,"float32",R),M=a.makeTensorInfo(P,"float32",O),A=ba({inputs:{real:_,imag:M},backend:a}),U=Ty(w,v,i,n,a),K=U.real,Q=U.imag,X=[K.length],B=a.makeTensorInfo(X,"float32",K),G=a.makeTensorInfo(X,"float32",Q),Y=ba({inputs:{real:B,imag:G},backend:a}),Z=rI(t,n),J=[Z.real.length],xe=a.makeTensorInfo(J,"float32",Z.real),ye=a.makeTensorInfo(J,"float32",Z.imag),ve=ba({inputs:{real:xe,imag:ye},backend:a}),Re=Zx({inputs:{a:ve,b:Y},backend:a}),Ce=Cu({inputs:{a:A,b:Re},backend:a}),pe=Dw({inputs:{a:A,b:Re},backend:a}),Te=Zl({inputs:{input:Ce},backend:a}),ee=Zl({inputs:{input:pe},backend:a}),he=ju({inputs:{input:Ce},backend:a}),oe=ju({inputs:{input:pe},backend:a}),Ie=ku({inputs:[Te,ee],backend:a,attrs:{axis:0}}),Be=ku({inputs:[he,oe],backend:a,attrs:{axis:0}}),We=a.data.get(Ie.dataId).values,Ke=a.data.get(Be.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(g),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(xe),a.disposeIntermediateTensorInfo(ye),a.disposeIntermediateTensorInfo(ve),a.disposeIntermediateTensorInfo(Re),a.disposeIntermediateTensorInfo(Ce),a.disposeIntermediateTensorInfo(pe),a.disposeIntermediateTensorInfo(Te),a.disposeIntermediateTensorInfo(he),a.disposeIntermediateTensorInfo(ee),a.disposeIntermediateTensorInfo(oe),a.disposeIntermediateTensorInfo(Ie),a.disposeIntermediateTensorInfo(Be),{real:We,imag:Ke}}function RQ(s,e,t){const n=new Float32Array(e*2);for(let a=0;a<e;a++){let o=0,i=0;for(let c=0;c<e;c++){const u=oI(a*c,e,t),h=Yv(s,c);o+=h.real*u.real-h.imag*u.imag,i+=h.real*u.imag+h.imag*u.real}t&&(o/=e,i/=e),aI(n,o,i,a)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(s){const{inputs:e,backend:t}=s,{input:n}=e,a=Ae(n.shape),o=n.shape[n.shape.length-1],i=a/o,c=hs({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),u=KE(c,!1,t),h=hs({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),h}const _Q={kernelName:r2,backendName:"cpu",kernelFunc:OQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _w(s){const{backend:e,attrs:t}=s,{shape:n,value:a,dtype:o}=t,i=o||Eu(a),c=Os(i,Ae(n));return LQ(c,a,i),e.makeTensorInfo(n,i,c)}const FQ={kernelName:o2,backendName:"cpu",kernelFunc:_w};function LQ(s,e,t){s.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MQ={kernelName:i2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,a=t,o=Sn(n.dtype,Ae(n.shape)),[i,c,u,h]=n.shape,p=a.data.get(n.dataId).values;for(let g=0;g<i;g++){const b=g*u*c*h;for(let y=0;y<c;y++){const w=y*(u*h);for(let v=0;v<u;v++){const N=v*h;for(let C=0;C<h;C++){const T=Math.round(u-v-1),I=b+w+N+C;let $=p[I];if(T>=0&&T<u){const R=T*h,O=b+w+R+C;$=p[O]}o[I]=$}}}}return{dataId:a.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n;let w=HE({inputs:{x:a,filter:o},backend:t,attrs:{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g}});if(i){const v=w;if(p==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const N=hs({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});w=Cu({inputs:{a:w,b:N},backend:t}),t.disposeIntermediateTensorInfo(N)}else w=Cu({inputs:{a:w,b:i},backend:t});t.disposeIntermediateTensorInfo(v)}if(b){const v=w;if(p==="NCHW"&&b==="prelu"&&c.shape.length===1&&c.shape[0]!==1){const N=hs({inputs:{x:c},backend:t,attrs:{shape:[c.shape[0],1,1]}});w=eg(t,w,b,N,y),t.disposeIntermediateTensorInfo(N)}else w=eg(t,w,b,c,y);t.disposeIntermediateTensorInfo(v)}return w}const zQ={kernelName:Rm,backendName:"cpu",kernelFunc:PQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n;let w=qE({inputs:{x:a,filter:o},backend:t,attrs:{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g}});if(i){const v=w;w=Cu({inputs:{a:w,b:i},backend:t}),t.disposeIntermediateTensorInfo(v)}if(b){const v=w;w=eg(t,w,b,c,y),t.disposeIntermediateTensorInfo(v)}return w}const VQ={kernelName:Om,backendName:"cpu",kernelFunc:BQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(s){const{inputs:e,backend:t}=s,{params:n,indices:a}=e,o=Ae(n.shape),i=a.shape,c=i[i.length-1],[u,h,p,f]=Rv(n,a);if(h===0)return t.makeTensorInfo(u,n.dtype,[]);const g=t.data.get(a.dataId).values,b=t.bufferSync(n),y=aE(g,b,n.dtype,h,c,p,f,n.shape,o);return t.makeTensorInfo(u,n.dtype,y.values)}const GQ={kernelName:l2,backendName:"cpu",kernelFunc:UQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,indices:o}=e,{axis:i,batchDims:c}=n;lt([a,o],"gatherV2");const u=Rt(i,a.shape)[0],h=t.data.get(o.dataId).values,p=a.shape[u];for(let I=0;I<h.length;++I){const $=h[I];V($<=p-1&&$>=0,()=>"GatherV2: the index value ".concat($," is not in [0, ").concat(p-1,"]"))}let f=c;c==null&&(f=0);const g=Ae(o.shape),b=nw(a,o,u,f),y=hs({inputs:{x:a},backend:t,attrs:{shape:[b.batchSize,b.outerSize,b.dimSize,b.sliceSize]}}),w=hs({inputs:{x:o},backend:t,attrs:{shape:[b.batchSize,g/b.batchSize]}}),v=[b.batchSize,b.outerSize,g/b.batchSize,b.sliceSize],N=t.bufferSync(w),C=t.bufferSync(y),T=rE(C,N,v);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),t.makeTensorInfo(b.outputShape,T.dtype,T.values)}const HQ={kernelName:Ag,backendName:"cpu",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQ(s){const{inputs:e,backend:t}=s,{input:n}=e,a=Ae(n.shape),o=n.shape[n.shape.length-1],i=a/o,c=hs({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),u=KE(c,!0,t),h=hs({inputs:{x:u},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(u),h}const KQ={kernelName:c2,backendName:"cpu",kernelFunc:qQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ=Qt(Yh,s=>Number.isFinite(s)?1:0,"bool"),YQ={kernelName:Yh,backendName:"cpu",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ=Qt(Zh,s=>Math.abs(s)===1/0?1:0,"bool"),QQ={kernelName:Zh,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ=Qt(Qh,s=>Number.isNaN(s)?1:0,"bool"),eJ={kernelName:Qh,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tJ(s){const{backend:e,attrs:t}=s,{start:n,stop:a,num:o}=t,i=uE(n,a,o);return e.makeTensorInfo([i.length],"float32",i)}const sJ={kernelName:d2,backendName:"cpu",kernelFunc:tJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ=Qt(ep,s=>Math.log1p(s)),aJ={kernelName:ep,backendName:"cpu",kernelFunc:nJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ=Ms((s,e)=>s&&e),oJ=nn(_g,rJ,null,"bool"),iJ={kernelName:_g,backendName:"cpu",kernelFunc:oJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJ=Qt(Fg,s=>s?0:1,"bool"),cJ={kernelName:Fg,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ=Ms((s,e)=>s||e),dJ=nn(Lg,uJ,null,"bool"),hJ={kernelName:Lg,backendName:"cpu",kernelFunc:dJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{depthRadius:o,bias:i,alpha:c,beta:u}=n;lt(a,"LRN");const h=a.shape[3],p=h-1,f=t.data.get(a.dataId).values,g=Ae(a.shape),b=new Float32Array(g);function y(w){const v=w%h;let N=w-v+Math.max(0,v-o);const C=w-v+Math.min(v+o,p);let T=0;for(;N<=C;N++){const I=f[N];T+=I*I}return T}for(let w=0;w<g;w++){const v=y(w),N=f[w]*Math.pow(i+c*v,-u);b[w]=N}return t.makeTensorInfo(a.shape,a.dtype,b)}const fJ={kernelName:Mg,backendName:"cpu",kernelFunc:pJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,y:o,dy:i}=e,{depthRadius:c,bias:u,alpha:h,beta:p}=n;lt(i,"LRNGrad");const f=Ae(i.shape),g=i.shape[3],b=t.data.get(i.dataId).values,y=t.data.get(a.dataId).values,w=t.data.get(o.dataId).values,v=new Float32Array(f),N=f;for(let C=0;C<N;C++){const T=C%g,I=C-T+Math.max(0,T-c),$=C-T+Math.min(g,T+c+1);let R=0;for(let O=I;O<$;O++)R+=Math.pow(y[O],2);R=h*R+u;for(let O=I;O<$;O++){let P=-2*h*p*y[O]*w[C]/R;C===O&&(P+=Math.pow(R,-p)),P*=b[C],v[O]+=P}}return t.makeTensorInfo(i.shape,a.dtype,v)}const gJ={kernelName:h2,backendName:"cpu",kernelFunc:mJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XE(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reductionIndices:o,keepDims:i}=n,c=t;let u=a.shape;const h=u.length,p=Rt(o,u);let f=p;const g=ws(f,h);let b=c.data.get(a.dataId).values;if(g!=null){const I=new Array(h);for(let $=0;$<I.length;$++)I[$]=u[g[$]];b=Aw(b,u,a.dtype,g,I),f=Fs(f.length,h),u=I}lt(a,"max"),kn("max",f,h);const[y,w]=gn(u,f),v=Ae(w),N=hE(b,v,y,a.dtype),C=c.write(N,y,a.dtype);let T=y;return i&&(T=_s(y,p)),{dataId:C,shape:T,dtype:a.dtype}}const xJ={kernelName:Pg,backendName:"cpu",kernelFunc:XE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;lt(a,"maxPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(jn(i,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=pr(a.shape,o,i,h,c,u);let f;if(p.filterWidth===1&&p.filterHeight===1&&zt(p.inShape,p.outShape))f=no({inputs:{x:a},backend:t});else{const g=t.data.get(a.dataId).values,b=ft(a.shape),y=Rw(g,a.shape,a.dtype,b,p,"max");f=t.makeTensorInfo(p.outShape,a.dtype,y.values)}return f}const yJ={kernelName:zg,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n;lt(a,"maxPool3d");const p=Uo(a.shape,o,i,1,c,u,h),f=t.data.get(a.dataId).values,g=WE(f,a.shape,a.dtype,ft(a.shape),p,"max");return t.makeTensorInfo(g.shape,"float32",g.values)}const wJ={kernelName:Bg,backendName:"cpu",kernelFunc:vJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NJ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,{filterSize:i,strides:c,pad:u,dimRoundingMode:h}=n;lt([a,o],"maxPool3DGrad");const p=Uo(o.shape,i,c,1,u,h),f=t.bufferSync(o),g=uZ(f,p),b=p.strideDepth,y=p.strideHeight,w=p.strideWidth,v=p.dilationDepth,N=p.dilationHeight,C=p.dilationWidth,T=p.effectiveFilterDepth,I=p.effectiveFilterHeight,$=p.effectiveFilterWidth,R=T-1-p.padInfo.front,O=$-1-p.padInfo.left,P=I-1-p.padInfo.top,_=Dt(o.shape,"float32"),M=t.bufferSync(a);for(let A=0;A<p.batchSize;++A)for(let U=0;U<p.inChannels;++U)for(let K=0;K<p.inDepth;++K)for(let Q=0;Q<p.inHeight;++Q)for(let X=0;X<p.inWidth;++X){const B=K-R,G=Q-P,Y=X-O;let Z=0;for(let J=0;J<T;J+=v){const xe=(B+J)/b;if(!(xe<0||xe>=p.outDepth||Math.floor(xe)!==xe))for(let ye=0;ye<I;ye+=N){const ve=(G+ye)/y;if(!(ve<0||ve>=p.outHeight||Math.floor(ve)!==ve))for(let Re=0;Re<$;Re+=C){const Ce=(Y+Re)/w;if(Ce<0||Ce>=p.outWidth||Math.floor(Ce)!==Ce)continue;const pe=T*I*$-1-g.get(A,xe,ve,Ce,U),Te=J*I*$+ye*$+Re,ee=pe===Te?1:0;if(ee===0)continue;const he=M.get(A,xe,ve,Ce,U);Z+=he*ee}}}_.set(Z,A,K,Q,X,U)}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const SJ={kernelName:f2,backendName:"cpu",kernelFunc:NJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o,output:i}=e,c=o;lt([o,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:p,dimRoundingMode:f}=n,g=pr(c.shape,u,h,1,p,f),b=t.data.get(c.dataId).values,y=Dt(g.outShape,c.dtype,GE(b,c.shape,c.dtype,g).values),w=g.strideHeight,v=g.strideWidth,N=g.dilationHeight,C=g.dilationWidth,T=g.effectiveFilterHeight,I=g.effectiveFilterWidth,$=I-1-g.padInfo.left,R=T-1-g.padInfo.top,O=Dt(c.shape,"float32"),P=t.data.get(a.dataId).values,_=Dt(a.shape,"float32",P);for(let M=0;M<g.batchSize;++M)for(let A=0;A<g.inChannels;++A)for(let U=0;U<g.inHeight;++U)for(let K=0;K<g.inWidth;++K){const Q=U-R,X=K-$;let B=0;for(let G=0;G<T;G+=N){const Y=(Q+G)/w;if(!(Y<0||Y>=g.outHeight||Math.floor(Y)!==Y))for(let Z=0;Z<I;Z+=C){const J=(X+Z)/v;if(J<0||J>=g.outWidth||Math.floor(J)!==J)continue;const xe=T*I-1-y.get(M,Y,J,A),ye=G*I+Z,ve=xe===ye?1:0;if(ve===0)continue;const Re=_.get(M,Y,J,A);B+=Re*ve}}O.set(B,M,U,K,A)}return t.makeTensorInfo(O.shape,O.dtype,O.values)}const jJ={kernelName:p2,backendName:"cpu",kernelFunc:CJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(s,e,t,n,a){const o=ft(e),i=Rw(s,e,t,o,a,"max"),c=GE(s,e,t,a,!0,n);return[i.values,c.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ={kernelName:m2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{filterSize:a,strides:o,pad:i,includeBatchInIndex:c}=e,u=t;lt(n,"MaxPoolWithArgmax");const h=u.data.get(n.dataId).values,p=pr(n.shape,a,o,[1,1],i),[f,g]=kJ(h,n.shape,n.dtype,c,p),b=u.write(f,p.outShape,n.dtype),y=u.write(g,p.outShape,n.dtype);return[{dataId:b,shape:p.outShape,dtype:n.dtype},{dataId:y,shape:p.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=Rt(o,a.shape),h=gn(a.shape,c)[1],p=Ae(h),f=[],g=t.makeTensorInfo([],"float32",new Float32Array([p]));f.push(g);const b=Ui({inputs:{x:a},backend:t,attrs:{dtype:"float32"}});f.push(b);const y=Ow({inputs:{a:b,b:g},backend:t});f.push(y);const w=Up({inputs:{x:y},backend:t,attrs:{axis:o,keepDims:i}});return f.forEach(v=>t.disposeIntermediateTensorInfo(v)),w}const $J={kernelName:Vg,backendName:"cpu",kernelFunc:IJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;lt(a,"min");const c=Rt(o,a.shape);let u=c;const h=ws(u,a.shape.length);let p=a;h!=null&&(p=ia({inputs:{x:a},backend:t,attrs:{perm:h}}),u=Fs(u.length,a.shape.length)),kn("min",u,p.shape.length);const[f,g]=gn(p.shape,u),b=Ae(g),y=Rn(Ae(f),p.dtype),w=t.data.get(p.dataId).values;for(let N=0;N<y.length;++N){const C=N*b;let T=w[C];for(let I=0;I<b;++I){const $=w[C+I];(Number.isNaN($)||$<T)&&(T=$)}y[N]=T}h!=null&&t.disposeIntermediateTensorInfo(p);const v=t.makeTensorInfo(f,p.dtype,y);if(i){const N=_s(f,c),C=hs({inputs:{x:v},backend:t,attrs:{shape:N}});return t.disposeIntermediateTensorInfo(v),C}return v}const EJ={kernelName:Ug,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,mode:i}=n;lt(a,"mirrorPad");const c=o.map((T,I)=>T[0]+a.shape[I]+T[1]),u=o.map(T=>T[0]),h=o.map((T,I)=>T[0]+a.shape[I]),p=i==="reflect"?0:1,f=t.data.get(a.dataId).values,g=a.shape.length,b=ft(a.shape),y=Ae(c),w=c.length,v=ft(c),N=Sn(a.dtype,y);for(let T=0;T<y;T++){let I=Du(T,w,v);for(let R=0;R<w;R++)I[R]<u[R]?I[R]=u[R]*2-I[R]-p:I[R]>=h[R]&&(I[R]=(h[R]-1)*2-I[R]+p);I=I.map((R,O)=>R-u[O]);const $=Zr(I,g,b);N[T]=f[$]}return{dataId:t.write(N,c,a.dtype),shape:c,dtype:a.dtype}}const RJ={kernelName:Gg,backendName:"cpu",kernelFunc:DJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJ=Ms((s,e)=>{const t=s%e;return s<0&&e<0||s>=0&&e>=0?t:(t+e)%e}),_J=nn(np,OJ),FJ={kernelName:np,backendName:"cpu",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YE(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{dim:o}=n,i=a.shape.length;let c=o;if(c===-1&&(c=i-1),c!==i-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(i," and dim was ").concat(c));const u=Rt([c],a.shape),h=XE({inputs:{x:a},backend:t,attrs:{reductionIndices:u,keepDims:!1}}),p=_s(h.shape,u),f=hs({inputs:{x:h},backend:t,attrs:{shape:p}}),g=Dw({inputs:{a,b:f},backend:t}),b=eE({inputs:{x:g},backend:t}),y=Up({inputs:{x:b},backend:t,attrs:{axis:u,keepDims:!1}}),w=hs({inputs:{x:y},backend:t,attrs:{shape:p}}),v=Ow({inputs:{a:b,b:w},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),v}const LJ={kernelName:lx,backendName:"cpu",kernelFunc:YE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{numSamples:o,seed:i,normalized:c}=n;lt(a,"multinomial");const u=c?a:YE({inputs:{logits:a},backend:t,attrs:{dim:-1}}),h=u.shape[0],p=u.shape[1],f=t.data.get(u.dataId).values,g=[h,o],b=Rn(Ae(g),"int32");for(let y=0;y<h;++y){const w=y*p,v=new Float32Array(p-1);v[0]=f[w];for(let T=1;T<v.length;++T)v[T]=v[T-1]+f[w+T];const N=kx.alea(i.toString()),C=y*o;for(let T=0;T<o;++T){const I=N();b[C+T]=v.length;for(let $=0;$<v.length;$++)if(I<v[$]){b[C+T]=$;break}}}return c||t.disposeIntermediateTensorInfo(u),t.makeTensorInfo(g,"int32",b)}const PJ={kernelName:g2,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ=kv;function BJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u}=n;lt(a,"NonMaxSuppression");const h=t.data.get(a.dataId).values,p=t.data.get(o.dataId).values,{selectedIndices:f}=zJ(h,p,i,c,u);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const VJ={kernelName:x2,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ=Tv;function GJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,padToMaxOutputSize:h}=n;lt(a,"NonMaxSuppressionPadded");const p=t.data.get(a.dataId).values,f=t.data.get(o.dataId).values,{selectedIndices:g,validOutputs:b}=UJ(p,f,i,c,u,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([],"int32",new Int32Array([b]))]}const WJ={kernelName:b2,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ=Iv;function qJ(s){const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,softNmsSigma:h}=n;lt(a,"NonMaxSuppressionWithScore");const p=t.data.get(a.dataId).values,f=t.data.get(o.dataId).values,g=i,b=c,y=u,w=h,{selectedIndices:v,selectedScores:N}=HJ(p,f,g,b,y,w);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const KJ={kernelName:y2,backendName:"cpu",kernelFunc:qJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a}=e,{dtype:o,depth:i,onValue:c,offValue:u}=n;lt(a,"oneHot");const h=Ae(a.shape),p=new Float32Array(h*i);p.fill(u);const f=t.data.get(a.dataId).values;for(let g=0;g<h;++g)f[g]>=0&&f[g]<i&&(p[g*i+f[g]]=c);return t.makeTensorInfo([...a.shape,i],o,p)}const YJ={kernelName:Kg,backendName:"cpu",kernelFunc:XJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){const a=Zl({inputs:{input:n},backend:t}),o=sg({inputs:{x:a},backend:t}),i=ju({inputs:{input:n},backend:t}),c=sg({inputs:{x:i},backend:t}),u=ba({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return _w({backend:t,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}const ZJ={kernelName:hx,backendName:"cpu",kernelFunc:sg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZE(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){const a=Zl({inputs:{input:n},backend:t}),o=ZE({inputs:{x:a},backend:t}),i=ju({inputs:{input:n},backend:t}),c=sg({inputs:{x:i},backend:t}),u=ba({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return _w({backend:t,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}const QJ={kernelName:qg,backendName:"cpu",kernelFunc:ZE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QE(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n;if(e.length===1)return tg({inputs:{input:e[0]},backend:t,attrs:{dim:a}});const o=e[0].shape,i=e[0].dtype;e.forEach(p=>{ja(o,p.shape,"All tensors passed to stack must have matching shapes"),V(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});const c=[],u=e.map(p=>{const f=tg({inputs:{input:p},backend:t,attrs:{dim:a}});return c.push(f),f}),h=ku({inputs:u,backend:t,attrs:{axis:a}});return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const JJ={kernelName:Xg,backendName:"cpu",kernelFunc:QE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,constantValue:i}=n;lt(a,"pad");const c=o.map((C,T)=>C[0]+a.shape[T]+C[1]),u=o.map(C=>C[0]),h=t.data.get(a.dataId).values,p=Ae(a.shape),f=a.shape.length,g=ft(a.shape),b=Ae(c),y=c.length,w=ft(c),v=Sn(a.dtype,b);i!==0&&v.fill(i);for(let C=0;C<p;C++){const I=Du(C,f,g).map((R,O)=>R+u[O]),$=Zr(I,y,w);v[$]=h[C]}return{dataId:t.write(v,c,a.dtype),shape:c,dtype:a.dtype}}const JE={kernelName:Yg,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tee=Ms((s,e)=>Math.pow(s,e)),see=nn(rp,tee),nee={kernelName:rp,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(s){const{inputs:e,backend:t,attrs:n}=s,{paramsNestedSplits:a,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:c}=n,u=a.map(N=>t.data.get(N.dataId).values),h=a.map(N=>N.shape),p=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,[g,b,y]=bE(u,h,p,o.shape,o.dtype,f,i.shape),w=g.map(N=>t.makeTensorInfo([N.length],"int32",N)),v=t.makeTensorInfo(y,o.dtype,b);return w.concat([v])}const ree={kernelName:v2,backendName:"cpu",kernelFunc:aee};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(s){const{inputs:e,backend:t}=s,{starts:n,limits:a,deltas:o}=e,i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=yE(i,n.shape,n.dtype,c,a.shape,u,o.shape),f=t.makeTensorInfo([h.length],"int32",h),g=t.makeTensorInfo([p.length],n.dtype,p);return[f,g]}const iee={kernelName:w2,backendName:"cpu",kernelFunc:oee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(s){const{inputs:e,backend:t,attrs:n}=s,{shape:a,values:o,defaultValue:i,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=n,h=t.data.get(a.dataId).values,p=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,g=c.map(v=>t.data.get(v.dataId).values),b=c.map(v=>v.shape),[y,w]=vE(h,a.shape,p,o.shape,o.dtype,f,i.shape,g,b,u);return t.makeTensorInfo(y,o.dtype,w)}const cee={kernelName:N2,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(s){const{backend:e,attrs:t}=s,{start:n,stop:a,dtype:o,step:i}=t,c=wE(n,a,i,o);return e.makeTensorInfo([c.length],o,c)}const dee={kernelName:S2,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hee=Qt(op,s=>1/s),pee={kernelName:op,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n;lt(a,"resizeBilinear");const u=ft(a.shape),[h,p]=c,[f,g,b,y]=a.shape,w=t.data.get(a.dataId).values,v=new Float32Array(Ae([f,h,p,y])),N=[o&&h>1?g-1:g,o&&p>1?b-1:b],C=[o&&h>1?h-1:h,o&&p>1?p-1:p];let T=0;const I=N[0]/C[0],$=N[1]/C[1];for(let R=0;R<f;R++)for(let O=0;O<h;O++){let P;i?P=I*(O+.5)-.5:P=I*O;const _=Math.max(0,Math.floor(P)),M=P-_,A=Math.min(g-1,Math.ceil(P)),U=R*u[0]+_*u[1],K=R*u[0]+A*u[1];for(let Q=0;Q<p;Q++){let X;i?X=$*(Q+.5)-.5:X=$*Q;const B=Math.max(0,Math.floor(X)),G=X-B,Y=Math.min(b-1,Math.ceil(X)),Z=U+B*u[2],J=K+B*u[2],xe=U+Y*u[2],ye=K+Y*u[2];for(let ve=0;ve<y;ve++){const Re=w[Z+ve],Ce=w[J+ve],pe=w[xe+ve],Te=w[ye+ve],ee=Re+(pe-Re)*G,he=Ce+(Te-Ce)*G,oe=ee+(he-ee)*M;v[T++]=oe}}}return t.makeTensorInfo([f,h,p,y],"float32",v)}const mee={kernelName:tx,backendName:"cpu",kernelFunc:fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n;lt([o,a],"resizeBilinearGrad");const c=ft(a.shape),[u,h,p,f]=a.shape,[,g,b]=o.shape,y=new Float32Array(u*h*p*f),w=[i&&g>1?h-1:h,i&&b>1?p-1:p],v=[i&&g>1?g-1:g,i&&b>1?b-1:b],N=w[0]/v[0],C=w[1]/v[1],T=t.data.get(o.dataId).values;let I=0;for(let $=0;$<u;$++){const R=$*c[0];for(let O=0;O<g;O++){const P=O*N,_=Math.floor(P),M=Math.min(Math.ceil(P),h-1),A=R+_*c[1],U=R+M*c[1],K=P-_,Q=1-K;for(let X=0;X<b;X++){const B=X*C,G=Math.floor(B),Y=Math.min(Math.ceil(B),p-1),Z=B-G,J=1-Z,xe=A+G*c[2],ye=A+Y*c[2],ve=U+G*c[2],Re=U+Y*c[2],Ce=Q*J,pe=Q*Z,Te=K*J,ee=K*Z;for(let he=0;he<f;he++){const oe=T[I++];y[xe+he]+=oe*Ce,y[ye+he]+=oe*pe,y[ve+he]+=oe*Te,y[Re+he]+=oe*ee}}}}return t.makeTensorInfo([u,p,h,f],"float32",y)}const xee={kernelName:k2,backendName:"cpu",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n;lt(a,"resizeNearestNeighbor");const u=ft(a.shape),[h,p]=c,[f,g,b,y]=a.shape,w=t.data.get(a.dataId).values,v=new Float32Array(f*h*p*y),N=[o&&h>1?g-1:g,o&&p>1?b-1:b],C=[o&&h>1?h-1:h,o&&p>1?p-1:p],T=N[0]/C[0],I=N[1]/C[1];let $=0;for(let R=0;R<f;R++){const O=R*u[0];for(let P=0;P<h;P++){const _=i?T*(P+.5):T*P;let M=Math.min(g-1,o?Math.round(_):Math.floor(_));i&&(M=Math.max(0,M));const A=O+M*u[1];for(let U=0;U<p;U++){const K=i?I*(U+.5):I*U;let Q=Math.min(b-1,o?Math.round(K):Math.floor(K));i&&(Q=Math.max(0,Q));const X=A+Q*u[2];for(let B=0;B<y;B++){const G=w[X+B];v[$++]=G}}}}return t.makeTensorInfo([f,h,p,y],a.dtype,v)}const yee={kernelName:ex,backendName:"cpu",kernelFunc:bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n;lt([o,a],"resizeNearestNeighborGrad");const c=ft(a.shape),u=ft(o.shape),[h,p,f,g]=a.shape,[,b,y]=o.shape,w=new Float32Array(h*p*f*g),v=t.data.get(o.dataId).values,N=[i&&b>1?p-1:p,i&&y>1?f-1:f],C=[i&&b>1?b-1:b,i&&y>1?y-1:y],T=N[0]/C[0],I=N[1]/C[1],$=1/T,R=1/I,O=Math.ceil($)*2+2,P=Math.ceil(R)*2+2;for(let _=0;_<h;_++){const M=_*c[0];for(let A=0;A<p;A++){const U=M+A*c[1],K=Math.floor(A*$),Q=Math.floor(K-O/2);for(let X=0;X<f;X++){const B=U+X*c[2],G=Math.floor(X*R),Y=Math.floor(G-P/2);for(let Z=0;Z<g;Z++){let J=0;for(let xe=0;xe<O;xe++){const ye=xe+Q;if(ye<0||ye>=b)continue;const ve=M+ye*u[1],Re=ye*T,Ce=Math.min(p-1,i?Math.round(Re):Math.floor(Re));if(A===Ce)for(let pe=0;pe<P;pe++){const Te=pe+Y;if(Te<0||Te>=y)continue;const ee=ve+Te*u[2],he=Te*I,oe=Math.min(f-1,i?Math.round(he):Math.floor(he));X===oe&&(J+=v[ee+Z])}}w[B+Z]=J}}}}return t.makeTensorInfo(a.shape,a.dtype,w)}const wee={kernelName:j2,backendName:"cpu",kernelFunc:vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dims:o}=n;lt(a,"reverse");const i=a.shape.length,c=Rt(o,a.shape);if(i===0)return no({inputs:{x:a},backend:t});const u=new Js(a.shape,a.dtype),h=t.bufferSync(a);for(let p=0;p<u.size;p++){const f=u.indexToLoc(p),g=f.slice();c.forEach(b=>g[b]=a.shape[b]-1-g[b]),u.set(h.get(...g),...f)}return t.makeTensorInfo(u.shape,u.dtype,u.values)}const See={kernelName:sx,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cee={kernelName:U2,backendName:"cpu",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,{radians:a,fillValue:o,center:i}=e,c=t,u=Sn(n.dtype,Ae(n.shape)),[h,p,f,g]=n.shape,[b,y]=Bv(i,p,f),w=255,v=Math.sin(a),N=Math.cos(a),C=c.data.get(n.dataId).values;for(let I=0;I<h;I++){const $=I*f*p*g;for(let R=0;R<p;R++){const O=R*(f*g);for(let P=0;P<f;P++){const _=P*g;for(let M=0;M<g;M++){const A=[h,R,P,M],U=A[2],K=A[1];let Q=(U-b)*N-(K-y)*v,X=(U-b)*v+(K-y)*N;Q=Math.round(Q+b),X=Math.round(X+y);let B=o;if(typeof o!="number"&&(M===3?B=w:B=o[M]),Q>=0&&Q<f&&X>=0&&X<p){const Y=X*(f*g),Z=Q*g,J=$+Y+Z+M;B=C[J]}const G=$+O+_+M;u[G]=B}}}}return{dataId:c.write(u,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee=Qt(cp,s=>{const e=Math.floor(s);return s-e<.5?Math.floor(s):s-e>.5?Math.ceil(s):e%2===0?e:e+1}),kee={kernelName:cp,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a,updates:o}=e,{shape:i}=n,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(o,a,i),g=!0,b=t.bufferSync(a),y=t.bufferSync(o),w=Ol(b,y,i,f,h,u,c,p,0,g);return t.makeTensorInfo(i,w.dtype,w.values)}const Iee={kernelName:T2,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(s,e){let t=0,n=s.length,a=0;for(;t<n;)a=Math.floor((t+n)/2),s[a]<e?t=a+1:n=a;return n}function Aee(s,e){let t=0,n=s.length,a=0;for(;t<n;)a=Math.floor((t+n)/2),s[a]<=e?t=a+1:n=a;return n}function Eee(s,e,t,n,a,o){const i=Os("int32",t*a);for(let c=0;c<t;++c){const u=s.slice(c*n,(c+1)*n),h=c*a;for(let p=0;p<a;++p)i[h+p]=o==="left"?$ee(u,e[p+h]):Aee(u,e[p+h])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(s){const{inputs:e,backend:t,attrs:n}=s,{sortedSequence:a,values:o}=e,{side:i}=n,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,h=Eee(c,u,a.shape[0],a.shape[1],o.shape[1],i);return t.makeTensorInfo(o.shape,"int32",h)}const Ree={kernelName:$2,backendName:"cpu",kernelFunc:Dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(s){const{inputs:e,backend:t}=s,{condition:n,t:a,e:o}=e;lt([n,a,o],"select");const i=n.shape.length,c=t.data.get(n.dataId).values,u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=wa(a.dtype,o.dtype),f=Rn(Ae(a.shape),p);let g=0;const b=i===0||i>1||a.shape.length===1?1:Ae(a.shape.slice(1));for(let y=0;y<c.length;y++)for(let w=0;w<b;w++)c[y]===1?f[g++]=u[y]:f[g++]=h[y];return t.makeTensorInfo(a.shape,p,f)}const _ee={kernelName:nx,backendName:"cpu",kernelFunc:Oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fee=Mx,Lee=Px,Mee=Qt(dp,s=>s>=0?Lee*s:Fee*(Math.exp(s)-1)),Pee={kernelName:dp,backendName:"cpu",kernelFunc:Mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zee=Qt(fp,s=>s<0?-1:s>0?1:0),Bee={kernelName:fp,backendName:"cpu",kernelFunc:zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vee=Qt(hp,s=>Math.sin(s)),Uee={kernelName:hp,backendName:"cpu",kernelFunc:Vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gee=Qt(pp,s=>Math.sinh(s)),Wee={kernelName:pp,backendName:"cpu",kernelFunc:Gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hee=11920928955078125e-23,HC=Math.log(Hee)+2,qee=Qt(gp,s=>{const e=s>-HC,t=s<HC,n=Math.exp(s);let a;return t?a=n:e?a=s:a=Math.log(1+n),a}),Kee={kernelName:gp,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,paddings:i}=n;lt([a],"spaceToBatchND");const c=Ae(o),u=[[0,0]];u.push(...i);for(let R=1+o.length;R<a.shape.length;++R)u.push([0,0]);const h=JE.kernelFunc({inputs:{x:a},backend:t,attrs:{paddings:u,constantValue:0}}),p=Dp(h.shape,o,c,!1),f=Rp(p.length,o.length,!1),g=Op(h.shape,o,c,!1),w=hs({inputs:{x:h},backend:t,attrs:{shape:p}}),C=ia({inputs:{x:w},backend:t,attrs:{perm:f}}),$=hs({inputs:{x:C},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),$}const Yee={kernelName:ox,backendName:"cpu",kernelFunc:Xee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(s){const{inputs:e,backend:t}=s,{indices:n,values:a,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n        ".concat(o.shape));if(n.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n        ".concat(n.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(i.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const c=t.data.get(n.dataId).values,u=t.data.get(a.dataId).values,h=t.data.get(o.dataId).values,p=t.data.get(i.dataId).values[0],[f,g,b,y,w]=jE(c,n.shape,n.dtype,u,a.dtype,h,p);return[t.makeTensorInfo(g,n.dtype,f),t.makeTensorInfo([g[0]],a.dtype,b),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([w.length],n.dtype,new Int32Array(w))]}const Qee={kernelName:A2,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(s){const{inputs:e,backend:t}=s,{inputIndices:n,inputShape:a,newShape:o}=e;if(n.shape.length!==2)throw new Error("Input indices should be a matrix but received shape\n        ".concat(n.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(o.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const i=Array.from(t.data.get(a.dataId).values),c=t.data.get(n.dataId).values,u=Array.from(t.data.get(o.dataId).values),[h,p,f]=kE(c,n.shape,n.dtype,i,u);return[t.makeTensorInfo(p,n.dtype,h),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const ete={kernelName:E2,backendName:"cpu",kernelFunc:Jee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n          ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=Ew(i,n.shape,n.dtype,c,u,!0);return t.makeTensorInfo(p,n.dtype,h)}const ste={kernelName:D2,backendName:"cpu",kernelFunc:tte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n         ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(a.dataId).values,u=t.data.get(o.dataId).values,[h,p]=Ew(i,n.shape,n.dtype,c,u);return t.makeTensorInfo(p,n.dtype,h)}const ate={kernelName:R2,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(s){const{inputs:e,backend:t,attrs:n}=s,{sparseIndices:a,sparseValues:o,defaultValue:i}=e,{outputShape:c}=n,{sliceRank:u,numUpdates:h,sliceSize:p,strides:f,outputSize:g}=nc(o,a,c),b=!1,y=t.bufferSync(a);let w;switch(o.dtype){case"bool":{const v=t.bufferSync(o),N=!!t.data.get(i.dataId).values[0];w=Ol(y,v,c,g,p,h,u,f,N,b);break}case"float32":{const v=t.bufferSync(o),N=t.data.get(i.dataId).values[0];w=Ol(y,v,c,g,p,h,u,f,N,b);break}case"int32":{const v=t.bufferSync(o),N=t.data.get(i.dataId).values[0];w=Ol(y,v,c,g,p,h,u,f,N,b);break}case"string":{const v=t.bufferSync(o),N=Ri(t.data.get(i.dataId).values[0]);w=Ol(y,v,c,g,p,h,u,f,N,b);break}default:throw new Error("Unsupported type ".concat(o.dtype))}return t.makeTensorInfo(c,w.dtype,w.values)}const ote={kernelName:O2,backendName:"cpu",kernelFunc:rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{numOrSizeSplits:o,axis:i}=n,c=Rt(i,a.shape)[0],u=sw(a,o,c),h=new Array(a.shape.length).fill(0),p=a.shape.slice();return u.map(f=>{const g=[...p];g[c]=f;const b=Ql({inputs:{x:a},backend:t,attrs:{begin:h,size:g}});return h[c]+=f,b})}const lte={kernelName:ix,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cte={kernelName:_2,backendName:"cpu",kernelFunc:({inputs:s,backend:e})=>{const{x:t}=s,n=e;lt(t,"square");const a=n.data.get(t.dataId).values,o=new Float32Array(a.length);for(let c=0;c<a.length;++c){const u=a[c];o[c]=u*u}return{dataId:n.write(o,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ute=Qt(Sp,(s,e)=>{const t=e;return isNaN(s)?NaN:s>0?1:t.alpha}),dte={kernelName:Sp,backendName:"cpu",kernelFunc:ute};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,end:i,strides:c,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:g}=n;lt(a,"stridedSlice");const{finalShapeSparse:b,finalShape:y,isIdentity:w,sliceDim0:v,isSimpleSlice:N,begin:C,end:T,strides:I}=Mv(a.shape,o,i,c,u,h,p,f,g);let $;if(w)$=hs({inputs:{x:a},backend:t,attrs:{shape:y}});else if(v||N){V(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const R=_v(C,T,I),O=Ql({inputs:{x:a},backend:t,attrs:{begin:C,size:R}});$=hs({inputs:{x:O},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(O)}else{const R=t.bufferSync(a),O=$E(b,R,I,C);$=t.makeTensorInfo(y,O.dtype,O.values)}return $}const pte={kernelName:F2,backendName:"cpu",kernelFunc:hte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(s){const{inputs:e,backend:t,attrs:n}=s,{separator:a,nGramWidths:o,leftPad:i,rightPad:c,padWidth:u,preserveShortSequences:h}=n,{data:p,dataSplits:f}=e,g=t.data.get(p.dataId).values,b=t.data.get(f.dataId).values,[y,w]=AE(g,b,a,o,i,c,u,h);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",w)]}const mte={kernelName:L2,backendName:"cpu",kernelFunc:fte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(s){const{inputs:e,backend:t,attrs:n}=s,{skipEmpty:a}=n,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(i.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const c=t.data.get(o.dataId).values,u=t.data.get(i.dataId).values[0],[h,p,f]=EE(c,u,a),g=p.length;return[t.makeTensorInfo([g,2],"int32",h),t.makeTensorInfo([g],"string",p),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const xte={kernelName:M2,backendName:"cpu",kernelFunc:gte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(s){const{inputs:e,backend:t,attrs:n}=s,{numBuckets:a}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(o.dataId).values,c=DE(i,a);return t.makeTensorInfo(o.shape,"int32",c)}const yte={kernelName:P2,backendName:"cpu",kernelFunc:bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vte=Qt(vp,s=>Math.tan(s)),wte={kernelName:vp,backendName:"cpu",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nte=Qt(wp,s=>Math.tanh(s)),Ste={kernelName:wp,backendName:"cpu",kernelFunc:Nte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(s){const{inputs:e,backend:t}=s,{tensor:n,indices:a,updates:o}=e,{sliceRank:i,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=nc(o,a,n.shape),f=!1,g=t.bufferSync(a),b=t.bufferSync(o),y=t.bufferSync(n),w=Ol(g,b,n.shape,p,u,c,i,h,y,f);return t.makeTensorInfo(n.shape,w.dtype,w.values)}const jte={kernelName:I2,backendName:"cpu",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reps:o}=n;lt(a,"tile");const i=OE(t.bufferSync(a),o);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Tte={kernelName:Np,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{k:o,sorted:i}=n;lt(a,"topk");const c=t.data.get(a.dataId).values,[u,h]=FE(c,a.shape,a.dtype,o,i);return[t.makeTensorInfo(u.shape,u.dtype,u.values),t.makeTensorInfo(h.shape,h.dtype,h.values)]}const $te={kernelName:z2,backendName:"cpu",kernelFunc:Ite};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(s){const{inputs:e,attrs:t,backend:n}=s,{image:a,transforms:o}=e,{interpolation:i,fillMode:c,fillValue:u,outputShape:h}=t,[p,f,g,b]=a.shape,[y,w]=h!=null?h:[f,g],v=[p,y,w,b],N=ft(a.shape),C=N[0],T=N[1],I=N[2],$=ft(v),R=$[0],O=$[1],P=$[2],_=Sn(a.dtype,Ae(v));_.fill(u);const M=n.data.get(a.dataId).values,A=n.data.get(o.dataId).values;for(let K=0;K<p;++K){const Q=o.shape[0]===1?A:A.subarray(K*8,K*8+8);for(let X=0;X<y;++X)for(let B=0;B<w;++B)for(let G=0;G<b;++G){let Y;const Z=Q[6]*B+Q[7]*X+1;if(Z===0)continue;const J=(Q[0]*B+Q[1]*X+Q[2])/Z,xe=(Q[3]*B+Q[4]*X+Q[5])/Z,ye=qC(J,g,c),ve=qC(xe,f,c);switch(i){case"nearest":Y=Fte(M,f,g,C,T,I,K,ve,ye,G,u);break;case"bilinear":Y=Lte(M,f,g,C,T,I,K,ve,ye,G,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(i))}const Re=K*R+X*O+B*P+G;_[Re]=Y}return n.makeTensorInfo(v,a.dtype,_)}return{dataId:n.write(_,v,a.dtype),shape:a.shape,dtype:a.dtype}}const Ete={kernelName:B2,backendName:"cpu",kernelFunc:Ate};function qC(s,e,t){switch(t){case"reflect":return Dte(s,e);case"wrap":return Rte(s,e);case"nearest":return _te(s,e);case"constant":default:return Ote(s)}}function Dte(s,e){let t=s;if(t<0)if(e<=1)t=0;else{const n=2*e;t<n&&(t=n*Math.trunc(-t/n)+t),t=t<-e?t+n:-t-1}else if(t>e-1)if(e<=1)t=0;else{const n=2*e;t-=n*Math.trunc(t/n),t>=e&&(t=n-t-1)}return Pl(0,t,e-1)}function Rte(s,e){let t=s;if(t<0)if(e<=1)t=0;else{const n=e-1;t+=e*(Math.trunc(-t/n)+1)}else if(t>e-1)if(e<=1)t=0;else{const n=e-1;t-=e*Math.trunc(t/n)}return Pl(0,t,e-1)}function Ote(s,e){return s}function _te(s,e){return Pl(0,s,e-1)}function ch(s,e,t,n,a,o,i,c,u,h,p){const f=i*n+c*a+u*o+h;return 0<=c&&c<e&&0<=u&&u<t?s[f]:p}function Fte(s,e,t,n,a,o,i,c,u,h,p){const f=Math.round(c),g=Math.round(u);return ch(s,e,t,n,a,o,i,f,g,h,p)}function Lte(s,e,t,n,a,o,i,c,u,h,p){const f=Math.floor(c),g=Math.floor(u),b=f+1,y=g+1,w=(y-u)*ch(s,e,t,n,a,o,i,f,g,h,p)+(u-g)*ch(s,e,t,n,a,o,i,f,y,h,p),v=(y-u)*ch(s,e,t,n,a,o,i,b,g,h,p)+(u-g)*ch(s,e,t,n,a,o,i,b,y,h,p);return(b-c)*w+(c-f)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(s){const{inputs:e,attrs:t,backend:n}=s,{axis:a}=t,{x:o}=e;lt(o,"unique");const i=n.data.get(o.dataId).values,{outputValues:c,outputShape:u,indices:h}=LE(i,a,o.shape,o.dtype);return[n.makeTensorInfo(u,o.dtype,c),n.makeTensorInfo([h.length],"int32",h)]}const Pte={kernelName:V2,backendName:"cpu",kernelFunc:Mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(s){const{inputs:e,backend:t,attrs:n}=s,{value:a}=e;let{axis:o}=n;o<0&&(o+=a.shape.length);const i=a.shape.length,c=a.shape[o],u=new Array(i-1);let h=0;for(let b=0;b<i;b++)b!==o&&(u[h++]=a.shape[b]);const p=new Array(i).fill(0),f=a.shape.slice();f[o]=1;const g=new Array(c);for(let b=0;b<g.length;b++){p[o]=b;const y=Ql({inputs:{x:a},backend:t,attrs:{begin:p,size:f}});g[b]=hs({inputs:{x:y},backend:t,attrs:{shape:u}}),t.disposeIntermediateTensorInfo(y)}return g}const Bte={kernelName:ux,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,segmentIds:o}=e,{numSegments:i}=n;lt(a,"unsortedSegmentSum");const c=a.shape.length,u=o.shape.length,h=[],p=[],f=c-u;let g=o;for(let y=0;y<f;++y){const w=tg({inputs:{input:g},backend:t,attrs:{dim:y+1}});g=w,p.push(w)}for(let y=0;y<i;++y){const w=Wi(y,"int32"),v=t.makeTensorInfo([],"int32",w),N=QA({inputs:{a:v,b:g},backend:t}),C=Ui({inputs:{x:N},backend:t,attrs:{dtype:"float32"}}),T=Zx({inputs:{a:C,b:a},backend:t}),I=Up({inputs:{x:T},backend:t,attrs:{axis:0,keepDims:!1}});h.push(I),p.push(v),p.push(N),p.push(C),p.push(T),p.push(I)}const b=QE({inputs:h,backend:t,attrs:{axis:0}});return p.forEach(y=>t.disposeIntermediateTensorInfo(y)),b}const Ute={kernelName:dx,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gte=[MY,bX,zY,VY,CX,GY,HY,KY,YY,QY,eZ,sZ,aZ,iZ,cZ,hZ,fZ,gZ,bZ,FY,vZ,NZ,CZ,kX,kZ,NX,IX,IZ,yX,AZ,DZ,RZ,_Z,LZ,PZ,BZ,UZ,WZ,qZ,XZ,ZZ,JZ,tQ,nQ,aQ,oQ,lQ,uQ,dQ,hQ,pQ,mQ,bQ,$Y,vQ,$X,IQ,AX,$Q,DX,_Q,FQ,MQ,OX,FX,zQ,VQ,GQ,HQ,MX,zX,vX,KQ,EZ,YQ,QQ,eJ,AY,VX,GX,sJ,HX,aJ,iJ,cJ,hJ,fJ,gJ,xJ,KX,yJ,wJ,SJ,jJ,TJ,$J,EJ,YX,RJ,FJ,PJ,QX,eY,VJ,WJ,KJ,sY,YJ,QJ,JJ,JE,nee,DY,rY,ree,iee,cee,dee,wX,ky,pee,RY,OY,_Y,mee,xee,yee,wee,See,Cee,kee,pY,Iee,Ree,_ee,Pee,mY,Bee,Uee,Wee,gY,LJ,Kee,Yee,Qee,ete,ste,ate,ote,lte,yY,cte,wY,SY,dte,pte,mte,xte,yte,TY,gQ,wte,Ste,jte,Tte,$te,Ete,nY,Pte,Bte,Ute,ZJ];for(const s of Gte)Gj(s);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dl={},hm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Wte(s,e){Dl[s]=e}function Er(s,e){if(!(s in Dl)||e!=null){const n=qte(s,e);if(n!==null)Dl[s]=n;else return console.log("Could not get context for WebGL version",s),null}const t=Dl[s];return t==null||t.isContextLost()?(delete Dl[s],Er(s)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Dl[s])}function Hte(s){if(!Se().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&s===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function qte(s,e){if(s!==1&&s!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e==null?Hte(s):e;return t.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete Dl[s]},!1),Se().getBool("SOFTWARE_WEBGL_ENABLED")&&(hm.failIfMajorPerformanceCaveat=!1),s===1?t.getContext("webgl",hm)||t.getContext("experimental-webgl",hm):t.getContext("webgl2",hm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sh;(function(s){s[s.DENSE=0]="DENSE",s[s.SHARED_BATCH=1]="SHARED_BATCH"})(Sh||(Sh={}));var Fa;(function(s){s[s.RENDER=0]="RENDER",s[s.UPLOAD=1]="UPLOAD",s[s.PIXELS=2]="PIXELS",s[s.DOWNLOAD=3]="DOWNLOAD"})(Fa||(Fa={}));var Nn;(function(s){s[s.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",s[s.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",s[s.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",s[s.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",s[s.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Nn||(Nn={}));function Gp(s,e){return[e,s]}function Kte(s,e){return s*e}function pm(s){const e=Ae(s),t=Math.ceil(e/4);return O1(t)}function zu(s,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(s/2))]}function Xte(s,e){const[t,n]=zu(s,e);return t*n*4}function Fw(s,e){const t=s;let n,a,o,i,c,u,h,p,f,g;return Se().getNumber("WEBGL_VERSION")===2?(n=t.R32F,a=t.R16F,o=t.RGBA16F,i=t.RGBA32F,c=t.RED,h=4,p=1,f=t.HALF_FLOAT,g=t.FLOAT,u=t.RGBA8):(n=s.RGBA,a=s.RGBA,o=s.RGBA,i=t.RGBA,c=s.RGBA,h=4,p=4,f=e!=null?e.HALF_FLOAT_OES:null,g=s.FLOAT,u=s.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:c,downloadTextureFormat:u,downloadUnpackNumChannels:h,defaultNumChannels:p,textureTypeHalfFloat:f,textureTypeFloat:g}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(s,e){const t=e();return Se().getBool("DEBUG")&&Yte(s),t}function Yte(s){const e=s.getError();if(e!==s.NO_ERROR)throw new Error("WebGL Error: "+ese(s,e))}const Zte=596e-10,Qte=65504;function Jte(s){return!!(Se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||s===0||Zte<Math.abs(s)&&Math.abs(s)<Qte)}function ese(s,e){switch(e){case s.NO_ERROR:return"NO_ERROR";case s.INVALID_ENUM:return"INVALID_ENUM";case s.INVALID_VALUE:return"INVALID_VALUE";case s.INVALID_OPERATION:return"INVALID_OPERATION";case s.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case s.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case s.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}function fm(s,e){return qo(s,()=>s.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function tse(s,e){const t=qo(s,()=>s.createShader(s.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ze(s,()=>s.shaderSource(t,e)),Ze(s,()=>s.compileShader(t)),s.getShaderParameter(t,s.COMPILE_STATUS)===!1)throw console.log(s.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function sse(s,e){const t=qo(s,()=>s.createShader(s.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ze(s,()=>s.shaderSource(t,e)),Ze(s,()=>s.compileShader(t)),Se().get("ENGINE_COMPILE_ONLY"))return t;if(s.getShaderParameter(t,s.COMPILE_STATUS)===!1)throw eD(e,s.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const nse=/ERROR: [0-9]+:([0-9]+):/g;function eD(s,e){const t=nse.exec(e);if(t==null){console.log("Couldn't parse line number in error: ".concat(e)),console.log(s);return}const n=+t[1],a=s.split("\n"),o=a.length.toString().length+2,i=a.map((f,g)=>uu((g+1).toString(),o)+f);let c=0;for(let f=0;f<i.length;f++)c=Math.max(i[f].length,c);const u=i.slice(0,n-1),h=i.slice(n-1,n),p=i.slice(n);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(uu(h[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join("\n"))}function ase(s){return qo(s,()=>s.createProgram(),"Unable to create WebGLProgram.")}function rse(s,e){if(Ze(s,()=>s.linkProgram(e)),!Se().get("ENGINE_COMPILE_ONLY")&&s.getProgramParameter(e,s.LINK_STATUS)===!1)throw console.log(s.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function T1(s,e){if(Ze(s,()=>s.validateProgram(e)),s.getProgramParameter(e,s.VALIDATE_STATUS)===!1)throw console.log(s.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ose(s,e){const t=qo(s,()=>s.createBuffer(),"Unable to create WebGLBuffer");return Ze(s,()=>s.bindBuffer(s.ARRAY_BUFFER,t)),Ze(s,()=>s.bufferData(s.ARRAY_BUFFER,e,s.STATIC_DRAW)),t}function ise(s,e){const t=qo(s,()=>s.createBuffer(),"Unable to create WebGLBuffer");return Ze(s,()=>s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t)),Ze(s,()=>s.bufferData(s.ELEMENT_ARRAY_BUFFER,e,s.STATIC_DRAW)),t}function lse(s){return qo(s,()=>s.createTexture(),"Unable to create WebGLTexture.")}function cse(s,e){const t=Se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(s<=0||e<=0){const n="[".concat(s,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(s>t||e>t){const n="[".concat(s,"x").concat(e,"]"),a="[".concat(t,"x").concat(t,"]");throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+a+".")}}function use(s){return qo(s,()=>s.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function KC(s,e,t,n,a,o,i){const c=s.getAttribLocation(e,t);return c===-1?!1:(Ze(s,()=>s.bindBuffer(s.ARRAY_BUFFER,n)),Ze(s,()=>s.vertexAttribPointer(c,a,s.FLOAT,!1,o,i)),Ze(s,()=>s.enableVertexAttribArray(c)),!0)}function dse(s,e,t){gse(s,t),Ze(s,()=>s.activeTexture(s.TEXTURE0+t)),Ze(s,()=>s.bindTexture(s.TEXTURE_2D,e))}function hse(s,e,t){return qo(s,()=>s.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function pse(s,e,t){return s.getUniformLocation(e,t)}function fse(s,e,t,n){Ze(s,()=>dse(s,e,n)),Ze(s,()=>s.uniform1i(t,n))}function I1(s,e,t){Ze(s,()=>s.bindFramebuffer(s.FRAMEBUFFER,t)),Ze(s,()=>s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0))}function XC(s,e){Ze(s,()=>s.bindFramebuffer(s.FRAMEBUFFER,e)),Ze(s,()=>s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,null,0))}function mm(s){const e=s.checkFramebufferStatus(s.FRAMEBUFFER);if(e!==s.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+mse(s,e))}function mse(s,e){switch(e){case s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case s.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}function qo(s,e,t){const n=Ze(s,()=>e());if(n==null)throw new Error(t);return n}function gse(s,e){const t=s.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+s.TEXTURE0;if(n<s.TEXTURE0||n>t){const a="[gl.TEXTURE0, gl.TEXTURE".concat(t,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function Tu(s,e=2){return Ae(s.slice(0,s.length-e))}function Iu(s){if(s.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[s.length>1?s[s.length-2]:1,s[s.length-1]]}function gm(s){let e=[1,1,1];return s.length===0||s.length===1&&s[0]===1||(e=[Tu(s),...Iu(s)]),e}function xse(s,e=!1){let t=Se().getNumber("WEBGL_MAX_TEXTURE_SIZE"),n=Se().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");n===1/0&&Se().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(n=t/2),e&&(t=t*2,n=n*2,s=s.map((c,u)=>u>=s.length-2?Ly(s[u]):s[u]),s.length===1&&(s=[2,s[0]])),s.length!==2&&(s=Gi(s).newShape);let a=Ae(s),o=null;s.length<=1&&a<=t?o=[1,a]:s.length===2&&s[0]<=t&&s[1]<=t?o=s:s.length===3&&s[0]*s[1]<=t&&s[2]<=t?o=[s[0]*s[1],s[2]]:s.length===3&&s[0]<=t&&s[1]*s[2]<=t?o=[s[0],s[1]*s[2]]:s.length===4&&s[0]*s[1]*s[2]<=t&&s[3]<=t?o=[s[0]*s[1]*s[2],s[3]]:s.length===4&&s[0]<=t&&s[1]*s[2]*s[3]<=t&&(o=[s[0],s[1]*s[2]*s[3]]);const i=o!=null&&Math.max(...o)>n&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const c=Tu(s);let u=2,h=2;s.length&&([u,h]=Iu(s)),a=c*(u/2)*(h/2),o=O1(a).map(p=>p*2)}else o=O1(a);return o}function xm(s){return s%2===0}function ng(s,e){if(s=s.slice(-2),e=e.slice(-2),zt(s,e)||!s.length||!e.length||s[0]===0||s[1]===0||e[0]===0||e[1]===0)return!0;if(s.length!==e.length){const t=s[s.length-1],n=e[e.length-1];if(t===n||xm(t)&&xm(n)&&(s[0]===1||e[0]===1))return!0}return s[1]===e[1]&&xm(s[0])&&xm(e[0])}let $1,A1;function bse(s){if($1==null){const e=Er(s);$1=e.getParameter(e.MAX_TEXTURE_SIZE)}return $1}function yse(s){if(A1==null){const e=Er(s);A1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,A1)}function vse(s){if(s===0)return 0;let e;const t=Er(s);return ir(t,"EXT_disjoint_timer_query_webgl2")&&s===2?e=2:ir(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function ir(s,e){return s.getExtension(e)!=null}function YC(s){try{if(Er(s)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function wse(s){if(s===0)return!1;const e=Er(s);if(s===1){if(!ir(e,"OES_texture_float"))return!1}else if(!ir(e,"EXT_color_buffer_float"))return!1;return Iy(e)}function Nse(s){if(s===0)return!1;const e=Er(s);if(s===1){if(!ir(e,"OES_texture_float")||!ir(e,"WEBGL_color_buffer_float"))return!1}else{if(ir(e,"EXT_color_buffer_float"))return Iy(e);const n="EXT_color_buffer_half_float";if(ir(e,n)){const a=e.getExtension(n);return Sse(e,a)}return!1}return Iy(e)}function Iy(s){const e=Fw(s),t=s.createTexture();s.bindTexture(s.TEXTURE_2D,t),s.texImage2D(s.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,o),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0);const i=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;return s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteTexture(t),s.deleteFramebuffer(o),i}function Sse(s,e){const t=Fw(s,e),n=s.createTexture();s.bindTexture(s.TEXTURE_2D,n),s.texImage2D(s.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,i),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0);const c=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;return s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteTexture(n),s.deleteFramebuffer(i),c}function Cse(s){return s!==2?!1:Er(s).fenceSync!=null}function Wp(s,e){Array.isArray(s)||(s=[s]),s.forEach(t=>{t!=null&&V(t.dtype!=="complex64",()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend.")})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dt=Se();dt.registerFlag("HAS_WEBGL",()=>dt.getNumber("WEBGL_VERSION")>0);dt.registerFlag("WEBGL_VERSION",()=>YC(2)?2:YC(1)?1:0);dt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);dt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>dt.get("WEBGL_VERSION")===2);dt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);dt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);dt.registerFlag("WEBGL_PACK",()=>dt.getBool("HAS_WEBGL"));dt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_CLIP",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_REDUCE",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_LAZILY_UNPACK",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_CONV_IM2COL",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>dt.getBool("WEBGL_PACK"));dt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>bse(dt.getNumber("WEBGL_VERSION")));dt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>yse(dt.getNumber("WEBGL_VERSION")));dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const s=dt.getNumber("WEBGL_VERSION");return s===0?0:vse(s)});dt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>dt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!nk());dt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>wse(dt.getNumber("WEBGL_VERSION")));dt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>dt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:dt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));dt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Nse(dt.getNumber("WEBGL_VERSION")));dt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Cse(dt.getNumber("WEBGL_VERSION")));dt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>dt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);dt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,s=>{if(typeof s!="number")throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(s,"."));if(s<0&&s!==-1)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(s,"."))});dt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>nk()?1:-1,s=>{if(typeof s!="number")throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(s,"."));if(s<0&&s!==-1)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(s,"."))});dt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);dt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);dt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);dt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);dt.registerFlag("WEBGL_EXP_CONV",()=>!1);dt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>dt.getBool("IS_TEST"));dt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);dt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);dt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);dt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xn(){let s,e,t,n,a,o,i,c,u,h;return Se().getNumber("WEBGL_VERSION")===2?(s="#version 300 es",e="in",t="out",n="in",a="texture",o="outputColor",i="out vec4 outputColor;",c=Se().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",h="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(s="",e="attribute",t="varying",n="varying",a="texture2D",o="gl_FragColor",i="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",h="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:s,attribute:e,varyingVs:t,varyingFs:n,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:c,defineSpecialInf:u,defineRound:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oc(s,e,t="index"){const n=ft(e);return n.map((a,o)=>{const i="int ".concat(s[o]," = ").concat(t," / ").concat(a),c=o===n.length-1?"int ".concat(s[o+1]," = ").concat(t," - ").concat(s[o]," * ").concat(a):"index -= ".concat(s[o]," * ").concat(a);return"".concat(i,"; ").concat(c,";")}).join("")}function Qx(s,e,t="index"){const n=ft(e);return n.map((a,o)=>{const i="int ".concat(s[o]," = ").concat(t," / outShapeStrides[").concat(o,"]"),c=o===n.length-1?"int ".concat(s[o+1]," = ").concat(t," - ").concat(s[o]," * outShapeStrides[").concat(o,"]"):"index -= ".concat(s[o]," * outShapeStrides[").concat(o,"]");return"".concat(i,"; ").concat(c,";")}).join("")}function jse(s,e){const t=s.length,n=s.map(o=>"".concat(e,"[").concat(o,"]")),a=new Array(t-1);a[t-2]=n[t-1];for(let o=t-3;o>=0;--o)a[o]="(".concat(a[o+1]," * ").concat(n[o+1],")");return a}function kse(s,e,t="index"){const n=s.map((o,i)=>i),a=jse(n,e);return a.map((o,i)=>{const c="int ".concat(s[i]," = ").concat(t," / ").concat(a[i]),u=i===a.length-1?"int ".concat(s[i+1]," = ").concat(t," - ").concat(s[i]," * ").concat(a[i]):"index -= ".concat(s[i]," * ").concat(a[i]);return"".concat(c,"; ").concat(u,";")}).join("")}function Lw(s){const e=ft(s).map(t=>t.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}function Mw(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}const tD="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:sD}=NU;function Tse(s,e,t){const n=[];if(s.forEach(b=>{const y=Ae(b.shapeInfo.logicalShape);if(b.shapeInfo.isUniform?n.push("uniform float ".concat(b.name).concat(y>1?"[".concat(y,"]"):"",";")):(n.push("uniform sampler2D ".concat(b.name,";")),n.push("uniform int offset".concat(b.name,";"))),t.enableShapeUniforms){const{uniformShape:w}=Pw(t.packedInputs,b.shapeInfo.logicalShape,b.shapeInfo.texShape);switch(w.length){case 1:n.push("uniform int ".concat(b.name,"Shape;"));break;case 2:n.push("uniform ivec2 ".concat(b.name,"Shape;"));break;case 3:n.push("uniform ivec3 ".concat(b.name,"Shape;"));break;case 4:n.push("uniform ivec4 ".concat(b.name,"Shape;"));break}n.push("uniform ivec2 ".concat(b.name,"TexShape;"))}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;");break}n.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(b=>{n.push("uniform ".concat(b.type," ").concat(b.name).concat(b.arrayIndex?"[".concat(b.arrayIndex,"]"):"",";"))});const a=n.join("\n"),o=s.map(b=>Ise(b,e,t.packedInputs,t.enableShapeUniforms)).join("\n"),i=e.texShape,c=Xn(),u=Ese(c);let h,p,f=Ose(c);return e.isPacked?(h=$se(e.logicalShape,i,t.enableShapeUniforms),p=Rse(c)):(h=Ase(e.logicalShape,i,t.enableShapeUniforms),p=Dse(c)),t.packedInputs&&(f+=Mse),[f,u,p,a,h,o,t.userCode].join("\n")}function Bu(s,e=!1){const t=s.shapeInfo.logicalShape;switch(t.length){case 0:return Yse(s,e);case 1:return Qse(s,e);case 2:return ene(s,e);case 3:return sne(s,e);case 4:return ane(s,e);case 5:return rne(s);case 6:return one(s);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function nD(s,e){switch(s.shapeInfo.logicalShape.length){case 0:return Xse(s);case 1:return Zse(s,e);case 2:return Jse(s,e);case 3:return tne(s,e);default:return nne(s,e)}}function Ise(s,e,t=!1,n){let a="";t?a+=nD(s,n):a+=Bu(s,n);const o=s.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(t?a+=ine(s,e):a+=lne(s,e)),a}function $se(s,e,t){switch(s.length){case 0:return aD();case 1:return Pse(s,e,t);case 2:return qse(s,e,t);case 3:return Bse(s,e,t);default:return Use(s,e,t)}}function Ase(s,e,t){switch(s.length){case 0:return aD();case 1:return zse(s,e,t);case 2:return Kse(s,e,t);case 3:return Vse(s,e,t);case 4:return Gse(s,e,t);case 5:return Wse(s,e);case 6:return Hse(s,e);default:throw new Error("".concat(s.length,"-D output sampling is not yet supported"))}}function Ese(s){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(s.texture2D,"(textureSampler, uv).r;\n    }\n  ")}function Dse(s){return"\n    void setOutput(float val) {\n      ".concat(s.output," = vec4(val, 0, 0, 0);\n    }\n  ")}function Rse(s){return"\n    void setOutput(vec4 val) {\n      ".concat(s.output," = val;\n    }\n  ")}function Ose(s){return"".concat(s.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(s.varyingFs," vec2 resultUV;\n    ").concat(s.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(s.defineSpecialNaN,"\n    ").concat(s.defineSpecialInf,"\n    ").concat(s.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(_se,"\n    ").concat(Fse,"\n    ").concat(Lse,"\n  ")}const _se="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Fse="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Lse="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Mse="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function aD(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function Pse(s,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return n[0]===1?t?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):n[1]===1?t?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):t?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}function zse(s,e,t){return e[0]===1?t?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    "):e[1]===1?t?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    "):t?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}function Bse(s,e,t){if(t)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(s[2]/2),o=a*Math.ceil(s[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}function Vse(s,e,t){if(t){const a=Qx(["r","c","d"],s);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(a,"\n    return ivec3(r, c, d);\n  }\n")}const n=oc(["r","c","d"],s);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}function Use(s,e,t){if(t)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(s[s.length-1]/2),o=a*Math.ceil(s[s.length-2]/2);let i=o,c="",u="b, r, c";for(let h=2;h<s.length-1;h++)i*=s[s.length-h-1],c="\n      int b".concat(h," = index / ").concat(i,";\n      index -= b").concat(h," * ").concat(i,";\n    ")+c,u="b".concat(h,", ")+u;return"\n    ivec".concat(s.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(c,"\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(s.length,"(").concat(u,");\n    }\n  ")}function Gse(s,e,t){if(t){const a=Qx(["r","c","d","d2"],s);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const n=oc(["r","c","d","d2"],s);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}function Wse(s,e){const t=oc(["r","c","d","d2","d3"],s);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(t,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}function Hse(s,e){const t=oc(["r","c","d","d2","d3","d4"],s);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(t,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}function qse(s,e,t){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(zt(s,e))return t?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");const a=Math.ceil(s[1]/2);return t?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}function Kse(s,e,t){return zt(s,e)?t?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    "):s[1]===1?t?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):s[0]===1?t?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):t?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(s[1],";\n      int c = index - r * ").concat(s[1],";\n      return ivec2(r, c);\n    }\n  ")}function ic(s){return"offset".concat(s)}function Xse(s){const e=s.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),n=Xn();return"\n    vec4 ".concat(t,"() {\n      return ").concat(n.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}function Yse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(s.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");const[a,o]=s.shapeInfo.texShape;if(a===1&&o===1)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");const i=ic(t);if(e)return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(t,"TexShape[0], ").concat(t,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ");const[c,u]=s.shapeInfo.texShape;return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", ").concat(i,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Zse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=s.shapeInfo.texShape,o=Xn();if(e)return"\n    vec4 ".concat(n,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(t,"TexShape[0]) / 2.0), ceil(float(").concat(t,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }\n  ");const i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }\n  ")}function Qse(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(Vu(s),"\n      }\n    ");const a=s.shapeInfo.texShape,o=a[0],i=a[1];if(i===1&&o===1)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");const c=ic(t);return i===1?e?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / float(").concat(t,"TexShape[0]));\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / ").concat(o,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):o===1?e?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / float(").concat(t,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):e?"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(t,"TexShape[0], ").concat(t,"TexShape[1], index + ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(i,", index + ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Jse(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape,i=o[0],c=o[1],u=Xn();if(o!=null&&zt(t,o))return e?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ");const h=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],p=Math.ceil(t[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(p,", ").concat(h[0],", ").concat(h[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}function ene(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape;if(o!=null&&zt(t,o)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const g=o[0],b=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(b,".0, ").concat(g,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}const{newShape:i,keptDims:c}=Gi(t),u=i;if(u.length<t.length){const g=Uu(s,u),b=["row","col"];return"\n      ".concat(Bu(g,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Gu(b,c),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const h=o[0],p=o[1],f=ic(n);return p===1?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):h===1?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(p,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):e?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(n,"Shape[1] + col + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(f,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}function tne(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=s.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const g=t.slice(1),b=[1,2],y=Uu(s,g),w=["b","row","col"];return"\n        ".concat(nD(y,e),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Gu(w,b),");\n        }\n      ")}const c=Xn();if(e)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ");const u=i[0],h=i[1],p=Math.ceil(t[2]/2),f=p*Math.ceil(t[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(h,", ").concat(f,", ").concat(p,", b, row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ")}function sne(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],i=t[2],{newShape:c,keptDims:u}=Gi(t),h=c;if(h.length<t.length){const w=Uu(s,h),v=["row","col","depth"];return"\n        ".concat(Bu(w,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Gu(v,u),");\n        }\n      ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(i,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.texShape,f=p[0],g=p[1],b=s.shapeInfo.flatOffset;if(g===o&&b==null)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(n,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(g,".0, ").concat(f,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(g===i&&b==null)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(n,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(g,".0, ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const y=ic(n);return e?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(n,"Shape[1] * ").concat(n,"Shape[2];\n      int stride1 = ").concat(n,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index);\n      return sampleTexture(").concat(n,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(i," + depth + ").concat(y,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(g,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}function nne(s,e){const t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=Xn();if(e)return"\n    vec4 ".concat(n,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(t,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(t,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(t,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(t,"TexShape[0]) / 2.0), ceil(float(").concat(t,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(t,", uv);\n    }\n  ");const o=s.shapeInfo.logicalShape,i=o.length,c=s.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],h=u[0],p=u[1],f=Math.ceil(o[i-1]/2);let g=f*Math.ceil(o[i-2]/2),b="int b, int row, int col",y="b * ".concat(g," + (row / 2) * ").concat(f," + (col / 2)");for(let w=2;w<i-1;w++)b="int b".concat(w,", ")+b,g*=o[i-w-1],y="b".concat(w," * ").concat(g," + ")+y;return"\n    vec4 ".concat(n,"(").concat(b,") {\n      int index = ").concat(y,";\n      int texR = index / ").concat(p,";\n      int texC = index - texR * ").concat(p,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,", ").concat(h,");\n      return ").concat(a.texture2D,"(").concat(t,", uv);\n    }\n  ")}function ane(s,e){const t=s.shapeInfo.logicalShape,n=s.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],i=t[2]*o,c=t[1]*i,{newShape:u,keptDims:h}=Gi(t);if(u.length<t.length){const C=Uu(s,u),T=["row","col","depth","depth2"];return"\n      ".concat(Bu(C,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Gu(T,h),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(c,", ").concat(i,", ").concat(o,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.flatOffset,f=s.shapeInfo.texShape,g=f[0],b=f[1],y="int stride2 = ".concat(n,"Shape[3];"),w="int stride1 = ".concat(n,"Shape[2] * stride2;"),v="int stride0 = ".concat(n,"Shape[1] * stride1;");if(b===c&&p==null)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(y,"\n        ").concat(w,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(b===o&&p==null)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n,"Shape[1] * ").concat(n,"Shape[2], ").concat(n,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(n,"TexShape[1], ").concat(n,"TexShape[0]);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const N=ic(n);return e?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(y,"\n      ").concat(w,"\n      ").concat(v,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(N,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(b,", index + ").concat(N,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function rne(s){const e=s.shapeInfo.logicalShape,t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=e[4],o=e[3]*a,i=e[2]*o,c=e[1]*i,{newShape:u,keptDims:h}=Gi(e);if(u.length<e.length){const w=Uu(s,u),v=["row","col","depth","depth2","depth3"];return"\n      ".concat(Bu(w),"\n      float ").concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(n,"(").concat(Gu(v,h),");\n      }\n    ")}if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(i,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(Vu(s),"\n      }\n    ");const p=s.shapeInfo.flatOffset,f=s.shapeInfo.texShape,g=f[0],b=f[1];if(b===c&&p==null)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(b===a&&p==null)return"\n      float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");const y=ic(t);return"\n    float ".concat(n,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(b,", index);\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function one(s){const e=s.shapeInfo.logicalShape,t=s.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:a,keptDims:o}=Gi(e);if(a.length<e.length){const v=Uu(s,a),N=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Bu(v),"\n      float ").concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(n,"(").concat(Gu(N,o),");\n      }\n    ")}const i=e[5],c=e[4]*i,u=e[3]*c,h=e[2]*u,p=e[1]*h;if(s.shapeInfo.isUniform)return"\n      float ".concat(n,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(h,", ").concat(u,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(Vu(s),"\n      }\n    ");const f=s.shapeInfo.flatOffset,g=s.shapeInfo.texShape,b=g[0],y=g[1];if(y===p&&f==null)return"\n      float ".concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(u,", ").concat(c,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(y,".0, ").concat(b,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(y===i&&f==null)return"\n      float ".concat(n,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(y,".0, ").concat(b,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");const w=ic(t);return"\n    float ".concat(n,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(h," + depth * ").concat(u," +\n          depth2 * ").concat(c," + depth3 * ").concat(i," + depth4 + ").concat(w,";\n      vec2 uv = uvFromFlat(").concat(b,", ").concat(y,", index);\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}function Vu(s){const e=s.name,t=Ae(s.shapeInfo.logicalShape);return t<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(t,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function ine(s,e){const t=s.name,n=t.charAt(0).toUpperCase()+t.slice(1),a="get"+n+"AtOutCoords",o=s.shapeInfo.logicalShape.length,i=e.logicalShape.length,c=sD(s.shapeInfo.logicalShape,e.logicalShape),u=ss(i),h=i-o;let p;const f=["x","y","z","w","u","v"];o===0?p="":i<2&&c.length>=1?p="coords = 0;":p=c.map(C=>"coords.".concat(f[C+h]," = 0;")).join("\n");let g="";i<2&&o>0?g="coords":g=s.shapeInfo.logicalShape.map((C,T)=>"coords.".concat(f[T+h])).join(", ");let b="return outputValue;";const w=Ae(s.shapeInfo.logicalShape)===1,N=Ae(e.logicalShape)===1;if(o===1&&!w&&!N)b="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";else if(w&&!N)i===1?b="\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":b="\n        return vec4(outputValue.x);\n      ";else if(c.length){const C=o-2,T=o-1;c.indexOf(C)>-1&&c.indexOf(T)>-1?b="return vec4(outputValue.x);":c.indexOf(C)>-1?b="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(T)>-1&&(b="return vec4(outputValue.xx, outputValue.zz);")}return"\n    vec4 ".concat(a,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(p,"\n      vec4 outputValue = get").concat(n,"(").concat(g,");\n      ").concat(b,"\n    }\n  ")}function lne(s,e){const t=s.name,n=t.charAt(0).toUpperCase()+t.slice(1),a="get"+n+"AtOutCoords",o=e.texShape,i=s.shapeInfo.texShape,c=s.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!s.shapeInfo.isUniform&&c===u&&s.shapeInfo.flatOffset==null&&zt(i,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(t,", resultUV);\n      }\n    ");const h=ss(u),p=sD(s.shapeInfo.logicalShape,e.logicalShape),f=u-c;let g;const b=["x","y","z","w","u","v"];c===0?g="":u<2&&p.length>=1?g="coords = 0;":g=p.map(w=>"coords.".concat(b[w+f]," = 0;")).join("\n");let y="";return u<2&&c>0?y="coords":y=s.shapeInfo.logicalShape.map((w,v)=>"coords.".concat(b[v+f])).join(", "),"\n    float ".concat(a,"() {\n      ").concat(h," coords = getOutputCoords();\n      ").concat(g,"\n      return get").concat(n,"(").concat(y,");\n    }\n  ")}function ss(s){if(s<=1)return"int";if(s===2)return"ivec2";if(s===3)return"ivec3";if(s===4)return"ivec4";if(s===5)return"ivec5";if(s===6)return"ivec6";throw Error("GPU for rank ".concat(s," is not yet supported"))}function Pw(s,e,t){const{newShape:n,keptDims:a}=Gi(e),o=e.length,i=s&&o===3&&e[0]===1,c=i?e.slice(1):n,u=!s&&o>1&&!zt(e,t)&&n.length<o||i;return{useSqueezeShape:u,uniformShape:u?c:e,keptDims:a}}function Uu(s,e){const t=JSON.parse(JSON.stringify(s));return t.shapeInfo.logicalShape=e,t}function Gu(s,e){return e.map(t=>s[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(s,e,t,n){const a=t.map((p,f)=>{const g={logicalShape:p.shape,texShape:p.isUniform?null:p.texData.texShape,isUniform:p.isUniform,isPacked:p.isUniform?!1:p.texData.isPacked,flatOffset:null};return p.texData!=null&&p.texData.slice!=null&&p.texData.slice.flatOffset>0&&(g.flatOffset=p.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:g}}),o=a.map(p=>p.shapeInfo),i={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},c=Tse(a,i,e),u=sse(s.gl,c),h=s.createProgram(u);return Se().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:c,webGLProgram:h,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(s.buildVao(h),Object.assign({program:e,fragmentShader:u,source:c,webGLProgram:h,inShapeInfos:o,outShapeInfo:i},rD(s,e,h)))}function rD(s,e,t){const n=[],a=[];let o,i,c,u=null,h=null;h=s.getUniformLocation(t,"NAN",!1),Se().getNumber("WEBGL_VERSION")===1&&(u=s.getUniformLocation(t,"INFINITY",!1));const p=!1;for(const f of e.variableNames){const g={name:f,uniform:s.getUniformLocation(t,f,p),offset:s.getUniformLocation(t,"offset".concat(f),p)};e.enableShapeUniforms&&(g.shape=s.getUniformLocation(t,"".concat(f,"Shape"),p),g.texShape=s.getUniformLocation(t,"".concat(f,"TexShape"),p)),n.push(g)}if(e.enableShapeUniforms&&(o=s.getUniformLocation(t,"outShape",p),c=s.getUniformLocation(t,"outShapeStrides",p),i=s.getUniformLocation(t,"outTexShape",p)),e.customUniforms)for(const f of e.customUniforms)a.push(s.getUniformLocation(t,f.name,p));return{variablesLocations:n,customUniformLocations:a,infLoc:u,nanLoc:h,outShapeLocation:o,outShapeStridesLocation:c,outTexShapeLocation:i}}function ZC(s,e){if(s.length!==e.length)throw Error("Binary was compiled with ".concat(s.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));s.forEach((t,n)=>{const a=t.logicalShape,o=e[n],i=o.shape;if(!zt(a,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(a," and ").concat(i," must match"));if(t.isUniform&&o.isUniform)return;const c=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!zt(c,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(c," and ").concat(u," must match"))})}function une(s,e,t,n,a){e.program.enableShapeUniforms||(ZC(e.inShapeInfos,t),ZC([e.outShapeInfo],[n]));const o=n.texData.texture,i=n.texData.texShape;n.texData.isPacked?s.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):s.setOutputMatrixTexture(o.texture,i[0],i[1]),s.setProgram(e.webGLProgram),s.bindVertexArray(e.webGLProgram.vao),Se().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&s.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&s.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<t.length;++u){const h=t[u],{uniform:p,offset:f,shape:g,texShape:b}=e.variablesLocations[u];if(g){const{uniformShape:y}=Pw(e.program.packedInputs,h.shape,h.texData.texShape);switch(y.length){case 1:s.gl.uniform1iv(g,new Int32Array(y));break;case 2:s.gl.uniform2iv(g,new Int32Array(y));break;case 3:s.gl.uniform3iv(g,new Int32Array(y));break;case 4:s.gl.uniform4iv(g,new Int32Array(y));break}}if(b&&s.gl.uniform2i(b,h.texData.texShape[0],h.texData.texShape[1]),p!=null){if(h.isUniform){if(Ae(h.shape)<2)s.gl.uniform1f(p,h.uniformValues[0]);else{let y=h.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),s.gl.uniform1fv(p,y)}continue}h.texData.slice!=null&&f!=null&&s.gl.uniform1i(f,h.texData.slice.flatOffset),s.setInputMatrixTexture(h.texData.texture.texture,p,u)}}const c=e.outShapeLocation;if(c)switch(n.shape.length){case 1:s.gl.uniform1iv(c,new Int32Array(n.shape));break;case 2:s.gl.uniform2iv(c,new Int32Array(n.shape));break;case 3:s.gl.uniform3iv(c,new Int32Array(n.shape));break;case 4:s.gl.uniform4iv(c,new Int32Array(n.shape));break}if(e.outShapeStridesLocation){const u=ft(n.shape);switch(n.shape.length){case 2:s.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:s.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:s.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}if(e.outTexShapeLocation&&s.gl.uniform2i(e.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),e.program.customUniforms&&a)for(let u=0;u<e.program.customUniforms.length;++u){const h=e.program.customUniforms[u],p=e.customUniformLocations[u],f=a[u];if(h.type==="float")s.gl.uniform1fv(p,f);else if(h.type==="vec2")s.gl.uniform2fv(p,f);else if(h.type==="vec3")s.gl.uniform3fv(p,f);else if(h.type==="vec4")s.gl.uniform4fv(p,f);else if(h.type==="int")s.gl.uniform1iv(p,f);else if(h.type==="ivec2")s.gl.uniform2iv(p,f);else if(h.type==="ivec3")s.gl.uniform3iv(p,f);else if(h.type==="ivec4")s.gl.uniform4iv(p,f);else throw Error("uniform type ".concat(h.type," is not supported yet."))}s.executeProgram()}function dne(s,e,t){let n="";e.concat(t).forEach(i=>{const c=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(s.enableShapeUniforms&&!i.isUniform){const u=i.texData.texShape,{useSqueezeShape:h,uniformShape:p,keptDims:f}=Pw(s.packedInputs,i.shape,u);let g="",b="",y="";if(p.length===1&&s.packedInputs){const $=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];g="".concat($[0]>1,"_").concat($[1]>1)}else if(p.length===2&&!s.packedInputs)b="".concat(p[0]>1,"_").concat(p[1]>1);else if(p.length>2&&!s.packedInputs){const $=ft(p);y="".concat($[0]===u[1],"_").concat($[$.length-1]===u[1])}const w=i.shape.length,v=p.length===2&&zt(i.shape,u),N=Ae(i.shape)===1,C=vu(i.shape,t.shape),T=!s.packedInputs&&w===t.shape.length&&zt(u,t.texData.texShape),I=s.packedInputs||p.length>2?"":"".concat(u[0]>1,"_").concat(u[1]>1);n+="".concat(w,"_").concat(T,"_").concat(h?f:"","_").concat(p.length,"_").concat(N,"_").concat(C,"_").concat(v,"_").concat(g,"_").concat(b,"_").concat(y,"_").concat(I,"_").concat(c)}else{const u=i.isUniform?"uniform":i.texData.texShape;n+="".concat(i.shape,"_").concat(u,"_").concat(c)}});const a=s.userCode;let o=s.constructor.name;return o+="_"+n+"_"+a+"".concat(Se().getNumber("WEBGL_VERSION")),o}function _n(s){return Se().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&s<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hne{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Sh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Xn();this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Qx(["r","c","d"],e):oc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Sh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Xn();this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Qx(["r","c","d"],e):oc(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fne{constructor(e){this.variableNames=["A"],this.outTexUsage=Fa.DOWNLOAD;const t=Xn();this.outputShape=e,this.userCode="\n      ".concat(tD,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Fa.DOWNLOAD;const t=Xn();this.outputShape=e,this.userCode="\n      ".concat(tD,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gne={R:0,G:1,B:2,A:3};class QC{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=Xn();this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length);let o="result";t&&(o="floor(result * 255. + 0.5)");let i="";for(let c=0;c<n.length;c++){const u=n[c];i+="\n          if(offset == ".concat(c,") {\n            result = values[").concat(gne[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?Mw():Lw(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(a.output," = vec4(").concat(o,", 0., 0., 0.);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xne{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Xn();this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length);let a="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let c=0;c<=1;c++){const u=i*2+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(c," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(c,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?Mw():Lw(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(o,";\n        }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(s){const e=Xn(),t="".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }");return tse(s,t)}function yne(s){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ose(s,e)}function vne(s){const e=new Uint16Array([0,1,2,2,1,3]);return ise(s,e)}function Hp(s,e,t,n,a,o){cse(e,t);const i=lse(s),c=s.TEXTURE_2D;return Ze(s,()=>s.bindTexture(c,i)),Ze(s,()=>s.texParameteri(c,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE)),Ze(s,()=>s.texParameteri(c,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE)),Ze(s,()=>s.texParameteri(c,s.TEXTURE_MIN_FILTER,s.NEAREST)),Ze(s,()=>s.texParameteri(c,s.TEXTURE_MAG_FILTER,s.NEAREST)),Se().getNumber("WEBGL_VERSION")===1?Ze(s,()=>s.texImage2D(c,0,n,e,t,0,a,o,null)):Ze(s,()=>s.texStorage2D(c,1,n,e,t)),Ze(s,()=>s.bindTexture(s.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function oD(s){return s.internalFormatFloat}function wne(s,e,t,n){const[a,o]=Gp(e,t);return Hp(s,a,o,oD(n),n.textureFormatFloat,s.FLOAT)}function iD(s){return s.internalFormatHalfFloat}function Nne(s,e,t,n){const[a,o]=Gp(e,t);return Hp(s,a,o,iD(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function lD(s){return s.downloadTextureFormat}function Sne(s,e,t,n){const[a,o]=Gp(e,t);return Hp(s,a,o,lD(n),s.RGBA,s.UNSIGNED_BYTE)}function cD(s){return s.internalFormatPackedFloat}function Cne(s,e,t,n){const[a,o]=zu(e,t);return Hp(s,a,o,cD(n),s.RGBA,s.FLOAT)}function uD(s){return s.internalFormatPackedHalfFloat}function jne(s,e,t,n){const[a,o]=zu(e,t);return Hp(s,a,o,uD(n),s.RGBA,n.textureTypeHalfFloat)}function kne(s,e,t){return Ze(s,()=>s.bindBuffer(s.ARRAY_BUFFER,t)),KC(s,e,"clipSpacePos",t,3,20,0)&&KC(s,e,"uv",t,2,20,12)}function Tne(s,e,t,n,a,o){Ze(s,()=>s.bindTexture(s.TEXTURE_2D,e));let i,c,u;a instanceof Uint8Array?(i=new Uint8Array(t*n*4),c=s.UNSIGNED_BYTE,u=s.RGBA):(i=new Float32Array(t*n*4),c=s.FLOAT,u=o.internalFormatPackedFloat),i.set(a),Se().getNumber("WEBGL_VERSION")===2?Ze(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,t,n,s.RGBA,c,i)):Ze(s,()=>s.texImage2D(s.TEXTURE_2D,0,u,t,n,0,s.RGBA,c,i)),Ze(s,()=>s.bindTexture(s.TEXTURE_2D,null))}function Ine(s,e,t){Ze(s,()=>s.bindTexture(s.TEXTURE_2D,e)),t.data instanceof Uint8Array?Se().getNumber("WEBGL_VERSION")===2?Ze(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.width,t.height,s.RGBA,s.UNSIGNED_BYTE,t.data)):Ze(s,()=>s.texImage2D(s.TEXTURE_2D,0,s.RGBA,t.width,t.height,0,s.RGBA,s.UNSIGNED_BYTE,t.data)):Se().getNumber("WEBGL_VERSION")===2?Ze(s,()=>s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,t)):Ze(s,()=>s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t)),Ze(s,()=>s.bindTexture(s.TEXTURE_2D,null))}function $ne(s,e,t,n){const a=s.createBuffer();Ze(s,()=>s.bindBuffer(s.PIXEL_PACK_BUFFER,a));const c=4*4*e*t;return Ze(s,()=>s.bufferData(s.PIXEL_PACK_BUFFER,c,s.STREAM_READ)),Ze(s,()=>s.readPixels(0,0,t,e,s.RGBA,s.FLOAT,0)),Ze(s,()=>s.bindBuffer(s.PIXEL_PACK_BUFFER,null)),a}function Ane(s,e,t){const n=s,a=new Float32Array(t);return n.bindBuffer(n.PIXEL_PACK_BUFFER,e),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function Ene(s,e,t,n){const[a,o]=Gp(e,t),i=4,c=new Uint8Array(Kte(e*t,i));return Ze(s,()=>s.readPixels(0,0,a,o,n.downloadTextureFormat,s.UNSIGNED_BYTE,c)),new Float32Array(c.buffer)}function Dne(s,e,t,n,a,o,i,c){const u=s,h=new Float32Array(Xte(o,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,h),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),h}function Rne(s,e,t){const n=new Float32Array(e*t*4);return Ze(s,()=>s.readPixels(0,0,t,e,s.RGBA,s.FLOAT,n)),n}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Se().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Wte(t,e)):this.gl=Er(t),e=this.gl,Se().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>Ze(o,()=>o.createVertexArray()),this.bindVertexArray=i=>Ze(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>Ze(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>Ze(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ze(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>Ze(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Ze(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>Ze(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Se().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=fm(this.gl,o),ir(this.gl,i))this.textureHalfFloatExtension=fm(this.gl,i);else if(Se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ir(this.gl,a))this.colorBufferHalfFloatExtension=fm(this.gl,a);else if(Se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ir(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(ir(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=yne(this.gl),this.indexBuffer=vne(this.gl),this.framebuffer=use(this.gl),this.textureConfig=Fw(this.gl,this.textureHalfFloatExtension)}get debug(){return Se().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ze(e,()=>e.finish()),Ze(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ze(e,()=>e.deleteFramebuffer(this.framebuffer)),Ze(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ze(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ze(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),wne(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Nne(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Sne(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Ine(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),Tne(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),jne(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Cne(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(XC(this.gl,this.framebuffer),this.outputTexture=null),Ze(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>Ene(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,o,i){return Dne(this.gl,e,t,n,a,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Ane(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const a=$ne(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Se().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const i=a.clientWaitSync(o,0,0);return i===a.ALREADY_SIGNALED||i===a.CONDITION_SATISFIED},t=o}else Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>Rne(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=bne(t));const n=ase(t);Ze(t,()=>t.attachShader(n,this.vertexShader)),Ze(t,()=>t.attachShader(n,e)),rse(t,n);const a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&T1(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ze(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),kne(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ze(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&T1(this.gl,this.program),Ze(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?hse(this.gl,e,t):pse(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ze(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),fse(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[a,o]=zu(t,n);this.setOutputMatrixTextureDriver(e,a,o)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&T1(this.gl,this.program),mm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ze(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ze(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fm(this.gl,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=n.createQuery();return n.beginQuery(a.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await k4(()=>this.disposed||this.isQueryAvailable(e,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{const n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const n=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const n=this.getQueryTimerExtensionWebGL1(),a=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=One(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Se().platform&&(n=Se().platform.setTimeoutCustom.bind(Se().platform)),k4(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),I1(this.gl,e,this.framebuffer),this.debug&&mm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(I1(this.gl,this.outputTexture,this.framebuffer),this.debug&&mm(this.gl)):XC(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const a=this.gl;I1(a,e,this.framebuffer),this.debug&&mm(a),this.outputTexture=e,Ze(a,()=>a.viewport(0,0,t,n)),Ze(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),Ze(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function One(s){let e=0;for(;e<s.length&&s[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:_ne,bincountImpl:dD,bincountReduceImpl:Fne,bitwiseAndImpl:Lne,castImpl:Mne,ceilImpl:Pne,concatImpl:zne,equalImpl:Bne,expImpl:Vne,expm1Impl:Une,floorImpl:Gne,gatherNdImpl:Wne,gatherV2Impl:Hne,greaterImpl:qne,greaterEqualImpl:Kne,lessImpl:Xne,lessEqualImpl:Yne,linSpaceImpl:Zne,logImpl:Qne,maxImpl:Jne,maximumImpl:eae,minimumImpl:tae,multiplyImpl:sae,negImpl:nae,notEqualImpl:aae,prodImpl:rae,raggedGatherImpl:oae,raggedRangeImpl:iae,raggedTensorToTensorImpl:lae,rangeImpl:cae,rsqrtImpl:uae,scatterImpl:dae,sigmoidImpl:hae,simpleAbsImpl:hD,sliceImpl:pae,sparseFillEmptyRowsImpl:fae,sparseReshapeImpl:mae,sparseSegmentReductionImpl:pD,sqrtImpl:gae,staticRegexReplaceImpl:xae,stridedSliceImpl:bae,stringNGramsImpl:yae,stringSplitImpl:vae,stringToHashBucketFastImpl:wae,subImpl:Nae,tileImpl:Sae,topKImpl:Cae,transposeImpl:zw,uniqueImpl:jae}=IY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fD(s,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>"".concat(s,".").concat(t))}function Gn(s,e){return e===1?[s]:fD(s,e)}function kae(s,e){if(s===1)return"rc";let t="";for(let n=0;n<s;n++)t+=e[n],n<s-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=_n(this.outputShape.length),this.rank===0)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=Gn("rc",this.rank),n=ss(this.rank),a=this.getOutOfBoundsCondition(t),o=this.getSetup(t),i=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(n," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(i,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let o="".concat(n===0?"r":"rp1",", ").concat(a===0?"c":"cp1");for(let i=2;i<this.rank;i++)o="".concat(e[e.length-1-i],",")+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(this.rank===1){const n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mD{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length);let n="";for(let a=0;a<4;a++){let o="thisRC = rc;";a%2===1&&(o+="thisRC.z += 1;"),a>1&&(o+="thisRC.y += 1;"),n+="\n        ".concat(o,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(Iae(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?Mw():Lw(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}function Iae(s,e){const t=e?kse(["r","c","d"],"inputShape"):oc(["r","c","d"],s);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ae{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const a=ej(t,n),o=tj(e,a,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=JC(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const u=this.freeTextures[o].pop();return this.usedTextures[o].push(u),u}let c;return a===Nn.PACKED_2X2_FLOAT32?c=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Nn.PACKED_2X2_FLOAT16?c=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Nn.UNPACKED_FLOAT32?c=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Nn.UNPACKED_FLOAT16?c=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Nn.PACKED_4X1_UNSIGNED_BYTE&&(c=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(c),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),c}releaseTexture(e,t,n,a){if(this.freeTextures==null)return;const o=ej(n,a),i=tj(t,o,a);i in this.freeTextures||(this.freeTextures[i]=[]);const c=JC(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,a),u=Se().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=c):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=c),this.numUsedTextures--;const h=this.usedTextures[i],p=h&&h.indexOf(e);if(p==null||p<0)throw new Error("Cannot release a texture that was never provided by this texture manager");h[p]=h[h.length-1],h.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Aae(s,e){const t=s;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===s.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}function JC(s,e,t,n,a){const o=Eae(e,n);let i;if(a){const[u,h]=zu(s[0],s[1]);i=u*h}else{const[u,h]=Gp(s[0],s[1]);i=u*h}const c=Aae(t,o);return i*c}function Eae(s,e){switch(s){case Nn.PACKED_2X2_FLOAT32:return cD(e);case Nn.PACKED_2X2_FLOAT16:return uD(e);case Nn.UNPACKED_FLOAT32:return oD(e);case Nn.UNPACKED_FLOAT16:return iD(e);case Nn.PACKED_4X1_UNSIGNED_BYTE:return lD(e);default:throw new Error("Unknown physical texture type ".concat(s))}}function Dae(s){return Se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?s?Nn.PACKED_2X2_FLOAT32:Nn.UNPACKED_FLOAT32:s?Nn.PACKED_2X2_FLOAT16:Nn.UNPACKED_FLOAT16}function ej(s,e){if(s===Fa.UPLOAD)return Nn.PACKED_2X2_FLOAT32;if(s===Fa.RENDER||s==null)return Dae(e);if(s===Fa.DOWNLOAD||s===Fa.PIXELS)return Nn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(s))}function tj(s,e,t){return"".concat(s[0],"_").concat(s[1],"_").concat(e,"_").concat(t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yr{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const mr="if (isnan(x)) return x;",Rae="return x;",sj="return abs(x);",Oae="return (x >= 0.0) ? x : (exp(x) - 1.0);",_ae=mr+"\n  return (x < 0.0) ? 0.0 : x;\n",Fae=mr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",ji="return x;",Lae="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae="return x;",Pae="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",zae="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Bae="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Vae="return 1.0 / (1.0 + exp(-1.0 * x));";class Ii{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length);const t=e.length,n=Gn("rc",t),a=ss(t),o=kae(t,n),i=n.slice(-2),c=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(o,");\n\n        setOutput(getChannel(packedInput, ").concat(c,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae=Sv,Wae=1e-7,Hae=1e-4,bm={};function qae(s){return s in bm||(bm[s]={}),bm[s]}const Kae=Se().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Xae=600;function Yae(){return Se().global.screen==null?1024:Se().global.screen.height*Se().global.screen.width*window.devicePixelRatio*Xae/1024/1024}class Jx extends Fy{nextDataId(){return Jx.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Se().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof E1)t=e;else{const n=Er(Se().getNumber("WEBGL_VERSION"),e);t=new E1(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const n=Er(Se().getNumber("WEBGL_VERSION"));t=new E1(n),this.binaryCache=qae(Se().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $ae(this.gpgpu),this.numMBBeforeWarning=Yae(),this.texData=new Lj(this,Wr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,o,i){const c=this.makeTensorInfo(t,n),u=this.texData.get(c.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[a,o]},u.texShape=[a,o];const h=gm(t),p=new QC(h,!1,i),f=this.runWebGLProgram(p,[c],n,[[a,o]]);return f.shape=t,u.texture=null,this.disposeIntermediateTensorInfo(c),f.dataId}write(e,t,n){if((Se().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Se().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:Fa.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,n,a,o){if(Se().getBool("DEBUG")&&this.checkNumericalProblems(t),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:Fa.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:a,complexTensorInfos:o,slice:i,shape:c,isPacked:u}=t;if(i!=null){let g;u?g=new Ii(c,ji):g=new Yr(c,ji);const b=this.runWebGLProgram(g,[{dataId:e,shape:c,dtype:a}],a),y=this.readSync(b.dataId);return this.disposeIntermediateTensorInfo(b),y}if(n!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return n;const h=this.activeTimers!=null;let p;h&&(p=sa());let f;if(a==="complex64"){const g=this.readSync(o.real.dataId),b=this.readSync(o.imag.dataId);f=Lo(g,b)}else f=this.getValuesFromTexture(e);return h&&(this.downloadWaitMs+=sa()-p),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(w=>y.push(w))}const t=this.texData.get(e),{values:n,shape:a,slice:o,dtype:i,complexTensorInfos:c,isPacked:u}=t;if(o!=null){let y;u?y=new Ii(a,ji):y=new Yr(a,ji);const w=this.runWebGLProgram(y,[{dataId:e,shape:a,dtype:i}],i),v=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),v}if(n!=null)return this.convertAndCacheOnCPU(e);if(Se().getBool("DEBUG")&&!Se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Se().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let h=null,p;if(i!=="complex64"&&Se().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(e);const y=this.texData.get(p.dataId);h=this.gpgpu.createBufferFromTexture(y.texture.texture,...pm(a))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(i==="complex64"){const y=await Promise.all([this.read(c.real.dataId),this.read(c.imag.dataId)]),w=y[0],v=y[1];f=Lo(w,v)}else if(h==null)f=this.getValuesFromTexture(e);else{const y=Ae(a);f=this.gpgpu.downloadFloat32MatrixFromBuffer(h,y)}if(p!=null&&this.disposeIntermediateTensorInfo(p),h!=null){const y=this.gpgpu.gl;Ze(y,()=>y.deleteBuffer(h))}const g=this.convertAndCacheOnCPU(e,f),b=this.pendingRead.get(e);return this.pendingRead.delete(e),b.forEach(y=>y(g)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Wr().removeDataId(e,this),this.pendingDeletes--),g}readToGPU(e,t={}){const n=this.texData.get(e),{values:a,shape:o,slice:i,dtype:c,isPacked:u,texture:h}=n;if(c==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let b;u?b=new Ii(o,ji):b=new Yr(o,ji);const y=this.runWebGLProgram(b,[{dataId:e,shape:o,dtype:c}],c),w=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),w}if(h==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const p=this.decode(e,t.customTexShape),f=Wr().makeTensorFromTensorInfo(p),g=this.texData.get(p.dataId);return Object.assign({tensorRef:f},g.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const n=t.map(a=>Ri(a));return Dt(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Dt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const n=e[t];if(!Jte(n))throw Se().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value ".concat(n," cannot be represented on this device."))}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:a}=this.texData.get(e),o=Ae(t);if(Se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const g=this.decode(e),b=this.texData.get(g.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(b.texture.texture,...pm(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(g),y}const i=Se().getBool("WEBGL_PACK")&&a===!0,c=i?gm(t):t,u=i?new mne(c):new fne(c),h=this.runWebGLProgram(u,[{shape:c,dtype:n,dataId:e}],"float32"),p=this.texData.get(h.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(h),f}timerAvailable(){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();const o=Bl(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=Bl(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=t,a&&(this.programTimersStack=null);const c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(o);c.kernelMs=G8(u),c.getExtraProfileInfo=()=>u.map((h,p)=>({name:i[p],ms:h})).map(h=>"".concat(h.name,": ").concat(h.ms)).join(", ")}else c.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,c})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:sa(),endMs:null}}endTimer(e){return Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=sa(),e)}async getQueryTime(e){if(Se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:a,usage:o,isPacked:i,slice:c}=this.texData.get(e),u=c&&c.origDataId||e,h=this.dataRefCount.get(u);h>1?this.dataRefCount.set(u,h-1):(this.dataRefCount.delete(u),t!=null&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,o,i)));const p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Kae){return Se().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&Ae(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Oa("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Gae(e.shape,t)}packedUnaryOp(e,t,n){const a=new Ii(e.shape,t),o=this.compileAndRun(a,[e],n);return Wr().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=hD(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(Se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,sj,e.dtype);const t=new Yr(e.shape,sj),n=this.compileAndRun(t,[e]);return Wr().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if(t==="string"&&n!=null&&n.length>0&&Ih(n[0])){const o=n.map(i=>Ai(i));a=this.write(o,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return Wr().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Uae(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Tae(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[Tu(e.shape),...Iu(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},o=[Tu(t),...Iu(t)],i=new mD(o,n),c=!0,u=[n],h=this.runWebGLProgram(i,[a],e.dtype,u,c);return{dataId:h.dataId,shape:t,dtype:h.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:a,shape:o,dtype:i}=n;if(t!=null){const g=Ae(o),b=t[0]*t[1]*4;V(g<=b,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const c=gm(o);let u;a?u=new pne(c):u=new hne(c);const h=!0,p=[t!=null?t:pm(c)],f=this.runWebGLProgram(u,[{shape:c,dtype:i,dataId:e}],i,p,h,t);return{dtype:i,shape:o,dataId:f.dataId}}runWebGLProgram(e,t,n,a,o=!1,i){const c=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(c.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Sh.DENSE){const N=i!=null?i:pm(e.outputShape);u.texShape=N.map(C=>C*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),Ae(c.shape)===0)return u.values=Sn(c.dtype,0),c;const h=[],p=t.map(N=>{if(N.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(N.dataId);if(C.texture==null){if(!e.packedInputs&&Ae(N.shape)<=Se().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:N.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=N.shape)}if(this.uploadToGPU(N.dataId),!!C.isPacked!=!!e.packedInputs)N=C.isPacked?this.unpackTensor(N):this.packTensor(N),h.push(N),C=this.texData.get(N.dataId);else if(C.isPacked&&!ng(C.shape,N.shape)){const T=N,I=N.shape;N.shape=C.shape,N=this.packedReshape(N,I),h.push(N),C=this.texData.get(N.dataId),T.shape=I}return{shape:N.shape,texData:C,isUniform:!1}});this.uploadToGPU(c.dataId);const f={shape:c.shape,texData:u,isUniform:!1},g=dne(e,p,f),b=this.getAndSaveBinary(g,()=>cne(this.gpgpu,e,p,f)),y=this.activeTimers!=null;let w;y&&(w=this.startTimer()),Se().get("ENGINE_COMPILE_ONLY")||une(this.gpgpu,b,p,f,a),h.forEach(N=>this.disposeIntermediateTensorInfo(N)),y&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const v=Se().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const N=sa();N-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=N)}if(!Se().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){const N=this.unpackTensor(c);return this.disposeIntermediateTensorInfo(c),N}return c}compileAndRun(e,t,n,a,o=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,a,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Se().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=me(()=>{if(!Se().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Se().getBool("DEBUG");Se().set("DEBUG",!1);const t=this.abs(gt(1e-8)).dataSync()[0];if(Se().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Wae:Hae}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:a,values:o,texture:i,usage:c,isPacked:u}=t;if(i!=null)return;const h=this.activeTimers!=null;let p;h&&(p=sa());let f=t.texShape;if(f==null&&(f=xse(n,u),t.texShape=f),o!=null){const g=gm(n);let b,y=f[1],w=f[0];const v=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(u||!v)&&([y,w]=zu(f[0],f[1])),u?b=new xne(g,v):b=new QC(g,v);const N=v?[w,y]:f,C=this.makeTensorInfo(N,a),T=this.texData.get(C.dataId);v?T.usage=Fa.PIXELS:T.usage=Fa.UPLOAD,T.texShape=N,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),y,w,o);const I=[[w,y]],R=this.runWebGLProgram(b,[C],a,I,!0),O=this.texData.get(R.dataId);t.texShape=O.texShape,t.isPacked=O.isPacked,t.usage=O.usage,Se().get("ENGINE_COMPILE_ONLY")?this.disposeData(R.dataId):(t.texture=O.texture,t.values=null,this.texData.delete(R.dataId)),this.disposeIntermediateTensorInfo(C),h&&(this.uploadWaitMs+=sa()-p)}else{const g=this.acquireTexture(f,c,a,u);t.texture=g}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:a}=n;return t!=null&&(n.values=Zae(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(o," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*Em(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(a=>{try{this.checkCompletion_(t),a(!0)}catch(o){throw o}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await YT(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(eD(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:c,outTexShapeLocation:u}=rD(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:a,height:o,width:i,channels:c}=e,u=Wr().backend;if(!u.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const h=u.writeTexture(a,t,n,o,i,c);return Wr().makeTensorFromDataId(h,t,n,u)}}Jx.nextDataId=0;function Zae(s,e){if(e==="float32"||e==="complex64")return s;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(s.length):new Uint8Array(s.length);for(let n=0;n<t.length;++n)t[n]=Math.round(s[n]);return t}else throw new Error("Unknown dtype ".concat(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ak()&&ik("webgl",()=>new Jx,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bw="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Jl{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=Tt(t,n),this.enableShapeUniforms=_n(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lc="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Wu{constructor(e,t,n,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Tt(t,n);const o=this.outputShape.length;this.enableShapeUniforms=_n(o);let i="";if(a)if(o===0||Ae(this.outputShape)===1)i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const c=ss(o);if(i="\n          ".concat(c," coords = getOutputCoords();\n        "),o===1)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const u=Gn("coords",o);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= outShape[").concat(o," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= outShape[").concat(o," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(s){const{inputs:e,backend:t}=s,{x:n}=e;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const Qae={kernelName:Xh,backendName:"webgl",kernelFunc:Ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(s){const{inputs:e,backend:t}=s,{real:n,imag:a}=e,o=t.makeTensorInfo(n.shape,"complex64"),i=t.texData.get(o.dataId),c=Ca({inputs:{x:n},backend:t}),u=Ca({inputs:{x:a},backend:t});return i.complexTensorInfos={real:c,imag:u},o}const Jae={kernelName:Hy,backendName:"webgl",kernelFunc:tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gD="return (a < 0.) ? b * a : a;",xD="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function ere(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{alpha:o}=n,i=t.makeTensorInfo([],"float32",Wi(o,"float32")),c=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(xD,a.shape,i.shape):new Jl(gD,a.shape,i.shape),u=t.runWebGLProgram(c,[a,i],"float32");return t.disposeIntermediateTensorInfo(i),u}const tre={kernelName:Dg,backendName:"webgl",kernelFunc:ere};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bD="return (a < 0.) ? b * a : a;",yD="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";function sre(s){const{inputs:e,backend:t}=s,{x:n,alpha:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(yD,n.shape,a.shape):new Jl(bD,n.shape,a.shape);return t.runWebGLProgram(o,[n,a],"float32")}const nre={kernelName:Zg,backendName:"webgl",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hu="if (isnan(x)) return x;";function Gt({opSnippet:s,packedOpSnippet:e,cpuKernelImpl:t,dtype:n}){return({inputs:a,backend:o})=>{const{x:i}=a,c=o,u=n||i.dtype;if(c.shouldExecuteOnCPU([i])&&t!=null){const f=c.texData.get(i.dataId),g=t(f.values,u);return c.makeTensorInfo(i.shape,u,g)}const h=Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let p;return h?p=new Ii(i.shape,e):p=new Yr(i.shape,s),c.runWebGLProgram(p,[i],u)}}function In({opSnippet:s,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:n=!1,cpuKernelImpl:a,dtype:o}){return({inputs:i,backend:c})=>{const{a:u,b:h}=i,p=c;if(n&&u.dtype==="complex64"){const y=p.texData.get(u.dataId),w=p.texData.get(h.dataId),[v,N]=[[y.complexTensorInfos.real,w.complexTensorInfos.real],[y.complexTensorInfos.imag,w.complexTensorInfos.imag]].map(T=>{const[I,$]=T,R={dataId:I.dataId,dtype:I.dtype,shape:u.shape},O={dataId:$.dataId,dtype:$.dtype,shape:h.shape},P=new Jl(s,u.shape,h.shape);return p.runWebGLProgram(P,[R,O],wa(I.dtype,$.dtype))}),C=tl({inputs:{real:v,imag:N},backend:p});return p.disposeIntermediateTensorInfo(v),p.disposeIntermediateTensorInfo(N),C}const f=o||wa(u.dtype,h.dtype);if((u.dtype==="string"||h.dtype==="string"||p.shouldExecuteOnCPU([u,h]))&&a!=null){const y=p.texData.get(u.dataId).values,w=p.texData.get(h.dataId).values,v=u.dtype==="string"?Mo(y):y,N=u.dtype==="string"?Mo(w):w,[C,T]=a(u.shape,h.shape,v,N,f),I=p.makeTensorInfo(T,f),$=p.texData.get(I.dataId);return $.values=C,I}const g=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let b;return g?b=new Wu(e,u.shape,h.shape,t):b=new Jl(s,u.shape,h.shape),p.runWebGLProgram(b,[u,h],f)}}function Ch(s,e=!1){if(s==="linear")return e?Mae:Rae;if(s==="relu")return e?zae:_ae;if(s==="elu")return e?Pae:Oae;if(s==="relu6")return e?Bae:Fae;if(s==="prelu")return e?yD:bD;if(s==="leakyrelu")return e?xD:gD;if(s==="sigmoid")return e?Vae:Lae;throw new Error("Activation ".concat(s," has not been implemented for the WebGL backend."))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vD{constructor(e,t,n,a=!1,o=!1,i=!1,c=null,u=!1,h=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=_n(this.outputShape.length);const p=a?e[1]:e[2],f=Math.ceil(p/2),g=a?"i * 2, rc.y":"rc.y, i * 2",b=o?"rc.z, i * 2":"i * 2, rc.z",y=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",N="";c&&(u?v="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(c,"\n        }"):h?v="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(c,"\n        }"):v="vec4 activation(vec4 x) {\n          ".concat(c,"\n        }"),N="result = activation(result);");const C=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha");let T="rc.x",I="rc.x";e[0]<t[0]?T="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(I="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(v,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(T,";\n        int batchB = ").concat(I,";\n        for (int i = 0; i < ").concat(f,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(g,");\n          vec4 b = getMatrixB(batchB, ").concat(b,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(y[0]," * ").concat(w[0],");\n          result += (").concat(y[1]," * ").concat(w[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(C,"\n\n        ").concat(N,"\n\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nj={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class aj{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Tt(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rj="return a * b;";function Vw(s){const{inputs:e,backend:t}=s,{a:n,b:a}=e,o=wa(n.dtype,a.dtype);if(n.dtype==="complex64"){const c=t.texData.get(n.dataId),u=t.texData.get(a.dataId),h=new aj(nj.REAL,n.shape,a.shape),p=new aj(nj.IMAG,n.shape,a.shape),f=[{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:n.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape}],g=t.runWebGLProgram(h,f,"float32"),b=t.runWebGLProgram(p,f,"float32"),y=tl({inputs:{real:g,imag:b},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),y}if(t.shouldExecuteOnCPU([n,a])){const c=t.texData.get(n.dataId),u=t.texData.get(a.dataId),[h,p]=sae(n.shape,a.shape,c.values,u.values,o),f=t.makeTensorInfo(p,o),g=t.texData.get(f.dataId);return g.values=h,f}let i;return Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Wu(rj,n.shape,a.shape):i=new Jl(rj,n.shape,a.shape),t.runWebGLProgram(i,[n,a],o)}const are={kernelName:ap,backendName:"webgl",kernelFunc:Vw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(s,e,t){const n=[Tu(s.shape),...Iu(s.shape)],a={dtype:s.dtype,shape:n,dataId:s.dataId},o=[Tu(e),...Iu(e)],i=new mD(o,n),c=!0,u=[n],h=t.runWebGLProgram(i,[a],s.dtype,u,c);return{dataId:h.dataId,shape:e,dtype:h.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ye(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{shape:o}=n,i=t,c=Ae(a.shape),u=Mj(o,c),h=Ae(u);V(c===h,()=>"The new shape (".concat(u,") has ").concat(h," elements and the old ")+"shape (".concat(a.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements.");const p=i.texData.get(a.dataId);return p.isPacked&&!ng(a.shape,u)&&!(p.texture!==null&&ng(p.shape,u))?rre(a,u,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype})}const ore={kernelName:Jg,backendName:"webgl",kernelFunc:Ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oj{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:o,outSize:i}=e;this.outputShape=[a,i];const c=Math.floor(n/4)*4,u=n%4;let h="sumValue += dot(values, ones);";if(t!=null){const f=1/t;h="sumValue += dot(values * ".concat(xu(f)?f.toPrecision(2):f,", ones);")}let p="";o%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(u===1,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(h,"\n        } else if (").concat(u===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(h,"\n        } else if (").concat(u===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(h,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ire{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:o,outSize:i}=e;this.outputShape=[a,i];let c="0.0",u="";t==="prod"?c="1.0":t==="min"?(c="1.0 / 1e-20",u="min"):t==="max"&&(c="-1.0 / 1e-20",u="max");let h="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?h="sumValue":t==="prod"?h="prodValue":t==="all"?h="allValue":t==="any"&&(h="anyValue");const p=Math.floor(n/4)*4,f=n%4;let g="\n      if (".concat(t==="sum",") {\n        sumValue += dot(values, ones);\n      } else if (").concat(t==="prod",") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat(t==="min"," || ").concat(t==="max",") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),b="vec4";t==="all"?(c="1.0",g="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",b="bvec4"):t==="any"&&(c="0.0",g="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",b="bvec4");let y="";o%n>0&&(y="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(c,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(y,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(c,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(p,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(g,"\n        }\n\n        int inIdx = inOffset + ").concat(p,";\n        if (").concat(f===1,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===2,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===3,") {\n          ").concat(b," values = ").concat(b,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(g,"\n        }\n        setOutput(").concat(h,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(s){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:s[1],n=Lx(t);e.push({inSize:t,windowSize:n,outSize:Math.ceil(t/n)})}return e}function cc(s,e,t,n){const a=lre(s.shape);let o=s;for(let i=0;i<a.length;i++){const{inSize:c,windowSize:u,outSize:h}=a[i];let p,f;t==="mean"?p=i===0?new oj({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h},c):new oj({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h}):p=new ire({windowSize:u,inSize:c,batchSize:s.shape[0],outSize:h},t),f=o,o=n.runWebGLProgram(p,[o],e),f.dataId!==s.dataId&&n.disposeIntermediateTensorInfo(f)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cre{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;const a=ss(this.rank),o=ure(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}}function ure(s){const e=s.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(e);for(let a=0;a<s.length;a++)n[s[a]]=t[a];return n.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dre{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let p=0;p<n.length;p++)n[p]=e[t[p]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const a=ss(this.rank),o=fD("rc",this.rank),i=new Array(this.rank);for(let p=0;p<t.length;p++)i[t[p]]=o[p];const c="vec2(".concat(i.slice(-2).join(),")"),u="++".concat(o[this.rank-1]," < ").concat(n[this.rank-1]),h="getChannel(getA(".concat(i.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(u,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(u,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0(s,e,t){const n=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dre(s.shape,e):new cre(s.shape,e);return t.runWebGLProgram(n,[s],s.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(s,e,t,n){const a=e,o=s.shape.length,i=Rt(a,s.shape);let c=i;const u=ws(c,o),h=u!=null;let p=s;h&&(p=e0(s,u,n),c=Fs(c.length,o)),kn("sum",c,o);const[f,g]=gn(p.shape,c);let b=f;t&&(b=_s(f,i));const y=Ae(g),v=Ae(s.shape)/y,N=Ye({inputs:{x:p},attrs:{shape:[v,y]},backend:n}),C=G2(s.dtype),T=cc(N,C,"sum",n),I=Ye({inputs:{x:T},attrs:{shape:b},backend:n});return n.disposeIntermediateTensorInfo(N),n.disposeIntermediateTensorInfo(T),h&&n.disposeIntermediateTensorInfo(p),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n;return hre(a,o,i,t)}const pre={kernelName:rx,backendName:"webgl",kernelFunc:t0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{perm:o}=n,i=t,c=a.shape.length,u=new Array(c);for(let p=0;p<u.length;p++)u[p]=a.shape[o[p]];let h;if(i.shouldExecuteOnCPU([a])){const f=i.texData.get(a.dataId).values,g=zw(f,a.shape,a.dtype,o,u);h=i.makeTensorInfo(u,a.dtype);const b=i.texData.get(h.dataId);b.values=g}else h=e0(a,o,i);return h}const fre={kernelName:du,backendName:"webgl",kernelFunc:Hn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wD=1e3;function ag({a:s,b:e,transposeA:t,transposeB:n,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:c=0,activation:u=null}){const h=s.shape.length,p=e.shape.length,f=t?s.shape[h-2]:s.shape[h-1],g=n?e.shape[p-1]:e.shape[p-2],b=t?s.shape[h-1]:s.shape[h-2],y=n?e.shape[p-2]:e.shape[p-1],w=s.shape.slice(0,-2),v=e.shape.slice(0,-2),N=Ae(w),C=Ae(v),I=Tt(s.shape.slice(0,-2),e.shape.slice(0,-2)).concat([b,y]);V(f===g,()=>"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(g,") of Tensors with shapes ").concat(s.shape," and ")+"".concat(e.shape," and transposeA=").concat(t)+" and transposeB=".concat(n," must match."));const $=t?[N,f,b]:[N,b,f],R=n?[C,y,g]:[C,g,y],O=Ye({inputs:{x:s},backend:a,attrs:{shape:$}}),P=Ye({inputs:{x:e},backend:a,attrs:{shape:R}}),_=[O,P],M=Math.max(N,C),A=t?O.shape[1]:O.shape[2],U=o!=null,K=i!=null,Q=u==="leakyrelu",X=u!=null?Ch(u,!0):null,B=U||K||Q||X!=null;let G;if((b===1||y===1)&&A>wD&&B===!1){let Z=O,J=P;t&&(Z=Hn({inputs:{x:O},backend:a,attrs:{perm:[0,2,1]}}),_.push(Z)),n&&(J=Hn({inputs:{x:P},backend:a,attrs:{perm:[0,2,1]}}),_.push(J));const xe=y!==1,ye=y===1;let ve=Z;xe&&(ve=Ye({inputs:{x:Z},backend:a,attrs:{shape:[M,A,1]}}),_.push(ve));const Re=y===1?2:1;let Ce=J;ye&&(Ce=Ye({inputs:{x:J},backend:a,attrs:{shape:[M,1,A]}}),_.push(Ce));const pe=Vw({inputs:{a:ve,b:Ce},backend:a});G=t0({inputs:{x:pe},backend:a,attrs:{axis:Re,keepDims:!0}}),_.push(pe)}else{const Z=wa(s.dtype,e.dtype),J=new vD($,R,[M,b,y],t,n,U,X,K,Q),xe=[O,P];if(o!=null&&xe.push(o),K&&xe.push(i),Q){const ye=a.makeTensorInfo([],"float32",Wi(c,"float32"));xe.push(ye),_.push(ye)}G=a.runWebGLProgram(J,xe,Z)}const Y=Ye({inputs:{x:G},backend:a,attrs:{shape:I}});_.push(G);for(const Z of _)a.disposeIntermediateTensorInfo(Z);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o,bias:i,preluActivationWeights:c}=e,{transposeA:u,transposeB:h,activation:p,leakyreluAlpha:f}=n;return ag({a,b:o,transposeA:u,transposeB:h,backend:t,bias:i,preluActivationWeights:c,leakyreluAlpha:f,activation:p})}const gre={kernelName:Dm,backendName:"webgl",kernelFunc:mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ij="return abs(x);";function xre(s){const{inputs:e,backend:t}=s,{x:n}=e;if(t.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){const o=t.texData.get(n.dataId),i=hD(o.values);return t.makeTensorInfo(n.shape,n.dtype,i)}let a;return Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ii(n.shape,ij):a=new Yr(n.shape,ij),t.runWebGLProgram(a,[n],n.dtype)}const bre={kernelName:ug,backendName:"webgl",kernelFunc:xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre=mr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",vre=Gt({opSnippet:yre}),wre={kernelName:$h,backendName:"webgl",kernelFunc:vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre=mr+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",Sre=Gt({opSnippet:Nre}),Cre={kernelName:Ah,backendName:"webgl",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj="return a + b;",jre=In({opSnippet:lj,packedOpSnippet:lj,supportsComplex:!0,cpuKernelImpl:_ne}),kre={kernelName:Ru,backendName:"webgl",kernelFunc:jre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tre{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,i)=>"T".concat(i));const n=[];this.variableNames.forEach(o=>{n.push("float v".concat(o," = get").concat(o,"AtOutCoords();"))});const a=this.variableNames.map(o=>"v".concat(o)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ire{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,i)=>"T".concat(i));const n=[];this.variableNames.forEach(o=>{n.push("vec4 v".concat(o," = get").concat(o,"AtOutCoords();"))});const a=this.variableNames.map(o=>"v".concat(o)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Am(s){const{inputs:e,backend:t}=s,n=e;if(n.length===1)return Ca({inputs:{x:n[0]},backend:t});if(n.length>Se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(n.length/2),h=Am({inputs:n.slice(0,u),backend:t}),p=Am({inputs:n.slice(u),backend:t});return Am({inputs:[h,p],backend:t})}const a=n.map(u=>u.dtype).reduce((u,h)=>wa(u,h)),o=n.map(u=>u.shape),c=Se().getBool("WEBGL_PACK")?new Ire(n[0].shape,o):new Tre(n[0].shape,o);return t.runWebGLProgram(c,n,a)}const $re={kernelName:dg,backendName:"webgl",kernelFunc:Am};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=Rt(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Hn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=Fs(h.length,c)),kn("all",h,c);const[g,b]=gn(f.shape,h),y=Ae(b),w=Ye({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=cc(w,w.dtype,"all",t);let N;if(i){const C=_s(g,u);N=Ye({inputs:{x:v},backend:t,attrs:{shape:C}})}else N=Ye({inputs:{x:v},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(v),p!=null&&t.disposeIntermediateTensorInfo(f),N}const Ere={kernelName:zy,backendName:"webgl",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=Rt(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Hn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=Fs(h.length,c)),kn("any",h,c);const[g,b]=gn(f.shape,h),y=Ae(b),w=Ye({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=cc(w,w.dtype,"any",t);let N;if(i){const C=_s(g,u);N=Ye({inputs:{x:v},backend:t,attrs:{shape:C}})}else N=Ye({inputs:{x:v},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(v),p!=null&&t.disposeIntermediateTensorInfo(f),N}const Rre={kernelName:By,backendName:"webgl",kernelFunc:Dre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ore{constructor(e,t,n){this.variableNames=["A"];const{windowSize:a,batchSize:o,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const c=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(c," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _re{constructor(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,V(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");const c=this.outputShape,u=c.length,h=ss(u),p=Gn("coords",u);let f,g;if(i===1){g=u+1;const P=ss(g);f="\n        ".concat(P," sourceLocR = ").concat(P,"(").concat(p.join(),", 0);\n        ++").concat(p[u-1],";\n        ").concat(P," sourceLocG = ").concat(P,"(").concat(p.join(),", 0);\n        ++").concat(p[u-2],";\n        ").concat(P," sourceLocA = ").concat(P,"(").concat(p.join(),", 0);\n        --").concat(p[u-1],";\n        ").concat(P," sourceLocB = ").concat(P,"(").concat(p.join(),", 0);\n        --").concat(p[u-2],";")}else g=u,f="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(p[u-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(p[u-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(p[u-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(p[u-2],";");const b=["x","y","z","w","u","v"].slice(0,g),y="."+b[g-1],w=b.map(P=>"int "+P),v=Gn("sourceLocR",g-1).concat("inIdx.r"),N=Gn("sourceLocG",g-1).concat("inIdx.g"),C=Gn("sourceLocB",g-1).concat("inIdx.b"),T=Gn("sourceLocA",g-1).concat("inIdx.a"),I=n==="max"?"greaterThan":"lessThan",$=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(N.join(),"),\n                             getBestIndicesAChannel(").concat(C.join(),"),\n                             getBestIndicesAChannel(").concat(T.join(),")));"),R="vec4(\n            getAChannel(".concat(v.join(),"),\n            hasNextCol ? getAChannel(").concat(N.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(C.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(T.join(),") : 0.)"),O=a?"":"\n      float getBestIndicesAChannel(".concat(w.join(),") {\n        return getChannel(getBestIndicesA(").concat(b.join(),"),\n                                          vec2(").concat(b.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(w.join(),") {\n        return getChannel(getA(").concat(b.join(),"),\n                               vec2(").concat(b.slice(-2).join(),"));\n      }\n      ").concat(O,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[u-1]," < ").concat(c[u-1]-1,";\n        bool hasNextRow = ").concat(p[u-2]," < ").concat(c[u-2]-1,";\n        ").concat(f,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(y,", sourceLocG").concat(y,",\n          sourceLocB").concat(y,", sourceLocA").concat(y,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(R,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat($,"\n          vec4 candidate = ").concat(R,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(I,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(s,e,t,n=null){let a=e.shape[0],o=e.shape[1];n!=null&&(a=n.shape[0],o=n.shape[1]);const i=Lx(o),c={windowSize:i,inSize:o,batchSize:a,outSize:Math.ceil(o/i)},u=new Ore(c,t,n==null),h=[e];n!=null&&h.push(n);const p=s.runWebGLProgram(u,h,"int32");if(p.shape[1]===1)return p;const f=ND(s,e,t,p);return s.disposeIntermediateTensorInfo(p),f}function SD(s,e,t,n=null){const a=n!=null?n.shape:e.shape,o=a[a.length-1],i=Lx(o),c=new _re(a,i,t,n==null),u=n==null?[e]:[e,n],h=s.runWebGLProgram(c,u,"int32");if(h.shape.length===e.shape.length){const p=SD(s,e,t,h);return s.disposeIntermediateTensorInfo(h),p}return h}function CD(s,e,t,n){const a=[t];if(kn("arg"+n.charAt(0).toUpperCase()+n.slice(1),a,e.shape.length),!Se().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=s.texData.get(e.dataId),c=i!==null&&i.isPacked;let u=e;c&&(u=s.unpackTensor(e),o.push(u));const[h,p]=gn(u.shape,a),f=Ae(p),g=Ye({inputs:{x:u},backend:s,attrs:{shape:[-1,f]}});o.push(g);const b=ND(s,g,n);o.push(b);const y=Ye({inputs:{x:b},backend:s,attrs:{shape:h}});return o.forEach(w=>s.disposeIntermediateTensorInfo(w)),y}return SD(s,e,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;let i=Rt(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=Hn({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=Fs(i.length,u.shape.length)),kn("argMax",[i[0]],u.shape.length);const p=CD(t,u,i[0],"max");return h.forEach(f=>t.disposeIntermediateTensorInfo(f)),p}const Lre={kernelName:hg,backendName:"webgl",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o}=n;let i=Rt(o,a.shape);const c=ws(i,a.shape.length);let u=a;const h=[];c!=null&&(u=Hn({inputs:{x:a},backend:t,attrs:{perm:c}}),h.push(u),i=Fs(i.length,u.shape.length)),kn("argMin",[i[0]],u.shape.length);const p=CD(t,u,i[0],"min");return h.forEach(f=>t.disposeIntermediateTensorInfo(f)),p}const Pre={kernelName:pg,backendName:"webgl",kernelFunc:Mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zre=mr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",Bre=Gt({opSnippet:zre}),Vre={kernelName:Eh,backendName:"webgl",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure=mr+"return log(x + sqrt(x * x + 1.0));",Gre=Gt({opSnippet:Ure}),Wre={kernelName:Dh,backendName:"webgl",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre=mr+"\n  return atan(x);\n",qre=Gt({opSnippet:Hre}),Kre={kernelName:Rh,backendName:"webgl",kernelFunc:qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xre=Bw+"\n  return atan(a, b);\n",Yre="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",Zre=In({opSnippet:Xre,packedOpSnippet:Yre}),Qre={kernelName:_h,backendName:"webgl",kernelFunc:Zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre=mr+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",eoe=Gt({opSnippet:Jre}),toe={kernelName:Oh,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jh{constructor(e,t,n,a=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,c=e.strideHeight,u=e.strideWidth,h=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,b=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",v="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),N="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let C="0.0";if(w||(C="-1.0 / 1e-20"),n){const P=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(b,", ").concat(y,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(g,";\n                wC += ").concat(p,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(P," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?o?v:N:"wR * ".concat(g," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}const T="max";let I="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(I="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,R=i%4,O="\n      if (".concat(w,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(T,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(b,", ").concat(y,");\n      const float initializationValue = ").concat(C,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(C,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(h,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat($,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              getValue(batch, xR, xC + 2 * ").concat(p,", d),\n              getValue(batch, xR, xC + 3 * ").concat(p,", d)\n            );\n\n            ").concat(O,"\n          }\n\n          int xC = xCCorner + ").concat($,";\n          if (").concat(R===1,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(O,"\n          } else if (").concat(R===2,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(O,"\n          } else if (").concat(R===3,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(p,", d),\n              getValue(batch, xR, xC + 2 * ").concat(p,", d),\n              initializationValue\n            );\n\n            ").concat(O,"\n          }\n        }\n        setOutput(").concat(I,");\n      }\n    ")}}class Uw{constructor(e,t,n,a=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,c=e.strideDepth,u=e.strideHeight,h=e.strideWidth,p=e.dilationDepth,f=e.dilationHeight,g=e.dilationWidth,b=e.effectiveFilterDepth,y=e.effectiveFilterHeight,w=e.effectiveFilterWidth,v=e.padInfo.front,N=e.padInfo.top,C=e.padInfo.left;this.outputShape=e.outShape;const T=t==="avg";let I="0.0";if(T||(I="-1.0 / 1e-20"),n){const M=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(c,", ").concat(u,", ").concat(h,");\n        const ivec3 pads = ivec3(").concat(v,", ").concat(N,", ").concat(C,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(b,";\n              wD += ").concat(p,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(y,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(w,";\n                  wC += ").concat(g,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(M," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?o?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(y," * ").concat(w," +\n                      wR * ").concat(w," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}const $="max";let R="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(R="avgValue / max(count, 1.0)");const O=Math.floor(i/4)*4,P=i%4,_="\n      if (".concat(T,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat($,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(c,", ").concat(u,", ").concat(h,");\n      const ivec3 pads = ivec3(").concat(v,", ").concat(N,", ").concat(C,");\n      const float initializationValue = ").concat(I,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(I,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(b,";\n            wD += ").concat(p,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(y,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(O,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(g,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(g,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(O,";\n            if (").concat(P===1,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(P===2,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(P===3,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(g,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(g,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n        }\n        setOutput(").concat(R,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;Wp(a,"avgPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(jn(i,h),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=pr(a.shape,o,i,h,c,u);if(p.filterWidth===1&&p.filterHeight===1&&zt(p.inShape,p.outShape))return Ca({inputs:{x:a},backend:t});const f=new jh(p,"avg",!1);return t.runWebGLProgram(f,[a],"float32")}const noe={kernelName:fg,backendName:"webgl",kernelFunc:soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dimRoundingMode:u,dataFormat:h}=n,p=[1,1,1],f=Uo(a.shape,o,i,p,c,u,h),g=new Uw(f,"avg",!1);return t.runWebGLProgram(g,[a],"float32")}const roe={kernelName:mg,backendName:"webgl",kernelFunc:aoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ooe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.top,f=h-1-e.padInfo.left,g=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(p,", ").concat(f,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(h,";\n            wC+= ").concat(c,") {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class ioe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,g=e.effectiveFilterHeight,b=e.effectiveFilterWidth,y=f-1-e.padInfo.front,w=g-1-e.padInfo.top,v=b-1-e.padInfo.left,N=1/(t*n*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(y,", ").concat(w,", ").concat(v,");\n      const float avgMultiplier = float(").concat(N,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(o,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(g,";\n              wR += ").concat(h,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(b,";\n                wC += ").concat(p,") {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o,{filterSize:c,strides:u,pad:h,dimRoundingMode:p}=n,f=[1,1,1],g=Uo(i.shape,c,u,f,h,p),b=new ioe(g);return t.runWebGLProgram(b,[a],i.dtype)}const coe={kernelName:Uy,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o;Wp([a,o],"avgPoolGrad");const{filterSize:c,strides:u,pad:h}=n,p=pr(i.shape,c,u,1,h),f=new ooe(p);return t.runWebGLProgram(f,[a],i.dtype)}const doe={kernelName:Vy,backendName:"webgl",kernelFunc:uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(s){const{inputs:e,backend:t,attrs:n}=s,{a,b:o}=e,{transposeA:i,transposeB:c}=n;return ag({a,b:o,transposeA:i,transposeB:c,backend:t})}const poe={kernelName:gg,backendName:"webgl",kernelFunc:hoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class foe{constructor(e,t,n,a,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Tt(e,t),Tt(e,n);let c="0.0";a!=null&&(Tt(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");let u="1.0";o!=null&&(Tt(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(c,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class moe{constructor(e,t,n,a,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Tt(e,t),Tt(e,n);let c="vec4(0.0)";a!=null&&(Tt(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");let u="vec4(1.0)";o!=null&&(Tt(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(c,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe=({inputs:s,backend:e,attrs:t})=>{const{x:n,mean:a,variance:o,offset:i,scale:c}=s;V(a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(c==null||a.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=t;u==null&&(u=.001);const h=[n,a,o];let p=null;i!=null&&(p=i.shape,h.push(i));let f=null;c!=null&&(f=c.shape,h.push(c));const g=Se().getBool("WEBGL_PACK_NORMALIZATION")?new moe(n.shape,a.shape,o.shape,p,f,u):new foe(n.shape,a.shape,o.shape,p,f,u);return e.runWebGLProgram(g,h,h[0].dtype)},xoe={kernelName:$g,backendName:"webgl",kernelFunc:goe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class boe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=ss(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=yoe(this.rank);let a;const o=e.map((i,c)=>"sourceLoc.".concat($y[c]," = start[").concat(c,"] + coords.").concat($y[c],";"));a="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(a,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const $y=["x","y","z","w","u","v"];function yoe(s){if(s===1)return"sourceLoc";if(s<=6)return $y.slice(0,s).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(s," is not yet supported"))}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class voe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=ss(this.rank),n=Gn("coords",this.rank),a=Gn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(o,")"),c="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=this.rank===1?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),h=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((p,f)=>"start[".concat(f,"]")).join(),");"):e.map((p,f)=>"".concat(a[f]," = ").concat(n[f]," + start[").concat(f,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(h,"\n        vec4 result = vec4(0.);\n        ").concat(c,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(s,e,t,n){const a=n.texData.get(s.dataId),o=n.makeTensorInfo(t,s.dtype),i=n.texData.get(o.dataId);Object.assign(i,a),i.refCount=1,i.shape=t,i.dtype=s.dtype;let c=Lv(e,ft(s.shape));a.slice&&(c+=a.slice.flatOffset),i.slice={flatOffset:c,origDataId:a.slice&&a.slice.origDataId||s.dataId};const u=n.dataRefCount.get(i.slice.origDataId)||1;return n.dataRefCount.set(i.slice.origDataId,u+1),o}function qu(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,size:i}=n,[c,u]=Fx(a,o,i);if(Ov(a,c,u),Ae(u)===0)return t.makeTensorInfo(u,a.dtype,[]);if(t.shouldExecuteOnCPU([a])||a.dtype==="string"){const f=t.texData.get(a.dataId),g=pae(f.values,c,u,a.shape,a.dtype);return t.makeTensorInfo(u,a.dtype,g)}const{isPacked:h}=t.texData.get(a.dataId),p=Fv(a.shape,c,u);if(h||!p){const f=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new voe(u):new boe(u),g=[c];return t.runWebGLProgram(f,[a],a.dtype,g)}return t.uploadToGPU(a.dataId),woe(a,c,u,t)}const Noe={kernelName:ax,backendName:"webgl",kernelFunc:qu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Soe=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,crops:i}=n;V(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const c=o.reduce((C,T)=>C*T),u=Dp(a.shape,o,c),h=Rp(u.length,o.length),p=Op(a.shape,o,c),f=Vv(i,o.length),g=Uv(p,i,o.length),b=[],y=Ye({inputs:{x:a},backend:t,attrs:{shape:u}}),w=Hn({inputs:{x:y},backend:t,attrs:{perm:h}}),v=Ye({inputs:{x:w},backend:t,attrs:{shape:p}}),N=qu({inputs:{x:v},backend:t,attrs:{begin:f,size:g}});return b.push(y),b.push(w),b.push(v),b.forEach(C=>t.disposeIntermediateTensorInfo(C)),N},Coe={kernelName:xg,backendName:"webgl",kernelFunc:Soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i}=n,c=t.readSync(a.dataId),u=t.readSync(o.dataId),h=dD(c,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}const koe={kernelName:Gy,backendName:"webgl",kernelFunc:joe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Toe="\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",Ioe="\n  return float(int(a.r) & int(b.r));\n";function $oe(s){const{inputs:e,backend:t}=s,{a:n,b:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=Se().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([n,a])||i===1){const u=t.texData.get(n.dataId).values,h=t.texData.get(a.dataId).values,[p,f]=Lne(n.shape,a.shape,u,h,n.dtype),g=t.makeTensorInfo(f,n.dtype),b=t.texData.get(g.dataId);return b.values=p,g}let c;return o?c=new Wu(Toe,n.shape,a.shape,!1):c=new Jl(Ioe,n.shape,a.shape),t.runWebGLProgram(c,[n,a],n.dtype)}const Aoe={kernelName:bg,backendName:"webgl",kernelFunc:$oe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(s){const{inputs:e,backend:t}=s,{s0:n,s1:a}=e,o=t.readSync(n.dataId),i=t.readSync(a.dataId),c=Tt(Array.from(o),Array.from(i));return t.makeTensorInfo([c.length],"int32",Int32Array.from(c))}const Doe={kernelName:Wy,backendName:"webgl",kernelFunc:Eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Roe="return float(a != b);",jD=In({opSnippet:Roe,cpuKernelImpl:aae,dtype:"bool"}),Ooe={kernelName:Hg,backendName:"webgl",kernelFunc:jD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.texData.get(n.dataId);return Ca({inputs:{x:a.complexTensorInfos.real},backend:t})}const _oe={kernelName:C2,backendName:"webgl",kernelFunc:qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe="return float(int(x));";function Loe(s,e){const t=new Yr(s.shape,Foe),n=e.runWebGLProgram(t,[s],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dtype:o}=n;if(o==="complex64"){if(a.dtype==="complex64")return Ca({inputs:{x:a},backend:t});const i=Ys(a.shape),c=Ay({inputs:{x:a},backend:t,attrs:{dtype:"float32"}}),u=tl({inputs:{real:c,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(c),u}if(a.dtype==="complex64"){const i=qp({inputs:{input:a},backend:t}),c=Ay({inputs:{x:i},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(i),c}if(!Pj(a.dtype,o)){const i=Ca({inputs:{x:a},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(t.shouldExecuteOnCPU([a])){const i=t.texData.get(a.dataId).values,[c,u,h]=Mne(i,a.shape,a.dtype,o);return t.makeTensorInfo(c,u,h)}if(o==="int32")return Loe(a,t);if(o==="bool"){const i=t.makeTensorInfo([],"bool",Sn("bool",1)),u=jD({inputs:{a,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),u}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(o))}const Moe={kernelName:Fh,backendName:"webgl",kernelFunc:Ay};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cj="return ceil(x);",Poe=Gt({opSnippet:cj,packedOpSnippet:cj,cpuKernelImpl:Pne}),zoe={kernelName:Lh,backendName:"webgl",kernelFunc:Poe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Boe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{clipValueMin:o,clipValueMax:i}=n;let c;Se().getBool("WEBGL_PACK_CLIP")?c=new Voe(a.shape):c=new Boe(a.shape);const u=[[o],[i]];return t.runWebGLProgram(c,[a],a.dtype,u)}const Goe={kernelName:Mh,backendName:"webgl",kernelFunc:Uoe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Woe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uj(s,e){return{dataId:e.dataId,dtype:e.dtype,shape:s.shape}}function Hoe(s){const{inputs:e,backend:t}=s,{x:n}=e,a=t.texData.get(n.dataId),o=new Woe(n.shape),i=[uj(n,a.complexTensorInfos.real),uj(n,a.complexTensorInfos.imag)];return t.runWebGLProgram(o,i,i[0].dtype)}const qoe={kernelName:yg,backendName:"webgl",kernelFunc:Hoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Koe{constructor(e){this.outputShape=[],this.outputShape=Qr(e,1),this.variableNames=e.map((i,c)=>"T".concat(c));const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){const c=t[i-1];n.push("else if (yC < ".concat(t[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(c,"));"))}const a=t.length,o=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(o,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xoe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Qr(e,t);const n=this.outputShape,a=n.length,o=ss(a),i=Gn("coords",a),c=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((w,v)=>"T".concat(v));const u=new Array(e.length-1);u[0]=e[0][t];for(let w=1;w<u.length;w++)u[w]=u[w-1]+e[w][t];const h=c[t],p=c.slice(-2),f=c.join();let g="if (".concat(h," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(f,"), vec2(").concat(p.join(),"));\n        }");for(let w=1;w<u.length;w++){const v=u[w-1];g+="\n        if (".concat(h," < ").concat(u[w],"  && ").concat(h," >= ").concat(u[w-1],") {\n          return getChannel(\n            getT").concat(w,"(").concat(ym(c,h,v),"),\n            vec2(").concat(ym(p,h,v),"));\n        }")}const b=u.length,y=u[u.length-1];g+="\n        return getChannel(\n          getT".concat(b,"(").concat(ym(c,h,y),"),\n          vec2(").concat(ym(p,h,y),"));"),this.userCode="\n      float getValue(".concat(c.map(w=>"int "+w),") {\n        ").concat(g,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2]," &&\n            ").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function ym(s,e,t){const n=s.indexOf(e);return s.map((o,i)=>i===n?"".concat(o," - ").concat(t):o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0(s){const{inputs:e,backend:t}=s,{input:n}=e,a=t.texData.get(n.dataId);return Ca({inputs:{x:a.complexTensorInfos.imag},backend:t})}const Yoe={kernelName:u2,backendName:"webgl",kernelFunc:s0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uh(s,e,t){const n=s[0].dtype;if(n==="complex64"){const b=s.map(C=>qp({inputs:{input:C},backend:t})),y=s.map(C=>s0({inputs:{input:C},backend:t})),w=uh(b,e,t),v=uh(y,e,t),N=tl({inputs:{real:w,imag:v},backend:t});return b.forEach(C=>t.disposeIntermediateTensorInfo(C)),y.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(v),N}let a=t.shouldExecuteOnCPU(s);if(n==="string"&&(a=!0),a){const b=s.map(I=>{const R=[-1,Ae(I.shape.slice(e))];return Ye({inputs:{x:I},backend:t,attrs:{shape:R}})}),y=b.map(I=>({vals:t.readSync(I.dataId),shape:I.shape})),w=Qr(b.map(I=>I.shape),1),v=b[0].shape[0]===1,N=zne(y,w,n,v),C=Qr(s.map(I=>I.shape),e),T=t.makeTensorInfo(C,n,N);return b.forEach(I=>t.disposeIntermediateTensorInfo(I)),T}const o=s.filter(b=>Ae(b.shape)>0),i=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const b=i?new Yr(s[0].shape,ji):new Ii(s[0].shape,ji);return t.runWebGLProgram(b,s,n)}const c=Se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>c){const b=[];for(let w=0;w<o.length;w+=c){const v=o.slice(w,w+c);b.push(uh(v,e,t))}const y=uh(b,e,t);for(const w of b)t.disposeIntermediateTensorInfo(w);return y}if(i){const b=new Xoe(o.map(y=>y.shape),e);return t.runWebGLProgram(b,o,n)}const{tensors2D:u,outShape:h}=Zoe(o,e,t),p=new Koe(u.map(b=>b.shape)),f=t.runWebGLProgram(p,u,n);u.forEach(b=>t.disposeIntermediateTensorInfo(b));const g=Ye({inputs:{x:f},attrs:{shape:h},backend:t});return t.disposeIntermediateTensorInfo(f),g}function Zoe(s,e,t){const n=Qr(s.map(o=>o.shape),e);return{tensors2D:s.map(o=>Ye({inputs:{x:o},attrs:{shape:[-1,Ae(o.shape.slice(e))]},backend:t})),outShape:n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kD(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n,o=Rt(a,e[0].shape)[0],i=e.map(h=>h.shape);Pv(i,o);const c=Qr(e.map(h=>h.shape),o);if(Ae(c)===0)return t.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter(h=>Ae(h.shape)>0);return u.length===1?Ca({inputs:{x:u[0]},backend:t}):uh(u,o,t)}const Qoe={kernelName:vg,backendName:"webgl",kernelFunc:kD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,c=e.padInfo.left,u=e.strideHeight,h=e.strideWidth,p=e.dilationHeight,f=e.dilationWidth,g=e.filterHeight,b=e.filterWidth,y=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,v=e.dataFormat==="channelsLast",N=v?1:2,C=v?2:3,T=v?3:1;let I="",$="";n&&(a?I="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?I="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):I="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),$="result = activation(result);");const R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(I,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(T,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(N,"], coords[").concat(C,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(g,"; wR++) {\n          int xR = xRCorner + wR * ").concat(p,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(y,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(w===1,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(y,") *\n                    getW(wR, wC, ").concat(y,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(y,", xR, xC) *\n                    getW(wR, wC, ").concat(y,", d2);\n              }\n\n            } else if (").concat(w===2,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(y,", d2),\n                getW(wR, wC, ").concat(y," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(y,"),\n                  getX(batch, xR, xC, ").concat(y," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(y,", xR, xC),\n                  getX(batch, ").concat(y," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(w===3,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(y,", d2),\n                getW(wR, wC, ").concat(y," + 1, d2),\n                getW(wR, wC, ").concat(y," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(y,"),\n                  getX(batch, xR, xC, ").concat(y," + 1),\n                  getX(batch, xR, xC, ").concat(y," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(y,", xR, xC),\n                  getX(batch, ").concat(y," + 1, xR, xC),\n                  getX(batch, ").concat(y," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(R,"\n        ").concat($,"\n        setOutput(result);\n      }\n    ")}}class Joe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,p=e.dilationWidth,f=e.filterDepth,g=e.filterHeight,b=e.filterWidth,y=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(o,", ").concat(i,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(g,"; wR++) {\n            int xR = xRCorner + wR * ").concat(h,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(b,"; wC++) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(y,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(w===1,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(y,") *\n                  getW(wF, wR, wC, ").concat(y,", d2);\n              } else if (").concat(w===2,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(y,"),\n                  getX(batch, xF, xR, xC, ").concat(y," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(y,", d2),\n                  getW(wF, wR, wC, ").concat(y," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(w===3,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(y,"),\n                  getX(batch, xF, xR, xC, ").concat(y," + 1),\n                  getX(batch, xF, xR, xC, ").concat(y," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(y,", d2),\n                  getW(wF, wR, wC, ").concat(y," + 1, d2),\n                  getW(wF, wR, wC, ").concat(y," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ID{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_n(this.outputShape.length);const i=e.padInfo.left,c=e.strideWidth,u=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=p;let g="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let v=0;v<p;v++)g+="\n           vec4 xTexelC".concat(v*2,";\n           int xTexelC").concat(v*2,"Ready;\n           vec4 xTexelC").concat(v*2+1,";\n           int xTexelC").concat(v*2+1,"Ready;\n           vec4 xC").concat(v,";");g+="\n     for (int r = 0; r < ".concat(h,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let v=0;v<p;v++)g+="\n           xTexelC".concat(v*2," = vec4(0.0);\n           xTexelC").concat(v*2,"Ready = 0;\n           xTexelC").concat(v*2+1," = vec4(0.0);\n           xTexelC").concat(v*2+1,"Ready = 0;\n           xC").concat(v," = vec4(0.0);");g+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let v=0;v<(f+1)/2;v++){const N=v*2;if(g+="\n           xC = xCCorner + ".concat(N*u,";\n           "),c===1){if(N<p&&(i%2===1?(g+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n               "),u===1&&N>0?g+="\n                 xC".concat(N," = vec4(xTexelC").concat(N-2,".zw, xTexelC").concat(N,".xy);\n                 "):g+="\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(N," = vec4(previous.zw, xTexelC").concat(N,".xy);\n                   } else {\n                     xC").concat(N," = vec4(0.0, 0.0, xTexelC").concat(N,".xy);\n                   }\n                   ")):g+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 xC").concat(N," = xTexelC").concat(N,";\n                 "),N+1<p)){const C=i%2===0?Ly(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(g+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(C,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                     xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(N+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(N+1,"Ready = 1;\n                   }\n                   "),u>1?g+="\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(N+1," = vec4(previous.zw, xTexelC").concat(N+1,".xy);\n                     } else {\n                      xC").concat(N+1," = vec4(0.0, 0.0, xTexelC").concat(N+1,".xy);\n                     }\n                     "):g+="\n                     xC".concat(N+1," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".xy);\n                     ")):C===1?g+="\n                     xC".concat(N+1," = xTexelC").concat(N,";\n                     "):g+="\n                     xCOffset = xC + ".concat(C,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                       xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(N+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(N+1,"Ready = 1;\n                     }\n\n                     xC").concat(N+1," = xTexelC").concat(N+1,";\n                     ")}}else N<p&&(i%2===1?(g+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                   xTexelC").concat(N+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(N+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N+1,"Ready = 1;\n                 }\n\n                 xC").concat(N," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".zw);\n               "),N+1<p&&(g+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(N+1," = vec4(xTexelC").concat(N+1,".xy, final.xy);\n                 "))):(g+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(N,"Ready == 0) {\n                   xTexelC").concat(N," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(N,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(N,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(N+1,"Ready == 0) {\n                   xTexelC").concat(N+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(N+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(N+1,"Ready = 1;\n                 }\n\n                 xC").concat(N," = vec4(\n                   xTexelC").concat(N,".xy, xTexelC").concat(N+1,".xy);\n               "),N+1<p&&(g+="\n                   xC".concat(N+1," = vec4(xTexelC").concat(N,".zw, xTexelC").concat(N+1,".zw);\n                 "))));N<p&&(g+="\n             wTexel = getW(r, ".concat(N,", d1, d2);\n             dotProd += xC").concat(N,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(N,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),N+1<p&&(g+="\n               wTexel = getW(r, ".concat(N+1,", d1, d2);\n               dotProd += xC").concat(N+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(N+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}g+="\n     }\n   ",g+="\n     }\n   ",g+="\n     }\n   ";let b="",y="";n&&(a?b="vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):o?b="vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):b="vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),y="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(b,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(g,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(w,"\n         ").concat(y,"\n         setOutput(result);\n       }\n     ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eie{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=_n(this.outputShape.length);const{dataFormat:n}=t,a=Xn(),o=n==="channelsLast",i=o?1:2,c=o?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let h="";for(let p=0;p<=1;p++)for(let f=0;f<=1;f++)h+="\n          blockIndex = rc.z + ".concat(f,";\n          pos = rc.y + ").concat(p,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(c,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(o,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(p*2+f,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(p*2+f,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(h,"\n\n        ").concat(a.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(s,e){const t=s.length;return t>=3?e?[...s.slice(0,-3),s[t-3]*s[t-2],s[t-1]]:[...s.slice(0,-3),s[t-3],s[t-2]*s[t-1]]:!e&&t===1&&s[0]>1?[s[0],1]:null}function $D({x:s,filter:e,convInfo:t,backend:n,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:c=null}){const u=s.shape,h=n.texData.get(s.dataId),p=t.inChannels,f=u[0]*u[1]*u[2],g=t.outChannels,b=t.dataFormat==="channelsLast",y=!1,w=!1;let v;const N=[];if(o!=null){const I=rg(o.shape,b);I!=null&&(o=Ye({inputs:{x:o},backend:n,attrs:{shape:I}}),N.push(o))}if(a!=null){const I=rg(a.shape,b);I!=null&&(a=Ye({inputs:{x:a},backend:n,attrs:{shape:I}}),N.push(a))}if(!((f===1||g===1)&&p>wD)&&h.isPacked&&b&&h.texture!=null&&u[2]%2!==0&&zt(h.shape.slice(-3),u.slice(-3))){const I=u[0]*u[1]*(u[2]+1),$={dataId:s.dataId,shape:[1,I,t.inChannels],dtype:s.dtype},R=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,V(ng(h.shape,$.shape),()=>"packed reshape ".concat(h.shape," to ").concat($.shape," isn't free"));const O=Ye({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}});N.push(O);const P=ag({a:$,b:O,backend:n,transposeA:y,transposeB:w,bias:a,activation:c,preluActivationWeights:o,leakyreluAlpha:i}),_=n.texData.get(P.dataId);V(_.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=R,_.shape=t.outShape,v=Ca({inputs:{x:P},backend:n}),v.shape=t.outShape,N.push(P)}else{const I=t.outHeight*t.outWidth,$=Ye({inputs:{x:s},backend:n,attrs:{shape:b?[t.batchSize,I,t.inChannels]:[t.batchSize,t.inChannels,I]}}),R=Ye({inputs:{x:e},backend:n,attrs:{shape:[1,t.inChannels,t.outChannels]}}),O=ag({a:b?$:R,b:b?R:$,transposeA:!b,transposeB:w,backend:n,bias:a,activation:c,preluActivationWeights:o,leakyreluAlpha:i});v=Ye({inputs:{x:O},backend:n,attrs:{shape:t.outShape}}),N.push($),N.push(R),N.push(O)}for(const I of N)n.disposeIntermediateTensorInfo(I);return v}function AD({x:s,filter:e,convInfo:t,backend:n,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:c=null}){const{filterWidth:u,filterHeight:h,inChannels:p,outWidth:f,outHeight:g,dataFormat:b}=t,y=b==="channelsLast",w=u*h*p,v=g*f,N=[t.batchSize,w,v],C=!0,T=!1,I=[];if(o!=null){const Y=rg(o.shape,y);Y!=null&&(o=Ye({inputs:{x:o},backend:n,attrs:{shape:Y}}),I.push(o))}if(a!=null){const Y=rg(a.shape,y);Y!=null&&(a=Ye({inputs:{x:a},backend:n,attrs:{shape:Y}}),I.push(a))}const $=Ye({inputs:{x:e},backend:n,attrs:{shape:[1,w,Ae(e.shape)/w]}});I.push($);const R=new eie(N,t),O=[s.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],P=n.runWebGLProgram(R,[s],"float32",O),_=Ye({inputs:{x:P},backend:n,attrs:{shape:N}});I.push(P),I.push(_);const M=a!=null,A=o!=null,U=c==="leakyrelu",K=c?Ch(c,!0):null,Q=new vD(y?_.shape:$.shape,y?$.shape:_.shape,y?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],C,T,M,K,A,U),X=y?[_,$]:[$,_];if(a&&X.push(a),A&&X.push(o),U){const Y=n.makeTensorInfo([],"float32",Wi(i,"float32"));X.push(Y),I.push(Y)}const B=n.runWebGLProgram(Q,X,"float32"),G=Ye({inputs:{x:B},backend:n,attrs:{shape:t.outShape}});I.push(B);for(const Y of I)n.disposeIntermediateTensorInfo(Y);return G}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}=n,f=Go(u),g=mn(a.shape,o.shape,i,h,c,p,!1,f);let b;if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))b=$D({x:a,filter:o,convInfo:g,backend:t});else if(g.strideWidth<=2&&f==="channelsLast"&&Se().getBool("WEBGL_EXP_CONV")){const w=new ID(g),v=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]];b=t.runWebGLProgram(w,[a,o],"float32",v)}else if(Se().getBool("WEBGL_CONV_IM2COL"))b=AD({x:a,filter:o,convInfo:g,backend:t});else{const w=new TD(g);b=t.runWebGLProgram(w,[a,o],"float32")}const y=Ye({inputs:{x:b},backend:t,attrs:{shape:g.outShape}});return t.disposeIntermediateTensorInfo(b),y}const sie={kernelName:wg,backendName:"webgl",kernelFunc:tie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class aie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",c=t-1-e.padInfo.top,u=n-1-e.padInfo.left,h=i?1:2,p=i?2:3,f=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(h,"], coords[").concat(p,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class rie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,c=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(o,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(c,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class oie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=t-1-e.padInfo.front,h=n-1-e.padInfo.top,p=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(o,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,dataFormat:u,dimRoundingMode:h,filterShape:p}=n,f=Go(u),g=mn(a.shape,p,i,1,c,h,!1,f),b=new nie(g);return t.runWebGLProgram(b,[a,o],"float32")}const lie={kernelName:qy,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cie{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=_n(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{inputShape:i,strides:c,pad:u,dataFormat:h,dimRoundingMode:p}=n,f=Go(h),g=mn(i,o.shape,c,1,u,p,!1,f);if(Se().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const b=[[g.strideHeight,g.strideWidth]],y=new cie(g);return t.runWebGLProgram(y,[a,o],"float32",b)}else{const b=new aie(g);return t.runWebGLProgram(b,[a,o],"float32")}}const die={kernelName:Ng,backendName:"webgl",kernelFunc:uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n,h=Ki(a.shape,o.shape,i,u,c),p=new Joe(h);return t.runWebGLProgram(p,[a,o],"float32")}const pie={kernelName:Sg,backendName:"webgl",kernelFunc:hie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,pad:c,filterShape:u}=n,h=Ki(a.shape,u,i,1,c),p=new rie(h);return t.runWebGLProgram(p,[a,o],"float32")}const mie={kernelName:Ky,backendName:"webgl",kernelFunc:fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{pad:i,strides:c,inputShape:u}=n,h=Ki(u,o.shape,c,1,i),p=new oie(h);return t.runWebGLProgram(p,[a,o],"float32")}const xie={kernelName:Xy,backendName:"webgl",kernelFunc:gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bie=Hu+"\n  return cos(x);\n",yie="\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(lc,"\n  return result;\n"),vie=Gt({opSnippet:bie,packedOpSnippet:yie}),wie={kernelName:Ph,backendName:"webgl",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",Sie=Gt({opSnippet:Nie}),Cie={kernelName:zh,backendName:"webgl",kernelFunc:Sie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jie{constructor(e,t,n,a,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,c,u,h]=e,[p]=t,[f,g]=n;this.outputShape=[p,f,g,h];const b=a==="bilinear"?1:0,[y,w]=["".concat(c-1,".0"),"".concat(u-1,".0")],[v,N,C]=f>1?["".concat((c-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(y," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(y)],[T,I,$]=g>1?["".concat((u-1)/(g-1)),"(x2-x1) * width_ratio","x1*".concat(w," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(w)];this.userCode="\n      const float height_ratio = float(".concat(v,");\n      const float width_ratio = float(").concat(T,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(N,";\n        float width_scale = ").concat(I,";\n\n        float in_y = ").concat(C,";\n        if( in_y < 0.0 || in_y > ").concat(y," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat($,";\n        if( in_x < 0.0 || in_x > ").concat(w," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(b," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie=s=>{const{inputs:e,backend:t,attrs:n}=s,{image:a,boxes:o,boxInd:i}=e,{cropSize:c,method:u,extrapolationValue:h}=n,p=new jie(a.shape,o.shape,c,u,h);return t.runWebGLProgram(p,[a,o,i],"float32")},Tie={kernelName:Zy,backendName:"webgl",kernelFunc:kie};var kh;(function(s){s.Prod="*",s.Sum="+"})(kh||(kh={}));class dj{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===kh.Prod?"1.0":"0.0",c=n?i:"getX(".concat(hj(o,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1];let h="",p="";n?(h=a?"end != ".concat(u-1):"end != 0",p=a?"end + 1":"end - 1"):(h=a?"end + pow2 < ".concat(u):"end >= pow2",p=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(ss(o)," coords = getOutputCoords();\n        int end = ").concat(pj(o,"coords",this.op),";\n        float val = ").concat(c,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(h,") {\n          int idx = ").concat(p,";\n          ").concat(pj(o,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(hj(o,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function hj(s,e,t){if(s===1)return"".concat(e);if(s===2)return"".concat(e,".x, ").concat(e,".y");if(s===3)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(s===4)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(t," for rank ").concat(s," is not yet supported"))}function pj(s,e,t){if(s===1)return"".concat(e);if(s===2)return"".concat(e,".y");if(s===3)return"".concat(e,".z");if(s===4)return"".concat(e,".w");throw new Error("Cumulative ".concat(t," for rank ").concat(s," is not yet supported"))}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(s,e,t,n,a,o){const i=e.shape.length,c=ws([n],i);let u=e;c!=null&&(u=Hn({inputs:{x:e},backend:t,attrs:{perm:c}}));const h=Fs(1,i)[0];if(h!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(n));const p=u.shape[h];let f=Ca({inputs:{x:u},backend:t});for(let g=0;g<=Math.ceil(Math.log2(p))-1;g++){const b=new dj(s,u.shape,!1,o),y=[[g]],w=f;f=t.runWebGLProgram(b,[f],f.dtype,y),t.disposeIntermediateTensorInfo(w)}if(a){const g=new dj(s,u.shape,a,o),b=f;f=t.runWebGLProgram(g,[f],f.dtype),t.disposeIntermediateTensorInfo(b)}if(c!=null){const g=Xi(c),b=Hn({inputs:{x:f},backend:t,attrs:{perm:g}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(u),b}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;return ED(kh.Prod,a,t,o,i,c)}const $ie={kernelName:Yy,backendName:"webgl",kernelFunc:Iie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,exclusive:i,reverse:c}=n;return ED(kh.Sum,a,t,o,i,c)}const Eie={kernelName:Cg,backendName:"webgl",kernelFunc:Aie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,weights:o}=e,{size:i,binaryOutput:c}=n;if(a.shape.length===1){const u=t.readSync(a.dataId),h=t.readSync(o.dataId),p=dD(u,h,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,p)}else if(a.shape.length===2){const u=t.bufferSync(a),h=t.bufferSync(o),p=Fne(u,h,i,c);return t.makeTensorInfo(p.shape,o.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}const Rie={kernelName:Qy,backendName:"webgl",kernelFunc:Die};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oie{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockSize:o,dataFormat:i}=n,c=a.shape[0],u=i==="NHWC"?a.shape[1]:a.shape[2],h=i==="NHWC"?a.shape[2]:a.shape[3],p=i==="NHWC"?a.shape[3]:a.shape[1],f=u*o,g=h*o,b=p/(o*o),y=i==="NHWC"?[c,f,g,b]:[c,b,f,g],w=new Oie(y,o,i);return t.runWebGLProgram(w,[a],a.dtype)}const Fie={kernelName:Jy,backendName:"webgl",kernelFunc:_ie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_n(this.outputShape.length);const i=e.filterHeight,c=e.filterWidth,u=e.outChannels/e.inChannels;let h="",p="";n&&(a?h="float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?h="float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):h="\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(h,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(c,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(f,"\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RD{constructor(e,t=!1,n=null,a=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=_n(this.outputShape.length);const i=e.outChannels/e.inChannels,c=e.padInfo.left,u=e.strideWidth,h=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=f;let b="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let N=0;N<f;N++)b+="\n          vec4 xTexelC".concat(N*2,";\n          int xTexelC").concat(N*2,"Ready;\n          vec4 xTexelC").concat(N*2+1,";\n          int xTexelC").concat(N*2+1,"Ready;\n          vec4 xC").concat(N,";");b+="\n    for (int r = 0; r < ".concat(p,"; r++) {\n      ");for(let N=0;N<f;N++)b+="\n          xTexelC".concat(N*2," = vec4(0.0);\n          xTexelC").concat(N*2,"Ready = 0;\n          xTexelC").concat(N*2+1," = vec4(0.0);\n          xTexelC").concat(N*2+1,"Ready = 0;\n          xC").concat(N," = vec4(0.0);");b+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let N=0;N<(g+1)/2;N++){const C=N*2;if(b+="\n          xC = xCCorner + ".concat(C*h,";\n          "),u===1){if(C<f&&(c%2===1?(b+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n              "),h===1&&C>0?b+="\n                xC".concat(C," = vec4(xTexelC").concat(C-2,".zw, xTexelC").concat(C,".xy);\n                "):b+="\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(C," = vec4(previous.zw, xTexelC").concat(C,".xy);\n                  } else {\n                    xC").concat(C," = vec4(0.0, 0.0, xTexelC").concat(C,".xy);\n                  }\n                  ")):b+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                xC").concat(C," = xTexelC").concat(C,";\n                "),C+1<f)){const T=c%2===0?Ly(h):h;h%2===0&&c%2===1||h%2!==0&&c%2!==1?(b+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(T,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                    xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(C+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(C+1,"Ready = 1;\n                  }\n                  "),h>1?b+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(C+1," = vec4(previous.zw, xTexelC").concat(C+1,".xy);\n                    } else {\n                     xC").concat(C+1," = vec4(0.0, 0.0, xTexelC").concat(C+1,".xy);\n                    }\n                    "):b+="\n                    xC".concat(C+1," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".xy);\n                    ")):T===1?b+="\n                    xC".concat(C+1," = xTexelC").concat(C,";\n                    "):b+="\n                    xCOffset = xC + ".concat(T,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                      xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(C+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(C+1,"Ready = 1;\n                    }\n\n                    xC").concat(C+1," = xTexelC").concat(C+1,";\n                    ")}}else C<f&&(c%2===1?(b+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                  xTexelC").concat(C+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(C+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C+1,"Ready = 1;\n                }\n\n                xC").concat(C," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".zw);\n              "),C+1<f&&(b+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(C+1," = vec4(xTexelC").concat(C+1,".xy, final.xy);\n                "))):(b+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(C,"Ready == 0) {\n                  xTexelC").concat(C," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(C,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(C,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(C+1,"Ready == 0) {\n                  xTexelC").concat(C+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(C+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(C+1,"Ready = 1;\n                }\n\n                xC").concat(C," = vec4(\n                  xTexelC").concat(C,".xy, xTexelC").concat(C+1,".xy);\n              "),C+1<f&&(b+="\n                  xC".concat(C+1," = vec4(xTexelC").concat(C,".zw, xTexelC").concat(C+1,".zw);\n                "))));C<f&&(b+="\n            wTexel = getW(r, ".concat(C,", d1, q);\n            dotProd += xC").concat(C," * vec4(wTexel.xz, wTexel.xz);\n          "),C+1<f&&(b+="\n              wTexel = getW(r, ".concat(C+1,", d1, q);\n              dotProd += xC").concat(C+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}b+="\n    }\n  ",b+="\n      }\n    ";let y="",w="";n&&(a?y="vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?y="vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):y="vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),w="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(y,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(b,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(v,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u,dimRoundingMode:h}=n;let p=u;p==null&&(p=[1,1]),V(jn(i,p),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(p,"'"));const f=mn(a.shape,o.shape,i,p,c,h,!0);let g;Se().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?g=new RD(f):g=new DD(f);const b=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(g,[a,o],"float32",b)}const Mie={kernelName:jg,backendName:"webgl",kernelFunc:Lie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class zie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,c=n-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,dy:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,filterShape:p}=n,f=mn(a.shape,p,i,c,u,h,!0),g=new Pie(f);return t.runWebGLProgram(g,[a,o],"float32")}const Vie={kernelName:e2,backendName:"webgl",kernelFunc:Bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,filter:o}=e,{strides:i,dilations:c,pad:u,dimRoundingMode:h,inputShape:p}=n,f=mn(p,o.shape,i,c,u,h,!0),g=new zie(f);return t.runWebGLProgram(g,[a,o],"float32")}const Gie={kernelName:t2,backendName:"webgl",kernelFunc:Uie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wie{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(s){const{inputs:e,backend:t}=s,{x:n}=e,a=[...n.shape,...n.shape],o=Ae(n.shape),i=Ye({inputs:{x:n},backend:t,attrs:{shape:[o]}}),c=new Wie(o),u=t.runWebGLProgram(c,[i],i.dtype),h=Ye({inputs:{x:u},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),h}const qie={kernelName:s2,backendName:"webgl",kernelFunc:Hie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:a,strideHeight:o,strideWidth:i,filterHeight:c,filterWidth:u,dilationHeight:h,dilationWidth:p}=e,{top:f,left:g}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(g,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(c,"; h++) {\n          int hIn = hBeg + h * ").concat(h,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(p,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o}=e,{strides:i,pad:c,dilations:u}=n,h=jp(a.shape,o.shape,i,c,"NHWC",u);let p;const f=new Kie(h);p=t.runWebGLProgram(f,[a,o],"float32");const g=Ye({inputs:{x:p},backend:t,attrs:{shape:h.outShape}});return t.disposeIntermediateTensorInfo(p),g}const Yie={kernelName:kg,backendName:"webgl",kernelFunc:Xie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(s){const{inputs:e,backend:t,attrs:n}=s,{equation:a}=n,o=e,{allDims:i,summedDims:c,idDims:u}=Zv(a,o.length);Jv(i.length,u,o);const{path:h,steps:p}=ew(c,u),f=p.length;let g=null,b=i.length;const y=[];for(let w=0;w<f;++w){for(const v of p[w]){const{permutationIndices:N,expandDims:C}=Qv(b,u[v]);let T;tw(N)?T=o[v]:(T=Hn({inputs:{x:o[v]},backend:t,attrs:{perm:N}}),y.push(T));const I=T.shape.slice();for(let $=0;$<C.length;++$)I.splice(C[$],0,1);zt(T.shape,I)||(T=Ye({inputs:{x:T},backend:t,attrs:{shape:I}}),y.push(T)),g===null?g=T:(g=Vw({inputs:{a:T,b:g},backend:t}),y.push(g))}w<f-1&&(h[w]>=0&&(g=t0({inputs:{x:g},backend:t,attrs:{axis:h[w]-(i.length-b),keepDims:!1}}),y.push(g)),b--)}for(const w of y)w!==g&&t.disposeIntermediateTensorInfo(w);return g}const Qie={kernelName:n2,backendName:"webgl",kernelFunc:Zie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jie="return (x >= 0.0) ? x : (exp(x) - 1.0);",ele="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",tle=Gt({opSnippet:Jie,packedOpSnippet:ele}),sle={kernelName:Vh,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle="return (b >= 0.0) ? a : a * (b + 1.0);",ale="\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",rle=s=>{const{inputs:e,backend:t}=s,{dy:n,y:a}=e,o=Se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wu(ale,n.shape,a.shape):new Jl(nle,n.shape,a.shape);return t.runWebGLProgram(o,[n,a],n.dtype)},ole={kernelName:a2,backendName:"webgl",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile="\n  return vec4(equal(a, b));\n",lle="return float(a == b);",cle=In({opSnippet:lle,packedOpSnippet:ile,dtype:"bool",cpuKernelImpl:Bne}),ule={kernelName:Tg,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Gv,";\n  float a1 = ").concat(Wv,";\n  float a2 = ").concat(Hv,";\n  float a3 = ").concat(qv,";\n  float a4 = ").concat(Kv,";\n  float a5 = ").concat(Xv,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),hle=Gt({opSnippet:dle}),ple={kernelName:Uh,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fle=Hu+"\n  return exp(x);\n",mle="\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",OD=Gt({opSnippet:fle,packedOpSnippet:mle,cpuKernelImpl:Vne,dtype:"float32"}),gle={kernelName:Gh,backendName:"webgl",kernelFunc:OD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ey(s){const{inputs:e,attrs:t,backend:n}=s,{dim:a}=t,{input:o}=e,i=o.shape.length,c=o.shape.slice();let u=a;return a<0&&(V(-(i+1)<=a,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),u=i+a+1),c.splice(u,0,1),Ye({inputs:{x:o},backend:n,attrs:{shape:c}})}const xle={kernelName:Ig,backendName:"webgl",kernelFunc:Ey};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fj="return exp(x) - 1.0;",ble=Gt({opSnippet:fj,packedOpSnippet:fj,cpuKernelImpl:Une}),yle={kernelName:Wh,backendName:"webgl",kernelFunc:ble};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mj{constructor(e,t,n){this.variableNames=["real","imag"];const a=t[1];this.outputShape=t;const o=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(a,".0"):"1.0";let c;if(e==="real")c="return real * expR - imag * expI;";else if(e==="imag")c="return real * expI + imag * expR;";else throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(c,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _D(s,e,t){const n=t.texData.get(s.dataId),a=Ae(s.shape),o=s.shape[s.shape.length-1],i=a/o,c=Ye({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),u=c.shape,h=new mj("real",u,e),p=new mj("imag",u,e),f=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:u},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:u}],g=t.runWebGLProgram(h,f,"float32"),b=t.runWebGLProgram(p,f,"float32"),y=tl({inputs:{real:g,imag:b},backend:t});t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b);const w=Ye({inputs:{x:y},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(y),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(s){const{inputs:e,backend:t}=s,{input:n}=e;return _D(n,!1,t)}const wle={kernelName:r2,backendName:"webgl",kernelFunc:vle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nle{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(s){const{backend:e,attrs:t}=s,{shape:n,value:a}=t;let{dtype:o}=t;if(o=o||Eu(a),o==="string"){const i=Os(o,Ae(n));return i.fill(a),e.makeTensorInfo(n,o,i)}else{const i=new Nle(n,a),c=[[a]];return e.runWebGLProgram(i,[],o,c)}}const Sle={kernelName:o2,backendName:"webgl",kernelFunc:Kp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cle{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle={kernelName:i2,backendName:"webgl",kernelFunc:({inputs:s,backend:e})=>{const{image:t}=s,n=e,a=new Cle(t.shape);return n.runWebGLProgram(a,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gj="return floor(x);",kle=Gt({opSnippet:gj,packedOpSnippet:gj,cpuKernelImpl:Gne}),Tle={kernelName:Hh,backendName:"webgl",kernelFunc:kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile="\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",$le="\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",Ale=In({opSnippet:Ile,packedOpSnippet:$le,dtype:"int32"}),Ele={kernelName:qh,backendName:"webgl",kernelFunc:Ale};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dle{constructor(e){this.variableNames=["A"];const t=Xn(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rle{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Xn(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole={kernelName:z1,backendName:"webgl",kernelFunc:_le};let ru,D1=Se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function _le(s){const{inputs:e,backend:t,attrs:n}=s;let{pixels:a}=e;const{numChannels:o}=n,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,c=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[u,h]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],p=[h,u],f=[h,u,o];if(c||i){const w=Se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ru==null||w!==D1)&&(D1=w,ru=document.createElement("canvas").getContext("2d",{willReadFrequently:D1})),ru.canvas.width=u,ru.canvas.height=h,ru.drawImage(a,0,0,u,h),a=ru.canvas}const g=t.makeTensorInfo(p,"int32");t.texData.get(g.dataId).usage=Fa.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(g.dataId),a);const b=Se().getBool("WEBGL_PACK")?new Rle(f):new Dle(f),y=t.runWebGLProgram(b,[g],"int32");return t.disposeData(g.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dataFormat:p,dilations:f,dimRoundingMode:g,activation:b,leakyreluAlpha:y}=n,w=Go(p),v=mn(a.shape,o.shape,u,f,h,g,!1,w);let N;const C=[],T=i!=null,I=c!=null,$=b==="leakyrelu",R=()=>{const P=[a,o],_=(M,A)=>{if(A==="NCHW"&&M.shape.length===1&&M.shape[0]!==1){const U=Ye({inputs:{x:M},backend:t,attrs:{shape:[M.shape[0],1,1]}});return C.push(U),U}return M};if(T&&P.push(_(i,p)),I&&P.push(_(c,p)),$){const M=t.makeTensorInfo([],"float32",Wi(y,"float32"));P.push(M),C.push(M)}return P};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))N=$D({x:a,filter:o,convInfo:v,backend:t,bias:i,activation:b,preluActivationWeights:c,leakyreluAlpha:y});else if(v.strideWidth<=2&&w==="channelsLast"&&Se().getBool("WEBGL_EXP_CONV")){const P=b?Ch(b,!0):null,_=new ID(v,T,P,I,$),M=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],A=R();N=t.runWebGLProgram(_,A,"float32",M)}else if(Se().getBool("WEBGL_CONV_IM2COL"))N=AD({x:a,filter:o,convInfo:v,backend:t,bias:i,activation:b,preluActivationWeights:c,leakyreluAlpha:y});else{const P=b?Ch(b,!1):null,_=new TD(v,T,P,I,$),M=R();N=t.runWebGLProgram(_,M,"float32")}const O=Ye({inputs:{x:N},backend:t,attrs:{shape:v.outShape}});return C.push(N),C.forEach(P=>t.disposeIntermediateTensorInfo(P)),O}const Lle={kernelName:Rm,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,filter:o,bias:i,preluActivationWeights:c}=e,{strides:u,pad:h,dilations:p,dimRoundingMode:f,activation:g,leakyreluAlpha:b}=n,y=[];let w=p;w==null&&(w=[1,1]),V(jn(u,w),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(w,"'"));const v=mn(a.shape,o.shape,u,w,h,f,!0),N=Se().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,C=g?Ch(g,N):null,T=[a,o],I=i!=null,$=c!=null,R=g==="leakyrelu";if(I&&T.push(i),$&&T.push(c),R){const M=t.makeTensorInfo([],"float32",Wi(b,"float32"));T.push(M),y.push(M)}let O;N?O=new RD(v,I,C,$,R):O=new DD(v,I,C,$,R);const P=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],_=t.runWebGLProgram(O,T,"float32",P);return y.forEach(M=>t.disposeIntermediateTensorInfo(M)),_}const Ple={kernelName:Om,backendName:"webgl",kernelFunc:Mle};class zle{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;const o=ss(n.length);let i="\n    int index;";for(let c=0;c<this.sliceDim;c++)i+="\n          index = round(getIndices(coords[0], ".concat(c,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[c],";\n          flattenIndex += index * ").concat(this.strides[c],";");this.userCode="\n         void main() {\n          ".concat(o," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(s){const{inputs:e,backend:t}=s,{params:n,indices:a}=e,o=a.shape,i=o[o.length-1],c=Ae(n.shape),[u,h,p,f]=Rv(n,a),g=Ye({inputs:{x:a},backend:t,attrs:{shape:[h,i]}}),b=Ye({inputs:{x:n},backend:t,attrs:{shape:[Ae(n.shape)/p,p]}});if(t.shouldExecuteOnCPU([n,a])||n.dtype==="string"){const N=t.readSync(a.dataId),C=t.bufferSync(n),T=Wne(N,C,n.dtype,h,i,p,f,n.shape,c);return t.makeTensorInfo(u,n.dtype,T.values)}const y=new zle(i,f,[h,p],n.shape),w=t.runWebGLProgram(y,[b,g],b.dtype),v=Ye({inputs:{x:w},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),v}const Vle={kernelName:l2,backendName:"webgl",kernelFunc:Ble};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ule{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=ss(this.rank),a=Gle(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}}function Gle(s,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<s.length;a++)a===2?n.push("index"):n.push("".concat(t[a]));return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FD(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,indices:o}=e,{axis:i,batchDims:c}=n,u=Rt(i,a.shape)[0];if(Se().get("DEBUG")){const C=t.readSync(o.dataId),T=a.shape[u];for(let I=0;I<C.length;++I){const $=C[I];V($<=T-1&&$>=0,()=>"GatherV2: the index value ".concat($," is not in [0, ").concat(T-1,"]"))}}const h=nw(a,o,u,c),p=Ae(o.shape),f=[],g=Ye({inputs:{x:a},backend:t,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),b=Ye({inputs:{x:o},backend:t,attrs:{shape:[h.batchSize,p/h.batchSize]}});f.push(g),f.push(b);const y=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize];if(t.shouldExecuteOnCPU([a,o])||a.dtype==="string"){const C=t.bufferSync(b),T=t.bufferSync(g),I=Hne(T,C,y);return f.forEach($=>t.disposeIntermediateTensorInfo($)),t.makeTensorInfo(h.outputShape,I.dtype,I.values)}const w=new Ule(g.shape,y),v=t.runWebGLProgram(w,[g,b],g.dtype);f.push(v);const N=Ye({inputs:{x:v},backend:t,attrs:{shape:h.outputShape}});return f.forEach(C=>t.disposeIntermediateTensorInfo(C)),N}const Wle={kernelName:Ag,backendName:"webgl",kernelFunc:FD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hle="return float(a > b);",qle="\n  return vec4(greaterThan(a, b));\n",Kle=In({opSnippet:Hle,packedOpSnippet:qle,cpuKernelImpl:qne,dtype:"bool"}),Xle={kernelName:Eg,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle="return float(a >= b);",Zle="\n  return vec4(greaterThanEqual(a, b));\n",Qle=In({opSnippet:Yle,packedOpSnippet:Zle,dtype:"bool",cpuKernelImpl:Kne}),Jle={kernelName:Kh,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(s){const{inputs:e,backend:t}=s,{input:n}=e;return _D(n,!0,t)}const tce={kernelName:c2,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sce="return float(!isnan(x) && !isinf(x));",nce=Gt({opSnippet:sce,dtype:"bool"}),ace={kernelName:Yh,backendName:"webgl",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce="return float(isinf(x));",oce=Gt({opSnippet:rce,dtype:"bool"}),ice={kernelName:Zh,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce="return float(isnan(x));",cce=Gt({opSnippet:lce,dtype:"bool"}),uce={kernelName:Qh,backendName:"webgl",kernelFunc:cce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dce="return float(a < b);",hce="\n  return vec4(lessThan(a, b));\n",pce=In({opSnippet:dce,packedOpSnippet:hce,cpuKernelImpl:Xne,dtype:"bool"}),fce={kernelName:Rg,backendName:"webgl",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce="return float(a <= b);",gce="\n  return vec4(lessThanEqual(a, b));\n",xce=In({opSnippet:mce,packedOpSnippet:gce,cpuKernelImpl:Yne,dtype:"bool"}),bce={kernelName:Og,backendName:"webgl",kernelFunc:xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(s){const{backend:e,attrs:t}=s,{start:n,stop:a,num:o}=t,i=Zne(n,a,o);return e.makeTensorInfo([i.length],"float32",i)}const vce={kernelName:d2,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce=Hu+"\n  return x < 0.0 ? 0./0. : log(x);\n",Nce="\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",Sce=Gt({opSnippet:wce,packedOpSnippet:Nce,cpuKernelImpl:Qne}),Cce={kernelName:Jh,backendName:"webgl",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jce=Hu+"\n  return log(1.0 + x);\n",kce=Gt({opSnippet:jce}),Tce={kernelName:ep,backendName:"webgl",kernelFunc:kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ice="return float(a >= 1.0 && b >= 1.0);",$ce="\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",Ace=In({opSnippet:Ice,packedOpSnippet:$ce,dtype:"bool"}),Ece={kernelName:_g,backendName:"webgl",kernelFunc:Ace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce="return float(!(x >= 1.0));",Rce=Gt({opSnippet:Dce}),Oce={kernelName:Fg,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ce="return float(a >= 1.0 || b >= 1.0);",Fce="\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",Lce=In({opSnippet:_ce,packedOpSnippet:Fce,dtype:"bool"}),Mce={kernelName:Lg,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pce{constructor(e,t,n,a,o){this.variableNames=["x"],this.outputShape=[];const i=t,c=e[3]-1;this.outputShape=e;let u;const h="float(".concat(n,") + float(").concat(a,") * sum");o===.5?u="inversesqrt(".concat(h,")"):o===1?u="1.0/(".concat(h,")"):u="exp(log(".concat(h,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(u,";\n        setOutput(val);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zce{constructor(e,t,n,a,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,c=e[3]-1;this.outputShape=e;let u;const h="float(".concat(n,") + float(").concat(a,") * sum");o===.5?u="inversesqrt(".concat(h,")"):o===1?u="1.0/(".concat(h,")"):u="exp(log(".concat(h,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(u,";\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{depthRadius:o,bias:i,alpha:c,beta:u}=n,h=Se().getBool("WEBGL_PACK_NORMALIZATION")?new zce(a.shape,o,i,c,u):new Pce(a.shape,o,i,c,u);return t.runWebGLProgram(h,[a],a.dtype)},Vce={kernelName:Mg,backendName:"webgl",kernelFunc:Bce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uce{constructor(e,t,n,a,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(o,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(o,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a,y:o,dy:i}=e,{depthRadius:c,bias:u,alpha:h,beta:p}=n,f=new Uce(a.shape,c,u,h,p);return t.runWebGLProgram(f,[a,o,i],a.dtype)},Wce={kernelName:h2,backendName:"webgl",kernelFunc:Gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(s,e,t,n){const a=Ae(e),i=Ae(s.shape)/a,c=Ye({inputs:{x:s},attrs:{shape:[i,a]},backend:n}),u=cc(c,s.dtype,"max",n),h=Ye({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LD(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reductionIndices:o,keepDims:i}=n,c=a.shape.length,u=Rt(o,a.shape);let h=u;const p=ws(h,c),f=p!=null,g=t.shouldExecuteOnCPU([a]);let b=a;if(f){if(g){const T=t.texData.get(b.dataId).values,I=new Array(c);for(let O=0;O<I.length;O++)I[O]=a.shape[p[O]];const $=zw(T,a.shape,a.dtype,p,I);b=t.makeTensorInfo(I,a.dtype);const R=t.texData.get(b.dataId);R.values=$}else b=e0(a,p,t);h=Fs(h.length,c)}kn("max",h,c);const[y,w]=gn(b.shape,h);let v=y;i&&(v=_s(y,u));let N;if(g){const T=t.texData.get(b.dataId).values,I=Jne(T,Ae(w),v,a.dtype);N=t.makeTensorInfo(v,a.dtype);const $=t.texData.get(N.dataId);$.values=I}else N=Hce(b,w,v,t);return f&&t.disposeIntermediateTensorInfo(b),N}const qce={kernelName:Pg,backendName:"webgl",kernelFunc:LD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce=Bw+"\n  return max(a, b);\n",Xce="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",Yce=In({opSnippet:Kce,packedOpSnippet:Xce,cpuKernelImpl:eae}),Zce={kernelName:tp,backendName:"webgl",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;Wp(a,"maxPool");const{filterSize:o,strides:i,pad:c,dimRoundingMode:u}=n,h=1;V(jn(i,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(h,"'"));const p=pr(a.shape,o,i,h,c,u);if(p.filterWidth===1&&p.filterHeight===1&&zt(p.inShape,p.outShape))return Ca({inputs:{x:a},backend:t});const f=new jh(p,"max",!1);return t.runWebGLProgram(f,[a],a.dtype)}const Jce={kernelName:zg,backendName:"webgl",kernelFunc:Qce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{filterSize:o,strides:i,pad:c,dataFormat:u,dimRoundingMode:h}=n,p=[1,1,1],f=Uo(a.shape,o,i,p,c,h,u),g=new Uw(f,"max",!1);return t.runWebGLProgram(g,[a],a.dtype)}const tue={kernelName:Bg,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sue{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=i-1-e.padInfo.left,h=o*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(h," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class nue{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=u-1-e.padInfo.front,g=h-1-e.padInfo.top,b=p-1-e.padInfo.left,y=u*h*p-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(g,", ").concat(b,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(y," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(h," * ").concat(p," +\n                  wR * ").concat(p," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o}=e,i=o,{filterSize:c,strides:u,pad:h,dimRoundingMode:p}=n,f=[1,1,1],g=Uo(i.shape,c,u,f,h,p),b=new Uw(g,"max",!0),y=t.runWebGLProgram(b,[i],i.dtype),w=new nue(g),v=t.runWebGLProgram(w,[a,y],i.dtype);return t.disposeIntermediateTensorInfo(y),v}const rue={kernelName:f2,backendName:"webgl",kernelFunc:aue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(s){const{inputs:e,backend:t,attrs:n}=s,{dy:a,input:o,output:i}=e,c=o;Wp([o,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:p,dimRoundingMode:f}=n,g=pr(c.shape,u,h,1,p,f),b=!0,y=new jh(g,"max",b),w=t.runWebGLProgram(y,[c],c.dtype),v=new sue(g),N=t.runWebGLProgram(v,[a,w],c.dtype);return t.disposeIntermediateTensorInfo(w),N}const iue={kernelName:p2,backendName:"webgl",kernelFunc:oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(s,e,t,n){let a=new jh(t,"max",!1);const o=n.runWebGLProgram(a,[s],"float32");a=new jh(t,"max",!0,!0,e);const i=n.runWebGLProgram(a,[s],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cue={kernelName:m2,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{filterSize:a,strides:o,pad:i,includeBatchInIndex:c}=e,u=t;V(n.shape.length===4,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(n.shape.length,"."));const h=[1,1];V(jn(o,h),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(h,"'"));const p=pr(n.shape,a,o,h,i),[f,g]=lue(n,c,p,u);return[f,g]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uue(s,e,t,n){const a=Ae(e),i=Ae(s.shape)/a,c=Ye({inputs:{x:s},attrs:{shape:[i,a]},backend:n}),u=cc(c,"float32","mean",n),h=Ye({inputs:{x:u},attrs:{shape:t},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const due={kernelName:Vg,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{x:n}=s,{keepDims:a,axis:o}=e,i=t,c=n.shape.length,u=Rt(o,n.shape);let h=u;const p=ws(h,c),f=p!=null,g=i.shouldExecuteOnCPU([n]),b=[];let y=n;if(f){if(g){const I=i.texData.get(y.dataId).values,$=new Array(c);for(let P=0;P<$.length;P++)$[P]=n.shape[p[P]];const R=zw(I,n.shape,n.dtype,p,$);y=i.makeTensorInfo($,n.dtype);const O=i.texData.get(y.dataId);O.values=R}else y=e0(n,p,i);b.push(y),h=Fs(h.length,c)}kn("sum",h,c);const[w,v]=gn(y.shape,h);let N=w;a&&(N=_s(w,u));const C=uue(y,v,N,i);for(const T of b)i.disposeIntermediateTensorInfo(T);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=Rt(o,a.shape);let h=u;const p=ws(h,c);let f=a;p!=null&&(f=Hn({inputs:{x:a},backend:t,attrs:{perm:p}}),h=Fs(h.length,a.shape.length)),kn("min",h,c);const[g,b]=gn(f.shape,h),y=Ae(b),w=Ye({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=cc(w,w.dtype,"min",t);let N;if(i){const C=_s(g,u);N=Ye({inputs:{x:v},backend:t,attrs:{shape:C}})}else N=Ye({inputs:{x:v},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(v),p!=null&&t.disposeIntermediateTensorInfo(f),N}const pue={kernelName:Ug,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue=Bw+"\n  return min(a, b);\n",mue="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+lc+"\n  return result;\n",gue=In({opSnippet:fue,packedOpSnippet:mue,cpuKernelImpl:tae}),xue={kernelName:sp,backendName:"webgl",kernelFunc:gue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((p,f)=>p[0]+e[f]+p[1]);const a=e.length,o=ss(a),i=t.map(p=>p[0]).join(","),c=t.map((p,f)=>p[0]+e[f]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),h=n==="reflect"?0:1;if(a===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(h,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(h,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ");return}this.userCode="\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(h,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(h,";\n          }\n        }\n        ").concat(o," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yue{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,w)=>y[0]+e[w]+y[1]);const a=e.length,o=ss(a),i=t.map(y=>y[0]).join(","),c=t.map((y,w)=>y[0]+e[w]).join(","),u=Gn("rc",a),h=Gn("source",a),p="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=a===1?"source":"vec2(".concat(h.slice(-2).join(),")"),g=n==="reflect"?0:1;let b="";if(a===1){const y="\n        ".concat(o," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(g,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(g,";\n        }\n        source -= start;\n      ");b="\n        ".concat(o," rc = outputLoc;\n        ").concat(y,"\n        result[0] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(p,") {\n          ").concat(y,"\n          result[1] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n      ")}else{const y="\n        ".concat(o," source = rc;\n        ").concat(o," lt = ").concat(o,"(lessThan(source, start));\n        ").concat(o," gte = ").concat(o,"(greaterThanEqual(source, end));\n        ").concat(o," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(g,") +\n                gte * ((end - 1) * 2 - source + ").concat(g,");\n        source -= start;\n      ");b="\n        ".concat(o," rc = outputLoc;\n        ").concat(y,"\n        result[0] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(p,") {\n          ").concat(y,"\n          result[1] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(y,"\n          result[2] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(p,") {\n            ").concat(y,"\n            result[3] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue=({inputs:s,backend:e,attrs:t})=>{const{x:n}=s,{paddings:a,mode:o}=t,i=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yue(n.shape,a,o):new bue(n.shape,a,o);return e.runWebGLProgram(i,[n],n.dtype)},wue={kernelName:Gg,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nue="if (b == 0.0) return NAN;\n  return mod(a, b);",Sue="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+lc+"\n  return result;\n",Cue=In({opSnippet:Nue,packedOpSnippet:Sue}),jue={kernelName:np,backendName:"webgl",kernelFunc:Cue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kue{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",Iue="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",MD=In({opSnippet:Tue,packedOpSnippet:Iue,checkOutOfBounds:!0}),$ue={kernelName:Bh,backendName:"webgl",kernelFunc:MD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xj="return a - b;",PD=In({opSnippet:xj,packedOpSnippet:xj,supportsComplex:!0,cpuKernelImpl:Nae}),Aue={kernelName:yp,backendName:"webgl",kernelFunc:PD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zD(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{dim:o}=n,i=Rt([o],a.shape),c=LD({inputs:{x:a},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),u=_s(c.shape,i),h=Ye({inputs:{x:c},backend:t,attrs:{shape:u}}),p=PD({inputs:{a,b:h},backend:t}),f=OD({inputs:{x:p},backend:t}),g=t0({inputs:{x:f},backend:t,attrs:{axis:i,keepDims:!1}}),b=Ye({inputs:{x:g},backend:t,attrs:{shape:u}}),y=MD({inputs:{a:f,b},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),y}const Eue={kernelName:lx,backendName:"webgl",kernelFunc:zD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(s){const{inputs:e,backend:t,attrs:n}=s,{logits:a}=e,{numSamples:o,seed:i,normalized:c}=n,u=c?a:zD({inputs:{logits:a},backend:t,attrs:{dim:a.shape.length-1}}),h=u.shape[0],p=u.shape[1],f=new kue(h,p,o),g=[[i]],b=t.runWebGLProgram(f,[u],"int32",g);return c||t.disposeIntermediateTensorInfo(u),b}const Rue={kernelName:g2,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue=mr+"\n  return -x;\n",_ue="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";function Fue(s){const{inputs:e,backend:t}=s,{x:n}=e;if(t.shouldExecuteOnCPU([n])){const o=t.texData.get(n.dataId),[i,c]=nae(o.values,n.shape,n.dtype);return t.makeTensorInfo(c,n.dtype,i)}let a;return Se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ii(n.shape,_ue):a=new Yr(n.shape,Oue),t.runWebGLProgram(a,[n],n.dtype)}const Lue={kernelName:Wg,backendName:"webgl",kernelFunc:Fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue=kv;function Pue(s){Oa("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u}=n,h=t.readSync(a.dataId),p=t.readSync(o.dataId),{selectedIndices:f}=Mue(h,p,i,c,u);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const zue={kernelName:x2,backendName:"webgl",kernelFunc:Pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue=Tv;function Vue(s){Oa("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,padToMaxOutputSize:h}=n,p=t.readSync(a.dataId),f=t.readSync(o.dataId),{selectedIndices:g,validOutputs:b}=Bue(p,f,i,c,u,h);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([],"int32",new Int32Array([b]))]}const Uue={kernelName:b2,backendName:"webgl",kernelFunc:Vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gue=Iv;function Wue(s){Oa("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:n}=s,{boxes:a,scores:o}=e,{maxOutputSize:i,iouThreshold:c,scoreThreshold:u,softNmsSigma:h}=n,p=t.readSync(a.dataId),f=t.readSync(o.dataId),g=i,b=c,y=u,w=h,{selectedIndices:v,selectedScores:N}=Gue(p,f,g,b,y,w);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const Hue={kernelName:y2,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class que{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kue=s=>{const{inputs:e,backend:t,attrs:n}=s,{indices:a}=e,{dtype:o,depth:i,onValue:c,offValue:u}=n,h=Ae(a.shape),p=new que(h,i,c,u),f=Ye({inputs:{x:a},backend:t,attrs:{shape:[h]}}),g=t.runWebGLProgram(p,[f],o);t.disposeIntermediateTensorInfo(f);const b=[...a.shape,i],y=Ye({inputs:{x:g},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(g),y},Xue={kernelName:Kg,backendName:"webgl",kernelFunc:Kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function og(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="complex64"){const a=qp({inputs:{input:n},backend:t}),o=og({inputs:{x:a},backend:t}),i=s0({inputs:{input:n},backend:t}),c=og({inputs:{x:i},backend:t}),u=tl({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return Kp({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:t})}const Yue={kernelName:hx,backendName:"webgl",kernelFunc:og};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BD(s){const{inputs:e,backend:t}=s,{x:n}=e;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){const a=qp({inputs:{input:n},backend:t}),o=BD({inputs:{x:a},backend:t}),i=s0({inputs:{input:n},backend:t}),c=og({inputs:{x:i},backend:t}),u=tl({inputs:{real:o,imag:c},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),u}else return Kp({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:t})}const Zue={kernelName:qg,backendName:"webgl",kernelFunc:BD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(s){const{inputs:e,backend:t,attrs:n}=s,{axis:a}=n;if(e.length===1)return Ey({inputs:{input:e[0]},backend:t,attrs:{dim:a}});const o=e[0].shape,i=e[0].dtype;e.forEach(p=>{ja(o,p.shape,"All tensors passed to stack must have matching shapes"),V(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});const c=[],u=e.map(p=>{const f=Ey({inputs:{input:p},backend:t,attrs:{dim:a}});return c.push(f),f}),h=kD({inputs:u,backend:t,attrs:{axis:a}});return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const Jue={kernelName:Xg,backendName:"webgl",kernelFunc:Que};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ede{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((h,p)=>h[0]+e[p]+h[1]);const a=e.length,o=ss(a),i=t.map(h=>h[0]).join(","),c=t.map((h,p)=>h[0]+e[p]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ");return}this.userCode="\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(o," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tde{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,v)=>w[0]+e[v]+w[1]);const a=e.length,o=ss(a),i=t.map(w=>w[0]).join(","),c=t.map((w,v)=>w[0]+e[v]).join(","),u=Gn("rc",a),h=Gn("source",a),p="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=a===1?"source":"vec2(".concat(h.slice(-2).join(),")"),g=["".concat(o," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(p,") {\n      "),a===1?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),a===1?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(p,") {")],b=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let w=0,v=a===1?2:4;w<v;w++)y+="\n        ".concat(g[w],"\n        if (").concat(b,") {\n          result[").concat(w,"] = float(value);\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(w,"] = getChannel(getX(").concat(h.join(),"), ").concat(f,");\n        }\n      ");y+=a===1?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{paddings:o,constantValue:i}=n;if(Ae(a.shape)===0){const h=o.map((p,f)=>p[0]+a.shape[f]+p[1]);return Kp({backend:t,attrs:{shape:h,value:i,dtype:a.dtype}})}const c=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tde(a.shape,o,i):new ede(a.shape,o,i),u=[[i]];return t.runWebGLProgram(c,[a],a.dtype,u)},sde={kernelName:Yg,backendName:"webgl",kernelFunc:VD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nde="\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",ade="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+lc+"\n  return result;\n",rde=In({opSnippet:nde,packedOpSnippet:ade}),ode={kernelName:rp,backendName:"webgl",kernelFunc:rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{axis:o,keepDims:i}=n,c=a.shape.length,u=[],h=Rt(o,a.shape);let p=h;const f=ws(p,c);let g=a;f!=null&&(g=Hn({inputs:{x:a},backend:t,attrs:{perm:f}}),p=Fs(p.length,c),u.push(g)),kn("prod",p,c);let b;if(t.shouldExecuteOnCPU([g])){const y=t.texData.get(g.dataId).values,{outVals:w,outShape:v,outDtype:N}=rae(g.shape,g.dtype,y,p);b=t.makeTensorInfo(v,N,w)}else{const[y,w]=gn(g.shape,p),v=Ae(w),N=Ye({inputs:{x:g},backend:t,attrs:{shape:[-1,v]}}),C=G2(a.dtype),T=cc(N,C,"prod",t);b=Ye({inputs:{x:T},backend:t,attrs:{shape:y}}),u.push(N),u.push(T)}if(i){u.push(b);const y=_s(b.shape,h);b=Ye({inputs:{x:b},backend:t,attrs:{shape:y}})}return u.forEach(y=>t.disposeIntermediateTensorInfo(y)),b}const lde={kernelName:Qg,backendName:"webgl",kernelFunc:ide};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(s){const{inputs:e,backend:t,attrs:n}=s,{paramsNestedSplits:a,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:c}=n,u=a.map(N=>t.readSync(N.dataId)),h=a.map(N=>N.shape),p=t.readSync(o.dataId),f=t.readSync(i.dataId),[g,b,y]=oae(u,h,p,o.shape,o.dtype,f,i.shape,c),w=g.map(N=>t.makeTensorInfo([N.length],"int32",N)),v=t.makeTensorInfo(y,o.dtype,b);return w.concat([v])}const ude={kernelName:v2,backendName:"webgl",kernelFunc:cde};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(s){const{inputs:e,backend:t}=s,{starts:n,limits:a,deltas:o}=e,i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=iae(i,n.shape,n.dtype,c,a.shape,u,o.shape),f=t.makeTensorInfo([h.length],"int32",h),g=t.makeTensorInfo([p.length],n.dtype,p);return[f,g]}const hde={kernelName:w2,backendName:"webgl",kernelFunc:dde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pde(s){const{inputs:e,backend:t,attrs:n}=s,{shape:a,values:o,defaultValue:i,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=n,h=t.readSync(a.dataId),p=t.readSync(o.dataId),f=t.readSync(i.dataId),g=c.map(v=>t.readSync(v.dataId)),b=c.map(v=>v.shape),[y,w]=lae(h,a.shape,p,o.shape,o.dtype,f,i.shape,g,b,u);return t.makeTensorInfo(y,o.dtype,w)}const fde={kernelName:N2,backendName:"webgl",kernelFunc:pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UD=s=>{const{backend:e,attrs:t}=s,{start:n,stop:a,step:o,dtype:i}=t,c=cae(n,a,o,i);return e.makeTensorInfo([c.length],i,c)},mde={kernelName:S2,backendName:"webgl",kernelFunc:UD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde="return 1.0 / x;",xde=Gt({opSnippet:gde}),bde={kernelName:op,backendName:"webgl",kernelFunc:xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde=mr+"\n  return (x < 0.0) ? 0.0 : x;\n",vde="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",wde=Gt({opSnippet:yde,packedOpSnippet:vde}),Nde={kernelName:ip,backendName:"webgl",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde=mr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Cde="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",jde=Gt({opSnippet:Sde,packedOpSnippet:Cde}),kde={kernelName:lp,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tde{constructor(e,t,n,a,o){this.variableNames=["A"],this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n];let g;o?g="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(g,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ide{constructor(e,t,n,a,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n];let g;o?g="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(g,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n,[u,h]=c,p=Se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ide(a.shape,u,h,o,i):new Tde(a.shape,u,h,o,i);return t.runWebGLProgram(p,[a],"float32")}const Ade={kernelName:tx,backendName:"webgl",kernelFunc:$de};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ede{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,o]=t,[,i,c]=e,u=[n&&i>1?a-1:a,n&&c>1?o-1:o],h=[n&&i>1?i-1:i,n&&c>1?c-1:c],p=u[0]/h[0],f=u[1]/h[1],g=1/p,b=1/f,y=Math.ceil(g)*2+2,w=Math.ceil(b)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(b,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(w,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n,c=new Ede(o.shape,a.shape,i);return t.runWebGLProgram(c,[o],o.dtype)}const Rde={kernelName:k2,backendName:"webgl",kernelFunc:Dde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ode{constructor(e,t,n,a,o){this.variableNames=["A"],this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n],g=a?"0.5":"0.0";let b;o?b="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":b="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(b,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _de{constructor(e,t,n,a,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,c,u,h]=e;this.outputShape=[i,t,n,h];const p=[a&&t>1?c-1:c,a&&n>1?u-1:u],f=[a&&t>1?t-1:t,a&&n>1?n-1:n],g=a?"0.5":"0.0";let b;o?b="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":b="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(b,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a}=e,{alignCorners:o,halfPixelCenters:i,size:c}=n,[u,h]=c,p=Se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new _de(a.shape,u,h,o,i):new Ode(a.shape,u,h,o,i);return t.runWebGLProgram(p,[a],a.dtype)}const Lde={kernelName:ex,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mde{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,o]=t,[,i,c]=e,u=[n&&i>1?a-1:a,n&&c>1?o-1:o],h=[n&&i>1?i-1:i,n&&c>1?c-1:c],p=u[0]/h[0],f=u[1]/h[1],g=1/p,b=1/f,y=Math.ceil(g)*2+2,w=Math.ceil(b)*2+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(b,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(w,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(u[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(u[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(s){const{inputs:e,backend:t,attrs:n}=s,{images:a,dy:o}=e,{alignCorners:i}=n,c=new Mde(o.shape,a.shape,i);return t.runWebGLProgram(c,[o],o.dtype)}const zde={kernelName:j2,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bde{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,n===1){this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ");return}const a=c=>t.indexOf(c)!==-1&&e[c]!==1?"".concat(e[c]," - coords[").concat(c,"] - 1"):"coords[".concat(c,"]"),o=e.map((c,u)=>a(u)).join(","),i=ss(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vde{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const a=Gn("rc",n),o="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),c=ss(n);n===1?this.userCode="\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):this.userCode="\n        void main() {\n          ".concat(c," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(u(a.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(h(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(p(a.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(f(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ");function u(y){return g(y)}function h(y){return y[n-1]="("+y[n-1]+" + 1)",g(y)}function p(y){return y[n-2]="("+y[n-2]+" + 1)",g(y)}function f(y){return y[n-1]="("+y[n-1]+" + 1)",y[n-2]="("+y[n-2]+" + 1)",g(y)}function g(y){const w=e.map((C,T)=>b(T,y)),v=w.join(","),N=w.slice(-2).join(",");return"getChannel(getX(".concat(v,"), vec2(").concat(N,"))")}function b(y,w){return t.indexOf(y)!==-1&&e[y]!==1?"".concat(e[y]," - ").concat(w[y]," - 1"):"".concat(w[y])}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ude(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{dims:o}=n,i=a.shape.length,c=Rt(o,a.shape);if(i===0)return Ca({inputs:{x:a},backend:t});const u=Se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vde(a.shape,c):new Bde(a.shape,c);return t.runWebGLProgram(u,[a],a.dtype)}const Gde={kernelName:sx,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wde{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],a=e[2];this.outputShape=e;let o="";typeof t=="number"?o="float outputValue = ".concat(t.toFixed(2),";"):o="\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(o,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hde={kernelName:U2,backendName:"webgl",kernelFunc:({inputs:s,attrs:e,backend:t})=>{const{image:n}=s,{radians:a,fillValue:o,center:i}=e,c=t,u=new Wde(n.shape,o),[h,p]=Bv(i,n.shape[1],n.shape[2]),f=[[h,p,Math.sin(a),Math.cos(a)]];return c.runWebGLProgram(u,[n],n.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",Kde=Gt({opSnippet:qde}),Xde={kernelName:cp,backendName:"webgl",kernelFunc:Kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yde="return inversesqrt(x);",Zde=Gt({opSnippet:Yde,cpuKernelImpl:uae}),Qde={kernelName:up,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gw{constructor(e,t,n,a,o,i,c=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const h=ss(o.length),p=ss(i.length);let f="";n===1?f="i":n===2&&(f="i, j");const g="getIndices(".concat(f,")");let b="";a===1?b="i":a===2&&(b="i, coords[1]");const y="getUpdates(".concat(b,")");let w="";u&&(w="coords[0], coords[1]");const v="getDefaultValue(".concat(w,")"),N=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(h," strides = ").concat(h,"(").concat(o,");\n\n        void main() {\n          ").concat(p," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(g,");\n              flattenedIndex += index * ").concat(N,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(y,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(v,", sum, float(found)));\n        }\n      ")}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e,t,n,a,o,i,c=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const h=ss(o.length),p=ss(i.length);let f="";n===1?f="i":n===2&&(f="i, j");const g="getIndices(".concat(f,")");let b="";a===1?b="i":a===2&&(b="i, coords[1]");const y="getUpdates(".concat(b,")");let w="";u&&(w="coords[0], coords[1]");const v="getDefaultValue(".concat(w,")"),N=t>1?"strides[j]":"strides",C=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(h," strides = ").concat(h,"(").concat(o,");\n\n        void main() {\n          ").concat(p," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(g,");\n              flattenedIndex += index.xz * ").concat(N,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(C,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(y,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(v,", sum, found));\n        }\n      ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(s){const{inputs:e,backend:t,attrs:n}=s,{indices:a,updates:o}=e,{shape:i}=n,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(o,a,i),g=[f/h,h];if(f===0)return t.makeTensorInfo(i,a.dtype);const b=Ye({inputs:{x:a},backend:t,attrs:{shape:[u,c]}}),y=Ye({inputs:{x:o},backend:t,attrs:{shape:[u,h]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;Se().getBool("WEBGL_PACK")?v=new Jde(u,c,b.shape.length,y.shape.length,p,g):v=new Gw(u,c,b.shape.length,y.shape.length,p,g);const N=t.runWebGLProgram(v,[y,b,w],y.dtype),C=Ye({inputs:{x:N},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(w),C}const the={kernelName:T2,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class she{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const o="while (left < right) {",i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),c=Se().getNumber("WEBGL_VERSION")===2?o:i,u=a==="left"?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(c,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(u," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(s){const{inputs:e,backend:t,attrs:n}=s,{sortedSequence:a,values:o}=e,{side:i}=n,c=new she(a.shape[0],a.shape[1],o.shape[1],i),u=[[a.shape[1]]];return t.runWebGLProgram(c,[a,o],"int32",u)}const ahe={kernelName:$2,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rhe{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let a,o;if(n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(n===1)o="resRC",a="resRC";else{const c=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],h=[];for(let p=0;p<t.length;p++)h.push("".concat(c[p])),p<e&&u.push("".concat(c[p]));a=u.join(),o=h.join()}const i=ss(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(o,"));\n        } else {\n          setOutput(getB(").concat(o,"));\n        }\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(s){const{inputs:e,backend:t}=s,{condition:n,t:a,e:o}=e,i=new rhe(n.shape.length,a.shape,a.shape.length);return t.runWebGLProgram(i,[n,a,o],wa(a.dtype,o.dtype))}const ihe={kernelName:nx,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Mx,";\n  float scale = ").concat(Px,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),che=Gt({opSnippet:lhe}),uhe={kernelName:dp,backendName:"webgl",kernelFunc:che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=Hu+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",hhe="\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",phe=Gt({opSnippet:dhe,packedOpSnippet:hhe,cpuKernelImpl:hae}),fhe={kernelName:mp,backendName:"webgl",kernelFunc:phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe="\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n",ghe=Gt({opSnippet:mhe}),xhe={kernelName:fp,backendName:"webgl",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bhe=Hu+"\n  return sin(x);\n",yhe="\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(lc,"\n  return result;\n"),vhe=Gt({opSnippet:bhe,packedOpSnippet:yhe}),whe={kernelName:hp,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",She=Gt({opSnippet:Nhe}),Che={kernelName:pp,backendName:"webgl",kernelFunc:She};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",khe=Gt({opSnippet:jhe}),The={kernelName:gp,backendName:"webgl",kernelFunc:khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ihe=s=>{const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{blockShape:o,paddings:i}=n;V(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const c=o.reduce((N,C)=>N*C),u=[[0,0]];u.push(...i);for(let N=1+o.length;N<a.shape.length;++N)u.push([0,0]);const h=[],p=VD({inputs:{x:a},backend:t,attrs:{paddings:u,constantValue:0}}),f=Dp(p.shape,o,c,!1),g=Rp(f.length,o.length,!1),b=Op(p.shape,o,c,!1),y=Ye({inputs:{x:p},backend:t,attrs:{shape:f}}),w=Hn({inputs:{x:y},backend:t,attrs:{perm:g}}),v=Ye({inputs:{x:w},backend:t,attrs:{shape:b}});return h.push(p),h.push(y),h.push(w),h.forEach(N=>t.disposeIntermediateTensorInfo(N)),v},$he={kernelName:ox,backendName:"webgl",kernelFunc:Ihe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(s){const{inputs:e,backend:t}=s,{indices:n,values:a,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(n.shape.length!==2)throw new Error("Indices must be a matrix, saw:\n         ".concat(n.shape));if(a.shape.length!==1)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(i.shape.length!==0)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const c=t.readSync(n.dataId),u=t.readSync(a.dataId),h=t.readSync(o.dataId),p=t.readSync(i.dataId)[0],[f,g,b,y,w]=fae(c,n.shape,n.dtype,u,a.dtype,h,p);return[t.makeTensorInfo(g,n.dtype,f),t.makeTensorInfo([g[0]],a.dtype,b),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([w.length],n.dtype,new Int32Array(w))]}const Ehe={kernelName:A2,backendName:"webgl",kernelFunc:Ahe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(s){const{inputs:e,backend:t}=s,{inputIndices:n,inputShape:a,newShape:o}=e;if(n.shape.length!==2)throw new Error("Input indices should be a matrix but received shape ".concat(n.shape));if(a.shape.length!==1)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(o.shape.length!==1)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const i=Array.from(t.readSync(a.dataId)),c=t.readSync(n.dataId),u=Array.from(t.readSync(o.dataId)),[h,p,f]=mae(c,n.shape,n.dtype,i,u);return[t.makeTensorInfo(p,n.dtype,h),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const Rhe={kernelName:E2,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));const i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=pD(i,n.shape,n.dtype,c,u,!0);return t.makeTensorInfo(p,n.dtype,h)}const _he={kernelName:D2,backendName:"webgl",kernelFunc:Ohe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(s){const{inputs:e,backend:t}=s,{data:n,indices:a,segmentIds:o}=e;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(o.shape.length!==1)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));const i=t.readSync(n.dataId),c=t.readSync(a.dataId),u=t.readSync(o.dataId),[h,p]=pD(i,n.shape,n.dtype,c,u);return t.makeTensorInfo(p,n.dtype,h)}const Lhe={kernelName:R2,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(s){const{inputs:e,backend:t,attrs:n}=s,{sparseIndices:a,sparseValues:o,defaultValue:i}=e,{outputShape:c}=n,{sliceRank:u,numUpdates:h,sliceSize:p,strides:f,outputSize:g}=nc(o,a,c),b=!1;if(o.dtype==="string"){const N=t.bufferSync(a),C=t.bufferSync(o),T=Ri(t.readSync(i.dataId)[0]),I=dae(N,C,c,g,p,h,u,f,T,b);return t.makeTensorInfo(c,I.dtype,I.values)}const y=new Gw(h,u,a.shape.length,o.shape.length,f,[g,1],b),w=t.runWebGLProgram(y,[o,a,i],o.dtype),v=Ye({inputs:{x:w},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(w),v}const Phe={kernelName:O2,backendName:"webgl",kernelFunc:Mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{numOrSizeSplits:o,axis:i}=n,c=Rt(i,a.shape)[0],u=sw(a,o,c),h=a.shape.length,p=new Array(h).fill(0),f=a.shape.slice();return u.map(g=>{const b=[...f];b[c]=g;const y=qu({inputs:{x:a},backend:t,attrs:{begin:p,size:b}});return p[c]+=g,y})}const Bhe={kernelName:ix,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bj="return sqrt(x);",Vhe=Gt({opSnippet:bj,packedOpSnippet:bj,cpuKernelImpl:gae}),Uhe={kernelName:xp,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe="return x * x;",Whe=Gt({opSnippet:Ghe}),Hhe={kernelName:_2,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yj="return (a - b) * (a - b);",qhe=In({opSnippet:yj,packedOpSnippet:yj}),Khe={kernelName:bp,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const o=t.readSync(a.dataId),i=Mo(o),c=xae(i,"string",n);return t.makeTensorInfo(a.shape,"string",c)}const Yhe={kernelName:cx,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe({inputs:s,attrs:e,backend:t}){const{x:n}=s,a=mr+"\n    return x > 0.0 ? 1.0 : float(".concat(e.alpha,");\n  "),o=new Yr(n.shape,a);return t.runWebGLProgram(o,[n],n.dtype)}const Qhe={kernelName:Sp,backendName:"webgl",kernelFunc:Zhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jhe{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const a=n.length,o=ss(n.length),i=ss(n.length);let c="";if(a===1)c="coords * strides + begin";else{let u=0;c=n.map((h,p)=>(u++,n.length===1?"coords * strides[".concat(p,"] + begin[").concat(p,"]"):"coords[".concat(u-1,"] * strides[").concat(p,"] + begin[").concat(p,"]"))).join(",")}this.userCode="\n      ".concat(o," begin = ").concat(o,"(").concat(e,");\n      ").concat(o," strides = ").concat(o,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(c,"));\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function epe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{begin:o,end:i,strides:c,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:g}=n,{finalShapeSparse:b,finalShape:y,isIdentity:w,sliceDim0:v,isSimpleSlice:N,begin:C,end:T,strides:I}=Mv(a.shape,o,i,c,u,h,p,f,g);let $;if(w)$=Ye({inputs:{x:a},backend:t,attrs:{shape:y}});else if(v||N){V(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const O=_v(C,T,I),P=qu({inputs:{x:a},backend:t,attrs:{begin:C,size:O}});$=Ye({inputs:{x:P},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(P)}else if(t.shouldExecuteOnCPU([a])){const P=t.readSync(a.dataId),_=Dt(a.shape,a.dtype,P),M=bae(b,_,I,C);$=t.makeTensorInfo(y,a.dtype,M.values)}else{const P=new Jhe(C,I,b);$=t.runWebGLProgram(P,[a],a.dtype)}const R=Ye({inputs:{x:$},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo($),R}const tpe={kernelName:F2,backendName:"webgl",kernelFunc:epe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spe(s){const{inputs:e,backend:t,attrs:n}=s,{separator:a,nGramWidths:o,leftPad:i,rightPad:c,padWidth:u,preserveShortSequences:h}=n,{data:p,dataSplits:f}=e,g=t.readSync(p.dataId),b=t.readSync(f.dataId),[y,w]=yae(g,b,a,o,i,c,u,h);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",w)]}const npe={kernelName:L2,backendName:"webgl",kernelFunc:spe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(s){const{inputs:e,backend:t,attrs:n}=s,{skipEmpty:a}=n,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(i.shape.length!==0)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const c=t.readSync(o.dataId),u=t.readSync(i.dataId)[0],[h,p,f]=vae(c,u,a),g=p.length;return[t.makeTensorInfo([g,2],"int32",h),t.makeTensorInfo([g],"string",p),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const rpe={kernelName:M2,backendName:"webgl",kernelFunc:ape};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ope(s){const{inputs:e,backend:t,attrs:n}=s,{numBuckets:a}=n,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(o.dataId),c=wae(i,a);return t.makeTensorInfo(o.shape,"int32",c)}const ipe={kernelName:P2,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe="return tan(x);",cpe=Gt({opSnippet:lpe}),upe={kernelName:vp,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",hpe=Gt({opSnippet:dpe}),ppe={kernelName:wp,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(s){const{inputs:e,backend:t,attrs:n}=s,{tensor:a,indices:o,updates:i}=e,{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=nc(i,o,a.shape),g=[f/h,h];if(f===0)return t.makeTensorInfo(a.shape,o.dtype);const b=Ye({inputs:{x:o},backend:t,attrs:{shape:[u,c]}}),y=Ye({inputs:{x:i},backend:t,attrs:{shape:[u,h]}}),w=Ye({inputs:{x:a},backend:t,attrs:{shape:g}}),v=new Gw(u,c,b.shape.length,y.shape.length,p,g,!1,!0),N=t.runWebGLProgram(v,[y,b,w],w.dtype),C=Ye({inputs:{x:N},backend:t,attrs:{shape:a.shape}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(N),C}const mpe={kernelName:I2,backendName:"webgl",kernelFunc:fpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gpe{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;const a=ss(this.rank),o=xpe(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}}function xpe(s){const e=s.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(e===1)return"imod(resRC, ".concat(s[0],")");const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let a=0;a<s.length;a++)n.push("imod(".concat(t[a],", ").concat(s[a],")"));return n.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GD(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{reps:o}=n;if(a.dtype==="string"||a.shape.length>5){const u=t.readSync(a.dataId),h=a.dtype==="string"?u.map(g=>Ri(g)):u,p=Dt(a.shape,a.dtype,h),f=Sae(p,o);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const i=new gpe(a.shape,o);return t.runWebGLProgram(i,[a],a.dtype)}const bpe={kernelName:Np,backendName:"webgl",kernelFunc:GD};class ype{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class vpe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(s,e){e!==null&&s.disposeIntermediateTensorInfo(e)}function vj(s){let e=1;for(;e<s;)e*=2;return e}function wpe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a}=e,{k:o,sorted:i}=n,c=Se().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=Se().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),h=a.shape,p=h[h.length-1];if(t.shouldExecuteOnCPU([a])||p<c||o>u){const M=t.readSync(a.dataId),[A,U]=Cae(M,h,a.dtype,o,i);return[t.makeTensorInfo(A.shape,A.dtype,A.values),t.makeTensorInfo(U.shape,U.dtype,U.values)]}if(o===0)return h[h.length-1]=0,[t.makeTensorInfo(h,a.dtype,[]),t.makeTensorInfo(h,"int32",[])];if(p===1)return[a,Kp({attrs:{shape:h,dtype:"int32",value:0},backend:t})];const f=t.texData.get(a.dataId),g=f!==null&&f.isPacked,b=g?t.unpackTensor(a):a,w=Ae(h)/p,v=Ye({inputs:{x:b},attrs:{shape:[w,p]},backend:t});g&&Tl(t,b);const N=vj(o),C=vj(p);let T=null;const I=()=>T===null?[v,v]:[v,T],$=(M,A,U)=>{const K=I(),Q=new ype(U),B=[[p],[T===null?1:0],[Number.NEGATIVE_INFINITY],[M],[A]],G=T;T=t.runWebGLProgram(Q,K,"int32",B),Tl(t,G)};for(let M=1;M<N;M*=2){const A=M*2;for(let U=M;U>=1;U/=2)$(A,U,[w,C])}for(let M=C;M>N;M/=2){const A=I(),U=new vpe([w,M/2]),Q=[[p],[T===null?1:0],[N]],X=T;T=t.runWebGLProgram(U,A,"int32",Q),Tl(t,X);const B=N/2,G=B*2;for(let Y=B;Y>=1;Y/=2)$(G,Y,T.shape)}let R=T;T=qu({inputs:{x:T},backend:t,attrs:{begin:0,size:[w,o]}}),Tl(t,R);let O=FD({inputs:{x:v,indices:T},backend:t,attrs:{axis:1,batchDims:1}});Tl(t,v);const P=h.slice(0,-1);P.push(o),R=T,T=Ye({inputs:{x:T},attrs:{shape:P},backend:t}),Tl(t,R);const _=O;return O=Ye({inputs:{x:O},attrs:{shape:P},backend:t}),Tl(t,_),[O,T]}const Npe={kernelName:z2,backendName:"webgl",kernelFunc:wpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Spe{constructor(e,t,n,a,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const c=n==="nearest"?1:2;let u;switch(a){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(u," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(o,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(o,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(c," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpe(s){const{inputs:e,backend:t,attrs:n}=s,{image:a,transforms:o}=e,{interpolation:i,fillMode:c,fillValue:u,outputShape:h}=n,[p,f,g,b]=a.shape,[y,w]=h!=null?h:[f,g],v=[p,y,w,b],N=new Spe(f,g,i,c,u,v);return t.runWebGLProgram(N,[a,o],"float32")}const jpe={kernelName:B2,backendName:"webgl",kernelFunc:Cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(s){const{inputs:e,attrs:t,backend:n}=s,{axis:a}=t,{x:o}=e;Wp(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=n.readSync(o.dataId),{outputValues:c,outputShape:u,indices:h}=jae(i,a,o.shape,o.dtype);return[n.makeTensorInfo(u,o.dtype,c),n.makeTensorInfo([h.length],"int32",h)]}const Tpe={kernelName:V2,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(s){const{inputs:e,backend:t,attrs:n}=s,{value:a}=e;let{axis:o}=n;o<0&&(o+=a.shape.length);const i=a,c=i.shape.length,u=a.shape[o],h=new Array(c-1);let p=0;for(let w=0;w<c;w++)w!==o&&(h[p++]=i.shape[w]);const f=[],g=new Array(c).fill(0),b=i.shape.slice();b[o]=1;const y=new Array(u);for(let w=0;w<y.length;w++){g[o]=w;const v=qu({inputs:{x:i},backend:t,attrs:{begin:g,size:b}}),N=Ye({inputs:{x:v},backend:t,attrs:{shape:h}});y[w]=N,f.push(v)}return f.forEach(w=>t.disposeIntermediateTensorInfo(w)),y}const $pe={kernelName:ux,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ape{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,a=e.batchSize,o=e.inSize,i=e.numSegments,c=i*Math.ceil(o/n);this.outputShape=[a,c];const u="0.0",h="sumValue",p=Math.floor(n/4)*4,f=n%4,g="\n        sumValue += dot(values, segFilter);\n    ";let b="";o%n>0&&(b="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      "));let y="";o%n>0&&(y="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(b,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(y,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(p,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(g,"\n        }\n\n        int inIdx = inOffset + ").concat(p,";\n        if (").concat(f===1,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===2,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(g,"\n        } else if (").concat(f===3,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(g,"\n        }\n        setOutput(").concat(h,");\n      }\n    ")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Epe(s){const{inputs:e,backend:t,attrs:n}=s,{x:a,segmentIds:o}=e,{numSegments:i}=n,c=a.shape.length,u=[];let h=0;const p=ws([h],c);let f=a;p!=null&&(f=Hn({inputs:{x:a},backend:t,attrs:{perm:p}}),u.push(f),h=Fs(1,c)[0]);const g=yI(f.shape,h,i),b=Ae([f.shape[h]]),y=Ye({inputs:{x:f},backend:t,attrs:{shape:[-1,b]}});u.push(y);const w=G2(a.dtype),v=(I,$,R,O,P)=>{const _=I.shape[0],M=I.shape[1],A=bI(M,P),U={windowSize:A,inSize:M,batchSize:_,numSegments:P},K=new Ape(U,$),Q=t.compileAndRun(K,[I,R],O);if(u.push(Q),Q.shape[1]===P)return Q;const X=UD({backend:t,attrs:{start:0,stop:P,step:1,dtype:"float32"}}),B=GD({inputs:{x:X},backend:t,attrs:{reps:[M/A]}});return u.push(X),u.push(B),v(Q,$,B,O,P)},N=v(y,"unsortedSegmentSum",o,w,i),C=Ye({inputs:{x:N},backend:t,attrs:{shape:g}});let T=C;if(p!=null){u.push(C);const I=Xi(p);T=Hn({inputs:{x:T},backend:t,attrs:{perm:I}})}return u.forEach(I=>t.disposeIntermediateTensorInfo(I)),T}const Dpe={kernelName:dx,backendName:"webgl",kernelFunc:Epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpe=[gre,bre,wre,Cre,kre,$re,Ere,Rre,Lre,Pre,Vre,Wre,Kre,Qre,toe,noe,roe,coe,doe,poe,xoe,Coe,koe,Aoe,Doe,Moe,zoe,Goe,Jae,qoe,Qoe,sie,lie,die,pie,mie,xie,wie,Cie,Tie,$ie,Eie,Rie,Fie,Mie,Vie,Gie,qie,Yie,Qie,sle,ole,ule,ple,gle,xle,yle,wle,Sle,jle,Tle,Ele,Ole,Lle,Ple,Vle,Wle,Xle,Jle,Qae,tce,Yoe,ace,ice,uce,tre,fce,bce,vce,Cce,Tce,Ece,Oce,Mce,Vce,Wce,qce,Zce,Jce,tue,rue,iue,cue,due,pue,xue,wue,jue,Rue,are,Lue,zue,Uue,Hue,Ooe,Xue,Zue,Jue,sde,ode,nre,lde,ude,hde,fde,mde,_oe,$ue,bde,Nde,kde,ore,Ade,Rde,Lde,zde,Gde,Hde,Xde,Qde,the,ahe,ihe,uhe,fhe,xhe,whe,Che,Noe,Eue,The,$he,Ehe,Rhe,_he,Lhe,Phe,Bhe,Uhe,Hhe,Khe,Yhe,Qhe,tpe,npe,rpe,ipe,Aue,pre,upe,ppe,mpe,bpe,Npe,jpe,fre,Tpe,$pe,Dpe,Yue];for(const s of Rpe)Gj(s);const Ope=()=>{const s=F.useRef(null),e=F.useRef(null),t=xs(),[n,a]=F.useState(!1),[o,i]=F.useState("Please Wait..."),[c,u]=F.useState("loading"),[h,p]=F.useState("loading"),[f,g]=F.useState("loading");F.useEffect(()=>{const y=async()=>{try{const T=await navigator.mediaDevices.getUserMedia({video:!0});s.current.srcObject=T,await new Promise(I=>{s.current.onloadedmetadata=()=>{s.current.play(),I()}})}catch(T){console.error("Camera access error:",T),alert("Camera access denied. Please allow permissions.")}},w=async()=>{const T=await xW(Vm.MediaPipeFaceDetector,{runtime:"tfjs",modelType:"short"});return console.log("Face detection model loaded.."),T},v=()=>{console.log("inside checkLightingAndShadow");const T=e.current,I=T.getContext("2d");T.width=s.current.videoWidth,T.height=s.current.videoHeight,I.drawImage(s.current,0,0,T.width,T.height);const $=I.getImageData(0,0,T.width,T.height);let R=0;const O=[];for(let K=0;K<$.data.length;K+=4){const Q=$.data[K],X=$.data[K+1],B=$.data[K+2],G=.299*Q+.587*X+.114*B;R+=G,O.push(G)}const P=R/($.data.length/4),_=O.reduce((K,Q)=>K+Math.pow(Q-P,2),0)/O.length,M=Math.sqrt(_);console.log("Avg Brightness:",P,"Shadow:",M);let A="fail";return P>=40&&P<=200&&(A="pass"),{lightingStatus:A,shadowStatus:A==="pass"?"pass":"fail"}},N=async T=>{if(!s.current||!s.current.videoWidth||!s.current.videoHeight)return requestAnimationFrame(()=>N(T));const{lightingStatus:I,shadowStatus:$}=v();if(u(I),p($),(await T.estimateFaces(s.current,{flipHorizontal:!1})).length===0)return g("fail"),i(I==="fail"?" No face + Poor lighting/shadow.":" No face detected. Look at the camera."),a(!1),requestAnimationFrame(()=>N(T));g("pass"),I==="pass"?(a(!0),i(" All checks passed. Ready to continue!")):(a(!1),i(" Please adjust lighting.")),requestAnimationFrame(()=>N(T))};(async()=>{await R7("webgl"),await O7(),await y();const T=await w();N(T)})()},[]);const b=y=>y==="pass"?"":y==="fail"?"":r.jsx("span",{className:"loader"});return r.jsxs("div",{className:"face-validation-container",children:[r.jsx("div",{className:"video-wrapper",children:r.jsx("video",{ref:s,autoPlay:!0,muted:!0,playsInline:!0})}),r.jsxs("div",{className:"status-section",children:[r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(c),children:b(c)}),r.jsx("p",{children:"Lighting"})]}),r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(h),children:b(h)}),r.jsx("p",{children:"Shadows"})]}),r.jsxs("div",{className:"status-item",children:[r.jsx("span",{className:"status-icon ".concat(f),children:b(f)}),r.jsx("p",{children:"Face"})]})]}),r.jsx("p",{className:"status-message",children:o}),r.jsx("button",{className:"continue-button",onClick:()=>{t("/games")},disabled:!n,children:"Continue"}),r.jsx("canvas",{ref:e,style:{display:"none"}})]})};function _pe(){const s=Th(),e=xs(),t=()=>{s(Oy()),sessionStorage.clear(),e("/login")},n=a=>window.location.pathname===a;return r.jsxs("div",{className:"min-h-screen bg-white shadow-md w-64 px-4 py-6",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-[rgb(197,27,28)] mb-2",children:"SuperAdmin Panel"}),r.jsx("p",{className:"text-sm text-gray-600",children:"System Overview"})]}),r.jsxs("nav",{className:"space-y-2",children:[r.jsx(ot,{to:"/superadmin/dashboard",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/dashboard")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Dashboard"})}),r.jsx(ot,{to:"/superadmin/users",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/users")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Users"})}),r.jsx(ot,{to:"/superadmin/children",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/children")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Children"})}),r.jsx(ot,{to:"/superadmin/appointments",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/appointments")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Appointments"})}),r.jsx(ot,{to:"/superadmin/centres",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/centres")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Centres"})}),r.jsx(ot,{to:"/superadmin/doctor-registration",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/doctor-registration")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Doctor Registration"})}),r.jsx(ot,{to:"/superadmin/slot-management",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/slot-management")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Slot Management"})}),r.jsx(ot,{to:"/superadmin/system-health",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/superadmin/system-health")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"System Health"})}),r.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[r.jsx(ot,{to:"/profile",className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(n("/profile")?"bg-red-50 text-[rgb(197,27,28)]":"text-gray-600 hover:bg-gray-50"),children:r.jsx("span",{children:"Profile"})}),r.jsx("button",{onClick:t,className:"w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:r.jsx("span",{children:"Logout"})})]})]})]})}function Fpe(){var c,u;const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null),i=xs();return F.useEffect(()=>{(async()=>{try{const p=await Pe.get("/api/superadmin/analytics",{headers:{Authorization:sessionStorage.getItem("token")}});e(p.data),n(!1)}catch(p){o("Failed to fetch analytics data"),n(!1)}})()},[]),t?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen text-red-500",children:a}):r.jsx("div",{className:"min-h-screen bg-gray-100",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-8",children:"Super Admin Dashboard"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Users"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalUsers)||0}),r.jsx("div",{className:"mt-4",children:(c=s==null?void 0:s.usersByRole)==null?void 0:c.map(h=>r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{className:"capitalize",children:h._id}),r.jsx("span",{children:h.count})]},h._id))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Children"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalChildren)||0})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total IEPs"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalIEPs)||0})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Appointments"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalAppointments)||0}),r.jsx("div",{className:"mt-4",children:(u=s==null?void 0:s.appointmentsByStatus)==null?void 0:u.map(h=>r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{className:"capitalize",children:h._id}),r.jsx("span",{children:h.count})]},h._id))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Centres"}),r.jsx("p",{className:"text-3xl font-bold text-[rgb(197,27,28)]",children:(s==null?void 0:s.totalCentres)||0})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("button",{onClick:()=>i("/superadmin/users"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Users"})}),r.jsx("button",{onClick:()=>i("/superadmin/children"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Children"})}),r.jsx("button",{onClick:()=>i("/superadmin/ieps"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View IEPs"})}),r.jsx("button",{onClick:()=>i("/superadmin/appointments"),className:"p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"View Appointments"})})]})]})})}const Lpe=({user:s,onClose:e})=>{var t;return s?r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md m-4 p-6 relative",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition duration-150","aria-label":"Close",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsxs("h3",{className:"text-xl font-bold text-[rgb(197,27,28)] mb-4 border-b pb-2",children:[s.name,"'s Details"]}),r.jsxs("div",{className:"space-y-3 text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Role:"}),r.jsx("span",{className:"capitalize",children:s.role})]}),r.jsx("p",{}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Phone:"}),s.mobilenumber||"N/A"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold w-24 inline-block",children:"Centre:"}),((t=s.centreId)==null?void 0:t.name)||"-"]})]})]})}):null},Mpe=({user:s,onBack:e,onSubmit:t})=>{const[n,a]=F.useState(""),[o,i]=F.useState(!1),c=u=>{u.preventDefault(),!(o||!n.trim())&&(i(!0),t(n).catch(()=>{}).finally(()=>{i(!1)}))};return r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-xl",children:[r.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["Users > ",s.name," > Write Feedback"]}),r.jsxs("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-4",children:["Write Feedback for ",s.name]}),r.jsxs("form",{onSubmit:c,className:"space-y-4",children:[r.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[rgb(197,27,28)] focus:border-transparent min-h-[200px]",placeholder:"Enter your feedback for ".concat(s.name," here..."),value:n,onChange:u=>a(u.target.value),required:!0}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,disabled:o,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition disabled:opacity-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-[rgb(197,27,28)] text-white font-semibold rounded-lg hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center",children:o?r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Submit Feedback"})]})]})]})};function Ppe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(""),[u,h]=F.useState("all"),[p,f]=F.useState(1),[g]=F.useState(10),[b,y]=F.useState(null),[w,v]=F.useState(null),N=async()=>{try{const O=await Pe.get("/api/superadmin/users",{headers:{Authorization:sessionStorage.getItem("token")}});return e(O.data),n(!1),O.data}catch(O){throw o("Failed to fetch users data"),n(!1),O}};F.useEffect(()=>{N()},[]);const C=O=>{y(O)},T=O=>{v(O)},I=async(O,P)=>{var _;try{console.log("Submitting feedback for user:",O._id),await Pe.post("/api/superadmin/therapists/".concat(O._id,"/feedback"),{content:P},{headers:{Authorization:sessionStorage.getItem("token")}}),alert("Feedback for ".concat(O.name," saved successfully!")),v(null)}catch(M){throw console.error("Error saving feedback:",((_=M.response)==null?void 0:_.data)||M.message),alert("Failed to save feedback. Please check the console for error details."),M}},$=()=>{v(null)},R=s.filter(O=>{const P=O.name.toLowerCase().includes(i.toLowerCase()),_=u==="all"||O.role===u;return P&&_});return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):w?r.jsx(Mpe,{user:w,onBack:$,onSubmit:O=>I(w,O)}):r.jsxs("div",{className:"p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Users"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search users...",className:"px-4 py-2 border rounded-lg",value:i,onChange:O=>c(O.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:u,onChange:O=>h(O.target.value),children:[r.jsx("option",{value:"all",children:"All Roles"}),r.jsx("option",{value:"parent",children:"Parent"}),r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"therapist",children:"Therapist"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"superadmin",children:"Super Admin"})]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Role"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:R.slice((p-1)*g,p*g).map(O=>{var P;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("button",{onClick:()=>C(O),className:"flex items-center gap-1 text-[rgb(197,27,28)] hover:text-red-700 font-medium cursor-pointer transition duration-150 group",children:[r.jsx("span",{children:O.name}),r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 group-hover:text-red-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-label":"View Details",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),r.jsx("td",{className:"px-6 py-4 capitalize",children:O.role}),r.jsx("td",{className:"px-6 py-4",children:((P=O.centreId)==null?void 0:P.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:O.role==="therapist"&&r.jsx("button",{onClick:()=>T(O),className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full hover:bg-red-700 transition duration-150",children:"Write Feedback"})})]},O._id)})})]})}),R.length>g&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>f(O=>Math.max(O-1,1)),disabled:p===1,className:"px-4 py-2 rounded ".concat(p===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",p," of ",Math.ceil(R.length/g)]}),r.jsx("button",{onClick:()=>f(O=>Math.min(O+1,Math.ceil(R.length/g))),disabled:p>=Math.ceil(R.length/g),className:"px-4 py-2 rounded ".concat(p>=Math.ceil(R.length/g)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]}),r.jsx(Lpe,{user:b,onClose:()=>y(null)})]})}function zpe(){const s=xs(),[e,t]=F.useState([]),[n,a]=F.useState(!0),[o,i]=F.useState(null),[c,u]=F.useState(""),[h,p]=F.useState("all"),[f,g]=F.useState(1),[b]=F.useState(10);F.useEffect(()=>{(async()=>{try{const N=await Pe.get("/api/superadmin/children",{headers:{Authorization:sessionStorage.getItem("token")}});t(N.data),a(!1)}catch(N){i("Failed to fetch children data"),a(!1)}})()},[]);const y=[...new Set(e.map(v=>{var N;return((N=v.centreId)==null?void 0:N.name)||"Unassigned"}))],w=e.filter(v=>{var T;const N=v.name.toLowerCase().includes(c.toLowerCase()),C=h==="all"||((T=v.centreId)==null?void 0:T.name)===h;return N&&C});return n?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):o?r.jsx("div",{className:"text-red-500 text-center py-8",children:o}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Children"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search by name...",className:"px-4 py-2 border rounded-lg",value:c,onChange:v=>u(v.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:h,onChange:v=>p(v.target.value),children:[r.jsx("option",{value:"all",children:"All Centres"}),y.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Age"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Parent"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:w.slice((f-1)*b,f*b).map(v=>{var N,C;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:v.name}),r.jsx("td",{className:"px-6 py-4",children:Math.floor((new Date-new Date(v.dob))/(365.25*24*60*60*1e3))}),r.jsx("td",{className:"px-6 py-4",children:((N=v.parentId)==null?void 0:N.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((C=v.centreId)==null?void 0:C.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("button",{onClick:()=>s("/superadmin/children/".concat(v._id)),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded-lg hover:bg-[rgb(150,20,20)] transition-colors",children:"View Details"})})]},v._id)})})]})}),w.length>b&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>g(v=>Math.max(v-1,1)),disabled:f===1,className:"px-4 py-2 rounded ".concat(f===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",f," of ",Math.ceil(w.length/b)]}),r.jsx("button",{onClick:()=>g(v=>Math.min(v+1,Math.ceil(w.length/b))),disabled:f>=Math.ceil(w.length/b),className:"px-4 py-2 rounded ".concat(f>=Math.ceil(w.length/b)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function Bpe(){var g,b,y,w;const{childId:s}=Vo(),e=xs(),[t,n]=F.useState(null),[a,o]=F.useState(!0),[i,c]=F.useState(null),[u,h]=F.useState([]),[p,f]=F.useState([]);return F.useEffect(()=>{(async()=>{try{const[N,C,T]=await Promise.all([Pe.get("/api/superadmin/children/".concat(s),{headers:{Authorization:sessionStorage.getItem("token")}}),Pe.get("/api/superadmin/children/".concat(s,"/ieps"),{headers:{Authorization:sessionStorage.getItem("token")}}),Pe.get("/api/superadmin/children/".concat(s,"/appointments"),{headers:{Authorization:sessionStorage.getItem("token")}})]);n(N.data),h(C.data),f(T.data),o(!1)}catch(N){c("Failed to fetch child data"),o(!1)}})()},[s]),a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):i?r.jsx("div",{className:"text-red-500 text-center py-8",children:i}):r.jsxs("div",{className:"p-6",children:[r.jsxs(ot,{to:"/superadmin/children",className:"inline-flex items-center text-gray-600 hover:text-[rgb(197,27,28)] mb-6",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Children List"]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-4",children:t.name}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Age"}),r.jsxs("p",{className:"text-lg",children:[Math.floor((new Date-new Date(t.dob))/(365.25*24*60*60*1e3))," years"]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Date of Birth"}),r.jsx("p",{className:"text-lg",children:new Date(t.dob).toLocaleDateString()})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Gender"}),r.jsx("p",{className:"text-lg",children:t.gender})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Centre"}),r.jsx("p",{className:"text-lg",children:((g=t.centreId)==null?void 0:g.name)||"Not Assigned"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Parent Name"}),r.jsx("p",{className:"text-lg",children:((b=t.parentId)==null?void 0:b.name)||"Not Available"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Parent Contact"}),r.jsx("p",{className:"text-lg",children:((y=t.parentId)==null?void 0:y.mobilenumber)||"Not Available"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"School Name"}),r.jsx("p",{className:"text-lg",children:t.schoolName||"Not Specified"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"School Board"}),r.jsx("p",{className:"text-lg",children:t.schoolBoard||"Not Specified"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Admit Status"}),r.jsx("p",{className:"text-lg",children:t.admitStatus})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Doctor"}),r.jsx("p",{className:"text-lg",children:((w=t.doctorId)==null?void 0:w.name)||"Not Assigned"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Date of Joining"}),r.jsx("p",{className:"text-lg",children:t.dateOfJoining?new Date(t.dateOfJoining).toLocaleDateString():"Not Available"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Registration ID"}),r.jsx("p",{className:"text-lg",children:t.registrationId||"Not Available"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Case ID"}),r.jsx("p",{className:"text-lg",children:t.caseId||"Not Available"})]})]})]}),t.therapies&&t.therapies.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsx("h2",{className:"text-xl font-bold text-[rgb(197,27,28)] mb-4",children:"Therapies"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.therapies.map((v,N)=>{var C;return r.jsxs("div",{className:"border p-4 rounded-lg",children:[r.jsxs("p",{className:"text-lg",children:[r.jsx("strong",{children:"Type:"})," ",v.therapyType]}),r.jsxs("p",{className:"text-lg",children:[r.jsx("strong",{children:"Therapist:"})," ",((C=v.therapistId)==null?void 0:C.name)||"Not Assigned"]})]},N)})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-[rgb(197,27,28)]",children:"IEPs"}),r.jsxs("span",{className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full",children:[u.length," Total"]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-gray-600",children:["Latest IEP: ",u[0]?"".concat(u[0].startingMonth,"/").concat(u[0].startingYear):"None"]})}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("button",{onClick:()=>e("/superadmin/children/".concat(s,"/ieps")),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"View All IEPs"}),u.length>0&&r.jsx("button",{onClick:()=>$u(u[0]),className:"border border-[rgb(197,27,28)] text-[rgb(197,27,28)] px-4 py-2 rounded hover:bg-red-50 transition-colors",children:"View Latest IEP"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-[rgb(197,27,28)]",children:"Appointments"}),r.jsxs("span",{className:"text-sm bg-[rgb(197,27,28)] text-white px-3 py-1 rounded-full",children:[p.length," Total"]})]}),r.jsx("div",{className:"mb-4",children:p.length>0?r.jsx("ul",{className:"space-y-2",children:p.filter(v=>new Date(v.appointmentDate)>=new Date).sort((v,N)=>new Date(v.appointmentDate)-new Date(N.appointmentDate)).slice(0,3).map((v,N)=>r.jsxs("li",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(v.appointmentDate).toLocaleDateString()," -",r.jsx("span",{className:"font-medium",children:"Time:"})," ",v.appointmentTime," -",r.jsx("span",{className:"font-medium",children:"Status:"})," ",v.status]},N))}):r.jsx("p",{className:"text-gray-600",children:"No upcoming appointments scheduled."})}),r.jsx("button",{onClick:()=>e("/superadmin/children/".concat(s,"/appointments")),className:"bg-[rgb(197,27,28)] text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"View All Appointments"})]})]})]})}function Vpe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState(""),[u,h]=F.useState("all"),[p,f]=F.useState("all"),[g,b]=F.useState(1),[y]=F.useState(10),[w,v]=F.useState(null);F.useEffect(()=>{(async()=>{try{const R=await Pe.get("/api/superadmin/appointments",{headers:{Authorization:sessionStorage.getItem("token")}});e(R.data),n(!1)}catch(R){o("Failed to fetch appointments data"),n(!1),console.error("Error fetching appointments:",R)}})()},[]);const N=[...new Set(s.map($=>{var R;return((R=$.centreId)==null?void 0:R.name)||"Unassigned"}))],C=[...new Set(s.map($=>$.status))],T=async($,R)=>{v($);try{await Pe.put("/api/admins/manageAppointment/".concat($),{status:R},{headers:{Authorization:"".concat(sessionStorage.getItem("token"))}}),e(s.map(O=>O._id===$?{...O,status:R}:O)),Ve.success("Appointment ".concat(R," successfully!"))}catch(O){console.error("Error updating appointment status:",O),Ve.error("Failed to update appointment status")}finally{v(null)}},I=s.filter($=>{var _,M,A,U;const R=((_=$.childId)==null?void 0:_.name.toLowerCase().includes(i.toLowerCase()))||((M=$.doctorId)==null?void 0:M.name.toLowerCase().includes(i.toLowerCase()))||((A=$.therapistId)==null?void 0:A.name.toLowerCase().includes(i.toLowerCase())),O=u==="all"||$.status===u,P=p==="all"||((U=$.centreId)==null?void 0:U.name)===p;return R&&O&&P});return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Appointments"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("input",{type:"text",placeholder:"Search by name...",className:"px-4 py-2 border rounded-lg",value:i,onChange:$=>c($.target.value)}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:u,onChange:$=>h($.target.value),children:[r.jsx("option",{value:"all",children:"All Statuses"}),C.map($=>r.jsx("option",{value:$,children:$},$))]}),r.jsxs("select",{className:"px-4 py-2 border rounded-lg",value:p,onChange:$=>f($.target.value),children:[r.jsx("option",{value:"all",children:"All Centres"}),N.map($=>r.jsx("option",{value:$,children:$},$))]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left",children:[r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Date & Time"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Child"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Centre"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Consultation Type"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:I.slice((g-1)*y,g*y).map($=>{var R,O,P;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4",children:[$.appointmentDate.split("T")[0]||"-"," ",$.appointmentTime||"-"]}),r.jsx("td",{className:"px-6 py-4",children:((R=$.childId)==null?void 0:R.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((O=$.doctorId)==null?void 0:O.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:((P=$.centreId)==null?void 0:P.name)||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:$.consultationType||"Not specified"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat($.status==="approved"?"bg-green-100 text-green-800":$.status==="pending"?"bg-yellow-100 text-yellow-800":$.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:$.status})}),r.jsx("td",{className:"px-6 py-4",children:$.status==="pending"?r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>T($._id,"approved"),disabled:w===$._id,className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm font-medium disabled:opacity-50",title:"Approve",children:w===$._id?"...":"Approve"}),r.jsx("button",{onClick:()=>T($._id,"rejected"),disabled:w===$._id,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium disabled:opacity-50",title:"Reject",children:w===$._id?"...":"Reject"})]}):r.jsx("span",{className:"text-gray-500 text-sm",children:"No actions available"})})]},$._id)})})]})}),I.length>y&&r.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[r.jsx("button",{onClick:()=>b($=>Math.max($-1,1)),disabled:g===1,className:"px-4 py-2 rounded ".concat(g===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Previous"}),r.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",g," of ",Math.ceil(I.length/y)]}),r.jsx("button",{onClick:()=>b($=>Math.min($+1,Math.ceil(I.length/y))),disabled:g>=Math.ceil(I.length/y),className:"px-4 py-2 rounded ".concat(g>=Math.ceil(I.length/y)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[rgb(197,27,28)] text-white hover:bg-red-700"),children:"Next"})]})]})}function Upe(){const[s,e]=F.useState([]),[t,n]=F.useState(!0),[a,o]=F.useState(null),[i,c]=F.useState("");F.useEffect(()=>{(async()=>{try{const p=await Pe.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});e(p.data),n(!1)}catch(p){o("Failed to fetch centres data"),n(!1)}})()},[]);const u=s.filter(h=>h.name.toLowerCase().includes(i.toLowerCase()));return t?r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})}):a?r.jsx("div",{className:"text-red-500 text-center py-8",children:a}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"Centres"}),r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"Search centres...",className:"px-4 py-2 border rounded-lg w-full md:w-1/3",value:i,onChange:h=>c(h.target.value)})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(h=>r.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:h.name}),r.jsxs("div",{className:"text-gray-600",children:[r.jsxs("p",{className:"mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Address: "}),h.address]}),r.jsxs("p",{className:"mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Phone:"})," ",h.contactNumber]})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Staff Details"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Doctors"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.doctorCount||0})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Therapists"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.therapistCount||0})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600",children:"Admins"}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:h.adminCount||0})]})]})]}),r.jsx("div",{className:"flex flex-col justify-center",children:r.jsxs("div",{className:"text-center bg-gray-50 p-4 rounded",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Children"}),r.jsx("p",{className:"text-2xl font-bold text-[rgb(197,27,28)]",children:h.childrenCount||0})]})})]})})]})},h._id))})]})}function Gpe(){var u,h;const[s,e]=F.useState(null),[t,n]=F.useState(!0),[a,o]=F.useState(null);if(F.useEffect(()=>{const p=async()=>{try{const g=await Pe.get("/api/superadmin/system-health",{headers:{Authorization:sessionStorage.getItem("token")}});e(g.data),n(!1)}catch(g){o("Failed to fetch system health data"),n(!1)}};p();const f=setInterval(p,3e4);return()=>clearInterval(f)},[]),t)return r.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-[rgb(197,27,28)]"})});if(a)return r.jsx("div",{className:"text-red-500 text-center py-8",children:a});const i=p=>{if(p===0)return"0 Bytes";const f=1024,g=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(p)/Math.log(f));return parseFloat((p/Math.pow(f,b)).toFixed(2))+" "+g[b]},c=p=>{const f=Math.floor(p/86400),g=Math.floor(p%(3600*24)/3600),b=Math.floor(p%3600/60);return"".concat(f,"d ").concat(g,"h ").concat(b,"m")};return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[rgb(197,27,28)] mb-6",children:"System Health"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"System Status"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full ".concat((s==null?void 0:s.status)==="operational"?"bg-green-500":"bg-red-500")}),r.jsx("span",{className:"capitalize",children:s==null?void 0:s.status})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Database Status"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full ".concat((s==null?void 0:s.dbStatus)==="connected"?"bg-green-500":"bg-red-500")}),r.jsx("span",{className:"capitalize",children:s==null?void 0:s.dbStatus})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Uptime"}),r.jsx("p",{className:"text-2xl font-bold text-[rgb(197,27,28)]",children:c((u=s==null?void 0:s.metrics)==null?void 0:u.uptime)})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Memory Usage"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(((h=s==null?void 0:s.metrics)==null?void 0:h.memoryUsage)||{}).map(([p,f])=>r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 capitalize",children:p.replace("Memory","")}),r.jsx("p",{className:"text-lg font-bold text-[rgb(197,27,28)]",children:i(f)})]},p))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"API Endpoints Status"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s==null?void 0:s.endpoints.map(p=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:p.path}),r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(p.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:p.status})]},p.path))})]})]})}const wj=s=>s?new Date(s+"T00:00:00").getDay()===0:!1,Nj=()=>{const s=new Date,e=new Date(s);return e.setDate(s.getDate()+1),e.getDay()===0&&e.setDate(e.getDate()+1),e.toISOString().split("T")[0]};function Wpe(){const[s,e]=F.useState([]),[t,n]=F.useState(""),[a,o]=F.useState([]),[i,c]=F.useState(""),[u,h]=F.useState(""),[p,f]=F.useState(null),[g,b]=F.useState(!1),[y,w]=F.useState(""),[v,N]=F.useState(""),[C,T]=F.useState("AM"),[I,$]=F.useState(!1),[R,O]=F.useState(!1),[P,_]=F.useState(!1),[M,A]=F.useState(!1),[U,K]=F.useState(""),[Q,X]=F.useState(""),[B,G]=F.useState(!0),[Y,Z]=F.useState(""),[J,xe]=F.useState(!1),[ye,ve]=F.useState(""),[Re,Ce]=F.useState(!1),[pe,Te]=F.useState([]),[ee,he]=F.useState(""),[oe,Ie]=F.useState([]),[Be,We]=F.useState([]),[Ke,be]=F.useState([]),[ue,Fe]=F.useState(""),[He,rt]=F.useState(!1),[Je,Wt]=F.useState(""),[At,wt]=F.useState(null),[Ge,nt]=F.useState(!1),[at,pt]=F.useState("block"),jt=()=>at==="block"?Be:Ke,It=Oe=>{at==="block"?We(Oe):be(Oe)},an=Bo();F.useEffect(()=>{$s(),Fn();const Oe=new URLSearchParams(an.search),et=Oe.get("centreId"),Ln=Oe.get("doctorId"),ln=Oe.get("date");if(et&&(n(et),rn(et)),Ln&&c(Ln),ln){const Cs=new Date(ln).toISOString().split("T")[0];h(Cs)}},[an.search]),F.useEffect(()=>{t?(rn(t),c("")):(o([]),c(""))},[t]),F.useEffect(()=>{Re&&ee&&ue?As():wt(null)},[ee,ue,Re]),F.useEffect(()=>{xe(!1),ve(""),f(null)},[t,i,u]);const $s=async()=>{try{const Oe=await Pe.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});e(Oe.data||[])}catch(Oe){console.error("Error fetching centers:",Oe),e([])}},rn=async Oe=>{try{const et=await Pe.get("/api/superadmin/center-doctors/".concat(Oe),{headers:{Authorization:sessionStorage.getItem("token")}});o(et.data.doctors||[])}catch(et){console.error("Error fetching center doctors:",et),o([])}},Fn=async()=>{try{const Oe=await Pe.get("/api/superadmin/doctors",{headers:{Authorization:sessionStorage.getItem("token")}});Te(Oe.data||[])}catch(Oe){console.error("Error fetching all doctors:",Oe),Te([])}},Yn=async Oe=>{try{const et=pe.find(Ln=>Ln._id===Oe);et&&et.centreIds?Ie(et.centreIds):Ie([])}catch(et){console.error("Error fetching doctor centers:",et),Ie([])}},As=F.useCallback(async()=>{if(!ee||!ue){wt(null);return}try{const Oe=await Pe.get("/api/superadmin/doctor-centers-status/".concat(ee,"/").concat(ue),{headers:{Authorization:sessionStorage.getItem("token")}});wt(Oe.data)}catch(Oe){console.error("Error fetching center statuses:",Oe),wt(null)}},[ee,ue]),Ps=async()=>{if(!ee||Be.length===0||!ue){Ve.error("Please select doctor, centers, and date");return}try{await Pe.post("/api/superadmin/bulk-block-slots",{doctorId:ee,centreIds:Be,date:ue,blockReason:Je||"Bulk block operation"},{headers:{Authorization:sessionStorage.getItem("token")}}),Ve.success("Successfully blocked all slots for selected centers on ".concat(ue)),rt(!1),Wt(""),We([]),await As()}catch(Oe){console.error("Error bulk blocking slots:",Oe),Ve.error("Failed to bulk block slots")}},Or=async()=>{if(!ee||Ke.length===0||!ue){Ve.error("Please select doctor, centers, and date");return}try{await Pe.post("/api/superadmin/bulk-unblock-slots",{doctorId:ee,centreIds:Ke,date:ue},{headers:{Authorization:sessionStorage.getItem("token")}}),Ve.success("Successfully unblocked all slots for selected centers on ".concat(ue)),nt(!1),be([]),await As()}catch(Oe){console.error("Error bulk unblocking slots:",Oe),Ve.error("Failed to bulk unblock slots")}},la=async()=>{if(!t||!i||!u){Ve.error("Please select center, doctor and date");return}try{b(!0);const et=(await Pe.get("/api/superadmin/slot-config/".concat(t,"/").concat(i,"?date=").concat(u),{headers:{Authorization:sessionStorage.getItem("token")}})).data[0];et&&et.isHoliday?(xe(!0),ve(et.holidayName),f(null)):(xe(!1),ve(""),f(et))}catch(Oe){console.error("Error fetching slot configuration:",Oe),Ve.error("Failed to fetch slot configuration")}finally{b(!1)}},sl=async()=>{if(!y||!v){Ve.error("Please enter hour and minute");return}const Oe="".concat(y,":").concat(v.padStart(2,"0")," ").concat(C);try{await Pe.post("/api/superadmin/add-slot",{doctorId:i,centreId:t,date:u,slotTime:Oe},{headers:{Authorization:sessionStorage.getItem("token")}}),await la(),w(""),N(""),T("AM"),$(!1)}catch(et){console.error("Error adding slot:",et),Ve.error("Failed to add slot")}},nl=async Oe=>{try{await Pe.post("/api/superadmin/remove-slot",{doctorId:i,centreId:t,date:u,slotTime:Oe},{headers:{Authorization:sessionStorage.getItem("token")}}),await la()}catch(et){console.error("Error removing slot:",et),Ve.error("Failed to remove slot")}},Ko=async()=>{if(!U){Ve.error("Please select a slot to block");return}try{await Pe.post("/api/superadmin/block-slot",{doctorId:i,centreId:t,date:u,slotTime:U,blockReason:Q||"Blocked by admin",blockAllCenters:!1},{headers:{Authorization:sessionStorage.getItem("token")}}),await la(),_(!1),X(""),K("")}catch(Oe){console.error("Error blocking slot:",Oe),Ve.error("Failed to block slot")}},on=async Oe=>{try{await Pe.post("/api/superadmin/unblock-slot",{doctorId:i,centreId:t,date:u,slotTime:Oe},{headers:{Authorization:sessionStorage.getItem("token")}}),await la()}catch(et){console.error("Error unblocking slot:",et),Ve.error("Failed to unblock slot")}},Ns=async()=>{var Oe;if(!t||!i||!u){Ve.error("Please select center, doctor and date");return}if(window.confirm("Are you sure you want to block ALL slots for this doctor in ".concat((Oe=s.find(et=>et._id===t))==null?void 0:Oe.name," on ").concat(u,"?")))try{await Pe.post("/api/superadmin/block-all-slots",{doctorId:i,centreId:t,date:u,blockReason:"All slots blocked for the day"},{headers:{Authorization:sessionStorage.getItem("token")}}),await la()}catch(et){console.error("Error blocking all slots:",et),Ve.error("Failed to block all slots")}},al=async()=>{try{await Pe.post("/api/superadmin/set-operational-status",{doctorId:i,centreId:t,date:u,isOperational:B,reason:Y||void 0},{headers:{Authorization:sessionStorage.getItem("token")}}),await la(),O(!1),Z("")}catch(Oe){console.error("Error updating operational status:",Oe),Ve.error("Failed to update operational status")}},Zn=Oe=>Oe.isActive?Oe.isBlocked?"bg-red-100 text-red-700 border-red-300":"bg-green-100 text-green-700 border-green-300":"bg-gray-100 text-gray-500 border-gray-300",_r=Oe=>Oe.isActive?Oe.isBlocked?"Blocked":"Available":"Inactive";return r.jsx("div",{className:"flex",children:r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-2",children:"Slot Management"})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 mb-6",children:r.jsxs("div",{className:"flex border-b border-red-200",children:[r.jsx("button",{onClick:()=>Ce(!1),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(Re?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-[#ab1c1c] text-[#ab1c1c] bg-red-50"),children:"Individual Center Management"}),r.jsx("button",{onClick:()=>Ce(!0),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors ".concat(Re?"border-[#ab1c1c] text-[#ab1c1c] bg-red-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Bulk Operations"})]})}),Re&&!J&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:"Bulk Slot Operations"}),r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>{pt("block")},className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(at==="block"?"bg-red-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Block Slots"}),r.jsx("button",{onClick:()=>{pt("unblock")},className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(at==="unblock"?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Unblock Slots"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor *"}),r.jsxs("select",{value:ee,onChange:Oe=>{he(Oe.target.value),Oe.target.value?Yn(Oe.target.value):(Ie([]),We([]),be([]))},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select Doctor"}),pe.map(Oe=>r.jsx("option",{value:Oe._id,children:Oe.name},Oe._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),r.jsx("input",{type:"date",value:ue,onChange:Oe=>{const et=Oe.target.value;if(wj(et)){Ve.error("Slots cannot be created on Sundays. Please select another date.");return}Fe(et)},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",min:Nj()})]})]}),oe.length>0&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Select Centers for ",at==="block"?"Blocking":"Unblocking"," *"]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[At&&r.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-1"}),"Blocked (",At.summary.fullyBlocked,")"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-1"}),"Partial (",At.summary.partiallyBlocked,")"]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-1"}),"Available (",At.summary.available,")"]})]}),oe.length>0&&r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{type:"button",onClick:()=>{It(oe.map(Oe=>Oe._id))},className:"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"Select All"}),r.jsx("button",{type:"button",onClick:()=>{It([])},className:"text-xs bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600",children:"Unselect All"})]})]})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 p-4 border border-gray-200 rounded-lg",children:oe.map(Oe=>{var Ba;const et=(Ba=At==null?void 0:At.allCenters)==null?void 0:Ba.find(io=>io.centreId===Oe._id),Ln=(et==null?void 0:et.status)==="fully_blocked",ln=(et==null?void 0:et.status)==="partially_blocked",Ss=(et==null?void 0:et.status)==="available",Cs=jt();return r.jsxs("label",{className:"flex items-start p-3 rounded-lg border cursor-pointer hover:shadow-sm transition-shadow ".concat(Ln?"border-red-300 bg-red-50":ln?"border-yellow-300 bg-yellow-50":Ss?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50"),children:[r.jsx("input",{type:"checkbox",checked:Cs.includes(Oe._id),onChange:io=>{io.target.checked?It([...Cs,Oe._id]):It(Cs.filter(Ku=>Ku!==Oe._id))},className:"mr-3 mt-1 h-4 w-4 text-[#ab1c1c] focus:ring-[#ab1c1c]"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:Oe.name}),et&&r.jsxs("div",{className:"text-xs mt-1 font-medium ".concat(Ln?"text-red-600":ln?"text-yellow-600":"text-green-600"),children:[Ln&&"Blocked (".concat(et.blockedSlotsCount,"/").concat(et.totalSlotsCount," slots)"),ln&&"Partial (".concat(et.blockedSlotsCount,"/").concat(et.totalSlotsCount," slots)"),Ss&&"Available"]})]})]},Oe._id)})}),r.jsxs("div",{className:"flex items-center justify-between mt-6",children:[r.jsx("div",{className:"text-sm text-gray-600",children:jt().length>0?r.jsxs("span",{className:"font-medium",children:[jt().length," center(s) selected for ",at,"ing"]}):r.jsxs("span",{children:["Select centers to ",at]})}),r.jsxs("button",{onClick:()=>{at==="block"?rt(!0):nt(!0)},disabled:!ee||jt().length===0||!ue,className:"px-6 py-3 text-white rounded-lg font-medium transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed ".concat(at==="block"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:[at==="block"?"Block":"Unblock"," Selected Centers"]})]})]}),at==="block"&&jt().length>0&&r.jsxs("div",{className:"mt-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("label",{className:"block text-sm font-medium text-red-800 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:Je,onChange:Oe=>Wt(Oe.target.value),placeholder:"e.g., Doctor on leave, Holiday, etc.",className:"w-full border border-red-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"})]})]}),Re&&J&&r.jsx("div",{className:"bg-orange-50 border border-orange-200 p-6 rounded-lg shadow-sm mb-6",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-4xl mb-3",children:""}),r.jsx("h3",{className:"text-lg font-semibold text-orange-800 mb-2",children:"Bulk Operations Unavailable on Holiday"}),r.jsx("p",{className:"text-orange-700",children:"Bulk slot operations are disabled during holidays. Please select a different date."})]})}),!Re&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200 mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-4",children:"Select Configuration"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Center *"}),r.jsxs("select",{value:t,onChange:Oe=>{const et=Oe.target.value;n(et),et?rn(et):(o([]),c(""))},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select Center"}),s.map(Oe=>r.jsx("option",{value:Oe._id,children:Oe.name},Oe._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor *"}),r.jsxs("select",{value:i,onChange:Oe=>c(Oe.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",disabled:!t||a.length===0,children:[r.jsx("option",{value:"",children:t?a.length===0?"No doctors available":"Select Doctor":"Select Center First"}),a.map(Oe=>r.jsx("option",{value:Oe._id,children:Oe.name},Oe._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsx("input",{type:"date",value:u,onChange:Oe=>{const et=Oe.target.value;if(wj(et)){Ve.error("Slots cannot be managed on Sundays. Please select another date.");return}h(et)},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",min:Nj()})]})]}),r.jsx("button",{onClick:la,disabled:!t||!i||!u||g,className:"bg-[#ab1c1c] text-white px-6 py-2 rounded-lg hover:bg-[#8a1717] disabled:bg-gray-300 disabled:cursor-not-allowed",children:g?"Loading...":"Load Slots"})]}),J&&r.jsx("div",{className:"bg-gradient-to-r from-orange-100 to-red-100 p-8 rounded-lg shadow-sm border-2 border-orange-300",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsxs("h2",{className:"text-2xl font-bold text-orange-800 mb-2",children:["Holiday - ",ye]}),r.jsx("p",{className:"text-lg text-orange-700 mb-4",children:u?new Date(u).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"No date selected"}),r.jsxs("div",{className:"bg-white bg-opacity-70 rounded-lg p-4 inline-block",children:[r.jsx("p",{className:"text-orange-800 font-medium",children:" No slots are available on this holiday"}),r.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"All appointments and slot management are disabled"})]})]})}),!J&&p&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-red-200",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:["Slot Configuration - ",u?new Date(u).toLocaleDateString():"No date selected"]}),r.jsxs("div",{className:"flex items-center mt-2",children:[r.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Status:"}),r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((p==null?void 0:p.isOperational)!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:(p==null?void 0:p.isOperational)!==!1?"Operational":"Non-Operational"})]})]}),r.jsxs("div",{className:"space-x-2",children:[r.jsx("button",{onClick:()=>$(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Add Slot"}),r.jsx("button",{onClick:()=>Ns(),className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Block All Slots"}),r.jsx("button",{onClick:()=>{var Oe;G((Oe=p==null?void 0:p.isOperational)!=null?Oe:!0),O(!0)},className:"px-4 py-2 rounded-lg ".concat((p==null?void 0:p.isOperational)!==!1?"bg-orange-600 hover:bg-orange-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:(p==null?void 0:p.isOperational)!==!1?"Set Non-Operational":"Set Operational"})]})]}),p&&p.availableSlots&&Array.isArray(p.availableSlots)&&p.availableSlots.length>0?r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:p.availableSlots.map((Oe,et)=>r.jsxs("div",{className:"p-3 rounded-lg border-2 ".concat(Zn(Oe)),children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-medium",children:Oe.time}),r.jsx("div",{className:"text-xs mt-1",children:_r(Oe)}),Oe.isBlocked&&Oe.blockReason&&r.jsx("div",{className:"text-xs mt-1 text-red-600",children:Oe.blockReason})]}),r.jsxs("div",{className:"flex justify-center mt-2 space-x-1",children:[Oe.isBlocked?r.jsx("button",{onClick:()=>on(Oe.time),className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",children:"Unblock"}):r.jsx("button",{onClick:()=>{K(Oe.time),_(!0)},className:"text-xs bg-orange-500 text-white px-2 py-1 rounded hover:bg-orange-600",children:"Block"}),r.jsx("button",{onClick:()=>{K(Oe.time),A(!0)},className:"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"Remove"})]})]},et))}):r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No slots configured for this combination. Add some slots to get started."})]}),I&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:"Add New Slot"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Slot"}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Hour"}),r.jsxs("select",{value:y,onChange:Oe=>w(Oe.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"",children:"Select"}),[...Array(12)].map((Oe,et)=>r.jsx("option",{value:et+1,children:et+1},et+1))]})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Minute (00 to 59)"}),r.jsx("input",{type:"number",value:v,onChange:Oe=>{const et=parseInt(Oe.target.value);(Oe.target.value===""||et>=0&&et<=59)&&N(Oe.target.value)},min:"0",max:"59",placeholder:"Enter minutes",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Period"}),r.jsxs("select",{value:C,onChange:Oe=>T(Oe.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:"AM",children:"AM"}),r.jsx("option",{value:"PM",children:"PM"})]})]})]}),y&&v&&r.jsxs("p",{className:"text-xs text-green-600 mt-2",children:["Preview: ",y,":",v.padStart(2,"0")," ",C]})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{$(!1),w(""),N(""),T("AM")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:sl,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Add Slot"})]})]})}),P&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-orange-600",children:"Block Slot"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to block the ",r.jsx("strong",{children:U})," slot?"]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:Q,onChange:Oe=>X(Oe.target.value),placeholder:"e.g., Doctor unavailable",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{_(!1),K(""),X("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Ko,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Yes, Block Slot"})]})]})}),M&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-red-600",children:"Confirm Remove Slot"}),r.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to ",r.jsx("strong",{children:"permanently remove"})," the ",r.jsx("strong",{children:U})," slot?"]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{A(!1),K("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>{nl(U),A(!1),K("")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Yes, Remove Permanently"})]})]})}),R&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:B?"Set Operational":"Set Non-Operational"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operational Status"}),r.jsxs("select",{value:B,onChange:Oe=>G(Oe.target.value==="true"),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",children:[r.jsx("option",{value:!0,children:"Operational"}),r.jsx("option",{value:!1,children:"Non-Operational"})]})]}),!B&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason (Optional)"}),r.jsx("input",{type:"text",value:Y,onChange:Oe=>Z(Oe.target.value),placeholder:"e.g., Doctor on leave",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{O(!1),Z("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:al,className:"px-4 py-2 bg-[#ab1c1c] text-white rounded-lg hover:bg-[#8a1717]",children:"Update Status"})]})]})})]}),He&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-red-600",children:"Bulk Block All Slots"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to block ALL slots for the selected doctor across"," ",r.jsxs("strong",{children:[Be.length," center(s)"]})," on"," ",r.jsx("strong",{children:ue}),"?"]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Reason (Optional)"}),r.jsx("input",{type:"text",value:Je,onChange:Oe=>Wt(Oe.target.value),placeholder:"e.g., Doctor on leave",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{rt(!1),Wt("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Ps,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Yes, Block All Slots"})]})]})}),Ge&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg",children:[r.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-600",children:"Confirm Bulk Unblock"}),r.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to unblock ALL slots for the selected doctor across"," ",r.jsxs("strong",{children:[Ke.length," center(s)"]})," on"," ",r.jsx("strong",{children:ue}),"?"]}),At&&Ke.length>0&&r.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Centers to unblock:"}),r.jsx("div",{className:"space-y-1",children:Ke.map(Oe=>{var Ln;const et=(Ln=At.allCenters)==null?void 0:Ln.find(ln=>ln.centreId===Oe);return et?r.jsxs("div",{className:"text-sm text-blue-700",children:[" ",et.centreName," (",et.blockedSlotsCount,"/",et.totalSlotsCount," slots blocked)"]},Oe):null})})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>{nt(!1)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>{Or(),be([])},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Unblock All Slots"})]})]})}),g&&r.jsx(Gs,{})]})})})}function Hpe(){const[s,e]=F.useState({name:"",mobilenumber:"",password:"",confirmPassword:"",designation:"",qualification:"",centreIds:[]}),[t,n]=F.useState([]),[a,o]=F.useState([]),[i,c]=F.useState({}),[u]=F.useState(!1),[h,p]=F.useState(!1),[f,g]=F.useState(!1),[b,y]=F.useState(!1),[w,v]=F.useState(!1),[N,C]=F.useState(!1);F.useEffect(()=>{T(),I()},[]);const T=async()=>{try{const A=await Pe.get("/api/superadmin/centres",{headers:{Authorization:sessionStorage.getItem("token")}});n(A.data||[])}catch(A){console.error("Error fetching centers:",A),Ve.error("Failed to fetch centers")}},I=async()=>{try{const A=await Pe.get("/api/superadmin/doctors-list",{headers:{Authorization:sessionStorage.getItem("token")}});o(A.data||[])}catch(A){console.error("Error fetching doctors:",A),Ve.error("Failed to fetch doctors")}},$=A=>{const{name:U,value:K}=A.target;e({...s,[U]:K}),i[U]&&c({...i,[U]:""})},R=(A,U)=>{let K=[...s.centreIds];U?K.includes(A)||K.push(A):K=K.filter(Q=>Q!==A),e({...s,centreIds:K}),C(K.length===t.length)},O=()=>{N?(e({...s,centreIds:[]}),C(!1)):(e({...s,centreIds:t.map(A=>A._id)}),C(!0))},P=()=>{const A={};return s.name.trim()||(A.name="Name is required"),s.mobilenumber?/^\d{10}$/.test(s.mobilenumber)||(A.mobilenumber="Mobile number must be 10 digits"):A.mobilenumber="Mobile number is required",s.password?s.password.length<6&&(A.password="Password must be at least 6 characters"):A.password="Password is required",s.password!==s.confirmPassword&&(A.confirmPassword="Passwords do not match"),s.centreIds.length===0&&(A.centreIds="At least one center must be selected"),A},_=async A=>{var U,K,Q,X;A.preventDefault(),g(!0);try{const B=P();if(Object.keys(B).length>0){c(B),Ve.error("Please fix the validation errors before submitting");return}await Pe.post("/api/superadmin/register-doctor",{name:s.name,mobilenumber:s.mobilenumber,password:s.password,centreIds:s.centreIds,designation:s.designation,qualification:s.qualification},{headers:{Authorization:sessionStorage.getItem("token")}}),Ve.success("Doctor registered successfully!"),p(!0),await I()}catch(B){console.error("Registration error:",B),Ve.error(((K=(U=B.response)==null?void 0:U.data)==null?void 0:K.error)||((X=(Q=B.response)==null?void 0:Q.data)==null?void 0:X.message)||"Registration failed")}finally{g(!1)}},M=()=>{e({name:"",mobilenumber:"",password:"",confirmPassword:"",designation:"",qualification:"",centreIds:[]}),c({}),p(!1),C(!1)};return h?r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-xl overflow-hidden border border-green-200",children:r.jsxs("div",{className:"px-6 py-8 text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h3",{className:"mt-3 text-xl font-medium text-gray-900",children:"Doctor Registration Successful!"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Doctor account has been created successfully and assigned to selected centers."}),r.jsx("div",{className:"mt-6 space-y-3",children:r.jsx("button",{onClick:M,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]",children:"Register Another Doctor"})})]})})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-[#ab1c1c] mb-2",children:"Doctor Registration"}),r.jsx("p",{className:"text-gray-600",children:"Register new doctors and assign them to centers"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 mb-8",children:r.jsxs("div",{className:"px-6 py-8",children:[r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c] mb-6",children:"Register New Doctor"}),r.jsxs("form",{onSubmit:_,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),r.jsx("input",{type:"text",name:"name",value:s.name,onChange:$,className:"w-full p-3 border ".concat(i.name?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Doctor's full name"}),i.name&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number *"}),r.jsx("input",{type:"number",name:"mobilenumber",value:s.mobilenumber,onChange:$,className:"w-full p-3 border ".concat(i.mobilenumber?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"10-digit mobile number",maxLength:"10"}),i.mobilenumber&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.mobilenumber})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),r.jsx("input",{type:"text",name:"designation",value:s.designation,onChange:$,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"e.g., Senior Consultant, Specialist"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Qualification"}),r.jsx("input",{type:"text",name:"qualification",value:s.qualification,onChange:$,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]",placeholder:"e.g., MBBS, MD, MS"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:b?"text":"password",name:"password",value:s.password,onChange:$,className:"w-full p-3 border ".concat(i.password?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>y(!b),children:b?r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),i.password&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.password})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:w?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:$,className:"w-full p-3 border ".concat(i.confirmPassword?"border-red-500":"border-gray-300"," rounded-lg focus:outline-none focus:ring-2 focus:ring-[#ab1c1c]"),placeholder:"Confirm Password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>v(!w),children:w?r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):r.jsxs("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),r.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),i.confirmPassword&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:i.confirmPassword})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assign Centers *"}),r.jsx("button",{type:"button",onClick:O,className:"text-sm text-[#ab1c1c] hover:text-[#8e1818] font-medium",children:N?"Deselect All":"Select All"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 p-4 border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:t.map(A=>r.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 hover:border-[#ab1c1c] hover:bg-red-50 cursor-pointer transition-colors",children:[r.jsx("input",{type:"checkbox",checked:s.centreIds.includes(A._id),onChange:U=>R(A._id,U.target.checked),className:"mr-3 h-4 w-4 text-[#ab1c1c] focus:ring-[#ab1c1c] border-gray-300 rounded"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),A.location&&r.jsx("div",{className:"text-xs text-gray-500",children:A.location})]})]},A._id))}),s.centreIds.length>0&&r.jsx("div",{className:"mt-3 p-3 bg-green-50 rounded-lg border border-green-200",children:r.jsxs("div",{className:"text-sm text-green-800",children:[r.jsx("strong",{children:s.centreIds.length})," center(s) selected"]})}),i.centreIds&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:i.centreIds})]}),r.jsx("div",{className:"pt-4",children:r.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white ".concat(f?"bg-gray-400 cursor-not-allowed":"bg-[#ab1c1c] hover:bg-[#8e1818] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#ab1c1c]"),children:f?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Registering Doctor..."]}):"Register Doctor"})})]})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-red-200",children:[r.jsx("div",{className:"px-6 py-4 border-b border-red-200",children:r.jsx("h2",{className:"text-xl font-semibold text-[#ab1c1c]",children:"Registered Doctors"})}),r.jsx("div",{className:"p-6",children:u?r.jsx(Gs,{}):a.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No doctors registered yet."}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned Centers"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patients"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(A=>{var U,K;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),A.designation&&r.jsx("div",{className:"text-sm text-gray-500",children:A.designation}),A.qualification&&r.jsx("div",{className:"text-xs text-gray-400",children:A.qualification})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-500",children:A.mobilenumber})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:(U=A.centreIds)==null?void 0:U.map(Q=>r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:Q.name},Q._id))})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[((K=A.patients)==null?void 0:K.length)||0," patients"]})]},A._id)})})]})})})]}),u&&r.jsx(Gs,{})]})}function qpe(){return r.jsx("div",{className:"min-h-screen bg-gray-100",children:r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(_pe,{}),r.jsx("div",{className:"flex-1 p-6",children:r.jsxs(ig,{children:[r.jsx(st,{path:"/dashboard",element:r.jsx(Fpe,{})}),r.jsx(st,{path:"/users",element:r.jsx(Ppe,{})}),r.jsx(st,{path:"/children",element:r.jsx(zpe,{})}),r.jsx(st,{path:"/children/:childId",element:r.jsx(Bpe,{})}),r.jsx(st,{path:"/children/:childId/ieps",element:r.jsx(u8,{})}),r.jsx(st,{path:"/children/:childId/appointments",element:r.jsx(d8,{})}),r.jsx(st,{path:"/appointments",element:r.jsx(Vpe,{})}),r.jsx(st,{path:"/centres",element:r.jsx(Upe,{})}),r.jsx(st,{path:"/doctor-registration",element:r.jsx(Hpe,{})}),r.jsx(st,{path:"/slot-management",element:r.jsx(Wpe,{})}),r.jsx(st,{path:"/system-health",element:r.jsx(Gpe,{})})]})})]})})}const Kpe=()=>{const s=Ml(t=>t.auth.isAuthenticated),e=sessionStorage.getItem("role");if(s)switch(console.log(s,e),e){case"admin":return r.jsx(Eo,{to:"/admindashboard",replace:!0});case"parent":return r.jsx(Eo,{to:"/parentdashboard",replace:!0});case"doctor":return r.jsx(Eo,{to:"/doctordashboard",replace:!0});case"therapist":return r.jsx(Eo,{to:"/therapistdashboard",replace:!0});case"superadmin":return r.jsx(Eo,{to:"/superadmin/dashboard",replace:!0})}return r.jsx(PF,{})},Xpe=()=>r.jsxs(r.Fragment,{children:[r.jsx(V5,{}),r.jsx("div",{className:"min-h-screen",children:r.jsxs(ig,{children:[r.jsx(st,{path:"/",element:r.jsx(j5,{})}),r.jsx(st,{path:"/aboutus/whoarewe",element:r.jsx(K5,{})}),r.jsx(st,{path:"/aboutus/whyus",element:r.jsx(tO,{})}),r.jsx(st,{path:"/aboutus/foundermessages",element:r.jsx(uO,{})}),r.jsx(st,{path:"/aboutus/goals",element:r.jsx(pO,{})}),r.jsx(st,{path:"/aboutus/research",element:r.jsx(bO,{})}),r.jsx(st,{path:"/services",element:r.jsx(XO,{})}),r.jsx(st,{path:"/services/speech-therapy",element:r.jsx(rO,{})}),r.jsx(st,{path:"/services/assessment-evaluation",element:r.jsx(iO,{})}),r.jsx(st,{path:"/services/behaviour-modification",element:r.jsx(vO,{})}),r.jsx(st,{path:"/services/occupational-therapy",element:r.jsx(c_,{})}),r.jsx(st,{path:"/services/remedial-therapy",element:r.jsx(NO,{})}),r.jsx(st,{path:"/services/behaviour-therapy",element:r.jsx(MO,{})}),r.jsx(st,{path:"/contact",element:r.jsx(Z5,{})}),r.jsx(st,{path:"/ourbranches",element:r.jsx(kO,{})}),r.jsx(st,{path:"/training",element:r.jsx(zO,{})}),r.jsx(st,{path:"/faq",element:r.jsx(QO,{})}),r.jsx(st,{path:"/terms-and-conditions",element:r.jsx(r_,{})}),r.jsx(st,{path:"/media/photos",element:r.jsx(OF,{})}),r.jsx(st,{path:"/media/videos",element:r.jsx(LF,{})}),r.jsx(st,{path:"/login",element:r.jsx(Kpe,{})}),r.jsx(st,{path:"/register",element:r.jsx(h8,{})}),r.jsx(st,{path:"/facedetection",element:r.jsx(ta,{requiredRole:["therapist"],children:r.jsx(Ope,{})})}),r.jsx(st,{path:"/doctordashboard",element:r.jsx(ta,{requiredRole:["doctor"],children:r.jsx(JF,{})})}),r.jsx(st,{path:"/doctordashboard/iepdoctor",element:r.jsx(ta,{requiredRole:["doctor"],children:r.jsx(t8,{})})}),r.jsx(st,{path:"/doctordashboard/viewappointment",element:r.jsx(ta,{requiredRole:["doctor"],children:r.jsx(a8,{})})}),r.jsx(st,{path:"/admindashboard/*",element:r.jsx(ta,{requiredRole:["admin"],children:r.jsx(M8,{})})}),r.jsx(st,{path:"/admindashboard/child/:childId/edit",element:r.jsx(ZF,{})}),r.jsx(st,{path:"/parentwrapper",element:r.jsx(C4,{})}),r.jsx(st,{path:"/therapistdashboard",element:r.jsx(ta,{requiredRole:["therapist"],children:r.jsx(QF,{})})}),r.jsx(st,{path:"/therapistdashboard/iep",element:r.jsx(ta,{requiredRole:["therapist"],children:r.jsx(s8,{})})}),r.jsx(st,{path:"/games",element:r.jsx(f8,{})}),r.jsx(st,{path:"/parentdashboard/*",element:r.jsx(ta,{requiredRole:["parent"],children:r.jsx(C4,{})})}),r.jsx(st,{path:"/reports",element:r.jsx(ta,{requiredRole:["admin","doctor","therapist"],children:r.jsx(Oj,{})})}),r.jsx(st,{path:"/iepreports/:childId",element:r.jsx(ta,{requiredRole:["parent"],children:r.jsx(_j,{})})}),r.jsx(st,{path:"/profile",element:r.jsx(ta,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(w8,{})})}),r.jsx(st,{path:"/calendar",element:r.jsx(ta,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(k8,{})})}),r.jsx(st,{path:"/codeofconduct",element:r.jsx(ta,{requiredRole:["therapist"],children:r.jsx(n8,{})})}),r.jsx(st,{path:"/announcements",element:r.jsx(ta,{requiredRole:["admin","parent","doctor","therapist","superadmin"],children:r.jsx(I8,{})})}),r.jsx(st,{path:"/superadmin/*",element:r.jsx(ta,{requiredRole:["superadmin"],children:r.jsx(qpe,{})})}),r.jsx(st,{path:"*",element:r.jsx(zF,{})})]})}),r.jsx(H5,{})]});function Ype(){const s=Th();return F.useEffect(()=>{const e=sessionStorage.getItem("token");if(e){const t=Cr(e),n=t.role;s(Dj({token:e,role:n,details:t.user}))}},[]),r.jsx("div",{className:"min-h-screen flex flex-col",children:r.jsxs(E6,{children:[r.jsx(cg,{}),r.jsx(Xpe,{})]})})}const Zpe={centreChildren:[],centreDoctors:[],centreTherapists:[],selectedCentreChild:null,selectedCentreDoctor:null,selectedCentreTherapist:null,appointmentDate:null,appointmentTime:null,loading:!1,error:null},WD=Sj({name:"centre",initialState:Zpe,reducers:{setCentreChildren:(s,e)=>{s.centreChildren=e.payload},setCentreDoctors:(s,e)=>{s.centreDoctors=e.payload},setCentreTherapists:(s,e)=>{s.centreTherapists=e.payload},setSelectedCentreChild:(s,e)=>{s.selectedCentreChild=e.payload},setSelectedCentreDoctor:(s,e)=>{s.selectedCentreDoctor=e.payload},setSelectedCentreTherapist:(s,e)=>{s.selectedCentreTherapist=e.payload},setCentreAppointmentDate:(s,e)=>{s.appointmentDate=e.payload},setCentreAppointmentTime:(s,e)=>{s.appointmentTime=e.payload}}}),{setCentreChildren:ffe,setCentreDoctors:mfe,setCentreTherapists:gfe,setSelectedCentreChild:xfe,setSelectedCentreDoctor:bfe,setSelectedCentreTherapist:yfe,setAppointmentDate:vfe,setAppointmentTime:wfe}=WD.actions,Qpe=WD.reducer,Jpe=I6({reducer:{auth:P5,admin:Qpe}});Pe.defaults.baseURL="\r\nhttps://testingtotalapi.joywithlearning.com";U6.createRoot(document.getElementById("root")).render(r.jsx($6,{store:Jpe,children:r.jsx(Ype,{})}));export{efe as __vite_legacy_guard};
